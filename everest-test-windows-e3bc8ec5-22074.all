This is /home/everbld/everest-ci/ci
Working directory: /cygdrive/c/build/agent1/_work/13/s
About to run: ./everest --yes -windows -j 16 test
BUILD_SOURCEBRANCHNAME: protz_uint128
BUILD_DEFINITIONNAME: Everest-CI-Windows-fnouint128
BUILD_BUILDID: 22074
DEFINITIONNAME:
Z3 is /home/everbld/everest/z3-4.5.1.1f29cebd4df6-x64-win/bin/z3
# Switching to the everest directory ... now in /cygdrive/c/build/agent1/_work/13/s

exported FSTAR_HOME=C:/build/agent1/_work/13/s/FStar
exported OPENSSL_HOME=C:/build/agent1/_work/13/s/MLCrypto/openssl
exported KREMLIN_HOME=C:/build/agent1/_work/13/s/kremlin
exported VALE_HOME=C:/build/agent1/_work/13/s/vale
exported HACL_HOME=C:/build/agent1/_work/13/s/hacl-star
exported MLCRYPTO_HOME=C:/build/agent1/_work/13/s/MLCrypto
+ hacl-star/secure_api/out/vale_aes_concrete_id/krml-test.exe
exported PATH=/cygdrive/c/build/agent1/_work/13/s/MLCrypto/openssl:/cygdrive/c/build/agent1/_work/13/s/FStar/bin:/cygdrive/c/build/agent1/_work/13/s/kremlin:/home/everbld/.opam/4.05.0+mingw64c/bin:/cygdrive/c/Windows/Microsoft.NET/Framework64/v4.0.30319/:/home/everbld/everest/nuget/bin:/home/everbld/everest/z3-4.5.1.1f29cebd4df6-x64-win/bin:/cygdrive/c/PROGRA~2/MICROS~1.0/VC/bin/amd64:/cygdrive/c/PROGRA~2/MICROS~1.0/VC/bin:/cygdrive/c/PROGRA~2/MICROS~4/F#/4.0/FRAMEW~1/v4.0/:/usr/x86_64-w64-mingw32/sys-root/mingw/bin:/usr/local/bin:/usr/bin:/cygdrive/c/build/agent1/externals/git/cmd:/cygdrive/c/Python36/Scripts:/cygdrive/c/Python36:/cygdrive/c/Docker/Resources/bin:/cygdrive/c/windows/system32:/cygdrive/c/windows:/cygdrive/c/windows/System32/Wbem:/cygdrive/c/windows/System32/WindowsPowerShell/v1.0:/cygdrive/c/Users/everbld/AppData/Local/Microsoft/WindowsApps:/cygdrive/c/Program Files/Docker/Docker/resources/bin:%USERPROFILE%/.dnx/bin:/cygdrive/c/Program Files/Microsoft DNX/Dnvm:/cygdrive/c/Program Files/Microsoft SQL Server/120/Tools/Binn:/cygdrive/c/Program Files/Microsoft SQL Server/130/Tools/Binn:/cygdrive/c/Program Files/dotnet:/cygdrive/c/Program Files/nodejs:/usr/bin:/cygdrive/c/Program Files/Git/mingw64/bin:/cygdrive/c/Users/everbld/AppData/Roaming/npm:/cygdrive/c/build/agent1/bin:/cygdrive/c/build/agent1/bin
================================================================================
Running tests (commands shown below)
test()
[test] expected output cipher is d31a8d34648e60db7b86afbc53ef7ec2a4aded51296e08fea9e2b5a736ee62d63dbea45e8ca9671282fafb69da92728b1a71de0a9e060b2905d6a5b67ecd3b3692ddbd7f2d778b8c9803aee328091b58fab324e4fad675945585808b4831d7bc3ff4def08e4b7a9de576d26586cec64b61161ae10b594f09e26a7e902ecbd0600691
+ hacl-star/secure_api/out/hacl_aes_concrete_id/krml-test.exe
[test] computed output cipher is d31a8d34648e60db7b86afbc53ef7ec2a4aded51296e08fea9e2b5a736ee62d63dbea45e8ca9671282fafb69da92728b1a71de0a9e060b2905d6a5b67ecd3b3692ddbd7f2d778b8c9803aee328091b58fab324e4fad675945585808b4831d7bc3ff4def08e4b7a9de576d26586cec64b61161ae10b594f09e26a7e902ecbd0600691
[test] cipher is a success
[test] expected output decryption is 4c616469657320616e642047656e746c656d656e206f662074686520636c617373206f66202739393a204966204920636f756c64206f6666657220796f75206f6e6c79206f6e652074697020666f7220746865206675747572652c2073756e73637265656e20776f756c642062652069742e
[test] computed output decryption is 4c616469657320616e642047656e746c656d656e206f662074686520636c617373206f66202739393a204966204920636f756c64206f6666657220796f75206f6e6c79206f6e652074697020666f7220746865206675747572652c2073756e73637265656e20776f756c642062652069742e
[test] decryption is a success
test_aes_gcm_0()
[test] expected output cipher is 58e2fccefa7e3061367f1d57a4e7455a
[test] computed output cipher is 58e2fccefa7e3061367f1d57a4e7455a
[test] cipher is a success
[test] expected output decryption is 
[test] computed output decryption is 
[test] decryption is a success
test_aes_gcm_1()
[test] expected output cipher is 530f8afbc74536b9a963b4f1c4cb738b
[test] computed output cipher is 530f8afbc74536b9a963b4f1c4cb738b
[test] cipher is a success
[test] expected output decryption is 
[test] computed output decryption is 
[test] decryption is a success
+ make -C hacl-star/secure_api -f Makefile.extract test
test_aes_gcm_2()
[test] expected output cipher is cea7403d4d606b6e074ec5d3baf39d18d0d1c8a799996bf0265b98b5d48ab919
[test] computed output cipher is cea7403d4d606b6e074ec5d3baf39d18d0d1c8a799996bf0265b98b5d48ab919
[test] cipher is a success
[test] expected output decryption is 00000000000000000000000000000000
[test] computed output decryption is 00000000000000000000000000000000
[test] decryption is a success
test_aes_gcm_3()
[test] expected output cipher is 522dc1f099567d07f47f37a32a84427d643a8cdcbfe5c0c97598a2bd2555d1aa8cb08e48590dbb3da7b08b1056828838c5f61e6393ba7a0abcc9f662898015adb094dac5d93471bdec1a502270e3cc6c
[test] computed output cipher is 522dc1f099567d07f47f37a32a84427d643a8cdcbfe5c0c97598a2bd2555d1aa8cb08e48590dbb3da7b08b1056828838c5f61e6393ba7a0abcc9f662898015adb094dac5d93471bdec1a502270e3cc6c
[test] cipher is a success
[test] expected output decryption is d9313225f88406e5a55909c5aff5269a86a7a9531534f7da2e4c303d8a318a721c3c0c95956809532fcf0e2449a6b525b16aedf5aa0de657ba637b391aafd255
[test] computed output decryption is d9313225f88406e5a55909c5aff5269a86a7a9531534f7da2e4c303d8a318a721c3c0c95956809532fcf0e2449a6b525b16aedf5aa0de657ba637b391aafd255
[test] decryption is a success
test_aes_gcm_4()
[test] expected output cipher is 522dc1f099567d07f47f37a32a84427d643a8cdcbfe5c0c97598a2bd2555d1aa8cb08e48590dbb3da7b08b1056828838c5f61e6393ba7a0abcc9f66276fc6ece0f4e1768cddf8853bb2d551b
[test] computed output cipher is 522dc1f099567d07f47f37a32a84427d643a8cdcbfe5c0c97598a2bd2555d1aa8cb08e48590dbb3da7b08b1056828838c5f61e6393ba7a0abcc9f66276fc6ece0f4e1768cddf8853bb2d551b
[test] cipher is a success
[test] expected output decryption is d9313225f88406e5a55909c5aff5269a86a7a9531534f7da2e4c303d8a318a721c3c0c95956809532fcf0e2449a6b525b16aedf5aa0de657ba637b39
[test] computed output decryption is d9313225f88406e5a55909c5aff5269a86a7a9531534f7da2e4c303d8a318a721c3c0c95956809532fcf0e2449a6b525b16aedf5aa0de657ba637b39
[test] decryption is a success
test()
[test] expected output cipher is d31a8d34648e60db7b86afbc53ef7ec2a4aded51296e08fea9e2b5a736ee62d63dbea45e8ca9671282fafb69da92728b1a71de0a9e060b2905d6a5b67ecd3b3692ddbd7f2d778b8c9803aee328091b58fab324e4fad675945585808b4831d7bc3ff4def08e4b7a9de576d26586cec64b61161ae10b594f09e26a7e902ecbd0600691
[test] computed output cipher is d31a8d34648e60db7b86afbc53ef7ec2a4aded51296e08fea9e2b5a736ee62d63dbea45e8ca9671282fafb69da92728b1a71de0a9e060b2905d6a5b67ecd3b3692ddbd7f2d778b8c9803aee328091b58fab324e4fad675945585808b4831d7bc3ff4def08e4b7a9de576d26586cec64b61161ae10b594f09e26a7e902ecbd0600691
[test] cipher is a success
[test] expected output decryption is 4c616469657320616e642047656e746c656d656e206f662074686520636c617373206f66202739393a204966204920636f756c64206f6666657220796f75206f6e6c79206f6e652074697020666f7220746865206675747572652c2073756e73637265656e20776f756c642062652069742e
[test] computed output decryption is 4c616469657320616e642047656e746c656d656e206f662074686520636c617373206f66202739393a204966204920636f756c64206f6666657220796f75206f6e6c79206f6e652074697020666f7220746865206675747572652c2073756e73637265656e20776f756c642062652069742e
[test] decryption is a success
test_aes_gcm_0()
[test] expected output cipher is 58e2fccefa7e3061367f1d57a4e7455a
[test] computed output cipher is 58e2fccefa7e3061367f1d57a4e7455a
[test] cipher is a success
[test] expected output decryption is 
[test] computed output decryption is 
[test] decryption is a success
test_aes_gcm_1()
[test] expected output cipher is 530f8afbc74536b9a963b4f1c4cb738b
[test] computed output cipher is 530f8afbc74536b9a963b4f1c4cb738b
[test] cipher is a success
[test] expected output decryption is 
[test] computed output decryption is 
[test] decryption is a success
test_aes_gcm_2()
[test] expected output cipher is cea7403d4d606b6e074ec5d3baf39d18d0d1c8a799996bf0265b98b5d48ab919
[test] computed output cipher is cea7403d4d606b6e074ec5d3baf39d18d0d1c8a799996bf0265b98b5d48ab919
[test] cipher is a success
[test] expected output decryption is 00000000000000000000000000000000
[test] computed output decryption is 00000000000000000000000000000000
[test] decryption is a success
test_aes_gcm_3()
[test] expected output cipher is 522dc1f099567d07f47f37a32a84427d643a8cdcbfe5c0c97598a2bd2555d1aa8cb08e48590dbb3da7b08b1056828838c5f61e6393ba7a0abcc9f662898015adb094dac5d93471bdec1a502270e3cc6c
[test] computed output cipher is 522dc1f099567d07f47f37a32a84427d643a8cdcbfe5c0c97598a2bd2555d1aa8cb08e48590dbb3da7b08b1056828838c5f61e6393ba7a0abcc9f662898015adb094dac5d93471bdec1a502270e3cc6c
[test] cipher is a success
[test] expected output decryption is d9313225f88406e5a55909c5aff5269a86a7a9531534f7da2e4c303d8a318a721c3c0c95956809532fcf0e2449a6b525b16aedf5aa0de657ba637b391aafd255
[test] computed output decryption is d9313225f88406e5a55909c5aff5269a86a7a9531534f7da2e4c303d8a318a721c3c0c95956809532fcf0e2449a6b525b16aedf5aa0de657ba637b391aafd255
[test] decryption is a success
test_aes_gcm_4()
[test] expected output cipher is 522dc1f099567d07f47f37a32a84427d643a8cdcbfe5c0c97598a2bd2555d1aa8cb08e48590dbb3da7b08b1056828838c5f61e6393ba7a0abcc9f66276fc6ece0f4e1768cddf8853bb2d551b
[test] computed output cipher is 522dc1f099567d07f47f37a32a84427d643a8cdcbfe5c0c97598a2bd2555d1aa8cb08e48590dbb3da7b08b1056828838c5f61e6393ba7a0abcc9f66276fc6ece0f4e1768cddf8853bb2d551b
[test] cipher is a success
[test] expected output decryption is d9313225f88406e5a55909c5aff5269a86a7a9531534f7da2e4c303d8a318a721c3c0c95956809532fcf0e2449a6b525b16aedf5aa0de657ba637b39
[test] computed output decryption is d9313225f88406e5a55909c5aff5269a86a7a9531534f7da2e4c303d8a318a721c3c0c95956809532fcf0e2449a6b525b16aedf5aa0de657ba637b39
[test] decryption is a success
make: Entering directory '/cygdrive/c/build/agent1/_work/13/s/hacl-star/secure_api'
C:/build/agent1/_work/13/s/FStar/bin/fstar.exe --print_z3_statistics --use_hints --query_stats --cache_dir ../secure_api/out/runtime_switch/cache --cache_checked_modules --include ../specs --include ../code/bignum --include ../code/experimental/aesgcm --include ../code/lib/kremlin --include ../code/poly1305 --include ../code/hash --include ../code/salsa-family --include C:/build/agent1/_work/13/s/kremlin/kremlib --include ../secure_api --include ../secure_api/aead --include ../secure_api/prf --include ../secure_api/hkdf --include ../secure_api/vale --include ../secure_api/uf1cma --include ../secure_api/utils --include ../secure_api/LowCProvider/fst --include C:/build/agent1/_work/13/s/FStar/contrib/CoreCrypto/fst --include ../secure_api/concrete_specializations --include ../secure_api/concrete_specializations/runtime_switch --include ../secure_api/test --odir ../secure_api/out/runtime_switch/extracted --use_hints --lax \
prims.fst \
--codegen Kremlin \
--extract_module prims
All verification conditions discharged successfully
TOTAL TIME 45 ms: C:\build\agent1\_work\13\s\FStar\bin\fstar.exe --print_z3_statistics --use_hints --query_stats --cache_dir ../secure_api/out/runtime_switch/cache --cache_checked_modules --include ../specs --include ../code/bignum --include ../code/experimental/aesgcm --include ../code/lib/kremlin --include ../code/poly1305 --include ../code/hash --include ../code/salsa-family --include C:/build/agent1/_work/13/s/kremlin/kremlib --include ../secure_api --include ../secure_api/aead --include ../secure_api/prf --include ../secure_api/hkdf --include ../secure_api/vale --include ../secure_api/uf1cma --include ../secure_api/utils --include ../secure_api/LowCProvider/fst --include C:/build/agent1/_work/13/s/FStar/contrib/CoreCrypto/fst --include ../secure_api/concrete_specializations --include ../secure_api/concrete_specializations/runtime_switch --include ../secure_api/test --odir ../secure_api/out/runtime_switch/extracted --use_hints --lax prims.fst --codegen Kremlin --extract_module prims
C:/build/agent1/_work/13/s/kremlin/krml -falloca -ftail-calls -no-prefix KrmlTest -bundle \
Hacl.Impl.Poly1305_64+Hacl.Impl.Chacha20=Hacl.*,Spec,Spec.* -bundle \
Crypto.AEAD.Main=Crypto.* -tmpdir ../secure_api/out/runtime_switch/extracted \
-add-include '"kremlin/internal/compat.h"' \
../secure_api/out/runtime_switch/extracted/prims.krml ../secure_api/out/runtime_switch/extracted/FStar_Pervasives_Native.krml ../secure_api/out/runtime_switch/extracted/FStar_Pervasives.krml ../secure_api/out/runtime_switch/extracted/FStar_Mul.krml ../secure_api/out/runtime_switch/extracted/FStar_Math_Lib.krml ../secure_api/out/runtime_switch/extracted/FStar_Math_Lemmas.krml ../secure_api/out/runtime_switch/extracted/FStar_Squash.krml ../secure_api/out/runtime_switch/extracted/FStar_StrongExcludedMiddle.krml ../secure_api/out/runtime_switch/extracted/FStar_Classical.krml ../secure_api/out/runtime_switch/extracted/FStar_List_Tot_Base.krml ../secure_api/out/runtime_switch/extracted/FStar_List_Tot_Properties.krml ../secure_api/out/runtime_switch/extracted/FStar_List_Tot.krml ../secure_api/out/runtime_switch/extracted/FStar_Seq_Base.krml ../secure_api/out/runtime_switch/extracted/FStar_Seq_Properties.krml ../secure_api/out/runtime_switch/extracted/FStar_Seq.krml ../secure_api/out/runtime_switch/extracted/FStar_BitVector.krml ../secure_api/out/runtime_switch/extracted/FStar_UInt.krml ../secure_api/out/runtime_switch/extracted/FStar_UInt32.krml ../secure_api/out/runtime_switch/extracted/FStar_Int.krml ../secure_api/out/runtime_switch/extracted/FStar_Int64.krml ../secure_api/out/runtime_switch/extracted/FStar_Int63.krml ../secure_api/out/runtime_switch/extracted/FStar_Int32.krml ../secure_api/out/runtime_switch/extracted/FStar_Int16.krml ../secure_api/out/runtime_switch/extracted/FStar_Int8.krml ../secure_api/out/runtime_switch/extracted/FStar_UInt64.krml ../secure_api/out/runtime_switch/extracted/FStar_UInt63.krml ../secure_api/out/runtime_switch/extracted/FStar_UInt16.krml ../secure_api/out/runtime_switch/extracted/FStar_UInt8.krml ../secure_api/out/runtime_switch/extracted/FStar_Int_Cast.krml ../secure_api/out/runtime_switch/extracted/FStar_UInt128.krml ../secure_api/out/runtime_switch/extracted/Hacl_UInt64.krml ../secure_api/out/runtime_switch/extracted/FStar_Preorder.krml ../secure_api/out/runtime_switch/extracted/FStar_Ghost.krml ../secure_api/out/runtime_switch/extracted/FStar_ErasedLogic.krml ../secure_api/out/runtime_switch/extracted/FStar_FunctionalExtensionality.krml ../secure_api/out/runtime_switch/extracted/FStar_Set.krml ../secure_api/out/runtime_switch/extracted/FStar_PropositionalExtensionality.krml ../secure_api/out/runtime_switch/extracted/FStar_PredicateExtensionality.krml ../secure_api/out/runtime_switch/extracted/FStar_TSet.krml ../secure_api/out/runtime_switch/extracted/FStar_Monotonic_Heap.krml ../secure_api/out/runtime_switch/extracted/FStar_Heap.krml ../secure_api/out/runtime_switch/extracted/FStar_Map.krml ../secure_api/out/runtime_switch/extracted/FStar_Monotonic_HyperHeap.krml ../secure_api/out/runtime_switch/extracted/FStar_Monotonic_HyperStack.krml ../secure_api/out/runtime_switch/extracted/FStar_HyperStack.krml ../secure_api/out/runtime_switch/extracted/FStar_Monotonic_Witnessed.krml ../secure_api/out/runtime_switch/extracted/FStar_HyperStack_ST.krml ../secure_api/out/runtime_switch/extracted/FStar_HyperStack_All.krml ../secure_api/out/runtime_switch/extracted/Hacl_UInt128.krml ../secure_api/out/runtime_switch/extracted/Hacl_UInt8.krml ../secure_api/out/runtime_switch/extracted/Hacl_Bignum_Constants.krml ../secure_api/out/runtime_switch/extracted/Hacl_UInt32.krml ../secure_api/out/runtime_switch/extracted/FStar_Int_Cast_Full.krml ../secure_api/out/runtime_switch/extracted/Hacl_Cast.krml ../secure_api/out/runtime_switch/extracted/FStar_Buffer.krml ../secure_api/out/runtime_switch/extracted/Hacl_Bignum_Parameters.krml ../secure_api/out/runtime_switch/extracted/Hacl_Bignum_Wide.krml ../secure_api/out/runtime_switch/extracted/Spec_Loops.krml ../secure_api/out/runtime_switch/extracted/Hacl_Bignum_Limb.krml ../secure_api/out/runtime_switch/extracted/Hacl_Spec_Bignum_Field.krml ../secure_api/out/runtime_switch/extracted/Hacl_Spec_Bignum_Bigint.krml ../secure_api/out/runtime_switch/extracted/Hacl_Spec_Bignum_Modulo.krml ../secure_api/out/runtime_switch/extracted/Hacl_Spec_Bignum_Fproduct.krml ../secure_api/out/runtime_switch/extracted/Hacl_Spec_Bignum_Fmul.krml ../secure_api/out/runtime_switch/extracted/FStar_Endianness.krml ../secure_api/out/runtime_switch/extracted/Spec_Poly1305_Lemmas.krml ../secure_api/out/runtime_switch/extracted/FStar_Kremlin_Endianness.krml ../secure_api/out/runtime_switch/extracted/C_Endianness.krml ../secure_api/out/runtime_switch/extracted/C.krml ../secure_api/out/runtime_switch/extracted/Hacl_UInt16.krml ../secure_api/out/runtime_switch/extracted/Hacl_Spec_Endianness.krml ../secure_api/out/runtime_switch/extracted/Hacl_Endianness.krml ../secure_api/out/runtime_switch/extracted/Spec_Lib.krml ../secure_api/out/runtime_switch/extracted/Seq_Create.krml ../secure_api/out/runtime_switch/extracted/Spec_SHA2_256.krml ../secure_api/out/runtime_switch/extracted/C_Loops.krml ../secure_api/out/runtime_switch/extracted/Hacl_Hash_Lib_LoadStore.krml ../secure_api/out/runtime_switch/extracted/Hacl_Hash_Lib_Create.krml ../secure_api/out/runtime_switch/extracted/Hacl_Impl_SHA2_256_Lemmas.krml ../secure_api/out/runtime_switch/extracted/Hacl_Impl_SHA2_256.krml ../secure_api/out/runtime_switch/extracted/Hacl_Spec_Bignum_Fsum.krml ../secure_api/out/runtime_switch/extracted/Hacl_Bignum_Fsum.krml ../secure_api/out/runtime_switch/extracted/Crypto_AEAD_BufferUtils.krml ../secure_api/out/runtime_switch/extracted/Vale_AES.krml ../secure_api/out/runtime_switch/extracted/Hacl_Impl_Xor_Lemmas.krml ../secure_api/out/runtime_switch/extracted/Spec_CTR_Lemmas.krml ../secure_api/out/runtime_switch/extracted/Spec_CTR.krml ../secure_api/out/runtime_switch/extracted/Hacl_Lib_LoadStore32.krml ../secure_api/out/runtime_switch/extracted/Spec_Chacha20_Lemmas.krml ../secure_api/out/runtime_switch/extracted/Spec_Chacha20.krml ../secure_api/out/runtime_switch/extracted/Hacl_Impl_Chacha20.krml ../secure_api/out/runtime_switch/extracted/Hacl_SecureAPI_Chacha20.krml ../secure_api/out/runtime_switch/extracted/Crypto_Indexing.krml ../secure_api/out/runtime_switch/extracted/Flag.krml ../secure_api/out/runtime_switch/extracted/Crypto_Symmetric_AES.krml ../secure_api/out/runtime_switch/extracted/Crypto_Symmetric_AES128.krml ../secure_api/out/runtime_switch/extracted/FStar_Float.krml ../secure_api/out/runtime_switch/extracted/FStar_Exn.krml ../secure_api/out/runtime_switch/extracted/FStar_ST.krml ../secure_api/out/runtime_switch/extracted/FStar_All.krml ../secure_api/out/runtime_switch/extracted/FStar_IO.krml ../secure_api/out/runtime_switch/extracted/Buffer_Utils.krml ../secure_api/out/runtime_switch/extracted/Crypto_Symmetric_Bytes.krml ../secure_api/out/runtime_switch/extracted/Crypto_Symmetric_Cipher.krml ../secure_api/out/runtime_switch/extracted/C_Nullity.krml ../secure_api/out/runtime_switch/extracted/Hacl_Spec_Bignum_AddAndMultiply.krml ../secure_api/out/runtime_switch/extracted/Spec_Poly1305.krml ../secure_api/out/runtime_switch/extracted/Hacl_Bignum_Modulo.krml ../secure_api/out/runtime_switch/extracted/Hacl_Bignum_Fproduct.krml ../secure_api/out/runtime_switch/extracted/Hacl_Spec_Poly1305_64_State.krml ../secure_api/out/runtime_switch/extracted/Hacl_Spec_Poly1305_64.krml ../secure_api/out/runtime_switch/extracted/Hacl_Impl_Poly1305_64_State.krml ../secure_api/out/runtime_switch/extracted/Hacl_Bignum_Fmul.krml ../secure_api/out/runtime_switch/extracted/Hacl_Bignum_AddAndMultiply.krml ../secure_api/out/runtime_switch/extracted/Hacl_Spe_Poly1305_64.krml ../secure_api/out/runtime_switch/extracted/Hacl_Impl_Poly1305_64.krml ../secure_api/out/runtime_switch/extracted/Spec_GaloisField.krml ../secure_api/out/runtime_switch/extracted/Spec_GF128.krml ../secure_api/out/runtime_switch/extracted/Crypto_Symmetric_GF128.krml ../secure_api/out/runtime_switch/extracted/Crypto_Symmetric_MAC.krml ../secure_api/out/runtime_switch/extracted/Crypto_Symmetric_UF1CMA.krml ../secure_api/out/runtime_switch/extracted/Crypto_Plain.krml ../secure_api/out/runtime_switch/extracted/Crypto_Symmetric_PRF.krml ../secure_api/out/runtime_switch/extracted/Crypto_AEAD_Encoding.krml ../secure_api/out/runtime_switch/extracted/Crypto_AEAD_Invariant.krml ../secure_api/out/runtime_switch/extracted/Crypto_AEAD_Encrypt_Invariant.krml ../secure_api/out/runtime_switch/extracted/Crypto_AEAD_Wrappers_PRF.krml ../secure_api/out/runtime_switch/extracted/Crypto_AEAD_Wrappers_Encoding.krml ../secure_api/out/runtime_switch/extracted/Crypto_AEAD_Wrappers_CMA.krml ../secure_api/out/runtime_switch/extracted/Crypto_AEAD_EnxorDexor.krml ../secure_api/out/runtime_switch/extracted/Crypto_AEAD_Decrypt.krml ../secure_api/out/runtime_switch/extracted/Spec_HMAC_SHA2_256.krml ../secure_api/out/runtime_switch/extracted/Spec_SHA2_512.krml ../secure_api/out/runtime_switch/extracted/Hacl_Impl_SHA2_512_Lemmas.krml ../secure_api/out/runtime_switch/extracted/Hacl_Impl_SHA2_512.krml ../secure_api/out/runtime_switch/extracted/Spec_SHA2_384.krml ../secure_api/out/runtime_switch/extracted/Hacl_Impl_SHA2_384_Lemmas.krml ../secure_api/out/runtime_switch/extracted/Hacl_Impl_SHA2_384.krml ../secure_api/out/runtime_switch/extracted/Crypto_HMAC.krml ../secure_api/out/runtime_switch/extracted/Crypto_AEAD_Encrypt_Ideal_Invariant.krml ../secure_api/out/runtime_switch/extracted/Crypto_AEAD_MAC_Wrapper_Invariant.krml ../secure_api/out/runtime_switch/extracted/Crypto_AEAD_Enxor_Invariant.krml ../secure_api/out/runtime_switch/extracted/Crypto_AEAD_Encrypt.krml ../secure_api/out/runtime_switch/extracted/Crypto_AEAD.krml ../secure_api/out/runtime_switch/extracted/FStar_List.krml ../secure_api/out/runtime_switch/extracted/FStar_Char.krml ../secure_api/out/runtime_switch/extracted/FStar_String.krml ../secure_api/out/runtime_switch/extracted/C_String.krml ../secure_api/out/runtime_switch/extracted/TestLib.krml ../secure_api/out/runtime_switch/extracted/FStar_Bytes.krml ../secure_api/out/runtime_switch/extracted/Crypto_AEAD_Main.krml ../secure_api/out/runtime_switch/extracted/CryptoTypes.krml ../secure_api/out/runtime_switch/extracted/Crypto_HKDF.krml ../secure_api/out/runtime_switch/extracted/HaclProvider.krml ../secure_api/out/runtime_switch/extracted/KrmlTest.krml ../secure_api/out/runtime_switch/extracted/LowCProvider.krml vale/asm/sha256_main_i.o vale/asm/sha256-x86_64.o vale/asm/Vale_Hash_SHA2_256.o vale/asm/vale_aes_glue.o vale/asm/aes-x86_64.o -o ../secure_api/out/runtime_switch/krml-test.exe \
-drop HaclProvider,LowCProvider,CryptoTypes
Warning 10: : -drop is deprecated
use a combination of -bundle and -d reachability to make sure the functions are eliminated as you wish
Warning 6: in top-level declaration Crypto.Plain.create, in file Crypto_AEAD_Main: stack newbuf @1 @0 is a non-constant size, stack-allocated array; this is not supported by CompCert and requires the use of alloca(3) for MSVC
Warning 6: in the definition of keyBuffer, after the definition of h0, in the last element of the sequence, after the definition of macId, in top-level declaration Crypto.Symmetric.PRF.prf_mac, in file Crypto_AEAD_Main: stack newbuf 0uint8 Crypto.Symmetric.UF1CMA.keylen @5 is a non-constant size, stack-allocated array; this is not supported by CompCert and requires the use of alloca(3) for MSVC
Warning 6: in the definition of cipher1, after the definition of cipherlen, in the last element of the sequence, in top-level declaration KrmlTest.test, in file KrmlTest: stack newbuf 0uint8 @0 is a non-constant size, stack-allocated array; this is not supported by CompCert and requires the use of alloca(3) for MSVC
Warning 6: in the definition of cipher1, after the definition of cipherlen, in the last element of the sequence, in top-level declaration KrmlTest.test_aes_gcm, in file KrmlTest: stack newbuf 2uint8 @0 is a non-constant size, stack-allocated array; this is not supported by CompCert and requires the use of alloca(3) for MSVC
Warning 6: in the definition of plain, after the definition of plainlen, in top-level declaration KrmlTest.test_aes_gcm_0, in file KrmlTest: stack newbuf 0uint8 @0 is a non-constant size, stack-allocated array; this is not supported by CompCert and requires the use of alloca(3) for MSVC
Warning 6: in the definition of aad, after the definition of aadlen, in top-level declaration KrmlTest.test_aes_gcm_0, in file KrmlTest: stack newbuf 0uint8 @0 is a non-constant size, stack-allocated array; this is not supported by CompCert and requires the use of alloca(3) for MSVC
Warning 6: in the definition of plain, after the definition of plainlen, in top-level declaration KrmlTest.test_aes_gcm_1, in file KrmlTest: stack newbuf 0uint8 @0 is a non-constant size, stack-allocated array; this is not supported by CompCert and requires the use of alloca(3) for MSVC
Warning 6: in the definition of aad, after the definition of aadlen, in top-level declaration KrmlTest.test_aes_gcm_1, in file KrmlTest: stack newbuf 0uint8 @0 is a non-constant size, stack-allocated array; this is not supported by CompCert and requires the use of alloca(3) for MSVC
Warning 6: in the definition of plain, after the definition of plainlen, in top-level declaration KrmlTest.test_aes_gcm_2, in file KrmlTest: stack newbuf 0uint8 @0 is a non-constant size, stack-allocated array; this is not supported by CompCert and requires the use of alloca(3) for MSVC
Warning 6: in the definition of aad, after the definition of aadlen, in top-level declaration KrmlTest.test_aes_gcm_2, in file KrmlTest: stack newbuf 0uint8 @0 is a non-constant size, stack-allocated array; this is not supported by CompCert and requires the use of alloca(3) for MSVC
Warning 6: in the definition of aad, after the definition of aadlen, in top-level declaration KrmlTest.test_aes_gcm_3, in file KrmlTest: stack newbuf 0uint8 @0 is a non-constant size, stack-allocated array; this is not supported by CompCert and requires the use of alloca(3) for MSVC
[38;5;119m✔[0m [Monomorphization] ⏱️ 78ms
[38;5;119m✔[0m [Inlining] ⏱️ 78ms
[38;5;119m✔[0m [Pattern matches compilation] ⏱️ 63ms
[38;5;119m✔[0m [Simplify 2] ⏱️ 313ms
Warning 14: : FStar.List.Tot.Base.append__uint8_t is recursive but cannot be optimized to a tail-call
Warning 14: : FStar.Seq.Base.create__uint8_t is recursive but cannot be optimized to a tail-call
Warning 14: : Crypto.Symmetric.Bytes.load_bytes is recursive but cannot be optimized to a tail-call
Warning 14: : Crypto.Symmetric.Bytes.load_uint128 is recursive but cannot be optimized to a tail-call
Warning 14: : Crypto.Symmetric.Bytes.store_uint32 is recursive but cannot be optimized to a tail-call
Warning 14: : Crypto.Symmetric.Bytes.store_big32 is recursive but cannot be optimized to a tail-call
Warning 14: : Crypto.Symmetric.Bytes.store_uint128 is recursive but cannot be optimized to a tail-call
Warning 7: : After inlining, Crypto.Symmetric.MAC.update (going into Crypto_AEAD_Main) calls Hacl.Impl.Poly1305_64.State.poly1305_state (going into Hacl_Impl_Poly1305_64_Hacl_Impl_Chacha20) -- removing the static qualifier from Hacl.Impl.Poly1305_64.State.poly1305_state
Warning 8: : After inlining, Crypto.Symmetric.MAC.update (going into Crypto_AEAD_Main) calls Hacl.Impl.Poly1305_64.poly1305_update (going into Hacl_Impl_Poly1305_64_Hacl_Impl_Chacha20). This is a call across translation units but Hacl.Impl.Poly1305_64.poly1305_update has a C "inline" qualifier. The C standard allows removing Hacl.Impl.Poly1305_64.poly1305_update from its translation unit (see C11 6.7.3 §5), and CompCert will do it. 
Warning 8: : After inlining, Crypto.Symmetric.MAC.finish (going into Crypto_AEAD_Main) calls Hacl.Impl.Poly1305_64.poly1305_process_last_block (going into Hacl_Impl_Poly1305_64_Hacl_Impl_Chacha20). This is a call across translation units but Hacl.Impl.Poly1305_64.poly1305_process_last_block has a C "inline" qualifier. The C standard allows removing Hacl.Impl.Poly1305_64.poly1305_process_last_block from its translation unit (see C11 6.7.3 §5), and CompCert will do it. 
Warning 8: : After inlining, Crypto.Symmetric.Cipher.compute (going into Crypto_AEAD_Main) calls Hacl.Impl.Chacha20.setup (going into Hacl_Impl_Poly1305_64_Hacl_Impl_Chacha20). This is a call across translation units but Hacl.Impl.Chacha20.setup has a C "inline" qualifier. The C standard allows removing Hacl.Impl.Chacha20.setup from its translation unit (see C11 6.7.3 §5), and CompCert will do it. 
Warning 8: : After inlining, Crypto.Symmetric.Cipher.compute (going into Crypto_AEAD_Main) calls Hacl.Impl.Chacha20.copy_state (going into Hacl_Impl_Poly1305_64_Hacl_Impl_Chacha20). This is a call across translation units but Hacl.Impl.Chacha20.copy_state has a C "inline" qualifier. The C standard allows removing Hacl.Impl.Chacha20.copy_state from its translation unit (see C11 6.7.3 §5), and CompCert will do it. 
Warning 8: : After inlining, Crypto.Symmetric.Cipher.compute (going into Crypto_AEAD_Main) calls Hacl.Impl.Chacha20.rounds (going into Hacl_Impl_Poly1305_64_Hacl_Impl_Chacha20). This is a call across translation units but Hacl.Impl.Chacha20.rounds has a C "inline" qualifier. The C standard allows removing Hacl.Impl.Chacha20.rounds from its translation unit (see C11 6.7.3 §5), and CompCert will do it. 
[38;5;119m✔[0m [Structs + Simplify 2] ⏱️ 313ms
[38;5;119m✔[0m [Drop] ⏱️ 16ms
Warning 8: : After inlining, Crypto.Symmetric.Cipher.compute (going into Crypto_AEAD_Main) calls Hacl.Impl.Chacha20.sum_states (going into Hacl_Impl_Poly1305_64_Hacl_Impl_Chacha20). This is a call across translation units but Hacl.Impl.Chacha20.sum_states has a C "inline" qualifier. The C standard allows removing Hacl.Impl.Chacha20.sum_states from its translation unit (see C11 6.7.3 §5), and CompCert will do it. 
Warning 7: : After inlining, Crypto.Symmetric.Cipher.compute (going into Crypto_AEAD_Main) calls Hacl.Lib.LoadStore32.uint32s_to_le_bytes (going into Hacl_Impl_Poly1305_64_Hacl_Impl_Chacha20) -- removing the static qualifier from Hacl.Lib.LoadStore32.uint32s_to_le_bytes
Warning 7: : After inlining, KrmlTest.test (going into KrmlTest) calls Crypto.Indexing.id (going into Crypto_AEAD_Main) -- removing the static qualifier from Crypto.Indexing.id
Warning 7: : After inlining, KrmlTest.test (going into KrmlTest) calls Crypto.Indexing.aeadAlg (going into Crypto_AEAD_Main) -- removing the static qualifier from Crypto.Indexing.aeadAlg
Warning 7: : After inlining, KrmlTest.test (going into KrmlTest) calls Crypto.Indexing.testId (going into Crypto_AEAD_Main) -- removing the static qualifier from Crypto.Indexing.testId
Warning 7: : After inlining, KrmlTest.test (going into KrmlTest) calls Crypto.Plain.unsafe_hide_buffer (going into Crypto_AEAD_Main) -- removing the static qualifier from Crypto.Plain.unsafe_hide_buffer
[38;5;119m✔[0m [AstToCStar] ⏱️ 16ms
[38;5;119m✔[0m [CStarToC] ⏱️ <1ms
Warning 7: : After inlining, KrmlTest.test (going into KrmlTest) calls Crypto.Symmetric.Bytes.load_bytes (going into Crypto_AEAD_Main) -- removing the static qualifier from Crypto.Symmetric.Bytes.load_bytes
Warning 7: : After inlining, KrmlTest.test (going into KrmlTest) calls Crypto.Symmetric.Bytes.load_uint128 (going into Crypto_AEAD_Main) -- removing the static qualifier from Crypto.Symmetric.Bytes.load_uint128
Warning 7: : After inlining, KrmlTest.test (going into KrmlTest) calls Crypto.AEAD.Invariant.aead_state (going into Crypto_AEAD_Main) -- removing the static qualifier from Crypto.AEAD.Invariant.aead_state
Warning 7: : After inlining, KrmlTest.test (going into KrmlTest) calls Crypto.Plain.bufferRepr (going into Crypto_AEAD_Main) -- removing the static qualifier from Crypto.Plain.bufferRepr
Warning 7: : After inlining, Flag.cipher_prf (going into Flag) calls Crypto.Indexing.cipherAlg (going into Crypto_AEAD_Main) -- removing the static qualifier from Crypto.Indexing.cipherAlg
Warning 7: : After inlining, Flag.mac_int1cma (going into Flag) calls Crypto.Indexing.macAlg (going into Crypto_AEAD_Main) -- removing the static qualifier from Crypto.Indexing.macAlg
Warning 14: : Crypto.AEAD.Invariant.safelen is not Low*; it uses mathematical integers and runtime checks may fail; rewrite your code to use machine integers, or if you must, use -add-include '"prims_int.h"'; if this declaration is for specification purposes only, consider marking it noextract or using -bundle <name-of-the-module> to only keep reachable definitions.
Warning 14: : Crypto.AEAD.Invariant.maxplain is not Low*; it uses mathematical integers and runtime checks may fail; rewrite your code to use machine integers, or if you must, use -add-include '"prims_int.h"'; if this declaration is for specification purposes only, consider marking it noextract or using -bundle <name-of-the-module> to only keep reachable definitions.
Warning 14: : FStar.Seq.Base.cons__uint8_t is not Low*; it uses a garbage-collected type (e.g. list) and will leak memory; you need to link with a garbage-collector; if this declaration is for specification purposes only, consider marking it noextract or using -bundle <name-of-the-module> to only keep reachable definitions.
Warning 14: : FStar.Seq.Base.append__uint8_t is not Low*; it uses a garbage-collected type (e.g. list) and will leak memory; you need to link with a garbage-collector; if this declaration is for specification purposes only, consider marking it noextract or using -bundle <name-of-the-module> to only keep reachable definitions.
Warning 14: : FStar.Seq.Base.createEmpty__uint8_t is not Low*; it uses a garbage-collected type (e.g. list) and will leak memory; you need to link with a garbage-collector; if this declaration is for specification purposes only, consider marking it noextract or using -bundle <name-of-the-module> to only keep reachable definitions.
Warning 14: : FStar.Seq.Base.seq__uint8_t is not Low*; it uses a garbage-collected type (e.g. list) and will leak memory; you need to link with a garbage-collector; if this declaration is for specification purposes only, consider marking it noextract or using -bundle <name-of-the-module> to only keep reachable definitions.
Warning 14: : Prims.list__uint8_t is not Low*; it uses a garbage-collected type (e.g. list) and will leak memory; you need to link with a garbage-collector; if this declaration is for specification purposes only, consider marking it noextract or using -bundle <name-of-the-module> to only keep reachable definitions.
Warning 14: : Prims.pow2 is not Low*; it uses mathematical integers and runtime checks may fail; rewrite your code to use machine integers, or if you must, use -add-include '"prims_int.h"'; if this declaration is for specification purposes only, consider marking it noextract or using -bundle <name-of-the-module> to only keep reachable definitions.
Warning 14: : Prims.op_LessThanOrEqual is not Low*; it uses mathematical integers and runtime checks may fail; rewrite your code to use machine integers, or if you must, use -add-include '"prims_int.h"'; if this declaration is for specification purposes only, consider marking it noextract or using -bundle <name-of-the-module> to only keep reachable definitions.
Warning 14: : Prims.op_Addition is not Low*; it uses mathematical integers and runtime checks may fail; rewrite your code to use machine integers, or if you must, use -add-include '"prims_int.h"'; if this declaration is for specification purposes only, consider marking it noextract or using -bundle <name-of-the-module> to only keep reachable definitions.
Warning 14: : Prims.op_Subtraction is not Low*; it uses mathematical integers and runtime checks may fail; rewrite your code to use machine integers, or if you must, use -add-include '"prims_int.h"'; if this declaration is for specification purposes only, consider marking it noextract or using -bundle <name-of-the-module> to only keep reachable definitions.
Warning 14: : Prims.op_Multiply is not Low*; it uses mathematical integers and runtime checks may fail; rewrite your code to use machine integers, or if you must, use -add-include '"prims_int.h"'; if this declaration is for specification purposes only, consider marking it noextract or using -bundle <name-of-the-module> to only keep reachable definitions.
Warning 14: : C.String.of_literal is not Low*; it uses F*'s Prims.string type and will leak memory; you need to link with a garbage-collector; if this declaration is for specification purposes only, consider marking it noextract or using -bundle <name-of-the-module> to only keep reachable definitions; if you are looking to use C strings, look into C.String (in kremlib/) and Server (in test/). See the KreMLin tutorial for more information.
[38;5;81m⚙ KreMLin auto-detecting tools.[0m Here's what we found:
[4mreadlink is:[0m readlink
[4mKreMLin called via:[0m C:\build\agent1\_work\13\s\kremlin\_build\src\Kremlin.native
[4mthe Kremlin executable is:[0m C:\build\agent1\_work\13\s\kremlin\_build\src\Kremlin.native
[4mKreMLin home is:[0m C:/build/agent1/_work/13/s/kremlin
[38;5;81m⚙ KreMLin will drive F*.[0m Here's what we found:
read FSTAR_HOME via the environment
[4mfstar converted to windows path:[0m C:/build/agent1/_work/13/s/FStar/bin/fstar.exe
[4mfstar home converted to windows path:[0m C:/build/agent1/_work/13/s/FStar
[4mfstar lib converted to windows path:[0m C:/build/agent1/_work/13/s/FStar/ulib
fstar is on [38;5;202mbranch protz_uint128[0m
[4mfstar is:[0m C:/build/agent1/_work/13/s/FStar/bin/fstar.exe C:/build/agent1/_work/13/s/kremlin/runtime/WasmSupport.fst C:/build/agent1/_work/13/s/FStar/ulib/FStar.UInt128.fst --trace_error --cache_checked_modules --expose_interfaces --include C:/build/agent1/_work/13/s/kremlin/include --include C:/build/agent1/_work/13/s/kremlin/kremlib
[38;5;119m✔[0m [PrettyPrinting] ⏱️ 47ms
KreMLin: wrote out .c files for C_String, TestLib, C_Loops_Spec_Loops, Prims, FStar, Buffer_Utils, C_Endianness, C_Nullity, Vale_AES, Seq_Create, C, Hacl_Impl_Poly1305_64_Hacl_Impl_Chacha20, Crypto_AEAD_Main, KrmlTest, Flag, LowStar
KreMLin: wrote out .h files for C_String, TestLib, C_Loops_Spec_Loops, Prims, FStar, Buffer_Utils, C_Endianness, C_Nullity, Vale_AES, Seq_Create, C, Hacl_Impl_Poly1305_64_Hacl_Impl_Chacha20, Crypto_AEAD_Main, KrmlTest, Flag, LowStar
[38;5;81m⚙ KreMLin will drive the C compiler.[0m Here's what we found:
[4mgcc is:[0m x86_64-w64-mingw32-gcc
[4mx86_64-w64-mingw32-gcc options are:[0m -I C:/build/agent1/_work/13/s/kremlin/include -I C:/build/agent1/_work/13/s/kremlin/kremlib -I ../secure_api/out/runtime_switch/extracted -Wall -Werror -Wno-unused-variable -Wno-unknown-warning-option -Wno-unused-but-set-variable -g -fwrapv -fstack-check -D_BSD_SOURCE -D_DEFAULT_SOURCE -D__USE_MINGW_ANSI_STDIO -Wno-parentheses -std=c11
[38;5;81m⚡ Generating object files[0m
[38;5;119m✔[0m [CC,../secure_api/out/runtime_switch/extracted/C_String.c] (use -verbose to see the output)
[38;5;119m✔[0m [CC,../secure_api/out/runtime_switch/extracted/TestLib.c] (use -verbose to see the output)
[38;5;119m✔[0m [CC,../secure_api/out/runtime_switch/extracted/C_Loops_Spec_Loops.c] (use -verbose to see the output)
[38;5;119m✔[0m [CC,../secure_api/out/runtime_switch/extracted/Prims.c] (use -verbose to see the output)
[38;5;119m✔[0m [CC,../secure_api/out/runtime_switch/extracted/FStar.c] (use -verbose to see the output)
[38;5;119m✔[0m [CC,../secure_api/out/runtime_switch/extracted/Buffer_Utils.c] (use -verbose to see the output)
[38;5;119m✔[0m [CC,../secure_api/out/runtime_switch/extracted/C_Endianness.c] (use -verbose to see the output)
[38;5;119m✔[0m [CC,../secure_api/out/runtime_switch/extracted/C_Nullity.c] (use -verbose to see the output)
[38;5;119m✔[0m [CC,../secure_api/out/runtime_switch/extracted/Vale_AES.c] (use -verbose to see the output)
[38;5;119m✔[0m [CC,../secure_api/out/runtime_switch/extracted/Seq_Create.c] (use -verbose to see the output)
[38;5;119m✔[0m [CC,../secure_api/out/runtime_switch/extracted/C.c] (use -verbose to see the output)
[38;5;119m✔[0m [CC,../secure_api/out/runtime_switch/extracted/Hacl_Impl_Poly1305_64_Hacl_Impl_Chacha20.c] (use -verbose to see the output)
[38;5;119m✔[0m [CC,../secure_api/out/runtime_switch/extracted/Crypto_AEAD_Main.c] (use -verbose to see the output)
[38;5;119m✔[0m [CC,../secure_api/out/runtime_switch/extracted/KrmlTest.c] (use -verbose to see the output)
[38;5;119m✔[0m [CC,../secure_api/out/runtime_switch/extracted/Flag.c] (use -verbose to see the output)
[38;5;119m✔[0m [CC,../secure_api/out/runtime_switch/extracted/LowStar.c] (use -verbose to see the output)
[38;5;119m✔[0m [LD] (use -verbose to see the output)
[38;5;119mAll files linked successfully[0m 👍
./../secure_api/out/runtime_switch/krml-test.exe
test()
[test] expected output cipher is d31a8d34648e60db7b86afbc53ef7ec2a4aded51296e08fea9e2b5a736ee62d63dbea45e8ca9671282fafb69da92728b1a71de0a9e060b2905d6a5b67ecd3b3692ddbd7f2d778b8c9803aee328091b58fab324e4fad675945585808b4831d7bc3ff4def08e4b7a9de576d26586cec64b61161ae10b594f09e26a7e902ecbd0600691
[test] computed output cipher is d31a8d34648e60db7b86afbc53ef7ec2a4aded51296e08fea9e2b5a736ee62d63dbea45e8ca9671282fafb69da92728b1a71de0a9e060b2905d6a5b67ecd3b3692ddbd7f2d778b8c9803aee328091b58fab324e4fad675945585808b4831d7bc3ff4def08e4b7a9de576d26586cec64b61161ae10b594f09e26a7e902ecbd0600691
[test] cipher is a success
[test] expected output decryption is 4c616469657320616e642047656e746c656d656e206f662074686520636c617373206f66202739393a204966204920636f756c64206f6666657220796f75206f6e6c79206f6e652074697020666f7220746865206675747572652c2073756e73637265656e20776f756c642062652069742e
[test] computed output decryption is 4c616469657320616e642047656e746c656d656e206f662074686520636c617373206f66202739393a204966204920636f756c64206f6666657220796f75206f6e6c79206f6e652074697020666f7220746865206675747572652c2073756e73637265656e20776f756c642062652069742e
[test] decryption is a success
test_aes_gcm_0()
[test] expected output cipher is 58e2fccefa7e3061367f1d57a4e7455a
[test] computed output cipher is 58e2fccefa7e3061367f1d57a4e7455a
[test] cipher is a success
[test] expected output decryption is 
[test] computed output decryption is 
[test] decryption is a success
test_aes_gcm_1()
[test] expected output cipher is 530f8afbc74536b9a963b4f1c4cb738b
[test] computed output cipher is 530f8afbc74536b9a963b4f1c4cb738b
[test] cipher is a success
[test] expected output decryption is 
[test] computed output decryption is 
[test] decryption is a success
test_aes_gcm_2()
[test] expected output cipher is cea7403d4d606b6e074ec5d3baf39d18d0d1c8a799996bf0265b98b5d48ab919
[test] computed output cipher is cea7403d4d606b6e074ec5d3baf39d18d0d1c8a799996bf0265b98b5d48ab919
[test] cipher is a success
[test] expected output decryption is 00000000000000000000000000000000
[test] computed output decryption is 00000000000000000000000000000000
[test] decryption is a success
test_aes_gcm_3()
[test] expected output cipher is 522dc1f099567d07f47f37a32a84427d643a8cdcbfe5c0c97598a2bd2555d1aa8cb08e48590dbb3da7b08b1056828838c5f61e6393ba7a0abcc9f662898015adb094dac5d93471bdec1a502270e3cc6c
[test] computed output cipher is 522dc1f099567d07f47f37a32a84427d643a8cdcbfe5c0c97598a2bd2555d1aa8cb08e48590dbb3da7b08b1056828838c5f61e6393ba7a0abcc9f662898015adb094dac5d93471bdec1a502270e3cc6c
[test] cipher is a success
[test] expected output decryption is d9313225f88406e5a55909c5aff5269a86a7a9531534f7da2e4c303d8a318a721c3c0c95956809532fcf0e2449a6b525b16aedf5aa0de657ba637b391aafd255
[test] computed output decryption is d9313225f88406e5a55909c5aff5269a86a7a9531534f7da2e4c303d8a318a721c3c0c95956809532fcf0e2449a6b525b16aedf5aa0de657ba637b391aafd255
[test] decryption is a success
test_aes_gcm_4()
[test] expected output cipher is 522dc1f099567d07f47f37a32a84427d643a8cdcbfe5c0c97598a2bd2555d1aa8cb08e48590dbb3da7b08b1056828838c5f61e6393ba7a0abcc9f66276fc6ece0f4e1768cddf8853bb2d551b
[test] computed output cipher is 522dc1f099567d07f47f37a32a84427d643a8cdcbfe5c0c97598a2bd2555d1aa8cb08e48590dbb3da7b08b1056828838c5f61e6393ba7a0abcc9f66276fc6ece0f4e1768cddf8853bb2d551b
[test] cipher is a success
[test] expected output decryption is d9313225f88406e5a55909c5aff5269a86a7a9531534f7da2e4c303d8a318a721c3c0c95956809532fcf0e2449a6b525b16aedf5aa0de657ba637b39
[test] computed output decryption is d9313225f88406e5a55909c5aff5269a86a7a9531534f7da2e4c303d8a318a721c3c0c95956809532fcf0e2449a6b525b16aedf5aa0de657ba637b39
[test] decryption is a success
make -C C:/build/agent1/_work/13/s/MLCrypto
make[1]: Entering directory '/cygdrive/c/build/agent1/_work/13/s/MLCrypto'
make[1]: Nothing to be done for 'all'.
make[1]: Leaving directory '/cygdrive/c/build/agent1/_work/13/s/MLCrypto'
OCAMLPATH="C:/build/agent1/_work/13/s/FStar/bin" ocamlfind opt -package fstarlib,zarith -g -I C:/build/agent1/_work/13/s/FStar/ulib/ml -c LowCProvider/LowCProvider.ml -I LowCProvider -I ../secure_api/out/runtime_switch -I ../secure_api/out/runtime_switch/extracted -I C:/build/agent1/_work/13/s/MLCrypto -o LowCProvider/LowCProvider.cmx
C:/build/agent1/_work/13/s/kremlin/krml -falloca -ftail-calls -bundle 'Crypto_Symmetric_Bytes=*' -minimal -skip-compilation \
-tmpdir ../secure_api/out/runtime_switch/crypto ../secure_api/out/runtime_switch/extracted/prims.krml ../secure_api/out/runtime_switch/extracted/FStar_Pervasives_Native.krml ../secure_api/out/runtime_switch/extracted/FStar_Pervasives.krml ../secure_api/out/runtime_switch/extracted/FStar_Mul.krml ../secure_api/out/runtime_switch/extracted/FStar_Math_Lib.krml ../secure_api/out/runtime_switch/extracted/FStar_Math_Lemmas.krml ../secure_api/out/runtime_switch/extracted/FStar_Squash.krml ../secure_api/out/runtime_switch/extracted/FStar_StrongExcludedMiddle.krml ../secure_api/out/runtime_switch/extracted/FStar_Classical.krml ../secure_api/out/runtime_switch/extracted/FStar_List_Tot_Base.krml ../secure_api/out/runtime_switch/extracted/FStar_List_Tot_Properties.krml ../secure_api/out/runtime_switch/extracted/FStar_List_Tot.krml ../secure_api/out/runtime_switch/extracted/FStar_Seq_Base.krml ../secure_api/out/runtime_switch/extracted/FStar_Seq_Properties.krml ../secure_api/out/runtime_switch/extracted/FStar_Seq.krml ../secure_api/out/runtime_switch/extracted/FStar_BitVector.krml ../secure_api/out/runtime_switch/extracted/FStar_UInt.krml ../secure_api/out/runtime_switch/extracted/FStar_UInt32.krml ../secure_api/out/runtime_switch/extracted/FStar_Int.krml ../secure_api/out/runtime_switch/extracted/FStar_Int64.krml ../secure_api/out/runtime_switch/extracted/FStar_Int63.krml ../secure_api/out/runtime_switch/extracted/FStar_Int32.krml ../secure_api/out/runtime_switch/extracted/FStar_Int16.krml ../secure_api/out/runtime_switch/extracted/FStar_Int8.krml ../secure_api/out/runtime_switch/extracted/FStar_UInt64.krml ../secure_api/out/runtime_switch/extracted/FStar_UInt63.krml ../secure_api/out/runtime_switch/extracted/FStar_UInt16.krml ../secure_api/out/runtime_switch/extracted/FStar_UInt8.krml ../secure_api/out/runtime_switch/extracted/FStar_Int_Cast.krml ../secure_api/out/runtime_switch/extracted/FStar_UInt128.krml ../secure_api/out/runtime_switch/extracted/Hacl_UInt64.krml ../secure_api/out/runtime_switch/extracted/FStar_Preorder.krml ../secure_api/out/runtime_switch/extracted/FStar_Ghost.krml ../secure_api/out/runtime_switch/extracted/FStar_ErasedLogic.krml ../secure_api/out/runtime_switch/extracted/FStar_FunctionalExtensionality.krml ../secure_api/out/runtime_switch/extracted/FStar_Set.krml ../secure_api/out/runtime_switch/extracted/FStar_PropositionalExtensionality.krml ../secure_api/out/runtime_switch/extracted/FStar_PredicateExtensionality.krml ../secure_api/out/runtime_switch/extracted/FStar_TSet.krml ../secure_api/out/runtime_switch/extracted/FStar_Monotonic_Heap.krml ../secure_api/out/runtime_switch/extracted/FStar_Heap.krml ../secure_api/out/runtime_switch/extracted/FStar_Map.krml ../secure_api/out/runtime_switch/extracted/FStar_Monotonic_HyperHeap.krml ../secure_api/out/runtime_switch/extracted/FStar_Monotonic_HyperStack.krml ../secure_api/out/runtime_switch/extracted/FStar_HyperStack.krml ../secure_api/out/runtime_switch/extracted/FStar_Monotonic_Witnessed.krml ../secure_api/out/runtime_switch/extracted/FStar_HyperStack_ST.krml ../secure_api/out/runtime_switch/extracted/FStar_HyperStack_All.krml ../secure_api/out/runtime_switch/extracted/Hacl_UInt128.krml ../secure_api/out/runtime_switch/extracted/Hacl_UInt8.krml ../secure_api/out/runtime_switch/extracted/Hacl_Bignum_Constants.krml ../secure_api/out/runtime_switch/extracted/Hacl_UInt32.krml ../secure_api/out/runtime_switch/extracted/FStar_Int_Cast_Full.krml ../secure_api/out/runtime_switch/extracted/Hacl_Cast.krml ../secure_api/out/runtime_switch/extracted/FStar_Buffer.krml ../secure_api/out/runtime_switch/extracted/Hacl_Bignum_Parameters.krml ../secure_api/out/runtime_switch/extracted/Hacl_Bignum_Wide.krml ../secure_api/out/runtime_switch/extracted/Spec_Loops.krml ../secure_api/out/runtime_switch/extracted/Hacl_Bignum_Limb.krml ../secure_api/out/runtime_switch/extracted/Hacl_Spec_Bignum_Field.krml ../secure_api/out/runtime_switch/extracted/Hacl_Spec_Bignum_Bigint.krml ../secure_api/out/runtime_switch/extracted/Hacl_Spec_Bignum_Modulo.krml ../secure_api/out/runtime_switch/extracted/Hacl_Spec_Bignum_Fproduct.krml ../secure_api/out/runtime_switch/extracted/Hacl_Spec_Bignum_Fmul.krml ../secure_api/out/runtime_switch/extracted/FStar_Endianness.krml ../secure_api/out/runtime_switch/extracted/Spec_Poly1305_Lemmas.krml ../secure_api/out/runtime_switch/extracted/FStar_Kremlin_Endianness.krml ../secure_api/out/runtime_switch/extracted/C_Endianness.krml ../secure_api/out/runtime_switch/extracted/C.krml ../secure_api/out/runtime_switch/extracted/Hacl_UInt16.krml ../secure_api/out/runtime_switch/extracted/Hacl_Spec_Endianness.krml ../secure_api/out/runtime_switch/extracted/Hacl_Endianness.krml ../secure_api/out/runtime_switch/extracted/Spec_Lib.krml ../secure_api/out/runtime_switch/extracted/Seq_Create.krml ../secure_api/out/runtime_switch/extracted/Spec_SHA2_256.krml ../secure_api/out/runtime_switch/extracted/C_Loops.krml ../secure_api/out/runtime_switch/extracted/Hacl_Hash_Lib_LoadStore.krml ../secure_api/out/runtime_switch/extracted/Hacl_Hash_Lib_Create.krml ../secure_api/out/runtime_switch/extracted/Hacl_Impl_SHA2_256_Lemmas.krml ../secure_api/out/runtime_switch/extracted/Hacl_Impl_SHA2_256.krml ../secure_api/out/runtime_switch/extracted/Hacl_Spec_Bignum_Fsum.krml ../secure_api/out/runtime_switch/extracted/Hacl_Bignum_Fsum.krml ../secure_api/out/runtime_switch/extracted/Crypto_AEAD_BufferUtils.krml ../secure_api/out/runtime_switch/extracted/Vale_AES.krml ../secure_api/out/runtime_switch/extracted/Hacl_Impl_Xor_Lemmas.krml ../secure_api/out/runtime_switch/extracted/Spec_CTR_Lemmas.krml ../secure_api/out/runtime_switch/extracted/Spec_CTR.krml ../secure_api/out/runtime_switch/extracted/Hacl_Lib_LoadStore32.krml ../secure_api/out/runtime_switch/extracted/Spec_Chacha20_Lemmas.krml ../secure_api/out/runtime_switch/extracted/Spec_Chacha20.krml ../secure_api/out/runtime_switch/extracted/Hacl_Impl_Chacha20.krml ../secure_api/out/runtime_switch/extracted/Hacl_SecureAPI_Chacha20.krml ../secure_api/out/runtime_switch/extracted/Crypto_Indexing.krml ../secure_api/out/runtime_switch/extracted/Flag.krml ../secure_api/out/runtime_switch/extracted/Crypto_Symmetric_AES.krml ../secure_api/out/runtime_switch/extracted/Crypto_Symmetric_AES128.krml ../secure_api/out/runtime_switch/extracted/FStar_Float.krml ../secure_api/out/runtime_switch/extracted/FStar_Exn.krml ../secure_api/out/runtime_switch/extracted/FStar_ST.krml ../secure_api/out/runtime_switch/extracted/FStar_All.krml ../secure_api/out/runtime_switch/extracted/FStar_IO.krml ../secure_api/out/runtime_switch/extracted/Buffer_Utils.krml ../secure_api/out/runtime_switch/extracted/Crypto_Symmetric_Bytes.krml ../secure_api/out/runtime_switch/extracted/Crypto_Symmetric_Cipher.krml ../secure_api/out/runtime_switch/extracted/C_Nullity.krml ../secure_api/out/runtime_switch/extracted/Hacl_Spec_Bignum_AddAndMultiply.krml ../secure_api/out/runtime_switch/extracted/Spec_Poly1305.krml ../secure_api/out/runtime_switch/extracted/Hacl_Bignum_Modulo.krml ../secure_api/out/runtime_switch/extracted/Hacl_Bignum_Fproduct.krml ../secure_api/out/runtime_switch/extracted/Hacl_Spec_Poly1305_64_State.krml ../secure_api/out/runtime_switch/extracted/Hacl_Spec_Poly1305_64.krml ../secure_api/out/runtime_switch/extracted/Hacl_Impl_Poly1305_64_State.krml ../secure_api/out/runtime_switch/extracted/Hacl_Bignum_Fmul.krml ../secure_api/out/runtime_switch/extracted/Hacl_Bignum_AddAndMultiply.krml ../secure_api/out/runtime_switch/extracted/Hacl_Spe_Poly1305_64.krml ../secure_api/out/runtime_switch/extracted/Hacl_Impl_Poly1305_64.krml ../secure_api/out/runtime_switch/extracted/Spec_GaloisField.krml ../secure_api/out/runtime_switch/extracted/Spec_GF128.krml ../secure_api/out/runtime_switch/extracted/Crypto_Symmetric_GF128.krml ../secure_api/out/runtime_switch/extracted/Crypto_Symmetric_MAC.krml ../secure_api/out/runtime_switch/extracted/Crypto_Symmetric_UF1CMA.krml ../secure_api/out/runtime_switch/extracted/Crypto_Plain.krml ../secure_api/out/runtime_switch/extracted/Crypto_Symmetric_PRF.krml ../secure_api/out/runtime_switch/extracted/Crypto_AEAD_Encoding.krml ../secure_api/out/runtime_switch/extracted/Crypto_AEAD_Invariant.krml ../secure_api/out/runtime_switch/extracted/Crypto_AEAD_Encrypt_Invariant.krml ../secure_api/out/runtime_switch/extracted/Crypto_AEAD_Wrappers_PRF.krml ../secure_api/out/runtime_switch/extracted/Crypto_AEAD_Wrappers_Encoding.krml ../secure_api/out/runtime_switch/extracted/Crypto_AEAD_Wrappers_CMA.krml ../secure_api/out/runtime_switch/extracted/Crypto_AEAD_EnxorDexor.krml ../secure_api/out/runtime_switch/extracted/Crypto_AEAD_Decrypt.krml ../secure_api/out/runtime_switch/extracted/Spec_HMAC_SHA2_256.krml ../secure_api/out/runtime_switch/extracted/Spec_SHA2_512.krml ../secure_api/out/runtime_switch/extracted/Hacl_Impl_SHA2_512_Lemmas.krml ../secure_api/out/runtime_switch/extracted/Hacl_Impl_SHA2_512.krml ../secure_api/out/runtime_switch/extracted/Spec_SHA2_384.krml ../secure_api/out/runtime_switch/extracted/Hacl_Impl_SHA2_384_Lemmas.krml ../secure_api/out/runtime_switch/extracted/Hacl_Impl_SHA2_384.krml ../secure_api/out/runtime_switch/extracted/Crypto_HMAC.krml ../secure_api/out/runtime_switch/extracted/Crypto_AEAD_Encrypt_Ideal_Invariant.krml ../secure_api/out/runtime_switch/extracted/Crypto_AEAD_MAC_Wrapper_Invariant.krml ../secure_api/out/runtime_switch/extracted/Crypto_AEAD_Enxor_Invariant.krml ../secure_api/out/runtime_switch/extracted/Crypto_AEAD_Encrypt.krml ../secure_api/out/runtime_switch/extracted/Crypto_AEAD.krml ../secure_api/out/runtime_switch/extracted/FStar_List.krml ../secure_api/out/runtime_switch/extracted/FStar_Char.krml ../secure_api/out/runtime_switch/extracted/FStar_String.krml ../secure_api/out/runtime_switch/extracted/C_String.krml ../secure_api/out/runtime_switch/extracted/TestLib.krml ../secure_api/out/runtime_switch/extracted/FStar_Bytes.krml ../secure_api/out/runtime_switch/extracted/Crypto_AEAD_Main.krml ../secure_api/out/runtime_switch/extracted/CryptoTypes.krml ../secure_api/out/runtime_switch/extracted/Crypto_HKDF.krml ../secure_api/out/runtime_switch/extracted/HaclProvider.krml ../secure_api/out/runtime_switch/extracted/KrmlTest.krml ../secure_api/out/runtime_switch/extracted/LowCProvider.krml -add-include '"kremlib.h"' -add-include '"kremlin/internal/compat.h"' \

Warning 6: in the definition of buf, after the definition of m0, in the last element of the sequence, in top-level declaration Crypto.Symmetric.Bytes.random_bytes, in file Crypto_Symmetric_Bytes: stack newbuf 0uint8 @1 is a non-constant size, stack-allocated array; this is not supported by CompCert and requires the use of alloca(3) for MSVC
[38;5;119m✔[0m [Monomorphization] ⏱️ 47ms
[38;5;119m✔[0m [Inlining] ⏱️ 16ms
[38;5;119m✔[0m [Pattern matches compilation] ⏱️ <1ms
[38;5;119m✔[0m [Simplify 2] ⏱️ <1ms
Warning 14: : FStar.List.Tot.Base.length__uint8_t is recursive but cannot be optimized to a tail-call
Warning 14: : FStar.Seq.Base.slice__uint8_t is recursive but cannot be optimized to a tail-call
Warning 14: : FStar.Endianness.little_endian is recursive but cannot be optimized to a tail-call
Warning 14: : FStar.Endianness.big_endian is recursive but cannot be optimized to a tail-call
[38;5;119m✔[0m [Structs + Simplify 2] ⏱️ 16ms
Warning 14: : FStar.List.Tot.Base.append__uint8_t is recursive but cannot be optimized to a tail-call
[38;5;119m✔[0m [Drop] ⏱️ <1ms
Warning 14: : FStar.Seq.Base.create__uint8_t is recursive but cannot be optimized to a tail-call
[38;5;119m✔[0m [AstToCStar] ⏱️ <1ms
Warning 14: : FStar.Endianness.little_bytes is recursive but cannot be optimized to a tail-call
[38;5;119m✔[0m [CStarToC] ⏱️ <1ms
Warning 14: : Crypto.Symmetric.Bytes.load_bytes is recursive but cannot be optimized to a tail-call
Warning 14: : Crypto.Symmetric.Bytes.load_uint32 is recursive but cannot be optimized to a tail-call
Warning 14: : Crypto.Symmetric.Bytes.load_big32 is recursive but cannot be optimized to a tail-call
Warning 14: : Crypto.Symmetric.Bytes.load_big64 is recursive but cannot be optimized to a tail-call
Warning 14: : Crypto.Symmetric.Bytes.load_uint128 is recursive but cannot be optimized to a tail-call
Warning 14: : Crypto.Symmetric.Bytes.load_big128 is recursive but cannot be optimized to a tail-call
Warning 14: : Crypto.Symmetric.Bytes.store_uint32 is recursive but cannot be optimized to a tail-call
Warning 14: : Crypto.Symmetric.Bytes.store_big32 is recursive but cannot be optimized to a tail-call
Warning 14: : Crypto.Symmetric.Bytes.big_bytes is recursive but cannot be optimized to a tail-call
Warning 14: : Crypto.Symmetric.Bytes.store_uint128 is recursive but cannot be optimized to a tail-call
Warning 14: : Crypto.Symmetric.Bytes.store_big128 is recursive but cannot be optimized to a tail-call
Warning 14: : Crypto.Symmetric.Bytes.print_buffer is not Low*; it uses F*'s Prims.string type and will leak memory; you need to link with a garbage-collector; if this declaration is for specification purposes only, consider marking it noextract or using -bundle <name-of-the-module> to only keep reachable definitions; if you are looking to use C strings, look into C.String (in kremlib/) and Server (in test/). See the KreMLin tutorial for more information.
Warning 14: : Crypto.Symmetric.Bytes.hex2 is not Low*; it uses F*'s Prims.string type and will leak memory; you need to link with a garbage-collector; if this declaration is for specification purposes only, consider marking it noextract or using -bundle <name-of-the-module> to only keep reachable definitions; if you are looking to use C strings, look into C.String (in kremlib/) and Server (in test/). See the KreMLin tutorial for more information.
Warning 14: : Crypto.Symmetric.Bytes.hex1 is not Low*; it uses F*'s Prims.string type and will leak memory; you need to link with a garbage-collector; if this declaration is for specification purposes only, consider marking it noextract or using -bundle <name-of-the-module> to only keep reachable definitions; if you are looking to use C strings, look into C.String (in kremlib/) and Server (in test/). See the KreMLin tutorial for more information.
Warning 14: : FStar.IO.debug_print_string is not Low*; it uses F*'s Prims.string type and will leak memory; you need to link with a garbage-collector; if this declaration is for specification purposes only, consider marking it noextract or using -bundle <name-of-the-module> to only keep reachable definitions; if you are looking to use C strings, look into C.String (in kremlib/) and Server (in test/). See the KreMLin tutorial for more information.
Warning 14: : FStar.Seq.Base.append__uint8_t is not Low*; it uses a garbage-collected type (e.g. list) and will leak memory; you need to link with a garbage-collector; if this declaration is for specification purposes only, consider marking it noextract or using -bundle <name-of-the-module> to only keep reachable definitions.
Warning 14: : FStar.Seq.Base.createEmpty__uint8_t is not Low*; it uses a garbage-collected type (e.g. list) and will leak memory; you need to link with a garbage-collector; if this declaration is for specification purposes only, consider marking it noextract or using -bundle <name-of-the-module> to only keep reachable definitions.
Warning 14: : FStar.Seq.Properties.last__uint8_t is not Low*; it uses mathematical integers and runtime checks may fail; rewrite your code to use machine integers, or if you must, use -add-include '"prims_int.h"'; if this declaration is for specification purposes only, consider marking it noextract or using -bundle <name-of-the-module> to only keep reachable definitions.
Warning 14: : FStar.Seq.Base.hd__uint8_t is not Low*; it uses a garbage-collected type (e.g. list) and will leak memory; you need to link with a garbage-collector; if this declaration is for specification purposes only, consider marking it noextract or using -bundle <name-of-the-module> to only keep reachable definitions.
Warning 14: : FStar.Seq.Base.cons__uint8_t is not Low*; it uses a garbage-collected type (e.g. list) and will leak memory; you need to link with a garbage-collector; if this declaration is for specification purposes only, consider marking it noextract or using -bundle <name-of-the-module> to only keep reachable definitions.
Warning 14: : FStar.Seq.Base.tl__uint8_t is not Low*; it uses a garbage-collected type (e.g. list) and will leak memory; you need to link with a garbage-collector; if this declaration is for specification purposes only, consider marking it noextract or using -bundle <name-of-the-module> to only keep reachable definitions.
Warning 14: : FStar.Seq.Base.index__uint8_t is not Low*; it uses a garbage-collected type (e.g. list) and will leak memory; you need to link with a garbage-collector; if this declaration is for specification purposes only, consider marking it noextract or using -bundle <name-of-the-module> to only keep reachable definitions.
Warning 14: : FStar.List.Tot.Base.index__uint8_t is not Low*; it uses mathematical integers and runtime checks may fail; rewrite your code to use machine integers, or if you must, use -add-include '"prims_int.h"'; if this declaration is for specification purposes only, consider marking it noextract or using -bundle <name-of-the-module> to only keep reachable definitions.
Warning 14: : FStar.List.Tot.Base.index__uint8_t is not Low*; it uses a garbage-collected type (e.g. list) and will leak memory; you need to link with a garbage-collector; if this declaration is for specification purposes only, consider marking it noextract or using -bundle <name-of-the-module> to only keep reachable definitions.
Warning 14: : FStar.List.Tot.Base.tl__uint8_t is not Low*; it uses a garbage-collected type (e.g. list) and will leak memory; you need to link with a garbage-collector; if this declaration is for specification purposes only, consider marking it noextract or using -bundle <name-of-the-module> to only keep reachable definitions.
Warning 14: : FStar.List.Tot.Base.tail__uint8_t is not Low*; it uses a garbage-collected type (e.g. list) and will leak memory; you need to link with a garbage-collector; if this declaration is for specification purposes only, consider marking it noextract or using -bundle <name-of-the-module> to only keep reachable definitions.
Warning 14: : FStar.List.Tot.Base.hd__uint8_t is not Low*; it uses a garbage-collected type (e.g. list) and will leak memory; you need to link with a garbage-collector; if this declaration is for specification purposes only, consider marking it noextract or using -bundle <name-of-the-module> to only keep reachable definitions.
Warning 14: : FStar.Seq.Base.length__uint8_t is not Low*; it uses a garbage-collected type (e.g. list) and will leak memory; you need to link with a garbage-collector; if this declaration is for specification purposes only, consider marking it noextract or using -bundle <name-of-the-module> to only keep reachable definitions.
Warning 14: : FStar.Seq.Base.seq__uint8_t is not Low*; it uses a garbage-collected type (e.g. list) and will leak memory; you need to link with a garbage-collector; if this declaration is for specification purposes only, consider marking it noextract or using -bundle <name-of-the-module> to only keep reachable definitions.
Warning 14: : Prims.list__uint8_t is not Low*; it uses a garbage-collected type (e.g. list) and will leak memory; you need to link with a garbage-collector; if this declaration is for specification purposes only, consider marking it noextract or using -bundle <name-of-the-module> to only keep reachable definitions.
Warning 14: : FStar.UInt8.to_string is not Low*; it uses F*'s Prims.string type and will leak memory; you need to link with a garbage-collector; if this declaration is for specification purposes only, consider marking it noextract or using -bundle <name-of-the-module> to only keep reachable definitions; if you are looking to use C strings, look into C.String (in kremlib/) and Server (in test/). See the KreMLin tutorial for more information.
Warning 14: : Prims.strcat is not Low*; it uses F*'s Prims.string type and will leak memory; you need to link with a garbage-collector; if this declaration is for specification purposes only, consider marking it noextract or using -bundle <name-of-the-module> to only keep reachable definitions; if you are looking to use C strings, look into C.String (in kremlib/) and Server (in test/). See the KreMLin tutorial for more information.
Warning 14: : Prims.pow2 is not Low*; it uses mathematical integers and runtime checks may fail; rewrite your code to use machine integers, or if you must, use -add-include '"prims_int.h"'; if this declaration is for specification purposes only, consider marking it noextract or using -bundle <name-of-the-module> to only keep reachable definitions.
Warning 14: : Prims.op_GreaterThan is not Low*; it uses mathematical integers and runtime checks may fail; rewrite your code to use machine integers, or if you must, use -add-include '"prims_int.h"'; if this declaration is for specification purposes only, consider marking it noextract or using -bundle <name-of-the-module> to only keep reachable definitions.
Warning 14: : Prims.op_Modulus is not Low*; it uses mathematical integers and runtime checks may fail; rewrite your code to use machine integers, or if you must, use -add-include '"prims_int.h"'; if this declaration is for specification purposes only, consider marking it noextract or using -bundle <name-of-the-module> to only keep reachable definitions.
Warning 14: : Prims.op_Addition is not Low*; it uses mathematical integers and runtime checks may fail; rewrite your code to use machine integers, or if you must, use -add-include '"prims_int.h"'; if this declaration is for specification purposes only, consider marking it noextract or using -bundle <name-of-the-module> to only keep reachable definitions.
Warning 14: : Prims.op_Subtraction is not Low*; it uses mathematical integers and runtime checks may fail; rewrite your code to use machine integers, or if you must, use -add-include '"prims_int.h"'; if this declaration is for specification purposes only, consider marking it noextract or using -bundle <name-of-the-module> to only keep reachable definitions.
Warning 14: : Prims.op_Division is not Low*; it uses mathematical integers and runtime checks may fail; rewrite your code to use machine integers, or if you must, use -add-include '"prims_int.h"'; if this declaration is for specification purposes only, consider marking it noextract or using -bundle <name-of-the-module> to only keep reachable definitions.
Warning 14: : Prims.op_Multiply is not Low*; it uses mathematical integers and runtime checks may fail; rewrite your code to use machine integers, or if you must, use -add-include '"prims_int.h"'; if this declaration is for specification purposes only, consider marking it noextract or using -bundle <name-of-the-module> to only keep reachable definitions.
[38;5;81m⚙ KreMLin auto-detecting tools.[0m Here's what we found:
[4mreadlink is:[0m readlink
[4mKreMLin called via:[0m C:\build\agent1\_work\13\s\kremlin\_build\src\Kremlin.native
[4mthe Kremlin executable is:[0m C:\build\agent1\_work\13\s\kremlin\_build\src\Kremlin.native
[4mKreMLin home is:[0m C:/build/agent1/_work/13/s/kremlin
[38;5;81m⚙ KreMLin will drive F*.[0m Here's what we found:
read FSTAR_HOME via the environment
[4mfstar converted to windows path:[0m C:/build/agent1/_work/13/s/FStar/bin/fstar.exe
[4mfstar home converted to windows path:[0m C:/build/agent1/_work/13/s/FStar
[4mfstar lib converted to windows path:[0m C:/build/agent1/_work/13/s/FStar/ulib
fstar is on [38;5;202mbranch protz_uint128[0m
[4mfstar is:[0m C:/build/agent1/_work/13/s/FStar/bin/fstar.exe C:/build/agent1/_work/13/s/kremlin/runtime/WasmSupport.fst C:/build/agent1/_work/13/s/FStar/ulib/FStar.UInt128.fst --trace_error --cache_checked_modules --expose_interfaces --include C:/build/agent1/_work/13/s/kremlin/include --include C:/build/agent1/_work/13/s/kremlin/kremlib
[38;5;119m✔[0m [PrettyPrinting] ⏱️ 16ms
KreMLin: wrote out .c files for Crypto_Symmetric_Bytes
KreMLin: wrote out .h files for Crypto_Symmetric_Bytes
C:/build/agent1/_work/13/s/kremlin/krml -falloca -ftail-calls -bundle 'Crypto_AEAD_Main+Crypto_Symmetric_Cipher+Crypto_Indexing=*' -minimal -skip-compilation \
-tmpdir ../secure_api/out/runtime_switch/crypto ../secure_api/out/runtime_switch/extracted/prims.krml ../secure_api/out/runtime_switch/extracted/FStar_Pervasives_Native.krml ../secure_api/out/runtime_switch/extracted/FStar_Pervasives.krml ../secure_api/out/runtime_switch/extracted/FStar_Mul.krml ../secure_api/out/runtime_switch/extracted/FStar_Math_Lib.krml ../secure_api/out/runtime_switch/extracted/FStar_Math_Lemmas.krml ../secure_api/out/runtime_switch/extracted/FStar_Squash.krml ../secure_api/out/runtime_switch/extracted/FStar_StrongExcludedMiddle.krml ../secure_api/out/runtime_switch/extracted/FStar_Classical.krml ../secure_api/out/runtime_switch/extracted/FStar_List_Tot_Base.krml ../secure_api/out/runtime_switch/extracted/FStar_List_Tot_Properties.krml ../secure_api/out/runtime_switch/extracted/FStar_List_Tot.krml ../secure_api/out/runtime_switch/extracted/FStar_Seq_Base.krml ../secure_api/out/runtime_switch/extracted/FStar_Seq_Properties.krml ../secure_api/out/runtime_switch/extracted/FStar_Seq.krml ../secure_api/out/runtime_switch/extracted/FStar_BitVector.krml ../secure_api/out/runtime_switch/extracted/FStar_UInt.krml ../secure_api/out/runtime_switch/extracted/FStar_UInt32.krml ../secure_api/out/runtime_switch/extracted/FStar_Int.krml ../secure_api/out/runtime_switch/extracted/FStar_Int64.krml ../secure_api/out/runtime_switch/extracted/FStar_Int63.krml ../secure_api/out/runtime_switch/extracted/FStar_Int32.krml ../secure_api/out/runtime_switch/extracted/FStar_Int16.krml ../secure_api/out/runtime_switch/extracted/FStar_Int8.krml ../secure_api/out/runtime_switch/extracted/FStar_UInt64.krml ../secure_api/out/runtime_switch/extracted/FStar_UInt63.krml ../secure_api/out/runtime_switch/extracted/FStar_UInt16.krml ../secure_api/out/runtime_switch/extracted/FStar_UInt8.krml ../secure_api/out/runtime_switch/extracted/FStar_Int_Cast.krml ../secure_api/out/runtime_switch/extracted/FStar_UInt128.krml ../secure_api/out/runtime_switch/extracted/Hacl_UInt64.krml ../secure_api/out/runtime_switch/extracted/FStar_Preorder.krml ../secure_api/out/runtime_switch/extracted/FStar_Ghost.krml ../secure_api/out/runtime_switch/extracted/FStar_ErasedLogic.krml ../secure_api/out/runtime_switch/extracted/FStar_FunctionalExtensionality.krml ../secure_api/out/runtime_switch/extracted/FStar_Set.krml ../secure_api/out/runtime_switch/extracted/FStar_PropositionalExtensionality.krml ../secure_api/out/runtime_switch/extracted/FStar_PredicateExtensionality.krml ../secure_api/out/runtime_switch/extracted/FStar_TSet.krml ../secure_api/out/runtime_switch/extracted/FStar_Monotonic_Heap.krml ../secure_api/out/runtime_switch/extracted/FStar_Heap.krml ../secure_api/out/runtime_switch/extracted/FStar_Map.krml ../secure_api/out/runtime_switch/extracted/FStar_Monotonic_HyperHeap.krml ../secure_api/out/runtime_switch/extracted/FStar_Monotonic_HyperStack.krml ../secure_api/out/runtime_switch/extracted/FStar_HyperStack.krml ../secure_api/out/runtime_switch/extracted/FStar_Monotonic_Witnessed.krml ../secure_api/out/runtime_switch/extracted/FStar_HyperStack_ST.krml ../secure_api/out/runtime_switch/extracted/FStar_HyperStack_All.krml ../secure_api/out/runtime_switch/extracted/Hacl_UInt128.krml ../secure_api/out/runtime_switch/extracted/Hacl_UInt8.krml ../secure_api/out/runtime_switch/extracted/Hacl_Bignum_Constants.krml ../secure_api/out/runtime_switch/extracted/Hacl_UInt32.krml ../secure_api/out/runtime_switch/extracted/FStar_Int_Cast_Full.krml ../secure_api/out/runtime_switch/extracted/Hacl_Cast.krml ../secure_api/out/runtime_switch/extracted/FStar_Buffer.krml ../secure_api/out/runtime_switch/extracted/Hacl_Bignum_Parameters.krml ../secure_api/out/runtime_switch/extracted/Hacl_Bignum_Wide.krml ../secure_api/out/runtime_switch/extracted/Spec_Loops.krml ../secure_api/out/runtime_switch/extracted/Hacl_Bignum_Limb.krml ../secure_api/out/runtime_switch/extracted/Hacl_Spec_Bignum_Field.krml ../secure_api/out/runtime_switch/extracted/Hacl_Spec_Bignum_Bigint.krml ../secure_api/out/runtime_switch/extracted/Hacl_Spec_Bignum_Modulo.krml ../secure_api/out/runtime_switch/extracted/Hacl_Spec_Bignum_Fproduct.krml ../secure_api/out/runtime_switch/extracted/Hacl_Spec_Bignum_Fmul.krml ../secure_api/out/runtime_switch/extracted/FStar_Endianness.krml ../secure_api/out/runtime_switch/extracted/Spec_Poly1305_Lemmas.krml ../secure_api/out/runtime_switch/extracted/FStar_Kremlin_Endianness.krml ../secure_api/out/runtime_switch/extracted/C_Endianness.krml ../secure_api/out/runtime_switch/extracted/C.krml ../secure_api/out/runtime_switch/extracted/Hacl_UInt16.krml ../secure_api/out/runtime_switch/extracted/Hacl_Spec_Endianness.krml ../secure_api/out/runtime_switch/extracted/Hacl_Endianness.krml ../secure_api/out/runtime_switch/extracted/Spec_Lib.krml ../secure_api/out/runtime_switch/extracted/Seq_Create.krml ../secure_api/out/runtime_switch/extracted/Spec_SHA2_256.krml ../secure_api/out/runtime_switch/extracted/C_Loops.krml ../secure_api/out/runtime_switch/extracted/Hacl_Hash_Lib_LoadStore.krml ../secure_api/out/runtime_switch/extracted/Hacl_Hash_Lib_Create.krml ../secure_api/out/runtime_switch/extracted/Hacl_Impl_SHA2_256_Lemmas.krml ../secure_api/out/runtime_switch/extracted/Hacl_Impl_SHA2_256.krml ../secure_api/out/runtime_switch/extracted/Hacl_Spec_Bignum_Fsum.krml ../secure_api/out/runtime_switch/extracted/Hacl_Bignum_Fsum.krml ../secure_api/out/runtime_switch/extracted/Crypto_AEAD_BufferUtils.krml ../secure_api/out/runtime_switch/extracted/Vale_AES.krml ../secure_api/out/runtime_switch/extracted/Hacl_Impl_Xor_Lemmas.krml ../secure_api/out/runtime_switch/extracted/Spec_CTR_Lemmas.krml ../secure_api/out/runtime_switch/extracted/Spec_CTR.krml ../secure_api/out/runtime_switch/extracted/Hacl_Lib_LoadStore32.krml ../secure_api/out/runtime_switch/extracted/Spec_Chacha20_Lemmas.krml ../secure_api/out/runtime_switch/extracted/Spec_Chacha20.krml ../secure_api/out/runtime_switch/extracted/Hacl_Impl_Chacha20.krml ../secure_api/out/runtime_switch/extracted/Hacl_SecureAPI_Chacha20.krml ../secure_api/out/runtime_switch/extracted/Crypto_Indexing.krml ../secure_api/out/runtime_switch/extracted/Flag.krml ../secure_api/out/runtime_switch/extracted/Crypto_Symmetric_AES.krml ../secure_api/out/runtime_switch/extracted/Crypto_Symmetric_AES128.krml ../secure_api/out/runtime_switch/extracted/FStar_Float.krml ../secure_api/out/runtime_switch/extracted/FStar_Exn.krml ../secure_api/out/runtime_switch/extracted/FStar_ST.krml ../secure_api/out/runtime_switch/extracted/FStar_All.krml ../secure_api/out/runtime_switch/extracted/FStar_IO.krml ../secure_api/out/runtime_switch/extracted/Buffer_Utils.krml ../secure_api/out/runtime_switch/extracted/Crypto_Symmetric_Bytes.krml ../secure_api/out/runtime_switch/extracted/Crypto_Symmetric_Cipher.krml ../secure_api/out/runtime_switch/extracted/C_Nullity.krml ../secure_api/out/runtime_switch/extracted/Hacl_Spec_Bignum_AddAndMultiply.krml ../secure_api/out/runtime_switch/extracted/Spec_Poly1305.krml ../secure_api/out/runtime_switch/extracted/Hacl_Bignum_Modulo.krml ../secure_api/out/runtime_switch/extracted/Hacl_Bignum_Fproduct.krml ../secure_api/out/runtime_switch/extracted/Hacl_Spec_Poly1305_64_State.krml ../secure_api/out/runtime_switch/extracted/Hacl_Spec_Poly1305_64.krml ../secure_api/out/runtime_switch/extracted/Hacl_Impl_Poly1305_64_State.krml ../secure_api/out/runtime_switch/extracted/Hacl_Bignum_Fmul.krml ../secure_api/out/runtime_switch/extracted/Hacl_Bignum_AddAndMultiply.krml ../secure_api/out/runtime_switch/extracted/Hacl_Spe_Poly1305_64.krml ../secure_api/out/runtime_switch/extracted/Hacl_Impl_Poly1305_64.krml ../secure_api/out/runtime_switch/extracted/Spec_GaloisField.krml ../secure_api/out/runtime_switch/extracted/Spec_GF128.krml ../secure_api/out/runtime_switch/extracted/Crypto_Symmetric_GF128.krml ../secure_api/out/runtime_switch/extracted/Crypto_Symmetric_MAC.krml ../secure_api/out/runtime_switch/extracted/Crypto_Symmetric_UF1CMA.krml ../secure_api/out/runtime_switch/extracted/Crypto_Plain.krml ../secure_api/out/runtime_switch/extracted/Crypto_Symmetric_PRF.krml ../secure_api/out/runtime_switch/extracted/Crypto_AEAD_Encoding.krml ../secure_api/out/runtime_switch/extracted/Crypto_AEAD_Invariant.krml ../secure_api/out/runtime_switch/extracted/Crypto_AEAD_Encrypt_Invariant.krml ../secure_api/out/runtime_switch/extracted/Crypto_AEAD_Wrappers_PRF.krml ../secure_api/out/runtime_switch/extracted/Crypto_AEAD_Wrappers_Encoding.krml ../secure_api/out/runtime_switch/extracted/Crypto_AEAD_Wrappers_CMA.krml ../secure_api/out/runtime_switch/extracted/Crypto_AEAD_EnxorDexor.krml ../secure_api/out/runtime_switch/extracted/Crypto_AEAD_Decrypt.krml ../secure_api/out/runtime_switch/extracted/Spec_HMAC_SHA2_256.krml ../secure_api/out/runtime_switch/extracted/Spec_SHA2_512.krml ../secure_api/out/runtime_switch/extracted/Hacl_Impl_SHA2_512_Lemmas.krml ../secure_api/out/runtime_switch/extracted/Hacl_Impl_SHA2_512.krml ../secure_api/out/runtime_switch/extracted/Spec_SHA2_384.krml ../secure_api/out/runtime_switch/extracted/Hacl_Impl_SHA2_384_Lemmas.krml ../secure_api/out/runtime_switch/extracted/Hacl_Impl_SHA2_384.krml ../secure_api/out/runtime_switch/extracted/Crypto_HMAC.krml ../secure_api/out/runtime_switch/extracted/Crypto_AEAD_Encrypt_Ideal_Invariant.krml ../secure_api/out/runtime_switch/extracted/Crypto_AEAD_MAC_Wrapper_Invariant.krml ../secure_api/out/runtime_switch/extracted/Crypto_AEAD_Enxor_Invariant.krml ../secure_api/out/runtime_switch/extracted/Crypto_AEAD_Encrypt.krml ../secure_api/out/runtime_switch/extracted/Crypto_AEAD.krml ../secure_api/out/runtime_switch/extracted/FStar_List.krml ../secure_api/out/runtime_switch/extracted/FStar_Char.krml ../secure_api/out/runtime_switch/extracted/FStar_String.krml ../secure_api/out/runtime_switch/extracted/C_String.krml ../secure_api/out/runtime_switch/extracted/TestLib.krml ../secure_api/out/runtime_switch/extracted/FStar_Bytes.krml ../secure_api/out/runtime_switch/extracted/Crypto_AEAD_Main.krml ../secure_api/out/runtime_switch/extracted/CryptoTypes.krml ../secure_api/out/runtime_switch/extracted/Crypto_HKDF.krml ../secure_api/out/runtime_switch/extracted/HaclProvider.krml ../secure_api/out/runtime_switch/extracted/KrmlTest.krml ../secure_api/out/runtime_switch/extracted/LowCProvider.krml -add-include '"kremlib.h"' -add-include '"kremlin/internal/compat.h"' \

Warning 6: in the definition of keyBuffer, after the definition of h0, in the last element of the sequence, after the definition of macId, in top-level declaration Crypto.Symmetric.PRF.prf_mac, in file Crypto_AEAD_Main_Crypto_Symmetric_Cipher_Crypto_Indexing: stack newbuf 0uint8 Crypto.Symmetric.UF1CMA.keylen @5 is a non-constant size, stack-allocated array; this is not supported by CompCert and requires the use of alloca(3) for MSVC
[38;5;119m✔[0m [Monomorphization] ⏱️ 63ms
[38;5;119m✔[0m [Inlining] ⏱️ 63ms
[38;5;119m✔[0m [Pattern matches compilation] ⏱️ 47ms
[38;5;119m✔[0m [Simplify 2] ⏱️ 281ms
Warning 14: : Crypto.Symmetric.Bytes.store_uint32 is recursive but cannot be optimized to a tail-call
Warning 14: : Crypto.Symmetric.Bytes.store_big32 is recursive but cannot be optimized to a tail-call
Warning 14: : Crypto.Symmetric.Bytes.store_uint128 is recursive but cannot be optimized to a tail-call
[38;5;119m✔[0m [Structs + Simplify 2] ⏱️ 328ms
[38;5;119m✔[0m [Drop] ⏱️ <1ms
Warning 14: : Crypto.AEAD.Invariant.safelen is not Low*; it uses mathematical integers and runtime checks may fail; rewrite your code to use machine integers, or if you must, use -add-include '"prims_int.h"'; if this declaration is for specification purposes only, consider marking it noextract or using -bundle <name-of-the-module> to only keep reachable definitions.
Warning 14: : Crypto.AEAD.Invariant.maxplain is not Low*; it uses mathematical integers and runtime checks may fail; rewrite your code to use machine integers, or if you must, use -add-include '"prims_int.h"'; if this declaration is for specification purposes only, consider marking it noextract or using -bundle <name-of-the-module> to only keep reachable definitions.
Warning 14: : Prims.pow2 is not Low*; it uses mathematical integers and runtime checks may fail; rewrite your code to use machine integers, or if you must, use -add-include '"prims_int.h"'; if this declaration is for specification purposes only, consider marking it noextract or using -bundle <name-of-the-module> to only keep reachable definitions.
Warning 14: : Prims.op_LessThanOrEqual is not Low*; it uses mathematical integers and runtime checks may fail; rewrite your code to use machine integers, or if you must, use -add-include '"prims_int.h"'; if this declaration is for specification purposes only, consider marking it noextract or using -bundle <name-of-the-module> to only keep reachable definitions.
Warning 14: : Prims.op_Addition is not Low*; it uses mathematical integers and runtime checks may fail; rewrite your code to use machine integers, or if you must, use -add-include '"prims_int.h"'; if this declaration is for specification purposes only, consider marking it noextract or using -bundle <name-of-the-module> to only keep reachable definitions.
[38;5;119m✔[0m [AstToCStar] ⏱️ 16ms
[38;5;119m✔[0m [CStarToC] ⏱️ <1ms
Warning 14: : Prims.op_Multiply is not Low*; it uses mathematical integers and runtime checks may fail; rewrite your code to use machine integers, or if you must, use -add-include '"prims_int.h"'; if this declaration is for specification purposes only, consider marking it noextract or using -bundle <name-of-the-module> to only keep reachable definitions.
[38;5;81m⚙ KreMLin auto-detecting tools.[0m Here's what we found:
[4mreadlink is:[0m readlink
[4mKreMLin called via:[0m C:\build\agent1\_work\13\s\kremlin\_build\src\Kremlin.native
[4mthe Kremlin executable is:[0m C:\build\agent1\_work\13\s\kremlin\_build\src\Kremlin.native
[4mKreMLin home is:[0m C:/build/agent1/_work/13/s/kremlin
[38;5;81m⚙ KreMLin will drive F*.[0m Here's what we found:
read FSTAR_HOME via the environment
[4mfstar converted to windows path:[0m C:/build/agent1/_work/13/s/FStar/bin/fstar.exe
[4mfstar home converted to windows path:[0m C:/build/agent1/_work/13/s/FStar
[4mfstar lib converted to windows path:[0m C:/build/agent1/_work/13/s/FStar/ulib
fstar is on [38;5;202mbranch protz_uint128[0m
[4mfstar is:[0m C:/build/agent1/_work/13/s/FStar/bin/fstar.exe C:/build/agent1/_work/13/s/kremlin/runtime/WasmSupport.fst C:/build/agent1/_work/13/s/FStar/ulib/FStar.UInt128.fst --trace_error --cache_checked_modules --expose_interfaces --include C:/build/agent1/_work/13/s/kremlin/include --include C:/build/agent1/_work/13/s/kremlin/kremlib
[38;5;119m✔[0m [PrettyPrinting] ⏱️ 31ms
KreMLin: wrote out .c files for Crypto_AEAD_Main_Crypto_Symmetric_Cipher_Crypto_Indexing
KreMLin: wrote out .h files for Crypto_AEAD_Main_Crypto_Symmetric_Cipher_Crypto_Indexing
C:/build/agent1/_work/13/s/kremlin/krml -falloca -ftail-calls -bundle 'Crypto_HKDF+Crypto_HMAC=*' -minimal -skip-compilation \
-tmpdir ../secure_api/out/runtime_switch/crypto ../secure_api/out/runtime_switch/extracted/prims.krml ../secure_api/out/runtime_switch/extracted/FStar_Pervasives_Native.krml ../secure_api/out/runtime_switch/extracted/FStar_Pervasives.krml ../secure_api/out/runtime_switch/extracted/FStar_Mul.krml ../secure_api/out/runtime_switch/extracted/FStar_Math_Lib.krml ../secure_api/out/runtime_switch/extracted/FStar_Math_Lemmas.krml ../secure_api/out/runtime_switch/extracted/FStar_Squash.krml ../secure_api/out/runtime_switch/extracted/FStar_StrongExcludedMiddle.krml ../secure_api/out/runtime_switch/extracted/FStar_Classical.krml ../secure_api/out/runtime_switch/extracted/FStar_List_Tot_Base.krml ../secure_api/out/runtime_switch/extracted/FStar_List_Tot_Properties.krml ../secure_api/out/runtime_switch/extracted/FStar_List_Tot.krml ../secure_api/out/runtime_switch/extracted/FStar_Seq_Base.krml ../secure_api/out/runtime_switch/extracted/FStar_Seq_Properties.krml ../secure_api/out/runtime_switch/extracted/FStar_Seq.krml ../secure_api/out/runtime_switch/extracted/FStar_BitVector.krml ../secure_api/out/runtime_switch/extracted/FStar_UInt.krml ../secure_api/out/runtime_switch/extracted/FStar_UInt32.krml ../secure_api/out/runtime_switch/extracted/FStar_Int.krml ../secure_api/out/runtime_switch/extracted/FStar_Int64.krml ../secure_api/out/runtime_switch/extracted/FStar_Int63.krml ../secure_api/out/runtime_switch/extracted/FStar_Int32.krml ../secure_api/out/runtime_switch/extracted/FStar_Int16.krml ../secure_api/out/runtime_switch/extracted/FStar_Int8.krml ../secure_api/out/runtime_switch/extracted/FStar_UInt64.krml ../secure_api/out/runtime_switch/extracted/FStar_UInt63.krml ../secure_api/out/runtime_switch/extracted/FStar_UInt16.krml ../secure_api/out/runtime_switch/extracted/FStar_UInt8.krml ../secure_api/out/runtime_switch/extracted/FStar_Int_Cast.krml ../secure_api/out/runtime_switch/extracted/FStar_UInt128.krml ../secure_api/out/runtime_switch/extracted/Hacl_UInt64.krml ../secure_api/out/runtime_switch/extracted/FStar_Preorder.krml ../secure_api/out/runtime_switch/extracted/FStar_Ghost.krml ../secure_api/out/runtime_switch/extracted/FStar_ErasedLogic.krml ../secure_api/out/runtime_switch/extracted/FStar_FunctionalExtensionality.krml ../secure_api/out/runtime_switch/extracted/FStar_Set.krml ../secure_api/out/runtime_switch/extracted/FStar_PropositionalExtensionality.krml ../secure_api/out/runtime_switch/extracted/FStar_PredicateExtensionality.krml ../secure_api/out/runtime_switch/extracted/FStar_TSet.krml ../secure_api/out/runtime_switch/extracted/FStar_Monotonic_Heap.krml ../secure_api/out/runtime_switch/extracted/FStar_Heap.krml ../secure_api/out/runtime_switch/extracted/FStar_Map.krml ../secure_api/out/runtime_switch/extracted/FStar_Monotonic_HyperHeap.krml ../secure_api/out/runtime_switch/extracted/FStar_Monotonic_HyperStack.krml ../secure_api/out/runtime_switch/extracted/FStar_HyperStack.krml ../secure_api/out/runtime_switch/extracted/FStar_Monotonic_Witnessed.krml ../secure_api/out/runtime_switch/extracted/FStar_HyperStack_ST.krml ../secure_api/out/runtime_switch/extracted/FStar_HyperStack_All.krml ../secure_api/out/runtime_switch/extracted/Hacl_UInt128.krml ../secure_api/out/runtime_switch/extracted/Hacl_UInt8.krml ../secure_api/out/runtime_switch/extracted/Hacl_Bignum_Constants.krml ../secure_api/out/runtime_switch/extracted/Hacl_UInt32.krml ../secure_api/out/runtime_switch/extracted/FStar_Int_Cast_Full.krml ../secure_api/out/runtime_switch/extracted/Hacl_Cast.krml ../secure_api/out/runtime_switch/extracted/FStar_Buffer.krml ../secure_api/out/runtime_switch/extracted/Hacl_Bignum_Parameters.krml ../secure_api/out/runtime_switch/extracted/Hacl_Bignum_Wide.krml ../secure_api/out/runtime_switch/extracted/Spec_Loops.krml ../secure_api/out/runtime_switch/extracted/Hacl_Bignum_Limb.krml ../secure_api/out/runtime_switch/extracted/Hacl_Spec_Bignum_Field.krml ../secure_api/out/runtime_switch/extracted/Hacl_Spec_Bignum_Bigint.krml ../secure_api/out/runtime_switch/extracted/Hacl_Spec_Bignum_Modulo.krml ../secure_api/out/runtime_switch/extracted/Hacl_Spec_Bignum_Fproduct.krml ../secure_api/out/runtime_switch/extracted/Hacl_Spec_Bignum_Fmul.krml ../secure_api/out/runtime_switch/extracted/FStar_Endianness.krml ../secure_api/out/runtime_switch/extracted/Spec_Poly1305_Lemmas.krml ../secure_api/out/runtime_switch/extracted/FStar_Kremlin_Endianness.krml ../secure_api/out/runtime_switch/extracted/C_Endianness.krml ../secure_api/out/runtime_switch/extracted/C.krml ../secure_api/out/runtime_switch/extracted/Hacl_UInt16.krml ../secure_api/out/runtime_switch/extracted/Hacl_Spec_Endianness.krml ../secure_api/out/runtime_switch/extracted/Hacl_Endianness.krml ../secure_api/out/runtime_switch/extracted/Spec_Lib.krml ../secure_api/out/runtime_switch/extracted/Seq_Create.krml ../secure_api/out/runtime_switch/extracted/Spec_SHA2_256.krml ../secure_api/out/runtime_switch/extracted/C_Loops.krml ../secure_api/out/runtime_switch/extracted/Hacl_Hash_Lib_LoadStore.krml ../secure_api/out/runtime_switch/extracted/Hacl_Hash_Lib_Create.krml ../secure_api/out/runtime_switch/extracted/Hacl_Impl_SHA2_256_Lemmas.krml ../secure_api/out/runtime_switch/extracted/Hacl_Impl_SHA2_256.krml ../secure_api/out/runtime_switch/extracted/Hacl_Spec_Bignum_Fsum.krml ../secure_api/out/runtime_switch/extracted/Hacl_Bignum_Fsum.krml ../secure_api/out/runtime_switch/extracted/Crypto_AEAD_BufferUtils.krml ../secure_api/out/runtime_switch/extracted/Vale_AES.krml ../secure_api/out/runtime_switch/extracted/Hacl_Impl_Xor_Lemmas.krml ../secure_api/out/runtime_switch/extracted/Spec_CTR_Lemmas.krml ../secure_api/out/runtime_switch/extracted/Spec_CTR.krml ../secure_api/out/runtime_switch/extracted/Hacl_Lib_LoadStore32.krml ../secure_api/out/runtime_switch/extracted/Spec_Chacha20_Lemmas.krml ../secure_api/out/runtime_switch/extracted/Spec_Chacha20.krml ../secure_api/out/runtime_switch/extracted/Hacl_Impl_Chacha20.krml ../secure_api/out/runtime_switch/extracted/Hacl_SecureAPI_Chacha20.krml ../secure_api/out/runtime_switch/extracted/Crypto_Indexing.krml ../secure_api/out/runtime_switch/extracted/Flag.krml ../secure_api/out/runtime_switch/extracted/Crypto_Symmetric_AES.krml ../secure_api/out/runtime_switch/extracted/Crypto_Symmetric_AES128.krml ../secure_api/out/runtime_switch/extracted/FStar_Float.krml ../secure_api/out/runtime_switch/extracted/FStar_Exn.krml ../secure_api/out/runtime_switch/extracted/FStar_ST.krml ../secure_api/out/runtime_switch/extracted/FStar_All.krml ../secure_api/out/runtime_switch/extracted/FStar_IO.krml ../secure_api/out/runtime_switch/extracted/Buffer_Utils.krml ../secure_api/out/runtime_switch/extracted/Crypto_Symmetric_Bytes.krml ../secure_api/out/runtime_switch/extracted/Crypto_Symmetric_Cipher.krml ../secure_api/out/runtime_switch/extracted/C_Nullity.krml ../secure_api/out/runtime_switch/extracted/Hacl_Spec_Bignum_AddAndMultiply.krml ../secure_api/out/runtime_switch/extracted/Spec_Poly1305.krml ../secure_api/out/runtime_switch/extracted/Hacl_Bignum_Modulo.krml ../secure_api/out/runtime_switch/extracted/Hacl_Bignum_Fproduct.krml ../secure_api/out/runtime_switch/extracted/Hacl_Spec_Poly1305_64_State.krml ../secure_api/out/runtime_switch/extracted/Hacl_Spec_Poly1305_64.krml ../secure_api/out/runtime_switch/extracted/Hacl_Impl_Poly1305_64_State.krml ../secure_api/out/runtime_switch/extracted/Hacl_Bignum_Fmul.krml ../secure_api/out/runtime_switch/extracted/Hacl_Bignum_AddAndMultiply.krml ../secure_api/out/runtime_switch/extracted/Hacl_Spe_Poly1305_64.krml ../secure_api/out/runtime_switch/extracted/Hacl_Impl_Poly1305_64.krml ../secure_api/out/runtime_switch/extracted/Spec_GaloisField.krml ../secure_api/out/runtime_switch/extracted/Spec_GF128.krml ../secure_api/out/runtime_switch/extracted/Crypto_Symmetric_GF128.krml ../secure_api/out/runtime_switch/extracted/Crypto_Symmetric_MAC.krml ../secure_api/out/runtime_switch/extracted/Crypto_Symmetric_UF1CMA.krml ../secure_api/out/runtime_switch/extracted/Crypto_Plain.krml ../secure_api/out/runtime_switch/extracted/Crypto_Symmetric_PRF.krml ../secure_api/out/runtime_switch/extracted/Crypto_AEAD_Encoding.krml ../secure_api/out/runtime_switch/extracted/Crypto_AEAD_Invariant.krml ../secure_api/out/runtime_switch/extracted/Crypto_AEAD_Encrypt_Invariant.krml ../secure_api/out/runtime_switch/extracted/Crypto_AEAD_Wrappers_PRF.krml ../secure_api/out/runtime_switch/extracted/Crypto_AEAD_Wrappers_Encoding.krml ../secure_api/out/runtime_switch/extracted/Crypto_AEAD_Wrappers_CMA.krml ../secure_api/out/runtime_switch/extracted/Crypto_AEAD_EnxorDexor.krml ../secure_api/out/runtime_switch/extracted/Crypto_AEAD_Decrypt.krml ../secure_api/out/runtime_switch/extracted/Spec_HMAC_SHA2_256.krml ../secure_api/out/runtime_switch/extracted/Spec_SHA2_512.krml ../secure_api/out/runtime_switch/extracted/Hacl_Impl_SHA2_512_Lemmas.krml ../secure_api/out/runtime_switch/extracted/Hacl_Impl_SHA2_512.krml ../secure_api/out/runtime_switch/extracted/Spec_SHA2_384.krml ../secure_api/out/runtime_switch/extracted/Hacl_Impl_SHA2_384_Lemmas.krml ../secure_api/out/runtime_switch/extracted/Hacl_Impl_SHA2_384.krml ../secure_api/out/runtime_switch/extracted/Crypto_HMAC.krml ../secure_api/out/runtime_switch/extracted/Crypto_AEAD_Encrypt_Ideal_Invariant.krml ../secure_api/out/runtime_switch/extracted/Crypto_AEAD_MAC_Wrapper_Invariant.krml ../secure_api/out/runtime_switch/extracted/Crypto_AEAD_Enxor_Invariant.krml ../secure_api/out/runtime_switch/extracted/Crypto_AEAD_Encrypt.krml ../secure_api/out/runtime_switch/extracted/Crypto_AEAD.krml ../secure_api/out/runtime_switch/extracted/FStar_List.krml ../secure_api/out/runtime_switch/extracted/FStar_Char.krml ../secure_api/out/runtime_switch/extracted/FStar_String.krml ../secure_api/out/runtime_switch/extracted/C_String.krml ../secure_api/out/runtime_switch/extracted/TestLib.krml ../secure_api/out/runtime_switch/extracted/FStar_Bytes.krml ../secure_api/out/runtime_switch/extracted/Crypto_AEAD_Main.krml ../secure_api/out/runtime_switch/extracted/CryptoTypes.krml ../secure_api/out/runtime_switch/extracted/Crypto_HKDF.krml ../secure_api/out/runtime_switch/extracted/HaclProvider.krml ../secure_api/out/runtime_switch/extracted/KrmlTest.krml ../secure_api/out/runtime_switch/extracted/LowCProvider.krml -add-include '"kremlib.h"' -add-include '"kremlin/internal/compat.h"' \

Warning 6: in the definition of state, after the definition of pos_T, in the last element of the sequence, in top-level declaration Crypto.HKDF.hkdf_expand, in file Crypto_HKDF_Crypto_HMAC: stack newbuf 0uint8 (+,uint32) (+,uint32) @7 @3 @4 is a non-constant size, stack-allocated array; this is not supported by CompCert and requires the use of alloca(3) for MSVC
Warning 6: in the definition of state0, after the definition of h0, in the last element of the sequence, in top-level declaration Crypto.HMAC.hmac_part1, in file Crypto_HKDF_Crypto_HMAC: stack newbuf 0uint32 match @4 with | λ .  SHA256 () ->  137uint32 | λ .  SHA384 () ->  338uint32 | λ .  SHA512 () ->  338uint32 is a non-constant size, stack-allocated array; this is not supported by CompCert and requires the use of alloca(3) for MSVC
Warning 6: in the definition of state1, after the definition of h0, in the last element of the sequence, after the definition of hinit, in top-level declaration Crypto.HMAC.hmac_part2, in file Crypto_HKDF_Crypto_HMAC: stack newbuf 0uint32 match @5 with | λ .  SHA256 () ->  137uint32 | λ .  SHA384 () ->  338uint32 | λ .  SHA512 () ->  338uint32 is a non-constant size, stack-allocated array; this is not supported by CompCert and requires the use of alloca(3) for MSVC
Warning 6: in the definition of ipad, after the definition of h0, in the last element of the sequence, after the definition of h00, in top-level declaration Crypto.HMAC.hmac_core, in file Crypto_HKDF_Crypto_HMAC: stack newbuf 0x36uint8 Crypto.HMAC.block_size @6 is a non-constant size, stack-allocated array; this is not supported by CompCert and requires the use of alloca(3) for MSVC
Warning 6: in the definition of opad, after the definition of ipad, in the last element of the sequence, after the definition of h00, in top-level declaration Crypto.HMAC.hmac_core, in file Crypto_HKDF_Crypto_HMAC: stack newbuf 0x5cuint8 Crypto.HMAC.block_size @7 is a non-constant size, stack-allocated array; this is not supported by CompCert and requires the use of alloca(3) for MSVC
Warning 6: in the definition of nkey, in the last element of the sequence, in top-level declaration Crypto.HMAC.hmac, in file Crypto_HKDF_Crypto_HMAC: stack newbuf 0x00uint8 Crypto.HMAC.block_size @5 is a non-constant size, stack-allocated array; this is not supported by CompCert and requires the use of alloca(3) for MSVC
[38;5;119m✔[0m [Monomorphization] ⏱️ 47ms
[38;5;119m✔[0m [Inlining] ⏱️ 47ms
[38;5;119m✔[0m [Pattern matches compilation] ⏱️ 31ms
[38;5;119m✔[0m [Simplify 2] ⏱️ 47ms
Warning 14: : Crypto.HKDF.hkdf_expand_inner is recursive but cannot be optimized to a tail-call
[38;5;119m✔[0m [Structs + Simplify 2] ⏱️ 94ms
[38;5;119m✔[0m [Drop] ⏱️ <1ms
[38;5;119m✔[0m [AstToCStar] ⏱️ 16ms
[38;5;119m✔[0m [CStarToC] ⏱️ <1ms
[38;5;81m⚙ KreMLin auto-detecting tools.[0m Here's what we found:
[4mreadlink is:[0m readlink
[4mKreMLin called via:[0m C:\build\agent1\_work\13\s\kremlin\_build\src\Kremlin.native
[4mthe Kremlin executable is:[0m C:\build\agent1\_work\13\s\kremlin\_build\src\Kremlin.native
[4mKreMLin home is:[0m C:/build/agent1/_work/13/s/kremlin
[38;5;81m⚙ KreMLin will drive F*.[0m Here's what we found:
read FSTAR_HOME via the environment
[4mfstar converted to windows path:[0m C:/build/agent1/_work/13/s/FStar/bin/fstar.exe
[4mfstar home converted to windows path:[0m C:/build/agent1/_work/13/s/FStar
[4mfstar lib converted to windows path:[0m C:/build/agent1/_work/13/s/FStar/ulib
fstar is on [38;5;202mbranch protz_uint128[0m
[4mfstar is:[0m C:/build/agent1/_work/13/s/FStar/bin/fstar.exe C:/build/agent1/_work/13/s/kremlin/runtime/WasmSupport.fst C:/build/agent1/_work/13/s/FStar/ulib/FStar.UInt128.fst --trace_error --cache_checked_modules --expose_interfaces --include C:/build/agent1/_work/13/s/kremlin/include --include C:/build/agent1/_work/13/s/kremlin/kremlib
[38;5;119m✔[0m [PrettyPrinting] ⏱️ <1ms
KreMLin: wrote out .c files for Crypto_HKDF_Crypto_HMAC
KreMLin: wrote out .h files for Crypto_HKDF_Crypto_HMAC
OCAMLPATH="C:/build/agent1/_work/13/s/FStar/bin" ocamlfind opt -package fstarlib,zarith -g -I C:/build/agent1/_work/13/s/FStar/ulib/ml -c LowCProvider/lowc_stub.c -I LowCProvider/ -I ../secure_api/out/runtime_switch -I C:/build/agent1/_work/13/s/kremlin/include -I C:/build/agent1/_work/13/s/MLCrypto \
-I ../../mitls-fstar/libs/ffi -ccopt "-o LowCProvider/lowc_stub.o" -I ../code/salsa-family/chacha-c -I ../code/poly1305/poly-c \
-I ../code/curve25519/x25519-c -I ../secure_api/out/runtime_switch/crypto -I ../code/api/aead-c \
-ccopt -Wall -ccopt -Wextra -ccopt -I -ccopt C:/build/agent1/_work/13/s/kremlin/include -ccopt -Wno-unused-variable -ccopt -Wno-unused-parameter -ccopt -Wno-unused-but-set-variable -ccopt -Wno-parentheses -ccopt -Werror -ccopt -Wno-unknown-warning-option
OCAMLPATH="C:/build/agent1/_work/13/s/FStar/bin" ocamlfind opt -package fstarlib,zarith -g -I C:/build/agent1/_work/13/s/FStar/ulib/ml -c ../secure_api/out/runtime_switch/crypto/Crypto_AEAD_Main_Crypto_Symmetric_Cipher_Crypto_Indexing.c -I ../secure_api/out/runtime_switch/crypto/ -I ../secure_api/out/runtime_switch -I C:/build/agent1/_work/13/s/kremlin/include -I C:/build/agent1/_work/13/s/MLCrypto \
-I ../../mitls-fstar/libs/ffi -ccopt "-o ../secure_api/out/runtime_switch/crypto/Crypto_AEAD_Main_Crypto_Symmetric_Cipher_Crypto_Indexing.o" -I ../code/salsa-family/chacha-c -I ../code/poly1305/poly-c \
-I ../code/curve25519/x25519-c -I ../secure_api/out/runtime_switch/crypto -I ../code/api/aead-c \
-ccopt -Wall -ccopt -Wextra -ccopt -I -ccopt C:/build/agent1/_work/13/s/kremlin/include -ccopt -Wno-unused-variable -ccopt -Wno-unused-parameter -ccopt -Wno-unused-but-set-variable -ccopt -Wno-parentheses -ccopt -Werror -ccopt -Wno-unknown-warning-option
OCAMLPATH="C:/build/agent1/_work/13/s/FStar/bin" ocamlfind opt -package fstarlib,zarith -g -I C:/build/agent1/_work/13/s/FStar/ulib/ml -c ../secure_api/out/runtime_switch/crypto/Crypto_HKDF_Crypto_HMAC.c -I ../secure_api/out/runtime_switch/crypto/ -I ../secure_api/out/runtime_switch -I C:/build/agent1/_work/13/s/kremlin/include -I C:/build/agent1/_work/13/s/MLCrypto \
-I ../../mitls-fstar/libs/ffi -ccopt "-o ../secure_api/out/runtime_switch/crypto/Crypto_HKDF_Crypto_HMAC.o" -I ../code/salsa-family/chacha-c -I ../code/poly1305/poly-c \
-I ../code/curve25519/x25519-c -I ../secure_api/out/runtime_switch/crypto -I ../code/api/aead-c \
-ccopt -Wall -ccopt -Wextra -ccopt -I -ccopt C:/build/agent1/_work/13/s/kremlin/include -ccopt -Wno-unused-variable -ccopt -Wno-unused-parameter -ccopt -Wno-unused-but-set-variable -ccopt -Wno-parentheses -ccopt -Werror -ccopt -Wno-unknown-warning-option
OCAMLPATH="C:/build/agent1/_work/13/s/FStar/bin" ocamlfind opt -package fstarlib,zarith -g -I C:/build/agent1/_work/13/s/FStar/ulib/ml -c ../secure_api/out/runtime_switch/crypto/Crypto_Symmetric_Bytes.c -I ../secure_api/out/runtime_switch/crypto/ -I ../secure_api/out/runtime_switch -I C:/build/agent1/_work/13/s/kremlin/include -I C:/build/agent1/_work/13/s/MLCrypto \
-I ../../mitls-fstar/libs/ffi -ccopt "-o ../secure_api/out/runtime_switch/crypto/Crypto_Symmetric_Bytes.o" -I ../code/salsa-family/chacha-c -I ../code/poly1305/poly-c \
-I ../code/curve25519/x25519-c -I ../secure_api/out/runtime_switch/crypto -I ../code/api/aead-c \
-ccopt -Wall -ccopt -Wextra -ccopt -I -ccopt C:/build/agent1/_work/13/s/kremlin/include -ccopt -Wno-unused-variable -ccopt -Wno-unused-parameter -ccopt -Wno-unused-but-set-variable -ccopt -Wno-parentheses -ccopt -Werror -ccopt -Wno-unknown-warning-option
OCAMLPATH="C:/build/agent1/_work/13/s/FStar/bin" ocamlfind mklib -g -I C:/build/agent1/_work/13/s/FStar/ulib/ml -I ../secure_api/out/runtime_switch/extracted vale/asm/sha256_main_i.o vale/asm/sha256-x86_64.o vale/asm/Vale_Hash_SHA2_256.o vale/asm/vale_aes_glue.o vale/asm/aes-x86_64.o LowCProvider/LowCProvider.cmx LowCProvider/HaclProvider.cmx LowCProvider/lowc_stub.o ../secure_api/out/runtime_switch/crypto/Crypto_AEAD_Main_Crypto_Symmetric_Cipher_Crypto_Indexing.o ../secure_api/out/runtime_switch/crypto/Crypto_HKDF_Crypto_HMAC.o ../code/salsa-family/chacha-c/Hacl_Chacha20.o ../code/poly1305/poly-c/AEAD_Poly1305_64.o ../code/api/policies-c/Hacl_Policies.o ../code/api/aead-c/Hacl_Chacha20Poly1305.o ../secure_api/out/runtime_switch/crypto/Crypto_Symmetric_Bytes.o ../code/curve25519/x25519-c/Hacl_Curve25519.o -o ../secure_api/out/runtime_switch/LowC
OCAMLPATH="C:/build/agent1/_work/13/s/FStar/bin" ocamlfind opt -package fstarlib,zarith -g -I C:/build/agent1/_work/13/s/FStar/ulib/ml -c LowCProvider/Tests.ml -I LowCProvider -I ../secure_api/out/runtime_switch -I ../secure_api/out/runtime_switch/extracted -I C:/build/agent1/_work/13/s/MLCrypto -o LowCProvider/Tests.cmx
OCAMLPATH="C:/build/agent1/_work/13/s/FStar/bin" ocamlfind opt -package fstarlib,zarith -g -I C:/build/agent1/_work/13/s/FStar/ulib/ml -I ../secure_api/out/runtime_switch/extracted -I LowCProvider \
-ccopt -L../secure_api/out/runtime_switch -cclib C:/build/agent1/_work/13/s/kremlin/kremlib/out/libkremlib.a -linkpkg C:/build/agent1/_work/13/s/MLCrypto/CryptoTypes.cmx ../secure_api/out/runtime_switch/LowC.cmxa LowCProvider/Tests.cmx -o ../secure_api/out/runtime_switch/LowCTests.exe
./../secure_api/out/runtime_switch/LowCTests.exe
Tests started
Test 1 OK

Test 2 OK

Test 3 OK

Test 4 OK

Test 5 OK

Test 6 OK

Output cipher:	ed3dc05f9d4877f5db78c69c3a8a3d8e8602646a0b2febe4fca07a426a9ace4163cb26eddbb5b0d5f56d7038512ac73d667397d129c3044e0eb8052e
Output tag:	e6f0c7f7b8920ba02a3942df2b8b2a04
cipher:		AES-128-GCM
key:		"feffe9928665731c6d6a8f9467308308"
iv:		"cafebabefacedbad"
aad:		"feedfacedeadbeeffeedfacedeadbeefabaddad2"
tag:		"3612d2e79e3b0785561be14aaca2fccb"
plaintext:	"d9313225f88406e5a55909c5aff5269a86a7a9531534f7da2e4c303d8a318a721c3c0c95956809532fcf0e2449a6b525b16aedf5aa0de657ba637b39"
ciphertext:	"61353b4c2806934a777ff51fa22a4755699b2a714fcdc6f83766e5f97b6c742373806900e49f24b22b097544d4896b424989b5e1ebac0f07c23f4598"

Test 7 failed, but this is expected because |IV| <> 12 bytes and we don't do IV expansion.
Please disregard.

Output cipher:	8076eba01a51d7702d398c6dc3adaaadfe061c23a7ffc3c4623ea2be7a08d982b8f331d21ac6b8db541df43510561a3fff90b942215b7fb6fbcea43d
Output tag:	1606863da7ad74443b3a89fd2489363d
cipher:		AES-128-GCM
key:		"feffe9928665731c6d6a8f9467308308"
iv:		"9313225df88406e555909c5aff5269aa6a7a9538534f7da1e4c303d2a318a728c3c0c95156809539fcf0e2429a6b525416aedbf5a0de6a57a637b39b"
aad:		"feedfacedeadbeeffeedfacedeadbeefabaddad2"
tag:		"619cc5aefffe0bfa462af43c1699d050"
plaintext:	"d9313225f88406e5a55909c5aff5269a86a7a9531534f7da2e4c303d8a318a721c3c0c95956809532fcf0e2449a6b525b16aedf5aa0de657ba637b39"
ciphertext:	"8ce24998625615b603a033aca13fb894be9112a5c3a211a8ba262a3cca7e2ca701e4a9a4fba43c90ccdcb281d48c7c6fd62875d2aca417034c34aee5"

Test 8 failed, but this is expected because |IV| <> 12 bytes and we don't do IV expansion.
Please disregard.

Test 9 OK

Test 10 OK

Test 11 OK

Test 12 OK

Output cipher:	677a374b4dd797f8ea0252a721fa83784f68c4877cf4e60f8c1f56972e9c20f789efb32096dd6336c6e5ef833b041251fdf04ce41fbcf2fea0d1e83c
Output tag:	91b8ee617f7c50dab5bc75abff3bc1c3
cipher:		AES-256-GCM
key:		"feffe9928665731c6d6a8f9467308308feffe9928665731c6d6a8f9467308308"
iv:		"cafebabefacedbad"
aad:		"feedfacedeadbeeffeedfacedeadbeefabaddad2"
tag:		"3a337dbf46a792c45e454913fe2ea8f2"
plaintext:	"d9313225f88406e5a55909c5aff5269a86a7a9531534f7da2e4c303d8a318a721c3c0c95956809532fcf0e2449a6b525b16aedf5aa0de657ba637b39"
ciphertext:	"c3762df1ca787d32ae47c13bf19844cbaf1ae14d0b976afac52ff7d79bba9de0feb582d33934a4f0954cc2363bc73f7862ac430e64abe499f47c9b1f"

Test 13 failed, but this is expected because |IV| <> 12 bytes and we don't do IV expansion.
Please disregard.

Output cipher:	cf3b9ab7a70a2ac55a7bcf74cda369c5b32e7870a937cb4d7679ef877de6403b7126c8ca2d6c620755e8ff330af0e7fa003585282b2d7a3d8f785bcc
Output tag:	881390e147e8fc6b2923305b6413a594
cipher:		AES-256-GCM
key:		"feffe9928665731c6d6a8f9467308308feffe9928665731c6d6a8f9467308308"
iv:		"9313225df88406e555909c5aff5269aa6a7a9538534f7da1e4c303d2a318a728c3c0c95156809539fcf0e2429a6b525416aedbf5a0de6a57a637b39b"
aad:		"feedfacedeadbeeffeedfacedeadbeefabaddad2"
tag:		"a44a8266ee1c8eb0c8b5d4cf5ae9f19a"
plaintext:	"d9313225f88406e5a55909c5aff5269a86a7a9531534f7da2e4c303d8a318a721c3c0c95956809532fcf0e2449a6b525b16aedf5aa0de657ba637b39"
ciphertext:	"5a8def2f0c9e53f1f75d7853659e2a20eeb2b22aafde6419a058ab4f6f746bf40fc0c3b780f244452da3ebf1c5d82cdea2418997200ef82e44ae7e3f"

Test 14 failed, but this is expected because |IV| <> 12 bytes and we don't do IV expansion.
Please disregard.

Test 15 OK

Test 16 OK

Test 17 OK

Test 18 OK

Output cipher:	eff01b40f151144abb70955cedcbe564afd7d338ce2c3eb2ac13b1228ef785edc5bf4b7501cdc522a855c4e5843a3a0af67e4c8285f641951d9dcb727fb5d53bffe8165999884aa1626b20328a233f189b48820f19d2cf1551f21d0ae749227f1d47344d687533456994f11584dfd15d4791ceedf45f3774821bcd340d4b18ec8ed70e7ce40859ec159363caab3eaa87261cbda3733c01bbd39f03f21d3c4f1b3af2cadd75c67fbe96929c20a13077991908a0d23adbcecd49ed2ed71dd8f659
Output tag:	1f200ef9ef5218a0a69331c8304f873d
cipher:		AES-128-GCM
key:		"00000000000000000000000000000000"
iv:		"ffffffff000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000"
aad:		""
tag:		"566f8ef683078bfdeeffa869d751a017"
plaintext:	"000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000"
ciphertext:	"56b3373ca9ef6e4a2b64fe1e9a17b61425f10d47a75a5fce13efc6bc784af24f4141bdd48cf7c770887afd573cca5418a9aeffcd7c5ceddfc6a78397b9a85b499da558257267caab2ad0b23ca476a53cb17fb41c4b8b475cb4f3f7165094c229c9e8c4dc0a2a5ff1903e501511221376a1cdb8364c5061a20cae74bc4acd76ceb0abc9fd3217ef9f8c90be402ddf6d8697f4f880dff15bfb7a6b28241ec8fe183c2d59e3f9dfff653c7126f0acb9e64211f42bae12af462b1070bef1ab5e3606"

Test 19 failed, but this is expected because |IV| <> 12 bytes and we don't do IV expansion.
Please disregard.

Output cipher:	eff01b40f151144abb70955cedcbe564afd7d338ce2c3eb2ac13b1228ef785edc5bf4b7501cdc522a855c4e5843a3a0af67e4c8285f641951d9dcb727fb5d53bffe8165999884aa1626b20328a233f189b48820f19d2cf1551f21d0ae749227f1d47344d687533456994f11584dfd15d4791ceedf45f3774821bcd340d4b18ec8ed70e7ce40859ec159363caab3eaa87261cbda3733c01bbd39f03f21d3c4f1b3af2cadd75c67fbe96929c20a13077991908a0d23adbcecd49ed2ed71dd8f65954f4ff316fe216dd9e29b1ea55824efb884af85d0e6743d586acfc3088f200284dcb744dcf6fe40745827d98067e32af9b279d8f8354d7e47b8bb6736de3b66479f0d1ee5cb7796d966955cc6dea4ae5e4205b07040a0d9ec6594c2c6d2350a4
Output tag:	99b156f6881899ee456476976e9f5414
cipher:		AES-128-GCM
key:		"00000000000000000000000000000000"
iv:		"ffffffff000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000"
aad:		""
tag:		"8b307f6b33286d0ab026a9ed3fe1e85f"
plaintext:	"000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000"
ciphertext:	"56b3373ca9ef6e4a2b64fe1e9a17b61425f10d47a75a5fce13efc6bc784af24f4141bdd48cf7c770887afd573cca5418a9aeffcd7c5ceddfc6a78397b9a85b499da558257267caab2ad0b23ca476a53cb17fb41c4b8b475cb4f3f7165094c229c9e8c4dc0a2a5ff1903e501511221376a1cdb8364c5061a20cae74bc4acd76ceb0abc9fd3217ef9f8c90be402ddf6d8697f4f880dff15bfb7a6b28241ec8fe183c2d59e3f9dfff653c7126f0acb9e64211f42bae12af462b1070bef1ab5e3606872ca10dee15b3249b1a1b958f23134c4bccb7d03200bce420a2f8eb66dcf3644d1423c1b5699003c13ecef4bf38a3b60eedc34033bac1902783dc6d89e2e774188a439c7ebcc0672dbda4ddcfb2794613b0be41315ef778708a70ee7d75165c"

Test 20 failed, but this is expected because |IV| <> 12 bytes and we don't do IV expansion.
Please disregard.

Test 21 OK

AEAD: 21/21 tests passed
OCAMLPATH="C:/build/agent1/_work/13/s/FStar/bin" ocamlfind opt -package fstarlib,zarith -g -I C:/build/agent1/_work/13/s/FStar/ulib/ml -c QuicProvider/test.c -I QuicProvider/ -I ../secure_api/out/runtime_switch -I C:/build/agent1/_work/13/s/kremlin/include -I C:/build/agent1/_work/13/s/MLCrypto \
-I ../../mitls-fstar/libs/ffi -ccopt "-o QuicProvider/test.o" -I ../code/salsa-family/chacha-c -I ../code/poly1305/poly-c \
-I ../code/curve25519/x25519-c -I ../secure_api/out/runtime_switch/crypto -I ../code/api/aead-c \
-ccopt -Wall -ccopt -Wextra -ccopt -I -ccopt C:/build/agent1/_work/13/s/kremlin/include -ccopt -Wno-unused-variable -ccopt -Wno-unused-parameter -ccopt -Wno-unused-but-set-variable -ccopt -Wno-parentheses -ccopt -Werror -ccopt -Wno-unknown-warning-option
OCAMLPATH="C:/build/agent1/_work/13/s/FStar/bin" ocamlfind opt -package fstarlib,zarith -g -I C:/build/agent1/_work/13/s/FStar/ulib/ml -c QuicProvider/quic_provider.c -I QuicProvider/ -I ../secure_api/out/runtime_switch -I C:/build/agent1/_work/13/s/kremlin/include -I C:/build/agent1/_work/13/s/MLCrypto \
-I ../../mitls-fstar/libs/ffi -ccopt "-o QuicProvider/quic_provider.o" -I ../code/salsa-family/chacha-c -I ../code/poly1305/poly-c \
-I ../code/curve25519/x25519-c -I ../secure_api/out/runtime_switch/crypto -I ../code/api/aead-c \
-ccopt -Wall -ccopt -Wextra -ccopt -I -ccopt C:/build/agent1/_work/13/s/kremlin/include -ccopt -Wno-unused-variable -ccopt -Wno-unused-parameter -ccopt -Wno-unused-but-set-variable -ccopt -Wno-parentheses -ccopt -Werror -ccopt -Wno-unknown-warning-option
x86_64-w64-mingw32-gcc vale/asm/sha256_main_i.o vale/asm/sha256-x86_64.o vale/asm/Vale_Hash_SHA2_256.o vale/asm/vale_aes_glue.o vale/asm/aes-x86_64.o QuicProvider/quic_provider.o ../secure_api/out/runtime_switch/crypto/Crypto_AEAD_Main_Crypto_Symmetric_Cipher_Crypto_Indexing.o ../secure_api/out/runtime_switch/crypto/Crypto_Symmetric_Bytes.o ../secure_api/out/runtime_switch/crypto/Crypto_HKDF_Crypto_HMAC.o ../code/salsa-family/chacha-c/Hacl_Chacha20.o ../code/poly1305/poly-c/AEAD_Poly1305_64.o ../code/api/policies-c/Hacl_Policies.o ../code/api/aead-c/Hacl_Chacha20Poly1305.o C:/build/agent1/_work/13/s/kremlin/kremlib/out/libkremlib.a -o ../secure_api/out/runtime_switch/libquicprovider.dll  -shared
x86_64-w64-mingw32-gcc QuicProvider/test.o -o ../secure_api/out/runtime_switch/quicprovider-test.exe -L../secure_api/out/runtime_switch -lquicprovider C:/build/agent1/_work/13/s/kremlin/kremlib/out/libkremlib.a
./../secure_api/out/runtime_switch/quicprovider-test.exe
==== coverage ====
SHA256('') =
e3b0c44298fc1c149afbf4c8996fb92427ae41e4649b934ca495991b7852b855

SHA384('') = 
38b060a751ac96384cd9327eb1b1e36a21fdb71114be07434c0cc7bf63f6e1da
274edebfe76f65fbd51ad2f14898b95b

SHA512('') = 
cf83e1357eefb8bdf1542850d66d8007d620e4050b5715dc83f4a921d36ce9ce
47d0d13c5d85f2b0ff8318d2877eec2f63b931bd47417a81a538327af927da3e
+ cd mitls-fstar/src/tls

HMAC-SHA256('Jefe', 'what do ya want for nothing?') = 
+ make -j 16 test
5bdcc146bf60754e6a042426089575c75a003f089d2739839dec58b964ec3843

HMAC-SHA384('Jefe', 'what do ya want for nothing?') = 
af45d2e376484031617f78d2b58a6b1b9c7ef464f5a01b47e42ec3736322445e
8e2240ca5e69e2c78b3239ecfab21649

HMAC-SHA512('Jefe', 'what do ya want for nothing?') = 
164b7a7bfcf819e2e395fbe73b56e0a387bd64222e831fd610270cd7ea250554
9758bf75c05a994a6d034f65f8f0e6fdcaeab1a34d4a6b4b636e070a38bce737

prk = HKDF-EXTRACT-SHA256('0x000102030405060708090a0b0c', '0x0b0b0b0b0b0b0b0b0b0b0b0b0b0b0b0b0b0b0b0b0b0b')
077709362c2e32df0ddc3f0dc47bba6390b6c73bb50f9c3122ec844ad7c2b3e5
077709362c2e32df0ddc3f0dc47bba6390b6c73bb50f9c3122ec844ad7c2b3e5

okm = HKDF-EXPAND-SHA256(prk, '0xf0f1f2f3f4f5f6f7f8f9', 42)
3cb25f25faacd57a90434f64d0362f2a2d2d0a90cf1a5a4c5db02d56ecc4c5bf
34007208d5b887185865

AES-128-GCM encrypt test:
5936f46d6c7eb7008dbbfb0d40b491fce5328aedcbc0c5272457d347363fd36d
f238bd17971e982f4449350d
PN encryption mask:
a52e332b
DECRYPT SUCCESS: 
7768617420646f2079612077616e7420666f72206e6f7468696e673f

CHACHA20-POLY1305 encrypt test:
a62fe99f3d6001a4f4214a986f04b1f42ea1e5dcea3236ecf35adb5d8cc57db2
df5e18b278c8c904fcddf440
PN encryption mask:
308ac6f5
DECRYPT SUCCESS: 
7768617420646f2079612077616e7420666f72206e6f7468696e673f
==== PASS:  coverage ====


==== test_crypto(TLS_hash_SHA256,TLS_aead_AES_128_GCM) ====
PASS
==== test_crypto(TLS_hash_SHA384,TLS_aead_AES_128_GCM) ====
PASS
==== test_crypto(TLS_hash_SHA512,TLS_aead_AES_128_GCM) ====
PASS
==== test_crypto(TLS_hash_SHA256,TLS_aead_AES_256_GCM) ====
PASS
==== test_crypto(TLS_hash_SHA384,TLS_aead_AES_256_GCM) ====
PASS
==== test_crypto(TLS_hash_SHA512,TLS_aead_AES_256_GCM) ====
PASS
==== test_crypto(TLS_hash_SHA256,TLS_aead_CHACHA20_POLY1305) ====
PASS
==== test_crypto(TLS_hash_SHA384,TLS_aead_CHACHA20_POLY1305) ====
PASS
==== test_crypto(TLS_hash_SHA512,TLS_aead_CHACHA20_POLY1305) ====
PASS
==== test_pn_encrypt() ====
PN encryption mask: fbb4b174
Decrypted PN: c0000000
==== test_handshake_secrets() ====
==== PASS: test_handshake_secrets ==== 
==== ALL TESTS PASS ====
make: Leaving directory '/cygdrive/c/build/agent1/_work/13/s/hacl-star/secure_api'
rm -f cache/OCaml/.depend cache/Kremlin/.depend cache/Model/.depend
make -f Makefile.Model test
make -f Makefile.Kremlin test
make -f Makefile.OCaml test
make -C ../../apps/quicMinusNet test -k
make[1]: Entering directory '/cygdrive/c/build/agent1/_work/13/s/mitls-fstar/apps/quicMinusNet'
x86_64-w64-mingw32-gcc.exe -fPIC -I../../src/tls/extract/Kremlin-Library/include \
quic.c:1:0: warning: -fPIC ignored for target (all code is position independent)
-I../../src/tls/extract/Kremlin-Library/stub -I../../src/pki \
#define __USE_MINGW_ANSI_STDIO 1
-I../../libs/ffi -I/cygdrive/c/build/agent1/_work/13/s/hacl-star/secure_api/QuicProvider \
quic.c \
^
-L/cygdrive/c/build/agent1/_work/13/s/hacl-star/providers/out -L../../src/pki -L../../src/tls/extract/Kremlin-Library -L/cygdrive/c/build/agent1/_work/13/s/hacl-star/secure_api/out/runtime_switch -L/cygdrive/c/build/agent1/_work/13/s/MLCrypto/openssl \
-lmitls -lquicprovider -lmipki -lbcrypt -o quic.exe
make[1]: Leaving directory '/cygdrive/c/build/agent1/_work/13/s/mitls-fstar/apps/quicMinusNet'
make[1]: Entering directory '/cygdrive/c/build/agent1/_work/13/s/mitls-fstar/apps/quicMinusNet'
./quic.exe
server create
FFI| offering custom extension 001a
FFI| extension contents: ffff00050a0b0c0d0e
FFI| setting early data limit to ffffffff
FFI| Setting a new ticket callback.
FFI| Setting a new server negotiation callback.
FFI| Setting up certificate callbacks.
client create
FFI| offering custom extension 001a
FFI| extension contents: ffff00050a0b0c0d0e
FFI| setting early data limit to ffffffff
FFI| Setting a new ticket callback.
FFI| Setting a new server negotiation callback.
FFI| Setting up certificate callbacks.
client call clen=8192 slen=   0
TLS| writeHandshake (plaintext)
TLS| HS.next_fragment PlaintextID?
HS | next_fragment
HS | offering ClientHello 1.3
KS | ks_client_init 1.3
CDH| Keygen (initiator) on X255519
NGO| No PSK or 0-RTT disabled
NGO| offering client extensions [ 001a supported_versions key_share server_name alpn extended_master_secret signature_algorithms supported_groups psk_key_exchange_modes ]
NGO| offering cipher suites ; TLS_CHACHA20_POLY1305_SHA256; TLS_AES_128_GCM_SHA256
HSL| emit ClientHello
TLS| HS.next_fragment returned a fragment
TLS| sendHandshake
TLS| send Handshake fragment with index PlaintextID
TLS| Sending fragment of length 170
REC| record headers: 16030300aa
TLS| writeHandshake (plaintext)
TLS| HS.next_fragment PlaintextID?
HS | next_fragment
TLS| HS.next_fragment returned nothing
TLS| sendHandshake
TLS| read: WrittenHS, Ctrl/Ctrl, nothing
REC| WouldBlock
TLS| readOne ReadWouldBlock
client done clen= 175 slen=   0 status=would_block
16030300aa010000a603035b22f0dbba943ec30d2c3ba4dd5451db54dc16a0e5
b27954c268625b77dca4910000041303130101000079001a0009ffff00050a0b
0c0d0e002b0003027f1c003300260024001d0020aad430ffdb9ebfd2724aa9b5
165354f8f7a5e3535fb69caa49950f290aa36e2d0000000e000c0000096c6f63
616c686f73740010000800060568712d313000170000000d0006000408040403
000a00040002001d002d0003020001
server call clen= 175 slen=8192
TLS| writeHandshake (plaintext)
TLS| HS.next_fragment PlaintextID?
HS | next_fragment
TLS| HS.next_fragment returned nothing
TLS| sendHandshake
TLS| read: WrittenHS, Ctrl/Ctrl, nothing
TLS| Read fragment at epoch index: -1 of length 170
TLS| read Handshake fragment
HS | recv_fragment
HSL| parsed [ClientHello] -- end of flight 
HS | Processing ClientHello
NGO| offered client extensions [ 001a supported_versions key_share server_name alpn extended_master_secret signature_algorithms supported_groups psk_key_exchange_modes ]
NGO| offered cipher suites ; TLS_CHACHA20_POLY1305_SHA256; TLS_AES_128_GCM_SHA256
NGO| offered versions 1.3
NGO| Negotiated Pure EDH key exchange
NGO| Negotiated ECDSA_SECP256R1_SHA256
NGO| Negotiation callback to handle extra extensions and query for stateless retry.
NGO| Application data in cookie: none
@@@@ Nego callback for TLS 1.3 @@@@
Offered extensions:
003d001a0009ffff00050a0b0c0d0e0000000e000c0000096c6f63616c686f73
740010000800060568712d3130000d0006000408040403000a00040002001d
Transport parameters offered:
ffff00050a0b0c0d0e
No application cookie (fist connection).
Adding server transport parameters:
000102
@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
NGO| negotiated 1.3 TLS_CHACHA20_POLY1305_SHA256
KS | ks_server_init
KS | No PSK selected.
KS | Computed early secret:           33ad0a1c607ec03b09e6cd9893680ce210adf300aa1f2660e1b22e10f170f92a
KS | Handshake salt:                  6f2615a108c702c5678f54fc9dbab69716c076189c48250cebeac3576c3611ba
CDH| Keygen (responder) on X255519
CDH| DH initiator on X255519
KS | DH shared secret: 16e2a41ea8daf104b1b011039be96a9e8a8f19a2b1358c32c222875d026d1a63
KS | Handshake secret:                7590c2f022f2c542e99111bcd9b66bef2c2c4b4e2ac8ce28f9db6b9cfdb5a563
NGO| processing client extensions [ 001a supported_versions key_share server_name alpn extended_master_secret signature_algorithms supported_groups psk_key_exchange_modes ]
NGO| including server extensions (SH + EE) [ supported_versions key_share alpn supported_groups ]
NGO| extra extensions from application callback: 001a 
HSL| emit ServerHello and hash
HS | derive handshake keys
KS | ks_server_13_sh, hashed log = 15d5058efd7a1e3273e3a4c23a5c79c0946a8977ea9b37d92a3eaf0e9375f6fb
KS | handshake traffic secret[C]:     52106fa2d0b8f5a5807dc99d8fd40c97bc61a8f92420d3b6c12cfb30968e8c37
KS | handshake traffic secret[S]:     3b2d0f9fc7acbb095824e58f7f172b6d1256bb8d9c5a889a958565c0978a9a9b
KS | handshake key[C]:                b45227ded1e8338d20ed3d64aa2be342263a295917b062e1774b9e96f01d627e, IV=189400788b1f3a0e17adc993
KS | handshake key[S]: c0d22f770d73a2df89a3c3eca85012e74114aeff48796a5236f89279d293e044, IV=51cf8f375ef279e4c49c5827
AEP| LowProvider: COERCE(K=c0d22f770d73a2df89a3c3eca85012e74114aeff48796a5236f89279d293e044)
AEP| LowProvider: COERCE(K=b45227ded1e8338d20ed3d64aa2be342263a295917b062e1774b9e96f01d627e)
KS | finished key[C]:                 ad235256e604f835d1e5b20b8b70f16c5ff19aeb73212575ab0e854eceb510a6
KS | finished key[S]:                 511b286e27ad23598c2fb14f63d1cf2014fbef5d7ef44c7c8bbd0dba52da029c
KS | Application salt:                5ad8aa6b9930fb6e83794e923b5754fbcb910ef5dc221a1009a22a15e1d92bf0
KS | Application secret:              0bcd3c410ae4dc4fb82706e51ec037907799f4ba6f7bbe75e0b9bada3d539c5b
TLS| readOne ReadAgain
TLS| writeHandshake (plaintext)
TLS| HS.next_fragment PlaintextID?
HS | next_fragment
TLS| HS.next_fragment returned a fragment; next_keys (for handshake only
TLS| sendHandshake
TLS| send Handshake fragment with index PlaintextID
TLS| Sending fragment of length 90
REC| record headers: 160303005a
EPO| writer++ -1/0
TLS| writeHandshake (encrypted)
TLS| HS.next_fragment ID13?
HS | next_fragment
HS | prepare Server Finished
HSL| emit EncryptedExtensions
HSL| emit Certificate13 and hash
======== TO BE SIGNED <0403>: (130 octets) ========
2020202020202020202020202020202020202020202020202020202020202020
2020202020202020202020202020202020202020202020202020202020202020
544c5320312e332c207365727665722043657274696669636174655665726966
7900c301e388cfe3f98663bc26e146f1069f098c1c40e9090ed38332ff2f9b43
331c
===================================================
HSL| emit CertificateVerify and hash
HSL| emit Finished and hash
KS | ks_server_13_sf hashed_log = 5fc4adef31ba50abf9cb1ce6a85938de44c9c5e9e6a1c34a5ad3344d0fdfe146
KS | application traffic secret[C]:   84dc7d27f382cf5118eff230332068faea7db7f4ee8b02bac2542f3826a22c82
KS | application traffic secret[S]:   eb2c9bcff69b644d25a0a3cbfe2d303ff8076a9f8484f8daea546d20da13066c
KS | exporter master secret:          b7a4dfd18541c90a822ad3ff81dfd65e8dc6e9bb0756471985d9c1b5dfee21ea
KS | application key[C]:              6f920760066a931cc41583f974a07a72ae2ca36fe61c74fc314f406052f125e1, IV=42208b09e65c60b9052f06ef
KS | application key[S]:              08419387c993aaec2de725722208421b4ca7e210177214b0ab8b820e69e682d1, IV=a03230336d28b5d9650f0e9f
AEP| LowProvider: COERCE(K=08419387c993aaec2de725722208421b4ca7e210177214b0ab8b820e69e682d1)
AEP| LowProvider: COERCE(K=6f920760066a931cc41583f974a07a72ae2ca36fe61c74fc314f406052f125e1)
HS | exporting a key
EPO| reader++ 0/0
TLS| HS.next_fragment returned a fragment; next_keys (for all data)
TLS| sendHandshake
TLS| send Handshake fragment with index ID13
TLS| Encrypting with key c0d22f770d73a2df89a3c3eca85012e74114aeff48796a5236f89279d293e044
TLS| Sending fragment of length 733
REC| record headers: 17030302dd
EPO| writer++ 0/1
TLS| read: WrittenHS, Ctrl/Open, new writer: writable
sender done clen= 175 slen= 833 status=server_accept
160303005a0200005603035b22f0db136b159f4adbe34771f48f788b77365521
64baddc9461f3379d061c200130300002e002b00027f1c00330024001d0020a8
90ae0be5de2d7b34908697f63d3d4719413b281e899fa584d0126ab66d3a0717
030302ddf7acf2adec49c5b2ef685116cbd8cf9460da653603ceb7274b2b4112
1b69769f6aa6128e0ea504ee88009940652d3508325bd2aa90458db36325b8a1
a75372bca0e0eac4de2399336473b8f8679fc000bc2506c053b6edd04392bab3
b1d33f56f30a2acca3fec9a16149a53e973cdbdea1b3a38447e93f2725928294
dce946f61f218f29926da9db019943e4c3ed7fac5653c0cc97c5447edac57eb7
9efd46610a5a3c6b1d366d2737c7df2f46fb81ab9722d91ead49f320bfa00fdc
18afeae2f4107d2a79d1b7f51adc1959bab9c683f08d39abe5d3185f52943e48
f4f9a9026156b7fc8994f8815e9246d4c4a1c6498fa97082ed977d5e0d17fb05
ce64604b4665a6a3e9d118999dbf0b64742eebcb8fb25033161ebe4868665295
81a720cad3e7709b852a99ec8873184ec19b8807eed5122ddbe5ff54f1b95e50
b81e8d887d0ad2fae29709b1616753a0144e7680836b95bfc45dc2bbbf515181
0195f32741c9590dd95bb85ea77eed6677fe5c86299f2f9573e62645b04a67dd
31b0b32cd34458ea97d5ff859701593d5dbe21dc7afbc318c351932d7e2e449e
a27517a5b434222c3c8d8a026437effd40d5dc87c53ded426b4ef90c626b8ce5
12cd38dcb29f0c57d12c77b222540b5b57cd4c50edb22e481e3aa87a8dd8e454
a0f1d4bb4727d0d5f94d9e405674f1d05da6694794c730b1c5645e3b2831885e
e6d213fc0f26cd0aabe6132393368033fa01f7bb0a149d497ce406042c53e25a
d1567fa3105026a614a4cac82ba583efe2faefbbc30c245335b7c4bee7a70725
23712aa2bbdec1f72b52ae857924eb93d4bf98081f9703c915f629688f9ae90f
024d8e307c92c2597ffeab4b6d1e9bc81a70ae10f818e4d945ec74752e28cb48
4f1d62def68870640c64aa0383fa13b5f52dcba4d38b53fa3d1cedda7ebf6a9b
ad676307465128f7ac81546a1cae3eb53315f59e5c8a1f64604ae6934333426a
d57811f24098454975e21d2a28afb65edbdcdef9280fa79fdbe5c043658518f4
67
client call clen=8017 slen= 833
TLS| writeHandshake (plaintext)
TLS| HS.next_fragment PlaintextID?
HS | next_fragment
TLS| HS.next_fragment returned nothing
TLS| sendHandshake
TLS| read: WrittenHS, Ctrl/Ctrl, nothing
TLS| Read fragment at epoch index: -1 of length 90
TLS| read Handshake fragment
HS | recv_fragment
HSL| parsed ServerHello
HSL| end of flight
HS | client_ServerHello
NGO| processing server extensions [ supported_versions key_share ]
NGO| negotiated 1.3 TLS_CHACHA20_POLY1305_SHA256
HS | Running TLS 1.3
KS | ks_client_13_sh hashed_log = 15d5058efd7a1e3273e3a4c23a5c79c0946a8977ea9b37d92a3eaf0e9375f6fb
KS | no PSK negotiated. Early secret: 33ad0a1c607ec03b09e6cd9893680ce210adf300aa1f2660e1b22e10f170f92a
KS | handshake salt:                  6f2615a108c702c5678f54fc9dbab69716c076189c48250cebeac3576c3611ba
CDH| DH initiator on X255519
KS | DH shared secret: 16e2a41ea8daf104b1b011039be96a9e8a8f19a2b1358c32c222875d026d1a63
KS | handshake secret:                7590c2f022f2c542e99111bcd9b66bef2c2c4b4e2ac8ce28f9db6b9cfdb5a563
KS | handshake traffic secret[C]:     52106fa2d0b8f5a5807dc99d8fd40c97bc61a8f92420d3b6c12cfb30968e8c37
KS | handshake traffic secret[S]:     3b2d0f9fc7acbb095824e58f7f172b6d1256bb8d9c5a889a958565c0978a9a9b
KS | handshake key[C]:                b45227ded1e8338d20ed3d64aa2be342263a295917b062e1774b9e96f01d627e, IV=189400788b1f3a0e17adc993
KS | handshake key[S]:                c0d22f770d73a2df89a3c3eca85012e74114aeff48796a5236f89279d293e044, IV=51cf8f375ef279e4c49c5827
KS | finished key[C]: ad235256e604f835d1e5b20b8b70f16c5ff19aeb73212575ab0e854eceb510a6
KS | finished key[S]: 511b286e27ad23598c2fb14f63d1cf2014fbef5d7ef44c7c8bbd0dba52da029c
KS | application salt:                5ad8aa6b9930fb6e83794e923b5754fbcb910ef5dc221a1009a22a15e1d92bf0
KS | application secret:              0bcd3c410ae4dc4fb82706e51ec037907799f4ba6f7bbe75e0b9bada3d539c5b
AEP| LowProvider: COERCE(K=b45227ded1e8338d20ed3d64aa2be342263a295917b062e1774b9e96f01d627e)
AEP| LowProvider: COERCE(K=c0d22f770d73a2df89a3c3eca85012e74114aeff48796a5236f89279d293e044)
EPO| reader++ 0/-1
TLS| readOne ReadAgain
TLS| writeHandshake (plaintext)
TLS| HS.next_fragment PlaintextID?
HS | next_fragment
TLS| HS.next_fragment returned nothing
TLS| sendHandshake
TLS| read: WrittenHS, Ctrl/Ctrl, nothing
TLS| Read fragment at epoch index: 0 of length 733
TLS| StAE decrypt correct.
TLS| read Handshake fragment
HS | recv_fragment
HSL| parsed EncryptedExtensions
HSL| parsed Certificate13
HSL| parsed CertificateVerify
HSL| parsed Finished
HSL| end of flight
NGO| Nego.clientComplete_13
NGO| EE: alpn supported_groups 001a 
NGO| Negotiation callback to process application extensions.
@@@@ Nego callback for TLS 1.3 @@@@
Offered extensions:
001b0010000800060568712d3130000a00040002001d001a0003000102
Transport parameters offered:
000102
No application cookie (fist connection).
Adding server transport parameters:
000102
@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
WARNING: chain validation failed, ignoring.
NGO| Certificate & signature 1.3 callback result: valid
KS | ks_client_13_sf hashed_log = 5fc4adef31ba50abf9cb1ce6a85938de44c9c5e9e6a1c34a5ad3344d0fdfe146
KS | application traffic secret[C]:   84dc7d27f382cf5118eff230332068faea7db7f4ee8b02bac2542f3826a22c82
KS | application traffic secret[S]:   eb2c9bcff69b644d25a0a3cbfe2d303ff8076a9f8484f8daea546d20da13066c
KS | exporter master secret:          b7a4dfd18541c90a822ad3ff81dfd65e8dc6e9bb0756471985d9c1b5dfee21ea
KS | application key[C]:              6f920760066a931cc41583f974a07a72ae2ca36fe61c74fc314f406052f125e1, IV=42208b09e65c60b9052f06ef
KS | application key[S]:              08419387c993aaec2de725722208421b4ca7e210177214b0ab8b820e69e682d1, IV=a03230336d28b5d9650f0e9f
AEP| LowProvider: COERCE(K=6f920760066a931cc41583f974a07a72ae2ca36fe61c74fc314f406052f125e1)
AEP| LowProvider: COERCE(K=08419387c993aaec2de725722208421b4ca7e210177214b0ab8b820e69e682d1)
HS | exporting a key
HS | Early data rejected
EPO| writer++ 0/0
HSL| emit Finished and hash
KS | ks_client_13_cf hashed_log = 3feaea605f435add3601594879a23c89e1387b175a29ee9b16897e7a8288fed2
KS | resumption master secret:        5a1699e65c44722d37972566a820d8128a1c1a046a122a387dcc88543441a065
EPO| reader++ 1/0
TLS| readOne ReadAgain
TLS| writeHandshake (encrypted)
TLS| HS.next_fragment ID13?
HS | next_fragment
TLS| HS.next_fragment returned a fragment; next_keys (for all data); complete
TLS| sendHandshake
TLS| send Handshake fragment with index ID13
TLS| Encrypting with key b45227ded1e8338d20ed3d64aa2be342263a295917b062e1774b9e96f01d627e
TLS| Sending fragment of length 53
REC| record headers: 1703030035
EPO| writer++ 1/1
TLS| read: WrittenHS, Open/Open, new writer: complete
client done clen=  58 slen= 833 status=client_complete
1703030035209cd5d1615e23dc67bbd89e23f2d6ff384c33c5fc1b6bfdfed0bd
5b9533fa96bd8e47efb696e26667fb515a1324de4ed7e97e041e
server call clen=  58 slen=7359
TLS| writeHandshake (encrypted)
TLS| HS.next_fragment ID13?
HS | next_fragment
TLS| HS.next_fragment returned nothing
TLS| sendHandshake
TLS| read: WrittenHS, Ctrl/Open, nothing
TLS| Read fragment at epoch index: 0 of length 53
TLS| StAE decrypt correct.
TLS| read Handshake fragment
HS | recv_fragment
HSL| parsed Finished
HSL| end of flight
HS | Process Client Finished
KS | ks_server_13_cf hashed_log = 3feaea605f435add3601594879a23c89e1387b175a29ee9b16897e7a8288fed2
KS | resumption master secret:        5a1699e65c44722d37972566a820d8128a1c1a046a122a387dcc88543441a065
AEP| LowProvider: COERCE(K=c5d791f1f23a6f255a06746bb3fb40cfb9d3a4f6f9bac64c59f4662287f81007)
HS | Sending ticket: 9afaeffba2f2a98c44cfc2fb9861f5eb39c5e3bb3055dc6d1d4dbeafabfdc3165ebbac74d5090fa82eafea09ed1c922370bc8ed71e69f092b31ba7bd367ad7b6f81b4da685578091f0d84202
HSL| emit NewSessionTicket13
EPO| reader++ 1/1
TLS| readOne Complete
sender done clen=  58 slen=   0 status=server_complete
=== Exporter secret ===
b7a4dfd18541c90a822ad3ff81dfd65e8dc6e9bb0756471985d9c1b5dfee21ea
=== QUIC 1-RTT secrets ===
C: b5f2c23c4fefa1912842e45cdd8f47a5948dd2352c911579221df828bc0e4156
S: a44a124629274019a08d140b94ad0e578c78c00a64b8adc7d0c0aba0f83797c2
=== AEAD client key test ===
b20b32bcba8bf41ae4a2110313cfd0ede788dca6b620694bc13398
=== Decrypt successful ===
Ok
./quic.exe 0rtt

INITIAL ECDHE HANDSHAKE (NO EARLY SECRET)

server create
FFI| offering custom extension 001a
FFI| extension contents: ffff00050a0b0c0d0e
FFI| setting early data limit to ffffffff
FFI| Setting a new ticket callback.
FFI| Setting a new server negotiation callback.
FFI| Setting up certificate callbacks.
client create
FFI| offering custom extension 001a
FFI| extension contents: ffff00050a0b0c0d0e
FFI| setting early data limit to ffffffff
FFI| Setting a new ticket callback.
FFI| Setting a new server negotiation callback.
FFI| Setting up certificate callbacks.
TLS| writeHandshake (plaintext)
TLS| HS.next_fragment PlaintextID?
HS | next_fragment
HS | offering ClientHello 1.3
KS | ks_client_init 1.3
CDH| Keygen (initiator) on X255519
NGO| No PSK or 0-RTT disabled
NGO| offering client extensions [ 001a supported_versions key_share server_name alpn extended_master_secret signature_algorithms supported_groups psk_key_exchange_modes ]
NGO| offering cipher suites ; TLS_CHACHA20_POLY1305_SHA256; TLS_AES_128_GCM_SHA256
HSL| emit ClientHello
TLS| HS.next_fragment returned a fragment
TLS| sendHandshake
TLS| send Handshake fragment with index PlaintextID
TLS| Sending fragment of length 170
REC| record headers: 16030300aa
TLS| writeHandshake (plaintext)
TLS| HS.next_fragment PlaintextID?
HS | next_fragment
TLS| HS.next_fragment returned nothing
TLS| sendHandshake
TLS| read: WrittenHS, Ctrl/Ctrl, nothing
REC| WouldBlock
TLS| readOne ReadWouldBlock
client returns would_block clen=175 slen=0
ClientHello[ 175] ---->

TLS| writeHandshake (plaintext)
TLS| HS.next_fragment PlaintextID?
HS | next_fragment
TLS| HS.next_fragment returned nothing
TLS| sendHandshake
TLS| read: WrittenHS, Ctrl/Ctrl, nothing
TLS| Read fragment at epoch index: -1 of length 170
TLS| read Handshake fragment
HS | recv_fragment
HSL| parsed [ClientHello] -- end of flight 
HS | Processing ClientHello
NGO| offered client extensions [ 001a supported_versions key_share server_name alpn extended_master_secret signature_algorithms supported_groups psk_key_exchange_modes ]
NGO| offered cipher suites ; TLS_CHACHA20_POLY1305_SHA256; TLS_AES_128_GCM_SHA256
NGO| offered versions 1.3
NGO| Negotiated Pure EDH key exchange
NGO| Negotiated ECDSA_SECP256R1_SHA256
NGO| Negotiation callback to handle extra extensions and query for stateless retry.
NGO| Application data in cookie: none
@@@@ Nego callback for TLS 1.3 @@@@
Offered extensions:
003d001a0009ffff00050a0b0c0d0e0000000e000c0000096c6f63616c686f73
740010000800060568712d3130000d0006000408040403000a00040002001d
Transport parameters offered:
ffff00050a0b0c0d0e
No application cookie (fist connection).
Adding server transport parameters:
000102
@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
NGO| negotiated 1.3 TLS_CHACHA20_POLY1305_SHA256
KS | ks_server_init
KS | No PSK selected.
KS | Computed early secret:           33ad0a1c607ec03b09e6cd9893680ce210adf300aa1f2660e1b22e10f170f92a
KS | Handshake salt:                  6f2615a108c702c5678f54fc9dbab69716c076189c48250cebeac3576c3611ba
CDH| Keygen (responder) on X255519
CDH| DH initiator on X255519
KS | DH shared secret: 28231e28f96e092ab718192ac0c4c0ce706ac2b57be7e479033c64e100fc9b39
KS | Handshake secret:                c7c97140cfbb4a0b150347549f0d2c00842f68da6c43e8580747527b9decec4d
NGO| processing client extensions [ 001a supported_versions key_share server_name alpn extended_master_secret signature_algorithms supported_groups psk_key_exchange_modes ]
NGO| including server extensions (SH + EE) [ supported_versions key_share alpn supported_groups ]
NGO| extra extensions from application callback: 001a 
HSL| emit ServerHello and hash
HS | derive handshake keys
KS | ks_server_13_sh, hashed log = 23dd603bb20c195b4db2f75c1773b58e92d5b688b84a69faad111200ef549e06
KS | handshake traffic secret[C]:     a5fe0adc352aaaf323c59ae541d66e8ffac6bf7e00344ae76131df0589abb79e
KS | handshake traffic secret[S]:     962a7f2bef0d37561b31f79759e754c3b19c7dad44b45eb7368b875a214d05f3
KS | handshake key[C]:                1c37ad6af5a05c85e2c1ffedc47b66f0cca9aff92f723c6eeda582b12c22513a, IV=3f1fdf265d35ea81aa4259d8
KS | handshake key[S]: e71b96b8e123482542ae26ee13294cf21cab0cef9c3bd4908b5192d23198b3a7, IV=b8a8fefd5fa464469aa9ce07
AEP| LowProvider: COERCE(K=e71b96b8e123482542ae26ee13294cf21cab0cef9c3bd4908b5192d23198b3a7)
AEP| LowProvider: COERCE(K=1c37ad6af5a05c85e2c1ffedc47b66f0cca9aff92f723c6eeda582b12c22513a)
KS | finished key[C]:                 b8f287b927f8850aee4d6e32f4a31e86ae0740a6be5a7a7549c00f7efbe6ed9a
KS | finished key[S]:                 adf1c485c86a10740bf1d885e1cdcfd69539270a415d0b88a788c21638c0bd48
KS | Application salt:                d2a0f643706404c34cf174cd42283e94a5fe045ff9964754b1692dc116103736
KS | Application secret:              5002dbdd0ec12ec48df5ce073ec2e521b5ffd4d0a29aabf728b5d2415aaaefc5
TLS| readOne ReadAgain
TLS| writeHandshake (plaintext)
TLS| HS.next_fragment PlaintextID?
HS | next_fragment
TLS| HS.next_fragment returned a fragment; next_keys (for handshake only
TLS| sendHandshake
TLS| send Handshake fragment with index PlaintextID
TLS| Sending fragment of length 90
REC| record headers: 160303005a
EPO| writer++ -1/0
TLS| writeHandshake (encrypted)
TLS| HS.next_fragment ID13?
HS | next_fragment
HS | prepare Server Finished
HSL| emit EncryptedExtensions
HSL| emit Certificate13 and hash
======== TO BE SIGNED <0403>: (130 octets) ========
2020202020202020202020202020202020202020202020202020202020202020
2020202020202020202020202020202020202020202020202020202020202020
544c5320312e332c207365727665722043657274696669636174655665726966
7900c83a547712696e75a9f46ec3ae698c79b8ff6845b2c5adf2269d22027141
1e7d
===================================================
HSL| emit CertificateVerify and hash
HSL| emit Finished and hash
KS | ks_server_13_sf hashed_log = d7dacdb11d28a1af5f3d70b4d342fe684260714d94fe391dbfd6bd9379e48d45
KS | application traffic secret[C]:   4edab8a1b6cab387c8f0a070f321e393f5cf784d047d6bc296d5f80b54e0701d
KS | application traffic secret[S]:   dad1f6d997ab2deae2deea7a3b9dc7ae94de3a689b235aaace9668aaf5ed9385
KS | exporter master secret:          2c632cdf5c817b130b119a185a23b4df04a0502056e10aa367c224df3c655cbe
KS | application key[C]:              ec99c8d89360ef7149f1064036a1633d3ae27f4ecd41a9925f6424e3685edb04, IV=6b7ac2813fc2aec4a05f9172
KS | application key[S]:              642e0328ca30dd21e49f6291e9c9d3487c716c960cf3bb59567f1980db88f279, IV=ff6a8d713b91935805ccfb0d
AEP| LowProvider: COERCE(K=642e0328ca30dd21e49f6291e9c9d3487c716c960cf3bb59567f1980db88f279)
AEP| LowProvider: COERCE(K=ec99c8d89360ef7149f1064036a1633d3ae27f4ecd41a9925f6424e3685edb04)
HS | exporting a key
EPO| reader++ 0/0
TLS| HS.next_fragment returned a fragment; next_keys (for all data)
TLS| sendHandshake
TLS| send Handshake fragment with index ID13
TLS| Encrypting with key e71b96b8e123482542ae26ee13294cf21cab0cef9c3bd4908b5192d23198b3a7
TLS| Sending fragment of length 733
REC| record headers: 17030302dd
EPO| writer++ 0/1
TLS| read: WrittenHS, Ctrl/Open, new writer: writable
server returns server_accept clen=175 slen=833
secret=2c632cdf5c817b130b119a185a23b4df04a0502056e10aa367c224df3c655cbe
<---- ServerHello;(EncryptedExtensions; Certificate; CertVerify; Finished)[ 833]

TLS| writeHandshake (plaintext)
TLS| HS.next_fragment PlaintextID?
HS | next_fragment
TLS| HS.next_fragment returned nothing
TLS| sendHandshake
TLS| read: WrittenHS, Ctrl/Ctrl, nothing
TLS| Read fragment at epoch index: -1 of length 90
TLS| read Handshake fragment
HS | recv_fragment
HSL| parsed ServerHello
HSL| end of flight
HS | client_ServerHello
NGO| processing server extensions [ supported_versions key_share ]
NGO| negotiated 1.3 TLS_CHACHA20_POLY1305_SHA256
HS | Running TLS 1.3
KS | ks_client_13_sh hashed_log = 23dd603bb20c195b4db2f75c1773b58e92d5b688b84a69faad111200ef549e06
KS | no PSK negotiated. Early secret: 33ad0a1c607ec03b09e6cd9893680ce210adf300aa1f2660e1b22e10f170f92a
KS | handshake salt:                  6f2615a108c702c5678f54fc9dbab69716c076189c48250cebeac3576c3611ba
CDH| DH initiator on X255519
KS | DH shared secret: 28231e28f96e092ab718192ac0c4c0ce706ac2b57be7e479033c64e100fc9b39
KS | handshake secret:                c7c97140cfbb4a0b150347549f0d2c00842f68da6c43e8580747527b9decec4d
KS | handshake traffic secret[C]:     a5fe0adc352aaaf323c59ae541d66e8ffac6bf7e00344ae76131df0589abb79e
KS | handshake traffic secret[S]:     962a7f2bef0d37561b31f79759e754c3b19c7dad44b45eb7368b875a214d05f3
KS | handshake key[C]:                1c37ad6af5a05c85e2c1ffedc47b66f0cca9aff92f723c6eeda582b12c22513a, IV=3f1fdf265d35ea81aa4259d8
KS | handshake key[S]:                e71b96b8e123482542ae26ee13294cf21cab0cef9c3bd4908b5192d23198b3a7, IV=b8a8fefd5fa464469aa9ce07
KS | finished key[C]: b8f287b927f8850aee4d6e32f4a31e86ae0740a6be5a7a7549c00f7efbe6ed9a
KS | finished key[S]: adf1c485c86a10740bf1d885e1cdcfd69539270a415d0b88a788c21638c0bd48
KS | application salt:                d2a0f643706404c34cf174cd42283e94a5fe045ff9964754b1692dc116103736
KS | application secret:              5002dbdd0ec12ec48df5ce073ec2e521b5ffd4d0a29aabf728b5d2415aaaefc5
AEP| LowProvider: COERCE(K=1c37ad6af5a05c85e2c1ffedc47b66f0cca9aff92f723c6eeda582b12c22513a)
AEP| LowProvider: COERCE(K=e71b96b8e123482542ae26ee13294cf21cab0cef9c3bd4908b5192d23198b3a7)
EPO| reader++ 0/-1
TLS| readOne ReadAgain
TLS| writeHandshake (plaintext)
TLS| HS.next_fragment PlaintextID?
HS | next_fragment
TLS| HS.next_fragment returned nothing
TLS| sendHandshake
TLS| read: WrittenHS, Ctrl/Ctrl, nothing
TLS| Read fragment at epoch index: 0 of length 733
TLS| StAE decrypt correct.
TLS| read Handshake fragment
HS | recv_fragment
HSL| parsed EncryptedExtensions
HSL| parsed Certificate13
HSL| parsed CertificateVerify
HSL| parsed Finished
HSL| end of flight
NGO| Nego.clientComplete_13
NGO| EE: alpn supported_groups 001a 
NGO| Negotiation callback to process application extensions.
@@@@ Nego callback for TLS 1.3 @@@@
Offered extensions:
001b0010000800060568712d3130000a00040002001d001a0003000102
Transport parameters offered:
000102
No application cookie (fist connection).
Adding server transport parameters:
000102
@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
WARNING: chain validation failed, ignoring.
NGO| Certificate & signature 1.3 callback result: valid
KS | ks_client_13_sf hashed_log = d7dacdb11d28a1af5f3d70b4d342fe684260714d94fe391dbfd6bd9379e48d45
KS | application traffic secret[C]:   4edab8a1b6cab387c8f0a070f321e393f5cf784d047d6bc296d5f80b54e0701d
KS | application traffic secret[S]:   dad1f6d997ab2deae2deea7a3b9dc7ae94de3a689b235aaace9668aaf5ed9385
KS | exporter master secret:          2c632cdf5c817b130b119a185a23b4df04a0502056e10aa367c224df3c655cbe
KS | application key[C]:              ec99c8d89360ef7149f1064036a1633d3ae27f4ecd41a9925f6424e3685edb04, IV=6b7ac2813fc2aec4a05f9172
KS | application key[S]:              642e0328ca30dd21e49f6291e9c9d3487c716c960cf3bb59567f1980db88f279, IV=ff6a8d713b91935805ccfb0d
AEP| LowProvider: COERCE(K=ec99c8d89360ef7149f1064036a1633d3ae27f4ecd41a9925f6424e3685edb04)
AEP| LowProvider: COERCE(K=642e0328ca30dd21e49f6291e9c9d3487c716c960cf3bb59567f1980db88f279)
HS | exporting a key
HS | Early data rejected
EPO| writer++ 0/0
HSL| emit Finished and hash
KS | ks_client_13_cf hashed_log = b1dcf1c1a59db1cd7c51fb82bfc857b3e4bb1bd484877befe929f60d7f310727
KS | resumption master secret:        961bcead0c732be50653ece0143d793b7a1905ceccdcef2846bbc2762249b8cd
EPO| reader++ 1/0
TLS| readOne ReadAgain
TLS| writeHandshake (encrypted)
TLS| HS.next_fragment ID13?
HS | next_fragment
TLS| HS.next_fragment returned a fragment; next_keys (for all data); complete
TLS| sendHandshake
TLS| send Handshake fragment with index ID13
TLS| Encrypting with key 1c37ad6af5a05c85e2c1ffedc47b66f0cca9aff92f723c6eeda582b12c22513a
TLS| Sending fragment of length 53
REC| record headers: 1703030035
EPO| writer++ 1/1
TLS| read: WrittenHS, Open/Open, new writer: complete
client returns client_complete clen=58 slen=833
secret=2c632cdf5c817b130b119a185a23b4df04a0502056e10aa367c224df3c655cbe
(Finished) [  58] ---->

TLS| writeHandshake (encrypted)
TLS| HS.next_fragment ID13?
HS | next_fragment
TLS| HS.next_fragment returned nothing
TLS| sendHandshake
TLS| read: WrittenHS, Ctrl/Open, nothing
TLS| Read fragment at epoch index: 0 of length 53
TLS| StAE decrypt correct.
TLS| read Handshake fragment
HS | recv_fragment
HSL| parsed Finished
HSL| end of flight
HS | Process Client Finished
KS | ks_server_13_cf hashed_log = b1dcf1c1a59db1cd7c51fb82bfc857b3e4bb1bd484877befe929f60d7f310727
KS | resumption master secret:        961bcead0c732be50653ece0143d793b7a1905ceccdcef2846bbc2762249b8cd
AEP| LowProvider: COERCE(K=e2e8593f50a69f64ee100ed817ae7cb390bb636d9ebaffb686bb29d2eb6f0751)
HS | Sending ticket: 8ecd095b1aa29e5ccc91e1786274aeb2dd82045c6935bf493f4a9dda51c4e453407258e5e57257c3fc8506add45781cd83d456307225b4672d5550cd96268c9b606add01ea2707d323d85cb4
HSL| emit NewSessionTicket13
EPO| reader++ 1/1
TLS| readOne Complete
server returns server_complete clen=58 slen=0
TLS| writeHandshake (encrypted)
TLS| HS.next_fragment ID13?
HS | next_fragment
TLS| HS.next_fragment returned a fragment
TLS| sendHandshake
TLS| send Handshake fragment with index ID13
TLS| Encrypting with key 642e0328ca30dd21e49f6291e9c9d3487c716c960cf3bb59567f1980db88f279
TLS| Sending fragment of length 130
REC| record headers: 1703030082
TLS| writeHandshake (encrypted)
TLS| HS.next_fragment ID13?
HS | next_fragment
TLS| HS.next_fragment returned nothing
TLS| sendHandshake
TLS| read: WrittenHS, Open/Open, nothing
REC| WouldBlock
TLS| readOne ReadWouldBlock
server returns would_block clen=0 slen=135
<---- {Ticket}[ 135]
TLS| writeHandshake (encrypted)
TLS| HS.next_fragment ID13?
HS | next_fragment
TLS| HS.next_fragment returned nothing
TLS| sendHandshake
TLS| read: WrittenHS, Open/Open, nothing
TLS| Read fragment at epoch index: 1 of length 130
TLS| StAE decrypt correct.
TLS| read Handshake fragment
HS | recv_fragment
HSL| parsed NewSessionTicket13
HSL| end of flight
HS | Received ticket: 8ecd095b1aa29e5ccc91e1786274aeb2dd82045c6935bf493f4a9dda51c4e453407258e5e57257c3fc8506add45781cd83d456307225b4672d5550cd96268c9b606add01ea2707d323d85cb4
KS | ks_client_13_rms
KS | Recall RMS: 961bcead0c732be50653ece0143d793b7a1905ceccdcef2846bbc2762249b8cd
AEP| LowProvider: COERCE(K=b4247df2560272363315809c7877d7885822c84698f0784327dffed27aa12bb2)

##### New session ticket received! #####
Host: localhost
Ticket:
8ecd095b1aa29e5ccc91e1786274aeb2dd82045c6935bf493f4a9dda51c4e453
407258e5e57257c3fc8506add45781cd83d456307225b4672d5550cd96268c9b
606add01ea2707d323d85cb4
########################################
TLS| readOne ReadAgain
TLS| writeHandshake (encrypted)
TLS| HS.next_fragment ID13?
HS | next_fragment
TLS| HS.next_fragment returned nothing
TLS| sendHandshake
TLS| read: WrittenHS, Open/Open, nothing
REC| WouldBlock
TLS| readOne ReadWouldBlock
client returns clen=0 slen=135 status=would_block

TICKET-BASED RESUMPTION

server create
FFI| offering custom extension 001a
FFI| extension contents: ffff00050a0b0c0d0e
FFI| setting early data limit to ffffffff
FFI| Setting a new ticket callback.
FFI| Setting a new server negotiation callback.
FFI| Setting up certificate callbacks.
client create
FFI| offering custom extension 001a
FFI| extension contents: ffff00050a0b0c0d0e
FFI| setting early data limit to ffffffff
FFI| Setting a new ticket callback.
FFI| Setting a new server negotiation callback.
FFI| Setting up certificate callbacks.
TCK| Decrypting ticket d83e559d0468329b4e190e857b09d111f71981b0d66ecdb255cc0a3361d2a66c3ed7fdac78833bc5179046010ec7561df8dd28d0ae41c182982fbb14f60295e772b67cd235db9c9a67495650
TCK| Parsing ticket 030413035b22f0dbbfd583b000000020996ef432c73123700dbcb7c0b1d3f5b03bfcb12e48caef88e60651b61474a0e0
TLS| writeHandshake (plaintext)
TLS| HS.next_fragment PlaintextID?
HS | next_fragment
HS | offering ClientHello 1.3
KS | ks_client_init 1.3
CDH| Keygen (initiator) on X255519
NGO| Offering a PSK compatible with 0-RTT
NGO| offering client extensions [ 001a supported_versions key_share server_name alpn extended_master_secret signature_algorithms supported_groups psk_key_exchange_modes early_data pre_shared_key ]
NGO| offering cipher suites ; TLS_CHACHA20_POLY1305_SHA256; TLS_AES_128_GCM_SHA256
HSL| emit ClientHello
KS | Loaded pre-shared key 8ecd095b1aa29e5ccc91e1786274aeb2dd82045c6935bf493f4a9dda51c4e453407258e5e57257c3fc8506add45781cd83d456307225b4672d5550cd96268c9b606add01ea2707d323d85cb4: 996ef432c73123700dbcb7c0b1d3f5b03bfcb12e48caef88e60651b61474a0e0
KS | Early secret: 9a0fdd8757c7d0fdd2d44916691c2d3a2c5862dd26a565f9208723dc34bd5f29
KS | Binder key[res binder]: e38e87324ac8cee5e17fa2274dcf1cb55745970e74197fe8a02cd4f1c0abbfa0
KS | Binder Finished key: 37a30f36ee7b4b50cc1b9aabb389f723ca1c0836c589ceddfd4d37def7285a9c
HSL| emit Binders
HS | setting up 0RTT
KS | ks_client_13_ch log=34724214f2b2c2bc20574dfb2aeec1d2d092e856e201c5d16ef712a13f093dc9
KS | Client early traffic secret:     3ecf731dd46bcd27b120928061ef7aeb31c2268791e7015c636c449663392bf7
KS | Early exporter master secret:    a377f488f209f2c7b1722393aede06e02347a3bb79c0874f6676f71fa001aaba
KS | Client 0-RTT key:                0d209d5140a027896e00fb104acfcd166885ab6e52bccb7cac0b3354e76ade64, IV=63aba10269945e8d22dc105a
AEP| LowProvider: COERCE(K=0d209d5140a027896e00fb104acfcd166885ab6e52bccb7cac0b3354e76ade64)
HS | exporting a key
TLS| HS.next_fragment returned a fragment; next_keys (for all data)
TLS| sendHandshake
TLS| send Handshake fragment with index PlaintextID
TLS| Sending fragment of length 297
REC| record headers: 1603030129
EPO| writer++ -1/0
TLS| read: WrittenHS, Ctrl/Open, new writer: writable
client returns client_early_data clen=302 slen=0
early secret=a377f488f209f2c7b1722393aede06e02347a3bb79c0874f6676f71fa001aaba
ClientHello[ 302] ---->

TLS| writeHandshake (plaintext)
TLS| HS.next_fragment PlaintextID?
HS | next_fragment
TLS| HS.next_fragment returned nothing
TLS| sendHandshake
TLS| read: WrittenHS, Ctrl/Ctrl, nothing
TLS| Read fragment at epoch index: -1 of length 297
TLS| read Handshake fragment
HS | recv_fragment
HSL| parsed [ClientHello; Binders] -- end of flight 
HS | Processing ClientHello with 1 binder(s)
NGO| offered client extensions [ 001a supported_versions key_share server_name alpn extended_master_secret signature_algorithms supported_groups psk_key_exchange_modes early_data pre_shared_key ]
NGO| offered cipher suites ; TLS_CHACHA20_POLY1305_SHA256; TLS_AES_128_GCM_SHA256
NGO| offered versions 1.3
TCK| Decrypting ticket 8ecd095b1aa29e5ccc91e1786274aeb2dd82045c6935bf493f4a9dda51c4e453407258e5e57257c3fc8506add45781cd83d456307225b4672d5550cd96268c9b606add01ea2707d323d85cb4
TCK| Parsing ticket 030413035b22f0dbbfd583b000000020961bcead0c732be50653ece0143d793b7a1905ceccdcef2846bbc2762249b8cd
NGO| Negotiated PSK_EDH key exchange
NGO| Negotiation callback to handle extra extensions and query for stateless retry.
NGO| Application data in cookie: none
@@@@ Nego callback for TLS 1.3 @@@@
Offered extensions:
003d001a0009ffff00050a0b0c0d0e0000000e000c0000096c6f63616c686f73
740010000800060568712d3130000d0006000408040403000a00040002001d
Transport parameters offered:
ffff00050a0b0c0d0e
No application cookie (fist connection).
Adding server transport parameters:
000102
@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
NGO| negotiated 1.3 TLS_CHACHA20_POLY1305_SHA256
HS | accepted TLS 1.3 psk #0
KS | ks_server_init
KS | Using negotiated PSK identity: 8ecd095b1aa29e5ccc91e1786274aeb2dd82045c6935bf493f4a9dda51c4e453407258e5e57257c3fc8506add45781cd83d456307225b4672d5550cd96268c9b606add01ea2707d323d85cb4
TCK| Decrypting ticket 8ecd095b1aa29e5ccc91e1786274aeb2dd82045c6935bf493f4a9dda51c4e453407258e5e57257c3fc8506add45781cd83d456307225b4672d5550cd96268c9b606add01ea2707d323d85cb4
TCK| Parsing ticket 030413035b22f0dbbfd583b000000020961bcead0c732be50653ece0143d793b7a1905ceccdcef2846bbc2762249b8cd
KS | Ticket RMS: 961bcead0c732be50653ece0143d793b7a1905ceccdcef2846bbc2762249b8cd
KS | Pre-shared key: 996ef432c73123700dbcb7c0b1d3f5b03bfcb12e48caef88e60651b61474a0e0
KS | binder key:                      e38e87324ac8cee5e17fa2274dcf1cb55745970e74197fe8a02cd4f1c0abbfa0
KS | binder Finished key:             37a30f36ee7b4b50cc1b9aabb389f723ca1c0836c589ceddfd4d37def7285a9c
KS | Computed early secret:           9a0fdd8757c7d0fdd2d44916691c2d3a2c5862dd26a565f9208723dc34bd5f29
KS | Handshake salt:                  ec08e9fb962401a8a9ff8c0af7c62dc4c91715b216423e329aeaf4ce07f74fbd
CDH| Keygen (responder) on X255519
CDH| DH initiator on X255519
KS | DH shared secret: d449ca4df71a8315344a2ffe37a5f5ea694f7f2f0bdf9a8ab0d2d7d202fc065c
KS | Handshake secret:                04cae60069fd032c26a0e52ffc54f75e9c18296b3177d3a83ccad25c083ffa96
NGO| processing client extensions [ 001a supported_versions key_share server_name alpn extended_master_secret signature_algorithms supported_groups psk_key_exchange_modes early_data pre_shared_key ]
NGO| including server extensions (SH + EE) [ supported_versions key_share alpn supported_groups early_data pre_shared_key ]
NGO| extra extensions from application callback: 001a 
HSL| emit ServerHello and hash
KS | ks_server_13_0rtt_key
KS | Client early traffic secret:     3ecf731dd46bcd27b120928061ef7aeb31c2268791e7015c636c449663392bf7
KS | Early exporter master secret:    a377f488f209f2c7b1722393aede06e02347a3bb79c0874f6676f71fa001aaba
KS | Client 0-RTT key:                0d209d5140a027896e00fb104acfcd166885ab6e52bccb7cac0b3354e76ade64, IV=63aba10269945e8d22dc105a
AEP| LowProvider: COERCE(K=0d209d5140a027896e00fb104acfcd166885ab6e52bccb7cac0b3354e76ade64)
HS | exporting a key
HS | derive handshake keys
KS | ks_server_13_sh, hashed log = 25a347bb9255579a4f61b2851e43117ce14dc8b610e84ccfa6e831b6e514820b
KS | handshake traffic secret[C]:     5bc9af0e362e443fadaa91f68e29ac7fdc1f50f05147c4129b0a6c623e0e5889
KS | handshake traffic secret[S]:     20bea64f0a71acd3c890815c79446f010ff0c8c037554d16e2161b3573120855
KS | handshake key[C]:                4c92a016911e756825c3d64e252054c314e9f9caba7c6eefddf3a6cc6f39809a, IV=b02361e43741a0559f9fe12c
KS | handshake key[S]: 8b028949db08ce9707019c40fbc12c3090ab8aaf4df9d52a2ab54eaa09f053f9, IV=2530c6cc2bfcb6c1ccad10c5
AEP| LowProvider: COERCE(K=8b028949db08ce9707019c40fbc12c3090ab8aaf4df9d52a2ab54eaa09f053f9)
AEP| LowProvider: COERCE(K=4c92a016911e756825c3d64e252054c314e9f9caba7c6eefddf3a6cc6f39809a)
KS | finished key[C]:                 b24a23bdbe9d79668403694a81095432a5e4311cc09f3ce4b9413cb6713ce2ca
KS | finished key[S]:                 ed53c16e16803d9914654dd11cbfcc075d100ea5d5c096031c26f652dfaedff2
KS | Application salt:                9d9a348d2cce5ba3a97811648c1891097674291a165621749c0f8c5bbd6f29c5
KS | Application secret:              0a4cfba53426df2af52585708f3acc120266467bea6047ea41456e5b06378549
TLS| readOne ReadAgain
TLS| writeHandshake (plaintext)
TLS| HS.next_fragment PlaintextID?
HS | next_fragment
TLS| HS.next_fragment returned a fragment; next_keys (for handshake only skipping 0RTT
TLS| sendHandshake
TLS| send Handshake fragment with index PlaintextID
TLS| Sending fragment of length 96
REC| record headers: 1603030060
EPO| writer++ -1/0
EPO| writer++ -1/1
TLS| writeHandshake (encrypted)
TLS| HS.next_fragment ID13?
HS | next_fragment
HS | prepare Server Finished
HSL| emit EncryptedExtensions and hash
HSL| emit Finished and hash
KS | ks_server_13_sf hashed_log = 207a61ee81d8985e0dca689a74d61b78f6872ab389e7e68ea2c6028bea0bc5ee
KS | application traffic secret[C]:   be4814038467f376426ed53f51cf698ecd380aaf056a6637b2cb5b32a304857f
KS | application traffic secret[S]:   190d61e10950e974290b1e19b82300817b0ab6c85054bd3c95667aa566d7218e
KS | exporter master secret:          7fa7adcd536f8c4347c1262b0b76565d6f08c06b93cdb65cf8514ae8b1f2830e
KS | application key[C]:              65b4570c401295976ac41ae3ad69d2ccd4d5e2836a2a3b7ae308f0e36ad8cef1, IV=b27b03446000e5042d47d4d9
KS | application key[S]:              411932c96fb748f6b1c51f7837c1f57922a980af5d390874019d6df97fd438db, IV=251a1ab6051f1b8f71d53cf9
AEP| LowProvider: COERCE(K=411932c96fb748f6b1c51f7837c1f57922a980af5d390874019d6df97fd438db)
AEP| LowProvider: COERCE(K=65b4570c401295976ac41ae3ad69d2ccd4d5e2836a2a3b7ae308f0e36ad8cef1)
HS | exporting a key
EPO| reader++ 0/1
TLS| HS.next_fragment returned a fragment; next_keys (for all data)
TLS| sendHandshake
TLS| send Handshake fragment with index ID13
TLS| Encrypting with key 8b028949db08ce9707019c40fbc12c3090ab8aaf4df9d52a2ab54eaa09f053f9
TLS| Sending fragment of length 90
REC| record headers: 170303005a
EPO| writer++ 0/2
TLS| read: WrittenHS, Ctrl/Open, new writer: writable
server returns server_accept_early_data clen=302 slen=196
early secret=a377f488f209f2c7b1722393aede06e02347a3bb79c0874f6676f71fa001aaba
secret=7fa7adcd536f8c4347c1262b0b76565d6f08c06b93cdb65cf8514ae8b1f2830e
<---- ServerHello;(EncryptedExtensions; Certificate; CertVerify; Finished)[ 196]

TLS| writeHandshake (encrypted)
TLS| HS.next_fragment ID13?
HS | next_fragment
TLS| HS.next_fragment returned nothing
TLS| sendHandshake
TLS| read: WrittenHS, Ctrl/Open, nothing
TLS| Read fragment at epoch index: -1 of length 96
TLS| read Handshake fragment
HS | recv_fragment
HSL| parsed ServerHello
HSL| end of flight
HS | client_ServerHello
NGO| processing server extensions [ supported_versions key_share pre_shared_key ]
NGO| negotiated 1.3 TLS_CHACHA20_POLY1305_SHA256
HS | Running TLS 1.3
KS | ks_client_13_sh hashed_log = 25a347bb9255579a4f61b2851e43117ce14dc8b610e84ccfa6e831b6e514820b
KS | recallPSK early secret:          9a0fdd8757c7d0fdd2d44916691c2d3a2c5862dd26a565f9208723dc34bd5f29
KS | handshake salt:                  ec08e9fb962401a8a9ff8c0af7c62dc4c91715b216423e329aeaf4ce07f74fbd
CDH| DH initiator on X255519
KS | DH shared secret: d449ca4df71a8315344a2ffe37a5f5ea694f7f2f0bdf9a8ab0d2d7d202fc065c
KS | handshake secret:                04cae60069fd032c26a0e52ffc54f75e9c18296b3177d3a83ccad25c083ffa96
KS | handshake traffic secret[C]:     5bc9af0e362e443fadaa91f68e29ac7fdc1f50f05147c4129b0a6c623e0e5889
KS | handshake traffic secret[S]:     20bea64f0a71acd3c890815c79446f010ff0c8c037554d16e2161b3573120855
KS | handshake key[C]:                4c92a016911e756825c3d64e252054c314e9f9caba7c6eefddf3a6cc6f39809a, IV=b02361e43741a0559f9fe12c
KS | handshake key[S]:                8b028949db08ce9707019c40fbc12c3090ab8aaf4df9d52a2ab54eaa09f053f9, IV=2530c6cc2bfcb6c1ccad10c5
KS | finished key[C]: b24a23bdbe9d79668403694a81095432a5e4311cc09f3ce4b9413cb6713ce2ca
KS | finished key[S]: ed53c16e16803d9914654dd11cbfcc075d100ea5d5c096031c26f652dfaedff2
KS | application salt:                9d9a348d2cce5ba3a97811648c1891097674291a165621749c0f8c5bbd6f29c5
KS | application secret:              0a4cfba53426df2af52585708f3acc120266467bea6047ea41456e5b06378549
AEP| LowProvider: COERCE(K=4c92a016911e756825c3d64e252054c314e9f9caba7c6eefddf3a6cc6f39809a)
AEP| LowProvider: COERCE(K=8b028949db08ce9707019c40fbc12c3090ab8aaf4df9d52a2ab54eaa09f053f9)
HS | 0RTT potentially accepted (wait for EE to confirm)
EPO| reader++ 0/0
EPO| reader++ 1/0
TLS| readOne ReadAgain
TLS| writeHandshake (encrypted)
TLS| HS.next_fragment ID13?
HS | next_fragment
TLS| HS.next_fragment returned nothing
TLS| sendHandshake
TLS| read: WrittenHS, Ctrl/Open, nothing
TLS| Read fragment at epoch index: 1 of length 90
TLS| StAE decrypt correct.
TLS| read Handshake fragment
HS | recv_fragment
HSL| parsed EncryptedExtensions
HSL| parsed Finished
HSL| end of flight
NGO| Nego.clientComplete_13
NGO| EE: alpn supported_groups early_data 001a 
NGO| Negotiation callback to process application extensions.
@@@@ Nego callback for TLS 1.3 @@@@
Offered extensions:
001b0010000800060568712d3130000a00040002001d001a0003000102
Transport parameters offered:
000102
No application cookie (fist connection).
Adding server transport parameters:
000102
@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
NGO| Certificate & signature 1.3 callback result: valid
KS | ks_client_13_sf hashed_log = 207a61ee81d8985e0dca689a74d61b78f6872ab389e7e68ea2c6028bea0bc5ee
KS | application traffic secret[C]:   be4814038467f376426ed53f51cf698ecd380aaf056a6637b2cb5b32a304857f
KS | application traffic secret[S]:   190d61e10950e974290b1e19b82300817b0ab6c85054bd3c95667aa566d7218e
KS | exporter master secret:          7fa7adcd536f8c4347c1262b0b76565d6f08c06b93cdb65cf8514ae8b1f2830e
KS | application key[C]:              65b4570c401295976ac41ae3ad69d2ccd4d5e2836a2a3b7ae308f0e36ad8cef1, IV=b27b03446000e5042d47d4d9
KS | application key[S]:              411932c96fb748f6b1c51f7837c1f57922a980af5d390874019d6df97fd438db, IV=251a1ab6051f1b8f71d53cf9
AEP| LowProvider: COERCE(K=65b4570c401295976ac41ae3ad69d2ccd4d5e2836a2a3b7ae308f0e36ad8cef1)
AEP| LowProvider: COERCE(K=411932c96fb748f6b1c51f7837c1f57922a980af5d390874019d6df97fd438db)
HS | exporting a key
HS | Early data accepted; emitting EOED.
HSL| emit EndOfEarlyData and hash
TLS| readOne ReadAgain
TLS| writeHandshake (encrypted)
TLS| HS.next_fragment ID13?
HS | next_fragment
TLS| HS.next_fragment returned a fragment; next_keys (for handshake only
TLS| sendHandshake
TLS| send Handshake fragment with index ID13
TLS| Encrypting with key 0d209d5140a027896e00fb104acfcd166885ab6e52bccb7cac0b3354e76ade64
TLS| Sending fragment of length 21
REC| record headers: 1703030015
EPO| writer++ 1/1
TLS| writeHandshake (encrypted)
TLS| HS.next_fragment ID13?
HS | next_fragment
HSL| emit Finished and hash
KS | ks_client_13_cf hashed_log = 9a8d2949f80c3ba00fe4c3f2bd5e42a8735715bc83f9600b7373c5c56548a8c5
KS | resumption master secret:        d14e15a818db4d96c9fccfcaac539e4b6babd5bcd27c142f9b4770e229b1e20b
EPO| reader++ 2/1
TLS| HS.next_fragment returned a fragment; next_keys (for all data); complete
TLS| sendHandshake
TLS| send Handshake fragment with index ID13
TLS| Encrypting with key 4c92a016911e756825c3d64e252054c314e9f9caba7c6eefddf3a6cc6f39809a
TLS| Sending fragment of length 53
REC| record headers: 1703030035
EPO| writer++ 2/2
TLS| read: WrittenHS, Open/Open, new writer: complete
client returns client_complete_early_data clen=84 slen=196
secret=7fa7adcd536f8c4347c1262b0b76565d6f08c06b93cdb65cf8514ae8b1f2830e
(Finished) [  84] ---->

TLS| writeHandshake (encrypted)
TLS| HS.next_fragment ID13?
HS | next_fragment
TLS| HS.next_fragment returned nothing
TLS| sendHandshake
TLS| read: WrittenHS, Ctrl/Open, nothing
TLS| Read fragment at epoch index: 0 of length 21
TLS| StAE decrypt correct.
TLS| read Handshake fragment
HS | recv_fragment
HSL| parsed EndOfEarlyData
HSL| end of flight
HS | Process EOED (increment reader to HS key)
EPO| reader++ 1/2
TLS| readOne ReadAgain
TLS| writeHandshake (encrypted)
TLS| HS.next_fragment ID13?
HS | next_fragment
TLS| HS.next_fragment returned nothing
TLS| sendHandshake
TLS| read: WrittenHS, Ctrl/Open, nothing
TLS| Read fragment at epoch index: 1 of length 53
TLS| StAE decrypt correct.
TLS| read Handshake fragment
HS | recv_fragment
HSL| parsed Finished
HSL| end of flight
HS | Process Client Finished
KS | ks_server_13_cf hashed_log = 9a8d2949f80c3ba00fe4c3f2bd5e42a8735715bc83f9600b7373c5c56548a8c5
KS | resumption master secret:        d14e15a818db4d96c9fccfcaac539e4b6babd5bcd27c142f9b4770e229b1e20b
HS | Sending ticket: 82e88697502ed8dad5c3909e334c8ee8731643073b38bf09a82f6676573e843f770f7c556a7a5e3355724657f957cac236a1d408285e7a5b5936c88059fc3c8ad20ff3a1ee47a395ccfb4a3f
HSL| emit NewSessionTicket13
EPO| reader++ 2/2
TLS| readOne Complete
server returns clen=84 slen=0 status=server_complete
TLS| writeHandshake (encrypted)
TLS| HS.next_fragment ID13?
HS | next_fragment
TLS| HS.next_fragment returned a fragment
TLS| sendHandshake
TLS| send Handshake fragment with index ID13
TLS| Encrypting with key 411932c96fb748f6b1c51f7837c1f57922a980af5d390874019d6df97fd438db
TLS| Sending fragment of length 130
REC| record headers: 1703030082
TLS| writeHandshake (encrypted)
TLS| HS.next_fragment ID13?
HS | next_fragment
TLS| HS.next_fragment returned nothing
TLS| sendHandshake
TLS| read: WrittenHS, Open/Open, nothing
REC| WouldBlock
TLS| readOne ReadWouldBlock
server returns would_block clen=0 slen=135
<---- {Ticket}[ 135]
TLS| writeHandshake (encrypted)
TLS| HS.next_fragment ID13?
HS | next_fragment
TLS| HS.next_fragment returned nothing
TLS| sendHandshake
TLS| read: WrittenHS, Open/Open, nothing
TLS| Read fragment at epoch index: 2 of length 130
TLS| StAE decrypt correct.
TLS| read Handshake fragment
HS | recv_fragment
HSL| parsed NewSessionTicket13
HSL| end of flight
HS | Received ticket: 82e88697502ed8dad5c3909e334c8ee8731643073b38bf09a82f6676573e843f770f7c556a7a5e3355724657f957cac236a1d408285e7a5b5936c88059fc3c8ad20ff3a1ee47a395ccfb4a3f
KS | ks_client_13_rms
KS | Recall RMS: d14e15a818db4d96c9fccfcaac539e4b6babd5bcd27c142f9b4770e229b1e20b

##### New session ticket received! #####
Host: localhost
Ticket:
82e88697502ed8dad5c3909e334c8ee8731643073b38bf09a82f6676573e843f
770f7c556a7a5e3355724657f957cac236a1d408285e7a5b5936c88059fc3c8a
d20ff3a1ee47a395ccfb4a3f
########################################
TLS| readOne ReadAgain
TLS| writeHandshake (encrypted)
TLS| HS.next_fragment ID13?
HS | next_fragment
TLS| HS.next_fragment returned nothing
TLS| sendHandshake
TLS| read: WrittenHS, Open/Open, nothing
REC| WouldBlock
TLS| readOne ReadWouldBlock
client returns clen=0 slen=135 status=would_block
Ok
./quic.exe hrr

STATELESS RETRY TEST

server create
FFI| offering custom extension 001a
FFI| extension contents: ffff00050a0b0c0d0e
FFI| setting early data limit to ffffffff
FFI| Setting a new ticket callback.
FFI| Setting a new server negotiation callback.
FFI| Setting up certificate callbacks.
client create
FFI| offering custom extension 001a
FFI| extension contents: ffff00050a0b0c0d0e
FFI| setting early data limit to ffffffff
FFI| Setting a new ticket callback.
FFI| Setting a new server negotiation callback.
FFI| Setting up certificate callbacks.
TLS| writeHandshake (plaintext)
TLS| HS.next_fragment PlaintextID?
HS | next_fragment
HS | offering ClientHello 1.3
KS | ks_client_init 1.3
CDH| Keygen (initiator) on X255519
NGO| No PSK or 0-RTT disabled
NGO| offering client extensions [ 001a supported_versions key_share server_name alpn extended_master_secret signature_algorithms supported_groups psk_key_exchange_modes ]
NGO| offering cipher suites ; TLS_CHACHA20_POLY1305_SHA256; TLS_AES_128_GCM_SHA256
HSL| emit ClientHello
TLS| HS.next_fragment returned a fragment
TLS| sendHandshake
TLS| send Handshake fragment with index PlaintextID
TLS| Sending fragment of length 170
REC| record headers: 16030300aa
TLS| writeHandshake (plaintext)
TLS| HS.next_fragment PlaintextID?
HS | next_fragment
TLS| HS.next_fragment returned nothing
TLS| sendHandshake
TLS| read: WrittenHS, Ctrl/Ctrl, nothing
REC| WouldBlock
TLS| readOne ReadWouldBlock
client returns would_block clen=175 slen=0
ClientHello[ 175] ---->

~~~~~~~~~ Client Hello Summary ~~~~~~~~~~~
~ SNI = localhost
~ ALPN = 00060568712d3130
~ Cookie = NULL
~ Extensions = 0079001a0009ffff00050a0b0c0d0e002b0003027f1c003300260024001d0020
045276179b68dd8ec45c234ba7e79063b8908787937cc1111c0ad453eded6f6c
0000000e000c0000096c6f63616c686f73740010000800060568712d31300017
0000000d0006000408040403000a00040002001d002d0003020001
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
TLS| writeHandshake (plaintext)
TLS| HS.next_fragment PlaintextID?
HS | next_fragment
TLS| HS.next_fragment returned nothing
TLS| sendHandshake
TLS| read: WrittenHS, Ctrl/Ctrl, nothing
TLS| Read fragment at epoch index: -1 of length 170
TLS| read Handshake fragment
HS | recv_fragment
HSL| parsed [ClientHello] -- end of flight 
HS | Processing ClientHello
NGO| offered client extensions [ 001a supported_versions key_share server_name alpn extended_master_secret signature_algorithms supported_groups psk_key_exchange_modes ]
NGO| offered cipher suites ; TLS_CHACHA20_POLY1305_SHA256; TLS_AES_128_GCM_SHA256
NGO| offered versions 1.3
NGO| Negotiated Pure EDH key exchange
NGO| Negotiated ECDSA_SECP256R1_SHA256
NGO| Negotiation callback to handle extra extensions and query for stateless retry.
NGO| Application data in cookie: none
@@@@ Nego callback for TLS 1.3 @@@@
Offered extensions:
003d001a0009ffff00050a0b0c0d0e0000000e000c0000096c6f63616c686f73
740010000800060568712d3130000d0006000408040403000a00040002001d
Transport parameters offered:
ffff00050a0b0c0d0e
No application cookie (fist connection).
Adding server transport parameters:
000102
@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
AEP| LowProvider: COERCE(K=1ade92e347fb3b419c52e9ac51a1b5caf9f9ce3891ccf7dfa7a4d7823be73f6d)
TCK| Encrypting cookie: 0000320200002e0303cf21ad74e59a6111be1d8c021e65b891c2a211167abb8c5e079e09e2c8a8339c001303000006002b00027f1c20d2faacd81877e270f9e4cbe473505df4c590092cb15b8f777d832cac0ad0a5cd000b48656c6c6f20576f726c64
TCK| Encrypted cookie:  95e08378bd782e136a8d543426ed163127d79011fedb64c0bce5b670e286b48adf35667485df273cd43743c40e6b822887ff0c21db84ef7c3838672904b050becc2b518840b78d63c9e87d24f717a8319c722343cd55dd7d499838fabe1f9203b07a55135096c4c71389ee705ad8e74e7ffc5cc70342f88eb9daec3dcbbc9a
HSL| emit HelloRetryRequest
TLS| readOne ReadAgain
TLS| writeHandshake (plaintext)
TLS| HS.next_fragment PlaintextID?
HS | next_fragment
TLS| HS.next_fragment returned a fragment
TLS| sendHandshake
TLS| send Handshake fragment with index PlaintextID
TLS| Sending fragment of length 183
REC| record headers: 16030300b7
TLS| writeHandshake (plaintext)
TLS| HS.next_fragment PlaintextID?
HS | next_fragment
TLS| HS.next_fragment returned nothing
TLS| sendHandshake
TLS| read: WrittenHS, Ctrl/Ctrl, nothing
REC| WouldBlock
TLS| readOne ReadWouldBlock
server returns server_stateless_retry clen=175 slen=188
<---- HRR[ 188]

server re-create
FFI| offering custom extension 001a
FFI| extension contents: ffff00050a0b0c0d0e
FFI| setting early data limit to ffffffff
FFI| Setting a new ticket callback.
FFI| Setting a new server negotiation callback.
FFI| Setting up certificate callbacks.
TLS| writeHandshake (plaintext)
TLS| HS.next_fragment PlaintextID?
HS | next_fragment
TLS| HS.next_fragment returned nothing
TLS| sendHandshake
TLS| read: WrittenHS, Ctrl/Ctrl, nothing
TLS| Read fragment at epoch index: -1 of length 183
TLS| read Handshake fragment
HS | recv_fragment
HSL| parsed HelloRetryRequest
HSL| end of flight
HSL| Replacing CH1 in transcript with fe000020d2faacd81877e270f9e4cbe473505df4c590092cb15b8f777d832cac0ad0a5cd
HSL| HRR bytes: 020000b30303cf21ad74e59a6111be1d8c021e65b891c2a211167abb8c5e079e09e2c8a8339c00130300008b002c0081007f95e08378bd782e136a8d543426ed163127d79011fedb64c0bce5b670e286b48adf35667485df273cd43743c40e6b822887ff0c21db84ef7c3838672904b050becc2b518840b78d63c9e87d24f717a8319c722343cd55dd7d499838fabe1f9203b07a55135096c4c71389ee705ad8e74e7ffc5cc70342f88eb9daec3dcbbc9a002b00027f1c
HS | client_HelloRetryRequest
HS | Server did not specify a group in HRR, re-using the previous choice
NGO| Got HRR, extensions: [cookie supported_versions ]
HSL| emit ClientHello
TLS| readOne ReadAgain
TLS| writeHandshake (plaintext)
TLS| HS.next_fragment PlaintextID?
HS | next_fragment
TLS| HS.next_fragment returned a fragment
TLS| sendHandshake
TLS| send Handshake fragment with index PlaintextID
TLS| Sending fragment of length 303
REC| record headers: 160303012f
TLS| writeHandshake (plaintext)
TLS| HS.next_fragment PlaintextID?
HS | next_fragment
TLS| HS.next_fragment returned nothing
TLS| sendHandshake
TLS| read: WrittenHS, Ctrl/Ctrl, nothing
REC| WouldBlock
TLS| readOne ReadWouldBlock
client returns would_block clen=308 slen=188
ClientHello2[ 308] ---->

TCK| Decrypting cookie 95e08378bd782e136a8d543426ed163127d79011fedb64c0bce5b670e286b48adf35667485df273cd43743c40e6b822887ff0c21db84ef7c3838672904b050becc2b518840b78d63c9e87d24f717a8319c722343cd55dd7d499838fabe1f9203b07a55135096c4c71389ee705ad8e74e7ffc5cc70342f88eb9daec3dcbbc9a
TCK| Plain cookie: 0000320200002e0303cf21ad74e59a6111be1d8c021e65b891c2a211167abb8c5e079e09e2c8a8339c001303000006002b00027f1c20d2faacd81877e270f9e4cbe473505df4c590092cb15b8f777d832cac0ad0a5cd000b48656c6c6f20576f726c64
~~~~~~~~~ Client Hello Summary ~~~~~~~~~~~
~ SNI = localhost
~ ALPN = 00060568712d3130
~ Cookie = 48656c6c6f20576f726c64
~ Extensions = 00fe002c0081007f95e08378bd782e136a8d543426ed163127d79011fedb64c0
bce5b670e286b48adf35667485df273cd43743c40e6b822887ff0c21db84ef7c
3838672904b050becc2b518840b78d63c9e87d24f717a8319c722343cd55dd7d
499838fabe1f9203b07a55135096c4c71389ee705ad8e74e7ffc5cc70342f88e
b9daec3dcbbc9a001a0009ffff00050a0b0c0d0e002b0003027f1c0033002600
24001d0020045276179b68dd8ec45c234ba7e79063b8908787937cc1111c0ad4
53eded6f6c0000000e000c0000096c6f63616c686f7374001000080006056871
2d313000170000000d0006000408040403000a00040002001d002d0003020001
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
TLS| writeHandshake (plaintext)
TLS| HS.next_fragment PlaintextID?
HS | next_fragment
TLS| HS.next_fragment returned nothing
TLS| sendHandshake
TLS| read: WrittenHS, Ctrl/Ctrl, nothing
TLS| Read fragment at epoch index: -1 of length 303
TLS| read Handshake fragment
HS | recv_fragment
HSL| parsed [ClientHello] -- end of flight 
HS | Processing ClientHello
NGO| offered client extensions [ cookie 001a supported_versions key_share server_name alpn extended_master_secret signature_algorithms supported_groups psk_key_exchange_modes ]
NGO| offered cipher suites ; TLS_CHACHA20_POLY1305_SHA256; TLS_AES_128_GCM_SHA256
NGO| offered versions 1.3
NGO| Negotiated Pure EDH key exchange
NGO| Negotiated ECDSA_SECP256R1_SHA256
TCK| Decrypting cookie 95e08378bd782e136a8d543426ed163127d79011fedb64c0bce5b670e286b48adf35667485df273cd43743c40e6b822887ff0c21db84ef7c3838672904b050becc2b518840b78d63c9e87d24f717a8319c722343cd55dd7d499838fabe1f9203b07a55135096c4c71389ee705ad8e74e7ffc5cc70342f88eb9daec3dcbbc9a
TCK| Plain cookie: 0000320200002e0303cf21ad74e59a6111be1d8c021e65b891c2a211167abb8c5e079e09e2c8a8339c001303000006002b00027f1c20d2faacd81877e270f9e4cbe473505df4c590092cb15b8f777d832cac0ad0a5cd000b48656c6c6f20576f726c64
NGO| Loaded stateless retry cookie 95e08378bd782e136a8d543426ed163127d79011fedb64c0bce5b670e286b48adf35667485df273cd43743c40e6b822887ff0c21db84ef7c3838672904b050becc2b518840b78d63c9e87d24f717a8319c722343cd55dd7d499838fabe1f9203b07a55135096c4c71389ee705ad8e74e7ffc5cc70342f88eb9daec3dcbbc9a
NGO| Overwriting the transcript digest with CH1 hash d2faacd81877e270f9e4cbe473505df4c590092cb15b8f777d832cac0ad0a5cd
HSL| Installing prefix to transcript: fe000020d2faacd81877e270f9e4cbe473505df4c590092cb15b8f777d832cac0ad0a5cd
HSL| HRR bytes: 020000b30303cf21ad74e59a6111be1d8c021e65b891c2a211167abb8c5e079e09e2c8a8339c00130300008b002c0081007f95e08378bd782e136a8d543426ed163127d79011fedb64c0bce5b670e286b48adf35667485df273cd43743c40e6b822887ff0c21db84ef7c3838672904b050becc2b518840b78d63c9e87d24f717a8319c722343cd55dd7d499838fabe1f9203b07a55135096c4c71389ee705ad8e74e7ffc5cc70342f88eb9daec3dcbbc9a002b00027f1c
NGO| Negotiation callback to handle extra extensions and query for stateless retry.
NGO| Application data in cookie: 48656c6c6f20576f726c64
@@@@ Nego callback for TLS 1.3 @@@@
Offered extensions:
003d001a0009ffff00050a0b0c0d0e0000000e000c0000096c6f63616c686f73
740010000800060568712d3130000d0006000408040403000a00040002001d
Transport parameters offered:
ffff00050a0b0c0d0e
Stateless cookie found, application contents:
48656c6c6f20576f726c64
Adding server transport parameters:
000102
@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
NGO| negotiated 1.3 TLS_CHACHA20_POLY1305_SHA256
KS | ks_server_init
KS | No PSK selected.
KS | Computed early secret:           33ad0a1c607ec03b09e6cd9893680ce210adf300aa1f2660e1b22e10f170f92a
KS | Handshake salt:                  6f2615a108c702c5678f54fc9dbab69716c076189c48250cebeac3576c3611ba
CDH| Keygen (responder) on X255519
CDH| DH initiator on X255519
KS | DH shared secret: 7f171561e706171088b2f893cf33dba870de007bf8f51cfd7796f0cf9fe5982a
KS | Handshake secret:                5016fae86ee86fa00c5bd68606687ab7565c978a39b83230222ca256c1faada3
NGO| processing client extensions [ cookie 001a supported_versions key_share server_name alpn extended_master_secret signature_algorithms supported_groups psk_key_exchange_modes ]
NGO| including server extensions (SH + EE) [ supported_versions key_share alpn supported_groups ]
NGO| extra extensions from application callback: 001a 
HSL| emit ServerHello and hash
HS | derive handshake keys
KS | ks_server_13_sh, hashed log = 756dfee9fa786a60ff27857e5d1f4dbe4533a8eb66f37b97c1b4c759758412f3
KS | handshake traffic secret[C]:     fc84de594ccb9ecb547700b420dcaad5a9e2f67ed743f3beaedc45cb0a7af1d3
KS | handshake traffic secret[S]:     3aa14330f342c5d0d2bba0f00e3915ab03925274a569ae60e77fed24a1cc6ac9
KS | handshake key[C]:                3c2802728cdd4d2aebf2eb23452e26cf29166ee5204ba4e19b1bd03da3338e25, IV=d0baec6fac2244e22434ddae
KS | handshake key[S]: b68cdb4093cd801466c9c88e7d550b64e5dac63194cf7cf8147ef20ac8b2a9d1, IV=278c7a3b44a07a16ef29b411
AEP| LowProvider: COERCE(K=b68cdb4093cd801466c9c88e7d550b64e5dac63194cf7cf8147ef20ac8b2a9d1)
AEP| LowProvider: COERCE(K=3c2802728cdd4d2aebf2eb23452e26cf29166ee5204ba4e19b1bd03da3338e25)
KS | finished key[C]:                 6ba06d4eae13f28050be6d3127907aafa52458360e384ba016de2792e5fcfce6
KS | finished key[S]:                 1648b553635005799dcc2d91bf1691a71ae5c4b32857ab6eaca2ad0db995aafb
KS | Application salt:                084699c67a5965e23221c1b7e10806e8c39731f04ad4aef87be7c97eb5cf1085
KS | Application secret:              14539c68768128c5e21b7e8039cf477ed3eee8f73c83ae5b7c3176bbdd11405b
TLS| readOne ReadAgain
TLS| writeHandshake (plaintext)
TLS| HS.next_fragment PlaintextID?
HS | next_fragment
TLS| HS.next_fragment returned a fragment; next_keys (for handshake only
TLS| sendHandshake
TLS| send Handshake fragment with index PlaintextID
TLS| Sending fragment of length 90
REC| record headers: 160303005a
EPO| writer++ -1/0
TLS| writeHandshake (encrypted)
TLS| HS.next_fragment ID13?
HS | next_fragment
HS | prepare Server Finished
HSL| emit EncryptedExtensions
HSL| emit Certificate13 and hash
======== TO BE SIGNED <0403>: (130 octets) ========
2020202020202020202020202020202020202020202020202020202020202020
2020202020202020202020202020202020202020202020202020202020202020
544c5320312e332c207365727665722043657274696669636174655665726966
7900c6db0bec580b576b8d834a1cc338b76f8f5425166186bb1bf2498b00bab8
a085
===================================================
HSL| emit CertificateVerify and hash
HSL| emit Finished and hash
KS | ks_server_13_sf hashed_log = 2f9b15c34ba9022626a9c048a4a9ab7328ae63542f152bd903a92655f5fbf6dc
KS | application traffic secret[C]:   5f0b7c5d6669482783f80a1c31e1378f128a0dc63f8dc3eb20ab0cc039914933
KS | application traffic secret[S]:   5ec1ee5cc32ad104f2cda9476dcd6cb6655b0b37835a580398316ed04ebf2dfc
KS | exporter master secret:          b3651caacd504de8a482b59ccde1844f08a9240676e9357153c2028d6d4a64ee
KS | application key[C]:              bd971f8008f9ae2598b50beb85441b5076e8654e688f32d58ed84545c0ba1654, IV=9a4ae172efa10a06f7fd04e7
KS | application key[S]:              4dcd34c36259a1d3a0f7318480836739ee529a960056d49557649fb310e8593c, IV=0c2b96bfd1aa7dd4519200c5
AEP| LowProvider: COERCE(K=4dcd34c36259a1d3a0f7318480836739ee529a960056d49557649fb310e8593c)
AEP| LowProvider: COERCE(K=bd971f8008f9ae2598b50beb85441b5076e8654e688f32d58ed84545c0ba1654)
HS | exporting a key
EPO| reader++ 0/0
TLS| HS.next_fragment returned a fragment; next_keys (for all data)
TLS| sendHandshake
TLS| send Handshake fragment with index ID13
TLS| Encrypting with key b68cdb4093cd801466c9c88e7d550b64e5dac63194cf7cf8147ef20ac8b2a9d1
TLS| Sending fragment of length 734
REC| record headers: 17030302de
EPO| writer++ 0/1
TLS| read: WrittenHS, Ctrl/Open, new writer: writable
server returns server_accept clen=308 slen=834
secret=b3651caacd504de8a482b59ccde1844f08a9240676e9357153c2028d6d4a64ee
<---- ServerHello;(EncryptedExtensions; Certificate; CertVerify; Finished)[ 834]

TLS| writeHandshake (plaintext)
TLS| HS.next_fragment PlaintextID?
HS | next_fragment
TLS| HS.next_fragment returned nothing
TLS| sendHandshake
TLS| read: WrittenHS, Ctrl/Ctrl, nothing
TLS| Read fragment at epoch index: -1 of length 90
TLS| read Handshake fragment
HS | recv_fragment
HSL| parsed ServerHello
HSL| end of flight
HS | client_ServerHello
NGO| processing server extensions [ supported_versions key_share ]
NGO| negotiated 1.3 TLS_CHACHA20_POLY1305_SHA256
HS | Running TLS 1.3
KS | ks_client_13_sh hashed_log = 756dfee9fa786a60ff27857e5d1f4dbe4533a8eb66f37b97c1b4c759758412f3
KS | no PSK negotiated. Early secret: 33ad0a1c607ec03b09e6cd9893680ce210adf300aa1f2660e1b22e10f170f92a
KS | handshake salt:                  6f2615a108c702c5678f54fc9dbab69716c076189c48250cebeac3576c3611ba
CDH| DH initiator on X255519
KS | DH shared secret: 7f171561e706171088b2f893cf33dba870de007bf8f51cfd7796f0cf9fe5982a
KS | handshake secret:                5016fae86ee86fa00c5bd68606687ab7565c978a39b83230222ca256c1faada3
KS | handshake traffic secret[C]:     fc84de594ccb9ecb547700b420dcaad5a9e2f67ed743f3beaedc45cb0a7af1d3
KS | handshake traffic secret[S]:     3aa14330f342c5d0d2bba0f00e3915ab03925274a569ae60e77fed24a1cc6ac9
KS | handshake key[C]:                3c2802728cdd4d2aebf2eb23452e26cf29166ee5204ba4e19b1bd03da3338e25, IV=d0baec6fac2244e22434ddae
KS | handshake key[S]:                b68cdb4093cd801466c9c88e7d550b64e5dac63194cf7cf8147ef20ac8b2a9d1, IV=278c7a3b44a07a16ef29b411
KS | finished key[C]: 6ba06d4eae13f28050be6d3127907aafa52458360e384ba016de2792e5fcfce6
KS | finished key[S]: 1648b553635005799dcc2d91bf1691a71ae5c4b32857ab6eaca2ad0db995aafb
KS | application salt:                084699c67a5965e23221c1b7e10806e8c39731f04ad4aef87be7c97eb5cf1085
KS | application secret:              14539c68768128c5e21b7e8039cf477ed3eee8f73c83ae5b7c3176bbdd11405b
AEP| LowProvider: COERCE(K=3c2802728cdd4d2aebf2eb23452e26cf29166ee5204ba4e19b1bd03da3338e25)
AEP| LowProvider: COERCE(K=b68cdb4093cd801466c9c88e7d550b64e5dac63194cf7cf8147ef20ac8b2a9d1)
EPO| reader++ 0/-1
TLS| readOne ReadAgain
TLS| writeHandshake (plaintext)
TLS| HS.next_fragment PlaintextID?
HS | next_fragment
TLS| HS.next_fragment returned nothing
TLS| sendHandshake
TLS| read: WrittenHS, Ctrl/Ctrl, nothing
TLS| Read fragment at epoch index: 0 of length 734
TLS| StAE decrypt correct.
TLS| read Handshake fragment
HS | recv_fragment
HSL| parsed EncryptedExtensions
HSL| parsed Certificate13
HSL| parsed CertificateVerify
HSL| parsed Finished
HSL| end of flight
NGO| Nego.clientComplete_13
NGO| EE: alpn supported_groups 001a 
NGO| Negotiation callback to process application extensions.
@@@@ Nego callback for TLS 1.3 @@@@
Offered extensions:
001b0010000800060568712d3130000a00040002001d001a0003000102
Transport parameters offered:
000102
No application cookie (fist connection).
Adding server transport parameters:
000102
@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
WARNING: chain validation failed, ignoring.
NGO| Certificate & signature 1.3 callback result: valid
KS | ks_client_13_sf hashed_log = 2f9b15c34ba9022626a9c048a4a9ab7328ae63542f152bd903a92655f5fbf6dc
KS | application traffic secret[C]:   5f0b7c5d6669482783f80a1c31e1378f128a0dc63f8dc3eb20ab0cc039914933
KS | application traffic secret[S]:   5ec1ee5cc32ad104f2cda9476dcd6cb6655b0b37835a580398316ed04ebf2dfc
KS | exporter master secret:          b3651caacd504de8a482b59ccde1844f08a9240676e9357153c2028d6d4a64ee
KS | application key[C]:              bd971f8008f9ae2598b50beb85441b5076e8654e688f32d58ed84545c0ba1654, IV=9a4ae172efa10a06f7fd04e7
KS | application key[S]:              4dcd34c36259a1d3a0f7318480836739ee529a960056d49557649fb310e8593c, IV=0c2b96bfd1aa7dd4519200c5
AEP| LowProvider: COERCE(K=bd971f8008f9ae2598b50beb85441b5076e8654e688f32d58ed84545c0ba1654)
AEP| LowProvider: COERCE(K=4dcd34c36259a1d3a0f7318480836739ee529a960056d49557649fb310e8593c)
HS | exporting a key
HS | Early data rejected
EPO| writer++ 0/0
HSL| emit Finished and hash
KS | ks_client_13_cf hashed_log = b32af82816a06519abcac429d8d1963000f7be1f7945ff92c8424e1d838ba716
KS | resumption master secret:        e1fa5893e5219eae63acfb78573558f2e4fb8fc46eaa26c11b405609b643c3a2
EPO| reader++ 1/0
TLS| readOne ReadAgain
TLS| writeHandshake (encrypted)
TLS| HS.next_fragment ID13?
HS | next_fragment
TLS| HS.next_fragment returned a fragment; next_keys (for all data); complete
TLS| sendHandshake
TLS| send Handshake fragment with index ID13
TLS| Encrypting with key 3c2802728cdd4d2aebf2eb23452e26cf29166ee5204ba4e19b1bd03da3338e25
TLS| Sending fragment of length 53
REC| record headers: 1703030035
EPO| writer++ 1/1
TLS| read: WrittenHS, Open/Open, new writer: complete
client returns client_complete clen=58 slen=834
secret=b3651caacd504de8a482b59ccde1844f08a9240676e9357153c2028d6d4a64ee
(Finished) [  58] ---->

TLS| writeHandshake (encrypted)
TLS| HS.next_fragment ID13?
HS | next_fragment
TLS| HS.next_fragment returned nothing
TLS| sendHandshake
TLS| read: WrittenHS, Ctrl/Open, nothing
TLS| Read fragment at epoch index: 0 of length 53
TLS| StAE decrypt correct.
TLS| read Handshake fragment
HS | recv_fragment
HSL| parsed Finished
HSL| end of flight
HS | Process Client Finished
KS | ks_server_13_cf hashed_log = b32af82816a06519abcac429d8d1963000f7be1f7945ff92c8424e1d838ba716
KS | resumption master secret:        e1fa5893e5219eae63acfb78573558f2e4fb8fc46eaa26c11b405609b643c3a2
HS | Sending ticket: f07eb65ae5a80a0a2fee00913db51d33c91a508525c197a1090181feb3e7c4dcb291b9d70a4f47212445da9e1d756c6baaf481920e47541054016fc95ae4b02892aad49ee0bca2bf61c804bf
HSL| emit NewSessionTicket13
EPO| reader++ 1/1
TLS| readOne Complete
server returns server_complete clen=58 slen=0
TLS| writeHandshake (encrypted)
TLS| HS.next_fragment ID13?
HS | next_fragment
TLS| HS.next_fragment returned a fragment
TLS| sendHandshake
TLS| send Handshake fragment with index ID13
TLS| Encrypting with key 4dcd34c36259a1d3a0f7318480836739ee529a960056d49557649fb310e8593c
TLS| Sending fragment of length 130
REC| record headers: 1703030082
TLS| writeHandshake (encrypted)
TLS| HS.next_fragment ID13?
HS | next_fragment
TLS| HS.next_fragment returned nothing
TLS| sendHandshake
TLS| read: WrittenHS, Open/Open, nothing
REC| WouldBlock
TLS| readOne ReadWouldBlock
server returns would_block clen=0 slen=135
<---- {Ticket}[ 135]
TLS| writeHandshake (encrypted)
TLS| HS.next_fragment ID13?
HS | next_fragment
TLS| HS.next_fragment returned nothing
TLS| sendHandshake
TLS| read: WrittenHS, Open/Open, nothing
TLS| Read fragment at epoch index: 1 of length 130
TLS| StAE decrypt correct.
TLS| read Handshake fragment
HS | recv_fragment
HSL| parsed NewSessionTicket13
HSL| end of flight
HS | Received ticket: f07eb65ae5a80a0a2fee00913db51d33c91a508525c197a1090181feb3e7c4dcb291b9d70a4f47212445da9e1d756c6baaf481920e47541054016fc95ae4b02892aad49ee0bca2bf61c804bf
KS | ks_client_13_rms
KS | Recall RMS: e1fa5893e5219eae63acfb78573558f2e4fb8fc46eaa26c11b405609b643c3a2
AEP| LowProvider: COERCE(K=bb804ced1a1529939e9b7b2d04a2b529e9193e39974de6804830465e454222c3)

##### New session ticket received! #####
Host: localhost
Ticket:
f07eb65ae5a80a0a2fee00913db51d33c91a508525c197a1090181feb3e7c4dc
b291b9d70a4f47212445da9e1d756c6baaf481920e47541054016fc95ae4b028
92aad49ee0bca2bf61c804bf
########################################
TLS| readOne ReadAgain
TLS| writeHandshake (encrypted)
TLS| HS.next_fragment ID13?
HS | next_fragment
TLS| HS.next_fragment returned nothing
TLS| sendHandshake
TLS| read: WrittenHS, Open/Open, nothing
REC| WouldBlock
TLS| readOne ReadWouldBlock
client returns clen=0 slen=135 status=would_block
Ok
make[1]: Leaving directory '/cygdrive/c/build/agent1/_work/13/s/mitls-fstar/apps/quicMinusNet'
make[1]: Entering directory '/cygdrive/c/build/agent1/_work/13/s/mitls-fstar/src/tls'
C:/build/agent1/_work/13/s/FStar/bin/fstar.exe --cache_dir cache/Kremlin --cache_checked_modules --print_z3_statistics --use_hints --query_stats --cache_dir cache/Kremlin --odir extract/Kremlin --extract '* -DHDB -LowCProvider -FFICallbacks -BufferBytes' --dep full --include C:/build/agent1/_work/13/s/FStar/contrib/CoreCrypto/fst/ --include C:/build/agent1/_work/13/s/hacl-star/secure_api --include C:/build/agent1/_work/13/s/hacl-star/secure_api/utils --include C:/build/agent1/_work/13/s/hacl-star/secure_api/concrete_specializations --include C:/build/agent1/_work/13/s/hacl-star/secure_api/LowCProvider/fst --include C:/build/agent1/_work/13/s/hacl-star/code/curve25519/api --include C:/build/agent1/_work/13/s/hacl-star/code/lib --include C:/build/agent1/_work/13/s/kremlin/include --include C:/build/agent1/_work/13/s/kremlin/kremlib --include ../../libs/ffi --include ../../src/lowparse --include C:/build/agent1/_work/13/s/hacl-star/providers/evercrypt --include ../../src/tls/concrete-flags --include ../../src/tls/concrete-flags/Kremlin --include ./concrete-flags/Debug QUIC.fst Test.Main.fst > cache/Kremlin/.depend
sed -i.opt -e "s/cmx/cmo/g" -e "s/source/old/g" cache/Kremlin/.depend
make[1]: Leaving directory '/cygdrive/c/build/agent1/_work/13/s/mitls-fstar/src/tls'
make[1]: Entering directory '/cygdrive/c/build/agent1/_work/13/s/mitls-fstar/src/tls'
C:/build/agent1/_work/13/s/FStar/bin/fstar.exe --cache_dir cache/Model --cache_checked_modules --print_z3_statistics --use_hints --query_stats --cache_dir cache/Model --odir extract/Model --extract Nothing --dep full --include C:/build/agent1/_work/13/s/FStar/contrib/CoreCrypto/fst/ --include C:/build/agent1/_work/13/s/hacl-star/secure_api --include C:/build/agent1/_work/13/s/hacl-star/secure_api/utils --include C:/build/agent1/_work/13/s/hacl-star/secure_api/concrete_specializations --include C:/build/agent1/_work/13/s/hacl-star/secure_api/LowCProvider/fst --include C:/build/agent1/_work/13/s/hacl-star/code/curve25519/api --include C:/build/agent1/_work/13/s/hacl-star/code/lib --include C:/build/agent1/_work/13/s/kremlin/include --include C:/build/agent1/_work/13/s/kremlin/kremlib --include ../../libs/ffi --include ../../src/lowparse --include C:/build/agent1/_work/13/s/hacl-star/providers/evercrypt --include ../../src/tls/ideal-flags --include ../../src/tls/concrete-flags/generic --include ./concrete-flags/Debug QUIC.fst Test.Main.fst IV.fst HMAC.UFCMA.fst Token.UF1CMA.fst Pkg.Tree.fst AEAD.Pkg.fst > cache/Model/.depend
sed -i.opt -e "s/cmx/cmo/g" -e "s/source/old/g" cache/Model/.depend
make[1]: Leaving directory '/cygdrive/c/build/agent1/_work/13/s/mitls-fstar/src/tls'
make[1]: Entering directory '/cygdrive/c/build/agent1/_work/13/s/mitls-fstar/src/tls'
C:/build/agent1/_work/13/s/FStar/bin/fstar.exe --cache_dir cache/OCaml --cache_checked_modules --print_z3_statistics --use_hints --query_stats --cache_dir cache/OCaml --odir extract/OCaml --extract '* -Prims -FStar +FStar.Test +FStar.Kremlin.Endianness -CoreCrypto -CryptoTypes -EverCrypt.Bytes -EverCrypt -DHDB -LowCProvider -HaclProvider -FFICallbacks -Crypto.AEAD -Crypto.Symmetric -Crypto.Plain -Spec.Loops -Buffer.Utils -C +C.Loops -LowParse.SLow.Tac -BufferBytes' --dep full --include C:/build/agent1/_work/13/s/FStar/contrib/CoreCrypto/fst/ --include C:/build/agent1/_work/13/s/hacl-star/secure_api --include C:/build/agent1/_work/13/s/hacl-star/secure_api/utils --include C:/build/agent1/_work/13/s/hacl-star/secure_api/concrete_specializations --include C:/build/agent1/_work/13/s/hacl-star/secure_api/LowCProvider/fst --include C:/build/agent1/_work/13/s/hacl-star/code/curve25519/api --include C:/build/agent1/_work/13/s/hacl-star/code/lib --include C:/build/agent1/_work/13/s/kremlin/include --include C:/build/agent1/_work/13/s/kremlin/kremlib --include ../../libs/ffi --include ../../src/lowparse --include C:/build/agent1/_work/13/s/hacl-star/providers/evercrypt --include ../../src/tls/concrete-flags --include ../../src/tls/concrete-flags/OCaml --include ./concrete-flags/Debug QUIC.fst Test.Main.fst > cache/OCaml/.depend
sed -i.opt -e "s/cmx/cmo/g" -e "s/source/old/g" cache/OCaml/.depend
make[1]: Leaving directory '/cygdrive/c/build/agent1/_work/13/s/mitls-fstar/src/tls'
EVEREST_WINDOWS=1 make -C extract/Kremlin-Internal-Test test
make[1]: Entering directory '/cygdrive/c/build/agent1/_work/13/s/mitls-fstar/src/tls'
echo No verification-specific tests as of yet.
No verification-specific tests as of yet.
make[1]: Leaving directory '/cygdrive/c/build/agent1/_work/13/s/mitls-fstar/src/tls'
EVEREST_WINDOWS=1 make -C extract/Kremlin-Library test
make[2]: Nothing to be done for 'test'.
make[2]: 'test' is up to date.
make[1]: Entering directory '/cygdrive/c/build/agent1/_work/13/s/mitls-fstar/src/tls'
OCAMLPATH="C:/build/agent1/_work/13/s/FStar/bin" ocamlfind opt -g -I C:/build/agent1/_work/13/s/FStar/ulib/ml -I extract/OCaml -I C:/build/agent1/_work/13/s/MLCrypto -I ../../libs/ffi -I C:/build/agent1/_work/13/s/hacl-star/secure_api/LowCProvider -I C:/build/agent1/_work/13/s/hacl-star/secure_api/out/runtime_switch/ -I C:/build/agent1/_work/13/s/kremlin/_build/kremlib -I test -I extract/mlstubs -I C:/build/agent1/_work/13/s/hacl-star/providers/evercrypt/ml -I . -package fstarlib,zarith,ctypes,ctypes.foreign -cclib -L../pki -cclib -lmipki \
-cclib -LC:/build/agent1/_work/13/s/hacl-star/providers/out -cclib -levercrypt -linkall \
-linkpkg -g extract/OCaml/BufferBytes.cmx extract/OCaml/Crypto_AEAD_Main.cmx C:/build/agent1/_work/13/s/kremlin/_build/kremlib/C.cmx C:/build/agent1/_work/13/s/MLCrypto/CoreCrypto.cmxa C:/build/agent1/_work/13/s/hacl-star/secure_api/out/runtime_switch/LowC.cmxa ../../libs/ffi/FFICallbacks.cmxa C:/build/agent1/_work/13/s/hacl-star/providers/out/evercrypt.cmxa extract/OCaml/Hashing_Spec.cmx extract/OCaml/Flags.cmx extract/OCaml/TLSError.cmx extract/OCaml/Mem.cmx extract/OCaml/Hashing_OpenSSL.cmx extract/OCaml/Hashing.cmx extract/OCaml/LowParse_Bytes32.cmx extract/OCaml/LowParse_Bytes.cmx extract/OCaml/LowParse_Spec_Base.cmx extract/OCaml/LowParse_Spec_Combinators.cmx extract/OCaml/LowParse_SLow_Base.cmx extract/OCaml/LowParse_SLow_Combinators.cmx extract/OCaml/LowParse_Spec_Enum.cmx extract/OCaml/LowParse_SLow_Enum.cmx extract/OCaml/LowParse_Spec_Sum.cmx extract/OCaml/LowParse_SLow_Sum.cmx extract/OCaml/LowParse_Math.cmx extract/OCaml/FStar_Kremlin_Endianness.cmx extract/OCaml/LowParse_BigEndian.cmx extract/OCaml/LowParse_BigEndianImpl_Base.cmx extract/OCaml/LowParse_BigEndianImpl_SLow.cmx extract/OCaml/LowParse_Spec_FLData.cmx extract/OCaml/LowParse_SLow_FLData.cmx extract/OCaml/LowParse_Spec_VLData.cmx extract/OCaml/LowParse_SLow_VLData.cmx extract/OCaml/LowParse_Spec_Bytes.cmx extract/OCaml/LowParse_SLow_Bytes.cmx extract/OCaml/LowParse_Spec_List.cmx extract/OCaml/LowParse_Spec_Array.cmx extract/OCaml/C_Loops.cmx extract/OCaml/LowParse_SLow_List.cmx extract/OCaml/LowParse_SLow_Array.cmx extract/OCaml/LowParse_Spec_Int_Aux.cmx extract/OCaml/LowParse_Spec_Int.cmx extract/OCaml/LowParse_Spec_Int_Unique.cmx extract/OCaml/LowParse_SLow_Int_Aux.cmx extract/OCaml/LowParse_SLow_Int.cmx extract/OCaml/LowParse_SLow.cmx extract/OCaml/Format_NamedGroup.cmx extract/OCaml/Format_Constants.cmx extract/OCaml/Format_UncompressedPointRepresentation.cmx extract/OCaml/Format_KeyShareEntry.cmx extract/OCaml/Format_ECCurveType.cmx extract/OCaml/TLS_Curve25519.cmx extract/OCaml/Parse.cmx extract/OCaml/ECGroup.cmx extract/OCaml/DHGroup.cmx extract/OCaml/DebugFlags.cmx extract/OCaml/Format_NamedGroupList.cmx extract/OCaml/CommonDH.cmx extract/OCaml/LowParseWrappers.cmx extract/OCaml/QD_TLS_protocolVersion.cmx extract/OCaml/TLSConstants.cmx extract/OCaml/PKI.cmx extract/OCaml/Nonce.cmx extract/OCaml/RSAKey.cmx extract/OCaml/PMS.cmx extract/OCaml/List_Helpers.cmx extract/OCaml/PSK.cmx extract/OCaml/Extensions.cmx extract/OCaml/Cert.cmx extract/OCaml/TLSInfoFlags.cmx extract/OCaml/TLSInfo.cmx extract/OCaml/Crypto_Indexing.cmx extract/OCaml/Flag.cmx extract/OCaml/Specializations_Providers_AEAD.cmx extract/OCaml/AEADOpenssl.cmx extract/OCaml/AEADProvider.cmx extract/OCaml/Range.cmx extract/OCaml/Hashing_CRF.cmx extract/OCaml/HandshakeMessages.cmx extract/OCaml/HandshakeLog.cmx extract/OCaml/HMAC.cmx extract/OCaml/Old_HMAC_UFCMA.cmx extract/OCaml/Test_BufferBytes.cmx extract/OCaml/TLSPRF.cmx extract/OCaml/DataStream.cmx extract/OCaml/Alert.cmx extract/OCaml/Content.cmx extract/OCaml/StreamPlain.cmx extract/OCaml/StreamAE.cmx extract/OCaml/StatefulPlain.cmx extract/OCaml/LHAEPlain.cmx extract/OCaml/AEAD_GCM.cmx extract/OCaml/StatefulLHAE.cmx extract/OCaml/StAE.cmx extract/OCaml/Ticket.cmx extract/OCaml/Old_HKDF.cmx extract/OCaml/Old_KeySchedule.cmx extract/OCaml/FStar_Test.cmx extract/OCaml/Test_CommonDH.cmx extract/OCaml/Negotiation.cmx extract/OCaml/Old_Epochs.cmx extract/OCaml/Old_Handshake.cmx extract/OCaml/Transport.cmx extract/OCaml/Record.cmx extract/OCaml/Connection.cmx extract/OCaml/StreamDeltas.cmx extract/OCaml/TLS.cmx extract/OCaml/FFI.cmx extract/OCaml/QUIC.cmx extract/OCaml/Test_StAE.cmx extract/OCaml/Test_TLSConstants.cmx extract/OCaml/Test_Handshake.cmx extract/OCaml/Test_AEAD.cmx extract/OCaml/Test_Main.cmx extract/OCaml/FFIRegister.cmx C:/build/agent1/_work/13/s/kremlin/kremlib/out/libkremlib.a -o mitls.exe -thread
make[1]: Leaving directory '/cygdrive/c/build/agent1/_work/13/s/mitls-fstar/src/tls'
make[1]: Entering directory '/cygdrive/c/build/agent1/_work/13/s/mitls-fstar/src/tls'
./mitls.exe
make[1]: Leaving directory '/cygdrive/c/build/agent1/_work/13/s/mitls-fstar/src/tls'
+ cd mitls-fstar/apps/cmitls
+ make test
./cmitls.exe google.com 443
cmitls.exe ===================
cmitls.exe calling FFI_mitls_init
cmitls.exe about to act as client or server
===============================================
Starting test client...
FFI| Setting up certificate callbacks.
FFI| Setting a new server negotiation callback.
TLS| writeHandshake (plaintext)
TLS| HS.next_fragment PlaintextID?
HS | next_fragment
HS | offering ClientHello 1.3
KS | ks_client_init 1.3
CDH| Keygen (initiator) on X255519
NGO| No PSK or 0-RTT disabled
NGO| offering client extensions [ supported_versions key_share server_name session_ticket extended_master_secret signature_algorithms ec_point_formats supported_groups psk_key_exchange_modes ]
NGO| offering cipher suites ; TLS_AES_128_GCM_SHA256; TLS_AES_256_GCM_SHA384; TLS_CHACHA20_POLY1305_SHA256; TLS_ECDHE_ECDSA_WITH_AES_128_GCM_SHA256; TLS_ECDHE_RSA_WITH_AES_128_GCM_SHA256; TLS_DHE_RSA_WITH_AES_128_GCM_SHA256; TLS_ECDHE_ECDSA_WITH_AES_256_GCM_SHA384; TLS_ECDHE_RSA_WITH_AES_256_GCM_SHA384; TLS_DHE_RSA_WITH_AES_256_GCM_SHA384; TLS_ECDHE_ECDSA_WITH_CHACHA20_POLY1305_SHA256; TLS_ECDHE_RSA_WITH_CHACHA20_POLY1305_SHA256; TLS_DHE_RSA_WITH_CHACHA20_POLY1305_SHA256
HSL| emit ClientHello
TLS| HS.next_fragment returned a fragment
TLS| sendHandshake
TLS| send Handshake fragment with index PlaintextID
TLS| Sending fragment of length 208
REC| record headers: 16030300d0
TLS| writeHandshake (plaintext)
TLS| HS.next_fragment PlaintextID?
HS | next_fragment
TLS| HS.next_fragment returned nothing
TLS| sendHandshake
TLS| read: WrittenHS, Ctrl/Ctrl, nothing
TLS| Read fragment at epoch index: -1 of length 58
TLS| read Handshake fragment
HS | recv_fragment
HSL| parsed ServerHello
HSL| end of flight
HS | client_ServerHello
NGO| processing server extensions [ extended_master_secret session_ticket ec_point_formats ]
NGO| negotiated 1.2 TLS_ECDHE_ECDSA_WITH_AES_128_GCM_SHA256
HS | Running classic TLS
HS | Offered SID= Server SID=
HS | recv_fragment
HSL| more bytes required
TLS| readOne ReadAgain
TLS| writeHandshake (plaintext)
TLS| HS.next_fragment PlaintextID?
HS | next_fragment
TLS| HS.next_fragment returned nothing
TLS| sendHandshake
TLS| read: WrittenHS, Ctrl/Ctrl, nothing
TLS| Read fragment at epoch index: -1 of length 3072
TLS| read Handshake fragment
HS | recv_fragment
HSL| parsed Certificate
HSL| more bytes required
TLS| readOne ReadAgain
TLS| writeHandshake (plaintext)
TLS| HS.next_fragment PlaintextID?
HS | next_fragment
TLS| HS.next_fragment returned nothing
TLS| sendHandshake
TLS| read: WrittenHS, Ctrl/Ctrl, nothing
TLS| Read fragment at epoch index: -1 of length 116
TLS| read Handshake fragment
HS | recv_fragment
HSL| parsed ServerKeyExchange
HSL| more bytes required
TLS| readOne ReadAgain
TLS| writeHandshake (plaintext)
TLS| HS.next_fragment PlaintextID?
HS | next_fragment
TLS| HS.next_fragment returned nothing
TLS| sendHandshake
TLS| read: WrittenHS, Ctrl/Ctrl, nothing
TLS| Read fragment at epoch index: -1 of length 4
TLS| read Handshake fragment
HS | recv_fragment
HSL| parsed ServerHelloDone
HSL| end of flight
HS | processing ...ServerHelloDone
NGO| ServerKeyExchange signature: Valid
CDH| Keygen (responder) on X255519
CDH| DH initiator on X255519
KS | Share: 8079f97b13d22595332244edeb2fc692ff460cfadab147f49d46e029e0786510
KS | Share: 88b1c182c4d967566c8ac2113c22195800085de5b6e06eeed987bc21287a2055
KS | PMS: fc28fc7a1796bbb7ebe6969fb5bbdd54d6480a428746ee0a7a5ae1de41752274
HSL| emit ClientKeyExchange and hash
KS | ks_client_12_set_session_hash hashed_log = 2cb404e35bf4d57fe5cb4ba88a1e7ace1dff1b518e1293015c288d416b0140c7
KS | extended master secret:cc88f3fbeb20ea20a0f3488f68713fa8e65880fd72d4edc7e3b9e187ba8a4746f21ad63ff307643337507ee84ed9fe26
KS | ks_12_record_key
KS | keystring (CK, CIV, SK, SIV) = eb2df9ac94c939acfd65159c7de237eab8fce9eafdd53587cd9f9d722066eef19a244211ff151e1a
AEP| LowProvider: COERCE(K=eb2df9ac94c939acfd65159c7de237ea)
AEP| LowProvider: COERCE(K=b8fce9eafdd53587cd9f9d722066eef1)
HS | digest is 2cb404e35bf4d57fe5cb4ba88a1e7ace1dff1b518e1293015c288d416b0140c7
TLS| readOne ReadAgain
TLS| writeHandshake (plaintext)
TLS| HS.next_fragment PlaintextID?
HS | next_fragment
TLS| HS.next_fragment returned a fragment; CCS; next_keys (for handshake only
TLS| sendHandshake
TLS| send Handshake fragment with index PlaintextID
TLS| Sending fragment of length 37
REC| record headers: 1603030025
TLS| send CCS fragment with index PlaintextID
TLS| Sending fragment of length 1
REC| record headers: 1403030001
EPO| writer++ -1/0
TLS| writeHandshake (encrypted)
TLS| HS.next_fragment ID12?
HS | next_fragment
TLS| HS.next_fragment returned a fragment
TLS| sendHandshake
TLS| send Handshake fragment with index ID12
TLS| Sending fragment of length 40
REC| record headers: 1603030028
TLS| writeHandshake (encrypted)
TLS| HS.next_fragment ID12?
HS | next_fragment
TLS| HS.next_fragment returned nothing
TLS| sendHandshake
TLS| read: WrittenHS, Ctrl/Ctrl, new writer: handshake-only
TLS| ignore handshake-specifc key change; calling read again
TLS| writeHandshake (encrypted)
TLS| HS.next_fragment ID12?
HS | next_fragment
TLS| HS.next_fragment returned nothing
TLS| sendHandshake
TLS| read: WrittenHS, Ctrl/Ctrl, nothing
TLS| Read fragment at epoch index: -1 of length 228
TLS| read Handshake fragment
HS | recv_fragment
HSL| parsed NewSessionTicket
HSL| more bytes required
TLS| readOne ReadAgain
TLS| writeHandshake (encrypted)
TLS| HS.next_fragment ID12?
HS | next_fragment
TLS| HS.next_fragment returned nothing
TLS| sendHandshake
TLS| read: WrittenHS, Ctrl/Ctrl, nothing
TLS| Read fragment at epoch index: -1 of length 1
TLS| read CCS fragment
HS | recv_ccs
HS | Processing server CCS (full handshake). Ticket: 00ed68b0f2fb668fca42a23b5b2cf97cc55b4bf07bd88af2cd74c9a937be0e699049cbdd60ae1714629c38e7450fda3d400054e186711730fc76ca5999b75eb3cd344dc8cefdbfdc3a7a2a545c2d8ae68c726d1cc7efd60e00467b154db3798884d2c7f69328c6b30efb39b07bccf7ef903179bbc68e8df96bb397dbbb4f4f965fb66dfb7a62fe5d5f20711388776530e8022694887f69cbfd94221370d1e92e3eddb51f4a066b9cbb1b05842ce58963e1b590d0d8d124535c46981667df40226af163582aaf7d458cd6043c69b6fdef404f22d814e0936e6bec
EPO| reader++ 0/0
TLS| readOne ReadAgainFinishing
TLS| writeHandshake (encrypted)
TLS| HS.next_fragment ID12?
HS | next_fragment
TLS| HS.next_fragment returned nothing
TLS| sendHandshake
TLS| read: WrittenHS, Ctrl/Ctrl, nothing
TLS| Read fragment at epoch index: 0 of length 40
TLS| StAE decrypt correct.
TLS| read Handshake fragment
HS | recv_fragment
HSL| parsed Finished
HSL| end of flight
TLS| readOne Complete
FFI| Read returned Complete
Read OK, sending HTTP request...
TLS| writeHandshake (encrypted)
TLS| HS.next_fragment ID12?
HS | next_fragment
TLS| HS.next_fragment returned nothing
TLS| sendHandshake
TLS| send Data fragment with index ID12
TLS| Sending fragment of length 60
REC| record headers: 170303003c
TLS| writeHandshake (encrypted)
TLS| HS.next_fragment ID12?
HS | next_fragment
TLS| HS.next_fragment returned nothing
TLS| sendHandshake
TLS| read: WrittenHS, Open/Open, nothing
TLS| Read fragment at epoch index: 0 of length 620
TLS| StAE decrypt correct.
TLS| read Data fragment
TLS| readOne Read 596 bytes of data
Received 596 bytes of data:
Download speed: 1.#INF00kB/s
HTTP/1.1 301 Moved Permanently
Location: https://www.google.com/
Content-Type: text/html; charset=UTF-8
Date: Thu, 14 Jun 2018 22:49:06 GMT
Expires: Sat, 14 Jul 2018 22:49:06 GMT
Cache-Control: public, max-age=2592000
Server: gws
Content-Length: 220
X-XSS-Protection: 1; mode=block
X-Frame-Options: SAMEORIGIN
Alt-Svc: quic=":443"; ma=2592000; v="43,42,41,39,35"

<HTML><HEAD><meta http-equiv="content-type" content="text/html;charset=utf-8">
<TITLE>301 Moved</TITLE></HEAD><BODY>
<H1>301 Moved</H1>
The document has moved
<A HREF="https://www.google.com/">here</A>.
</BODY></HTML>

Closing connection, irrespective of the response
./cmitls.exe tls13.cloudflare.com 443
cmitls.exe ===================
cmitls.exe calling FFI_mitls_init
cmitls.exe about to act as client or server
===============================================
Starting test client...
FFI| Setting up certificate callbacks.
FFI| Setting a new server negotiation callback.
TLS| writeHandshake (plaintext)
TLS| HS.next_fragment PlaintextID?
HS | next_fragment
HS | offering ClientHello 1.3
KS | ks_client_init 1.3
CDH| Keygen (initiator) on X255519
NGO| No PSK or 0-RTT disabled
NGO| offering client extensions [ supported_versions key_share server_name session_ticket extended_master_secret signature_algorithms ec_point_formats supported_groups psk_key_exchange_modes ]
NGO| offering cipher suites ; TLS_AES_128_GCM_SHA256; TLS_AES_256_GCM_SHA384; TLS_CHACHA20_POLY1305_SHA256; TLS_ECDHE_ECDSA_WITH_AES_128_GCM_SHA256; TLS_ECDHE_RSA_WITH_AES_128_GCM_SHA256; TLS_DHE_RSA_WITH_AES_128_GCM_SHA256; TLS_ECDHE_ECDSA_WITH_AES_256_GCM_SHA384; TLS_ECDHE_RSA_WITH_AES_256_GCM_SHA384; TLS_DHE_RSA_WITH_AES_256_GCM_SHA384; TLS_ECDHE_ECDSA_WITH_CHACHA20_POLY1305_SHA256; TLS_ECDHE_RSA_WITH_CHACHA20_POLY1305_SHA256; TLS_DHE_RSA_WITH_CHACHA20_POLY1305_SHA256
HSL| emit ClientHello
TLS| HS.next_fragment returned a fragment
TLS| sendHandshake
TLS| send Handshake fragment with index PlaintextID
TLS| Sending fragment of length 218
REC| record headers: 16030300da
TLS| writeHandshake (plaintext)
TLS| HS.next_fragment PlaintextID?
HS | next_fragment
TLS| HS.next_fragment returned nothing
TLS| sendHandshake
TLS| read: WrittenHS, Ctrl/Ctrl, nothing
TLS| Read fragment at epoch index: -1 of length 90
TLS| read Handshake fragment
HS | recv_fragment
HSL| parsed ServerHello
HSL| end of flight
HS | client_ServerHello
NGO| processing server extensions [ key_share supported_versions ]
NGO| negotiated 1.3 TLS_AES_128_GCM_SHA256
HS | Running TLS 1.3
KS | ks_client_13_sh hashed_log = 3f05d9664f6c359e8ebbf8fde54dc2c7648cc242d158c51d1389aba0475b0906
KS | no PSK negotiated. Early secret: 33ad0a1c607ec03b09e6cd9893680ce210adf300aa1f2660e1b22e10f170f92a
KS | handshake salt:                  6f2615a108c702c5678f54fc9dbab69716c076189c48250cebeac3576c3611ba
CDH| DH initiator on X255519
KS | DH shared secret: 008f0ab1655bcfec925325d94639480b592449f330c41b4e3f264be4adafb649
KS | handshake secret:                85f9620e06c728406d4b11ac3655ca955b7142b97a81f32d2adb4adb140da982
KS | handshake traffic secret[C]:     20572335287835a1e3700274908e7b1071c8399dcdb2478e52e2c587d16b6c33
KS | handshake traffic secret[S]:     6fda21575c03e6c87cb6aa37e47602937eb2aa8764300f31a37da80b1d851bf3
KS | handshake key[C]:                e477c9e803f39071882b0bb07e07dfd4, IV=74f3d78fa2f16a16dfca7a90
KS | handshake key[S]:                718edca088ee1d8668736aacfbb7f5c1, IV=34cb6045beb1b93e35fb9be7
KS | finished key[C]: 155938b3be6ce38fc17b9b16a4011f547bf7da21defc5ddb19d901e434fa390e
KS | finished key[S]: d08c82720bad59b680c6212c2032d1be1c45fdc1c402c14f8d16c56909d9c661
KS | application salt:                5f275cd46614e33d8134461102895880ec197ec42b8736b17a90402420176748
KS | application secret:              27634b40c4719a99e0158358ce2c0b9deff75a4639633d26d12467381e5ba31d
AEP| LowProvider: COERCE(K=e477c9e803f39071882b0bb07e07dfd4)
AEP| LowProvider: COERCE(K=718edca088ee1d8668736aacfbb7f5c1)
EPO| reader++ 0/-1
TLS| readOne ReadAgain
TLS| writeHandshake (plaintext)
TLS| HS.next_fragment PlaintextID?
HS | next_fragment
TLS| HS.next_fragment returned nothing
TLS| sendHandshake
TLS| read: WrittenHS, Ctrl/Ctrl, nothing
TLS| Read fragment at epoch index: 0 of length 1
TLS| Ignoring a CCS
TLS| Read fragment at epoch index: 0 of length 3366
TLS| StAE decrypt correct.
TLS| read Handshake fragment
HS | recv_fragment
HSL| parsed EncryptedExtensions
HSL| parsed Certificate13
HSL| parsed CertificateVerify
HSL| parsed Finished
HSL| end of flight
NGO| Nego.clientComplete_13
NGO| EE: 
NGO| Negotiation callback to process application extensions.
@@@@ Nego callback for TLS 1.3 @@@@
Offered extensions:
0000
No application cookie (fist connection).
@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
NGO| Certificate & signature 1.3 callback result: valid
KS | ks_client_13_sf hashed_log = 61da6140e946ea3f8a5d75408711756366df73811c0029054e5136b6c161bdc3
+ cd mitls-fstar/apps/quicMinusNet
KS | application traffic secret[C]:   ff5ee6cc4c5030cc45f6d2394650ce6d5259c385b0527e9ca83d5d1c3cc2762e
+ make test
KS | application traffic secret[S]:   6f2bc2c5f0ef4e35ff3dc31792dc49b6256fd5d518e635277ea4879db9428645
KS | exporter master secret:          e628f83427b3b53386f27397155ec441e6abd6888f1947de5057311a398b7e18
KS | application key[C]:              b1f746729c079a757018396705d8635c, IV=da7d08945c27d978d9b12d44
KS | application key[S]:              81bc48118771fe7e7045d49e28b6aeed, IV=fab5e4dc7a8d6a2fd0a79b85
AEP| LowProvider: COERCE(K=b1f746729c079a757018396705d8635c)
AEP| LowProvider: COERCE(K=81bc48118771fe7e7045d49e28b6aeed)
HS | exporting a key
HS | Early data rejected
EPO| writer++ 0/0
HSL| emit Finished and hash
KS | ks_client_13_cf hashed_log = 7da16a06975f927a04736599e8f3048a1ff0f0eafffcb92428860b954b04188a
KS | resumption master secret:        275fc0e69a5da33d4d5a821673ca88e3154f55ce19f57d7e3402cef6bd37582f
EPO| reader++ 1/0
TLS| readOne ReadAgain
TLS| writeHandshake (encrypted)
TLS| HS.next_fragment ID13?
HS | next_fragment
TLS| HS.next_fragment returned a fragment; next_keys (for all data); complete
TLS| sendHandshake
TLS| send Handshake fragment with index ID13
TLS| Encrypting with key 637c777bf26b6fc53001672bfed7ab76
TLS| Sending fragment of length 53
REC| record headers: 1703030035
EPO| writer++ 1/1
TLS| read: WrittenHS, Open/Open, new writer: complete
FFI| Read returned Complete
Read OK, sending HTTP request...
TLS| writeHandshake (encrypted)
TLS| HS.next_fragment ID13?
HS | next_fragment
TLS| HS.next_fragment returned nothing
TLS| sendHandshake
TLS| send Data fragment with index ID13
TLS| Encrypting with key 637c777bf26b6fc53001672bfed7ab76
TLS| Sending fragment of length 63
REC| record headers: 170303003f
TLS| writeHandshake (encrypted)
TLS| HS.next_fragment ID13?
HS | next_fragment
TLS| HS.next_fragment returned nothing
TLS| sendHandshake
TLS| read: WrittenHS, Open/Open, nothing
TLS| Read fragment at epoch index: 1 of length 461
TLS| StAE decrypt correct.
TLS| read Handshake fragment
HS | recv_fragment
HSL| parsed NewSessionTicket13
HSL| end of flight (bytes waiting)
HS | Received ticket: ecd4bc7d9d1776d4c53d7f957b8bc725619d62dbd0b160b988d80189e18bde1fb6e1cc5e6223cb913cc5bdfa19d289b0b002476902bd17ef058936e6b07dcb2afc5a9728b13345fbb10d95d917483820b9555e5114a5f1998ee162eef1c5865de5aceffb0f3b9b19ee8dd50144fae2a417bfbf42bb5a13a11f10221c77e9387157c0747d9ed7737cf130788ef4d0f5a3e9ce264b9913187dc2fc812572b76dac423ad331dfdfae8bb54d94d0dc23dbdeb7c16c6d74a37a8b35607aabee329cd0
KS | ks_client_13_rms
KS | Recall RMS: 275fc0e69a5da33d4d5a821673ca88e3154f55ce19f57d7e3402cef6bd37582f
TLS| readOne ReadAgain
TLS| writeHandshake (encrypted)
TLS| HS.next_fragment ID13?
HS | next_fragment
TLS| HS.next_fragment returned nothing
TLS| sendHandshake
TLS| read: WrittenHS, Open/Open, nothing
TLS| Read fragment at epoch index: 1 of length 1386
TLS| StAE decrypt correct.
TLS| read Data fragment
TLS| readOne Read 1369 bytes of data
Received 1369 bytes of data:
Download speed: 1.#INF00kB/s
HTTP/1.1 521 Origin Down
Date: Thu, 14 Jun 2018 22:49:06 GMT
Content-Type: text/html; charset=UTF-8
Transfer-Encoding: chunked
Connection: keep-alive
Set-Cookie: __cfduid=deae78bd1d45a2cd87542654593ee55be1529016546; expires=Fri, 14-Jun-19 22:49:06 GMT; path=/; domain=.cloudflare.com; HttpOnly
Expires: Thu, 01 Jan 1970 00:00:01 GMT
Cache-Control: no-store, no-cache, must-revalidate, post-check=0, pre-check=0
Pragma: no-cache
X-Frame-Options: SAMEORIGIN
Set-Cookie: cf_use_ob=443; expires=Thu, 14-Jun-18 22:49:36 GMT; path=/
Set-Cookie: cf_ob_info=521:42b059284f1d2a37:SEA; expires=Thu, 14-Jun-18 22:49:36 GMT; path=/
Strict-Transport-Security: max-age=15780000; includeSubDomains
Expect-CT: max-age=604800, report-uri="https://report-uri.cloudflare.com/cdn-cgi/beacon/expect-ct"
Server: cloudflare
CF-RAY: 42b059284f1d2a37-SEA

11c7
<!DOCTYPE html>
<!--[if lt IE 7]> <html class="no-js ie6 oldie" lang="en-US"> <![endif]-->
<!--[if IE 7]>    <html class="no-js ie7 oldie" lang="en-US"> <![endif]-->
<!--[if IE 8]>    <html class="no-js ie8 oldie" lang="en-US"> <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en-US"> <!--<![endif]-->
<head>
<meta http-equiv="refresh" content="0">

<title>tls13.cloudflare.com | 521: Web server is down</title>
<meta charset="UTF-8" />
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8
Closing connection, irrespective of the response
./quic.exe
server create
FFI| offering custom extension 001a
FFI| extension contents: ffff00050a0b0c0d0e
FFI| setting early data limit to ffffffff
FFI| Setting a new ticket callback.
FFI| Setting a new server negotiation callback.
FFI| Setting up certificate callbacks.
client create
FFI| offering custom extension 001a
FFI| extension contents: ffff00050a0b0c0d0e
FFI| setting early data limit to ffffffff
FFI| Setting a new ticket callback.
FFI| Setting a new server negotiation callback.
FFI| Setting up certificate callbacks.
client call clen=8192 slen=   0
TLS| writeHandshake (plaintext)
TLS| HS.next_fragment PlaintextID?
HS | next_fragment
HS | offering ClientHello 1.3
KS | ks_client_init 1.3
CDH| Keygen (initiator) on X255519
NGO| No PSK or 0-RTT disabled
NGO| offering client extensions [ 001a supported_versions key_share server_name alpn extended_master_secret signature_algorithms supported_groups psk_key_exchange_modes ]
NGO| offering cipher suites ; TLS_CHACHA20_POLY1305_SHA256; TLS_AES_128_GCM_SHA256
HSL| emit ClientHello
TLS| HS.next_fragment returned a fragment
TLS| sendHandshake
TLS| send Handshake fragment with index PlaintextID
TLS| Sending fragment of length 170
REC| record headers: 16030300aa
TLS| writeHandshake (plaintext)
TLS| HS.next_fragment PlaintextID?
HS | next_fragment
TLS| HS.next_fragment returned nothing
TLS| sendHandshake
TLS| read: WrittenHS, Ctrl/Ctrl, nothing
REC| WouldBlock
TLS| readOne ReadWouldBlock
client done clen= 175 slen=   0 status=would_block
16030300aa010000a603035b22f0e31ac6361e8eaa2c12f9cd4459fb6cc22ddc
e4c77413104a4525875ad10000041303130101000079001a0009ffff00050a0b
0c0d0e002b0003027f1c003300260024001d00201600cdeefc92645c85e62d81
ffdf64589c226d1408849f936ac00d2f9cd0df100000000e000c0000096c6f63
616c686f73740010000800060568712d313000170000000d0006000408040403
000a00040002001d002d0003020001
server call clen= 175 slen=8192
TLS| writeHandshake (plaintext)
TLS| HS.next_fragment PlaintextID?
HS | next_fragment
TLS| HS.next_fragment returned nothing
TLS| sendHandshake
TLS| read: WrittenHS, Ctrl/Ctrl, nothing
TLS| Read fragment at epoch index: -1 of length 170
TLS| read Handshake fragment
HS | recv_fragment
HSL| parsed [ClientHello] -- end of flight 
HS | Processing ClientHello
NGO| offered client extensions [ 001a supported_versions key_share server_name alpn extended_master_secret signature_algorithms supported_groups psk_key_exchange_modes ]
NGO| offered cipher suites ; TLS_CHACHA20_POLY1305_SHA256; TLS_AES_128_GCM_SHA256
NGO| offered versions 1.3
NGO| Negotiated Pure EDH key exchange
NGO| Negotiated ECDSA_SECP256R1_SHA256
NGO| Negotiation callback to handle extra extensions and query for stateless retry.
NGO| Application data in cookie: none
@@@@ Nego callback for TLS 1.3 @@@@
Offered extensions:
003d001a0009ffff00050a0b0c0d0e0000000e000c0000096c6f63616c686f73
740010000800060568712d3130000d0006000408040403000a00040002001d
Transport parameters offered:
ffff00050a0b0c0d0e
No application cookie (fist connection).
Adding server transport parameters:
000102
@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
NGO| negotiated 1.3 TLS_CHACHA20_POLY1305_SHA256
KS | ks_server_init
KS | No PSK selected.
KS | Computed early secret:           33ad0a1c607ec03b09e6cd9893680ce210adf300aa1f2660e1b22e10f170f92a
KS | Handshake salt:                  6f2615a108c702c5678f54fc9dbab69716c076189c48250cebeac3576c3611ba
CDH| Keygen (responder) on X255519
CDH| DH initiator on X255519
KS | DH shared secret: aa1d89d0f7d4b12472162b040b7ad0b46074cf8b8ca8c74e774a3cfdbc189c14
KS | Handshake secret:                ca64bf348cc384e8c140bfc854018084d38e0711d6085b1bb094be1426025e48
NGO| processing client extensions [ 001a supported_versions key_share server_name alpn extended_master_secret signature_algorithms supported_groups psk_key_exchange_modes ]
NGO| including server extensions (SH + EE) [ supported_versions key_share alpn supported_groups ]
NGO| extra extensions from application callback: 001a 
HSL| emit ServerHello and hash
HS | derive handshake keys
KS | ks_server_13_sh, hashed log = 13300f012c16dfb55a5d98b1fb5642e0241d5cfc4930ac2edf386ab976cd0379
KS | handshake traffic secret[C]:     e2f69b84a5d111b7a8eec4f6c826b232293404d98f119ceb902d2c18890c7831
KS | handshake traffic secret[S]:     8c16d85e7eb562f36baa50e4f32d9614770d031bf7112f37394989f042dc37eb
KS | handshake key[C]:                7441c8c656510c6d759ca71b04e077093328c4f5bc00b3277ca6f5b19eb970b8, IV=80605729a528c8736c4f1f8f
KS | handshake key[S]: 329e0e3009083ab523f82ff2ace419c5c0e462974e82386716fbb0575ae4f632, IV=e3028201aaa9f4933e6f3c33
AEP| LowProvider: COERCE(K=329e0e3009083ab523f82ff2ace419c5c0e462974e82386716fbb0575ae4f632)
AEP| LowProvider: COERCE(K=7441c8c656510c6d759ca71b04e077093328c4f5bc00b3277ca6f5b19eb970b8)
KS | finished key[C]:                 81ae871bc2f4544260c61c140587edd86f4c255dff00dc2d0022ffa70f4d72d7
KS | finished key[S]:                 61ffc5f97cb04293186f9835427bd4e00fde1797d7d665643f9cdcf4731db77d
KS | Application salt:                143cfd0ee28c7e9d9f205a263273471c77dd6630981f7bef1ad760d2a96a1678
KS | Application secret:              c390d3ac520d535e78e5ad3c62d8ea00d22e25254926c12e779798405c7552ce
TLS| readOne ReadAgain
TLS| writeHandshake (plaintext)
TLS| HS.next_fragment PlaintextID?
HS | next_fragment
TLS| HS.next_fragment returned a fragment; next_keys (for handshake only
TLS| sendHandshake
TLS| send Handshake fragment with index PlaintextID
TLS| Sending fragment of length 90
REC| record headers: 160303005a
EPO| writer++ -1/0
TLS| writeHandshake (encrypted)
TLS| HS.next_fragment ID13?
HS | next_fragment
HS | prepare Server Finished
HSL| emit EncryptedExtensions
HSL| emit Certificate13 and hash
======== TO BE SIGNED <0403>: (130 octets) ========
2020202020202020202020202020202020202020202020202020202020202020
2020202020202020202020202020202020202020202020202020202020202020
544c5320312e332c207365727665722043657274696669636174655665726966
790057ff63ecc3431b24da81f1096a1166693ca71accec983601726edec6b5e6
4f4f
===================================================
HSL| emit CertificateVerify and hash
HSL| emit Finished and hash
KS | ks_server_13_sf hashed_log = d9008dbf6dab0750c0591ce90fd80e2e50a4948ab7d163544f54eabddfc83e12
KS | application traffic secret[C]:   0368e2924f95771fcf9bb626f4a87aedad046c79bd62d166df612c4e18d07769
KS | application traffic secret[S]:   1ab4f9b026b62054d03a3c45116facce90115c5441f5a8673e283a4e39fac94f
KS | exporter master secret:          3c9e4e3c952fb3c6e81e28e573aeb2931cc980462344cd8697a146c23d270a43
KS | application key[C]:              a8a6e493250c3c520e64c789f29a9382cc1c254e3c28eb8b4969f3936c62b602, IV=15b233f5054ab55c87c0c9db
KS | application key[S]:              7f20b19d87ff4c234302494cc8f98785448375554de12ad2837cff20e1f08394, IV=b18e751ae9009c85cd6844cc
AEP| LowProvider: COERCE(K=7f20b19d87ff4c234302494cc8f98785448375554de12ad2837cff20e1f08394)
AEP| LowProvider: COERCE(K=a8a6e493250c3c520e64c789f29a9382cc1c254e3c28eb8b4969f3936c62b602)
HS | exporting a key
EPO| reader++ 0/0
TLS| HS.next_fragment returned a fragment; next_keys (for all data)
TLS| sendHandshake
TLS| send Handshake fragment with index ID13
+ set +x
TLS| Encrypting with key 329e0e3009083ab523f82ff2ace419c5c0e462974e82386716fbb0575ae4f632
TLS| Sending fragment of length 735
REC| record headers: 17030302df
EPO| writer++ 0/1
TLS| read: WrittenHS, Ctrl/Open, new writer: writable
sender done clen= 175 slen= 835 status=server_accept
160303005a0200005603035b22f0e3dfe6ca41d42011acab6c53a4457a51d9d6
89adb37dfbe5f146c96a6900130300002e002b00027f1c00330024001d002082
609a3c59a28eb105299dec481086bc0e090def053d460493dbcf0d4bdf917517
030302df53540733ecc333263e8f07652e3189e91f0e44025e7be8b7d32ae968
8c858b765aee493ea6a0529c8cdd309014ea2bad3d8e573a8c35dcb7aee29405
9a596dcfe440b73e3e658b0ba969743acdd673e0f75d4a953c6cec5bc9516ef6
64cd51a8f6cf047d1dc7ffe129d398c3749a5f1df90d8fa0b262fb8dbf7a0e66
26869c35e1eb16fbf8c76ba511f474a9c1c5bed5ec01f19d6b25b223ddc40121
17e569fd869aa7b8bd0c1aa7886ed00c83971685530b8a7bb1c24cd2dd5aa290
c7e93206ce8147d9f8db15c46c9820fcbac84b0d6443f2d0c72f7f5c36fac544
608feb195e1d39dc962e219fa4a4c3bfccf9c33991fb1de97b4427a5ff4efa92
1d9199e329f68ddbb1d177e49c22ff3a123bf8880c331c9c0ad58ed659fd89b4
450f3a1f0c75417ea10e964ba45a45437335e47bb5ce6d2fa36e1f4fc2bbcd75
d94812aa95ed5adbe59673a1343f38ab48a1c680807ed62dd4cb6ade8dd794ec
87e5cf50587d7940a37f10346defd7d866fe6491390c9cab8493af26296a3b4e
e79a43b702b3a92ec31f3bedbd62386f04972b1e9bd9610f45a961c6a4e7a33a
136c2c2edc422c0024e8e4f5518e622a310715670d6f443e775917224843f5ef
912ce843b3a6b3c4be40667cfdb7e2bf9a68754081f885e23f373eeef26c92c3
6776f1a883478d153c55383e620746f097686a8fff07bc0964baae7e07198a11
742071732e552838e4aa5ab9ce803f61e3997d8c2610956f8f8e096485aabb99
d0c26b5b1833eb681fcc97d4e1b4b712ccb5e2de6e0ca8c6998e9861487d7ea1
855bac30a5f50003b9499123b647cd39c0c84c43bb18d9b85ddb4f72628301b5
07cdcf7ec166ec69c76832060172df82691544099e1f7f7c3baf8b0730725221
5fc3916d698577c74d611cb49fdaa29f4f95c7b615df05819f19a5ceb9363996
65003f86105b5af0b3463d235e6a4eeba3f2ae2502d8666d7f5f2b4a88142107
580d4468a76f1930d5de716f33921b8cd41961976c27172035bb2100123b63d1
186a9d
client call clen=8017 slen= 835
TLS| writeHandshake (plaintext)
TLS| HS.next_fragment PlaintextID?
HS | next_fragment
TLS| HS.next_fragment returned nothing
TLS| sendHandshake
TLS| read: WrittenHS, Ctrl/Ctrl, nothing
TLS| Read fragment at epoch index: -1 of length 90
TLS| read Handshake fragment
HS | recv_fragment
HSL| parsed ServerHello
HSL| end of flight
HS | client_ServerHello
NGO| processing server extensions [ supported_versions key_share ]
NGO| negotiated 1.3 TLS_CHACHA20_POLY1305_SHA256
HS | Running TLS 1.3
KS | ks_client_13_sh hashed_log = 13300f012c16dfb55a5d98b1fb5642e0241d5cfc4930ac2edf386ab976cd0379
KS | no PSK negotiated. Early secret: 33ad0a1c607ec03b09e6cd9893680ce210adf300aa1f2660e1b22e10f170f92a
KS | handshake salt:                  6f2615a108c702c5678f54fc9dbab69716c076189c48250cebeac3576c3611ba
CDH| DH initiator on X255519
KS | DH shared secret: aa1d89d0f7d4b12472162b040b7ad0b46074cf8b8ca8c74e774a3cfdbc189c14
KS | handshake secret:                ca64bf348cc384e8c140bfc854018084d38e0711d6085b1bb094be1426025e48
KS | handshake traffic secret[C]:     e2f69b84a5d111b7a8eec4f6c826b232293404d98f119ceb902d2c18890c7831
KS | handshake traffic secret[S]:     8c16d85e7eb562f36baa50e4f32d9614770d031bf7112f37394989f042dc37eb
KS | handshake key[C]:                7441c8c656510c6d759ca71b04e077093328c4f5bc00b3277ca6f5b19eb970b8, IV=80605729a528c8736c4f1f8f
KS | handshake key[S]:                329e0e3009083ab523f82ff2ace419c5c0e462974e82386716fbb0575ae4f632, IV=e3028201aaa9f4933e6f3c33
KS | finished key[C]: 81ae871bc2f4544260c61c140587edd86f4c255dff00dc2d0022ffa70f4d72d7
KS | finished key[S]: 61ffc5f97cb04293186f9835427bd4e00fde1797d7d665643f9cdcf4731db77d
KS | application salt:                143cfd0ee28c7e9d9f205a263273471c77dd6630981f7bef1ad760d2a96a1678
KS | application secret:              c390d3ac520d535e78e5ad3c62d8ea00d22e25254926c12e779798405c7552ce
AEP| LowProvider: COERCE(K=7441c8c656510c6d759ca71b04e077093328c4f5bc00b3277ca6f5b19eb970b8)
AEP| LowProvider: COERCE(K=329e0e3009083ab523f82ff2ace419c5c0e462974e82386716fbb0575ae4f632)
EPO| reader++ 0/-1
TLS| readOne ReadAgain
TLS| writeHandshake (plaintext)
TLS| HS.next_fragment PlaintextID?
HS | next_fragment
TLS| HS.next_fragment returned nothing
TLS| sendHandshake
TLS| read: WrittenHS, Ctrl/Ctrl, nothing
TLS| Read fragment at epoch index: 0 of length 735
TLS| StAE decrypt correct.
TLS| read Handshake fragment
HS | recv_fragment
HSL| parsed EncryptedExtensions
HSL| parsed Certificate13
HSL| parsed CertificateVerify
HSL| parsed Finished
HSL| end of flight
NGO| Nego.clientComplete_13
NGO| EE: alpn supported_groups 001a 
NGO| Negotiation callback to process application extensions.
@@@@ Nego callback for TLS 1.3 @@@@
Offered extensions:
001b0010000800060568712d3130000a00040002001d001a0003000102
Transport parameters offered:
000102
No application cookie (fist connection).
Adding server transport parameters:
000102
@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
WARNING: chain validation failed, ignoring.
NGO| Certificate & signature 1.3 callback result: valid
KS | ks_client_13_sf hashed_log = d9008dbf6dab0750c0591ce90fd80e2e50a4948ab7d163544f54eabddfc83e12
KS | application traffic secret[C]:   0368e2924f95771fcf9bb626f4a87aedad046c79bd62d166df612c4e18d07769
KS | application traffic secret[S]:   1ab4f9b026b62054d03a3c45116facce90115c5441f5a8673e283a4e39fac94f
KS | exporter master secret:          3c9e4e3c952fb3c6e81e28e573aeb2931cc980462344cd8697a146c23d270a43
KS | application key[C]:              a8a6e493250c3c520e64c789f29a9382cc1c254e3c28eb8b4969f3936c62b602, IV=15b233f5054ab55c87c0c9db
KS | application key[S]:              7f20b19d87ff4c234302494cc8f98785448375554de12ad2837cff20e1f08394, IV=b18e751ae9009c85cd6844cc
AEP| LowProvider: COERCE(K=a8a6e493250c3c520e64c789f29a9382cc1c254e3c28eb8b4969f3936c62b602)
AEP| LowProvider: COERCE(K=7f20b19d87ff4c234302494cc8f98785448375554de12ad2837cff20e1f08394)
HS | exporting a key
HS | Early data rejected
EPO| writer++ 0/0
HSL| emit Finished and hash
KS | ks_client_13_cf hashed_log = b1c8e827423c88ce50415a29dd91f8f7bff94a04e42489f3c4f800edcfe488d1
KS | resumption master secret:        d87c6b036345b249d8185026e752904014de98fb86c984e694e55bfe34cae995
EPO| reader++ 1/0
TLS| readOne ReadAgain
TLS| writeHandshake (encrypted)
TLS| HS.next_fragment ID13?
HS | next_fragment
TLS| HS.next_fragment returned a fragment; next_keys (for all data); complete
TLS| sendHandshake
TLS| send Handshake fragment with index ID13
TLS| Encrypting with key 7441c8c656510c6d759ca71b04e077093328c4f5bc00b3277ca6f5b19eb970b8
TLS| Sending fragment of length 53
REC| record headers: 1703030035
EPO| writer++ 1/1
TLS| read: WrittenHS, Open/Open, new writer: complete
client done clen=  58 slen= 835 status=client_complete
17030300351200f74bff3bf123c43bac036c48eb15ceab2559eaf115c2caf08c
860bd856c7028cd5c7e9bb3224fa97effa9a56e36326791944fe
server call clen=  58 slen=7357
TLS| writeHandshake (encrypted)
TLS| HS.next_fragment ID13?
HS | next_fragment
TLS| HS.next_fragment returned nothing
TLS| sendHandshake
TLS| read: WrittenHS, Ctrl/Open, nothing
TLS| Read fragment at epoch index: 0 of length 53
TLS| StAE decrypt correct.
TLS| read Handshake fragment
HS | recv_fragment
HSL| parsed Finished
HSL| end of flight
HS | Process Client Finished
KS | ks_server_13_cf hashed_log = b1c8e827423c88ce50415a29dd91f8f7bff94a04e42489f3c4f800edcfe488d1
KS | resumption master secret:        d87c6b036345b249d8185026e752904014de98fb86c984e694e55bfe34cae995
AEP| LowProvider: COERCE(K=f3bf977d595afbd2e70bd2efe9d9f4ff908b45c785990d7b2c6464722eb87f17)
HS | Sending ticket: 45b3a24edf1ece6a41fcbf5019e60d2cd598939605bbe025c6a93f6853d5457f9dcdbbd5480c2d7a53c8efeb4b8b96badc3ebd1fe85bc0380ff66aa78601171b1644d9752287abccb48c8245
HSL| emit NewSessionTicket13
EPO| reader++ 1/1
TLS| readOne Complete
sender done clen=  58 slen=   0 status=server_complete
=== Exporter secret ===
3c9e4e3c952fb3c6e81e28e573aeb2931cc980462344cd8697a146c23d270a43
=== QUIC 1-RTT secrets ===
C: 9165f4ffd08048e7e38d8fa232a5efa7a3f52f390f712d4d33519b620d2e1a50
S: 3fddadd7a3705a6970f61da4abe3da064078c5e2d52f3b098141198922bc5b99
=== AEAD client key test ===
b1783dd459bdc4fef0947cd16e08b95cca923aa4fd06e1fb77d0d3
=== Decrypt successful ===
Ok
./quic.exe 0rtt

INITIAL ECDHE HANDSHAKE (NO EARLY SECRET)

server create
FFI| offering custom extension 001a
FFI| extension contents: ffff00050a0b0c0d0e
FFI| setting early data limit to ffffffff
FFI| Setting a new ticket callback.
FFI| Setting a new server negotiation callback.
FFI| Setting up certificate callbacks.
client create
FFI| offering custom extension 001a
FFI| extension contents: ffff00050a0b0c0d0e
FFI| setting early data limit to ffffffff
FFI| Setting a new ticket callback.
FFI| Setting a new server negotiation callback.
FFI| Setting up certificate callbacks.
TLS| writeHandshake (plaintext)
TLS| HS.next_fragment PlaintextID?
HS | next_fragment
HS | offering ClientHello 1.3
KS | ks_client_init 1.3
CDH| Keygen (initiator) on X255519
NGO| No PSK or 0-RTT disabled
NGO| offering client extensions [ 001a supported_versions key_share server_name alpn extended_master_secret signature_algorithms supported_groups psk_key_exchange_modes ]
NGO| offering cipher suites ; TLS_CHACHA20_POLY1305_SHA256; TLS_AES_128_GCM_SHA256
HSL| emit ClientHello
TLS| HS.next_fragment returned a fragment
TLS| sendHandshake
TLS| send Handshake fragment with index PlaintextID
TLS| Sending fragment of length 170
REC| record headers: 16030300aa
TLS| writeHandshake (plaintext)
TLS| HS.next_fragment PlaintextID?
HS | next_fragment
TLS| HS.next_fragment returned nothing
TLS| sendHandshake
TLS| read: WrittenHS, Ctrl/Ctrl, nothing
REC| WouldBlock
TLS| readOne ReadWouldBlock
client returns would_block clen=175 slen=0
ClientHello[ 175] ---->

TLS| writeHandshake (plaintext)
TLS| HS.next_fragment PlaintextID?
HS | next_fragment
TLS| HS.next_fragment returned nothing
TLS| sendHandshake
TLS| read: WrittenHS, Ctrl/Ctrl, nothing
TLS| Read fragment at epoch index: -1 of length 170
TLS| read Handshake fragment
HS | recv_fragment
HSL| parsed [ClientHello] -- end of flight 
HS | Processing ClientHello
NGO| offered client extensions [ 001a supported_versions key_share server_name alpn extended_master_secret signature_algorithms supported_groups psk_key_exchange_modes ]
NGO| offered cipher suites ; TLS_CHACHA20_POLY1305_SHA256; TLS_AES_128_GCM_SHA256
NGO| offered versions 1.3
NGO| Negotiated Pure EDH key exchange
NGO| Negotiated ECDSA_SECP256R1_SHA256
NGO| Negotiation callback to handle extra extensions and query for stateless retry.
NGO| Application data in cookie: none
@@@@ Nego callback for TLS 1.3 @@@@
Offered extensions:
003d001a0009ffff00050a0b0c0d0e0000000e000c0000096c6f63616c686f73
740010000800060568712d3130000d0006000408040403000a00040002001d
Transport parameters offered:
ffff00050a0b0c0d0e
No application cookie (fist connection).
Adding server transport parameters:
000102
@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
NGO| negotiated 1.3 TLS_CHACHA20_POLY1305_SHA256
KS | ks_server_init
KS | No PSK selected.
KS | Computed early secret:           33ad0a1c607ec03b09e6cd9893680ce210adf300aa1f2660e1b22e10f170f92a
KS | Handshake salt:                  6f2615a108c702c5678f54fc9dbab69716c076189c48250cebeac3576c3611ba
CDH| Keygen (responder) on X255519
CDH| DH initiator on X255519
KS | DH shared secret: 6838913fa6f32e251f00b94f1c750a6b0fada4737eaa64667fedd09b3f38016f
KS | Handshake secret:                99e6b95d041aca2176ef418ec997a7d757e50afc85b6c6d05644fa784c5e7dd3
NGO| processing client extensions [ 001a supported_versions key_share server_name alpn extended_master_secret signature_algorithms supported_groups psk_key_exchange_modes ]
NGO| including server extensions (SH + EE) [ supported_versions key_share alpn supported_groups ]
NGO| extra extensions from application callback: 001a 
HSL| emit ServerHello and hash
HS | derive handshake keys
KS | ks_server_13_sh, hashed log = 28e9e18f81a904e8d8aea5c160aa967f7f546ddc63ae594c717554a7ce8f09fa
KS | handshake traffic secret[C]:     bc195aa8fe71312b0488a05bdf81f1f8a43013182fd4881a03393cee64a27576
KS | handshake traffic secret[S]:     2833f78197153f5076d8fbaf0318789a6d0a7c932f6d0a1af1de10aa5e723d07
KS | handshake key[C]:                c9f4e7e3faaad48972ac7777c8195eb450d54d4b33a5cbc96d9698ef46b3698e, IV=59c1e52cefca6084f57738b3
KS | handshake key[S]: c03afdac7b53bd4709d59ba1fef4e3864ca3056cf4879d15fccc5df23c226cf7, IV=d71ea68cafc306df87bde30e
AEP| LowProvider: COERCE(K=c03afdac7b53bd4709d59ba1fef4e3864ca3056cf4879d15fccc5df23c226cf7)
AEP| LowProvider: COERCE(K=c9f4e7e3faaad48972ac7777c8195eb450d54d4b33a5cbc96d9698ef46b3698e)
KS | finished key[C]:                 4b0699e2d0e5df8a23cac9c20b1016ea4fe396aae431ffce1239645a6c3ec8f3
KS | finished key[S]:                 f5c07a06361324620e52ebcda2a23b94a46afbcbf61350e858fd8e8dc5709947
KS | Application salt:                d6feb2c190e8958dd756b5f7457e08add65abc0826da6dcb7866ae9b5ea59bd6
KS | Application secret:              7abe9000c966e2f9b31bc541481b29970369902bed85b1100cdc3d9456593c0e
TLS| readOne ReadAgain
TLS| writeHandshake (plaintext)
TLS| HS.next_fragment PlaintextID?
HS | next_fragment
TLS| HS.next_fragment returned a fragment; next_keys (for handshake only
TLS| sendHandshake
TLS| send Handshake fragment with index PlaintextID
TLS| Sending fragment of length 90
REC| record headers: 160303005a
EPO| writer++ -1/0
TLS| writeHandshake (encrypted)
TLS| HS.next_fragment ID13?
HS | next_fragment
HS | prepare Server Finished
HSL| emit EncryptedExtensions
HSL| emit Certificate13 and hash
======== TO BE SIGNED <0403>: (130 octets) ========
2020202020202020202020202020202020202020202020202020202020202020
2020202020202020202020202020202020202020202020202020202020202020
544c5320312e332c207365727665722043657274696669636174655665726966
7900d4b31b4a36c93ea498dd18dfbb4c823ab3a26ebb8bd44475df8bddb94b5f
8d9d
===================================================
HSL| emit CertificateVerify and hash
HSL| emit Finished and hash
KS | ks_server_13_sf hashed_log = 627405c9eb9b9b76f8e4ae942168c0fa049e1cbedc4cf450ec16eac3ce864556
KS | application traffic secret[C]:   eec28dee5645e84bdc2a1c02007427ea4faffcbd5028fa488716998961099968
KS | application traffic secret[S]:   0c96ebc99ad148f099ae5576edc17bae7779d93c07e8e47eecb0a67da6aedb2e
KS | exporter master secret:          d38629ab4ffc61d603871ab71ecb5be7f89c843fa76b16712f964d7fe3c0c640
KS | application key[C]:              3577d05420e24ea04be822c6b4df593106ff9d6eb2e2abd8264b24aedb33e665, IV=a18ba1b292c91e400aee3160
KS | application key[S]:              f70c48ca58bc7baacc4344124c0b71d75c97527d2e74a8006c0ca92ee35a249c, IV=8ee425c05a9b44e0ebda2c3d
AEP| LowProvider: COERCE(K=f70c48ca58bc7baacc4344124c0b71d75c97527d2e74a8006c0ca92ee35a249c)
AEP| LowProvider: COERCE(K=3577d05420e24ea04be822c6b4df593106ff9d6eb2e2abd8264b24aedb33e665)
HS | exporting a key
EPO| reader++ 0/0
TLS| HS.next_fragment returned a fragment; next_keys (for all data)
TLS| sendHandshake
TLS| send Handshake fragment with index ID13
TLS| Encrypting with key c03afdac7b53bd4709d59ba1fef4e3864ca3056cf4879d15fccc5df23c226cf7
TLS| Sending fragment of length 733
REC| record headers: 17030302dd
EPO| writer++ 0/1
TLS| read: WrittenHS, Ctrl/Open, new writer: writable
server returns server_accept clen=175 slen=833
secret=d38629ab4ffc61d603871ab71ecb5be7f89c843fa76b16712f964d7fe3c0c640
<---- ServerHello;(EncryptedExtensions; Certificate; CertVerify; Finished)[ 833]

TLS| writeHandshake (plaintext)
TLS| HS.next_fragment PlaintextID?
HS | next_fragment
TLS| HS.next_fragment returned nothing
TLS| sendHandshake
TLS| read: WrittenHS, Ctrl/Ctrl, nothing
TLS| Read fragment at epoch index: -1 of length 90
TLS| read Handshake fragment
HS | recv_fragment
HSL| parsed ServerHello
HSL| end of flight
HS | client_ServerHello
NGO| processing server extensions [ supported_versions key_share ]
NGO| negotiated 1.3 TLS_CHACHA20_POLY1305_SHA256
HS | Running TLS 1.3
KS | ks_client_13_sh hashed_log = 28e9e18f81a904e8d8aea5c160aa967f7f546ddc63ae594c717554a7ce8f09fa
KS | no PSK negotiated. Early secret: 33ad0a1c607ec03b09e6cd9893680ce210adf300aa1f2660e1b22e10f170f92a
KS | handshake salt:                  6f2615a108c702c5678f54fc9dbab69716c076189c48250cebeac3576c3611ba
CDH| DH initiator on X255519
KS | DH shared secret: 6838913fa6f32e251f00b94f1c750a6b0fada4737eaa64667fedd09b3f38016f
KS | handshake secret:                99e6b95d041aca2176ef418ec997a7d757e50afc85b6c6d05644fa784c5e7dd3
KS | handshake traffic secret[C]:     bc195aa8fe71312b0488a05bdf81f1f8a43013182fd4881a03393cee64a27576
KS | handshake traffic secret[S]:     2833f78197153f5076d8fbaf0318789a6d0a7c932f6d0a1af1de10aa5e723d07
KS | handshake key[C]:                c9f4e7e3faaad48972ac7777c8195eb450d54d4b33a5cbc96d9698ef46b3698e, IV=59c1e52cefca6084f57738b3
KS | handshake key[S]:                c03afdac7b53bd4709d59ba1fef4e3864ca3056cf4879d15fccc5df23c226cf7, IV=d71ea68cafc306df87bde30e
KS | finished key[C]: 4b0699e2d0e5df8a23cac9c20b1016ea4fe396aae431ffce1239645a6c3ec8f3
KS | finished key[S]: f5c07a06361324620e52ebcda2a23b94a46afbcbf61350e858fd8e8dc5709947
KS | application salt:                d6feb2c190e8958dd756b5f7457e08add65abc0826da6dcb7866ae9b5ea59bd6
KS | application secret:              7abe9000c966e2f9b31bc541481b29970369902bed85b1100cdc3d9456593c0e
AEP| LowProvider: COERCE(K=c9f4e7e3faaad48972ac7777c8195eb450d54d4b33a5cbc96d9698ef46b3698e)
AEP| LowProvider: COERCE(K=c03afdac7b53bd4709d59ba1fef4e3864ca3056cf4879d15fccc5df23c226cf7)
EPO| reader++ 0/-1
TLS| readOne ReadAgain
TLS| writeHandshake (plaintext)
TLS| HS.next_fragment PlaintextID?
HS | next_fragment
TLS| HS.next_fragment returned nothing
TLS| sendHandshake
TLS| read: WrittenHS, Ctrl/Ctrl, nothing
TLS| Read fragment at epoch index: 0 of length 733
TLS| StAE decrypt correct.
TLS| read Handshake fragment
HS | recv_fragment
HSL| parsed EncryptedExtensions
HSL| parsed Certificate13
HSL| parsed CertificateVerify
HSL| parsed Finished
HSL| end of flight
NGO| Nego.clientComplete_13
NGO| EE: alpn supported_groups 001a 
NGO| Negotiation callback to process application extensions.
@@@@ Nego callback for TLS 1.3 @@@@
Offered extensions:
001b0010000800060568712d3130000a00040002001d001a0003000102
Transport parameters offered:
000102
No application cookie (fist connection).
Adding server transport parameters:
000102
@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
WARNING: chain validation failed, ignoring.
NGO| Certificate & signature 1.3 callback result: valid
KS | ks_client_13_sf hashed_log = 627405c9eb9b9b76f8e4ae942168c0fa049e1cbedc4cf450ec16eac3ce864556
KS | application traffic secret[C]:   eec28dee5645e84bdc2a1c02007427ea4faffcbd5028fa488716998961099968
KS | application traffic secret[S]:   0c96ebc99ad148f099ae5576edc17bae7779d93c07e8e47eecb0a67da6aedb2e
KS | exporter master secret:          d38629ab4ffc61d603871ab71ecb5be7f89c843fa76b16712f964d7fe3c0c640
KS | application key[C]:              3577d05420e24ea04be822c6b4df593106ff9d6eb2e2abd8264b24aedb33e665, IV=a18ba1b292c91e400aee3160
KS | application key[S]:              f70c48ca58bc7baacc4344124c0b71d75c97527d2e74a8006c0ca92ee35a249c, IV=8ee425c05a9b44e0ebda2c3d
AEP| LowProvider: COERCE(K=3577d05420e24ea04be822c6b4df593106ff9d6eb2e2abd8264b24aedb33e665)
AEP| LowProvider: COERCE(K=f70c48ca58bc7baacc4344124c0b71d75c97527d2e74a8006c0ca92ee35a249c)
HS | exporting a key
HS | Early data rejected
EPO| writer++ 0/0
HSL| emit Finished and hash
KS | ks_client_13_cf hashed_log = 27d31f4aeb927f53da580a2667569e7c22af0782044404151232200f95a7723b
KS | resumption master secret:        59098b3c0028a4422b958986e10669024e870ac9d7fc1b1c35ecec9eb37668d3
EPO| reader++ 1/0
TLS| readOne ReadAgain
TLS| writeHandshake (encrypted)
TLS| HS.next_fragment ID13?
HS | next_fragment
TLS| HS.next_fragment returned a fragment; next_keys (for all data); complete
TLS| sendHandshake
TLS| send Handshake fragment with index ID13
TLS| Encrypting with key c9f4e7e3faaad48972ac7777c8195eb450d54d4b33a5cbc96d9698ef46b3698e
TLS| Sending fragment of length 53
REC| record headers: 1703030035
EPO| writer++ 1/1
TLS| read: WrittenHS, Open/Open, new writer: complete
client returns client_complete clen=58 slen=833
secret=d38629ab4ffc61d603871ab71ecb5be7f89c843fa76b16712f964d7fe3c0c640
(Finished) [  58] ---->

TLS| writeHandshake (encrypted)
TLS| HS.next_fragment ID13?
HS | next_fragment
TLS| HS.next_fragment returned nothing
TLS| sendHandshake
TLS| read: WrittenHS, Ctrl/Open, nothing
TLS| Read fragment at epoch index: 0 of length 53
TLS| StAE decrypt correct.
TLS| read Handshake fragment
HS | recv_fragment
HSL| parsed Finished
HSL| end of flight
HS | Process Client Finished
KS | ks_server_13_cf hashed_log = 27d31f4aeb927f53da580a2667569e7c22af0782044404151232200f95a7723b
KS | resumption master secret:        59098b3c0028a4422b958986e10669024e870ac9d7fc1b1c35ecec9eb37668d3
AEP| LowProvider: COERCE(K=40b4fcc565a0fb8eb20caccbb0be2707f3086610789c387b0b9171f8532182a2)
HS | Sending ticket: 482273ac995d1a4019da263a3cb90385b42f98ca63e7daf9e863474faf5c33c477d75c18475b13178e3617361dd5f1fbb92232e35fcc85920118750e8ebe8e1432b7a8455d6c7772cfd65749
HSL| emit NewSessionTicket13
EPO| reader++ 1/1
TLS| readOne Complete
server returns server_complete clen=58 slen=0
TLS| writeHandshake (encrypted)
TLS| HS.next_fragment ID13?
HS | next_fragment
TLS| HS.next_fragment returned a fragment
TLS| sendHandshake
TLS| send Handshake fragment with index ID13
TLS| Encrypting with key f70c48ca58bc7baacc4344124c0b71d75c97527d2e74a8006c0ca92ee35a249c
TLS| Sending fragment of length 130
REC| record headers: 1703030082
TLS| writeHandshake (encrypted)
TLS| HS.next_fragment ID13?
HS | next_fragment
TLS| HS.next_fragment returned nothing
TLS| sendHandshake
TLS| read: WrittenHS, Open/Open, nothing
REC| WouldBlock
TLS| readOne ReadWouldBlock
server returns would_block clen=0 slen=135
<---- {Ticket}[ 135]
TLS| writeHandshake (encrypted)
TLS| HS.next_fragment ID13?
HS | next_fragment
TLS| HS.next_fragment returned nothing
TLS| sendHandshake
TLS| read: WrittenHS, Open/Open, nothing
TLS| Read fragment at epoch index: 1 of length 130
TLS| StAE decrypt correct.
TLS| read Handshake fragment
HS | recv_fragment
HSL| parsed NewSessionTicket13
HSL| end of flight
HS | Received ticket: 482273ac995d1a4019da263a3cb90385b42f98ca63e7daf9e863474faf5c33c477d75c18475b13178e3617361dd5f1fbb92232e35fcc85920118750e8ebe8e1432b7a8455d6c7772cfd65749
KS | ks_client_13_rms
KS | Recall RMS: 59098b3c0028a4422b958986e10669024e870ac9d7fc1b1c35ecec9eb37668d3
AEP| LowProvider: COERCE(K=149baab6821c27db3ccae0a80f1f45c265f68a67a0a79d74ba100483edeb6460)

##### New session ticket received! #####
Host: localhost
Ticket:
482273ac995d1a4019da263a3cb90385b42f98ca63e7daf9e863474faf5c33c4
77d75c18475b13178e3617361dd5f1fbb92232e35fcc85920118750e8ebe8e14
32b7a8455d6c7772cfd65749
########################################
TLS| readOne ReadAgain
TLS| writeHandshake (encrypted)
TLS| HS.next_fragment ID13?
HS | next_fragment
TLS| HS.next_fragment returned nothing
TLS| sendHandshake
TLS| read: WrittenHS, Open/Open, nothing
REC| WouldBlock
TLS| readOne ReadWouldBlock
client returns clen=0 slen=135 status=would_block

TICKET-BASED RESUMPTION

server create
FFI| offering custom extension 001a
FFI| extension contents: ffff00050a0b0c0d0e
FFI| setting early data limit to ffffffff
FFI| Setting a new ticket callback.
FFI| Setting a new server negotiation callback.
FFI| Setting up certificate callbacks.
client create
FFI| offering custom extension 001a
FFI| extension contents: ffff00050a0b0c0d0e
FFI| setting early data limit to ffffffff
FFI| Setting a new ticket callback.
FFI| Setting a new server negotiation callback.
FFI| Setting up certificate callbacks.
TCK| Decrypting ticket e6e1de6e11ac90d594088d0a80a7eca53c5429dceb1d254fa7e7ba95a5c3b281d9d4df027a48d6b201713f070b8a9c0a4113aaf4f0ea8e4eabc5a6eaf0e3d0171f6fd00b0745b8a41fda46b2
TCK| Parsing ticket 030413035b22f0e39b182471000000205b72c38f4963297cef4aa8a012f685742f3099d26dba70ebb8208fc39cf4850b
TLS| writeHandshake (plaintext)
TLS| HS.next_fragment PlaintextID?
HS | next_fragment
HS | offering ClientHello 1.3
KS | ks_client_init 1.3
CDH| Keygen (initiator) on X255519
NGO| Offering a PSK compatible with 0-RTT
NGO| offering client extensions [ 001a supported_versions key_share server_name alpn extended_master_secret signature_algorithms supported_groups psk_key_exchange_modes early_data pre_shared_key ]
NGO| offering cipher suites ; TLS_CHACHA20_POLY1305_SHA256; TLS_AES_128_GCM_SHA256
HSL| emit ClientHello
KS | Loaded pre-shared key 482273ac995d1a4019da263a3cb90385b42f98ca63e7daf9e863474faf5c33c477d75c18475b13178e3617361dd5f1fbb92232e35fcc85920118750e8ebe8e1432b7a8455d6c7772cfd65749: 5b72c38f4963297cef4aa8a012f685742f3099d26dba70ebb8208fc39cf4850b
KS | Early secret: 06f42936eb6a29b3b8259813ee34463e77af0d3f4d7b78c7d8155b273caf02d0
KS | Binder key[res binder]: 77060f7f4ddf9b767c608efea980827de8ec07336d72df7f15102ef980cd4d1a
KS | Binder Finished key: 549575b171895b83d8febbc27d18095009067f4d4d1784b75ccb71f034767cc4
HSL| emit Binders
HS | setting up 0RTT
KS | ks_client_13_ch log=f744db531ad46298cde6e1f5d9ecc2b6b976a2bf85a2d077ff7f8bc29ae7fc38
KS | Client early traffic secret:     9c1548174b032c19d6d0176573b43a886a9c40ab28db5026fd7b11db9f439f50
KS | Early exporter master secret:    4f1ecd0f20dbd5f6e42d09b4301a7f0dfe5bad3975da7aa95da5e1d7be0d7436
KS | Client 0-RTT key:                93dfa997ab53a702df44b267a6e93379e86b5c78b0d653891a733f9b287c0001, IV=e8af6d1970fb1ad35be1c561
AEP| LowProvider: COERCE(K=93dfa997ab53a702df44b267a6e93379e86b5c78b0d653891a733f9b287c0001)
HS | exporting a key
TLS| HS.next_fragment returned a fragment; next_keys (for all data)
TLS| sendHandshake
TLS| send Handshake fragment with index PlaintextID
TLS| Sending fragment of length 297
REC| record headers: 1603030129
EPO| writer++ -1/0
TLS| read: WrittenHS, Ctrl/Open, new writer: writable
client returns client_early_data clen=302 slen=0
early secret=4f1ecd0f20dbd5f6e42d09b4301a7f0dfe5bad3975da7aa95da5e1d7be0d7436
ClientHello[ 302] ---->

TLS| writeHandshake (plaintext)
TLS| HS.next_fragment PlaintextID?
HS | next_fragment
TLS| HS.next_fragment returned nothing
TLS| sendHandshake
TLS| read: WrittenHS, Ctrl/Ctrl, nothing
TLS| Read fragment at epoch index: -1 of length 297
TLS| read Handshake fragment
HS | recv_fragment
HSL| parsed [ClientHello; Binders] -- end of flight 
HS | Processing ClientHello with 1 binder(s)
NGO| offered client extensions [ 001a supported_versions key_share server_name alpn extended_master_secret signature_algorithms supported_groups psk_key_exchange_modes early_data pre_shared_key ]
NGO| offered cipher suites ; TLS_CHACHA20_POLY1305_SHA256; TLS_AES_128_GCM_SHA256
NGO| offered versions 1.3
TCK| Decrypting ticket 482273ac995d1a4019da263a3cb90385b42f98ca63e7daf9e863474faf5c33c477d75c18475b13178e3617361dd5f1fbb92232e35fcc85920118750e8ebe8e1432b7a8455d6c7772cfd65749
TCK| Parsing ticket 030413035b22f0e39b1824710000002059098b3c0028a4422b958986e10669024e870ac9d7fc1b1c35ecec9eb37668d3
NGO| Negotiated PSK_EDH key exchange
NGO| Negotiation callback to handle extra extensions and query for stateless retry.
NGO| Application data in cookie: none
@@@@ Nego callback for TLS 1.3 @@@@
Offered extensions:
003d001a0009ffff00050a0b0c0d0e0000000e000c0000096c6f63616c686f73
740010000800060568712d3130000d0006000408040403000a00040002001d
Transport parameters offered:
ffff00050a0b0c0d0e
No application cookie (fist connection).
Adding server transport parameters:
000102
@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
NGO| negotiated 1.3 TLS_CHACHA20_POLY1305_SHA256
HS | accepted TLS 1.3 psk #0
KS | ks_server_init
KS | Using negotiated PSK identity: 482273ac995d1a4019da263a3cb90385b42f98ca63e7daf9e863474faf5c33c477d75c18475b13178e3617361dd5f1fbb92232e35fcc85920118750e8ebe8e1432b7a8455d6c7772cfd65749
TCK| Decrypting ticket 482273ac995d1a4019da263a3cb90385b42f98ca63e7daf9e863474faf5c33c477d75c18475b13178e3617361dd5f1fbb92232e35fcc85920118750e8ebe8e1432b7a8455d6c7772cfd65749
TCK| Parsing ticket 030413035b22f0e39b1824710000002059098b3c0028a4422b958986e10669024e870ac9d7fc1b1c35ecec9eb37668d3
KS | Ticket RMS: 59098b3c0028a4422b958986e10669024e870ac9d7fc1b1c35ecec9eb37668d3
KS | Pre-shared key: 5b72c38f4963297cef4aa8a012f685742f3099d26dba70ebb8208fc39cf4850b
KS | binder key:                      77060f7f4ddf9b767c608efea980827de8ec07336d72df7f15102ef980cd4d1a
KS | binder Finished key:             549575b171895b83d8febbc27d18095009067f4d4d1784b75ccb71f034767cc4
KS | Computed early secret:           06f42936eb6a29b3b8259813ee34463e77af0d3f4d7b78c7d8155b273caf02d0
KS | Handshake salt:                  c44943e4d7b55846dd28bde6caa8ef1f1f803df15a65d5aedc4bac362967e211
CDH| Keygen (responder) on X255519
CDH| DH initiator on X255519
KS | DH shared secret: f435ad75bbb60d77dbbb91b29279410eb1721a539c2c2253efca8a32b638e43e
KS | Handshake secret:                c3541ecf498103e8d7b79048254742592988804352c4b22281735695af677143
NGO| processing client extensions [ 001a supported_versions key_share server_name alpn extended_master_secret signature_algorithms supported_groups psk_key_exchange_modes early_data pre_shared_key ]
NGO| including server extensions (SH + EE) [ supported_versions key_share alpn supported_groups early_data pre_shared_key ]
NGO| extra extensions from application callback: 001a 
HSL| emit ServerHello and hash
KS | ks_server_13_0rtt_key
KS | Client early traffic secret:     9c1548174b032c19d6d0176573b43a886a9c40ab28db5026fd7b11db9f439f50
KS | Early exporter master secret:    4f1ecd0f20dbd5f6e42d09b4301a7f0dfe5bad3975da7aa95da5e1d7be0d7436
KS | Client 0-RTT key:                93dfa997ab53a702df44b267a6e93379e86b5c78b0d653891a733f9b287c0001, IV=e8af6d1970fb1ad35be1c561
AEP| LowProvider: COERCE(K=93dfa997ab53a702df44b267a6e93379e86b5c78b0d653891a733f9b287c0001)
HS | exporting a key
HS | derive handshake keys
KS | ks_server_13_sh, hashed log = a294ff83eb3e562638c73dce4c77811078b83afe55ad3f086d80d46126abc7f9
KS | handshake traffic secret[C]:     fe4591868390034558042789f40d0025d23441a76fa551fbd146c9d0a07a3d47
KS | handshake traffic secret[S]:     3203d1c3e11febe5032d9100501fa4892d6692400c22ad48328950dfde87a23a
KS | handshake key[C]:                b0355cc9295360e5d70355377b5e373bb970741125dd942926052e82c803d6a2, IV=136b485fc7e613ebc96dd652
KS | handshake key[S]: 382801ae3fb178cc4973f1a71f4b4b1320bf11778db6664a3c6e703e3b8aaf8e, IV=0a7dacc7380cf52ec77e2f95
AEP| LowProvider: COERCE(K=382801ae3fb178cc4973f1a71f4b4b1320bf11778db6664a3c6e703e3b8aaf8e)
AEP| LowProvider: COERCE(K=b0355cc9295360e5d70355377b5e373bb970741125dd942926052e82c803d6a2)
KS | finished key[C]:                 dd9eac5aec4184599e3e0b2171b806aa7d422f17ff9c7a64c78fb2d99842a45a
KS | finished key[S]:                 20188c247919b1e2a8391e3afece37e7d0ad1a3acf2ab5d9cb84c7402839b75e
KS | Application salt:                1d3d884fe3f15de48112ccc4a7dfa8274ded7cb7bc20697e0d91df477a8985a3
KS | Application secret:              16fff4c45613ca86f5a9566411f53a4353eafb1977836d8862ef2e76195e8403
TLS| readOne ReadAgain
TLS| writeHandshake (plaintext)
TLS| HS.next_fragment PlaintextID?
HS | next_fragment
TLS| HS.next_fragment returned a fragment; next_keys (for handshake only skipping 0RTT
TLS| sendHandshake
TLS| send Handshake fragment with index PlaintextID
TLS| Sending fragment of length 96
REC| record headers: 1603030060
EPO| writer++ -1/0
EPO| writer++ -1/1
TLS| writeHandshake (encrypted)
TLS| HS.next_fragment ID13?
HS | next_fragment
HS | prepare Server Finished
HSL| emit EncryptedExtensions and hash
HSL| emit Finished and hash
KS | ks_server_13_sf hashed_log = c262db0b0c34b4fa10af22260509f63e1b93c450078b6f4477110ddce578eda6
KS | application traffic secret[C]:   fd83f3e728086eb007e5081f603f374b8f3345c982baefdc36bfd566101244ee
KS | application traffic secret[S]:   4695f964c97876d9efba417c5a60b48559ea082251cef5aff1f33fe716e89b48
KS | exporter master secret:          3f22f548904f9b1619a5da9787b5c637c8a718ceac8807e3c4f2ba37cf976689
KS | application key[C]:              f0df6dcd5cb9034940380751a8b2ed25deb6d4aeff6276a22a30dbaa1c637b3e, IV=be2edfca2cd061d0431c5fa0
KS | application key[S]:              92d9c909ec98524af18b503a6278c5db66b4a2713388fec8d3cebcfd3a1e0401, IV=56322e5a90b63508a1de612f
AEP| LowProvider: COERCE(K=92d9c909ec98524af18b503a6278c5db66b4a2713388fec8d3cebcfd3a1e0401)
AEP| LowProvider: COERCE(K=f0df6dcd5cb9034940380751a8b2ed25deb6d4aeff6276a22a30dbaa1c637b3e)
HS | exporting a key
EPO| reader++ 0/1
TLS| HS.next_fragment returned a fragment; next_keys (for all data)
TLS| sendHandshake
TLS| send Handshake fragment with index ID13
TLS| Encrypting with key 382801ae3fb178cc4973f1a71f4b4b1320bf11778db6664a3c6e703e3b8aaf8e
TLS| Sending fragment of length 90
REC| record headers: 170303005a
EPO| writer++ 0/2
TLS| read: WrittenHS, Ctrl/Open, new writer: writable
server returns server_accept_early_data clen=302 slen=196
early secret=4f1ecd0f20dbd5f6e42d09b4301a7f0dfe5bad3975da7aa95da5e1d7be0d7436
secret=3f22f548904f9b1619a5da9787b5c637c8a718ceac8807e3c4f2ba37cf976689
<---- ServerHello;(EncryptedExtensions; Certificate; CertVerify; Finished)[ 196]

TLS| writeHandshake (encrypted)
TLS| HS.next_fragment ID13?
HS | next_fragment
TLS| HS.next_fragment returned nothing
TLS| sendHandshake
TLS| read: WrittenHS, Ctrl/Open, nothing
TLS| Read fragment at epoch index: -1 of length 96
TLS| read Handshake fragment
HS | recv_fragment
HSL| parsed ServerHello
HSL| end of flight
HS | client_ServerHello
NGO| processing server extensions [ supported_versions key_share pre_shared_key ]
NGO| negotiated 1.3 TLS_CHACHA20_POLY1305_SHA256
HS | Running TLS 1.3
KS | ks_client_13_sh hashed_log = a294ff83eb3e562638c73dce4c77811078b83afe55ad3f086d80d46126abc7f9
KS | recallPSK early secret:          06f42936eb6a29b3b8259813ee34463e77af0d3f4d7b78c7d8155b273caf02d0
KS | handshake salt:                  c44943e4d7b55846dd28bde6caa8ef1f1f803df15a65d5aedc4bac362967e211
CDH| DH initiator on X255519
KS | DH shared secret: f435ad75bbb60d77dbbb91b29279410eb1721a539c2c2253efca8a32b638e43e
KS | handshake secret:                c3541ecf498103e8d7b79048254742592988804352c4b22281735695af677143
KS | handshake traffic secret[C]:     fe4591868390034558042789f40d0025d23441a76fa551fbd146c9d0a07a3d47
KS | handshake traffic secret[S]:     3203d1c3e11febe5032d9100501fa4892d6692400c22ad48328950dfde87a23a
KS | handshake key[C]:                b0355cc9295360e5d70355377b5e373bb970741125dd942926052e82c803d6a2, IV=136b485fc7e613ebc96dd652
KS | handshake key[S]:                382801ae3fb178cc4973f1a71f4b4b1320bf11778db6664a3c6e703e3b8aaf8e, IV=0a7dacc7380cf52ec77e2f95
KS | finished key[C]: dd9eac5aec4184599e3e0b2171b806aa7d422f17ff9c7a64c78fb2d99842a45a
KS | finished key[S]: 20188c247919b1e2a8391e3afece37e7d0ad1a3acf2ab5d9cb84c7402839b75e
KS | application salt:                1d3d884fe3f15de48112ccc4a7dfa8274ded7cb7bc20697e0d91df477a8985a3
KS | application secret:              16fff4c45613ca86f5a9566411f53a4353eafb1977836d8862ef2e76195e8403
AEP| LowProvider: COERCE(K=b0355cc9295360e5d70355377b5e373bb970741125dd942926052e82c803d6a2)
AEP| LowProvider: COERCE(K=382801ae3fb178cc4973f1a71f4b4b1320bf11778db6664a3c6e703e3b8aaf8e)
HS | 0RTT potentially accepted (wait for EE to confirm)
EPO| reader++ 0/0
EPO| reader++ 1/0
TLS| readOne ReadAgain
TLS| writeHandshake (encrypted)
TLS| HS.next_fragment ID13?
HS | next_fragment
TLS| HS.next_fragment returned nothing
TLS| sendHandshake
TLS| read: WrittenHS, Ctrl/Open, nothing
TLS| Read fragment at epoch index: 1 of length 90
TLS| StAE decrypt correct.
TLS| read Handshake fragment
HS | recv_fragment
HSL| parsed EncryptedExtensions
HSL| parsed Finished
HSL| end of flight
NGO| Nego.clientComplete_13
NGO| EE: alpn supported_groups early_data 001a 
NGO| Negotiation callback to process application extensions.
@@@@ Nego callback for TLS 1.3 @@@@
Offered extensions:
001b0010000800060568712d3130000a00040002001d001a0003000102
Transport parameters offered:
000102
No application cookie (fist connection).
Adding server transport parameters:
000102
@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
NGO| Certificate & signature 1.3 callback result: valid
KS | ks_client_13_sf hashed_log = c262db0b0c34b4fa10af22260509f63e1b93c450078b6f4477110ddce578eda6
KS | application traffic secret[C]:   fd83f3e728086eb007e5081f603f374b8f3345c982baefdc36bfd566101244ee
KS | application traffic secret[S]:   4695f964c97876d9efba417c5a60b48559ea082251cef5aff1f33fe716e89b48
KS | exporter master secret:          3f22f548904f9b1619a5da9787b5c637c8a718ceac8807e3c4f2ba37cf976689
KS | application key[C]:              f0df6dcd5cb9034940380751a8b2ed25deb6d4aeff6276a22a30dbaa1c637b3e, IV=be2edfca2cd061d0431c5fa0
KS | application key[S]:              92d9c909ec98524af18b503a6278c5db66b4a2713388fec8d3cebcfd3a1e0401, IV=56322e5a90b63508a1de612f
AEP| LowProvider: COERCE(K=f0df6dcd5cb9034940380751a8b2ed25deb6d4aeff6276a22a30dbaa1c637b3e)
AEP| LowProvider: COERCE(K=92d9c909ec98524af18b503a6278c5db66b4a2713388fec8d3cebcfd3a1e0401)
HS | exporting a key
HS | Early data accepted; emitting EOED.
HSL| emit EndOfEarlyData and hash
TLS| readOne ReadAgain
TLS| writeHandshake (encrypted)
TLS| HS.next_fragment ID13?
HS | next_fragment
TLS| HS.next_fragment returned a fragment; next_keys (for handshake only
TLS| sendHandshake
TLS| send Handshake fragment with index ID13
TLS| Encrypting with key 93dfa997ab53a702df44b267a6e93379e86b5c78b0d653891a733f9b287c0001
TLS| Sending fragment of length 21
REC| record headers: 1703030015
EPO| writer++ 1/1
TLS| writeHandshake (encrypted)
TLS| HS.next_fragment ID13?
HS | next_fragment
HSL| emit Finished and hash
KS | ks_client_13_cf hashed_log = ad1ec7dff2d12069d156c8636966494c2d62bc9c16eb6eecb2b5921dfccb7b65
KS | resumption master secret:        8d4cc4ae3358c6f3f8ca6701dd1c45ef2dd787082cdc2a1322178247f381e8f6
EPO| reader++ 2/1
TLS| HS.next_fragment returned a fragment; next_keys (for all data); complete
TLS| sendHandshake
TLS| send Handshake fragment with index ID13
TLS| Encrypting with key b0355cc9295360e5d70355377b5e373bb970741125dd942926052e82c803d6a2
TLS| Sending fragment of length 53
REC| record headers: 1703030035
EPO| writer++ 2/2
TLS| read: WrittenHS, Open/Open, new writer: complete
client returns client_complete_early_data clen=84 slen=196
secret=3f22f548904f9b1619a5da9787b5c637c8a718ceac8807e3c4f2ba37cf976689
(Finished) [  84] ---->

TLS| writeHandshake (encrypted)
TLS| HS.next_fragment ID13?
HS | next_fragment
TLS| HS.next_fragment returned nothing
TLS| sendHandshake
TLS| read: WrittenHS, Ctrl/Open, nothing
TLS| Read fragment at epoch index: 0 of length 21
TLS| StAE decrypt correct.
TLS| read Handshake fragment
HS | recv_fragment
HSL| parsed EndOfEarlyData
HSL| end of flight
HS | Process EOED (increment reader to HS key)
EPO| reader++ 1/2
TLS| readOne ReadAgain
TLS| writeHandshake (encrypted)
TLS| HS.next_fragment ID13?
HS | next_fragment
TLS| HS.next_fragment returned nothing
TLS| sendHandshake
TLS| read: WrittenHS, Ctrl/Open, nothing
TLS| Read fragment at epoch index: 1 of length 53
TLS| StAE decrypt correct.
TLS| read Handshake fragment
HS | recv_fragment
HSL| parsed Finished
HSL| end of flight
HS | Process Client Finished
KS | ks_server_13_cf hashed_log = ad1ec7dff2d12069d156c8636966494c2d62bc9c16eb6eecb2b5921dfccb7b65
KS | resumption master secret:        8d4cc4ae3358c6f3f8ca6701dd1c45ef2dd787082cdc2a1322178247f381e8f6
HS | Sending ticket: 95b631ef0b5922b0b008bbeba77a6390064493d321fd4dfe2fcc59d71a6f7d96f7981db2968ed28f10a1e997008037afc26307b97a3f1aec69bb1b4e80955604ecef078af178c3d84aa8bff7
HSL| emit NewSessionTicket13
EPO| reader++ 2/2
TLS| readOne Complete
server returns clen=84 slen=0 status=server_complete
TLS| writeHandshake (encrypted)
TLS| HS.next_fragment ID13?
HS | next_fragment
TLS| HS.next_fragment returned a fragment
TLS| sendHandshake
TLS| send Handshake fragment with index ID13
TLS| Encrypting with key 92d9c909ec98524af18b503a6278c5db66b4a2713388fec8d3cebcfd3a1e0401
TLS| Sending fragment of length 130
REC| record headers: 1703030082
TLS| writeHandshake (encrypted)
TLS| HS.next_fragment ID13?
HS | next_fragment
TLS| HS.next_fragment returned nothing
TLS| sendHandshake
TLS| read: WrittenHS, Open/Open, nothing
REC| WouldBlock
TLS| readOne ReadWouldBlock
server returns would_block clen=0 slen=135
<---- {Ticket}[ 135]
TLS| writeHandshake (encrypted)
TLS| HS.next_fragment ID13?
HS | next_fragment
TLS| HS.next_fragment returned nothing
TLS| sendHandshake
TLS| read: WrittenHS, Open/Open, nothing
TLS| Read fragment at epoch index: 2 of length 130
TLS| StAE decrypt correct.
TLS| read Handshake fragment
HS | recv_fragment
HSL| parsed NewSessionTicket13
HSL| end of flight
HS | Received ticket: 95b631ef0b5922b0b008bbeba77a6390064493d321fd4dfe2fcc59d71a6f7d96f7981db2968ed28f10a1e997008037afc26307b97a3f1aec69bb1b4e80955604ecef078af178c3d84aa8bff7
KS | ks_client_13_rms
KS | Recall RMS: 8d4cc4ae3358c6f3f8ca6701dd1c45ef2dd787082cdc2a1322178247f381e8f6

##### New session ticket received! #####
Host: localhost
Ticket:
95b631ef0b5922b0b008bbeba77a6390064493d321fd4dfe2fcc59d71a6f7d96
f7981db2968ed28f10a1e997008037afc26307b97a3f1aec69bb1b4e80955604
ecef078af178c3d84aa8bff7
########################################
TLS| readOne ReadAgain
TLS| writeHandshake (encrypted)
TLS| HS.next_fragment ID13?
HS | next_fragment
TLS| HS.next_fragment returned nothing
TLS| sendHandshake
TLS| read: WrittenHS, Open/Open, nothing
REC| WouldBlock
TLS| readOne ReadWouldBlock
client returns clen=0 slen=135 status=would_block
Ok
./quic.exe hrr

STATELESS RETRY TEST

server create
FFI| offering custom extension 001a
FFI| extension contents: ffff00050a0b0c0d0e
FFI| setting early data limit to ffffffff
FFI| Setting a new ticket callback.
FFI| Setting a new server negotiation callback.
FFI| Setting up certificate callbacks.
client create
FFI| offering custom extension 001a
FFI| extension contents: ffff00050a0b0c0d0e
FFI| setting early data limit to ffffffff
FFI| Setting a new ticket callback.
FFI| Setting a new server negotiation callback.
FFI| Setting up certificate callbacks.
TLS| writeHandshake (plaintext)
TLS| HS.next_fragment PlaintextID?
HS | next_fragment
HS | offering ClientHello 1.3
KS | ks_client_init 1.3
CDH| Keygen (initiator) on X255519
NGO| No PSK or 0-RTT disabled
NGO| offering client extensions [ 001a supported_versions key_share server_name alpn extended_master_secret signature_algorithms supported_groups psk_key_exchange_modes ]
NGO| offering cipher suites ; TLS_CHACHA20_POLY1305_SHA256; TLS_AES_128_GCM_SHA256
HSL| emit ClientHello
TLS| HS.next_fragment returned a fragment
TLS| sendHandshake
TLS| send Handshake fragment with index PlaintextID
TLS| Sending fragment of length 170
REC| record headers: 16030300aa
TLS| writeHandshake (plaintext)
TLS| HS.next_fragment PlaintextID?
HS | next_fragment
TLS| HS.next_fragment returned nothing
TLS| sendHandshake
TLS| read: WrittenHS, Ctrl/Ctrl, nothing
REC| WouldBlock
TLS| readOne ReadWouldBlock
client returns would_block clen=175 slen=0
ClientHello[ 175] ---->

~~~~~~~~~ Client Hello Summary ~~~~~~~~~~~
~ SNI = localhost
~ ALPN = 00060568712d3130
~ Cookie = NULL
~ Extensions = 0079001a0009ffff00050a0b0c0d0e002b0003027f1c003300260024001d0020
190d536bf617a1f2ee6c94f9890bc4c6650b1d86089cc2822c07eafd40bcaf2d
0000000e000c0000096c6f63616c686f73740010000800060568712d31300017
0000000d0006000408040403000a00040002001d002d0003020001
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
TLS| writeHandshake (plaintext)
TLS| HS.next_fragment PlaintextID?
HS | next_fragment
TLS| HS.next_fragment returned nothing
TLS| sendHandshake
TLS| read: WrittenHS, Ctrl/Ctrl, nothing
TLS| Read fragment at epoch index: -1 of length 170
TLS| read Handshake fragment
HS | recv_fragment
HSL| parsed [ClientHello] -- end of flight 
HS | Processing ClientHello
NGO| offered client extensions [ 001a supported_versions key_share server_name alpn extended_master_secret signature_algorithms supported_groups psk_key_exchange_modes ]
NGO| offered cipher suites ; TLS_CHACHA20_POLY1305_SHA256; TLS_AES_128_GCM_SHA256
NGO| offered versions 1.3
NGO| Negotiated Pure EDH key exchange
NGO| Negotiated ECDSA_SECP256R1_SHA256
NGO| Negotiation callback to handle extra extensions and query for stateless retry.
NGO| Application data in cookie: none
@@@@ Nego callback for TLS 1.3 @@@@
Offered extensions:
003d001a0009ffff00050a0b0c0d0e0000000e000c0000096c6f63616c686f73
740010000800060568712d3130000d0006000408040403000a00040002001d
Transport parameters offered:
ffff00050a0b0c0d0e
No application cookie (fist connection).
Adding server transport parameters:
000102
@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
AEP| LowProvider: COERCE(K=251761ca2320acd5c2fb2e6440f89bfe682adb11997294b7525e1908d2ca8857)
TCK| Encrypting cookie: 0000320200002e0303cf21ad74e59a6111be1d8c021e65b891c2a211167abb8c5e079e09e2c8a8339c001303000006002b00027f1c20f3b072cbd2c56ab8fb387bc644791789eca78093b470fecddf439b796058bc9c000b48656c6c6f20576f726c64
TCK| Encrypted cookie:  0b0dbad3d195576c8387ea70abe073846a2549595229dc2cc4d9d0299df3fdf02dbbe21bd2eff69e830f8a7110d560bbe71d859d84ac58dd1fc997f6228b995cddb31072e4e21276f7d0d62b111024aebf6ab2ae1d59d039f445116f2e9ba48769463158a9466e9cb5ad6fe629f58a95626ca881a6e9de9e115c32cae6d3ac
HSL| emit HelloRetryRequest
TLS| readOne ReadAgain
TLS| writeHandshake (plaintext)
TLS| HS.next_fragment PlaintextID?
HS | next_fragment
TLS| HS.next_fragment returned a fragment
TLS| sendHandshake
TLS| send Handshake fragment with index PlaintextID
TLS| Sending fragment of length 183
REC| record headers: 16030300b7
TLS| writeHandshake (plaintext)
TLS| HS.next_fragment PlaintextID?
HS | next_fragment
TLS| HS.next_fragment returned nothing
TLS| sendHandshake
TLS| read: WrittenHS, Ctrl/Ctrl, nothing
REC| WouldBlock
TLS| readOne ReadWouldBlock
server returns server_stateless_retry clen=175 slen=188
<---- HRR[ 188]

server re-create
FFI| offering custom extension 001a
FFI| extension contents: ffff00050a0b0c0d0e
FFI| setting early data limit to ffffffff
FFI| Setting a new ticket callback.
FFI| Setting a new server negotiation callback.
FFI| Setting up certificate callbacks.
TLS| writeHandshake (plaintext)
TLS| HS.next_fragment PlaintextID?
HS | next_fragment
TLS| HS.next_fragment returned nothing
TLS| sendHandshake
TLS| read: WrittenHS, Ctrl/Ctrl, nothing
TLS| Read fragment at epoch index: -1 of length 183
TLS| read Handshake fragment
HS | recv_fragment
HSL| parsed HelloRetryRequest
HSL| end of flight
HSL| Replacing CH1 in transcript with fe000020f3b072cbd2c56ab8fb387bc644791789eca78093b470fecddf439b796058bc9c
HSL| HRR bytes: 020000b30303cf21ad74e59a6111be1d8c021e65b891c2a211167abb8c5e079e09e2c8a8339c00130300008b002c0081007f0b0dbad3d195576c8387ea70abe073846a2549595229dc2cc4d9d0299df3fdf02dbbe21bd2eff69e830f8a7110d560bbe71d859d84ac58dd1fc997f6228b995cddb31072e4e21276f7d0d62b111024aebf6ab2ae1d59d039f445116f2e9ba48769463158a9466e9cb5ad6fe629f58a95626ca881a6e9de9e115c32cae6d3ac002b00027f1c
HS | client_HelloRetryRequest
HS | Server did not specify a group in HRR, re-using the previous choice
NGO| Got HRR, extensions: [cookie supported_versions ]
HSL| emit ClientHello
TLS| readOne ReadAgain
TLS| writeHandshake (plaintext)
TLS| HS.next_fragment PlaintextID?
HS | next_fragment
TLS| HS.next_fragment returned a fragment
TLS| sendHandshake
TLS| send Handshake fragment with index PlaintextID
TLS| Sending fragment of length 303
REC| record headers: 160303012f
TLS| writeHandshake (plaintext)
TLS| HS.next_fragment PlaintextID?
HS | next_fragment
TLS| HS.next_fragment returned nothing
TLS| sendHandshake
TLS| read: WrittenHS, Ctrl/Ctrl, nothing
REC| WouldBlock
TLS| readOne ReadWouldBlock
client returns would_block clen=308 slen=188
ClientHello2[ 308] ---->

TCK| Decrypting cookie 0b0dbad3d195576c8387ea70abe073846a2549595229dc2cc4d9d0299df3fdf02dbbe21bd2eff69e830f8a7110d560bbe71d859d84ac58dd1fc997f6228b995cddb31072e4e21276f7d0d62b111024aebf6ab2ae1d59d039f445116f2e9ba48769463158a9466e9cb5ad6fe629f58a95626ca881a6e9de9e115c32cae6d3ac
TCK| Plain cookie: 0000320200002e0303cf21ad74e59a6111be1d8c021e65b891c2a211167abb8c5e079e09e2c8a8339c001303000006002b00027f1c20f3b072cbd2c56ab8fb387bc644791789eca78093b470fecddf439b796058bc9c000b48656c6c6f20576f726c64
~~~~~~~~~ Client Hello Summary ~~~~~~~~~~~
~ SNI = localhost
~ ALPN = 00060568712d3130
~ Cookie = 48656c6c6f20576f726c64
~ Extensions = 00fe002c0081007f0b0dbad3d195576c8387ea70abe073846a2549595229dc2c
c4d9d0299df3fdf02dbbe21bd2eff69e830f8a7110d560bbe71d859d84ac58dd
1fc997f6228b995cddb31072e4e21276f7d0d62b111024aebf6ab2ae1d59d039
f445116f2e9ba48769463158a9466e9cb5ad6fe629f58a95626ca881a6e9de9e
115c32cae6d3ac001a0009ffff00050a0b0c0d0e002b0003027f1c0033002600
24001d0020190d536bf617a1f2ee6c94f9890bc4c6650b1d86089cc2822c07ea
fd40bcaf2d0000000e000c0000096c6f63616c686f7374001000080006056871
2d313000170000000d0006000408040403000a00040002001d002d0003020001
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
TLS| writeHandshake (plaintext)
TLS| HS.next_fragment PlaintextID?
HS | next_fragment
TLS| HS.next_fragment returned nothing
TLS| sendHandshake
TLS| read: WrittenHS, Ctrl/Ctrl, nothing
TLS| Read fragment at epoch index: -1 of length 303
TLS| read Handshake fragment
HS | recv_fragment
HSL| parsed [ClientHello] -- end of flight 
HS | Processing ClientHello
NGO| offered client extensions [ cookie 001a supported_versions key_share server_name alpn extended_master_secret signature_algorithms supported_groups psk_key_exchange_modes ]
NGO| offered cipher suites ; TLS_CHACHA20_POLY1305_SHA256; TLS_AES_128_GCM_SHA256
NGO| offered versions 1.3
NGO| Negotiated Pure EDH key exchange
NGO| Negotiated ECDSA_SECP256R1_SHA256
TCK| Decrypting cookie 0b0dbad3d195576c8387ea70abe073846a2549595229dc2cc4d9d0299df3fdf02dbbe21bd2eff69e830f8a7110d560bbe71d859d84ac58dd1fc997f6228b995cddb31072e4e21276f7d0d62b111024aebf6ab2ae1d59d039f445116f2e9ba48769463158a9466e9cb5ad6fe629f58a95626ca881a6e9de9e115c32cae6d3ac
TCK| Plain cookie: 0000320200002e0303cf21ad74e59a6111be1d8c021e65b891c2a211167abb8c5e079e09e2c8a8339c001303000006002b00027f1c20f3b072cbd2c56ab8fb387bc644791789eca78093b470fecddf439b796058bc9c000b48656c6c6f20576f726c64
NGO| Loaded stateless retry cookie 0b0dbad3d195576c8387ea70abe073846a2549595229dc2cc4d9d0299df3fdf02dbbe21bd2eff69e830f8a7110d560bbe71d859d84ac58dd1fc997f6228b995cddb31072e4e21276f7d0d62b111024aebf6ab2ae1d59d039f445116f2e9ba48769463158a9466e9cb5ad6fe629f58a95626ca881a6e9de9e115c32cae6d3ac
NGO| Overwriting the transcript digest with CH1 hash f3b072cbd2c56ab8fb387bc644791789eca78093b470fecddf439b796058bc9c
HSL| Installing prefix to transcript: fe000020f3b072cbd2c56ab8fb387bc644791789eca78093b470fecddf439b796058bc9c
HSL| HRR bytes: 020000b30303cf21ad74e59a6111be1d8c021e65b891c2a211167abb8c5e079e09e2c8a8339c00130300008b002c0081007f0b0dbad3d195576c8387ea70abe073846a2549595229dc2cc4d9d0299df3fdf02dbbe21bd2eff69e830f8a7110d560bbe71d859d84ac58dd1fc997f6228b995cddb31072e4e21276f7d0d62b111024aebf6ab2ae1d59d039f445116f2e9ba48769463158a9466e9cb5ad6fe629f58a95626ca881a6e9de9e115c32cae6d3ac002b00027f1c
NGO| Negotiation callback to handle extra extensions and query for stateless retry.
NGO| Application data in cookie: 48656c6c6f20576f726c64
@@@@ Nego callback for TLS 1.3 @@@@
Offered extensions:
003d001a0009ffff00050a0b0c0d0e0000000e000c0000096c6f63616c686f73
740010000800060568712d3130000d0006000408040403000a00040002001d
Transport parameters offered:
ffff00050a0b0c0d0e
Stateless cookie found, application contents:
48656c6c6f20576f726c64
Adding server transport parameters:
000102
@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
NGO| negotiated 1.3 TLS_CHACHA20_POLY1305_SHA256
KS | ks_server_init
KS | No PSK selected.
KS | Computed early secret:           33ad0a1c607ec03b09e6cd9893680ce210adf300aa1f2660e1b22e10f170f92a
KS | Handshake salt:                  6f2615a108c702c5678f54fc9dbab69716c076189c48250cebeac3576c3611ba
CDH| Keygen (responder) on X255519
CDH| DH initiator on X255519
KS | DH shared secret: 6e4a169ece1d8eac2b527f3ed49e1053953504d1c7287bb0847fb68c1c5a5074
KS | Handshake secret:                6857c531aac985a5fe5ab2439d9daf629c59436456dea52b17baee89cd8acfd1
NGO| processing client extensions [ cookie 001a supported_versions key_share server_name alpn extended_master_secret signature_algorithms supported_groups psk_key_exchange_modes ]
NGO| including server extensions (SH + EE) [ supported_versions key_share alpn supported_groups ]
NGO| extra extensions from application callback: 001a 
HSL| emit ServerHello and hash
HS | derive handshake keys
KS | ks_server_13_sh, hashed log = 25a0b3949ef75de7c1929c3cbe4656759ff86e09a034d04186037805b43036eb
KS | handshake traffic secret[C]:     98c78f71cbc21efcda4fc8c531eb1a6afa4b87c2da898cf68d918b9e1dd359b1
KS | handshake traffic secret[S]:     7946831fcbedfdb41b34f847b9391d3de96b19748022fd714a6954bdcdb49bc1
KS | handshake key[C]:                3c2a27ba1a40b9eb24964ca5fce5dd26d0368be3ddb5934a7ffb98bec8007efd, IV=aeb6b83163dccf0257bc2dd0
KS | handshake key[S]: cc40ab55592abbe8bb26aa1af66eed677983e77d41ed4c94cf2015360403cb8e, IV=c1e39db5a88bbd548b11465c
AEP| LowProvider: COERCE(K=cc40ab55592abbe8bb26aa1af66eed677983e77d41ed4c94cf2015360403cb8e)
AEP| LowProvider: COERCE(K=3c2a27ba1a40b9eb24964ca5fce5dd26d0368be3ddb5934a7ffb98bec8007efd)
KS | finished key[C]:                 5d974aa88dcef43d363499bc1aedd80ae082f91cb56a57610859c54876d51779
KS | finished key[S]:                 3babfdc1253061fefe97b7334071b95b53f4cb3cfb4e014d78762473724a39bd
KS | Application salt:                745bb8a99c3a935f0b9559e40869e7c1704dc673f840720b31b8ffade5acbb0d
KS | Application secret:              970df4278c7255de774874e593dcb64d3010a07447afd1406742c01eaef886ca
TLS| readOne ReadAgain
TLS| writeHandshake (plaintext)
TLS| HS.next_fragment PlaintextID?
HS | next_fragment
TLS| HS.next_fragment returned a fragment; next_keys (for handshake only
TLS| sendHandshake
TLS| send Handshake fragment with index PlaintextID
TLS| Sending fragment of length 90
REC| record headers: 160303005a
EPO| writer++ -1/0
TLS| writeHandshake (encrypted)
TLS| HS.next_fragment ID13?
HS | next_fragment
HS | prepare Server Finished
HSL| emit EncryptedExtensions
HSL| emit Certificate13 and hash
======== TO BE SIGNED <0403>: (130 octets) ========
2020202020202020202020202020202020202020202020202020202020202020
2020202020202020202020202020202020202020202020202020202020202020
544c5320312e332c207365727665722043657274696669636174655665726966
7900f524c3dabd2fbc0331ffc16c86955d0bcfb090eccd7bf2b46d3c77fec466
0e8e
===================================================
HSL| emit CertificateVerify and hash
HSL| emit Finished and hash
KS | ks_server_13_sf hashed_log = eb4a8568f174f3b8a0db65f0938d725093de0eeb86fe6df7fa3402342ae5ffc3
KS | application traffic secret[C]:   a629ca66b0391deaaa5527c85cbdecf75915017f39fe70eff7e9aaed3054592e
KS | application traffic secret[S]:   a72ff0186b7da23f7752117b82339aca05e217dd1cbd73befc0f54b3134b67eb
KS | exporter master secret:          cbc841af79647e5cc0baa657f65c13a3350704695053965300e18907deba71ed
KS | application key[C]:              e2418a96be1372d62caa3a648e9ae6bac1b1b094865eccd7a41a8ca5ceb6a7b7, IV=cc4dbc85319716db423d154b
KS | application key[S]:              e06ef46ed264c4e7e697aff50e94f7aaff9f70ab4ab9a10e06c9f7ee622e12ee, IV=b6e9d8795e4a62f7119a70ca
AEP| LowProvider: COERCE(K=e06ef46ed264c4e7e697aff50e94f7aaff9f70ab4ab9a10e06c9f7ee622e12ee)
AEP| LowProvider: COERCE(K=e2418a96be1372d62caa3a648e9ae6bac1b1b094865eccd7a41a8ca5ceb6a7b7)
HS | exporting a key
EPO| reader++ 0/0
TLS| HS.next_fragment returned a fragment; next_keys (for all data)
TLS| sendHandshake
TLS| send Handshake fragment with index ID13
TLS| Encrypting with key cc40ab55592abbe8bb26aa1af66eed677983e77d41ed4c94cf2015360403cb8e
TLS| Sending fragment of length 735
REC| record headers: 17030302df
EPO| writer++ 0/1
TLS| read: WrittenHS, Ctrl/Open, new writer: writable
server returns server_accept clen=308 slen=835
secret=cbc841af79647e5cc0baa657f65c13a3350704695053965300e18907deba71ed
<---- ServerHello;(EncryptedExtensions; Certificate; CertVerify; Finished)[ 835]

TLS| writeHandshake (plaintext)
TLS| HS.next_fragment PlaintextID?
HS | next_fragment
TLS| HS.next_fragment returned nothing
TLS| sendHandshake
TLS| read: WrittenHS, Ctrl/Ctrl, nothing
TLS| Read fragment at epoch index: -1 of length 90
TLS| read Handshake fragment
HS | recv_fragment
HSL| parsed ServerHello
HSL| end of flight
HS | client_ServerHello
NGO| processing server extensions [ supported_versions key_share ]
NGO| negotiated 1.3 TLS_CHACHA20_POLY1305_SHA256
HS | Running TLS 1.3
KS | ks_client_13_sh hashed_log = 25a0b3949ef75de7c1929c3cbe4656759ff86e09a034d04186037805b43036eb
KS | no PSK negotiated. Early secret: 33ad0a1c607ec03b09e6cd9893680ce210adf300aa1f2660e1b22e10f170f92a
KS | handshake salt:                  6f2615a108c702c5678f54fc9dbab69716c076189c48250cebeac3576c3611ba
CDH| DH initiator on X255519
KS | DH shared secret: 6e4a169ece1d8eac2b527f3ed49e1053953504d1c7287bb0847fb68c1c5a5074
KS | handshake secret:                6857c531aac985a5fe5ab2439d9daf629c59436456dea52b17baee89cd8acfd1
KS | handshake traffic secret[C]:     98c78f71cbc21efcda4fc8c531eb1a6afa4b87c2da898cf68d918b9e1dd359b1
KS | handshake traffic secret[S]:     7946831fcbedfdb41b34f847b9391d3de96b19748022fd714a6954bdcdb49bc1
KS | handshake key[C]:                3c2a27ba1a40b9eb24964ca5fce5dd26d0368be3ddb5934a7ffb98bec8007efd, IV=aeb6b83163dccf0257bc2dd0
KS | handshake key[S]:                cc40ab55592abbe8bb26aa1af66eed677983e77d41ed4c94cf2015360403cb8e, IV=c1e39db5a88bbd548b11465c
KS | finished key[C]: 5d974aa88dcef43d363499bc1aedd80ae082f91cb56a57610859c54876d51779
KS | finished key[S]: 3babfdc1253061fefe97b7334071b95b53f4cb3cfb4e014d78762473724a39bd
KS | application salt:                745bb8a99c3a935f0b9559e40869e7c1704dc673f840720b31b8ffade5acbb0d
KS | application secret:              970df4278c7255de774874e593dcb64d3010a07447afd1406742c01eaef886ca
AEP| LowProvider: COERCE(K=3c2a27ba1a40b9eb24964ca5fce5dd26d0368be3ddb5934a7ffb98bec8007efd)
AEP| LowProvider: COERCE(K=cc40ab55592abbe8bb26aa1af66eed677983e77d41ed4c94cf2015360403cb8e)
EPO| reader++ 0/-1
TLS| readOne ReadAgain
TLS| writeHandshake (plaintext)
TLS| HS.next_fragment PlaintextID?
HS | next_fragment
TLS| HS.next_fragment returned nothing
TLS| sendHandshake
TLS| read: WrittenHS, Ctrl/Ctrl, nothing
TLS| Read fragment at epoch index: 0 of length 735
TLS| StAE decrypt correct.
TLS| read Handshake fragment
HS | recv_fragment
HSL| parsed EncryptedExtensions
HSL| parsed Certificate13
HSL| parsed CertificateVerify
HSL| parsed Finished
HSL| end of flight
NGO| Nego.clientComplete_13
NGO| EE: alpn supported_groups 001a 
NGO| Negotiation callback to process application extensions.
@@@@ Nego callback for TLS 1.3 @@@@
Offered extensions:
001b0010000800060568712d3130000a00040002001d001a0003000102
Transport parameters offered:
000102
No application cookie (fist connection).
Adding server transport parameters:
000102
@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
WARNING: chain validation failed, ignoring.
NGO| Certificate & signature 1.3 callback result: valid
KS | ks_client_13_sf hashed_log = eb4a8568f174f3b8a0db65f0938d725093de0eeb86fe6df7fa3402342ae5ffc3
KS | application traffic secret[C]:   a629ca66b0391deaaa5527c85cbdecf75915017f39fe70eff7e9aaed3054592e
KS | application traffic secret[S]:   a72ff0186b7da23f7752117b82339aca05e217dd1cbd73befc0f54b3134b67eb
KS | exporter master secret:          cbc841af79647e5cc0baa657f65c13a3350704695053965300e18907deba71ed
KS | application key[C]:              e2418a96be1372d62caa3a648e9ae6bac1b1b094865eccd7a41a8ca5ceb6a7b7, IV=cc4dbc85319716db423d154b
KS | application key[S]:              e06ef46ed264c4e7e697aff50e94f7aaff9f70ab4ab9a10e06c9f7ee622e12ee, IV=b6e9d8795e4a62f7119a70ca
AEP| LowProvider: COERCE(K=e2418a96be1372d62caa3a648e9ae6bac1b1b094865eccd7a41a8ca5ceb6a7b7)
AEP| LowProvider: COERCE(K=e06ef46ed264c4e7e697aff50e94f7aaff9f70ab4ab9a10e06c9f7ee622e12ee)
HS | exporting a key
HS | Early data rejected
EPO| writer++ 0/0
HSL| emit Finished and hash
KS | ks_client_13_cf hashed_log = d6c2958916a2de15330363a777d5d8739a6b99becd688d036841255eae3428a0
KS | resumption master secret:        718bf36e21cdf5f43d704963c8ba0d034078e08944370f660456e629e4deec85
EPO| reader++ 1/0
TLS| readOne ReadAgain
TLS| writeHandshake (encrypted)
TLS| HS.next_fragment ID13?
HS | next_fragment
TLS| HS.next_fragment returned a fragment; next_keys (for all data); complete
TLS| sendHandshake
TLS| send Handshake fragment with index ID13
TLS| Encrypting with key 3c2a27ba1a40b9eb24964ca5fce5dd26d0368be3ddb5934a7ffb98bec8007efd
TLS| Sending fragment of length 53
REC| record headers: 1703030035
EPO| writer++ 1/1
TLS| read: WrittenHS, Open/Open, new writer: complete
client returns client_complete clen=58 slen=835
secret=cbc841af79647e5cc0baa657f65c13a3350704695053965300e18907deba71ed
(Finished) [  58] ---->

TLS| writeHandshake (encrypted)
TLS| HS.next_fragment ID13?
HS | next_fragment
TLS| HS.next_fragment returned nothing
TLS| sendHandshake
TLS| read: WrittenHS, Ctrl/Open, nothing
TLS| Read fragment at epoch index: 0 of length 53
TLS| StAE decrypt correct.
TLS| read Handshake fragment
HS | recv_fragment
HSL| parsed Finished
HSL| end of flight
HS | Process Client Finished
KS | ks_server_13_cf hashed_log = d6c2958916a2de15330363a777d5d8739a6b99becd688d036841255eae3428a0
KS | resumption master secret:        718bf36e21cdf5f43d704963c8ba0d034078e08944370f660456e629e4deec85
HS | Sending ticket: f545ee93271bdc450d7421b7c96f44b34b239a39a27b5426cbafa05dd671db5579a4a9399620d5edaa12bf5ab9506cc2d533b3f9b9937ae4ebea0c575578abbe39b3ca97fde57d6c36dcfaac
HSL| emit NewSessionTicket13
EPO| reader++ 1/1
TLS| readOne Complete
server returns server_complete clen=58 slen=0
TLS| writeHandshake (encrypted)
TLS| HS.next_fragment ID13?
HS | next_fragment
TLS| HS.next_fragment returned a fragment
TLS| sendHandshake
TLS| send Handshake fragment with index ID13
TLS| Encrypting with key e06ef46ed264c4e7e697aff50e94f7aaff9f70ab4ab9a10e06c9f7ee622e12ee
TLS| Sending fragment of length 130
REC| record headers: 1703030082
TLS| writeHandshake (encrypted)
TLS| HS.next_fragment ID13?
HS | next_fragment
TLS| HS.next_fragment returned nothing
TLS| sendHandshake
TLS| read: WrittenHS, Open/Open, nothing
REC| WouldBlock
TLS| readOne ReadWouldBlock
server returns would_block clen=0 slen=135
<---- {Ticket}[ 135]
TLS| writeHandshake (encrypted)
TLS| HS.next_fragment ID13?
HS | next_fragment
TLS| HS.next_fragment returned nothing
TLS| sendHandshake
TLS| read: WrittenHS, Open/Open, nothing
TLS| Read fragment at epoch index: 1 of length 130
TLS| StAE decrypt correct.
TLS| read Handshake fragment
HS | recv_fragment
HSL| parsed NewSessionTicket13
HSL| end of flight
HS | Received ticket: f545ee93271bdc450d7421b7c96f44b34b239a39a27b5426cbafa05dd671db5579a4a9399620d5edaa12bf5ab9506cc2d533b3f9b9937ae4ebea0c575578abbe39b3ca97fde57d6c36dcfaac
KS | ks_client_13_rms
KS | Recall RMS: 718bf36e21cdf5f43d704963c8ba0d034078e08944370f660456e629e4deec85
AEP| LowProvider: COERCE(K=8f87cd7efb634463853c56b3ca764f8b014fd82c357cb51efa5a3299533115ff)

##### New session ticket received! #####
Host: localhost
Ticket:
f545ee93271bdc450d7421b7c96f44b34b239a39a27b5426cbafa05dd671db55
79a4a9399620d5edaa12bf5ab9506cc2d533b3f9b9937ae4ebea0c575578abbe
39b3ca97fde57d6c36dcfaac
########################################
TLS| readOne ReadAgain
TLS| writeHandshake (encrypted)
TLS| HS.next_fragment ID13?
HS | next_fragment
TLS| HS.next_fragment returned nothing
TLS| sendHandshake
TLS| read: WrittenHS, Open/Open, nothing
REC| WouldBlock
TLS| readOne ReadWouldBlock
client returns clen=0 slen=135 status=would_block
Ok
================================================================================
