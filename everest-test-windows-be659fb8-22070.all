This is /home/everbld/everest-ci/ci
Working directory: /cygdrive/c/build/agent1/_work/13/s
About to run: ./everest --yes -windows -j 16 test
BUILD_SOURCEBRANCHNAME: protz_uint128
BUILD_DEFINITIONNAME: Everest-CI-Windows-fnouint128
BUILD_BUILDID: 22070
DEFINITIONNAME:
Z3 is /home/everbld/everest/z3-4.5.1.1f29cebd4df6-x64-win/bin/z3
# Switching to the everest directory ... now in /cygdrive/c/build/agent1/_work/13/s

exported FSTAR_HOME=C:/build/agent1/_work/13/s/FStar
exported OPENSSL_HOME=C:/build/agent1/_work/13/s/MLCrypto/openssl
exported KREMLIN_HOME=C:/build/agent1/_work/13/s/kremlin
exported VALE_HOME=C:/build/agent1/_work/13/s/vale
exported HACL_HOME=C:/build/agent1/_work/13/s/hacl-star
exported MLCRYPTO_HOME=C:/build/agent1/_work/13/s/MLCrypto
+ hacl-star/secure_api/out/vale_aes_concrete_id/krml-test.exe
exported PATH=/cygdrive/c/build/agent1/_work/13/s/MLCrypto/openssl:/cygdrive/c/build/agent1/_work/13/s/FStar/bin:/cygdrive/c/build/agent1/_work/13/s/kremlin:/home/everbld/.opam/4.05.0+mingw64c/bin:/cygdrive/c/Windows/Microsoft.NET/Framework64/v4.0.30319/:/home/everbld/everest/nuget/bin:/home/everbld/everest/z3-4.5.1.1f29cebd4df6-x64-win/bin:/cygdrive/c/PROGRA~2/MICROS~1.0/VC/bin/amd64:/cygdrive/c/PROGRA~2/MICROS~1.0/VC/bin:/cygdrive/c/PROGRA~2/MICROS~4/F#/4.0/FRAMEW~1/v4.0/:/usr/x86_64-w64-mingw32/sys-root/mingw/bin:/usr/local/bin:/usr/bin:/cygdrive/c/build/agent1/externals/git/cmd:/cygdrive/c/Python36/Scripts:/cygdrive/c/Python36:/cygdrive/c/Docker/Resources/bin:/cygdrive/c/windows/system32:/cygdrive/c/windows:/cygdrive/c/windows/System32/Wbem:/cygdrive/c/windows/System32/WindowsPowerShell/v1.0:/cygdrive/c/Users/everbld/AppData/Local/Microsoft/WindowsApps:/cygdrive/c/Program Files/Docker/Docker/resources/bin:%USERPROFILE%/.dnx/bin:/cygdrive/c/Program Files/Microsoft DNX/Dnvm:/cygdrive/c/Program Files/Microsoft SQL Server/120/Tools/Binn:/cygdrive/c/Program Files/Microsoft SQL Server/130/Tools/Binn:/cygdrive/c/Program Files/dotnet:/cygdrive/c/Program Files/nodejs:/usr/bin:/cygdrive/c/Program Files/Git/mingw64/bin:/cygdrive/c/Users/everbld/AppData/Roaming/npm:/cygdrive/c/build/agent1/bin:/cygdrive/c/build/agent1/bin
================================================================================
Running tests (commands shown below)
test()
[test] expected output cipher is d31a8d34648e60db7b86afbc53ef7ec2a4aded51296e08fea9e2b5a736ee62d63dbea45e8ca9671282fafb69da92728b1a71de0a9e060b2905d6a5b67ecd3b3692ddbd7f2d778b8c9803aee328091b58fab324e4fad675945585808b4831d7bc3ff4def08e4b7a9de576d26586cec64b61161ae10b594f09e26a7e902ecbd0600691
+ hacl-star/secure_api/out/hacl_aes_concrete_id/krml-test.exe
[test] computed output cipher is d31a8d34648e60db7b86afbc53ef7ec2a4aded51296e08fea9e2b5a736ee62d63dbea45e8ca9671282fafb69da92728b1a71de0a9e060b2905d6a5b67ecd3b3692ddbd7f2d778b8c9803aee328091b58fab324e4fad675945585808b4831d7bc3ff4def08e4b7a9de576d26586cec64b61161ae10b594f09e26a7e902ecbd0600691
[test] cipher is a success
[test] expected output decryption is 4c616469657320616e642047656e746c656d656e206f662074686520636c617373206f66202739393a204966204920636f756c64206f6666657220796f75206f6e6c79206f6e652074697020666f7220746865206675747572652c2073756e73637265656e20776f756c642062652069742e
[test] computed output decryption is 4c616469657320616e642047656e746c656d656e206f662074686520636c617373206f66202739393a204966204920636f756c64206f6666657220796f75206f6e6c79206f6e652074697020666f7220746865206675747572652c2073756e73637265656e20776f756c642062652069742e
[test] decryption is a success
test_aes_gcm_0()
[test] expected output cipher is 58e2fccefa7e3061367f1d57a4e7455a
[test] computed output cipher is 58e2fccefa7e3061367f1d57a4e7455a
[test] cipher is a success
[test] expected output decryption is 
[test] computed output decryption is 
[test] decryption is a success
test_aes_gcm_1()
[test] expected output cipher is 530f8afbc74536b9a963b4f1c4cb738b
[test] computed output cipher is 530f8afbc74536b9a963b4f1c4cb738b
[test] cipher is a success
[test] expected output decryption is 
[test] computed output decryption is 
+ make -C hacl-star/secure_api -f Makefile.extract test
[test] decryption is a success
test_aes_gcm_2()
[test] expected output cipher is cea7403d4d606b6e074ec5d3baf39d18d0d1c8a799996bf0265b98b5d48ab919
[test] computed output cipher is cea7403d4d606b6e074ec5d3baf39d18d0d1c8a799996bf0265b98b5d48ab919
[test] cipher is a success
[test] expected output decryption is 00000000000000000000000000000000
[test] computed output decryption is 00000000000000000000000000000000
[test] decryption is a success
test_aes_gcm_3()
[test] expected output cipher is 522dc1f099567d07f47f37a32a84427d643a8cdcbfe5c0c97598a2bd2555d1aa8cb08e48590dbb3da7b08b1056828838c5f61e6393ba7a0abcc9f662898015adb094dac5d93471bdec1a502270e3cc6c
[test] computed output cipher is 522dc1f099567d07f47f37a32a84427d643a8cdcbfe5c0c97598a2bd2555d1aa8cb08e48590dbb3da7b08b1056828838c5f61e6393ba7a0abcc9f662898015adb094dac5d93471bdec1a502270e3cc6c
[test] cipher is a success
[test] expected output decryption is d9313225f88406e5a55909c5aff5269a86a7a9531534f7da2e4c303d8a318a721c3c0c95956809532fcf0e2449a6b525b16aedf5aa0de657ba637b391aafd255
[test] computed output decryption is d9313225f88406e5a55909c5aff5269a86a7a9531534f7da2e4c303d8a318a721c3c0c95956809532fcf0e2449a6b525b16aedf5aa0de657ba637b391aafd255
[test] decryption is a success
test_aes_gcm_4()
[test] expected output cipher is 522dc1f099567d07f47f37a32a84427d643a8cdcbfe5c0c97598a2bd2555d1aa8cb08e48590dbb3da7b08b1056828838c5f61e6393ba7a0abcc9f66276fc6ece0f4e1768cddf8853bb2d551b
[test] computed output cipher is 522dc1f099567d07f47f37a32a84427d643a8cdcbfe5c0c97598a2bd2555d1aa8cb08e48590dbb3da7b08b1056828838c5f61e6393ba7a0abcc9f66276fc6ece0f4e1768cddf8853bb2d551b
[test] cipher is a success
[test] expected output decryption is d9313225f88406e5a55909c5aff5269a86a7a9531534f7da2e4c303d8a318a721c3c0c95956809532fcf0e2449a6b525b16aedf5aa0de657ba637b39
[test] computed output decryption is d9313225f88406e5a55909c5aff5269a86a7a9531534f7da2e4c303d8a318a721c3c0c95956809532fcf0e2449a6b525b16aedf5aa0de657ba637b39
[test] decryption is a success
test()
[test] expected output cipher is d31a8d34648e60db7b86afbc53ef7ec2a4aded51296e08fea9e2b5a736ee62d63dbea45e8ca9671282fafb69da92728b1a71de0a9e060b2905d6a5b67ecd3b3692ddbd7f2d778b8c9803aee328091b58fab324e4fad675945585808b4831d7bc3ff4def08e4b7a9de576d26586cec64b61161ae10b594f09e26a7e902ecbd0600691
[test] computed output cipher is d31a8d34648e60db7b86afbc53ef7ec2a4aded51296e08fea9e2b5a736ee62d63dbea45e8ca9671282fafb69da92728b1a71de0a9e060b2905d6a5b67ecd3b3692ddbd7f2d778b8c9803aee328091b58fab324e4fad675945585808b4831d7bc3ff4def08e4b7a9de576d26586cec64b61161ae10b594f09e26a7e902ecbd0600691
[test] cipher is a success
[test] expected output decryption is 4c616469657320616e642047656e746c656d656e206f662074686520636c617373206f66202739393a204966204920636f756c64206f6666657220796f75206f6e6c79206f6e652074697020666f7220746865206675747572652c2073756e73637265656e20776f756c642062652069742e
[test] computed output decryption is 4c616469657320616e642047656e746c656d656e206f662074686520636c617373206f66202739393a204966204920636f756c64206f6666657220796f75206f6e6c79206f6e652074697020666f7220746865206675747572652c2073756e73637265656e20776f756c642062652069742e
[test] decryption is a success
test_aes_gcm_0()
[test] expected output cipher is 58e2fccefa7e3061367f1d57a4e7455a
[test] computed output cipher is 58e2fccefa7e3061367f1d57a4e7455a
[test] cipher is a success
[test] expected output decryption is 
[test] computed output decryption is 
[test] decryption is a success
test_aes_gcm_1()
[test] expected output cipher is 530f8afbc74536b9a963b4f1c4cb738b
[test] computed output cipher is 530f8afbc74536b9a963b4f1c4cb738b
[test] cipher is a success
[test] expected output decryption is 
[test] computed output decryption is 
[test] decryption is a success
test_aes_gcm_2()
[test] expected output cipher is cea7403d4d606b6e074ec5d3baf39d18d0d1c8a799996bf0265b98b5d48ab919
[test] computed output cipher is cea7403d4d606b6e074ec5d3baf39d18d0d1c8a799996bf0265b98b5d48ab919
[test] cipher is a success
[test] expected output decryption is 00000000000000000000000000000000
[test] computed output decryption is 00000000000000000000000000000000
[test] decryption is a success
test_aes_gcm_3()
[test] expected output cipher is 522dc1f099567d07f47f37a32a84427d643a8cdcbfe5c0c97598a2bd2555d1aa8cb08e48590dbb3da7b08b1056828838c5f61e6393ba7a0abcc9f662898015adb094dac5d93471bdec1a502270e3cc6c
[test] computed output cipher is 522dc1f099567d07f47f37a32a84427d643a8cdcbfe5c0c97598a2bd2555d1aa8cb08e48590dbb3da7b08b1056828838c5f61e6393ba7a0abcc9f662898015adb094dac5d93471bdec1a502270e3cc6c
[test] cipher is a success
[test] expected output decryption is d9313225f88406e5a55909c5aff5269a86a7a9531534f7da2e4c303d8a318a721c3c0c95956809532fcf0e2449a6b525b16aedf5aa0de657ba637b391aafd255
[test] computed output decryption is d9313225f88406e5a55909c5aff5269a86a7a9531534f7da2e4c303d8a318a721c3c0c95956809532fcf0e2449a6b525b16aedf5aa0de657ba637b391aafd255
[test] decryption is a success
test_aes_gcm_4()
[test] expected output cipher is 522dc1f099567d07f47f37a32a84427d643a8cdcbfe5c0c97598a2bd2555d1aa8cb08e48590dbb3da7b08b1056828838c5f61e6393ba7a0abcc9f66276fc6ece0f4e1768cddf8853bb2d551b
[test] computed output cipher is 522dc1f099567d07f47f37a32a84427d643a8cdcbfe5c0c97598a2bd2555d1aa8cb08e48590dbb3da7b08b1056828838c5f61e6393ba7a0abcc9f66276fc6ece0f4e1768cddf8853bb2d551b
[test] cipher is a success
[test] expected output decryption is d9313225f88406e5a55909c5aff5269a86a7a9531534f7da2e4c303d8a318a721c3c0c95956809532fcf0e2449a6b525b16aedf5aa0de657ba637b39
[test] computed output decryption is d9313225f88406e5a55909c5aff5269a86a7a9531534f7da2e4c303d8a318a721c3c0c95956809532fcf0e2449a6b525b16aedf5aa0de657ba637b39
[test] decryption is a success
make: Entering directory '/cygdrive/c/build/agent1/_work/13/s/hacl-star/secure_api'
C:/build/agent1/_work/13/s/FStar/bin/fstar.exe --print_z3_statistics --use_hints --query_stats --cache_dir ../secure_api/out/runtime_switch/cache --cache_checked_modules --include ../specs --include ../code/bignum --include ../code/experimental/aesgcm --include ../code/lib/kremlin --include ../code/poly1305 --include ../code/hash --include ../code/salsa-family --include C:/build/agent1/_work/13/s/kremlin/kremlib --include ../secure_api --include ../secure_api/aead --include ../secure_api/prf --include ../secure_api/hkdf --include ../secure_api/vale --include ../secure_api/uf1cma --include ../secure_api/utils --include ../secure_api/LowCProvider/fst --include C:/build/agent1/_work/13/s/FStar/contrib/CoreCrypto/fst --include ../secure_api/concrete_specializations --include ../secure_api/concrete_specializations/runtime_switch --include ../secure_api/test --odir ../secure_api/out/runtime_switch/extracted --use_hints --lax \
prims.fst \
--codegen Kremlin \
--extract_module prims
All verification conditions discharged successfully
TOTAL TIME 51 ms: C:\build\agent1\_work\13\s\FStar\bin\fstar.exe --print_z3_statistics --use_hints --query_stats --cache_dir ../secure_api/out/runtime_switch/cache --cache_checked_modules --include ../specs --include ../code/bignum --include ../code/experimental/aesgcm --include ../code/lib/kremlin --include ../code/poly1305 --include ../code/hash --include ../code/salsa-family --include C:/build/agent1/_work/13/s/kremlin/kremlib --include ../secure_api --include ../secure_api/aead --include ../secure_api/prf --include ../secure_api/hkdf --include ../secure_api/vale --include ../secure_api/uf1cma --include ../secure_api/utils --include ../secure_api/LowCProvider/fst --include C:/build/agent1/_work/13/s/FStar/contrib/CoreCrypto/fst --include ../secure_api/concrete_specializations --include ../secure_api/concrete_specializations/runtime_switch --include ../secure_api/test --odir ../secure_api/out/runtime_switch/extracted --use_hints --lax prims.fst --codegen Kremlin --extract_module prims
C:/build/agent1/_work/13/s/kremlin/krml -falloca -ftail-calls -no-prefix KrmlTest -bundle \
Hacl.Impl.Poly1305_64+Hacl.Impl.Chacha20=Hacl.*,Spec,Spec.* -bundle \
Crypto.AEAD.Main=Crypto.* -tmpdir ../secure_api/out/runtime_switch/extracted \
-add-include '"kremlin/internal/compat.h"' \
../secure_api/out/runtime_switch/extracted/prims.krml ../secure_api/out/runtime_switch/extracted/FStar_Pervasives_Native.krml ../secure_api/out/runtime_switch/extracted/FStar_Pervasives.krml ../secure_api/out/runtime_switch/extracted/FStar_Mul.krml ../secure_api/out/runtime_switch/extracted/FStar_Math_Lib.krml ../secure_api/out/runtime_switch/extracted/FStar_Math_Lemmas.krml ../secure_api/out/runtime_switch/extracted/FStar_Squash.krml ../secure_api/out/runtime_switch/extracted/FStar_StrongExcludedMiddle.krml ../secure_api/out/runtime_switch/extracted/FStar_Classical.krml ../secure_api/out/runtime_switch/extracted/FStar_List_Tot_Base.krml ../secure_api/out/runtime_switch/extracted/FStar_List_Tot_Properties.krml ../secure_api/out/runtime_switch/extracted/FStar_List_Tot.krml ../secure_api/out/runtime_switch/extracted/FStar_Seq_Base.krml ../secure_api/out/runtime_switch/extracted/FStar_Seq_Properties.krml ../secure_api/out/runtime_switch/extracted/FStar_Seq.krml ../secure_api/out/runtime_switch/extracted/FStar_BitVector.krml ../secure_api/out/runtime_switch/extracted/FStar_UInt.krml ../secure_api/out/runtime_switch/extracted/FStar_UInt32.krml ../secure_api/out/runtime_switch/extracted/FStar_Int.krml ../secure_api/out/runtime_switch/extracted/FStar_Int64.krml ../secure_api/out/runtime_switch/extracted/FStar_Int63.krml ../secure_api/out/runtime_switch/extracted/FStar_Int32.krml ../secure_api/out/runtime_switch/extracted/FStar_Int16.krml ../secure_api/out/runtime_switch/extracted/FStar_Int8.krml ../secure_api/out/runtime_switch/extracted/FStar_UInt64.krml ../secure_api/out/runtime_switch/extracted/FStar_UInt63.krml ../secure_api/out/runtime_switch/extracted/FStar_UInt16.krml ../secure_api/out/runtime_switch/extracted/FStar_UInt8.krml ../secure_api/out/runtime_switch/extracted/FStar_Int_Cast.krml ../secure_api/out/runtime_switch/extracted/FStar_UInt128.krml ../secure_api/out/runtime_switch/extracted/Hacl_UInt64.krml ../secure_api/out/runtime_switch/extracted/FStar_Preorder.krml ../secure_api/out/runtime_switch/extracted/FStar_Ghost.krml ../secure_api/out/runtime_switch/extracted/FStar_ErasedLogic.krml ../secure_api/out/runtime_switch/extracted/FStar_FunctionalExtensionality.krml ../secure_api/out/runtime_switch/extracted/FStar_Set.krml ../secure_api/out/runtime_switch/extracted/FStar_PropositionalExtensionality.krml ../secure_api/out/runtime_switch/extracted/FStar_PredicateExtensionality.krml ../secure_api/out/runtime_switch/extracted/FStar_TSet.krml ../secure_api/out/runtime_switch/extracted/FStar_Monotonic_Heap.krml ../secure_api/out/runtime_switch/extracted/FStar_Heap.krml ../secure_api/out/runtime_switch/extracted/FStar_Map.krml ../secure_api/out/runtime_switch/extracted/FStar_Monotonic_HyperHeap.krml ../secure_api/out/runtime_switch/extracted/FStar_Monotonic_HyperStack.krml ../secure_api/out/runtime_switch/extracted/FStar_HyperStack.krml ../secure_api/out/runtime_switch/extracted/FStar_Monotonic_Witnessed.krml ../secure_api/out/runtime_switch/extracted/FStar_HyperStack_ST.krml ../secure_api/out/runtime_switch/extracted/FStar_HyperStack_All.krml ../secure_api/out/runtime_switch/extracted/Hacl_UInt128.krml ../secure_api/out/runtime_switch/extracted/Hacl_UInt8.krml ../secure_api/out/runtime_switch/extracted/Hacl_Bignum_Constants.krml ../secure_api/out/runtime_switch/extracted/Hacl_UInt32.krml ../secure_api/out/runtime_switch/extracted/FStar_Int_Cast_Full.krml ../secure_api/out/runtime_switch/extracted/Hacl_Cast.krml ../secure_api/out/runtime_switch/extracted/FStar_Buffer.krml ../secure_api/out/runtime_switch/extracted/Hacl_Bignum_Parameters.krml ../secure_api/out/runtime_switch/extracted/Hacl_Bignum_Wide.krml ../secure_api/out/runtime_switch/extracted/Spec_Loops.krml ../secure_api/out/runtime_switch/extracted/Hacl_Bignum_Limb.krml ../secure_api/out/runtime_switch/extracted/Hacl_Spec_Bignum_Field.krml ../secure_api/out/runtime_switch/extracted/Hacl_Spec_Bignum_Bigint.krml ../secure_api/out/runtime_switch/extracted/Hacl_Spec_Bignum_Modulo.krml ../secure_api/out/runtime_switch/extracted/Hacl_Spec_Bignum_Fproduct.krml ../secure_api/out/runtime_switch/extracted/Hacl_Spec_Bignum_Fmul.krml ../secure_api/out/runtime_switch/extracted/FStar_Endianness.krml ../secure_api/out/runtime_switch/extracted/Spec_Poly1305_Lemmas.krml ../secure_api/out/runtime_switch/extracted/FStar_Kremlin_Endianness.krml ../secure_api/out/runtime_switch/extracted/C_Endianness.krml ../secure_api/out/runtime_switch/extracted/C.krml ../secure_api/out/runtime_switch/extracted/Hacl_UInt16.krml ../secure_api/out/runtime_switch/extracted/Hacl_Spec_Endianness.krml ../secure_api/out/runtime_switch/extracted/Hacl_Endianness.krml ../secure_api/out/runtime_switch/extracted/Spec_Lib.krml ../secure_api/out/runtime_switch/extracted/Seq_Create.krml ../secure_api/out/runtime_switch/extracted/Spec_SHA2_256.krml ../secure_api/out/runtime_switch/extracted/C_Loops.krml ../secure_api/out/runtime_switch/extracted/Hacl_Hash_Lib_LoadStore.krml ../secure_api/out/runtime_switch/extracted/Hacl_Hash_Lib_Create.krml ../secure_api/out/runtime_switch/extracted/Hacl_Impl_SHA2_256_Lemmas.krml ../secure_api/out/runtime_switch/extracted/Hacl_Impl_SHA2_256.krml ../secure_api/out/runtime_switch/extracted/Hacl_Spec_Bignum_Fsum.krml ../secure_api/out/runtime_switch/extracted/Hacl_Bignum_Fsum.krml ../secure_api/out/runtime_switch/extracted/Crypto_AEAD_BufferUtils.krml ../secure_api/out/runtime_switch/extracted/Vale_AES.krml ../secure_api/out/runtime_switch/extracted/Hacl_Impl_Xor_Lemmas.krml ../secure_api/out/runtime_switch/extracted/Spec_CTR_Lemmas.krml ../secure_api/out/runtime_switch/extracted/Spec_CTR.krml ../secure_api/out/runtime_switch/extracted/Hacl_Lib_LoadStore32.krml ../secure_api/out/runtime_switch/extracted/Spec_Chacha20_Lemmas.krml ../secure_api/out/runtime_switch/extracted/Spec_Chacha20.krml ../secure_api/out/runtime_switch/extracted/Hacl_Impl_Chacha20.krml ../secure_api/out/runtime_switch/extracted/Hacl_SecureAPI_Chacha20.krml ../secure_api/out/runtime_switch/extracted/Crypto_Indexing.krml ../secure_api/out/runtime_switch/extracted/Flag.krml ../secure_api/out/runtime_switch/extracted/Crypto_Symmetric_AES.krml ../secure_api/out/runtime_switch/extracted/Crypto_Symmetric_AES128.krml ../secure_api/out/runtime_switch/extracted/FStar_Float.krml ../secure_api/out/runtime_switch/extracted/FStar_Exn.krml ../secure_api/out/runtime_switch/extracted/FStar_ST.krml ../secure_api/out/runtime_switch/extracted/FStar_All.krml ../secure_api/out/runtime_switch/extracted/FStar_IO.krml ../secure_api/out/runtime_switch/extracted/Buffer_Utils.krml ../secure_api/out/runtime_switch/extracted/Crypto_Symmetric_Bytes.krml ../secure_api/out/runtime_switch/extracted/Crypto_Symmetric_Cipher.krml ../secure_api/out/runtime_switch/extracted/C_Nullity.krml ../secure_api/out/runtime_switch/extracted/Hacl_Spec_Bignum_AddAndMultiply.krml ../secure_api/out/runtime_switch/extracted/Spec_Poly1305.krml ../secure_api/out/runtime_switch/extracted/Hacl_Bignum_Modulo.krml ../secure_api/out/runtime_switch/extracted/Hacl_Bignum_Fproduct.krml ../secure_api/out/runtime_switch/extracted/Hacl_Spec_Poly1305_64_State.krml ../secure_api/out/runtime_switch/extracted/Hacl_Spec_Poly1305_64.krml ../secure_api/out/runtime_switch/extracted/Hacl_Impl_Poly1305_64_State.krml ../secure_api/out/runtime_switch/extracted/Hacl_Bignum_Fmul.krml ../secure_api/out/runtime_switch/extracted/Hacl_Bignum_AddAndMultiply.krml ../secure_api/out/runtime_switch/extracted/Hacl_Spe_Poly1305_64.krml ../secure_api/out/runtime_switch/extracted/Hacl_Impl_Poly1305_64.krml ../secure_api/out/runtime_switch/extracted/Spec_GaloisField.krml ../secure_api/out/runtime_switch/extracted/Spec_GF128.krml ../secure_api/out/runtime_switch/extracted/Crypto_Symmetric_GF128.krml ../secure_api/out/runtime_switch/extracted/Crypto_Symmetric_MAC.krml ../secure_api/out/runtime_switch/extracted/Crypto_Symmetric_UF1CMA.krml ../secure_api/out/runtime_switch/extracted/Crypto_Plain.krml ../secure_api/out/runtime_switch/extracted/Crypto_Symmetric_PRF.krml ../secure_api/out/runtime_switch/extracted/Crypto_AEAD_Encoding.krml ../secure_api/out/runtime_switch/extracted/Crypto_AEAD_Invariant.krml ../secure_api/out/runtime_switch/extracted/Crypto_AEAD_Encrypt_Invariant.krml ../secure_api/out/runtime_switch/extracted/Crypto_AEAD_Wrappers_PRF.krml ../secure_api/out/runtime_switch/extracted/Crypto_AEAD_Wrappers_Encoding.krml ../secure_api/out/runtime_switch/extracted/Crypto_AEAD_Wrappers_CMA.krml ../secure_api/out/runtime_switch/extracted/Crypto_AEAD_EnxorDexor.krml ../secure_api/out/runtime_switch/extracted/Crypto_AEAD_Decrypt.krml ../secure_api/out/runtime_switch/extracted/Spec_HMAC_SHA2_256.krml ../secure_api/out/runtime_switch/extracted/Spec_SHA2_512.krml ../secure_api/out/runtime_switch/extracted/Hacl_Impl_SHA2_512_Lemmas.krml ../secure_api/out/runtime_switch/extracted/Hacl_Impl_SHA2_512.krml ../secure_api/out/runtime_switch/extracted/Spec_SHA2_384.krml ../secure_api/out/runtime_switch/extracted/Hacl_Impl_SHA2_384_Lemmas.krml ../secure_api/out/runtime_switch/extracted/Hacl_Impl_SHA2_384.krml ../secure_api/out/runtime_switch/extracted/Crypto_HMAC.krml ../secure_api/out/runtime_switch/extracted/Crypto_AEAD_Encrypt_Ideal_Invariant.krml ../secure_api/out/runtime_switch/extracted/Crypto_AEAD_MAC_Wrapper_Invariant.krml ../secure_api/out/runtime_switch/extracted/Crypto_AEAD_Enxor_Invariant.krml ../secure_api/out/runtime_switch/extracted/Crypto_AEAD_Encrypt.krml ../secure_api/out/runtime_switch/extracted/Crypto_AEAD.krml ../secure_api/out/runtime_switch/extracted/FStar_List.krml ../secure_api/out/runtime_switch/extracted/FStar_Char.krml ../secure_api/out/runtime_switch/extracted/FStar_String.krml ../secure_api/out/runtime_switch/extracted/C_String.krml ../secure_api/out/runtime_switch/extracted/TestLib.krml ../secure_api/out/runtime_switch/extracted/FStar_Bytes.krml ../secure_api/out/runtime_switch/extracted/Crypto_AEAD_Main.krml ../secure_api/out/runtime_switch/extracted/CryptoTypes.krml ../secure_api/out/runtime_switch/extracted/Crypto_HKDF.krml ../secure_api/out/runtime_switch/extracted/HaclProvider.krml ../secure_api/out/runtime_switch/extracted/KrmlTest.krml ../secure_api/out/runtime_switch/extracted/LowCProvider.krml vale/asm/sha256_main_i.o vale/asm/sha256-x86_64.o vale/asm/Vale_Hash_SHA2_256.o vale/asm/vale_aes_glue.o vale/asm/aes-x86_64.o -o ../secure_api/out/runtime_switch/krml-test.exe \
-drop HaclProvider,LowCProvider,CryptoTypes
Warning 10: : -drop is deprecated
use a combination of -bundle and -d reachability to make sure the functions are eliminated as you wish
Warning 6: in top-level declaration Crypto.Plain.create, in file Crypto_AEAD_Main: stack newbuf @1 @0 is a non-constant size, stack-allocated array; this is not supported by CompCert and requires the use of alloca(3) for MSVC
Warning 6: in the definition of keyBuffer, after the definition of h0, in the last element of the sequence, after the definition of macId, in top-level declaration Crypto.Symmetric.PRF.prf_mac, in file Crypto_AEAD_Main: stack newbuf 0uint8 Crypto.Symmetric.UF1CMA.keylen @5 is a non-constant size, stack-allocated array; this is not supported by CompCert and requires the use of alloca(3) for MSVC
Warning 6: in the definition of cipher1, after the definition of cipherlen, in the last element of the sequence, in top-level declaration KrmlTest.test, in file KrmlTest: stack newbuf 0uint8 @0 is a non-constant size, stack-allocated array; this is not supported by CompCert and requires the use of alloca(3) for MSVC
Warning 6: in the definition of cipher1, after the definition of cipherlen, in the last element of the sequence, in top-level declaration KrmlTest.test_aes_gcm, in file KrmlTest: stack newbuf 2uint8 @0 is a non-constant size, stack-allocated array; this is not supported by CompCert and requires the use of alloca(3) for MSVC
Warning 6: in the definition of plain, after the definition of plainlen, in top-level declaration KrmlTest.test_aes_gcm_0, in file KrmlTest: stack newbuf 0uint8 @0 is a non-constant size, stack-allocated array; this is not supported by CompCert and requires the use of alloca(3) for MSVC
Warning 6: in the definition of aad, after the definition of aadlen, in top-level declaration KrmlTest.test_aes_gcm_0, in file KrmlTest: stack newbuf 0uint8 @0 is a non-constant size, stack-allocated array; this is not supported by CompCert and requires the use of alloca(3) for MSVC
Warning 6: in the definition of plain, after the definition of plainlen, in top-level declaration KrmlTest.test_aes_gcm_1, in file KrmlTest: stack newbuf 0uint8 @0 is a non-constant size, stack-allocated array; this is not supported by CompCert and requires the use of alloca(3) for MSVC
Warning 6: in the definition of aad, after the definition of aadlen, in top-level declaration KrmlTest.test_aes_gcm_1, in file KrmlTest: stack newbuf 0uint8 @0 is a non-constant size, stack-allocated array; this is not supported by CompCert and requires the use of alloca(3) for MSVC
Warning 6: in the definition of plain, after the definition of plainlen, in top-level declaration KrmlTest.test_aes_gcm_2, in file KrmlTest: stack newbuf 0uint8 @0 is a non-constant size, stack-allocated array; this is not supported by CompCert and requires the use of alloca(3) for MSVC
Warning 6: in the definition of aad, after the definition of aadlen, in top-level declaration KrmlTest.test_aes_gcm_2, in file KrmlTest: stack newbuf 0uint8 @0 is a non-constant size, stack-allocated array; this is not supported by CompCert and requires the use of alloca(3) for MSVC
Warning 6: in the definition of aad, after the definition of aadlen, in top-level declaration KrmlTest.test_aes_gcm_3, in file KrmlTest: stack newbuf 0uint8 @0 is a non-constant size, stack-allocated array; this is not supported by CompCert and requires the use of alloca(3) for MSVC
[38;5;119m✔[0m [Monomorphization] ⏱️ 78ms
[38;5;119m✔[0m [Inlining] ⏱️ 78ms
[38;5;119m✔[0m [Pattern matches compilation] ⏱️ 63ms
[38;5;119m✔[0m [Simplify 2] ⏱️ 297ms
Warning 14: : FStar.List.Tot.Base.append__uint8_t is recursive but cannot be optimized to a tail-call
Warning 14: : FStar.Seq.Base.create__uint8_t is recursive but cannot be optimized to a tail-call
Warning 14: : Crypto.Symmetric.Bytes.load_bytes is recursive but cannot be optimized to a tail-call
Warning 14: : Crypto.Symmetric.Bytes.load_uint128 is recursive but cannot be optimized to a tail-call
Warning 14: : Crypto.Symmetric.Bytes.store_uint32 is recursive but cannot be optimized to a tail-call
Warning 14: : Crypto.Symmetric.Bytes.store_big32 is recursive but cannot be optimized to a tail-call
Warning 14: : Crypto.Symmetric.Bytes.store_uint128 is recursive but cannot be optimized to a tail-call
Warning 7: : After inlining, Crypto.Symmetric.MAC.update (going into Crypto_AEAD_Main) calls Hacl.Impl.Poly1305_64.State.poly1305_state (going into Hacl_Impl_Poly1305_64_Hacl_Impl_Chacha20) -- removing the static qualifier from Hacl.Impl.Poly1305_64.State.poly1305_state
Warning 8: : After inlining, Crypto.Symmetric.MAC.update (going into Crypto_AEAD_Main) calls Hacl.Impl.Poly1305_64.poly1305_update (going into Hacl_Impl_Poly1305_64_Hacl_Impl_Chacha20). This is a call across translation units but Hacl.Impl.Poly1305_64.poly1305_update has a C "inline" qualifier. The C standard allows removing Hacl.Impl.Poly1305_64.poly1305_update from its translation unit (see C11 6.7.3 §5), and CompCert will do it. 
Warning 8: : After inlining, Crypto.Symmetric.MAC.finish (going into Crypto_AEAD_Main) calls Hacl.Impl.Poly1305_64.poly1305_process_last_block (going into Hacl_Impl_Poly1305_64_Hacl_Impl_Chacha20). This is a call across translation units but Hacl.Impl.Poly1305_64.poly1305_process_last_block has a C "inline" qualifier. The C standard allows removing Hacl.Impl.Poly1305_64.poly1305_process_last_block from its translation unit (see C11 6.7.3 §5), and CompCert will do it. 
Warning 8: : After inlining, Crypto.Symmetric.Cipher.compute (going into Crypto_AEAD_Main) calls Hacl.Impl.Chacha20.setup (going into Hacl_Impl_Poly1305_64_Hacl_Impl_Chacha20). This is a call across translation units but Hacl.Impl.Chacha20.setup has a C "inline" qualifier. The C standard allows removing Hacl.Impl.Chacha20.setup from its translation unit (see C11 6.7.3 §5), and CompCert will do it. 
Warning 8: : After inlining, Crypto.Symmetric.Cipher.compute (going into Crypto_AEAD_Main) calls Hacl.Impl.Chacha20.copy_state (going into Hacl_Impl_Poly1305_64_Hacl_Impl_Chacha20). This is a call across translation units but Hacl.Impl.Chacha20.copy_state has a C "inline" qualifier. The C standard allows removing Hacl.Impl.Chacha20.copy_state from its translation unit (see C11 6.7.3 §5), and CompCert will do it. 
[38;5;119m✔[0m [Structs + Simplify 2] ⏱️ 359ms
Warning 8: : After inlining, Crypto.Symmetric.Cipher.compute (going into Crypto_AEAD_Main) calls Hacl.Impl.Chacha20.rounds (going into Hacl_Impl_Poly1305_64_Hacl_Impl_Chacha20). This is a call across translation units but Hacl.Impl.Chacha20.rounds has a C "inline" qualifier. The C standard allows removing Hacl.Impl.Chacha20.rounds from its translation unit (see C11 6.7.3 §5), and CompCert will do it. 
[38;5;119m✔[0m [Drop] ⏱️ 16ms
Warning 8: : After inlining, Crypto.Symmetric.Cipher.compute (going into Crypto_AEAD_Main) calls Hacl.Impl.Chacha20.sum_states (going into Hacl_Impl_Poly1305_64_Hacl_Impl_Chacha20). This is a call across translation units but Hacl.Impl.Chacha20.sum_states has a C "inline" qualifier. The C standard allows removing Hacl.Impl.Chacha20.sum_states from its translation unit (see C11 6.7.3 §5), and CompCert will do it. 
Warning 7: : After inlining, Crypto.Symmetric.Cipher.compute (going into Crypto_AEAD_Main) calls Hacl.Lib.LoadStore32.uint32s_to_le_bytes (going into Hacl_Impl_Poly1305_64_Hacl_Impl_Chacha20) -- removing the static qualifier from Hacl.Lib.LoadStore32.uint32s_to_le_bytes
Warning 7: : After inlining, KrmlTest.test (going into KrmlTest) calls Crypto.Indexing.id (going into Crypto_AEAD_Main) -- removing the static qualifier from Crypto.Indexing.id
Warning 7: : After inlining, KrmlTest.test (going into KrmlTest) calls Crypto.Indexing.aeadAlg (going into Crypto_AEAD_Main) -- removing the static qualifier from Crypto.Indexing.aeadAlg
Warning 7: : After inlining, KrmlTest.test (going into KrmlTest) calls Crypto.Indexing.testId (going into Crypto_AEAD_Main) -- removing the static qualifier from Crypto.Indexing.testId
Warning 7: : After inlining, KrmlTest.test (going into KrmlTest) calls Crypto.Plain.unsafe_hide_buffer (going into Crypto_AEAD_Main) -- removing the static qualifier from Crypto.Plain.unsafe_hide_buffer
Warning 7: : After inlining, KrmlTest.test (going into KrmlTest) calls Crypto.Symmetric.Bytes.load_bytes (going into Crypto_AEAD_Main) -- removing the static qualifier from Crypto.Symmetric.Bytes.load_bytes
[38;5;119m✔[0m [AstToCStar] ⏱️ 16ms
[38;5;119m✔[0m [CStarToC] ⏱️ <1ms
Warning 7: : After inlining, KrmlTest.test (going into KrmlTest) calls Crypto.Symmetric.Bytes.load_uint128 (going into Crypto_AEAD_Main) -- removing the static qualifier from Crypto.Symmetric.Bytes.load_uint128
Warning 7: : After inlining, KrmlTest.test (going into KrmlTest) calls Crypto.AEAD.Invariant.aead_state (going into Crypto_AEAD_Main) -- removing the static qualifier from Crypto.AEAD.Invariant.aead_state
Warning 7: : After inlining, KrmlTest.test (going into KrmlTest) calls Crypto.Plain.bufferRepr (going into Crypto_AEAD_Main) -- removing the static qualifier from Crypto.Plain.bufferRepr
Warning 7: : After inlining, Flag.cipher_prf (going into Flag) calls Crypto.Indexing.cipherAlg (going into Crypto_AEAD_Main) -- removing the static qualifier from Crypto.Indexing.cipherAlg
Warning 7: : After inlining, Flag.mac_int1cma (going into Flag) calls Crypto.Indexing.macAlg (going into Crypto_AEAD_Main) -- removing the static qualifier from Crypto.Indexing.macAlg
Warning 14: : Crypto.AEAD.Invariant.safelen is not Low*; it uses mathematical integers and runtime checks may fail; rewrite your code to use machine integers, or if you must, use -add-include '"prims_int.h"'; if this declaration is for specification purposes only, consider marking it noextract or using -bundle <name-of-the-module> to only keep reachable definitions.
Warning 14: : Crypto.AEAD.Invariant.maxplain is not Low*; it uses mathematical integers and runtime checks may fail; rewrite your code to use machine integers, or if you must, use -add-include '"prims_int.h"'; if this declaration is for specification purposes only, consider marking it noextract or using -bundle <name-of-the-module> to only keep reachable definitions.
Warning 14: : FStar.Seq.Base.cons__uint8_t is not Low*; it uses a garbage-collected type (e.g. list) and will leak memory; you need to link with a garbage-collector; if this declaration is for specification purposes only, consider marking it noextract or using -bundle <name-of-the-module> to only keep reachable definitions.
Warning 14: : FStar.Seq.Base.append__uint8_t is not Low*; it uses a garbage-collected type (e.g. list) and will leak memory; you need to link with a garbage-collector; if this declaration is for specification purposes only, consider marking it noextract or using -bundle <name-of-the-module> to only keep reachable definitions.
Warning 14: : FStar.Seq.Base.createEmpty__uint8_t is not Low*; it uses a garbage-collected type (e.g. list) and will leak memory; you need to link with a garbage-collector; if this declaration is for specification purposes only, consider marking it noextract or using -bundle <name-of-the-module> to only keep reachable definitions.
Warning 14: : FStar.Seq.Base.seq__uint8_t is not Low*; it uses a garbage-collected type (e.g. list) and will leak memory; you need to link with a garbage-collector; if this declaration is for specification purposes only, consider marking it noextract or using -bundle <name-of-the-module> to only keep reachable definitions.
Warning 14: : Prims.list__uint8_t is not Low*; it uses a garbage-collected type (e.g. list) and will leak memory; you need to link with a garbage-collector; if this declaration is for specification purposes only, consider marking it noextract or using -bundle <name-of-the-module> to only keep reachable definitions.
Warning 14: : Prims.pow2 is not Low*; it uses mathematical integers and runtime checks may fail; rewrite your code to use machine integers, or if you must, use -add-include '"prims_int.h"'; if this declaration is for specification purposes only, consider marking it noextract or using -bundle <name-of-the-module> to only keep reachable definitions.
Warning 14: : Prims.op_LessThanOrEqual is not Low*; it uses mathematical integers and runtime checks may fail; rewrite your code to use machine integers, or if you must, use -add-include '"prims_int.h"'; if this declaration is for specification purposes only, consider marking it noextract or using -bundle <name-of-the-module> to only keep reachable definitions.
Warning 14: : Prims.op_Addition is not Low*; it uses mathematical integers and runtime checks may fail; rewrite your code to use machine integers, or if you must, use -add-include '"prims_int.h"'; if this declaration is for specification purposes only, consider marking it noextract or using -bundle <name-of-the-module> to only keep reachable definitions.
Warning 14: : Prims.op_Subtraction is not Low*; it uses mathematical integers and runtime checks may fail; rewrite your code to use machine integers, or if you must, use -add-include '"prims_int.h"'; if this declaration is for specification purposes only, consider marking it noextract or using -bundle <name-of-the-module> to only keep reachable definitions.
Warning 14: : Prims.op_Multiply is not Low*; it uses mathematical integers and runtime checks may fail; rewrite your code to use machine integers, or if you must, use -add-include '"prims_int.h"'; if this declaration is for specification purposes only, consider marking it noextract or using -bundle <name-of-the-module> to only keep reachable definitions.
Warning 14: : C.String.of_literal is not Low*; it uses F*'s Prims.string type and will leak memory; you need to link with a garbage-collector; if this declaration is for specification purposes only, consider marking it noextract or using -bundle <name-of-the-module> to only keep reachable definitions; if you are looking to use C strings, look into C.String (in kremlib/) and Server (in test/). See the KreMLin tutorial for more information.
[38;5;81m⚙ KreMLin auto-detecting tools.[0m Here's what we found:
[4mreadlink is:[0m readlink
[4mKreMLin called via:[0m C:\build\agent1\_work\13\s\kremlin\_build\src\Kremlin.native
[4mthe Kremlin executable is:[0m C:\build\agent1\_work\13\s\kremlin\_build\src\Kremlin.native
[4mKreMLin home is:[0m C:/build/agent1/_work/13/s/kremlin
[38;5;81m⚙ KreMLin will drive F*.[0m Here's what we found:
read FSTAR_HOME via the environment
[4mfstar converted to windows path:[0m C:/build/agent1/_work/13/s/FStar/bin/fstar.exe
[4mfstar home converted to windows path:[0m C:/build/agent1/_work/13/s/FStar
[4mfstar lib converted to windows path:[0m C:/build/agent1/_work/13/s/FStar/ulib
fstar is on [38;5;202mbranch protz_uint128[0m
[4mfstar is:[0m C:/build/agent1/_work/13/s/FStar/bin/fstar.exe C:/build/agent1/_work/13/s/kremlin/runtime/WasmSupport.fst C:/build/agent1/_work/13/s/FStar/ulib/FStar.UInt128.fst --trace_error --cache_checked_modules --expose_interfaces --include C:/build/agent1/_work/13/s/kremlin/include --include C:/build/agent1/_work/13/s/kremlin/kremlib
[38;5;119m✔[0m [PrettyPrinting] ⏱️ 31ms
KreMLin: wrote out .c files for C_String, TestLib, C_Loops_Spec_Loops, Prims, FStar, Buffer_Utils, C_Endianness, C_Nullity, Vale_AES, Seq_Create, C, Hacl_Impl_Poly1305_64_Hacl_Impl_Chacha20, Crypto_AEAD_Main, KrmlTest, Flag, LowStar
KreMLin: wrote out .h files for C_String, TestLib, C_Loops_Spec_Loops, Prims, FStar, Buffer_Utils, C_Endianness, C_Nullity, Vale_AES, Seq_Create, C, Hacl_Impl_Poly1305_64_Hacl_Impl_Chacha20, Crypto_AEAD_Main, KrmlTest, Flag, LowStar
[38;5;81m⚙ KreMLin will drive the C compiler.[0m Here's what we found:
[4mgcc is:[0m x86_64-w64-mingw32-gcc
[4mx86_64-w64-mingw32-gcc options are:[0m -I C:/build/agent1/_work/13/s/kremlin/include -I C:/build/agent1/_work/13/s/kremlin/kremlib -I ../secure_api/out/runtime_switch/extracted -Wall -Werror -Wno-unused-variable -Wno-unknown-warning-option -Wno-unused-but-set-variable -g -fwrapv -fstack-check -D_BSD_SOURCE -D_DEFAULT_SOURCE -D__USE_MINGW_ANSI_STDIO -Wno-parentheses -std=c11
[38;5;81m⚡ Generating object files[0m
[38;5;119m✔[0m [CC,../secure_api/out/runtime_switch/extracted/C_String.c] (use -verbose to see the output)
[38;5;119m✔[0m [CC,../secure_api/out/runtime_switch/extracted/TestLib.c] (use -verbose to see the output)
[38;5;119m✔[0m [CC,../secure_api/out/runtime_switch/extracted/C_Loops_Spec_Loops.c] (use -verbose to see the output)
[38;5;119m✔[0m [CC,../secure_api/out/runtime_switch/extracted/Prims.c] (use -verbose to see the output)
[38;5;119m✔[0m [CC,../secure_api/out/runtime_switch/extracted/FStar.c] (use -verbose to see the output)
[38;5;119m✔[0m [CC,../secure_api/out/runtime_switch/extracted/Buffer_Utils.c] (use -verbose to see the output)
[38;5;119m✔[0m [CC,../secure_api/out/runtime_switch/extracted/C_Endianness.c] (use -verbose to see the output)
[38;5;119m✔[0m [CC,../secure_api/out/runtime_switch/extracted/C_Nullity.c] (use -verbose to see the output)
[38;5;119m✔[0m [CC,../secure_api/out/runtime_switch/extracted/Vale_AES.c] (use -verbose to see the output)
[38;5;119m✔[0m [CC,../secure_api/out/runtime_switch/extracted/Seq_Create.c] (use -verbose to see the output)
[38;5;119m✔[0m [CC,../secure_api/out/runtime_switch/extracted/C.c] (use -verbose to see the output)
[38;5;119m✔[0m [CC,../secure_api/out/runtime_switch/extracted/Hacl_Impl_Poly1305_64_Hacl_Impl_Chacha20.c] (use -verbose to see the output)
[38;5;119m✔[0m [CC,../secure_api/out/runtime_switch/extracted/Crypto_AEAD_Main.c] (use -verbose to see the output)
[38;5;119m✔[0m [CC,../secure_api/out/runtime_switch/extracted/KrmlTest.c] (use -verbose to see the output)
[38;5;119m✔[0m [CC,../secure_api/out/runtime_switch/extracted/Flag.c] (use -verbose to see the output)
[38;5;119m✔[0m [CC,../secure_api/out/runtime_switch/extracted/LowStar.c] (use -verbose to see the output)
[38;5;119m✔[0m [LD] (use -verbose to see the output)
[38;5;119mAll files linked successfully[0m 👍
./../secure_api/out/runtime_switch/krml-test.exe
test()
[test] expected output cipher is d31a8d34648e60db7b86afbc53ef7ec2a4aded51296e08fea9e2b5a736ee62d63dbea45e8ca9671282fafb69da92728b1a71de0a9e060b2905d6a5b67ecd3b3692ddbd7f2d778b8c9803aee328091b58fab324e4fad675945585808b4831d7bc3ff4def08e4b7a9de576d26586cec64b61161ae10b594f09e26a7e902ecbd0600691
[test] computed output cipher is d31a8d34648e60db7b86afbc53ef7ec2a4aded51296e08fea9e2b5a736ee62d63dbea45e8ca9671282fafb69da92728b1a71de0a9e060b2905d6a5b67ecd3b3692ddbd7f2d778b8c9803aee328091b58fab324e4fad675945585808b4831d7bc3ff4def08e4b7a9de576d26586cec64b61161ae10b594f09e26a7e902ecbd0600691
[test] cipher is a success
[test] expected output decryption is 4c616469657320616e642047656e746c656d656e206f662074686520636c617373206f66202739393a204966204920636f756c64206f6666657220796f75206f6e6c79206f6e652074697020666f7220746865206675747572652c2073756e73637265656e20776f756c642062652069742e
[test] computed output decryption is 4c616469657320616e642047656e746c656d656e206f662074686520636c617373206f66202739393a204966204920636f756c64206f6666657220796f75206f6e6c79206f6e652074697020666f7220746865206675747572652c2073756e73637265656e20776f756c642062652069742e
[test] decryption is a success
test_aes_gcm_0()
[test] expected output cipher is 58e2fccefa7e3061367f1d57a4e7455a
[test] computed output cipher is 58e2fccefa7e3061367f1d57a4e7455a
[test] cipher is a success
[test] expected output decryption is 
[test] computed output decryption is 
[test] decryption is a success
test_aes_gcm_1()
[test] expected output cipher is 530f8afbc74536b9a963b4f1c4cb738b
[test] computed output cipher is 530f8afbc74536b9a963b4f1c4cb738b
[test] cipher is a success
[test] expected output decryption is 
[test] computed output decryption is 
[test] decryption is a success
test_aes_gcm_2()
[test] expected output cipher is cea7403d4d606b6e074ec5d3baf39d18d0d1c8a799996bf0265b98b5d48ab919
[test] computed output cipher is cea7403d4d606b6e074ec5d3baf39d18d0d1c8a799996bf0265b98b5d48ab919
[test] cipher is a success
[test] expected output decryption is 00000000000000000000000000000000
[test] computed output decryption is 00000000000000000000000000000000
[test] decryption is a success
test_aes_gcm_3()
[test] expected output cipher is 522dc1f099567d07f47f37a32a84427d643a8cdcbfe5c0c97598a2bd2555d1aa8cb08e48590dbb3da7b08b1056828838c5f61e6393ba7a0abcc9f662898015adb094dac5d93471bdec1a502270e3cc6c
[test] computed output cipher is 522dc1f099567d07f47f37a32a84427d643a8cdcbfe5c0c97598a2bd2555d1aa8cb08e48590dbb3da7b08b1056828838c5f61e6393ba7a0abcc9f662898015adb094dac5d93471bdec1a502270e3cc6c
[test] cipher is a success
[test] expected output decryption is d9313225f88406e5a55909c5aff5269a86a7a9531534f7da2e4c303d8a318a721c3c0c95956809532fcf0e2449a6b525b16aedf5aa0de657ba637b391aafd255
[test] computed output decryption is d9313225f88406e5a55909c5aff5269a86a7a9531534f7da2e4c303d8a318a721c3c0c95956809532fcf0e2449a6b525b16aedf5aa0de657ba637b391aafd255
[test] decryption is a success
test_aes_gcm_4()
[test] expected output cipher is 522dc1f099567d07f47f37a32a84427d643a8cdcbfe5c0c97598a2bd2555d1aa8cb08e48590dbb3da7b08b1056828838c5f61e6393ba7a0abcc9f66276fc6ece0f4e1768cddf8853bb2d551b
[test] computed output cipher is 522dc1f099567d07f47f37a32a84427d643a8cdcbfe5c0c97598a2bd2555d1aa8cb08e48590dbb3da7b08b1056828838c5f61e6393ba7a0abcc9f66276fc6ece0f4e1768cddf8853bb2d551b
[test] cipher is a success
[test] expected output decryption is d9313225f88406e5a55909c5aff5269a86a7a9531534f7da2e4c303d8a318a721c3c0c95956809532fcf0e2449a6b525b16aedf5aa0de657ba637b39
[test] computed output decryption is d9313225f88406e5a55909c5aff5269a86a7a9531534f7da2e4c303d8a318a721c3c0c95956809532fcf0e2449a6b525b16aedf5aa0de657ba637b39
[test] decryption is a success
make -C C:/build/agent1/_work/13/s/MLCrypto
make[1]: Entering directory '/cygdrive/c/build/agent1/_work/13/s/MLCrypto'
make[1]: Nothing to be done for 'all'.
make[1]: Leaving directory '/cygdrive/c/build/agent1/_work/13/s/MLCrypto'
OCAMLPATH="C:/build/agent1/_work/13/s/FStar/bin" ocamlfind opt -package fstarlib,zarith -g -I C:/build/agent1/_work/13/s/FStar/ulib/ml -c LowCProvider/LowCProvider.ml -I LowCProvider -I ../secure_api/out/runtime_switch -I ../secure_api/out/runtime_switch/extracted -I C:/build/agent1/_work/13/s/MLCrypto -o LowCProvider/LowCProvider.cmx
C:/build/agent1/_work/13/s/kremlin/krml -falloca -ftail-calls -bundle 'Crypto_Symmetric_Bytes=*' -minimal -skip-compilation \
-tmpdir ../secure_api/out/runtime_switch/crypto ../secure_api/out/runtime_switch/extracted/prims.krml ../secure_api/out/runtime_switch/extracted/FStar_Pervasives_Native.krml ../secure_api/out/runtime_switch/extracted/FStar_Pervasives.krml ../secure_api/out/runtime_switch/extracted/FStar_Mul.krml ../secure_api/out/runtime_switch/extracted/FStar_Math_Lib.krml ../secure_api/out/runtime_switch/extracted/FStar_Math_Lemmas.krml ../secure_api/out/runtime_switch/extracted/FStar_Squash.krml ../secure_api/out/runtime_switch/extracted/FStar_StrongExcludedMiddle.krml ../secure_api/out/runtime_switch/extracted/FStar_Classical.krml ../secure_api/out/runtime_switch/extracted/FStar_List_Tot_Base.krml ../secure_api/out/runtime_switch/extracted/FStar_List_Tot_Properties.krml ../secure_api/out/runtime_switch/extracted/FStar_List_Tot.krml ../secure_api/out/runtime_switch/extracted/FStar_Seq_Base.krml ../secure_api/out/runtime_switch/extracted/FStar_Seq_Properties.krml ../secure_api/out/runtime_switch/extracted/FStar_Seq.krml ../secure_api/out/runtime_switch/extracted/FStar_BitVector.krml ../secure_api/out/runtime_switch/extracted/FStar_UInt.krml ../secure_api/out/runtime_switch/extracted/FStar_UInt32.krml ../secure_api/out/runtime_switch/extracted/FStar_Int.krml ../secure_api/out/runtime_switch/extracted/FStar_Int64.krml ../secure_api/out/runtime_switch/extracted/FStar_Int63.krml ../secure_api/out/runtime_switch/extracted/FStar_Int32.krml ../secure_api/out/runtime_switch/extracted/FStar_Int16.krml ../secure_api/out/runtime_switch/extracted/FStar_Int8.krml ../secure_api/out/runtime_switch/extracted/FStar_UInt64.krml ../secure_api/out/runtime_switch/extracted/FStar_UInt63.krml ../secure_api/out/runtime_switch/extracted/FStar_UInt16.krml ../secure_api/out/runtime_switch/extracted/FStar_UInt8.krml ../secure_api/out/runtime_switch/extracted/FStar_Int_Cast.krml ../secure_api/out/runtime_switch/extracted/FStar_UInt128.krml ../secure_api/out/runtime_switch/extracted/Hacl_UInt64.krml ../secure_api/out/runtime_switch/extracted/FStar_Preorder.krml ../secure_api/out/runtime_switch/extracted/FStar_Ghost.krml ../secure_api/out/runtime_switch/extracted/FStar_ErasedLogic.krml ../secure_api/out/runtime_switch/extracted/FStar_FunctionalExtensionality.krml ../secure_api/out/runtime_switch/extracted/FStar_Set.krml ../secure_api/out/runtime_switch/extracted/FStar_PropositionalExtensionality.krml ../secure_api/out/runtime_switch/extracted/FStar_PredicateExtensionality.krml ../secure_api/out/runtime_switch/extracted/FStar_TSet.krml ../secure_api/out/runtime_switch/extracted/FStar_Monotonic_Heap.krml ../secure_api/out/runtime_switch/extracted/FStar_Heap.krml ../secure_api/out/runtime_switch/extracted/FStar_Map.krml ../secure_api/out/runtime_switch/extracted/FStar_Monotonic_HyperHeap.krml ../secure_api/out/runtime_switch/extracted/FStar_Monotonic_HyperStack.krml ../secure_api/out/runtime_switch/extracted/FStar_HyperStack.krml ../secure_api/out/runtime_switch/extracted/FStar_Monotonic_Witnessed.krml ../secure_api/out/runtime_switch/extracted/FStar_HyperStack_ST.krml ../secure_api/out/runtime_switch/extracted/FStar_HyperStack_All.krml ../secure_api/out/runtime_switch/extracted/Hacl_UInt128.krml ../secure_api/out/runtime_switch/extracted/Hacl_UInt8.krml ../secure_api/out/runtime_switch/extracted/Hacl_Bignum_Constants.krml ../secure_api/out/runtime_switch/extracted/Hacl_UInt32.krml ../secure_api/out/runtime_switch/extracted/FStar_Int_Cast_Full.krml ../secure_api/out/runtime_switch/extracted/Hacl_Cast.krml ../secure_api/out/runtime_switch/extracted/FStar_Buffer.krml ../secure_api/out/runtime_switch/extracted/Hacl_Bignum_Parameters.krml ../secure_api/out/runtime_switch/extracted/Hacl_Bignum_Wide.krml ../secure_api/out/runtime_switch/extracted/Spec_Loops.krml ../secure_api/out/runtime_switch/extracted/Hacl_Bignum_Limb.krml ../secure_api/out/runtime_switch/extracted/Hacl_Spec_Bignum_Field.krml ../secure_api/out/runtime_switch/extracted/Hacl_Spec_Bignum_Bigint.krml ../secure_api/out/runtime_switch/extracted/Hacl_Spec_Bignum_Modulo.krml ../secure_api/out/runtime_switch/extracted/Hacl_Spec_Bignum_Fproduct.krml ../secure_api/out/runtime_switch/extracted/Hacl_Spec_Bignum_Fmul.krml ../secure_api/out/runtime_switch/extracted/FStar_Endianness.krml ../secure_api/out/runtime_switch/extracted/Spec_Poly1305_Lemmas.krml ../secure_api/out/runtime_switch/extracted/FStar_Kremlin_Endianness.krml ../secure_api/out/runtime_switch/extracted/C_Endianness.krml ../secure_api/out/runtime_switch/extracted/C.krml ../secure_api/out/runtime_switch/extracted/Hacl_UInt16.krml ../secure_api/out/runtime_switch/extracted/Hacl_Spec_Endianness.krml ../secure_api/out/runtime_switch/extracted/Hacl_Endianness.krml ../secure_api/out/runtime_switch/extracted/Spec_Lib.krml ../secure_api/out/runtime_switch/extracted/Seq_Create.krml ../secure_api/out/runtime_switch/extracted/Spec_SHA2_256.krml ../secure_api/out/runtime_switch/extracted/C_Loops.krml ../secure_api/out/runtime_switch/extracted/Hacl_Hash_Lib_LoadStore.krml ../secure_api/out/runtime_switch/extracted/Hacl_Hash_Lib_Create.krml ../secure_api/out/runtime_switch/extracted/Hacl_Impl_SHA2_256_Lemmas.krml ../secure_api/out/runtime_switch/extracted/Hacl_Impl_SHA2_256.krml ../secure_api/out/runtime_switch/extracted/Hacl_Spec_Bignum_Fsum.krml ../secure_api/out/runtime_switch/extracted/Hacl_Bignum_Fsum.krml ../secure_api/out/runtime_switch/extracted/Crypto_AEAD_BufferUtils.krml ../secure_api/out/runtime_switch/extracted/Vale_AES.krml ../secure_api/out/runtime_switch/extracted/Hacl_Impl_Xor_Lemmas.krml ../secure_api/out/runtime_switch/extracted/Spec_CTR_Lemmas.krml ../secure_api/out/runtime_switch/extracted/Spec_CTR.krml ../secure_api/out/runtime_switch/extracted/Hacl_Lib_LoadStore32.krml ../secure_api/out/runtime_switch/extracted/Spec_Chacha20_Lemmas.krml ../secure_api/out/runtime_switch/extracted/Spec_Chacha20.krml ../secure_api/out/runtime_switch/extracted/Hacl_Impl_Chacha20.krml ../secure_api/out/runtime_switch/extracted/Hacl_SecureAPI_Chacha20.krml ../secure_api/out/runtime_switch/extracted/Crypto_Indexing.krml ../secure_api/out/runtime_switch/extracted/Flag.krml ../secure_api/out/runtime_switch/extracted/Crypto_Symmetric_AES.krml ../secure_api/out/runtime_switch/extracted/Crypto_Symmetric_AES128.krml ../secure_api/out/runtime_switch/extracted/FStar_Float.krml ../secure_api/out/runtime_switch/extracted/FStar_Exn.krml ../secure_api/out/runtime_switch/extracted/FStar_ST.krml ../secure_api/out/runtime_switch/extracted/FStar_All.krml ../secure_api/out/runtime_switch/extracted/FStar_IO.krml ../secure_api/out/runtime_switch/extracted/Buffer_Utils.krml ../secure_api/out/runtime_switch/extracted/Crypto_Symmetric_Bytes.krml ../secure_api/out/runtime_switch/extracted/Crypto_Symmetric_Cipher.krml ../secure_api/out/runtime_switch/extracted/C_Nullity.krml ../secure_api/out/runtime_switch/extracted/Hacl_Spec_Bignum_AddAndMultiply.krml ../secure_api/out/runtime_switch/extracted/Spec_Poly1305.krml ../secure_api/out/runtime_switch/extracted/Hacl_Bignum_Modulo.krml ../secure_api/out/runtime_switch/extracted/Hacl_Bignum_Fproduct.krml ../secure_api/out/runtime_switch/extracted/Hacl_Spec_Poly1305_64_State.krml ../secure_api/out/runtime_switch/extracted/Hacl_Spec_Poly1305_64.krml ../secure_api/out/runtime_switch/extracted/Hacl_Impl_Poly1305_64_State.krml ../secure_api/out/runtime_switch/extracted/Hacl_Bignum_Fmul.krml ../secure_api/out/runtime_switch/extracted/Hacl_Bignum_AddAndMultiply.krml ../secure_api/out/runtime_switch/extracted/Hacl_Spe_Poly1305_64.krml ../secure_api/out/runtime_switch/extracted/Hacl_Impl_Poly1305_64.krml ../secure_api/out/runtime_switch/extracted/Spec_GaloisField.krml ../secure_api/out/runtime_switch/extracted/Spec_GF128.krml ../secure_api/out/runtime_switch/extracted/Crypto_Symmetric_GF128.krml ../secure_api/out/runtime_switch/extracted/Crypto_Symmetric_MAC.krml ../secure_api/out/runtime_switch/extracted/Crypto_Symmetric_UF1CMA.krml ../secure_api/out/runtime_switch/extracted/Crypto_Plain.krml ../secure_api/out/runtime_switch/extracted/Crypto_Symmetric_PRF.krml ../secure_api/out/runtime_switch/extracted/Crypto_AEAD_Encoding.krml ../secure_api/out/runtime_switch/extracted/Crypto_AEAD_Invariant.krml ../secure_api/out/runtime_switch/extracted/Crypto_AEAD_Encrypt_Invariant.krml ../secure_api/out/runtime_switch/extracted/Crypto_AEAD_Wrappers_PRF.krml ../secure_api/out/runtime_switch/extracted/Crypto_AEAD_Wrappers_Encoding.krml ../secure_api/out/runtime_switch/extracted/Crypto_AEAD_Wrappers_CMA.krml ../secure_api/out/runtime_switch/extracted/Crypto_AEAD_EnxorDexor.krml ../secure_api/out/runtime_switch/extracted/Crypto_AEAD_Decrypt.krml ../secure_api/out/runtime_switch/extracted/Spec_HMAC_SHA2_256.krml ../secure_api/out/runtime_switch/extracted/Spec_SHA2_512.krml ../secure_api/out/runtime_switch/extracted/Hacl_Impl_SHA2_512_Lemmas.krml ../secure_api/out/runtime_switch/extracted/Hacl_Impl_SHA2_512.krml ../secure_api/out/runtime_switch/extracted/Spec_SHA2_384.krml ../secure_api/out/runtime_switch/extracted/Hacl_Impl_SHA2_384_Lemmas.krml ../secure_api/out/runtime_switch/extracted/Hacl_Impl_SHA2_384.krml ../secure_api/out/runtime_switch/extracted/Crypto_HMAC.krml ../secure_api/out/runtime_switch/extracted/Crypto_AEAD_Encrypt_Ideal_Invariant.krml ../secure_api/out/runtime_switch/extracted/Crypto_AEAD_MAC_Wrapper_Invariant.krml ../secure_api/out/runtime_switch/extracted/Crypto_AEAD_Enxor_Invariant.krml ../secure_api/out/runtime_switch/extracted/Crypto_AEAD_Encrypt.krml ../secure_api/out/runtime_switch/extracted/Crypto_AEAD.krml ../secure_api/out/runtime_switch/extracted/FStar_List.krml ../secure_api/out/runtime_switch/extracted/FStar_Char.krml ../secure_api/out/runtime_switch/extracted/FStar_String.krml ../secure_api/out/runtime_switch/extracted/C_String.krml ../secure_api/out/runtime_switch/extracted/TestLib.krml ../secure_api/out/runtime_switch/extracted/FStar_Bytes.krml ../secure_api/out/runtime_switch/extracted/Crypto_AEAD_Main.krml ../secure_api/out/runtime_switch/extracted/CryptoTypes.krml ../secure_api/out/runtime_switch/extracted/Crypto_HKDF.krml ../secure_api/out/runtime_switch/extracted/HaclProvider.krml ../secure_api/out/runtime_switch/extracted/KrmlTest.krml ../secure_api/out/runtime_switch/extracted/LowCProvider.krml -add-include '"kremlib.h"' -add-include '"kremlin/internal/compat.h"' \

Warning 6: in the definition of buf, after the definition of m0, in the last element of the sequence, in top-level declaration Crypto.Symmetric.Bytes.random_bytes, in file Crypto_Symmetric_Bytes: stack newbuf 0uint8 @1 is a non-constant size, stack-allocated array; this is not supported by CompCert and requires the use of alloca(3) for MSVC
[38;5;119m✔[0m [Monomorphization] ⏱️ 47ms
[38;5;119m✔[0m [Inlining] ⏱️ <1ms
[38;5;119m✔[0m [Pattern matches compilation] ⏱️ 16ms
[38;5;119m✔[0m [Simplify 2] ⏱️ <1ms
Warning 14: : FStar.List.Tot.Base.length__uint8_t is recursive but cannot be optimized to a tail-call
Warning 14: : FStar.Seq.Base.slice__uint8_t is recursive but cannot be optimized to a tail-call
Warning 14: : FStar.Endianness.little_endian is recursive but cannot be optimized to a tail-call
Warning 14: : FStar.Endianness.big_endian is recursive but cannot be optimized to a tail-call
[38;5;119m✔[0m [Structs + Simplify 2] ⏱️ 16ms
[38;5;119m✔[0m [Drop] ⏱️ <1ms
Warning 14: : FStar.List.Tot.Base.append__uint8_t is recursive but cannot be optimized to a tail-call
Warning 14: : FStar.Seq.Base.create__uint8_t is recursive but cannot be optimized to a tail-call
[38;5;119m✔[0m [AstToCStar] ⏱️ <1ms
[38;5;119m✔[0m [CStarToC] ⏱️ <1ms
Warning 14: : FStar.Endianness.little_bytes is recursive but cannot be optimized to a tail-call
Warning 14: : Crypto.Symmetric.Bytes.load_bytes is recursive but cannot be optimized to a tail-call
Warning 14: : Crypto.Symmetric.Bytes.load_uint32 is recursive but cannot be optimized to a tail-call
Warning 14: : Crypto.Symmetric.Bytes.load_big32 is recursive but cannot be optimized to a tail-call
Warning 14: : Crypto.Symmetric.Bytes.load_big64 is recursive but cannot be optimized to a tail-call
Warning 14: : Crypto.Symmetric.Bytes.load_uint128 is recursive but cannot be optimized to a tail-call
Warning 14: : Crypto.Symmetric.Bytes.load_big128 is recursive but cannot be optimized to a tail-call
Warning 14: : Crypto.Symmetric.Bytes.store_uint32 is recursive but cannot be optimized to a tail-call
Warning 14: : Crypto.Symmetric.Bytes.store_big32 is recursive but cannot be optimized to a tail-call
Warning 14: : Crypto.Symmetric.Bytes.big_bytes is recursive but cannot be optimized to a tail-call
Warning 14: : Crypto.Symmetric.Bytes.store_uint128 is recursive but cannot be optimized to a tail-call
Warning 14: : Crypto.Symmetric.Bytes.store_big128 is recursive but cannot be optimized to a tail-call
Warning 14: : Crypto.Symmetric.Bytes.print_buffer is not Low*; it uses F*'s Prims.string type and will leak memory; you need to link with a garbage-collector; if this declaration is for specification purposes only, consider marking it noextract or using -bundle <name-of-the-module> to only keep reachable definitions; if you are looking to use C strings, look into C.String (in kremlib/) and Server (in test/). See the KreMLin tutorial for more information.
Warning 14: : Crypto.Symmetric.Bytes.hex2 is not Low*; it uses F*'s Prims.string type and will leak memory; you need to link with a garbage-collector; if this declaration is for specification purposes only, consider marking it noextract or using -bundle <name-of-the-module> to only keep reachable definitions; if you are looking to use C strings, look into C.String (in kremlib/) and Server (in test/). See the KreMLin tutorial for more information.
Warning 14: : Crypto.Symmetric.Bytes.hex1 is not Low*; it uses F*'s Prims.string type and will leak memory; you need to link with a garbage-collector; if this declaration is for specification purposes only, consider marking it noextract or using -bundle <name-of-the-module> to only keep reachable definitions; if you are looking to use C strings, look into C.String (in kremlib/) and Server (in test/). See the KreMLin tutorial for more information.
Warning 14: : FStar.IO.debug_print_string is not Low*; it uses F*'s Prims.string type and will leak memory; you need to link with a garbage-collector; if this declaration is for specification purposes only, consider marking it noextract or using -bundle <name-of-the-module> to only keep reachable definitions; if you are looking to use C strings, look into C.String (in kremlib/) and Server (in test/). See the KreMLin tutorial for more information.
Warning 14: : FStar.Seq.Base.append__uint8_t is not Low*; it uses a garbage-collected type (e.g. list) and will leak memory; you need to link with a garbage-collector; if this declaration is for specification purposes only, consider marking it noextract or using -bundle <name-of-the-module> to only keep reachable definitions.
Warning 14: : FStar.Seq.Base.createEmpty__uint8_t is not Low*; it uses a garbage-collected type (e.g. list) and will leak memory; you need to link with a garbage-collector; if this declaration is for specification purposes only, consider marking it noextract or using -bundle <name-of-the-module> to only keep reachable definitions.
Warning 14: : FStar.Seq.Properties.last__uint8_t is not Low*; it uses mathematical integers and runtime checks may fail; rewrite your code to use machine integers, or if you must, use -add-include '"prims_int.h"'; if this declaration is for specification purposes only, consider marking it noextract or using -bundle <name-of-the-module> to only keep reachable definitions.
Warning 14: : FStar.Seq.Base.hd__uint8_t is not Low*; it uses a garbage-collected type (e.g. list) and will leak memory; you need to link with a garbage-collector; if this declaration is for specification purposes only, consider marking it noextract or using -bundle <name-of-the-module> to only keep reachable definitions.
Warning 14: : FStar.Seq.Base.cons__uint8_t is not Low*; it uses a garbage-collected type (e.g. list) and will leak memory; you need to link with a garbage-collector; if this declaration is for specification purposes only, consider marking it noextract or using -bundle <name-of-the-module> to only keep reachable definitions.
Warning 14: : FStar.Seq.Base.tl__uint8_t is not Low*; it uses a garbage-collected type (e.g. list) and will leak memory; you need to link with a garbage-collector; if this declaration is for specification purposes only, consider marking it noextract or using -bundle <name-of-the-module> to only keep reachable definitions.
Warning 14: : FStar.Seq.Base.index__uint8_t is not Low*; it uses a garbage-collected type (e.g. list) and will leak memory; you need to link with a garbage-collector; if this declaration is for specification purposes only, consider marking it noextract or using -bundle <name-of-the-module> to only keep reachable definitions.
Warning 14: : FStar.List.Tot.Base.index__uint8_t is not Low*; it uses mathematical integers and runtime checks may fail; rewrite your code to use machine integers, or if you must, use -add-include '"prims_int.h"'; if this declaration is for specification purposes only, consider marking it noextract or using -bundle <name-of-the-module> to only keep reachable definitions.
Warning 14: : FStar.List.Tot.Base.index__uint8_t is not Low*; it uses a garbage-collected type (e.g. list) and will leak memory; you need to link with a garbage-collector; if this declaration is for specification purposes only, consider marking it noextract or using -bundle <name-of-the-module> to only keep reachable definitions.
Warning 14: : FStar.List.Tot.Base.tl__uint8_t is not Low*; it uses a garbage-collected type (e.g. list) and will leak memory; you need to link with a garbage-collector; if this declaration is for specification purposes only, consider marking it noextract or using -bundle <name-of-the-module> to only keep reachable definitions.
Warning 14: : FStar.List.Tot.Base.tail__uint8_t is not Low*; it uses a garbage-collected type (e.g. list) and will leak memory; you need to link with a garbage-collector; if this declaration is for specification purposes only, consider marking it noextract or using -bundle <name-of-the-module> to only keep reachable definitions.
Warning 14: : FStar.List.Tot.Base.hd__uint8_t is not Low*; it uses a garbage-collected type (e.g. list) and will leak memory; you need to link with a garbage-collector; if this declaration is for specification purposes only, consider marking it noextract or using -bundle <name-of-the-module> to only keep reachable definitions.
Warning 14: : FStar.Seq.Base.length__uint8_t is not Low*; it uses a garbage-collected type (e.g. list) and will leak memory; you need to link with a garbage-collector; if this declaration is for specification purposes only, consider marking it noextract or using -bundle <name-of-the-module> to only keep reachable definitions.
Warning 14: : FStar.Seq.Base.seq__uint8_t is not Low*; it uses a garbage-collected type (e.g. list) and will leak memory; you need to link with a garbage-collector; if this declaration is for specification purposes only, consider marking it noextract or using -bundle <name-of-the-module> to only keep reachable definitions.
Warning 14: : Prims.list__uint8_t is not Low*; it uses a garbage-collected type (e.g. list) and will leak memory; you need to link with a garbage-collector; if this declaration is for specification purposes only, consider marking it noextract or using -bundle <name-of-the-module> to only keep reachable definitions.
Warning 14: : FStar.UInt8.to_string is not Low*; it uses F*'s Prims.string type and will leak memory; you need to link with a garbage-collector; if this declaration is for specification purposes only, consider marking it noextract or using -bundle <name-of-the-module> to only keep reachable definitions; if you are looking to use C strings, look into C.String (in kremlib/) and Server (in test/). See the KreMLin tutorial for more information.
Warning 14: : Prims.strcat is not Low*; it uses F*'s Prims.string type and will leak memory; you need to link with a garbage-collector; if this declaration is for specification purposes only, consider marking it noextract or using -bundle <name-of-the-module> to only keep reachable definitions; if you are looking to use C strings, look into C.String (in kremlib/) and Server (in test/). See the KreMLin tutorial for more information.
Warning 14: : Prims.pow2 is not Low*; it uses mathematical integers and runtime checks may fail; rewrite your code to use machine integers, or if you must, use -add-include '"prims_int.h"'; if this declaration is for specification purposes only, consider marking it noextract or using -bundle <name-of-the-module> to only keep reachable definitions.
Warning 14: : Prims.op_GreaterThan is not Low*; it uses mathematical integers and runtime checks may fail; rewrite your code to use machine integers, or if you must, use -add-include '"prims_int.h"'; if this declaration is for specification purposes only, consider marking it noextract or using -bundle <name-of-the-module> to only keep reachable definitions.
Warning 14: : Prims.op_Modulus is not Low*; it uses mathematical integers and runtime checks may fail; rewrite your code to use machine integers, or if you must, use -add-include '"prims_int.h"'; if this declaration is for specification purposes only, consider marking it noextract or using -bundle <name-of-the-module> to only keep reachable definitions.
Warning 14: : Prims.op_Addition is not Low*; it uses mathematical integers and runtime checks may fail; rewrite your code to use machine integers, or if you must, use -add-include '"prims_int.h"'; if this declaration is for specification purposes only, consider marking it noextract or using -bundle <name-of-the-module> to only keep reachable definitions.
Warning 14: : Prims.op_Subtraction is not Low*; it uses mathematical integers and runtime checks may fail; rewrite your code to use machine integers, or if you must, use -add-include '"prims_int.h"'; if this declaration is for specification purposes only, consider marking it noextract or using -bundle <name-of-the-module> to only keep reachable definitions.
Warning 14: : Prims.op_Division is not Low*; it uses mathematical integers and runtime checks may fail; rewrite your code to use machine integers, or if you must, use -add-include '"prims_int.h"'; if this declaration is for specification purposes only, consider marking it noextract or using -bundle <name-of-the-module> to only keep reachable definitions.
Warning 14: : Prims.op_Multiply is not Low*; it uses mathematical integers and runtime checks may fail; rewrite your code to use machine integers, or if you must, use -add-include '"prims_int.h"'; if this declaration is for specification purposes only, consider marking it noextract or using -bundle <name-of-the-module> to only keep reachable definitions.
[38;5;81m⚙ KreMLin auto-detecting tools.[0m Here's what we found:
[4mreadlink is:[0m readlink
[4mKreMLin called via:[0m C:\build\agent1\_work\13\s\kremlin\_build\src\Kremlin.native
[4mthe Kremlin executable is:[0m C:\build\agent1\_work\13\s\kremlin\_build\src\Kremlin.native
[4mKreMLin home is:[0m C:/build/agent1/_work/13/s/kremlin
[38;5;81m⚙ KreMLin will drive F*.[0m Here's what we found:
read FSTAR_HOME via the environment
[4mfstar converted to windows path:[0m C:/build/agent1/_work/13/s/FStar/bin/fstar.exe
[4mfstar home converted to windows path:[0m C:/build/agent1/_work/13/s/FStar
[4mfstar lib converted to windows path:[0m C:/build/agent1/_work/13/s/FStar/ulib
fstar is on [38;5;202mbranch protz_uint128[0m
[4mfstar is:[0m C:/build/agent1/_work/13/s/FStar/bin/fstar.exe C:/build/agent1/_work/13/s/kremlin/runtime/WasmSupport.fst C:/build/agent1/_work/13/s/FStar/ulib/FStar.UInt128.fst --trace_error --cache_checked_modules --expose_interfaces --include C:/build/agent1/_work/13/s/kremlin/include --include C:/build/agent1/_work/13/s/kremlin/kremlib
[38;5;119m✔[0m [PrettyPrinting] ⏱️ <1ms
KreMLin: wrote out .c files for Crypto_Symmetric_Bytes
KreMLin: wrote out .h files for Crypto_Symmetric_Bytes
C:/build/agent1/_work/13/s/kremlin/krml -falloca -ftail-calls -bundle 'Crypto_AEAD_Main+Crypto_Symmetric_Cipher+Crypto_Indexing=*' -minimal -skip-compilation \
-tmpdir ../secure_api/out/runtime_switch/crypto ../secure_api/out/runtime_switch/extracted/prims.krml ../secure_api/out/runtime_switch/extracted/FStar_Pervasives_Native.krml ../secure_api/out/runtime_switch/extracted/FStar_Pervasives.krml ../secure_api/out/runtime_switch/extracted/FStar_Mul.krml ../secure_api/out/runtime_switch/extracted/FStar_Math_Lib.krml ../secure_api/out/runtime_switch/extracted/FStar_Math_Lemmas.krml ../secure_api/out/runtime_switch/extracted/FStar_Squash.krml ../secure_api/out/runtime_switch/extracted/FStar_StrongExcludedMiddle.krml ../secure_api/out/runtime_switch/extracted/FStar_Classical.krml ../secure_api/out/runtime_switch/extracted/FStar_List_Tot_Base.krml ../secure_api/out/runtime_switch/extracted/FStar_List_Tot_Properties.krml ../secure_api/out/runtime_switch/extracted/FStar_List_Tot.krml ../secure_api/out/runtime_switch/extracted/FStar_Seq_Base.krml ../secure_api/out/runtime_switch/extracted/FStar_Seq_Properties.krml ../secure_api/out/runtime_switch/extracted/FStar_Seq.krml ../secure_api/out/runtime_switch/extracted/FStar_BitVector.krml ../secure_api/out/runtime_switch/extracted/FStar_UInt.krml ../secure_api/out/runtime_switch/extracted/FStar_UInt32.krml ../secure_api/out/runtime_switch/extracted/FStar_Int.krml ../secure_api/out/runtime_switch/extracted/FStar_Int64.krml ../secure_api/out/runtime_switch/extracted/FStar_Int63.krml ../secure_api/out/runtime_switch/extracted/FStar_Int32.krml ../secure_api/out/runtime_switch/extracted/FStar_Int16.krml ../secure_api/out/runtime_switch/extracted/FStar_Int8.krml ../secure_api/out/runtime_switch/extracted/FStar_UInt64.krml ../secure_api/out/runtime_switch/extracted/FStar_UInt63.krml ../secure_api/out/runtime_switch/extracted/FStar_UInt16.krml ../secure_api/out/runtime_switch/extracted/FStar_UInt8.krml ../secure_api/out/runtime_switch/extracted/FStar_Int_Cast.krml ../secure_api/out/runtime_switch/extracted/FStar_UInt128.krml ../secure_api/out/runtime_switch/extracted/Hacl_UInt64.krml ../secure_api/out/runtime_switch/extracted/FStar_Preorder.krml ../secure_api/out/runtime_switch/extracted/FStar_Ghost.krml ../secure_api/out/runtime_switch/extracted/FStar_ErasedLogic.krml ../secure_api/out/runtime_switch/extracted/FStar_FunctionalExtensionality.krml ../secure_api/out/runtime_switch/extracted/FStar_Set.krml ../secure_api/out/runtime_switch/extracted/FStar_PropositionalExtensionality.krml ../secure_api/out/runtime_switch/extracted/FStar_PredicateExtensionality.krml ../secure_api/out/runtime_switch/extracted/FStar_TSet.krml ../secure_api/out/runtime_switch/extracted/FStar_Monotonic_Heap.krml ../secure_api/out/runtime_switch/extracted/FStar_Heap.krml ../secure_api/out/runtime_switch/extracted/FStar_Map.krml ../secure_api/out/runtime_switch/extracted/FStar_Monotonic_HyperHeap.krml ../secure_api/out/runtime_switch/extracted/FStar_Monotonic_HyperStack.krml ../secure_api/out/runtime_switch/extracted/FStar_HyperStack.krml ../secure_api/out/runtime_switch/extracted/FStar_Monotonic_Witnessed.krml ../secure_api/out/runtime_switch/extracted/FStar_HyperStack_ST.krml ../secure_api/out/runtime_switch/extracted/FStar_HyperStack_All.krml ../secure_api/out/runtime_switch/extracted/Hacl_UInt128.krml ../secure_api/out/runtime_switch/extracted/Hacl_UInt8.krml ../secure_api/out/runtime_switch/extracted/Hacl_Bignum_Constants.krml ../secure_api/out/runtime_switch/extracted/Hacl_UInt32.krml ../secure_api/out/runtime_switch/extracted/FStar_Int_Cast_Full.krml ../secure_api/out/runtime_switch/extracted/Hacl_Cast.krml ../secure_api/out/runtime_switch/extracted/FStar_Buffer.krml ../secure_api/out/runtime_switch/extracted/Hacl_Bignum_Parameters.krml ../secure_api/out/runtime_switch/extracted/Hacl_Bignum_Wide.krml ../secure_api/out/runtime_switch/extracted/Spec_Loops.krml ../secure_api/out/runtime_switch/extracted/Hacl_Bignum_Limb.krml ../secure_api/out/runtime_switch/extracted/Hacl_Spec_Bignum_Field.krml ../secure_api/out/runtime_switch/extracted/Hacl_Spec_Bignum_Bigint.krml ../secure_api/out/runtime_switch/extracted/Hacl_Spec_Bignum_Modulo.krml ../secure_api/out/runtime_switch/extracted/Hacl_Spec_Bignum_Fproduct.krml ../secure_api/out/runtime_switch/extracted/Hacl_Spec_Bignum_Fmul.krml ../secure_api/out/runtime_switch/extracted/FStar_Endianness.krml ../secure_api/out/runtime_switch/extracted/Spec_Poly1305_Lemmas.krml ../secure_api/out/runtime_switch/extracted/FStar_Kremlin_Endianness.krml ../secure_api/out/runtime_switch/extracted/C_Endianness.krml ../secure_api/out/runtime_switch/extracted/C.krml ../secure_api/out/runtime_switch/extracted/Hacl_UInt16.krml ../secure_api/out/runtime_switch/extracted/Hacl_Spec_Endianness.krml ../secure_api/out/runtime_switch/extracted/Hacl_Endianness.krml ../secure_api/out/runtime_switch/extracted/Spec_Lib.krml ../secure_api/out/runtime_switch/extracted/Seq_Create.krml ../secure_api/out/runtime_switch/extracted/Spec_SHA2_256.krml ../secure_api/out/runtime_switch/extracted/C_Loops.krml ../secure_api/out/runtime_switch/extracted/Hacl_Hash_Lib_LoadStore.krml ../secure_api/out/runtime_switch/extracted/Hacl_Hash_Lib_Create.krml ../secure_api/out/runtime_switch/extracted/Hacl_Impl_SHA2_256_Lemmas.krml ../secure_api/out/runtime_switch/extracted/Hacl_Impl_SHA2_256.krml ../secure_api/out/runtime_switch/extracted/Hacl_Spec_Bignum_Fsum.krml ../secure_api/out/runtime_switch/extracted/Hacl_Bignum_Fsum.krml ../secure_api/out/runtime_switch/extracted/Crypto_AEAD_BufferUtils.krml ../secure_api/out/runtime_switch/extracted/Vale_AES.krml ../secure_api/out/runtime_switch/extracted/Hacl_Impl_Xor_Lemmas.krml ../secure_api/out/runtime_switch/extracted/Spec_CTR_Lemmas.krml ../secure_api/out/runtime_switch/extracted/Spec_CTR.krml ../secure_api/out/runtime_switch/extracted/Hacl_Lib_LoadStore32.krml ../secure_api/out/runtime_switch/extracted/Spec_Chacha20_Lemmas.krml ../secure_api/out/runtime_switch/extracted/Spec_Chacha20.krml ../secure_api/out/runtime_switch/extracted/Hacl_Impl_Chacha20.krml ../secure_api/out/runtime_switch/extracted/Hacl_SecureAPI_Chacha20.krml ../secure_api/out/runtime_switch/extracted/Crypto_Indexing.krml ../secure_api/out/runtime_switch/extracted/Flag.krml ../secure_api/out/runtime_switch/extracted/Crypto_Symmetric_AES.krml ../secure_api/out/runtime_switch/extracted/Crypto_Symmetric_AES128.krml ../secure_api/out/runtime_switch/extracted/FStar_Float.krml ../secure_api/out/runtime_switch/extracted/FStar_Exn.krml ../secure_api/out/runtime_switch/extracted/FStar_ST.krml ../secure_api/out/runtime_switch/extracted/FStar_All.krml ../secure_api/out/runtime_switch/extracted/FStar_IO.krml ../secure_api/out/runtime_switch/extracted/Buffer_Utils.krml ../secure_api/out/runtime_switch/extracted/Crypto_Symmetric_Bytes.krml ../secure_api/out/runtime_switch/extracted/Crypto_Symmetric_Cipher.krml ../secure_api/out/runtime_switch/extracted/C_Nullity.krml ../secure_api/out/runtime_switch/extracted/Hacl_Spec_Bignum_AddAndMultiply.krml ../secure_api/out/runtime_switch/extracted/Spec_Poly1305.krml ../secure_api/out/runtime_switch/extracted/Hacl_Bignum_Modulo.krml ../secure_api/out/runtime_switch/extracted/Hacl_Bignum_Fproduct.krml ../secure_api/out/runtime_switch/extracted/Hacl_Spec_Poly1305_64_State.krml ../secure_api/out/runtime_switch/extracted/Hacl_Spec_Poly1305_64.krml ../secure_api/out/runtime_switch/extracted/Hacl_Impl_Poly1305_64_State.krml ../secure_api/out/runtime_switch/extracted/Hacl_Bignum_Fmul.krml ../secure_api/out/runtime_switch/extracted/Hacl_Bignum_AddAndMultiply.krml ../secure_api/out/runtime_switch/extracted/Hacl_Spe_Poly1305_64.krml ../secure_api/out/runtime_switch/extracted/Hacl_Impl_Poly1305_64.krml ../secure_api/out/runtime_switch/extracted/Spec_GaloisField.krml ../secure_api/out/runtime_switch/extracted/Spec_GF128.krml ../secure_api/out/runtime_switch/extracted/Crypto_Symmetric_GF128.krml ../secure_api/out/runtime_switch/extracted/Crypto_Symmetric_MAC.krml ../secure_api/out/runtime_switch/extracted/Crypto_Symmetric_UF1CMA.krml ../secure_api/out/runtime_switch/extracted/Crypto_Plain.krml ../secure_api/out/runtime_switch/extracted/Crypto_Symmetric_PRF.krml ../secure_api/out/runtime_switch/extracted/Crypto_AEAD_Encoding.krml ../secure_api/out/runtime_switch/extracted/Crypto_AEAD_Invariant.krml ../secure_api/out/runtime_switch/extracted/Crypto_AEAD_Encrypt_Invariant.krml ../secure_api/out/runtime_switch/extracted/Crypto_AEAD_Wrappers_PRF.krml ../secure_api/out/runtime_switch/extracted/Crypto_AEAD_Wrappers_Encoding.krml ../secure_api/out/runtime_switch/extracted/Crypto_AEAD_Wrappers_CMA.krml ../secure_api/out/runtime_switch/extracted/Crypto_AEAD_EnxorDexor.krml ../secure_api/out/runtime_switch/extracted/Crypto_AEAD_Decrypt.krml ../secure_api/out/runtime_switch/extracted/Spec_HMAC_SHA2_256.krml ../secure_api/out/runtime_switch/extracted/Spec_SHA2_512.krml ../secure_api/out/runtime_switch/extracted/Hacl_Impl_SHA2_512_Lemmas.krml ../secure_api/out/runtime_switch/extracted/Hacl_Impl_SHA2_512.krml ../secure_api/out/runtime_switch/extracted/Spec_SHA2_384.krml ../secure_api/out/runtime_switch/extracted/Hacl_Impl_SHA2_384_Lemmas.krml ../secure_api/out/runtime_switch/extracted/Hacl_Impl_SHA2_384.krml ../secure_api/out/runtime_switch/extracted/Crypto_HMAC.krml ../secure_api/out/runtime_switch/extracted/Crypto_AEAD_Encrypt_Ideal_Invariant.krml ../secure_api/out/runtime_switch/extracted/Crypto_AEAD_MAC_Wrapper_Invariant.krml ../secure_api/out/runtime_switch/extracted/Crypto_AEAD_Enxor_Invariant.krml ../secure_api/out/runtime_switch/extracted/Crypto_AEAD_Encrypt.krml ../secure_api/out/runtime_switch/extracted/Crypto_AEAD.krml ../secure_api/out/runtime_switch/extracted/FStar_List.krml ../secure_api/out/runtime_switch/extracted/FStar_Char.krml ../secure_api/out/runtime_switch/extracted/FStar_String.krml ../secure_api/out/runtime_switch/extracted/C_String.krml ../secure_api/out/runtime_switch/extracted/TestLib.krml ../secure_api/out/runtime_switch/extracted/FStar_Bytes.krml ../secure_api/out/runtime_switch/extracted/Crypto_AEAD_Main.krml ../secure_api/out/runtime_switch/extracted/CryptoTypes.krml ../secure_api/out/runtime_switch/extracted/Crypto_HKDF.krml ../secure_api/out/runtime_switch/extracted/HaclProvider.krml ../secure_api/out/runtime_switch/extracted/KrmlTest.krml ../secure_api/out/runtime_switch/extracted/LowCProvider.krml -add-include '"kremlib.h"' -add-include '"kremlin/internal/compat.h"' \

Warning 6: in the definition of keyBuffer, after the definition of h0, in the last element of the sequence, after the definition of macId, in top-level declaration Crypto.Symmetric.PRF.prf_mac, in file Crypto_AEAD_Main_Crypto_Symmetric_Cipher_Crypto_Indexing: stack newbuf 0uint8 Crypto.Symmetric.UF1CMA.keylen @5 is a non-constant size, stack-allocated array; this is not supported by CompCert and requires the use of alloca(3) for MSVC
[38;5;119m✔[0m [Monomorphization] ⏱️ 63ms
[38;5;119m✔[0m [Inlining] ⏱️ 63ms
[38;5;119m✔[0m [Pattern matches compilation] ⏱️ 63ms
[38;5;119m✔[0m [Simplify 2] ⏱️ 297ms
Warning 14: : Crypto.Symmetric.Bytes.store_uint32 is recursive but cannot be optimized to a tail-call
Warning 14: : Crypto.Symmetric.Bytes.store_big32 is recursive but cannot be optimized to a tail-call
Warning 14: : Crypto.Symmetric.Bytes.store_uint128 is recursive but cannot be optimized to a tail-call
[38;5;119m✔[0m [Structs + Simplify 2] ⏱️ 313ms
[38;5;119m✔[0m [Drop] ⏱️ 16ms
Warning 14: : Crypto.AEAD.Invariant.safelen is not Low*; it uses mathematical integers and runtime checks may fail; rewrite your code to use machine integers, or if you must, use -add-include '"prims_int.h"'; if this declaration is for specification purposes only, consider marking it noextract or using -bundle <name-of-the-module> to only keep reachable definitions.
Warning 14: : Crypto.AEAD.Invariant.maxplain is not Low*; it uses mathematical integers and runtime checks may fail; rewrite your code to use machine integers, or if you must, use -add-include '"prims_int.h"'; if this declaration is for specification purposes only, consider marking it noextract or using -bundle <name-of-the-module> to only keep reachable definitions.
Warning 14: : Prims.pow2 is not Low*; it uses mathematical integers and runtime checks may fail; rewrite your code to use machine integers, or if you must, use -add-include '"prims_int.h"'; if this declaration is for specification purposes only, consider marking it noextract or using -bundle <name-of-the-module> to only keep reachable definitions.
Warning 14: : Prims.op_LessThanOrEqual is not Low*; it uses mathematical integers and runtime checks may fail; rewrite your code to use machine integers, or if you must, use -add-include '"prims_int.h"'; if this declaration is for specification purposes only, consider marking it noextract or using -bundle <name-of-the-module> to only keep reachable definitions.
Warning 14: : Prims.op_Addition is not Low*; it uses mathematical integers and runtime checks may fail; rewrite your code to use machine integers, or if you must, use -add-include '"prims_int.h"'; if this declaration is for specification purposes only, consider marking it noextract or using -bundle <name-of-the-module> to only keep reachable definitions.
[38;5;119m✔[0m [AstToCStar] ⏱️ <1ms
Warning 14: : Prims.op_Multiply is not Low*; it uses mathematical integers and runtime checks may fail; rewrite your code to use machine integers, or if you must, use -add-include '"prims_int.h"'; if this declaration is for specification purposes only, consider marking it noextract or using -bundle <name-of-the-module> to only keep reachable definitions.
[38;5;119m✔[0m [CStarToC] ⏱️ <1ms
[38;5;81m⚙ KreMLin auto-detecting tools.[0m Here's what we found:
[4mreadlink is:[0m readlink
[4mKreMLin called via:[0m C:\build\agent1\_work\13\s\kremlin\_build\src\Kremlin.native
[4mthe Kremlin executable is:[0m C:\build\agent1\_work\13\s\kremlin\_build\src\Kremlin.native
[4mKreMLin home is:[0m C:/build/agent1/_work/13/s/kremlin
[38;5;81m⚙ KreMLin will drive F*.[0m Here's what we found:
read FSTAR_HOME via the environment
[4mfstar converted to windows path:[0m C:/build/agent1/_work/13/s/FStar/bin/fstar.exe
[4mfstar home converted to windows path:[0m C:/build/agent1/_work/13/s/FStar
[4mfstar lib converted to windows path:[0m C:/build/agent1/_work/13/s/FStar/ulib
fstar is on [38;5;202mbranch protz_uint128[0m
[4mfstar is:[0m C:/build/agent1/_work/13/s/FStar/bin/fstar.exe C:/build/agent1/_work/13/s/kremlin/runtime/WasmSupport.fst C:/build/agent1/_work/13/s/FStar/ulib/FStar.UInt128.fst --trace_error --cache_checked_modules --expose_interfaces --include C:/build/agent1/_work/13/s/kremlin/include --include C:/build/agent1/_work/13/s/kremlin/kremlib
[38;5;119m✔[0m [PrettyPrinting] ⏱️ 31ms
KreMLin: wrote out .c files for Crypto_AEAD_Main_Crypto_Symmetric_Cipher_Crypto_Indexing
KreMLin: wrote out .h files for Crypto_AEAD_Main_Crypto_Symmetric_Cipher_Crypto_Indexing
C:/build/agent1/_work/13/s/kremlin/krml -falloca -ftail-calls -bundle 'Crypto_HKDF+Crypto_HMAC=*' -minimal -skip-compilation \
-tmpdir ../secure_api/out/runtime_switch/crypto ../secure_api/out/runtime_switch/extracted/prims.krml ../secure_api/out/runtime_switch/extracted/FStar_Pervasives_Native.krml ../secure_api/out/runtime_switch/extracted/FStar_Pervasives.krml ../secure_api/out/runtime_switch/extracted/FStar_Mul.krml ../secure_api/out/runtime_switch/extracted/FStar_Math_Lib.krml ../secure_api/out/runtime_switch/extracted/FStar_Math_Lemmas.krml ../secure_api/out/runtime_switch/extracted/FStar_Squash.krml ../secure_api/out/runtime_switch/extracted/FStar_StrongExcludedMiddle.krml ../secure_api/out/runtime_switch/extracted/FStar_Classical.krml ../secure_api/out/runtime_switch/extracted/FStar_List_Tot_Base.krml ../secure_api/out/runtime_switch/extracted/FStar_List_Tot_Properties.krml ../secure_api/out/runtime_switch/extracted/FStar_List_Tot.krml ../secure_api/out/runtime_switch/extracted/FStar_Seq_Base.krml ../secure_api/out/runtime_switch/extracted/FStar_Seq_Properties.krml ../secure_api/out/runtime_switch/extracted/FStar_Seq.krml ../secure_api/out/runtime_switch/extracted/FStar_BitVector.krml ../secure_api/out/runtime_switch/extracted/FStar_UInt.krml ../secure_api/out/runtime_switch/extracted/FStar_UInt32.krml ../secure_api/out/runtime_switch/extracted/FStar_Int.krml ../secure_api/out/runtime_switch/extracted/FStar_Int64.krml ../secure_api/out/runtime_switch/extracted/FStar_Int63.krml ../secure_api/out/runtime_switch/extracted/FStar_Int32.krml ../secure_api/out/runtime_switch/extracted/FStar_Int16.krml ../secure_api/out/runtime_switch/extracted/FStar_Int8.krml ../secure_api/out/runtime_switch/extracted/FStar_UInt64.krml ../secure_api/out/runtime_switch/extracted/FStar_UInt63.krml ../secure_api/out/runtime_switch/extracted/FStar_UInt16.krml ../secure_api/out/runtime_switch/extracted/FStar_UInt8.krml ../secure_api/out/runtime_switch/extracted/FStar_Int_Cast.krml ../secure_api/out/runtime_switch/extracted/FStar_UInt128.krml ../secure_api/out/runtime_switch/extracted/Hacl_UInt64.krml ../secure_api/out/runtime_switch/extracted/FStar_Preorder.krml ../secure_api/out/runtime_switch/extracted/FStar_Ghost.krml ../secure_api/out/runtime_switch/extracted/FStar_ErasedLogic.krml ../secure_api/out/runtime_switch/extracted/FStar_FunctionalExtensionality.krml ../secure_api/out/runtime_switch/extracted/FStar_Set.krml ../secure_api/out/runtime_switch/extracted/FStar_PropositionalExtensionality.krml ../secure_api/out/runtime_switch/extracted/FStar_PredicateExtensionality.krml ../secure_api/out/runtime_switch/extracted/FStar_TSet.krml ../secure_api/out/runtime_switch/extracted/FStar_Monotonic_Heap.krml ../secure_api/out/runtime_switch/extracted/FStar_Heap.krml ../secure_api/out/runtime_switch/extracted/FStar_Map.krml ../secure_api/out/runtime_switch/extracted/FStar_Monotonic_HyperHeap.krml ../secure_api/out/runtime_switch/extracted/FStar_Monotonic_HyperStack.krml ../secure_api/out/runtime_switch/extracted/FStar_HyperStack.krml ../secure_api/out/runtime_switch/extracted/FStar_Monotonic_Witnessed.krml ../secure_api/out/runtime_switch/extracted/FStar_HyperStack_ST.krml ../secure_api/out/runtime_switch/extracted/FStar_HyperStack_All.krml ../secure_api/out/runtime_switch/extracted/Hacl_UInt128.krml ../secure_api/out/runtime_switch/extracted/Hacl_UInt8.krml ../secure_api/out/runtime_switch/extracted/Hacl_Bignum_Constants.krml ../secure_api/out/runtime_switch/extracted/Hacl_UInt32.krml ../secure_api/out/runtime_switch/extracted/FStar_Int_Cast_Full.krml ../secure_api/out/runtime_switch/extracted/Hacl_Cast.krml ../secure_api/out/runtime_switch/extracted/FStar_Buffer.krml ../secure_api/out/runtime_switch/extracted/Hacl_Bignum_Parameters.krml ../secure_api/out/runtime_switch/extracted/Hacl_Bignum_Wide.krml ../secure_api/out/runtime_switch/extracted/Spec_Loops.krml ../secure_api/out/runtime_switch/extracted/Hacl_Bignum_Limb.krml ../secure_api/out/runtime_switch/extracted/Hacl_Spec_Bignum_Field.krml ../secure_api/out/runtime_switch/extracted/Hacl_Spec_Bignum_Bigint.krml ../secure_api/out/runtime_switch/extracted/Hacl_Spec_Bignum_Modulo.krml ../secure_api/out/runtime_switch/extracted/Hacl_Spec_Bignum_Fproduct.krml ../secure_api/out/runtime_switch/extracted/Hacl_Spec_Bignum_Fmul.krml ../secure_api/out/runtime_switch/extracted/FStar_Endianness.krml ../secure_api/out/runtime_switch/extracted/Spec_Poly1305_Lemmas.krml ../secure_api/out/runtime_switch/extracted/FStar_Kremlin_Endianness.krml ../secure_api/out/runtime_switch/extracted/C_Endianness.krml ../secure_api/out/runtime_switch/extracted/C.krml ../secure_api/out/runtime_switch/extracted/Hacl_UInt16.krml ../secure_api/out/runtime_switch/extracted/Hacl_Spec_Endianness.krml ../secure_api/out/runtime_switch/extracted/Hacl_Endianness.krml ../secure_api/out/runtime_switch/extracted/Spec_Lib.krml ../secure_api/out/runtime_switch/extracted/Seq_Create.krml ../secure_api/out/runtime_switch/extracted/Spec_SHA2_256.krml ../secure_api/out/runtime_switch/extracted/C_Loops.krml ../secure_api/out/runtime_switch/extracted/Hacl_Hash_Lib_LoadStore.krml ../secure_api/out/runtime_switch/extracted/Hacl_Hash_Lib_Create.krml ../secure_api/out/runtime_switch/extracted/Hacl_Impl_SHA2_256_Lemmas.krml ../secure_api/out/runtime_switch/extracted/Hacl_Impl_SHA2_256.krml ../secure_api/out/runtime_switch/extracted/Hacl_Spec_Bignum_Fsum.krml ../secure_api/out/runtime_switch/extracted/Hacl_Bignum_Fsum.krml ../secure_api/out/runtime_switch/extracted/Crypto_AEAD_BufferUtils.krml ../secure_api/out/runtime_switch/extracted/Vale_AES.krml ../secure_api/out/runtime_switch/extracted/Hacl_Impl_Xor_Lemmas.krml ../secure_api/out/runtime_switch/extracted/Spec_CTR_Lemmas.krml ../secure_api/out/runtime_switch/extracted/Spec_CTR.krml ../secure_api/out/runtime_switch/extracted/Hacl_Lib_LoadStore32.krml ../secure_api/out/runtime_switch/extracted/Spec_Chacha20_Lemmas.krml ../secure_api/out/runtime_switch/extracted/Spec_Chacha20.krml ../secure_api/out/runtime_switch/extracted/Hacl_Impl_Chacha20.krml ../secure_api/out/runtime_switch/extracted/Hacl_SecureAPI_Chacha20.krml ../secure_api/out/runtime_switch/extracted/Crypto_Indexing.krml ../secure_api/out/runtime_switch/extracted/Flag.krml ../secure_api/out/runtime_switch/extracted/Crypto_Symmetric_AES.krml ../secure_api/out/runtime_switch/extracted/Crypto_Symmetric_AES128.krml ../secure_api/out/runtime_switch/extracted/FStar_Float.krml ../secure_api/out/runtime_switch/extracted/FStar_Exn.krml ../secure_api/out/runtime_switch/extracted/FStar_ST.krml ../secure_api/out/runtime_switch/extracted/FStar_All.krml ../secure_api/out/runtime_switch/extracted/FStar_IO.krml ../secure_api/out/runtime_switch/extracted/Buffer_Utils.krml ../secure_api/out/runtime_switch/extracted/Crypto_Symmetric_Bytes.krml ../secure_api/out/runtime_switch/extracted/Crypto_Symmetric_Cipher.krml ../secure_api/out/runtime_switch/extracted/C_Nullity.krml ../secure_api/out/runtime_switch/extracted/Hacl_Spec_Bignum_AddAndMultiply.krml ../secure_api/out/runtime_switch/extracted/Spec_Poly1305.krml ../secure_api/out/runtime_switch/extracted/Hacl_Bignum_Modulo.krml ../secure_api/out/runtime_switch/extracted/Hacl_Bignum_Fproduct.krml ../secure_api/out/runtime_switch/extracted/Hacl_Spec_Poly1305_64_State.krml ../secure_api/out/runtime_switch/extracted/Hacl_Spec_Poly1305_64.krml ../secure_api/out/runtime_switch/extracted/Hacl_Impl_Poly1305_64_State.krml ../secure_api/out/runtime_switch/extracted/Hacl_Bignum_Fmul.krml ../secure_api/out/runtime_switch/extracted/Hacl_Bignum_AddAndMultiply.krml ../secure_api/out/runtime_switch/extracted/Hacl_Spe_Poly1305_64.krml ../secure_api/out/runtime_switch/extracted/Hacl_Impl_Poly1305_64.krml ../secure_api/out/runtime_switch/extracted/Spec_GaloisField.krml ../secure_api/out/runtime_switch/extracted/Spec_GF128.krml ../secure_api/out/runtime_switch/extracted/Crypto_Symmetric_GF128.krml ../secure_api/out/runtime_switch/extracted/Crypto_Symmetric_MAC.krml ../secure_api/out/runtime_switch/extracted/Crypto_Symmetric_UF1CMA.krml ../secure_api/out/runtime_switch/extracted/Crypto_Plain.krml ../secure_api/out/runtime_switch/extracted/Crypto_Symmetric_PRF.krml ../secure_api/out/runtime_switch/extracted/Crypto_AEAD_Encoding.krml ../secure_api/out/runtime_switch/extracted/Crypto_AEAD_Invariant.krml ../secure_api/out/runtime_switch/extracted/Crypto_AEAD_Encrypt_Invariant.krml ../secure_api/out/runtime_switch/extracted/Crypto_AEAD_Wrappers_PRF.krml ../secure_api/out/runtime_switch/extracted/Crypto_AEAD_Wrappers_Encoding.krml ../secure_api/out/runtime_switch/extracted/Crypto_AEAD_Wrappers_CMA.krml ../secure_api/out/runtime_switch/extracted/Crypto_AEAD_EnxorDexor.krml ../secure_api/out/runtime_switch/extracted/Crypto_AEAD_Decrypt.krml ../secure_api/out/runtime_switch/extracted/Spec_HMAC_SHA2_256.krml ../secure_api/out/runtime_switch/extracted/Spec_SHA2_512.krml ../secure_api/out/runtime_switch/extracted/Hacl_Impl_SHA2_512_Lemmas.krml ../secure_api/out/runtime_switch/extracted/Hacl_Impl_SHA2_512.krml ../secure_api/out/runtime_switch/extracted/Spec_SHA2_384.krml ../secure_api/out/runtime_switch/extracted/Hacl_Impl_SHA2_384_Lemmas.krml ../secure_api/out/runtime_switch/extracted/Hacl_Impl_SHA2_384.krml ../secure_api/out/runtime_switch/extracted/Crypto_HMAC.krml ../secure_api/out/runtime_switch/extracted/Crypto_AEAD_Encrypt_Ideal_Invariant.krml ../secure_api/out/runtime_switch/extracted/Crypto_AEAD_MAC_Wrapper_Invariant.krml ../secure_api/out/runtime_switch/extracted/Crypto_AEAD_Enxor_Invariant.krml ../secure_api/out/runtime_switch/extracted/Crypto_AEAD_Encrypt.krml ../secure_api/out/runtime_switch/extracted/Crypto_AEAD.krml ../secure_api/out/runtime_switch/extracted/FStar_List.krml ../secure_api/out/runtime_switch/extracted/FStar_Char.krml ../secure_api/out/runtime_switch/extracted/FStar_String.krml ../secure_api/out/runtime_switch/extracted/C_String.krml ../secure_api/out/runtime_switch/extracted/TestLib.krml ../secure_api/out/runtime_switch/extracted/FStar_Bytes.krml ../secure_api/out/runtime_switch/extracted/Crypto_AEAD_Main.krml ../secure_api/out/runtime_switch/extracted/CryptoTypes.krml ../secure_api/out/runtime_switch/extracted/Crypto_HKDF.krml ../secure_api/out/runtime_switch/extracted/HaclProvider.krml ../secure_api/out/runtime_switch/extracted/KrmlTest.krml ../secure_api/out/runtime_switch/extracted/LowCProvider.krml -add-include '"kremlib.h"' -add-include '"kremlin/internal/compat.h"' \

Warning 6: in the definition of state, after the definition of pos_T, in the last element of the sequence, in top-level declaration Crypto.HKDF.hkdf_expand, in file Crypto_HKDF_Crypto_HMAC: stack newbuf 0uint8 (+,uint32) (+,uint32) @7 @3 @4 is a non-constant size, stack-allocated array; this is not supported by CompCert and requires the use of alloca(3) for MSVC
Warning 6: in the definition of state0, after the definition of h0, in the last element of the sequence, in top-level declaration Crypto.HMAC.hmac_part1, in file Crypto_HKDF_Crypto_HMAC: stack newbuf 0uint32 match @4 with | λ .  SHA256 () ->  137uint32 | λ .  SHA384 () ->  338uint32 | λ .  SHA512 () ->  338uint32 is a non-constant size, stack-allocated array; this is not supported by CompCert and requires the use of alloca(3) for MSVC
Warning 6: in the definition of state1, after the definition of h0, in the last element of the sequence, after the definition of hinit, in top-level declaration Crypto.HMAC.hmac_part2, in file Crypto_HKDF_Crypto_HMAC: stack newbuf 0uint32 match @5 with | λ .  SHA256 () ->  137uint32 | λ .  SHA384 () ->  338uint32 | λ .  SHA512 () ->  338uint32 is a non-constant size, stack-allocated array; this is not supported by CompCert and requires the use of alloca(3) for MSVC
Warning 6: in the definition of ipad, after the definition of h0, in the last element of the sequence, after the definition of h00, in top-level declaration Crypto.HMAC.hmac_core, in file Crypto_HKDF_Crypto_HMAC: stack newbuf 0x36uint8 Crypto.HMAC.block_size @6 is a non-constant size, stack-allocated array; this is not supported by CompCert and requires the use of alloca(3) for MSVC
Warning 6: in the definition of opad, after the definition of ipad, in the last element of the sequence, after the definition of h00, in top-level declaration Crypto.HMAC.hmac_core, in file Crypto_HKDF_Crypto_HMAC: stack newbuf 0x5cuint8 Crypto.HMAC.block_size @7 is a non-constant size, stack-allocated array; this is not supported by CompCert and requires the use of alloca(3) for MSVC
Warning 6: in the definition of nkey, in the last element of the sequence, in top-level declaration Crypto.HMAC.hmac, in file Crypto_HKDF_Crypto_HMAC: stack newbuf 0x00uint8 Crypto.HMAC.block_size @5 is a non-constant size, stack-allocated array; this is not supported by CompCert and requires the use of alloca(3) for MSVC
[38;5;119m✔[0m [Monomorphization] ⏱️ 78ms
[38;5;119m✔[0m [Inlining] ⏱️ 47ms
[38;5;119m✔[0m [Pattern matches compilation] ⏱️ 16ms
[38;5;119m✔[0m [Simplify 2] ⏱️ 63ms
Warning 14: : Crypto.HKDF.hkdf_expand_inner is recursive but cannot be optimized to a tail-call
[38;5;119m✔[0m [Structs + Simplify 2] ⏱️ 94ms
[38;5;119m✔[0m [Drop] ⏱️ <1ms
[38;5;119m✔[0m [AstToCStar] ⏱️ 16ms
[38;5;119m✔[0m [CStarToC] ⏱️ <1ms
[38;5;81m⚙ KreMLin auto-detecting tools.[0m Here's what we found:
[4mreadlink is:[0m readlink
[4mKreMLin called via:[0m C:\build\agent1\_work\13\s\kremlin\_build\src\Kremlin.native
[4mthe Kremlin executable is:[0m C:\build\agent1\_work\13\s\kremlin\_build\src\Kremlin.native
[4mKreMLin home is:[0m C:/build/agent1/_work/13/s/kremlin
[38;5;81m⚙ KreMLin will drive F*.[0m Here's what we found:
read FSTAR_HOME via the environment
[4mfstar converted to windows path:[0m C:/build/agent1/_work/13/s/FStar/bin/fstar.exe
[4mfstar home converted to windows path:[0m C:/build/agent1/_work/13/s/FStar
[4mfstar lib converted to windows path:[0m C:/build/agent1/_work/13/s/FStar/ulib
fstar is on [38;5;202mbranch protz_uint128[0m
[4mfstar is:[0m C:/build/agent1/_work/13/s/FStar/bin/fstar.exe C:/build/agent1/_work/13/s/kremlin/runtime/WasmSupport.fst C:/build/agent1/_work/13/s/FStar/ulib/FStar.UInt128.fst --trace_error --cache_checked_modules --expose_interfaces --include C:/build/agent1/_work/13/s/kremlin/include --include C:/build/agent1/_work/13/s/kremlin/kremlib
[38;5;119m✔[0m [PrettyPrinting] ⏱️ <1ms
KreMLin: wrote out .c files for Crypto_HKDF_Crypto_HMAC
KreMLin: wrote out .h files for Crypto_HKDF_Crypto_HMAC
OCAMLPATH="C:/build/agent1/_work/13/s/FStar/bin" ocamlfind opt -package fstarlib,zarith -g -I C:/build/agent1/_work/13/s/FStar/ulib/ml -c LowCProvider/lowc_stub.c -I LowCProvider/ -I ../secure_api/out/runtime_switch -I C:/build/agent1/_work/13/s/kremlin/include -I C:/build/agent1/_work/13/s/MLCrypto \
-I ../../mitls-fstar/libs/ffi -ccopt "-o LowCProvider/lowc_stub.o" -I ../code/salsa-family/chacha-c -I ../code/poly1305/poly-c \
-I ../code/curve25519/x25519-c -I ../secure_api/out/runtime_switch/crypto -I ../code/api/aead-c \
-ccopt -Wall -ccopt -Wextra -ccopt -I -ccopt C:/build/agent1/_work/13/s/kremlin/include -ccopt -Wno-unused-variable -ccopt -Wno-unused-parameter -ccopt -Wno-unused-but-set-variable -ccopt -Wno-parentheses -ccopt -Werror -ccopt -Wno-unknown-warning-option
OCAMLPATH="C:/build/agent1/_work/13/s/FStar/bin" ocamlfind opt -package fstarlib,zarith -g -I C:/build/agent1/_work/13/s/FStar/ulib/ml -c ../secure_api/out/runtime_switch/crypto/Crypto_AEAD_Main_Crypto_Symmetric_Cipher_Crypto_Indexing.c -I ../secure_api/out/runtime_switch/crypto/ -I ../secure_api/out/runtime_switch -I C:/build/agent1/_work/13/s/kremlin/include -I C:/build/agent1/_work/13/s/MLCrypto \
-I ../../mitls-fstar/libs/ffi -ccopt "-o ../secure_api/out/runtime_switch/crypto/Crypto_AEAD_Main_Crypto_Symmetric_Cipher_Crypto_Indexing.o" -I ../code/salsa-family/chacha-c -I ../code/poly1305/poly-c \
-I ../code/curve25519/x25519-c -I ../secure_api/out/runtime_switch/crypto -I ../code/api/aead-c \
-ccopt -Wall -ccopt -Wextra -ccopt -I -ccopt C:/build/agent1/_work/13/s/kremlin/include -ccopt -Wno-unused-variable -ccopt -Wno-unused-parameter -ccopt -Wno-unused-but-set-variable -ccopt -Wno-parentheses -ccopt -Werror -ccopt -Wno-unknown-warning-option
OCAMLPATH="C:/build/agent1/_work/13/s/FStar/bin" ocamlfind opt -package fstarlib,zarith -g -I C:/build/agent1/_work/13/s/FStar/ulib/ml -c ../secure_api/out/runtime_switch/crypto/Crypto_HKDF_Crypto_HMAC.c -I ../secure_api/out/runtime_switch/crypto/ -I ../secure_api/out/runtime_switch -I C:/build/agent1/_work/13/s/kremlin/include -I C:/build/agent1/_work/13/s/MLCrypto \
-I ../../mitls-fstar/libs/ffi -ccopt "-o ../secure_api/out/runtime_switch/crypto/Crypto_HKDF_Crypto_HMAC.o" -I ../code/salsa-family/chacha-c -I ../code/poly1305/poly-c \
-I ../code/curve25519/x25519-c -I ../secure_api/out/runtime_switch/crypto -I ../code/api/aead-c \
-ccopt -Wall -ccopt -Wextra -ccopt -I -ccopt C:/build/agent1/_work/13/s/kremlin/include -ccopt -Wno-unused-variable -ccopt -Wno-unused-parameter -ccopt -Wno-unused-but-set-variable -ccopt -Wno-parentheses -ccopt -Werror -ccopt -Wno-unknown-warning-option
OCAMLPATH="C:/build/agent1/_work/13/s/FStar/bin" ocamlfind opt -package fstarlib,zarith -g -I C:/build/agent1/_work/13/s/FStar/ulib/ml -c ../secure_api/out/runtime_switch/crypto/Crypto_Symmetric_Bytes.c -I ../secure_api/out/runtime_switch/crypto/ -I ../secure_api/out/runtime_switch -I C:/build/agent1/_work/13/s/kremlin/include -I C:/build/agent1/_work/13/s/MLCrypto \
-I ../../mitls-fstar/libs/ffi -ccopt "-o ../secure_api/out/runtime_switch/crypto/Crypto_Symmetric_Bytes.o" -I ../code/salsa-family/chacha-c -I ../code/poly1305/poly-c \
-I ../code/curve25519/x25519-c -I ../secure_api/out/runtime_switch/crypto -I ../code/api/aead-c \
-ccopt -Wall -ccopt -Wextra -ccopt -I -ccopt C:/build/agent1/_work/13/s/kremlin/include -ccopt -Wno-unused-variable -ccopt -Wno-unused-parameter -ccopt -Wno-unused-but-set-variable -ccopt -Wno-parentheses -ccopt -Werror -ccopt -Wno-unknown-warning-option
OCAMLPATH="C:/build/agent1/_work/13/s/FStar/bin" ocamlfind mklib -g -I C:/build/agent1/_work/13/s/FStar/ulib/ml -I ../secure_api/out/runtime_switch/extracted vale/asm/sha256_main_i.o vale/asm/sha256-x86_64.o vale/asm/Vale_Hash_SHA2_256.o vale/asm/vale_aes_glue.o vale/asm/aes-x86_64.o LowCProvider/LowCProvider.cmx LowCProvider/HaclProvider.cmx LowCProvider/lowc_stub.o ../secure_api/out/runtime_switch/crypto/Crypto_AEAD_Main_Crypto_Symmetric_Cipher_Crypto_Indexing.o ../secure_api/out/runtime_switch/crypto/Crypto_HKDF_Crypto_HMAC.o ../code/salsa-family/chacha-c/Hacl_Chacha20.o ../code/poly1305/poly-c/AEAD_Poly1305_64.o ../code/api/policies-c/Hacl_Policies.o ../code/api/aead-c/Hacl_Chacha20Poly1305.o ../secure_api/out/runtime_switch/crypto/Crypto_Symmetric_Bytes.o ../code/curve25519/x25519-c/Hacl_Curve25519.o -o ../secure_api/out/runtime_switch/LowC
OCAMLPATH="C:/build/agent1/_work/13/s/FStar/bin" ocamlfind opt -package fstarlib,zarith -g -I C:/build/agent1/_work/13/s/FStar/ulib/ml -c LowCProvider/Tests.ml -I LowCProvider -I ../secure_api/out/runtime_switch -I ../secure_api/out/runtime_switch/extracted -I C:/build/agent1/_work/13/s/MLCrypto -o LowCProvider/Tests.cmx
OCAMLPATH="C:/build/agent1/_work/13/s/FStar/bin" ocamlfind opt -package fstarlib,zarith -g -I C:/build/agent1/_work/13/s/FStar/ulib/ml -I ../secure_api/out/runtime_switch/extracted -I LowCProvider \
-ccopt -L../secure_api/out/runtime_switch -cclib C:/build/agent1/_work/13/s/kremlin/kremlib/out/libkremlib.a -linkpkg C:/build/agent1/_work/13/s/MLCrypto/CryptoTypes.cmx ../secure_api/out/runtime_switch/LowC.cmxa LowCProvider/Tests.cmx -o ../secure_api/out/runtime_switch/LowCTests.exe
./../secure_api/out/runtime_switch/LowCTests.exe
Tests started
Test 1 OK

Test 2 OK

Test 3 OK

Test 4 OK

Test 5 OK

Test 6 OK

Output cipher:	ed3dc05f9d4877f5db78c69c3a8a3d8e8602646a0b2febe4fca07a426a9ace4163cb26eddbb5b0d5f56d7038512ac73d667397d129c3044e0eb8052e
Output tag:	e6f0c7f7b8920ba02a3942df2b8b2a04
cipher:		AES-128-GCM
key:		"feffe9928665731c6d6a8f9467308308"
iv:		"cafebabefacedbad"
aad:		"feedfacedeadbeeffeedfacedeadbeefabaddad2"
tag:		"3612d2e79e3b0785561be14aaca2fccb"
plaintext:	"d9313225f88406e5a55909c5aff5269a86a7a9531534f7da2e4c303d8a318a721c3c0c95956809532fcf0e2449a6b525b16aedf5aa0de657ba637b39"
ciphertext:	"61353b4c2806934a777ff51fa22a4755699b2a714fcdc6f83766e5f97b6c742373806900e49f24b22b097544d4896b424989b5e1ebac0f07c23f4598"

Test 7 failed, but this is expected because |IV| <> 12 bytes and we don't do IV expansion.
Please disregard.

Output cipher:	8076eba01a51d7702d398c6dc3adaaadfe061c23a7ffc3c4623ea2be7a08d982b8f331d21ac6b8db541df43510561a3fff90b942215b7fb6fbcea43d
Output tag:	1606863da7ad74443b3a89fd2489363d
cipher:		AES-128-GCM
key:		"feffe9928665731c6d6a8f9467308308"
iv:		"9313225df88406e555909c5aff5269aa6a7a9538534f7da1e4c303d2a318a728c3c0c95156809539fcf0e2429a6b525416aedbf5a0de6a57a637b39b"
aad:		"feedfacedeadbeeffeedfacedeadbeefabaddad2"
tag:		"619cc5aefffe0bfa462af43c1699d050"
plaintext:	"d9313225f88406e5a55909c5aff5269a86a7a9531534f7da2e4c303d8a318a721c3c0c95956809532fcf0e2449a6b525b16aedf5aa0de657ba637b39"
ciphertext:	"8ce24998625615b603a033aca13fb894be9112a5c3a211a8ba262a3cca7e2ca701e4a9a4fba43c90ccdcb281d48c7c6fd62875d2aca417034c34aee5"

Test 8 failed, but this is expected because |IV| <> 12 bytes and we don't do IV expansion.
Please disregard.

Test 9 OK

Test 10 OK

Test 11 OK

Test 12 OK

Output cipher:	677a374b4dd797f8ea0252a721fa83784f68c4877cf4e60f8c1f56972e9c20f789efb32096dd6336c6e5ef833b041251fdf04ce41fbcf2fea0d1e83c
Output tag:	91b8ee617f7c50dab5bc75abff3bc1c3
cipher:		AES-256-GCM
key:		"feffe9928665731c6d6a8f9467308308feffe9928665731c6d6a8f9467308308"
iv:		"cafebabefacedbad"
aad:		"feedfacedeadbeeffeedfacedeadbeefabaddad2"
tag:		"3a337dbf46a792c45e454913fe2ea8f2"
plaintext:	"d9313225f88406e5a55909c5aff5269a86a7a9531534f7da2e4c303d8a318a721c3c0c95956809532fcf0e2449a6b525b16aedf5aa0de657ba637b39"
ciphertext:	"c3762df1ca787d32ae47c13bf19844cbaf1ae14d0b976afac52ff7d79bba9de0feb582d33934a4f0954cc2363bc73f7862ac430e64abe499f47c9b1f"

Test 13 failed, but this is expected because |IV| <> 12 bytes and we don't do IV expansion.
Please disregard.

Output cipher:	cf3b9ab7a70a2ac55a7bcf74cda369c5b32e7870a937cb4d7679ef877de6403b7126c8ca2d6c620755e8ff330af0e7fa003585282b2d7a3d8f785bcc
Output tag:	881390e147e8fc6b2923305b6413a594
cipher:		AES-256-GCM
key:		"feffe9928665731c6d6a8f9467308308feffe9928665731c6d6a8f9467308308"
iv:		"9313225df88406e555909c5aff5269aa6a7a9538534f7da1e4c303d2a318a728c3c0c95156809539fcf0e2429a6b525416aedbf5a0de6a57a637b39b"
aad:		"feedfacedeadbeeffeedfacedeadbeefabaddad2"
tag:		"a44a8266ee1c8eb0c8b5d4cf5ae9f19a"
plaintext:	"d9313225f88406e5a55909c5aff5269a86a7a9531534f7da2e4c303d8a318a721c3c0c95956809532fcf0e2449a6b525b16aedf5aa0de657ba637b39"
ciphertext:	"5a8def2f0c9e53f1f75d7853659e2a20eeb2b22aafde6419a058ab4f6f746bf40fc0c3b780f244452da3ebf1c5d82cdea2418997200ef82e44ae7e3f"

Test 14 failed, but this is expected because |IV| <> 12 bytes and we don't do IV expansion.
Please disregard.

Test 15 OK

Test 16 OK

Test 17 OK

Test 18 OK

Output cipher:	eff01b40f151144abb70955cedcbe564afd7d338ce2c3eb2ac13b1228ef785edc5bf4b7501cdc522a855c4e5843a3a0af67e4c8285f641951d9dcb727fb5d53bffe8165999884aa1626b20328a233f189b48820f19d2cf1551f21d0ae749227f1d47344d687533456994f11584dfd15d4791ceedf45f3774821bcd340d4b18ec8ed70e7ce40859ec159363caab3eaa87261cbda3733c01bbd39f03f21d3c4f1b3af2cadd75c67fbe96929c20a13077991908a0d23adbcecd49ed2ed71dd8f659
Output tag:	1f200ef9ef5218a0a69331c8304f873d
cipher:		AES-128-GCM
key:		"00000000000000000000000000000000"
iv:		"ffffffff000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000"
aad:		""
tag:		"566f8ef683078bfdeeffa869d751a017"
plaintext:	"000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000"
ciphertext:	"56b3373ca9ef6e4a2b64fe1e9a17b61425f10d47a75a5fce13efc6bc784af24f4141bdd48cf7c770887afd573cca5418a9aeffcd7c5ceddfc6a78397b9a85b499da558257267caab2ad0b23ca476a53cb17fb41c4b8b475cb4f3f7165094c229c9e8c4dc0a2a5ff1903e501511221376a1cdb8364c5061a20cae74bc4acd76ceb0abc9fd3217ef9f8c90be402ddf6d8697f4f880dff15bfb7a6b28241ec8fe183c2d59e3f9dfff653c7126f0acb9e64211f42bae12af462b1070bef1ab5e3606"

Test 19 failed, but this is expected because |IV| <> 12 bytes and we don't do IV expansion.
Please disregard.

Output cipher:	eff01b40f151144abb70955cedcbe564afd7d338ce2c3eb2ac13b1228ef785edc5bf4b7501cdc522a855c4e5843a3a0af67e4c8285f641951d9dcb727fb5d53bffe8165999884aa1626b20328a233f189b48820f19d2cf1551f21d0ae749227f1d47344d687533456994f11584dfd15d4791ceedf45f3774821bcd340d4b18ec8ed70e7ce40859ec159363caab3eaa87261cbda3733c01bbd39f03f21d3c4f1b3af2cadd75c67fbe96929c20a13077991908a0d23adbcecd49ed2ed71dd8f65954f4ff316fe216dd9e29b1ea55824efb884af85d0e6743d586acfc3088f200284dcb744dcf6fe40745827d98067e32af9b279d8f8354d7e47b8bb6736de3b66479f0d1ee5cb7796d966955cc6dea4ae5e4205b07040a0d9ec6594c2c6d2350a4
Output tag:	99b156f6881899ee456476976e9f5414
cipher:		AES-128-GCM
key:		"00000000000000000000000000000000"
iv:		"ffffffff000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000"
aad:		""
tag:		"8b307f6b33286d0ab026a9ed3fe1e85f"
plaintext:	"000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000"
ciphertext:	"56b3373ca9ef6e4a2b64fe1e9a17b61425f10d47a75a5fce13efc6bc784af24f4141bdd48cf7c770887afd573cca5418a9aeffcd7c5ceddfc6a78397b9a85b499da558257267caab2ad0b23ca476a53cb17fb41c4b8b475cb4f3f7165094c229c9e8c4dc0a2a5ff1903e501511221376a1cdb8364c5061a20cae74bc4acd76ceb0abc9fd3217ef9f8c90be402ddf6d8697f4f880dff15bfb7a6b28241ec8fe183c2d59e3f9dfff653c7126f0acb9e64211f42bae12af462b1070bef1ab5e3606872ca10dee15b3249b1a1b958f23134c4bccb7d03200bce420a2f8eb66dcf3644d1423c1b5699003c13ecef4bf38a3b60eedc34033bac1902783dc6d89e2e774188a439c7ebcc0672dbda4ddcfb2794613b0be41315ef778708a70ee7d75165c"

Test 20 failed, but this is expected because |IV| <> 12 bytes and we don't do IV expansion.
Please disregard.

Test 21 OK

AEAD: 21/21 tests passed
OCAMLPATH="C:/build/agent1/_work/13/s/FStar/bin" ocamlfind opt -package fstarlib,zarith -g -I C:/build/agent1/_work/13/s/FStar/ulib/ml -c QuicProvider/test.c -I QuicProvider/ -I ../secure_api/out/runtime_switch -I C:/build/agent1/_work/13/s/kremlin/include -I C:/build/agent1/_work/13/s/MLCrypto \
-I ../../mitls-fstar/libs/ffi -ccopt "-o QuicProvider/test.o" -I ../code/salsa-family/chacha-c -I ../code/poly1305/poly-c \
-I ../code/curve25519/x25519-c -I ../secure_api/out/runtime_switch/crypto -I ../code/api/aead-c \
-ccopt -Wall -ccopt -Wextra -ccopt -I -ccopt C:/build/agent1/_work/13/s/kremlin/include -ccopt -Wno-unused-variable -ccopt -Wno-unused-parameter -ccopt -Wno-unused-but-set-variable -ccopt -Wno-parentheses -ccopt -Werror -ccopt -Wno-unknown-warning-option
OCAMLPATH="C:/build/agent1/_work/13/s/FStar/bin" ocamlfind opt -package fstarlib,zarith -g -I C:/build/agent1/_work/13/s/FStar/ulib/ml -c QuicProvider/quic_provider.c -I QuicProvider/ -I ../secure_api/out/runtime_switch -I C:/build/agent1/_work/13/s/kremlin/include -I C:/build/agent1/_work/13/s/MLCrypto \
-I ../../mitls-fstar/libs/ffi -ccopt "-o QuicProvider/quic_provider.o" -I ../code/salsa-family/chacha-c -I ../code/poly1305/poly-c \
-I ../code/curve25519/x25519-c -I ../secure_api/out/runtime_switch/crypto -I ../code/api/aead-c \
-ccopt -Wall -ccopt -Wextra -ccopt -I -ccopt C:/build/agent1/_work/13/s/kremlin/include -ccopt -Wno-unused-variable -ccopt -Wno-unused-parameter -ccopt -Wno-unused-but-set-variable -ccopt -Wno-parentheses -ccopt -Werror -ccopt -Wno-unknown-warning-option
x86_64-w64-mingw32-gcc vale/asm/sha256_main_i.o vale/asm/sha256-x86_64.o vale/asm/Vale_Hash_SHA2_256.o vale/asm/vale_aes_glue.o vale/asm/aes-x86_64.o QuicProvider/quic_provider.o ../secure_api/out/runtime_switch/crypto/Crypto_AEAD_Main_Crypto_Symmetric_Cipher_Crypto_Indexing.o ../secure_api/out/runtime_switch/crypto/Crypto_Symmetric_Bytes.o ../secure_api/out/runtime_switch/crypto/Crypto_HKDF_Crypto_HMAC.o ../code/salsa-family/chacha-c/Hacl_Chacha20.o ../code/poly1305/poly-c/AEAD_Poly1305_64.o ../code/api/policies-c/Hacl_Policies.o ../code/api/aead-c/Hacl_Chacha20Poly1305.o C:/build/agent1/_work/13/s/kremlin/kremlib/out/libkremlib.a -o ../secure_api/out/runtime_switch/libquicprovider.dll  -shared
x86_64-w64-mingw32-gcc QuicProvider/test.o -o ../secure_api/out/runtime_switch/quicprovider-test.exe -L../secure_api/out/runtime_switch -lquicprovider C:/build/agent1/_work/13/s/kremlin/kremlib/out/libkremlib.a
./../secure_api/out/runtime_switch/quicprovider-test.exe
==== coverage ====
SHA256('') =
e3b0c44298fc1c149afbf4c8996fb92427ae41e4649b934ca495991b7852b855

SHA384('') = 
38b060a751ac96384cd9327eb1b1e36a21fdb71114be07434c0cc7bf63f6e1da
274edebfe76f65fbd51ad2f14898b95b

SHA512('') = 
cf83e1357eefb8bdf1542850d66d8007d620e4050b5715dc83f4a921d36ce9ce
47d0d13c5d85f2b0ff8318d2877eec2f63b931bd47417a81a538327af927da3e
+ cd mitls-fstar/src/tls

HMAC-SHA256('Jefe', 'what do ya want for nothing?') = 
+ make -j 16 test
5bdcc146bf60754e6a042426089575c75a003f089d2739839dec58b964ec3843

HMAC-SHA384('Jefe', 'what do ya want for nothing?') = 
af45d2e376484031617f78d2b58a6b1b9c7ef464f5a01b47e42ec3736322445e
8e2240ca5e69e2c78b3239ecfab21649

HMAC-SHA512('Jefe', 'what do ya want for nothing?') = 
164b7a7bfcf819e2e395fbe73b56e0a387bd64222e831fd610270cd7ea250554
9758bf75c05a994a6d034f65f8f0e6fdcaeab1a34d4a6b4b636e070a38bce737

prk = HKDF-EXTRACT-SHA256('0x000102030405060708090a0b0c', '0x0b0b0b0b0b0b0b0b0b0b0b0b0b0b0b0b0b0b0b0b0b0b')
077709362c2e32df0ddc3f0dc47bba6390b6c73bb50f9c3122ec844ad7c2b3e5
077709362c2e32df0ddc3f0dc47bba6390b6c73bb50f9c3122ec844ad7c2b3e5

okm = HKDF-EXPAND-SHA256(prk, '0xf0f1f2f3f4f5f6f7f8f9', 42)
3cb25f25faacd57a90434f64d0362f2a2d2d0a90cf1a5a4c5db02d56ecc4c5bf
34007208d5b887185865

AES-128-GCM encrypt test:
5936f46d6c7eb7008dbbfb0d40b491fce5328aedcbc0c5272457d347363fd36d
f238bd17971e982f4449350d
PN encryption mask:
a52e332b
DECRYPT SUCCESS: 
7768617420646f2079612077616e7420666f72206e6f7468696e673f

CHACHA20-POLY1305 encrypt test:
a62fe99f3d6001a4f4214a986f04b1f42ea1e5dcea3236ecf35adb5d8cc57db2
df5e18b278c8c904fcddf440
PN encryption mask:
308ac6f5
DECRYPT SUCCESS: 
7768617420646f2079612077616e7420666f72206e6f7468696e673f
==== PASS:  coverage ====


==== test_crypto(TLS_hash_SHA256,TLS_aead_AES_128_GCM) ====
PASS
==== test_crypto(TLS_hash_SHA384,TLS_aead_AES_128_GCM) ====
PASS
==== test_crypto(TLS_hash_SHA512,TLS_aead_AES_128_GCM) ====
PASS
==== test_crypto(TLS_hash_SHA256,TLS_aead_AES_256_GCM) ====
PASS
==== test_crypto(TLS_hash_SHA384,TLS_aead_AES_256_GCM) ====
PASS
==== test_crypto(TLS_hash_SHA512,TLS_aead_AES_256_GCM) ====
PASS
==== test_crypto(TLS_hash_SHA256,TLS_aead_CHACHA20_POLY1305) ====
PASS
==== test_crypto(TLS_hash_SHA384,TLS_aead_CHACHA20_POLY1305) ====
PASS
==== test_crypto(TLS_hash_SHA512,TLS_aead_CHACHA20_POLY1305) ====
PASS
==== test_pn_encrypt() ====
PN encryption mask: fbb4b174
Decrypted PN: c0000000
==== test_handshake_secrets() ====
==== PASS: test_handshake_secrets ==== 
==== ALL TESTS PASS ====
make: Leaving directory '/cygdrive/c/build/agent1/_work/13/s/hacl-star/secure_api'
rm -f cache/OCaml/.depend cache/Kremlin/.depend cache/Model/.depend
make -f Makefile.Model test
make -f Makefile.Kremlin test
make -f Makefile.OCaml test
make -C ../../apps/quicMinusNet test -k
make[1]: Entering directory '/cygdrive/c/build/agent1/_work/13/s/mitls-fstar/apps/quicMinusNet'
quic.c:1:0: warning: -fPIC ignored for target (all code is position independent)
x86_64-w64-mingw32-gcc.exe -fPIC -I../../src/tls/extract/Kremlin-Library/include \
-I../../src/tls/extract/Kremlin-Library/stub -I../../src/pki \
#define __USE_MINGW_ANSI_STDIO 1
-I../../libs/ffi -I/cygdrive/c/build/agent1/_work/13/s/hacl-star/secure_api/QuicProvider \
quic.c \
^
-L/cygdrive/c/build/agent1/_work/13/s/hacl-star/providers/out -L../../src/pki -L../../src/tls/extract/Kremlin-Library -L/cygdrive/c/build/agent1/_work/13/s/hacl-star/secure_api/out/runtime_switch -L/cygdrive/c/build/agent1/_work/13/s/MLCrypto/openssl \
-lmitls -lquicprovider -lmipki -lbcrypt -o quic.exe
make[1]: Leaving directory '/cygdrive/c/build/agent1/_work/13/s/mitls-fstar/apps/quicMinusNet'
make[1]: Entering directory '/cygdrive/c/build/agent1/_work/13/s/mitls-fstar/apps/quicMinusNet'
./quic.exe
server create
FFI| offering custom extension 001a
FFI| extension contents: ffff00050a0b0c0d0e
FFI| setting early data limit to ffffffff
FFI| Setting a new ticket callback.
FFI| Setting a new server negotiation callback.
FFI| Setting up certificate callbacks.
client create
FFI| offering custom extension 001a
FFI| extension contents: ffff00050a0b0c0d0e
FFI| setting early data limit to ffffffff
FFI| Setting a new ticket callback.
FFI| Setting a new server negotiation callback.
FFI| Setting up certificate callbacks.
client call clen=8192 slen=   0
TLS| writeHandshake (plaintext)
TLS| HS.next_fragment PlaintextID?
HS | next_fragment
HS | offering ClientHello 1.3
KS | ks_client_init 1.3
CDH| Keygen (initiator) on X255519
NGO| No PSK or 0-RTT disabled
NGO| offering client extensions [ 001a supported_versions key_share server_name alpn extended_master_secret signature_algorithms supported_groups psk_key_exchange_modes ]
NGO| offering cipher suites ; TLS_CHACHA20_POLY1305_SHA256; TLS_AES_128_GCM_SHA256
HSL| emit ClientHello
TLS| HS.next_fragment returned a fragment
TLS| sendHandshake
TLS| send Handshake fragment with index PlaintextID
TLS| Sending fragment of length 170
REC| record headers: 16030300aa
TLS| writeHandshake (plaintext)
TLS| HS.next_fragment PlaintextID?
HS | next_fragment
TLS| HS.next_fragment returned nothing
TLS| sendHandshake
TLS| read: WrittenHS, Ctrl/Ctrl, nothing
REC| WouldBlock
TLS| readOne ReadWouldBlock
client done clen= 175 slen=   0 status=would_block
16030300aa010000a603035b22e8fefd17a61b24a0161658936e1536f2cd26ae
deb19281d3549ef1e988980000041303130101000079001a0009ffff00050a0b
0c0d0e002b0003027f1c003300260024001d0020e873dfc5d812368e417946e1
87414d1fcbb56fde18220da629b30ea0fa23357e0000000e000c0000096c6f63
616c686f73740010000800060568712d313000170000000d0006000408040403
000a00040002001d002d0003020001
server call clen= 175 slen=8192
TLS| writeHandshake (plaintext)
TLS| HS.next_fragment PlaintextID?
HS | next_fragment
TLS| HS.next_fragment returned nothing
TLS| sendHandshake
TLS| read: WrittenHS, Ctrl/Ctrl, nothing
TLS| Read fragment at epoch index: -1 of length 170
TLS| read Handshake fragment
HS | recv_fragment
HSL| parsed [ClientHello] -- end of flight 
HS | Processing ClientHello
NGO| offered client extensions [ 001a supported_versions key_share server_name alpn extended_master_secret signature_algorithms supported_groups psk_key_exchange_modes ]
NGO| offered cipher suites ; TLS_CHACHA20_POLY1305_SHA256; TLS_AES_128_GCM_SHA256
NGO| offered versions 1.3
NGO| Negotiated Pure EDH key exchange
NGO| Negotiated ECDSA_SECP256R1_SHA256
NGO| Negotiation callback to handle extra extensions and query for stateless retry.
NGO| Application data in cookie: none
@@@@ Nego callback for TLS 1.3 @@@@
Offered extensions:
003d001a0009ffff00050a0b0c0d0e0000000e000c0000096c6f63616c686f73
740010000800060568712d3130000d0006000408040403000a00040002001d
Transport parameters offered:
ffff00050a0b0c0d0e
No application cookie (fist connection).
Adding server transport parameters:
000102
@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
NGO| negotiated 1.3 TLS_CHACHA20_POLY1305_SHA256
KS | ks_server_init
KS | No PSK selected.
KS | Computed early secret:           33ad0a1c607ec03b09e6cd9893680ce210adf300aa1f2660e1b22e10f170f92a
KS | Handshake salt:                  6f2615a108c702c5678f54fc9dbab69716c076189c48250cebeac3576c3611ba
CDH| Keygen (responder) on X255519
CDH| DH initiator on X255519
KS | DH shared secret: f3ae2b425235cd6ec215c8636754505d8bd42a3ed8cd5909a246592cab646d38
KS | Handshake secret:                994441bb26940339c3e58d031a25fec986bc1bf345a3b47dd618a8f9401a6d80
NGO| processing client extensions [ 001a supported_versions key_share server_name alpn extended_master_secret signature_algorithms supported_groups psk_key_exchange_modes ]
NGO| including server extensions (SH + EE) [ supported_versions key_share alpn supported_groups ]
NGO| extra extensions from application callback: 001a 
HSL| emit ServerHello and hash
HS | derive handshake keys
KS | ks_server_13_sh, hashed log = 3ec23e5f3abbf72866e9e5dff4fb9c69364e7446b365b87e694ca578b8a4aef7
KS | handshake traffic secret[C]:     b20b138efc5003930f278cd9d37c0ac0d396636c017848581e2c694614b5dc09
KS | handshake traffic secret[S]:     85e88e5c64149a03b9bfc5a92f343346934d19b50decfc1fd4ec9ade1e4bfdb6
KS | handshake key[C]:                94763996b5655da123af35da6056dcf98abb862d9573dd1af840bf056c01509d, IV=855edb49996bc5c255ff76ce
KS | handshake key[S]: b34f5eaeb5021c908e9eb27f8f643de6065e571e025c3ef340c7fa9f5b5b514a, IV=189b1464a7e59337c5762b90
AEP| LowProvider: COERCE(K=b34f5eaeb5021c908e9eb27f8f643de6065e571e025c3ef340c7fa9f5b5b514a)
AEP| LowProvider: COERCE(K=94763996b5655da123af35da6056dcf98abb862d9573dd1af840bf056c01509d)
KS | finished key[C]:                 68888d11d18f868c4ef64d9c4a0991b87e4ab41dba93fe72a23b458d18afc60e
KS | finished key[S]:                 47423fa9bc9c6547059b45f3749af42ec9ef40555f692fc5d09dd224afae7d93
KS | Application salt:                12f7da9d9a4d86858079d21c7b28362e7021337bc61645ec6d57159893ece773
KS | Application secret:              0099310e84d11275f7c98e548560b34a1022de7945815f2aa4cbf36fa7fb2db6
TLS| readOne ReadAgain
TLS| writeHandshake (plaintext)
TLS| HS.next_fragment PlaintextID?
HS | next_fragment
TLS| HS.next_fragment returned a fragment; next_keys (for handshake only
TLS| sendHandshake
TLS| send Handshake fragment with index PlaintextID
TLS| Sending fragment of length 90
REC| record headers: 160303005a
EPO| writer++ -1/0
TLS| writeHandshake (encrypted)
TLS| HS.next_fragment ID13?
HS | next_fragment
HS | prepare Server Finished
HSL| emit EncryptedExtensions
HSL| emit Certificate13 and hash
======== TO BE SIGNED <0403>: (130 octets) ========
2020202020202020202020202020202020202020202020202020202020202020
2020202020202020202020202020202020202020202020202020202020202020
544c5320312e332c207365727665722043657274696669636174655665726966
7900d2af9b3bf97bae2d602361c03c9f177ab7d4ec8148b53d9816312038fc62
bef9
===================================================
HSL| emit CertificateVerify and hash
HSL| emit Finished and hash
KS | ks_server_13_sf hashed_log = b13d349e5b54357f18c6936e8302b1e59a75eac8f19514676109d3ec7c93f2d9
KS | application traffic secret[C]:   3b4b8da3772af101e2accf1d7a85f348874c48212e60631fc07fe94b0e550daf
KS | application traffic secret[S]:   5bec37fd6b89295a97b0792493c19c10a3d1df9615b029db21ce1525008c5a83
KS | exporter master secret:          eada0d9a9d6205d04ad60a88cf86113677ab64dd851e4d43b13b9d6b90453bbd
KS | application key[C]:              f302cda494415da2389a59a88b2b7e78e48568c537f53747ecd2ccaf6e0e02a4, IV=9c61e9f93419c6135dfa1dfd
KS | application key[S]:              1ce772ee0abcbf30f839b4b0c6b2285356639bef72d6bbd08ebf82caa83e7ba1, IV=558ba30081fa2bce9675cd41
AEP| LowProvider: COERCE(K=1ce772ee0abcbf30f839b4b0c6b2285356639bef72d6bbd08ebf82caa83e7ba1)
AEP| LowProvider: COERCE(K=f302cda494415da2389a59a88b2b7e78e48568c537f53747ecd2ccaf6e0e02a4)
HS | exporting a key
EPO| reader++ 0/0
TLS| HS.next_fragment returned a fragment; next_keys (for all data)
TLS| sendHandshake
TLS| send Handshake fragment with index ID13
TLS| Encrypting with key b34f5eaeb5021c908e9eb27f8f643de6065e571e025c3ef340c7fa9f5b5b514a
TLS| Sending fragment of length 735
REC| record headers: 17030302df
EPO| writer++ 0/1
TLS| read: WrittenHS, Ctrl/Open, new writer: writable
sender done clen= 175 slen= 835 status=server_accept
160303005a0200005603035b22e8fe1a67ed5ac63d30cc65e151d31a400a1594
d75f34b398edb68af07a6b00130300002e002b00027f1c00330024001d0020f5
af2cc7372d45672c69f9d90f28b986f2da80b7b598d06f46fd954cf9f4354f17
030302df44261621776f74abadeeea1320799f45cab876f4a31d6344168e9cd4
2ee094714ce24b2a94e5ecf41c5a329bb724224aaaa0b17aa5d13b532f1f0545
0b81e35813fe6ee69aeca086f0d81bd4404838dfbf3ce5528b88de797a540ad4
f127a54374d91e35476d3e4c66e6b21c6f0d67c6dc808e3e52a86eae0bf7f359
bcf0b0318d73dfd0ec8ab2f818693cd0d5be457a8ed403789425282dd1ff559e
227d16b81c0368e0a98a1ba890545f3381d88fff59a447124a3d7237876750d6
d6c2bcf863dea2c9199c9985a94c906b94b4c929d0e3b0c50a4be06dede24501
6c0529761f1224f32bd0ae5d4ed4ce3057a5ca7f5ceb02b5ea56ee6ffb8c2c3c
1990e2093e3489182f54a7505ff9037d05f6a2b832b5bc230919db688b736d6e
ef9b0bb17f922c232e8b70189c1e1b33cc305d9c2604240535aef0e79813442e
f7ecd91e892260a6f5bac4420042ee26041f30045e66405d2e7cced8d63d12df
dd052bdf2bbd4e02f46a6c9ae0c99f7c5b0a764592aeb138c799591b45dcdec7
8e001400b4ea1c3df0a3c28aa88d15acb7f0cf1cdd048a29a7379f9834684295
d1d7d172beeb5a68d5e990b55c9999c5d4ea3b2639933506cf93e423805d04e0
19f710902ecaf046c9d8df054d678ca37b9ebfdab9eebe7bd63ddadc1aa090d8
6534cf7b3f0fadc0eacaded181fae967c4dcad98ab2152e0e10a5545f12727ec
7a97c46f152d0458a4d981d96a929b8cbc3d5f021c19425a3f977563af6f39f1
13120510a6e6652efb988325fd77861ea11fecadf789e729962084604bb7aba6
69e7875b04528336514a80af2a8ddb153972723ebf598633b9da8d44c97a74e7
9a8067b648831c125f41b3102a1f4a298f49909976a841538791849fba938d4d
9afe65ad9121b1eb77f835ea87444c0c2e460536608942f5c279741be7b83d3d
e79e7fc736c54c3a19715249f7322869acca2bed0d5327399ff5bb34dbd536a0
d6809076ac8f23731a99d3d7d5f623f72a126ca8a3b50114fe854b20403ec6fc
496187
client call clen=8017 slen= 835
TLS| writeHandshake (plaintext)
TLS| HS.next_fragment PlaintextID?
HS | next_fragment
TLS| HS.next_fragment returned nothing
TLS| sendHandshake
TLS| read: WrittenHS, Ctrl/Ctrl, nothing
TLS| Read fragment at epoch index: -1 of length 90
TLS| read Handshake fragment
HS | recv_fragment
HSL| parsed ServerHello
HSL| end of flight
HS | client_ServerHello
NGO| processing server extensions [ supported_versions key_share ]
NGO| negotiated 1.3 TLS_CHACHA20_POLY1305_SHA256
HS | Running TLS 1.3
KS | ks_client_13_sh hashed_log = 3ec23e5f3abbf72866e9e5dff4fb9c69364e7446b365b87e694ca578b8a4aef7
KS | no PSK negotiated. Early secret: 33ad0a1c607ec03b09e6cd9893680ce210adf300aa1f2660e1b22e10f170f92a
KS | handshake salt:                  6f2615a108c702c5678f54fc9dbab69716c076189c48250cebeac3576c3611ba
CDH| DH initiator on X255519
KS | DH shared secret: f3ae2b425235cd6ec215c8636754505d8bd42a3ed8cd5909a246592cab646d38
KS | handshake secret:                994441bb26940339c3e58d031a25fec986bc1bf345a3b47dd618a8f9401a6d80
KS | handshake traffic secret[C]:     b20b138efc5003930f278cd9d37c0ac0d396636c017848581e2c694614b5dc09
KS | handshake traffic secret[S]:     85e88e5c64149a03b9bfc5a92f343346934d19b50decfc1fd4ec9ade1e4bfdb6
KS | handshake key[C]:                94763996b5655da123af35da6056dcf98abb862d9573dd1af840bf056c01509d, IV=855edb49996bc5c255ff76ce
KS | handshake key[S]:                b34f5eaeb5021c908e9eb27f8f643de6065e571e025c3ef340c7fa9f5b5b514a, IV=189b1464a7e59337c5762b90
KS | finished key[C]: 68888d11d18f868c4ef64d9c4a0991b87e4ab41dba93fe72a23b458d18afc60e
KS | finished key[S]: 47423fa9bc9c6547059b45f3749af42ec9ef40555f692fc5d09dd224afae7d93
KS | application salt:                12f7da9d9a4d86858079d21c7b28362e7021337bc61645ec6d57159893ece773
KS | application secret:              0099310e84d11275f7c98e548560b34a1022de7945815f2aa4cbf36fa7fb2db6
AEP| LowProvider: COERCE(K=94763996b5655da123af35da6056dcf98abb862d9573dd1af840bf056c01509d)
AEP| LowProvider: COERCE(K=b34f5eaeb5021c908e9eb27f8f643de6065e571e025c3ef340c7fa9f5b5b514a)
EPO| reader++ 0/-1
TLS| readOne ReadAgain
TLS| writeHandshake (plaintext)
TLS| HS.next_fragment PlaintextID?
HS | next_fragment
TLS| HS.next_fragment returned nothing
TLS| sendHandshake
TLS| read: WrittenHS, Ctrl/Ctrl, nothing
TLS| Read fragment at epoch index: 0 of length 735
TLS| StAE decrypt correct.
TLS| read Handshake fragment
HS | recv_fragment
HSL| parsed EncryptedExtensions
HSL| parsed Certificate13
HSL| parsed CertificateVerify
HSL| parsed Finished
HSL| end of flight
NGO| Nego.clientComplete_13
NGO| EE: alpn supported_groups 001a 
NGO| Negotiation callback to process application extensions.
@@@@ Nego callback for TLS 1.3 @@@@
Offered extensions:
001b0010000800060568712d3130000a00040002001d001a0003000102
Transport parameters offered:
000102
No application cookie (fist connection).
Adding server transport parameters:
000102
@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
WARNING: chain validation failed, ignoring.
NGO| Certificate & signature 1.3 callback result: valid
KS | ks_client_13_sf hashed_log = b13d349e5b54357f18c6936e8302b1e59a75eac8f19514676109d3ec7c93f2d9
KS | application traffic secret[C]:   3b4b8da3772af101e2accf1d7a85f348874c48212e60631fc07fe94b0e550daf
KS | application traffic secret[S]:   5bec37fd6b89295a97b0792493c19c10a3d1df9615b029db21ce1525008c5a83
KS | exporter master secret:          eada0d9a9d6205d04ad60a88cf86113677ab64dd851e4d43b13b9d6b90453bbd
KS | application key[C]:              f302cda494415da2389a59a88b2b7e78e48568c537f53747ecd2ccaf6e0e02a4, IV=9c61e9f93419c6135dfa1dfd
KS | application key[S]:              1ce772ee0abcbf30f839b4b0c6b2285356639bef72d6bbd08ebf82caa83e7ba1, IV=558ba30081fa2bce9675cd41
AEP| LowProvider: COERCE(K=f302cda494415da2389a59a88b2b7e78e48568c537f53747ecd2ccaf6e0e02a4)
AEP| LowProvider: COERCE(K=1ce772ee0abcbf30f839b4b0c6b2285356639bef72d6bbd08ebf82caa83e7ba1)
HS | exporting a key
HS | Early data rejected
EPO| writer++ 0/0
HSL| emit Finished and hash
KS | ks_client_13_cf hashed_log = 33db3b1f300592f67808a687b5220eff706404e9f7f46b7c1aef83e47ac08a10
KS | resumption master secret:        0d5fbec1f77eb4600fa901041f50bdbbb209156606033875d2ca99bad3cf7b9a
EPO| reader++ 1/0
TLS| readOne ReadAgain
TLS| writeHandshake (encrypted)
TLS| HS.next_fragment ID13?
HS | next_fragment
TLS| HS.next_fragment returned a fragment; next_keys (for all data); complete
TLS| sendHandshake
TLS| send Handshake fragment with index ID13
TLS| Encrypting with key 94763996b5655da123af35da6056dcf98abb862d9573dd1af840bf056c01509d
TLS| Sending fragment of length 53
REC| record headers: 1703030035
EPO| writer++ 1/1
TLS| read: WrittenHS, Open/Open, new writer: complete
client done clen=  58 slen= 835 status=client_complete
17030300353b0c3f9bc072a6a7767eda40eef0b254283184db4148159895b032
5478ac587d0134d34954cf7e06544d74fab311883d067052501d
server call clen=  58 slen=7357
TLS| writeHandshake (encrypted)
TLS| HS.next_fragment ID13?
HS | next_fragment
TLS| HS.next_fragment returned nothing
TLS| sendHandshake
TLS| read: WrittenHS, Ctrl/Open, nothing
TLS| Read fragment at epoch index: 0 of length 53
TLS| StAE decrypt correct.
TLS| read Handshake fragment
HS | recv_fragment
HSL| parsed Finished
HSL| end of flight
HS | Process Client Finished
KS | ks_server_13_cf hashed_log = 33db3b1f300592f67808a687b5220eff706404e9f7f46b7c1aef83e47ac08a10
KS | resumption master secret:        0d5fbec1f77eb4600fa901041f50bdbbb209156606033875d2ca99bad3cf7b9a
AEP| LowProvider: COERCE(K=05b9a0492d4ee489eb0d434fe4ae4d7f4e035fcd2670e7e08e3072d7bde5a0c7)
HS | Sending ticket: d76a7461314f2a61cbf1948c8952893772a285c0c263d109b5666cf4f70f6fbe03673a09db3b23cc5f374be14e153d3d819d8efe6cbcb311726107b973f20c1cf23e6f840297928d2f882c7a
HSL| emit NewSessionTicket13
EPO| reader++ 1/1
TLS| readOne Complete
sender done clen=  58 slen=   0 status=server_complete
=== Exporter secret ===
eada0d9a9d6205d04ad60a88cf86113677ab64dd851e4d43b13b9d6b90453bbd
=== QUIC 1-RTT secrets ===
C: 4628cd9cf3805db8faa590b10056d05d47e6aa9c7112794f4cba1562258beba5
S: 62891bfa29c29787ed70e70dcdedaf8685f6114e649f061d5a3468cfc9d59aff
=== AEAD client key test ===
ac89c3fc0a8fd081063f8db74a2ff4aa2db687b6c4cc886b417719
=== Decrypt successful ===
Ok
./quic.exe 0rtt

INITIAL ECDHE HANDSHAKE (NO EARLY SECRET)

server create
FFI| offering custom extension 001a
FFI| extension contents: ffff00050a0b0c0d0e
FFI| setting early data limit to ffffffff
FFI| Setting a new ticket callback.
FFI| Setting a new server negotiation callback.
FFI| Setting up certificate callbacks.
client create
FFI| offering custom extension 001a
FFI| extension contents: ffff00050a0b0c0d0e
FFI| setting early data limit to ffffffff
FFI| Setting a new ticket callback.
FFI| Setting a new server negotiation callback.
FFI| Setting up certificate callbacks.
TLS| writeHandshake (plaintext)
TLS| HS.next_fragment PlaintextID?
HS | next_fragment
HS | offering ClientHello 1.3
KS | ks_client_init 1.3
CDH| Keygen (initiator) on X255519
NGO| No PSK or 0-RTT disabled
NGO| offering client extensions [ 001a supported_versions key_share server_name alpn extended_master_secret signature_algorithms supported_groups psk_key_exchange_modes ]
NGO| offering cipher suites ; TLS_CHACHA20_POLY1305_SHA256; TLS_AES_128_GCM_SHA256
HSL| emit ClientHello
TLS| HS.next_fragment returned a fragment
TLS| sendHandshake
TLS| send Handshake fragment with index PlaintextID
TLS| Sending fragment of length 170
REC| record headers: 16030300aa
TLS| writeHandshake (plaintext)
TLS| HS.next_fragment PlaintextID?
HS | next_fragment
TLS| HS.next_fragment returned nothing
TLS| sendHandshake
TLS| read: WrittenHS, Ctrl/Ctrl, nothing
REC| WouldBlock
TLS| readOne ReadWouldBlock
client returns would_block clen=175 slen=0
ClientHello[ 175] ---->

TLS| writeHandshake (plaintext)
TLS| HS.next_fragment PlaintextID?
HS | next_fragment
TLS| HS.next_fragment returned nothing
TLS| sendHandshake
TLS| read: WrittenHS, Ctrl/Ctrl, nothing
TLS| Read fragment at epoch index: -1 of length 170
TLS| read Handshake fragment
HS | recv_fragment
HSL| parsed [ClientHello] -- end of flight 
HS | Processing ClientHello
NGO| offered client extensions [ 001a supported_versions key_share server_name alpn extended_master_secret signature_algorithms supported_groups psk_key_exchange_modes ]
NGO| offered cipher suites ; TLS_CHACHA20_POLY1305_SHA256; TLS_AES_128_GCM_SHA256
NGO| offered versions 1.3
NGO| Negotiated Pure EDH key exchange
NGO| Negotiated ECDSA_SECP256R1_SHA256
NGO| Negotiation callback to handle extra extensions and query for stateless retry.
NGO| Application data in cookie: none
@@@@ Nego callback for TLS 1.3 @@@@
Offered extensions:
003d001a0009ffff00050a0b0c0d0e0000000e000c0000096c6f63616c686f73
740010000800060568712d3130000d0006000408040403000a00040002001d
Transport parameters offered:
ffff00050a0b0c0d0e
No application cookie (fist connection).
Adding server transport parameters:
000102
@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
NGO| negotiated 1.3 TLS_CHACHA20_POLY1305_SHA256
KS | ks_server_init
KS | No PSK selected.
KS | Computed early secret:           33ad0a1c607ec03b09e6cd9893680ce210adf300aa1f2660e1b22e10f170f92a
KS | Handshake salt:                  6f2615a108c702c5678f54fc9dbab69716c076189c48250cebeac3576c3611ba
CDH| Keygen (responder) on X255519
CDH| DH initiator on X255519
KS | DH shared secret: 179e8e03289eb6e0dac962676102a900aa63c38214e59de863702dfc126bab2d
KS | Handshake secret:                5459501697bbdc1bc7c6b627ae6a42c46661bca268e70745a655119f41781fbe
NGO| processing client extensions [ 001a supported_versions key_share server_name alpn extended_master_secret signature_algorithms supported_groups psk_key_exchange_modes ]
NGO| including server extensions (SH + EE) [ supported_versions key_share alpn supported_groups ]
NGO| extra extensions from application callback: 001a 
HSL| emit ServerHello and hash
HS | derive handshake keys
KS | ks_server_13_sh, hashed log = e0c4867ecad32911e4cf3cb401391dc182b6cef90a0205635e303b42396cdf54
KS | handshake traffic secret[C]:     af7b42d1bca703afd153ea849407392d7e11b9ba335aebeb5e2c3b4bb1c98f10
KS | handshake traffic secret[S]:     7ab2dd834b90dbb7b22ead7651ecd3db0ac60bfb4454b0cfa19aaeb1b56230fd
KS | handshake key[C]:                20b5409fdaa75c16f67b34476f210bea10468c9564f5e2eb0dbfe17fb371829c, IV=b5a97b5e523ebbe5214988ae
KS | handshake key[S]: 3702fa48f073cf8915c4e5678300517d9192343c7e4eed7e0ecb8b3b2f43e8c9, IV=df0f34af17072bdb390e6f8b
AEP| LowProvider: COERCE(K=3702fa48f073cf8915c4e5678300517d9192343c7e4eed7e0ecb8b3b2f43e8c9)
AEP| LowProvider: COERCE(K=20b5409fdaa75c16f67b34476f210bea10468c9564f5e2eb0dbfe17fb371829c)
KS | finished key[C]:                 e2a289f1b13cd12009edfeda8154f09fd9ba9271b6494a65b156cc6e418edf51
KS | finished key[S]:                 7ac9e9eed0f85885d33966782003a6acc292b82ea6eaf79f24493a0ea5bdda30
KS | Application salt:                e4c4b0182f7d4fae1b4f4d05a4d299cafe64608b8963616ea9fe6b4f0a08a72b
KS | Application secret:              d6664e338113fa44d9ce6ec0b1a0fa458e90ed8ea31acd542481daf026141eb7
TLS| readOne ReadAgain
TLS| writeHandshake (plaintext)
TLS| HS.next_fragment PlaintextID?
HS | next_fragment
TLS| HS.next_fragment returned a fragment; next_keys (for handshake only
TLS| sendHandshake
TLS| send Handshake fragment with index PlaintextID
TLS| Sending fragment of length 90
REC| record headers: 160303005a
EPO| writer++ -1/0
TLS| writeHandshake (encrypted)
TLS| HS.next_fragment ID13?
HS | next_fragment
HS | prepare Server Finished
HSL| emit EncryptedExtensions
HSL| emit Certificate13 and hash
======== TO BE SIGNED <0403>: (130 octets) ========
2020202020202020202020202020202020202020202020202020202020202020
2020202020202020202020202020202020202020202020202020202020202020
544c5320312e332c207365727665722043657274696669636174655665726966
7900b6b891c410ace6d2f9a31cfbc92de10b3d4df51612c64341471d05532c15
4539
===================================================
HSL| emit CertificateVerify and hash
HSL| emit Finished and hash
KS | ks_server_13_sf hashed_log = a0be19cbb265c29d13e5b5bd8b27b44e419d56b429a96f843b0c4e0f1142233f
KS | application traffic secret[C]:   414e321253f2d67e5d060f24a5cbd936092866112707f6b7c378bec49df44f3e
KS | application traffic secret[S]:   8cd500029ff659cdae57a59334ff09aa3beed7f09b2e3e9d7130f33b23769489
KS | exporter master secret:          a6f58b4bdf94ccb45edfc6efed5d0785da48e3197375331315766f96cd37bfd9
KS | application key[C]:              471c1c3a91a7d9e95fa8f2cb9893f5c34f36292c8357eb8b53e8ed3f7daf4ec0, IV=5ab58178e6dec3d9e34ce2ca
KS | application key[S]:              bea4e1da15ce0f275f96d8af720c55f1ff6ce3998f3c049900e0f6cbf35307d1, IV=9340eae0b88cc959eccb60d8
AEP| LowProvider: COERCE(K=bea4e1da15ce0f275f96d8af720c55f1ff6ce3998f3c049900e0f6cbf35307d1)
AEP| LowProvider: COERCE(K=471c1c3a91a7d9e95fa8f2cb9893f5c34f36292c8357eb8b53e8ed3f7daf4ec0)
HS | exporting a key
EPO| reader++ 0/0
TLS| HS.next_fragment returned a fragment; next_keys (for all data)
TLS| sendHandshake
TLS| send Handshake fragment with index ID13
TLS| Encrypting with key 3702fa48f073cf8915c4e5678300517d9192343c7e4eed7e0ecb8b3b2f43e8c9
TLS| Sending fragment of length 734
REC| record headers: 17030302de
EPO| writer++ 0/1
TLS| read: WrittenHS, Ctrl/Open, new writer: writable
server returns server_accept clen=175 slen=834
secret=a6f58b4bdf94ccb45edfc6efed5d0785da48e3197375331315766f96cd37bfd9
<---- ServerHello;(EncryptedExtensions; Certificate; CertVerify; Finished)[ 834]

TLS| writeHandshake (plaintext)
TLS| HS.next_fragment PlaintextID?
HS | next_fragment
TLS| HS.next_fragment returned nothing
TLS| sendHandshake
TLS| read: WrittenHS, Ctrl/Ctrl, nothing
TLS| Read fragment at epoch index: -1 of length 90
TLS| read Handshake fragment
HS | recv_fragment
HSL| parsed ServerHello
HSL| end of flight
HS | client_ServerHello
NGO| processing server extensions [ supported_versions key_share ]
NGO| negotiated 1.3 TLS_CHACHA20_POLY1305_SHA256
HS | Running TLS 1.3
KS | ks_client_13_sh hashed_log = e0c4867ecad32911e4cf3cb401391dc182b6cef90a0205635e303b42396cdf54
KS | no PSK negotiated. Early secret: 33ad0a1c607ec03b09e6cd9893680ce210adf300aa1f2660e1b22e10f170f92a
KS | handshake salt:                  6f2615a108c702c5678f54fc9dbab69716c076189c48250cebeac3576c3611ba
CDH| DH initiator on X255519
KS | DH shared secret: 179e8e03289eb6e0dac962676102a900aa63c38214e59de863702dfc126bab2d
KS | handshake secret:                5459501697bbdc1bc7c6b627ae6a42c46661bca268e70745a655119f41781fbe
KS | handshake traffic secret[C]:     af7b42d1bca703afd153ea849407392d7e11b9ba335aebeb5e2c3b4bb1c98f10
KS | handshake traffic secret[S]:     7ab2dd834b90dbb7b22ead7651ecd3db0ac60bfb4454b0cfa19aaeb1b56230fd
KS | handshake key[C]:                20b5409fdaa75c16f67b34476f210bea10468c9564f5e2eb0dbfe17fb371829c, IV=b5a97b5e523ebbe5214988ae
KS | handshake key[S]:                3702fa48f073cf8915c4e5678300517d9192343c7e4eed7e0ecb8b3b2f43e8c9, IV=df0f34af17072bdb390e6f8b
KS | finished key[C]: e2a289f1b13cd12009edfeda8154f09fd9ba9271b6494a65b156cc6e418edf51
KS | finished key[S]: 7ac9e9eed0f85885d33966782003a6acc292b82ea6eaf79f24493a0ea5bdda30
KS | application salt:                e4c4b0182f7d4fae1b4f4d05a4d299cafe64608b8963616ea9fe6b4f0a08a72b
KS | application secret:              d6664e338113fa44d9ce6ec0b1a0fa458e90ed8ea31acd542481daf026141eb7
AEP| LowProvider: COERCE(K=20b5409fdaa75c16f67b34476f210bea10468c9564f5e2eb0dbfe17fb371829c)
AEP| LowProvider: COERCE(K=3702fa48f073cf8915c4e5678300517d9192343c7e4eed7e0ecb8b3b2f43e8c9)
EPO| reader++ 0/-1
TLS| readOne ReadAgain
TLS| writeHandshake (plaintext)
TLS| HS.next_fragment PlaintextID?
HS | next_fragment
TLS| HS.next_fragment returned nothing
TLS| sendHandshake
TLS| read: WrittenHS, Ctrl/Ctrl, nothing
TLS| Read fragment at epoch index: 0 of length 734
TLS| StAE decrypt correct.
TLS| read Handshake fragment
HS | recv_fragment
HSL| parsed EncryptedExtensions
HSL| parsed Certificate13
HSL| parsed CertificateVerify
HSL| parsed Finished
HSL| end of flight
NGO| Nego.clientComplete_13
NGO| EE: alpn supported_groups 001a 
NGO| Negotiation callback to process application extensions.
@@@@ Nego callback for TLS 1.3 @@@@
Offered extensions:
001b0010000800060568712d3130000a00040002001d001a0003000102
Transport parameters offered:
000102
No application cookie (fist connection).
Adding server transport parameters:
000102
@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
WARNING: chain validation failed, ignoring.
NGO| Certificate & signature 1.3 callback result: valid
KS | ks_client_13_sf hashed_log = a0be19cbb265c29d13e5b5bd8b27b44e419d56b429a96f843b0c4e0f1142233f
KS | application traffic secret[C]:   414e321253f2d67e5d060f24a5cbd936092866112707f6b7c378bec49df44f3e
KS | application traffic secret[S]:   8cd500029ff659cdae57a59334ff09aa3beed7f09b2e3e9d7130f33b23769489
KS | exporter master secret:          a6f58b4bdf94ccb45edfc6efed5d0785da48e3197375331315766f96cd37bfd9
KS | application key[C]:              471c1c3a91a7d9e95fa8f2cb9893f5c34f36292c8357eb8b53e8ed3f7daf4ec0, IV=5ab58178e6dec3d9e34ce2ca
KS | application key[S]:              bea4e1da15ce0f275f96d8af720c55f1ff6ce3998f3c049900e0f6cbf35307d1, IV=9340eae0b88cc959eccb60d8
AEP| LowProvider: COERCE(K=471c1c3a91a7d9e95fa8f2cb9893f5c34f36292c8357eb8b53e8ed3f7daf4ec0)
AEP| LowProvider: COERCE(K=bea4e1da15ce0f275f96d8af720c55f1ff6ce3998f3c049900e0f6cbf35307d1)
HS | exporting a key
HS | Early data rejected
EPO| writer++ 0/0
HSL| emit Finished and hash
KS | ks_client_13_cf hashed_log = b42e41315b0874fab7d45a206237e6a3135f7cc8d2fb45d04f55432ad729fc17
KS | resumption master secret:        262fa900df12d35fc230196cf01ad615e516e5ae2c04ca392ee3f2329067e7f7
EPO| reader++ 1/0
TLS| readOne ReadAgain
TLS| writeHandshake (encrypted)
TLS| HS.next_fragment ID13?
HS | next_fragment
TLS| HS.next_fragment returned a fragment; next_keys (for all data); complete
TLS| sendHandshake
TLS| send Handshake fragment with index ID13
TLS| Encrypting with key 20b5409fdaa75c16f67b34476f210bea10468c9564f5e2eb0dbfe17fb371829c
TLS| Sending fragment of length 53
REC| record headers: 1703030035
EPO| writer++ 1/1
TLS| read: WrittenHS, Open/Open, new writer: complete
client returns client_complete clen=58 slen=834
secret=a6f58b4bdf94ccb45edfc6efed5d0785da48e3197375331315766f96cd37bfd9
(Finished) [  58] ---->

TLS| writeHandshake (encrypted)
TLS| HS.next_fragment ID13?
HS | next_fragment
TLS| HS.next_fragment returned nothing
TLS| sendHandshake
TLS| read: WrittenHS, Ctrl/Open, nothing
TLS| Read fragment at epoch index: 0 of length 53
TLS| StAE decrypt correct.
TLS| read Handshake fragment
HS | recv_fragment
HSL| parsed Finished
HSL| end of flight
HS | Process Client Finished
KS | ks_server_13_cf hashed_log = b42e41315b0874fab7d45a206237e6a3135f7cc8d2fb45d04f55432ad729fc17
KS | resumption master secret:        262fa900df12d35fc230196cf01ad615e516e5ae2c04ca392ee3f2329067e7f7
AEP| LowProvider: COERCE(K=d96ae0d2736352f2ee8ebff88d22f8c1e583dcd0cedd0c61ba31350e065a9077)
HS | Sending ticket: 8e6349964835aa356ae4a3fc4cce5f24cc69c0bbf3f19f43b20de8c576fbe0c0dd45ff36a5b5fd453deef43ed293f7335b0f566614990bba8a0b8e502d31d8f9939ad03dc525a75b890bcac1
HSL| emit NewSessionTicket13
EPO| reader++ 1/1
TLS| readOne Complete
server returns server_complete clen=58 slen=0
TLS| writeHandshake (encrypted)
TLS| HS.next_fragment ID13?
HS | next_fragment
TLS| HS.next_fragment returned a fragment
TLS| sendHandshake
TLS| send Handshake fragment with index ID13
TLS| Encrypting with key bea4e1da15ce0f275f96d8af720c55f1ff6ce3998f3c049900e0f6cbf35307d1
TLS| Sending fragment of length 130
REC| record headers: 1703030082
TLS| writeHandshake (encrypted)
TLS| HS.next_fragment ID13?
HS | next_fragment
TLS| HS.next_fragment returned nothing
TLS| sendHandshake
TLS| read: WrittenHS, Open/Open, nothing
REC| WouldBlock
TLS| readOne ReadWouldBlock
server returns would_block clen=0 slen=135
<---- {Ticket}[ 135]
TLS| writeHandshake (encrypted)
TLS| HS.next_fragment ID13?
HS | next_fragment
TLS| HS.next_fragment returned nothing
TLS| sendHandshake
TLS| read: WrittenHS, Open/Open, nothing
TLS| Read fragment at epoch index: 1 of length 130
TLS| StAE decrypt correct.
TLS| read Handshake fragment
HS | recv_fragment
HSL| parsed NewSessionTicket13
HSL| end of flight
HS | Received ticket: 8e6349964835aa356ae4a3fc4cce5f24cc69c0bbf3f19f43b20de8c576fbe0c0dd45ff36a5b5fd453deef43ed293f7335b0f566614990bba8a0b8e502d31d8f9939ad03dc525a75b890bcac1
KS | ks_client_13_rms
KS | Recall RMS: 262fa900df12d35fc230196cf01ad615e516e5ae2c04ca392ee3f2329067e7f7
AEP| LowProvider: COERCE(K=a60aa9ab1df0cf8a87b1d1930c20489fc225c0b816e6d00e9cf367634cdbb7fa)

##### New session ticket received! #####
Host: localhost
Ticket:
8e6349964835aa356ae4a3fc4cce5f24cc69c0bbf3f19f43b20de8c576fbe0c0
dd45ff36a5b5fd453deef43ed293f7335b0f566614990bba8a0b8e502d31d8f9
939ad03dc525a75b890bcac1
########################################
TLS| readOne ReadAgain
TLS| writeHandshake (encrypted)
TLS| HS.next_fragment ID13?
HS | next_fragment
TLS| HS.next_fragment returned nothing
TLS| sendHandshake
TLS| read: WrittenHS, Open/Open, nothing
REC| WouldBlock
TLS| readOne ReadWouldBlock
client returns clen=0 slen=135 status=would_block

TICKET-BASED RESUMPTION

server create
FFI| offering custom extension 001a
FFI| extension contents: ffff00050a0b0c0d0e
FFI| setting early data limit to ffffffff
FFI| Setting a new ticket callback.
FFI| Setting a new server negotiation callback.
FFI| Setting up certificate callbacks.
client create
FFI| offering custom extension 001a
FFI| extension contents: ffff00050a0b0c0d0e
FFI| setting early data limit to ffffffff
FFI| Setting a new ticket callback.
FFI| Setting a new server negotiation callback.
FFI| Setting up certificate callbacks.
TCK| Decrypting ticket ecec12f744bd717cc641d149326d6e40cc160942c5783e078f8e681e22f5e62ade60cc7df6be21dbc82a87b2842df234f29477cd646494918a62019a3e6e7bb2202603c9c786aa68d585b1b4
TCK| Parsing ticket 030413035b22e8fe528818b80000002018d00f513b05c6a4bfba5f90153c30804726ec1e70297247ccfb391a2ee9bf33
TLS| writeHandshake (plaintext)
TLS| HS.next_fragment PlaintextID?
HS | next_fragment
HS | offering ClientHello 1.3
KS | ks_client_init 1.3
CDH| Keygen (initiator) on X255519
NGO| Offering a PSK compatible with 0-RTT
NGO| offering client extensions [ 001a supported_versions key_share server_name alpn extended_master_secret signature_algorithms supported_groups psk_key_exchange_modes early_data pre_shared_key ]
NGO| offering cipher suites ; TLS_CHACHA20_POLY1305_SHA256; TLS_AES_128_GCM_SHA256
HSL| emit ClientHello
KS | Loaded pre-shared key 8e6349964835aa356ae4a3fc4cce5f24cc69c0bbf3f19f43b20de8c576fbe0c0dd45ff36a5b5fd453deef43ed293f7335b0f566614990bba8a0b8e502d31d8f9939ad03dc525a75b890bcac1: 18d00f513b05c6a4bfba5f90153c30804726ec1e70297247ccfb391a2ee9bf33
KS | Early secret: 90f25bddf7056a6a41b4c1ed8cc1da77b181d057a8330f4898aba76bf2931374
KS | Binder key[res binder]: 6b675e9cbe492498de6066ec26e224b9925ab64dfc80ab22bc6b9028e8eb554a
KS | Binder Finished key: d64cf93e714741a6a110464169fee95cb6a9102bff411850d81a0ce736d7aa35
HSL| emit Binders
HS | setting up 0RTT
KS | ks_client_13_ch log=0b21d2a95cf4092782b479446a5b6034985e5044a4d8ea7310ad29d26f0c510c
KS | Client early traffic secret:     56e334a30881288ecb75e04a7571a3ff380ce0084570ac9761726e7dc1b7d079
KS | Early exporter master secret:    54a9d2a2cb14541d766e23512b55b62c6d41a172754108902e58d6e617ac2bef
KS | Client 0-RTT key:                95a84e85369b5fe77eec4bca12f2ba3967e23bb9f2a594def9856b6c1a1bdb0c, IV=1fe6376d0c0ff767d681b470
AEP| LowProvider: COERCE(K=95a84e85369b5fe77eec4bca12f2ba3967e23bb9f2a594def9856b6c1a1bdb0c)
HS | exporting a key
TLS| HS.next_fragment returned a fragment; next_keys (for all data)
TLS| sendHandshake
TLS| send Handshake fragment with index PlaintextID
TLS| Sending fragment of length 297
REC| record headers: 1603030129
EPO| writer++ -1/0
TLS| read: WrittenHS, Ctrl/Open, new writer: writable
client returns client_early_data clen=302 slen=0
early secret=54a9d2a2cb14541d766e23512b55b62c6d41a172754108902e58d6e617ac2bef
ClientHello[ 302] ---->

TLS| writeHandshake (plaintext)
TLS| HS.next_fragment PlaintextID?
HS | next_fragment
TLS| HS.next_fragment returned nothing
TLS| sendHandshake
TLS| read: WrittenHS, Ctrl/Ctrl, nothing
TLS| Read fragment at epoch index: -1 of length 297
TLS| read Handshake fragment
HS | recv_fragment
HSL| parsed [ClientHello; Binders] -- end of flight 
HS | Processing ClientHello with 1 binder(s)
NGO| offered client extensions [ 001a supported_versions key_share server_name alpn extended_master_secret signature_algorithms supported_groups psk_key_exchange_modes early_data pre_shared_key ]
NGO| offered cipher suites ; TLS_CHACHA20_POLY1305_SHA256; TLS_AES_128_GCM_SHA256
NGO| offered versions 1.3
TCK| Decrypting ticket 8e6349964835aa356ae4a3fc4cce5f24cc69c0bbf3f19f43b20de8c576fbe0c0dd45ff36a5b5fd453deef43ed293f7335b0f566614990bba8a0b8e502d31d8f9939ad03dc525a75b890bcac1
TCK| Parsing ticket 030413035b22e8fe528818b800000020262fa900df12d35fc230196cf01ad615e516e5ae2c04ca392ee3f2329067e7f7
NGO| Negotiated PSK_EDH key exchange
NGO| Negotiation callback to handle extra extensions and query for stateless retry.
NGO| Application data in cookie: none
@@@@ Nego callback for TLS 1.3 @@@@
Offered extensions:
003d001a0009ffff00050a0b0c0d0e0000000e000c0000096c6f63616c686f73
740010000800060568712d3130000d0006000408040403000a00040002001d
Transport parameters offered:
ffff00050a0b0c0d0e
No application cookie (fist connection).
Adding server transport parameters:
000102
@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
NGO| negotiated 1.3 TLS_CHACHA20_POLY1305_SHA256
HS | accepted TLS 1.3 psk #0
KS | ks_server_init
KS | Using negotiated PSK identity: 8e6349964835aa356ae4a3fc4cce5f24cc69c0bbf3f19f43b20de8c576fbe0c0dd45ff36a5b5fd453deef43ed293f7335b0f566614990bba8a0b8e502d31d8f9939ad03dc525a75b890bcac1
TCK| Decrypting ticket 8e6349964835aa356ae4a3fc4cce5f24cc69c0bbf3f19f43b20de8c576fbe0c0dd45ff36a5b5fd453deef43ed293f7335b0f566614990bba8a0b8e502d31d8f9939ad03dc525a75b890bcac1
TCK| Parsing ticket 030413035b22e8fe528818b800000020262fa900df12d35fc230196cf01ad615e516e5ae2c04ca392ee3f2329067e7f7
KS | Ticket RMS: 262fa900df12d35fc230196cf01ad615e516e5ae2c04ca392ee3f2329067e7f7
KS | Pre-shared key: 18d00f513b05c6a4bfba5f90153c30804726ec1e70297247ccfb391a2ee9bf33
KS | binder key:                      6b675e9cbe492498de6066ec26e224b9925ab64dfc80ab22bc6b9028e8eb554a
KS | binder Finished key:             d64cf93e714741a6a110464169fee95cb6a9102bff411850d81a0ce736d7aa35
KS | Computed early secret:           90f25bddf7056a6a41b4c1ed8cc1da77b181d057a8330f4898aba76bf2931374
KS | Handshake salt:                  d0f70c06372f8f7ffcc4fe517996677ff8efa83628c2ff37e0a83cd91da39869
CDH| Keygen (responder) on X255519
CDH| DH initiator on X255519
KS | DH shared secret: fd9b649e275cbb0b8a1a237eb64700bdbb7a0c2340ff364cc5b5b0d20468e94b
KS | Handshake secret:                62e26f6c9b7a716077f1f2f12b454af80e3267e8d6cfdee13ca9f3161e29d5bd
NGO| processing client extensions [ 001a supported_versions key_share server_name alpn extended_master_secret signature_algorithms supported_groups psk_key_exchange_modes early_data pre_shared_key ]
NGO| including server extensions (SH + EE) [ supported_versions key_share alpn supported_groups early_data pre_shared_key ]
NGO| extra extensions from application callback: 001a 
HSL| emit ServerHello and hash
KS | ks_server_13_0rtt_key
KS | Client early traffic secret:     56e334a30881288ecb75e04a7571a3ff380ce0084570ac9761726e7dc1b7d079
KS | Early exporter master secret:    54a9d2a2cb14541d766e23512b55b62c6d41a172754108902e58d6e617ac2bef
KS | Client 0-RTT key:                95a84e85369b5fe77eec4bca12f2ba3967e23bb9f2a594def9856b6c1a1bdb0c, IV=1fe6376d0c0ff767d681b470
AEP| LowProvider: COERCE(K=95a84e85369b5fe77eec4bca12f2ba3967e23bb9f2a594def9856b6c1a1bdb0c)
HS | exporting a key
HS | derive handshake keys
KS | ks_server_13_sh, hashed log = 3928eef1293cce85a1911a20239f07943d3d79593ad8b925c18a665ddc8a5ae4
KS | handshake traffic secret[C]:     1e0e2a4b71e52aee185cf8ff4e9aee5d19f8fafe01ba8da794001fae6c0040ef
KS | handshake traffic secret[S]:     9747ec456efa0353fd0772b24c2657b506604e8587e4f1d0c775ba378f480144
KS | handshake key[C]:                ae7fa967d5c88c4c647a197af96901019cefafae10be1877a75ac6c9537c0625, IV=d7aaf5a3db2cde99f3b4f390
KS | handshake key[S]: 06e6e1f8ea67ac95ba1d9b764743435be8db1de10e14d916544b9401e5df57ee, IV=7e073d8109f597248c264d88
AEP| LowProvider: COERCE(K=06e6e1f8ea67ac95ba1d9b764743435be8db1de10e14d916544b9401e5df57ee)
AEP| LowProvider: COERCE(K=ae7fa967d5c88c4c647a197af96901019cefafae10be1877a75ac6c9537c0625)
KS | finished key[C]:                 5ae6e6758f2dc27bb6f1bde9c1d3dd07d7696645141b560d93a004502e11e7a9
KS | finished key[S]:                 2fdbaf1715cb0e20faf7df1622ea70d066b3660dae4e7e8f219181540a02fe0f
KS | Application salt:                70dfbedeffc80b753a25333f3e02813f850cee337377be841f38615b126c71c0
KS | Application secret:              b2425f95356f8299e9ad05f8a79a17d2ea3f075f53d4fe33ad4f1ec7146def79
TLS| readOne ReadAgain
TLS| writeHandshake (plaintext)
TLS| HS.next_fragment PlaintextID?
HS | next_fragment
TLS| HS.next_fragment returned a fragment; next_keys (for handshake only skipping 0RTT
TLS| sendHandshake
TLS| send Handshake fragment with index PlaintextID
TLS| Sending fragment of length 96
REC| record headers: 1603030060
EPO| writer++ -1/0
EPO| writer++ -1/1
TLS| writeHandshake (encrypted)
TLS| HS.next_fragment ID13?
HS | next_fragment
HS | prepare Server Finished
HSL| emit EncryptedExtensions and hash
HSL| emit Finished and hash
KS | ks_server_13_sf hashed_log = fa72958b581cf029264413154013191d7f6768e43a2c86c2c7de486290fb1eff
KS | application traffic secret[C]:   64bfaab0c70e29cfe317c9f62de469990302e6e05bd450a6677e7aa3ecbde23e
KS | application traffic secret[S]:   02acbe3215f016ea8a0aad7cf07e8959fe840af1419187583426f36599958c6a
KS | exporter master secret:          134e6da66b6bb617db430d3bdb01f51324128095d5e163588a7414c7b19a91ed
KS | application key[C]:              bd225a85ed3dfd167a1625b2b344008ec9d87e7e4528b67fbc2db4107dc3541e, IV=6a07540f01b8444fbf2c05f8
KS | application key[S]:              46baf7203002e7d1fd2c92b20ad76280e7b7bbbaf251378339cdafe97a5a06d2, IV=12490b684c3fd048229f1b60
AEP| LowProvider: COERCE(K=46baf7203002e7d1fd2c92b20ad76280e7b7bbbaf251378339cdafe97a5a06d2)
AEP| LowProvider: COERCE(K=bd225a85ed3dfd167a1625b2b344008ec9d87e7e4528b67fbc2db4107dc3541e)
HS | exporting a key
EPO| reader++ 0/1
TLS| HS.next_fragment returned a fragment; next_keys (for all data)
TLS| sendHandshake
TLS| send Handshake fragment with index ID13
TLS| Encrypting with key 06e6e1f8ea67ac95ba1d9b764743435be8db1de10e14d916544b9401e5df57ee
TLS| Sending fragment of length 90
REC| record headers: 170303005a
EPO| writer++ 0/2
TLS| read: WrittenHS, Ctrl/Open, new writer: writable
server returns server_accept_early_data clen=302 slen=196
early secret=54a9d2a2cb14541d766e23512b55b62c6d41a172754108902e58d6e617ac2bef
secret=134e6da66b6bb617db430d3bdb01f51324128095d5e163588a7414c7b19a91ed
<---- ServerHello;(EncryptedExtensions; Certificate; CertVerify; Finished)[ 196]

TLS| writeHandshake (encrypted)
TLS| HS.next_fragment ID13?
HS | next_fragment
TLS| HS.next_fragment returned nothing
TLS| sendHandshake
TLS| read: WrittenHS, Ctrl/Open, nothing
TLS| Read fragment at epoch index: -1 of length 96
TLS| read Handshake fragment
HS | recv_fragment
HSL| parsed ServerHello
HSL| end of flight
HS | client_ServerHello
NGO| processing server extensions [ supported_versions key_share pre_shared_key ]
NGO| negotiated 1.3 TLS_CHACHA20_POLY1305_SHA256
HS | Running TLS 1.3
KS | ks_client_13_sh hashed_log = 3928eef1293cce85a1911a20239f07943d3d79593ad8b925c18a665ddc8a5ae4
KS | recallPSK early secret:          90f25bddf7056a6a41b4c1ed8cc1da77b181d057a8330f4898aba76bf2931374
KS | handshake salt:                  d0f70c06372f8f7ffcc4fe517996677ff8efa83628c2ff37e0a83cd91da39869
CDH| DH initiator on X255519
KS | DH shared secret: fd9b649e275cbb0b8a1a237eb64700bdbb7a0c2340ff364cc5b5b0d20468e94b
KS | handshake secret:                62e26f6c9b7a716077f1f2f12b454af80e3267e8d6cfdee13ca9f3161e29d5bd
KS | handshake traffic secret[C]:     1e0e2a4b71e52aee185cf8ff4e9aee5d19f8fafe01ba8da794001fae6c0040ef
KS | handshake traffic secret[S]:     9747ec456efa0353fd0772b24c2657b506604e8587e4f1d0c775ba378f480144
KS | handshake key[C]:                ae7fa967d5c88c4c647a197af96901019cefafae10be1877a75ac6c9537c0625, IV=d7aaf5a3db2cde99f3b4f390
KS | handshake key[S]:                06e6e1f8ea67ac95ba1d9b764743435be8db1de10e14d916544b9401e5df57ee, IV=7e073d8109f597248c264d88
KS | finished key[C]: 5ae6e6758f2dc27bb6f1bde9c1d3dd07d7696645141b560d93a004502e11e7a9
KS | finished key[S]: 2fdbaf1715cb0e20faf7df1622ea70d066b3660dae4e7e8f219181540a02fe0f
KS | application salt:                70dfbedeffc80b753a25333f3e02813f850cee337377be841f38615b126c71c0
KS | application secret:              b2425f95356f8299e9ad05f8a79a17d2ea3f075f53d4fe33ad4f1ec7146def79
AEP| LowProvider: COERCE(K=ae7fa967d5c88c4c647a197af96901019cefafae10be1877a75ac6c9537c0625)
AEP| LowProvider: COERCE(K=06e6e1f8ea67ac95ba1d9b764743435be8db1de10e14d916544b9401e5df57ee)
HS | 0RTT potentially accepted (wait for EE to confirm)
EPO| reader++ 0/0
EPO| reader++ 1/0
TLS| readOne ReadAgain
TLS| writeHandshake (encrypted)
TLS| HS.next_fragment ID13?
HS | next_fragment
TLS| HS.next_fragment returned nothing
TLS| sendHandshake
TLS| read: WrittenHS, Ctrl/Open, nothing
TLS| Read fragment at epoch index: 1 of length 90
TLS| StAE decrypt correct.
TLS| read Handshake fragment
HS | recv_fragment
HSL| parsed EncryptedExtensions
HSL| parsed Finished
HSL| end of flight
NGO| Nego.clientComplete_13
NGO| EE: alpn supported_groups early_data 001a 
NGO| Negotiation callback to process application extensions.
@@@@ Nego callback for TLS 1.3 @@@@
Offered extensions:
001b0010000800060568712d3130000a00040002001d001a0003000102
Transport parameters offered:
000102
No application cookie (fist connection).
Adding server transport parameters:
000102
@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
NGO| Certificate & signature 1.3 callback result: valid
KS | ks_client_13_sf hashed_log = fa72958b581cf029264413154013191d7f6768e43a2c86c2c7de486290fb1eff
KS | application traffic secret[C]:   64bfaab0c70e29cfe317c9f62de469990302e6e05bd450a6677e7aa3ecbde23e
KS | application traffic secret[S]:   02acbe3215f016ea8a0aad7cf07e8959fe840af1419187583426f36599958c6a
KS | exporter master secret:          134e6da66b6bb617db430d3bdb01f51324128095d5e163588a7414c7b19a91ed
KS | application key[C]:              bd225a85ed3dfd167a1625b2b344008ec9d87e7e4528b67fbc2db4107dc3541e, IV=6a07540f01b8444fbf2c05f8
KS | application key[S]:              46baf7203002e7d1fd2c92b20ad76280e7b7bbbaf251378339cdafe97a5a06d2, IV=12490b684c3fd048229f1b60
AEP| LowProvider: COERCE(K=bd225a85ed3dfd167a1625b2b344008ec9d87e7e4528b67fbc2db4107dc3541e)
AEP| LowProvider: COERCE(K=46baf7203002e7d1fd2c92b20ad76280e7b7bbbaf251378339cdafe97a5a06d2)
HS | exporting a key
HS | Early data accepted; emitting EOED.
HSL| emit EndOfEarlyData and hash
TLS| readOne ReadAgain
TLS| writeHandshake (encrypted)
TLS| HS.next_fragment ID13?
HS | next_fragment
TLS| HS.next_fragment returned a fragment; next_keys (for handshake only
TLS| sendHandshake
TLS| send Handshake fragment with index ID13
TLS| Encrypting with key 95a84e85369b5fe77eec4bca12f2ba3967e23bb9f2a594def9856b6c1a1bdb0c
TLS| Sending fragment of length 21
REC| record headers: 1703030015
EPO| writer++ 1/1
TLS| writeHandshake (encrypted)
TLS| HS.next_fragment ID13?
HS | next_fragment
HSL| emit Finished and hash
KS | ks_client_13_cf hashed_log = 8e0aebced42c1821a8c5fb348c674c30aa67b3239007026dd2e70a8fadc56aa3
KS | resumption master secret:        49f1b989d9865c97a5076638c96ddc9ab11233e22da4469fd682c5cf844bed27
EPO| reader++ 2/1
TLS| HS.next_fragment returned a fragment; next_keys (for all data); complete
TLS| sendHandshake
TLS| send Handshake fragment with index ID13
TLS| Encrypting with key ae7fa967d5c88c4c647a197af96901019cefafae10be1877a75ac6c9537c0625
TLS| Sending fragment of length 53
REC| record headers: 1703030035
EPO| writer++ 2/2
TLS| read: WrittenHS, Open/Open, new writer: complete
client returns client_complete_early_data clen=84 slen=196
secret=134e6da66b6bb617db430d3bdb01f51324128095d5e163588a7414c7b19a91ed
(Finished) [  84] ---->

TLS| writeHandshake (encrypted)
TLS| HS.next_fragment ID13?
HS | next_fragment
TLS| HS.next_fragment returned nothing
TLS| sendHandshake
TLS| read: WrittenHS, Ctrl/Open, nothing
TLS| Read fragment at epoch index: 0 of length 21
TLS| StAE decrypt correct.
TLS| read Handshake fragment
HS | recv_fragment
HSL| parsed EndOfEarlyData
HSL| end of flight
HS | Process EOED (increment reader to HS key)
EPO| reader++ 1/2
TLS| readOne ReadAgain
TLS| writeHandshake (encrypted)
TLS| HS.next_fragment ID13?
HS | next_fragment
TLS| HS.next_fragment returned nothing
TLS| sendHandshake
TLS| read: WrittenHS, Ctrl/Open, nothing
TLS| Read fragment at epoch index: 1 of length 53
TLS| StAE decrypt correct.
TLS| read Handshake fragment
HS | recv_fragment
HSL| parsed Finished
HSL| end of flight
HS | Process Client Finished
KS | ks_server_13_cf hashed_log = 8e0aebced42c1821a8c5fb348c674c30aa67b3239007026dd2e70a8fadc56aa3
KS | resumption master secret:        49f1b989d9865c97a5076638c96ddc9ab11233e22da4469fd682c5cf844bed27
HS | Sending ticket: 87141079bb93faacd2036b0a133338cd877441b8e32b7a575b0789ba4f0ad60a27993c74cb4c3e79657c7506f8b5d235daffbfa0067e8527f7ef4db4d260068fd7ce22bef0653791186b0c56
HSL| emit NewSessionTicket13
EPO| reader++ 2/2
TLS| readOne Complete
server returns clen=84 slen=0 status=server_complete
TLS| writeHandshake (encrypted)
TLS| HS.next_fragment ID13?
HS | next_fragment
TLS| HS.next_fragment returned a fragment
TLS| sendHandshake
TLS| send Handshake fragment with index ID13
TLS| Encrypting with key 46baf7203002e7d1fd2c92b20ad76280e7b7bbbaf251378339cdafe97a5a06d2
TLS| Sending fragment of length 130
REC| record headers: 1703030082
TLS| writeHandshake (encrypted)
TLS| HS.next_fragment ID13?
HS | next_fragment
TLS| HS.next_fragment returned nothing
TLS| sendHandshake
TLS| read: WrittenHS, Open/Open, nothing
REC| WouldBlock
TLS| readOne ReadWouldBlock
server returns would_block clen=0 slen=135
<---- {Ticket}[ 135]
TLS| writeHandshake (encrypted)
TLS| HS.next_fragment ID13?
HS | next_fragment
TLS| HS.next_fragment returned nothing
TLS| sendHandshake
TLS| read: WrittenHS, Open/Open, nothing
TLS| Read fragment at epoch index: 2 of length 130
TLS| StAE decrypt correct.
TLS| read Handshake fragment
HS | recv_fragment
HSL| parsed NewSessionTicket13
HSL| end of flight
HS | Received ticket: 87141079bb93faacd2036b0a133338cd877441b8e32b7a575b0789ba4f0ad60a27993c74cb4c3e79657c7506f8b5d235daffbfa0067e8527f7ef4db4d260068fd7ce22bef0653791186b0c56
KS | ks_client_13_rms
KS | Recall RMS: 49f1b989d9865c97a5076638c96ddc9ab11233e22da4469fd682c5cf844bed27

##### New session ticket received! #####
Host: localhost
Ticket:
87141079bb93faacd2036b0a133338cd877441b8e32b7a575b0789ba4f0ad60a
27993c74cb4c3e79657c7506f8b5d235daffbfa0067e8527f7ef4db4d260068f
d7ce22bef0653791186b0c56
########################################
TLS| readOne ReadAgain
TLS| writeHandshake (encrypted)
TLS| HS.next_fragment ID13?
HS | next_fragment
TLS| HS.next_fragment returned nothing
TLS| sendHandshake
TLS| read: WrittenHS, Open/Open, nothing
REC| WouldBlock
TLS| readOne ReadWouldBlock
client returns clen=0 slen=135 status=would_block
Ok
./quic.exe hrr

STATELESS RETRY TEST

server create
FFI| offering custom extension 001a
FFI| extension contents: ffff00050a0b0c0d0e
FFI| setting early data limit to ffffffff
FFI| Setting a new ticket callback.
FFI| Setting a new server negotiation callback.
FFI| Setting up certificate callbacks.
client create
FFI| offering custom extension 001a
FFI| extension contents: ffff00050a0b0c0d0e
FFI| setting early data limit to ffffffff
FFI| Setting a new ticket callback.
FFI| Setting a new server negotiation callback.
FFI| Setting up certificate callbacks.
TLS| writeHandshake (plaintext)
TLS| HS.next_fragment PlaintextID?
HS | next_fragment
HS | offering ClientHello 1.3
KS | ks_client_init 1.3
CDH| Keygen (initiator) on X255519
NGO| No PSK or 0-RTT disabled
NGO| offering client extensions [ 001a supported_versions key_share server_name alpn extended_master_secret signature_algorithms supported_groups psk_key_exchange_modes ]
NGO| offering cipher suites ; TLS_CHACHA20_POLY1305_SHA256; TLS_AES_128_GCM_SHA256
HSL| emit ClientHello
TLS| HS.next_fragment returned a fragment
TLS| sendHandshake
TLS| send Handshake fragment with index PlaintextID
TLS| Sending fragment of length 170
REC| record headers: 16030300aa
TLS| writeHandshake (plaintext)
TLS| HS.next_fragment PlaintextID?
HS | next_fragment
TLS| HS.next_fragment returned nothing
TLS| sendHandshake
TLS| read: WrittenHS, Ctrl/Ctrl, nothing
REC| WouldBlock
TLS| readOne ReadWouldBlock
client returns would_block clen=175 slen=0
ClientHello[ 175] ---->

~~~~~~~~~ Client Hello Summary ~~~~~~~~~~~
~ SNI = localhost
~ ALPN = 00060568712d3130
~ Cookie = NULL
~ Extensions = 0079001a0009ffff00050a0b0c0d0e002b0003027f1c003300260024001d0020
8393d1c5d702bc91fbeecd56842c30df9ea05c23cbbc6a80904f029b793f6833
0000000e000c0000096c6f63616c686f73740010000800060568712d31300017
0000000d0006000408040403000a00040002001d002d0003020001
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
TLS| writeHandshake (plaintext)
TLS| HS.next_fragment PlaintextID?
HS | next_fragment
TLS| HS.next_fragment returned nothing
TLS| sendHandshake
TLS| read: WrittenHS, Ctrl/Ctrl, nothing
TLS| Read fragment at epoch index: -1 of length 170
TLS| read Handshake fragment
HS | recv_fragment
HSL| parsed [ClientHello] -- end of flight 
HS | Processing ClientHello
NGO| offered client extensions [ 001a supported_versions key_share server_name alpn extended_master_secret signature_algorithms supported_groups psk_key_exchange_modes ]
NGO| offered cipher suites ; TLS_CHACHA20_POLY1305_SHA256; TLS_AES_128_GCM_SHA256
NGO| offered versions 1.3
NGO| Negotiated Pure EDH key exchange
NGO| Negotiated ECDSA_SECP256R1_SHA256
NGO| Negotiation callback to handle extra extensions and query for stateless retry.
NGO| Application data in cookie: none
@@@@ Nego callback for TLS 1.3 @@@@
Offered extensions:
003d001a0009ffff00050a0b0c0d0e0000000e000c0000096c6f63616c686f73
740010000800060568712d3130000d0006000408040403000a00040002001d
Transport parameters offered:
ffff00050a0b0c0d0e
No application cookie (fist connection).
Adding server transport parameters:
000102
@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
AEP| LowProvider: COERCE(K=4d5654de025e77a4a21ac5212f32dbd5595e4234aadf0d1f0ac18196700cf78d)
TCK| Encrypting cookie: 0000320200002e0303cf21ad74e59a6111be1d8c021e65b891c2a211167abb8c5e079e09e2c8a8339c001303000006002b00027f1c2035cc33898ad1ed55832144239f0de6ce7ef7a8fe9ee2f4ed4e164659f1c6aaaa000b48656c6c6f20576f726c64
TCK| Encrypted cookie:  45d520b23eab5c31e726b13f8d874c1cfcd05b0b8ec861657f2808537f415628c44d54eaa3e25aad43476d5e3097c098f1cffff7ca35772008b6e91abe9df204d68a476d549e11ce7b13666431f78251eba78cc1edc2bbe6d37119737f3f50c4e161b1cb4d0fa25c54b0d3d1467336f4613a26551ebd281a50105fcd15bebd
HSL| emit HelloRetryRequest
TLS| readOne ReadAgain
TLS| writeHandshake (plaintext)
TLS| HS.next_fragment PlaintextID?
HS | next_fragment
TLS| HS.next_fragment returned a fragment
TLS| sendHandshake
TLS| send Handshake fragment with index PlaintextID
TLS| Sending fragment of length 183
REC| record headers: 16030300b7
TLS| writeHandshake (plaintext)
TLS| HS.next_fragment PlaintextID?
HS | next_fragment
TLS| HS.next_fragment returned nothing
TLS| sendHandshake
TLS| read: WrittenHS, Ctrl/Ctrl, nothing
REC| WouldBlock
TLS| readOne ReadWouldBlock
server returns server_stateless_retry clen=175 slen=188
<---- HRR[ 188]

server re-create
FFI| offering custom extension 001a
FFI| extension contents: ffff00050a0b0c0d0e
FFI| setting early data limit to ffffffff
FFI| Setting a new ticket callback.
FFI| Setting a new server negotiation callback.
FFI| Setting up certificate callbacks.
TLS| writeHandshake (plaintext)
TLS| HS.next_fragment PlaintextID?
HS | next_fragment
TLS| HS.next_fragment returned nothing
TLS| sendHandshake
TLS| read: WrittenHS, Ctrl/Ctrl, nothing
TLS| Read fragment at epoch index: -1 of length 183
TLS| read Handshake fragment
HS | recv_fragment
HSL| parsed HelloRetryRequest
HSL| end of flight
HSL| Replacing CH1 in transcript with fe00002035cc33898ad1ed55832144239f0de6ce7ef7a8fe9ee2f4ed4e164659f1c6aaaa
HSL| HRR bytes: 020000b30303cf21ad74e59a6111be1d8c021e65b891c2a211167abb8c5e079e09e2c8a8339c00130300008b002c0081007f45d520b23eab5c31e726b13f8d874c1cfcd05b0b8ec861657f2808537f415628c44d54eaa3e25aad43476d5e3097c098f1cffff7ca35772008b6e91abe9df204d68a476d549e11ce7b13666431f78251eba78cc1edc2bbe6d37119737f3f50c4e161b1cb4d0fa25c54b0d3d1467336f4613a26551ebd281a50105fcd15bebd002b00027f1c
HS | client_HelloRetryRequest
HS | Server did not specify a group in HRR, re-using the previous choice
NGO| Got HRR, extensions: [cookie supported_versions ]
HSL| emit ClientHello
TLS| readOne ReadAgain
TLS| writeHandshake (plaintext)
TLS| HS.next_fragment PlaintextID?
HS | next_fragment
TLS| HS.next_fragment returned a fragment
TLS| sendHandshake
TLS| send Handshake fragment with index PlaintextID
TLS| Sending fragment of length 303
REC| record headers: 160303012f
TLS| writeHandshake (plaintext)
TLS| HS.next_fragment PlaintextID?
HS | next_fragment
TLS| HS.next_fragment returned nothing
TLS| sendHandshake
TLS| read: WrittenHS, Ctrl/Ctrl, nothing
REC| WouldBlock
TLS| readOne ReadWouldBlock
client returns would_block clen=308 slen=188
ClientHello2[ 308] ---->

TCK| Decrypting cookie 45d520b23eab5c31e726b13f8d874c1cfcd05b0b8ec861657f2808537f415628c44d54eaa3e25aad43476d5e3097c098f1cffff7ca35772008b6e91abe9df204d68a476d549e11ce7b13666431f78251eba78cc1edc2bbe6d37119737f3f50c4e161b1cb4d0fa25c54b0d3d1467336f4613a26551ebd281a50105fcd15bebd
TCK| Plain cookie: 0000320200002e0303cf21ad74e59a6111be1d8c021e65b891c2a211167abb8c5e079e09e2c8a8339c001303000006002b00027f1c2035cc33898ad1ed55832144239f0de6ce7ef7a8fe9ee2f4ed4e164659f1c6aaaa000b48656c6c6f20576f726c64
~~~~~~~~~ Client Hello Summary ~~~~~~~~~~~
~ SNI = localhost
~ ALPN = 00060568712d3130
~ Cookie = 48656c6c6f20576f726c64
~ Extensions = 00fe002c0081007f45d520b23eab5c31e726b13f8d874c1cfcd05b0b8ec86165
7f2808537f415628c44d54eaa3e25aad43476d5e3097c098f1cffff7ca357720
08b6e91abe9df204d68a476d549e11ce7b13666431f78251eba78cc1edc2bbe6
d37119737f3f50c4e161b1cb4d0fa25c54b0d3d1467336f4613a26551ebd281a
50105fcd15bebd001a0009ffff00050a0b0c0d0e002b0003027f1c0033002600
24001d00208393d1c5d702bc91fbeecd56842c30df9ea05c23cbbc6a80904f02
9b793f68330000000e000c0000096c6f63616c686f7374001000080006056871
2d313000170000000d0006000408040403000a00040002001d002d0003020001
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
TLS| writeHandshake (plaintext)
TLS| HS.next_fragment PlaintextID?
HS | next_fragment
TLS| HS.next_fragment returned nothing
TLS| sendHandshake
TLS| read: WrittenHS, Ctrl/Ctrl, nothing
TLS| Read fragment at epoch index: -1 of length 303
TLS| read Handshake fragment
HS | recv_fragment
HSL| parsed [ClientHello] -- end of flight 
HS | Processing ClientHello
NGO| offered client extensions [ cookie 001a supported_versions key_share server_name alpn extended_master_secret signature_algorithms supported_groups psk_key_exchange_modes ]
NGO| offered cipher suites ; TLS_CHACHA20_POLY1305_SHA256; TLS_AES_128_GCM_SHA256
NGO| offered versions 1.3
NGO| Negotiated Pure EDH key exchange
NGO| Negotiated ECDSA_SECP256R1_SHA256
TCK| Decrypting cookie 45d520b23eab5c31e726b13f8d874c1cfcd05b0b8ec861657f2808537f415628c44d54eaa3e25aad43476d5e3097c098f1cffff7ca35772008b6e91abe9df204d68a476d549e11ce7b13666431f78251eba78cc1edc2bbe6d37119737f3f50c4e161b1cb4d0fa25c54b0d3d1467336f4613a26551ebd281a50105fcd15bebd
TCK| Plain cookie: 0000320200002e0303cf21ad74e59a6111be1d8c021e65b891c2a211167abb8c5e079e09e2c8a8339c001303000006002b00027f1c2035cc33898ad1ed55832144239f0de6ce7ef7a8fe9ee2f4ed4e164659f1c6aaaa000b48656c6c6f20576f726c64
NGO| Loaded stateless retry cookie 45d520b23eab5c31e726b13f8d874c1cfcd05b0b8ec861657f2808537f415628c44d54eaa3e25aad43476d5e3097c098f1cffff7ca35772008b6e91abe9df204d68a476d549e11ce7b13666431f78251eba78cc1edc2bbe6d37119737f3f50c4e161b1cb4d0fa25c54b0d3d1467336f4613a26551ebd281a50105fcd15bebd
NGO| Overwriting the transcript digest with CH1 hash 35cc33898ad1ed55832144239f0de6ce7ef7a8fe9ee2f4ed4e164659f1c6aaaa
HSL| Installing prefix to transcript: fe00002035cc33898ad1ed55832144239f0de6ce7ef7a8fe9ee2f4ed4e164659f1c6aaaa
HSL| HRR bytes: 020000b30303cf21ad74e59a6111be1d8c021e65b891c2a211167abb8c5e079e09e2c8a8339c00130300008b002c0081007f45d520b23eab5c31e726b13f8d874c1cfcd05b0b8ec861657f2808537f415628c44d54eaa3e25aad43476d5e3097c098f1cffff7ca35772008b6e91abe9df204d68a476d549e11ce7b13666431f78251eba78cc1edc2bbe6d37119737f3f50c4e161b1cb4d0fa25c54b0d3d1467336f4613a26551ebd281a50105fcd15bebd002b00027f1c
NGO| Negotiation callback to handle extra extensions and query for stateless retry.
NGO| Application data in cookie: 48656c6c6f20576f726c64
@@@@ Nego callback for TLS 1.3 @@@@
Offered extensions:
003d001a0009ffff00050a0b0c0d0e0000000e000c0000096c6f63616c686f73
740010000800060568712d3130000d0006000408040403000a00040002001d
Transport parameters offered:
ffff00050a0b0c0d0e
Stateless cookie found, application contents:
48656c6c6f20576f726c64
Adding server transport parameters:
000102
@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
NGO| negotiated 1.3 TLS_CHACHA20_POLY1305_SHA256
KS | ks_server_init
KS | No PSK selected.
KS | Computed early secret:           33ad0a1c607ec03b09e6cd9893680ce210adf300aa1f2660e1b22e10f170f92a
KS | Handshake salt:                  6f2615a108c702c5678f54fc9dbab69716c076189c48250cebeac3576c3611ba
CDH| Keygen (responder) on X255519
CDH| DH initiator on X255519
KS | DH shared secret: 4dcf51434dd0a81c9860388a43909b08e8eb4fd92cfd24089ffee24dc00a081f
KS | Handshake secret:                0c00b7000f368c9d8285fc6196512cf01399f9e2f015db77e733421065a4fb0c
NGO| processing client extensions [ cookie 001a supported_versions key_share server_name alpn extended_master_secret signature_algorithms supported_groups psk_key_exchange_modes ]
NGO| including server extensions (SH + EE) [ supported_versions key_share alpn supported_groups ]
NGO| extra extensions from application callback: 001a 
HSL| emit ServerHello and hash
HS | derive handshake keys
KS | ks_server_13_sh, hashed log = ed778ade702842b26271d33f8871c30d0e89dbbdf67ceb725baff6039f470c3c
KS | handshake traffic secret[C]:     bff5403b22eee5c33977a5a6f9e04ee8414585685f7d42d1701515a6bfc65ddf
KS | handshake traffic secret[S]:     d2d64801560922eab2a80898596710ca521e6a59878f051705ae8df6002e95d8
KS | handshake key[C]:                13fcc2db33494fe1d3511b7d58694ef44a5636cc7f1fcf6317dada7ab6855052, IV=7c6fe436c0c4693ac5966ddc
KS | handshake key[S]: e559b961cebee647a8c6427569932faa09866548f63e760718fe7fbee9cdbca9, IV=a7b39484a07893fc8c82538b
AEP| LowProvider: COERCE(K=e559b961cebee647a8c6427569932faa09866548f63e760718fe7fbee9cdbca9)
AEP| LowProvider: COERCE(K=13fcc2db33494fe1d3511b7d58694ef44a5636cc7f1fcf6317dada7ab6855052)
KS | finished key[C]:                 f6e3108e21ff52a9213a58f21cfbd197412088519131ca19adbe1cf4fdd5f8b0
KS | finished key[S]:                 6987c3e64d45c68ef7eb7c0e3132ae32b27cf6eb75326f601b2bdeb2a818c623
KS | Application salt:                b50c486eac64a7b90ab624105f3e3c7e59c86a5d9ae42d52e9ae8d4566d00dd2
KS | Application secret:              8d5f18c533dcc88f8c480cfbeb3ea50effc145218140438c9a32d6e895bd5d52
TLS| readOne ReadAgain
TLS| writeHandshake (plaintext)
TLS| HS.next_fragment PlaintextID?
HS | next_fragment
TLS| HS.next_fragment returned a fragment; next_keys (for handshake only
TLS| sendHandshake
TLS| send Handshake fragment with index PlaintextID
TLS| Sending fragment of length 90
REC| record headers: 160303005a
EPO| writer++ -1/0
TLS| writeHandshake (encrypted)
TLS| HS.next_fragment ID13?
HS | next_fragment
HS | prepare Server Finished
HSL| emit EncryptedExtensions
HSL| emit Certificate13 and hash
======== TO BE SIGNED <0403>: (130 octets) ========
2020202020202020202020202020202020202020202020202020202020202020
2020202020202020202020202020202020202020202020202020202020202020
544c5320312e332c207365727665722043657274696669636174655665726966
7900ebedb75b782569b9075087a6cf74f11fdd6319c5e58253dd7b99dc65b51d
2b73
===================================================
HSL| emit CertificateVerify and hash
HSL| emit Finished and hash
KS | ks_server_13_sf hashed_log = b149c7fceca09f708dca20a69696a9e06214800df58d193d60e806ced5c56809
KS | application traffic secret[C]:   98e6ee346d903d919e0898b824c8132ddb1f099f84d874ec05b996e33e086013
KS | application traffic secret[S]:   fcd6f016953e7960adf93e3206cadff60a5fb9a30b139f9e8f4f5ce5675c48ad
KS | exporter master secret:          b5d7e6e4cdb04162841fa56a17341b63522fda97b74df3dd6ab8a4f6fe4606f8
KS | application key[C]:              1282f65d1268cef763736a774b5a2bd4bf8c4c9baaa14c8855904385fd465a89, IV=3cfd5f25127367c9d969d112
KS | application key[S]:              b41412a992941a84796c0bbd6567df74eb261c28e1fd9bc5b98377d3f400ff3e, IV=05ccf592a2d5dad187da2a9a
AEP| LowProvider: COERCE(K=b41412a992941a84796c0bbd6567df74eb261c28e1fd9bc5b98377d3f400ff3e)
AEP| LowProvider: COERCE(K=1282f65d1268cef763736a774b5a2bd4bf8c4c9baaa14c8855904385fd465a89)
HS | exporting a key
EPO| reader++ 0/0
TLS| HS.next_fragment returned a fragment; next_keys (for all data)
TLS| sendHandshake
TLS| send Handshake fragment with index ID13
TLS| Encrypting with key e559b961cebee647a8c6427569932faa09866548f63e760718fe7fbee9cdbca9
TLS| Sending fragment of length 734
REC| record headers: 17030302de
EPO| writer++ 0/1
TLS| read: WrittenHS, Ctrl/Open, new writer: writable
server returns server_accept clen=308 slen=834
secret=b5d7e6e4cdb04162841fa56a17341b63522fda97b74df3dd6ab8a4f6fe4606f8
<---- ServerHello;(EncryptedExtensions; Certificate; CertVerify; Finished)[ 834]

TLS| writeHandshake (plaintext)
TLS| HS.next_fragment PlaintextID?
HS | next_fragment
TLS| HS.next_fragment returned nothing
TLS| sendHandshake
TLS| read: WrittenHS, Ctrl/Ctrl, nothing
TLS| Read fragment at epoch index: -1 of length 90
TLS| read Handshake fragment
HS | recv_fragment
HSL| parsed ServerHello
HSL| end of flight
HS | client_ServerHello
NGO| processing server extensions [ supported_versions key_share ]
NGO| negotiated 1.3 TLS_CHACHA20_POLY1305_SHA256
HS | Running TLS 1.3
KS | ks_client_13_sh hashed_log = ed778ade702842b26271d33f8871c30d0e89dbbdf67ceb725baff6039f470c3c
KS | no PSK negotiated. Early secret: 33ad0a1c607ec03b09e6cd9893680ce210adf300aa1f2660e1b22e10f170f92a
KS | handshake salt:                  6f2615a108c702c5678f54fc9dbab69716c076189c48250cebeac3576c3611ba
CDH| DH initiator on X255519
KS | DH shared secret: 4dcf51434dd0a81c9860388a43909b08e8eb4fd92cfd24089ffee24dc00a081f
KS | handshake secret:                0c00b7000f368c9d8285fc6196512cf01399f9e2f015db77e733421065a4fb0c
KS | handshake traffic secret[C]:     bff5403b22eee5c33977a5a6f9e04ee8414585685f7d42d1701515a6bfc65ddf
KS | handshake traffic secret[S]:     d2d64801560922eab2a80898596710ca521e6a59878f051705ae8df6002e95d8
KS | handshake key[C]:                13fcc2db33494fe1d3511b7d58694ef44a5636cc7f1fcf6317dada7ab6855052, IV=7c6fe436c0c4693ac5966ddc
KS | handshake key[S]:                e559b961cebee647a8c6427569932faa09866548f63e760718fe7fbee9cdbca9, IV=a7b39484a07893fc8c82538b
KS | finished key[C]: f6e3108e21ff52a9213a58f21cfbd197412088519131ca19adbe1cf4fdd5f8b0
KS | finished key[S]: 6987c3e64d45c68ef7eb7c0e3132ae32b27cf6eb75326f601b2bdeb2a818c623
KS | application salt:                b50c486eac64a7b90ab624105f3e3c7e59c86a5d9ae42d52e9ae8d4566d00dd2
KS | application secret:              8d5f18c533dcc88f8c480cfbeb3ea50effc145218140438c9a32d6e895bd5d52
AEP| LowProvider: COERCE(K=13fcc2db33494fe1d3511b7d58694ef44a5636cc7f1fcf6317dada7ab6855052)
AEP| LowProvider: COERCE(K=e559b961cebee647a8c6427569932faa09866548f63e760718fe7fbee9cdbca9)
EPO| reader++ 0/-1
TLS| readOne ReadAgain
TLS| writeHandshake (plaintext)
TLS| HS.next_fragment PlaintextID?
HS | next_fragment
TLS| HS.next_fragment returned nothing
TLS| sendHandshake
TLS| read: WrittenHS, Ctrl/Ctrl, nothing
TLS| Read fragment at epoch index: 0 of length 734
TLS| StAE decrypt correct.
TLS| read Handshake fragment
HS | recv_fragment
HSL| parsed EncryptedExtensions
HSL| parsed Certificate13
HSL| parsed CertificateVerify
HSL| parsed Finished
HSL| end of flight
NGO| Nego.clientComplete_13
NGO| EE: alpn supported_groups 001a 
NGO| Negotiation callback to process application extensions.
@@@@ Nego callback for TLS 1.3 @@@@
Offered extensions:
001b0010000800060568712d3130000a00040002001d001a0003000102
Transport parameters offered:
000102
No application cookie (fist connection).
Adding server transport parameters:
000102
@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
WARNING: chain validation failed, ignoring.
NGO| Certificate & signature 1.3 callback result: valid
KS | ks_client_13_sf hashed_log = b149c7fceca09f708dca20a69696a9e06214800df58d193d60e806ced5c56809
KS | application traffic secret[C]:   98e6ee346d903d919e0898b824c8132ddb1f099f84d874ec05b996e33e086013
KS | application traffic secret[S]:   fcd6f016953e7960adf93e3206cadff60a5fb9a30b139f9e8f4f5ce5675c48ad
KS | exporter master secret:          b5d7e6e4cdb04162841fa56a17341b63522fda97b74df3dd6ab8a4f6fe4606f8
KS | application key[C]:              1282f65d1268cef763736a774b5a2bd4bf8c4c9baaa14c8855904385fd465a89, IV=3cfd5f25127367c9d969d112
KS | application key[S]:              b41412a992941a84796c0bbd6567df74eb261c28e1fd9bc5b98377d3f400ff3e, IV=05ccf592a2d5dad187da2a9a
AEP| LowProvider: COERCE(K=1282f65d1268cef763736a774b5a2bd4bf8c4c9baaa14c8855904385fd465a89)
AEP| LowProvider: COERCE(K=b41412a992941a84796c0bbd6567df74eb261c28e1fd9bc5b98377d3f400ff3e)
HS | exporting a key
HS | Early data rejected
EPO| writer++ 0/0
HSL| emit Finished and hash
KS | ks_client_13_cf hashed_log = acef2e046bd131bb9694eb54182e1d84d7debedeeb166067f2102c5feb55e1e7
KS | resumption master secret:        15309db522b5bb9a8acab4ffd593845fb0f6b2f47885a174809bd8cfd2e42649
EPO| reader++ 1/0
TLS| readOne ReadAgain
TLS| writeHandshake (encrypted)
TLS| HS.next_fragment ID13?
HS | next_fragment
TLS| HS.next_fragment returned a fragment; next_keys (for all data); complete
TLS| sendHandshake
TLS| send Handshake fragment with index ID13
TLS| Encrypting with key 13fcc2db33494fe1d3511b7d58694ef44a5636cc7f1fcf6317dada7ab6855052
TLS| Sending fragment of length 53
REC| record headers: 1703030035
EPO| writer++ 1/1
TLS| read: WrittenHS, Open/Open, new writer: complete
client returns client_complete clen=58 slen=834
secret=b5d7e6e4cdb04162841fa56a17341b63522fda97b74df3dd6ab8a4f6fe4606f8
(Finished) [  58] ---->

TLS| writeHandshake (encrypted)
TLS| HS.next_fragment ID13?
HS | next_fragment
TLS| HS.next_fragment returned nothing
TLS| sendHandshake
TLS| read: WrittenHS, Ctrl/Open, nothing
TLS| Read fragment at epoch index: 0 of length 53
TLS| StAE decrypt correct.
TLS| read Handshake fragment
HS | recv_fragment
HSL| parsed Finished
HSL| end of flight
HS | Process Client Finished
KS | ks_server_13_cf hashed_log = acef2e046bd131bb9694eb54182e1d84d7debedeeb166067f2102c5feb55e1e7
KS | resumption master secret:        15309db522b5bb9a8acab4ffd593845fb0f6b2f47885a174809bd8cfd2e42649
HS | Sending ticket: 861fd9b3d02066ee920e0818fe63b8fcc258c659c1e6df630e6b1a60caa8f5e80beca5a60eaeec9b1519552af078ddbfb8f169a50996bda31701c0e4c512f1f21d70a3fa70dc9b5dc7685e4b
HSL| emit NewSessionTicket13
EPO| reader++ 1/1
TLS| readOne Complete
server returns server_complete clen=58 slen=0
TLS| writeHandshake (encrypted)
TLS| HS.next_fragment ID13?
HS | next_fragment
TLS| HS.next_fragment returned a fragment
TLS| sendHandshake
TLS| send Handshake fragment with index ID13
TLS| Encrypting with key b41412a992941a84796c0bbd6567df74eb261c28e1fd9bc5b98377d3f400ff3e
TLS| Sending fragment of length 130
REC| record headers: 1703030082
TLS| writeHandshake (encrypted)
TLS| HS.next_fragment ID13?
HS | next_fragment
TLS| HS.next_fragment returned nothing
TLS| sendHandshake
TLS| read: WrittenHS, Open/Open, nothing
REC| WouldBlock
TLS| readOne ReadWouldBlock
server returns would_block clen=0 slen=135
<---- {Ticket}[ 135]
TLS| writeHandshake (encrypted)
TLS| HS.next_fragment ID13?
HS | next_fragment
TLS| HS.next_fragment returned nothing
TLS| sendHandshake
TLS| read: WrittenHS, Open/Open, nothing
TLS| Read fragment at epoch index: 1 of length 130
TLS| StAE decrypt correct.
TLS| read Handshake fragment
HS | recv_fragment
HSL| parsed NewSessionTicket13
HSL| end of flight
HS | Received ticket: 861fd9b3d02066ee920e0818fe63b8fcc258c659c1e6df630e6b1a60caa8f5e80beca5a60eaeec9b1519552af078ddbfb8f169a50996bda31701c0e4c512f1f21d70a3fa70dc9b5dc7685e4b
KS | ks_client_13_rms
KS | Recall RMS: 15309db522b5bb9a8acab4ffd593845fb0f6b2f47885a174809bd8cfd2e42649
AEP| LowProvider: COERCE(K=1e23639c7a62161bcbedfdf1c6abaa104f5b7d185a3e1e620569af19ec9bc7f6)

##### New session ticket received! #####
Host: localhost
Ticket:
861fd9b3d02066ee920e0818fe63b8fcc258c659c1e6df630e6b1a60caa8f5e8
0beca5a60eaeec9b1519552af078ddbfb8f169a50996bda31701c0e4c512f1f2
1d70a3fa70dc9b5dc7685e4b
########################################
TLS| readOne ReadAgain
TLS| writeHandshake (encrypted)
TLS| HS.next_fragment ID13?
HS | next_fragment
TLS| HS.next_fragment returned nothing
TLS| sendHandshake
TLS| read: WrittenHS, Open/Open, nothing
REC| WouldBlock
TLS| readOne ReadWouldBlock
client returns clen=0 slen=135 status=would_block
Ok
make[1]: Leaving directory '/cygdrive/c/build/agent1/_work/13/s/mitls-fstar/apps/quicMinusNet'
make[1]: Entering directory '/cygdrive/c/build/agent1/_work/13/s/mitls-fstar/src/tls'
C:/build/agent1/_work/13/s/FStar/bin/fstar.exe --cache_dir cache/Model --cache_checked_modules --print_z3_statistics --use_hints --query_stats --cache_dir cache/Model --odir extract/Model --extract Nothing --dep full --include C:/build/agent1/_work/13/s/FStar/contrib/CoreCrypto/fst/ --include C:/build/agent1/_work/13/s/hacl-star/secure_api --include C:/build/agent1/_work/13/s/hacl-star/secure_api/utils --include C:/build/agent1/_work/13/s/hacl-star/secure_api/concrete_specializations --include C:/build/agent1/_work/13/s/hacl-star/secure_api/LowCProvider/fst --include C:/build/agent1/_work/13/s/hacl-star/code/curve25519/api --include C:/build/agent1/_work/13/s/hacl-star/code/lib --include C:/build/agent1/_work/13/s/kremlin/include --include C:/build/agent1/_work/13/s/kremlin/kremlib --include ../../libs/ffi --include ../../src/lowparse --include C:/build/agent1/_work/13/s/hacl-star/providers/evercrypt --include ../../src/tls/ideal-flags --include ../../src/tls/concrete-flags/generic --include ./concrete-flags/Debug QUIC.fst Test.Main.fst IV.fst HMAC.UFCMA.fst Token.UF1CMA.fst Pkg.Tree.fst AEAD.Pkg.fst > cache/Model/.depend
sed -i.opt -e "s/cmx/cmo/g" -e "s/source/old/g" cache/Model/.depend
make[1]: Leaving directory '/cygdrive/c/build/agent1/_work/13/s/mitls-fstar/src/tls'
make[1]: Entering directory '/cygdrive/c/build/agent1/_work/13/s/mitls-fstar/src/tls'
C:/build/agent1/_work/13/s/FStar/bin/fstar.exe --cache_dir cache/Kremlin --cache_checked_modules --print_z3_statistics --use_hints --query_stats --cache_dir cache/Kremlin --odir extract/Kremlin --extract '* -DHDB -LowCProvider -FFICallbacks -BufferBytes' --dep full --include C:/build/agent1/_work/13/s/FStar/contrib/CoreCrypto/fst/ --include C:/build/agent1/_work/13/s/hacl-star/secure_api --include C:/build/agent1/_work/13/s/hacl-star/secure_api/utils --include C:/build/agent1/_work/13/s/hacl-star/secure_api/concrete_specializations --include C:/build/agent1/_work/13/s/hacl-star/secure_api/LowCProvider/fst --include C:/build/agent1/_work/13/s/hacl-star/code/curve25519/api --include C:/build/agent1/_work/13/s/hacl-star/code/lib --include C:/build/agent1/_work/13/s/kremlin/include --include C:/build/agent1/_work/13/s/kremlin/kremlib --include ../../libs/ffi --include ../../src/lowparse --include C:/build/agent1/_work/13/s/hacl-star/providers/evercrypt --include ../../src/tls/concrete-flags --include ../../src/tls/concrete-flags/Kremlin --include ./concrete-flags/Debug QUIC.fst Test.Main.fst > cache/Kremlin/.depend
sed -i.opt -e "s/cmx/cmo/g" -e "s/source/old/g" cache/Kremlin/.depend
make[1]: Leaving directory '/cygdrive/c/build/agent1/_work/13/s/mitls-fstar/src/tls'
make[1]: Entering directory '/cygdrive/c/build/agent1/_work/13/s/mitls-fstar/src/tls'
C:/build/agent1/_work/13/s/FStar/bin/fstar.exe --cache_dir cache/OCaml --cache_checked_modules --print_z3_statistics --use_hints --query_stats --cache_dir cache/OCaml --odir extract/OCaml --extract '* -Prims -FStar +FStar.Test +FStar.Kremlin.Endianness -CoreCrypto -CryptoTypes -EverCrypt.Bytes -EverCrypt -DHDB -LowCProvider -HaclProvider -FFICallbacks -Crypto.AEAD -Crypto.Symmetric -Crypto.Plain -Spec.Loops -Buffer.Utils -C +C.Loops -LowParse.SLow.Tac -BufferBytes' --dep full --include C:/build/agent1/_work/13/s/FStar/contrib/CoreCrypto/fst/ --include C:/build/agent1/_work/13/s/hacl-star/secure_api --include C:/build/agent1/_work/13/s/hacl-star/secure_api/utils --include C:/build/agent1/_work/13/s/hacl-star/secure_api/concrete_specializations --include C:/build/agent1/_work/13/s/hacl-star/secure_api/LowCProvider/fst --include C:/build/agent1/_work/13/s/hacl-star/code/curve25519/api --include C:/build/agent1/_work/13/s/hacl-star/code/lib --include C:/build/agent1/_work/13/s/kremlin/include --include C:/build/agent1/_work/13/s/kremlin/kremlib --include ../../libs/ffi --include ../../src/lowparse --include C:/build/agent1/_work/13/s/hacl-star/providers/evercrypt --include ../../src/tls/concrete-flags --include ../../src/tls/concrete-flags/OCaml --include ./concrete-flags/Debug QUIC.fst Test.Main.fst > cache/OCaml/.depend
sed -i.opt -e "s/cmx/cmo/g" -e "s/source/old/g" cache/OCaml/.depend
make[1]: Leaving directory '/cygdrive/c/build/agent1/_work/13/s/mitls-fstar/src/tls'
make[1]: Entering directory '/cygdrive/c/build/agent1/_work/13/s/mitls-fstar/src/tls'
echo No verification-specific tests as of yet.
No verification-specific tests as of yet.
make[1]: Leaving directory '/cygdrive/c/build/agent1/_work/13/s/mitls-fstar/src/tls'
EVEREST_WINDOWS=1 make -C extract/Kremlin-Internal-Test test
EVEREST_WINDOWS=1 make -C extract/Kremlin-Library test
make[2]: Nothing to be done for 'test'.
make[2]: 'test' is up to date.
make[1]: Entering directory '/cygdrive/c/build/agent1/_work/13/s/mitls-fstar/src/tls'
OCAMLPATH="C:/build/agent1/_work/13/s/FStar/bin" ocamlfind opt -g -I C:/build/agent1/_work/13/s/FStar/ulib/ml -I extract/OCaml -I C:/build/agent1/_work/13/s/MLCrypto -I ../../libs/ffi -I C:/build/agent1/_work/13/s/hacl-star/secure_api/LowCProvider -I C:/build/agent1/_work/13/s/hacl-star/secure_api/out/runtime_switch/ -I C:/build/agent1/_work/13/s/kremlin/_build/kremlib -I test -I extract/mlstubs -I C:/build/agent1/_work/13/s/hacl-star/providers/evercrypt/ml -I . -package fstarlib,zarith,ctypes,ctypes.foreign -cclib -L../pki -cclib -lmipki \
-cclib -LC:/build/agent1/_work/13/s/hacl-star/providers/out -cclib -levercrypt -linkall \
-linkpkg -g extract/OCaml/BufferBytes.cmx extract/OCaml/Crypto_AEAD_Main.cmx C:/build/agent1/_work/13/s/kremlin/_build/kremlib/C.cmx C:/build/agent1/_work/13/s/MLCrypto/CoreCrypto.cmxa C:/build/agent1/_work/13/s/hacl-star/secure_api/out/runtime_switch/LowC.cmxa ../../libs/ffi/FFICallbacks.cmxa C:/build/agent1/_work/13/s/hacl-star/providers/out/evercrypt.cmxa extract/OCaml/Hashing_Spec.cmx extract/OCaml/Flags.cmx extract/OCaml/TLSError.cmx extract/OCaml/Mem.cmx extract/OCaml/Hashing_OpenSSL.cmx extract/OCaml/Hashing.cmx extract/OCaml/LowParse_Bytes32.cmx extract/OCaml/LowParse_Bytes.cmx extract/OCaml/LowParse_Spec_Base.cmx extract/OCaml/LowParse_Spec_Combinators.cmx extract/OCaml/LowParse_SLow_Base.cmx extract/OCaml/LowParse_SLow_Combinators.cmx extract/OCaml/LowParse_Spec_Enum.cmx extract/OCaml/LowParse_SLow_Enum.cmx extract/OCaml/LowParse_Spec_Sum.cmx extract/OCaml/LowParse_SLow_Sum.cmx extract/OCaml/LowParse_Math.cmx extract/OCaml/FStar_Kremlin_Endianness.cmx extract/OCaml/LowParse_BigEndian.cmx extract/OCaml/LowParse_BigEndianImpl_Base.cmx extract/OCaml/LowParse_BigEndianImpl_SLow.cmx extract/OCaml/LowParse_Spec_FLData.cmx extract/OCaml/LowParse_SLow_FLData.cmx extract/OCaml/LowParse_Spec_VLData.cmx extract/OCaml/LowParse_SLow_VLData.cmx extract/OCaml/LowParse_Spec_Bytes.cmx extract/OCaml/LowParse_SLow_Bytes.cmx extract/OCaml/LowParse_Spec_List.cmx extract/OCaml/LowParse_Spec_Array.cmx extract/OCaml/C_Loops.cmx extract/OCaml/LowParse_SLow_List.cmx extract/OCaml/LowParse_SLow_Array.cmx extract/OCaml/LowParse_Spec_Int_Aux.cmx extract/OCaml/LowParse_Spec_Int.cmx extract/OCaml/LowParse_Spec_Int_Unique.cmx extract/OCaml/LowParse_SLow_Int_Aux.cmx extract/OCaml/LowParse_SLow_Int.cmx extract/OCaml/LowParse_SLow.cmx extract/OCaml/Format_NamedGroup.cmx extract/OCaml/Format_Constants.cmx extract/OCaml/Format_UncompressedPointRepresentation.cmx extract/OCaml/Format_KeyShareEntry.cmx extract/OCaml/Format_ECCurveType.cmx extract/OCaml/TLS_Curve25519.cmx extract/OCaml/Parse.cmx extract/OCaml/ECGroup.cmx extract/OCaml/DHGroup.cmx extract/OCaml/DebugFlags.cmx extract/OCaml/Format_NamedGroupList.cmx extract/OCaml/CommonDH.cmx extract/OCaml/LowParseWrappers.cmx extract/OCaml/QD_TLS_protocolVersion.cmx extract/OCaml/TLSConstants.cmx extract/OCaml/PKI.cmx extract/OCaml/Nonce.cmx extract/OCaml/RSAKey.cmx extract/OCaml/PMS.cmx extract/OCaml/List_Helpers.cmx extract/OCaml/PSK.cmx extract/OCaml/Extensions.cmx extract/OCaml/Cert.cmx extract/OCaml/TLSInfoFlags.cmx extract/OCaml/TLSInfo.cmx extract/OCaml/Crypto_Indexing.cmx extract/OCaml/Flag.cmx extract/OCaml/Specializations_Providers_AEAD.cmx extract/OCaml/AEADOpenssl.cmx extract/OCaml/AEADProvider.cmx extract/OCaml/Range.cmx extract/OCaml/Hashing_CRF.cmx extract/OCaml/HandshakeMessages.cmx extract/OCaml/HandshakeLog.cmx extract/OCaml/HMAC.cmx extract/OCaml/Old_HMAC_UFCMA.cmx extract/OCaml/Test_BufferBytes.cmx extract/OCaml/TLSPRF.cmx extract/OCaml/DataStream.cmx extract/OCaml/Alert.cmx extract/OCaml/Content.cmx extract/OCaml/StreamPlain.cmx extract/OCaml/StreamAE.cmx extract/OCaml/StatefulPlain.cmx extract/OCaml/LHAEPlain.cmx extract/OCaml/AEAD_GCM.cmx extract/OCaml/StatefulLHAE.cmx extract/OCaml/StAE.cmx extract/OCaml/Ticket.cmx extract/OCaml/Old_HKDF.cmx extract/OCaml/Old_KeySchedule.cmx extract/OCaml/FStar_Test.cmx extract/OCaml/Test_CommonDH.cmx extract/OCaml/Negotiation.cmx extract/OCaml/Old_Epochs.cmx extract/OCaml/Old_Handshake.cmx extract/OCaml/Transport.cmx extract/OCaml/Record.cmx extract/OCaml/Connection.cmx extract/OCaml/StreamDeltas.cmx extract/OCaml/TLS.cmx extract/OCaml/FFI.cmx extract/OCaml/QUIC.cmx extract/OCaml/Test_StAE.cmx extract/OCaml/Test_TLSConstants.cmx extract/OCaml/Test_Handshake.cmx extract/OCaml/Test_AEAD.cmx extract/OCaml/Test_Main.cmx extract/OCaml/FFIRegister.cmx C:/build/agent1/_work/13/s/kremlin/kremlib/out/libkremlib.a -o mitls.exe -thread
make[1]: Leaving directory '/cygdrive/c/build/agent1/_work/13/s/mitls-fstar/src/tls'
make[1]: Entering directory '/cygdrive/c/build/agent1/_work/13/s/mitls-fstar/src/tls'
./mitls.exe
make[1]: Leaving directory '/cygdrive/c/build/agent1/_work/13/s/mitls-fstar/src/tls'
+ cd mitls-fstar/apps/cmitls
+ make test
./cmitls.exe google.com 443
cmitls.exe ===================
cmitls.exe calling FFI_mitls_init
cmitls.exe about to act as client or server
===============================================
Starting test client...
FFI| Setting up certificate callbacks.
FFI| Setting a new server negotiation callback.
TLS| writeHandshake (plaintext)
TLS| HS.next_fragment PlaintextID?
HS | next_fragment
HS | offering ClientHello 1.3
KS | ks_client_init 1.3
CDH| Keygen (initiator) on X255519
NGO| No PSK or 0-RTT disabled
NGO| offering client extensions [ supported_versions key_share server_name session_ticket extended_master_secret signature_algorithms ec_point_formats supported_groups psk_key_exchange_modes ]
NGO| offering cipher suites ; TLS_AES_128_GCM_SHA256; TLS_AES_256_GCM_SHA384; TLS_CHACHA20_POLY1305_SHA256; TLS_ECDHE_ECDSA_WITH_AES_128_GCM_SHA256; TLS_ECDHE_RSA_WITH_AES_128_GCM_SHA256; TLS_DHE_RSA_WITH_AES_128_GCM_SHA256; TLS_ECDHE_ECDSA_WITH_AES_256_GCM_SHA384; TLS_ECDHE_RSA_WITH_AES_256_GCM_SHA384; TLS_DHE_RSA_WITH_AES_256_GCM_SHA384; TLS_ECDHE_ECDSA_WITH_CHACHA20_POLY1305_SHA256; TLS_ECDHE_RSA_WITH_CHACHA20_POLY1305_SHA256; TLS_DHE_RSA_WITH_CHACHA20_POLY1305_SHA256
HSL| emit ClientHello
TLS| HS.next_fragment returned a fragment
TLS| sendHandshake
TLS| send Handshake fragment with index PlaintextID
TLS| Sending fragment of length 208
REC| record headers: 16030300d0
TLS| writeHandshake (plaintext)
TLS| HS.next_fragment PlaintextID?
HS | next_fragment
TLS| HS.next_fragment returned nothing
TLS| sendHandshake
TLS| read: WrittenHS, Ctrl/Ctrl, nothing
TLS| Read fragment at epoch index: -1 of length 58
TLS| read Handshake fragment
HS | recv_fragment
HSL| parsed ServerHello
HSL| end of flight
HS | client_ServerHello
NGO| processing server extensions [ extended_master_secret session_ticket ec_point_formats ]
NGO| negotiated 1.2 TLS_ECDHE_ECDSA_WITH_AES_128_GCM_SHA256
HS | Running classic TLS
HS | Offered SID= Server SID=
HS | recv_fragment
HSL| more bytes required
TLS| readOne ReadAgain
TLS| writeHandshake (plaintext)
TLS| HS.next_fragment PlaintextID?
HS | next_fragment
TLS| HS.next_fragment returned nothing
TLS| sendHandshake
TLS| read: WrittenHS, Ctrl/Ctrl, nothing
TLS| Read fragment at epoch index: -1 of length 3072
TLS| read Handshake fragment
HS | recv_fragment
HSL| parsed Certificate
HSL| more bytes required
TLS| readOne ReadAgain
TLS| writeHandshake (plaintext)
TLS| HS.next_fragment PlaintextID?
HS | next_fragment
TLS| HS.next_fragment returned nothing
TLS| sendHandshake
TLS| read: WrittenHS, Ctrl/Ctrl, nothing
TLS| Read fragment at epoch index: -1 of length 116
TLS| read Handshake fragment
HS | recv_fragment
HSL| parsed ServerKeyExchange
HSL| more bytes required
TLS| readOne ReadAgain
TLS| writeHandshake (plaintext)
TLS| HS.next_fragment PlaintextID?
HS | next_fragment
TLS| HS.next_fragment returned nothing
TLS| sendHandshake
TLS| read: WrittenHS, Ctrl/Ctrl, nothing
TLS| Read fragment at epoch index: -1 of length 4
TLS| read Handshake fragment
HS | recv_fragment
HSL| parsed ServerHelloDone
HSL| end of flight
HS | processing ...ServerHelloDone
NGO| ServerKeyExchange signature: Valid
CDH| Keygen (responder) on X255519
CDH| DH initiator on X255519
KS | Share: 7ac692c93b7bfd36ce090e92851cd15105a554dc637bb08dc5dab9ba0f5b6441
KS | Share: eb2117e2967c80c7fa5093cc57718aa7a4916123a0a394a187eca88a90bc8179
KS | PMS: 15bd4fe0433b4e9e6fa57db7402112a70f67d6f89551c8fde1b901e6332e4757
HSL| emit ClientKeyExchange and hash
KS | ks_client_12_set_session_hash hashed_log = 600bfa6d994b167954e8b29054d2ff770004155d28ce44139f8c7f9d6c211ea5
KS | extended master secret:12955fdf7b3dab5ee55bec53c1778409d60414ca00f73e56c25261973fbf1f4a6906525432334550f1a420d3d69611a2
KS | ks_12_record_key
KS | keystring (CK, CIV, SK, SIV) = 65c4a045bfea1a1b0be906233bdb88103dd07a261f08826eba5095a13a7685f54ce49f39920b7000
AEP| LowProvider: COERCE(K=65c4a045bfea1a1b0be906233bdb8810)
AEP| LowProvider: COERCE(K=3dd07a261f08826eba5095a13a7685f5)
HS | digest is 600bfa6d994b167954e8b29054d2ff770004155d28ce44139f8c7f9d6c211ea5
TLS| readOne ReadAgain
TLS| writeHandshake (plaintext)
TLS| HS.next_fragment PlaintextID?
HS | next_fragment
TLS| HS.next_fragment returned a fragment; CCS; next_keys (for handshake only
TLS| sendHandshake
TLS| send Handshake fragment with index PlaintextID
TLS| Sending fragment of length 37
REC| record headers: 1603030025
TLS| send CCS fragment with index PlaintextID
TLS| Sending fragment of length 1
REC| record headers: 1403030001
EPO| writer++ -1/0
TLS| writeHandshake (encrypted)
TLS| HS.next_fragment ID12?
HS | next_fragment
TLS| HS.next_fragment returned a fragment
TLS| sendHandshake
TLS| send Handshake fragment with index ID12
TLS| Sending fragment of length 40
REC| record headers: 1603030028
TLS| writeHandshake (encrypted)
TLS| HS.next_fragment ID12?
HS | next_fragment
TLS| HS.next_fragment returned nothing
TLS| sendHandshake
TLS| read: WrittenHS, Ctrl/Ctrl, new writer: handshake-only
TLS| ignore handshake-specifc key change; calling read again
TLS| writeHandshake (encrypted)
TLS| HS.next_fragment ID12?
HS | next_fragment
TLS| HS.next_fragment returned nothing
TLS| sendHandshake
TLS| read: WrittenHS, Ctrl/Ctrl, nothing
TLS| Read fragment at epoch index: -1 of length 228
TLS| read Handshake fragment
HS | recv_fragment
HSL| parsed NewSessionTicket
HSL| more bytes required
TLS| readOne ReadAgain
TLS| writeHandshake (encrypted)
TLS| HS.next_fragment ID12?
HS | next_fragment
TLS| HS.next_fragment returned nothing
TLS| sendHandshake
TLS| read: WrittenHS, Ctrl/Ctrl, nothing
TLS| Read fragment at epoch index: -1 of length 1
TLS| read CCS fragment
HS | recv_ccs
HS | Processing server CCS (full handshake). Ticket: 00ed68b0f2fb668fca42a23b5b2cf97cec532c05c581c2f8d51e8559b478ee9400e5d75a066bf1b4118fe90f2589e657c6d7efcb7612b033a5f4e2f0203988e2fb2ffb370c54b8bc3d08e7edb9e3318c8a7e798f7d192d52bbe07a6df15067bd96e42bd52f2a1d12fff845a73113fdc78e1788d7678a29db39e6cb1e680934312809656544bda0ce2c3543f78940721f4dececd763fd62908e4929d6c57b6b5e8ba25b6be8ca29b400455ed2c8d2b51d5acecaf092ea66ccbda0ef8460806ddc544d8ed4bdf6492268abc5761d258d42309e0c0d79db17d67748
EPO| reader++ 0/0
TLS| readOne ReadAgainFinishing
TLS| writeHandshake (encrypted)
TLS| HS.next_fragment ID12?
HS | next_fragment
TLS| HS.next_fragment returned nothing
TLS| sendHandshake
TLS| read: WrittenHS, Ctrl/Ctrl, nothing
TLS| Read fragment at epoch index: 0 of length 40
TLS| StAE decrypt correct.
TLS| read Handshake fragment
HS | recv_fragment
HSL| parsed Finished
HSL| end of flight
TLS| readOne Complete
FFI| Read returned Complete
Read OK, sending HTTP request...
TLS| writeHandshake (encrypted)
TLS| HS.next_fragment ID12?
HS | next_fragment
TLS| HS.next_fragment returned nothing
TLS| sendHandshake
TLS| send Data fragment with index ID12
TLS| Sending fragment of length 60
REC| record headers: 170303003c
TLS| writeHandshake (encrypted)
TLS| HS.next_fragment ID12?
HS | next_fragment
TLS| HS.next_fragment returned nothing
TLS| sendHandshake
TLS| read: WrittenHS, Open/Open, nothing
TLS| Read fragment at epoch index: 0 of length 620
TLS| StAE decrypt correct.
TLS| read Data fragment
TLS| readOne Read 596 bytes of data
Received 596 bytes of data:
Download speed: 1.#INF00kB/s
HTTP/1.1 301 Moved Permanently
Location: https://www.google.com/
Content-Type: text/html; charset=UTF-8
Date: Thu, 14 Jun 2018 22:15:33 GMT
Expires: Sat, 14 Jul 2018 22:15:33 GMT
Cache-Control: public, max-age=2592000
Server: gws
Content-Length: 220
X-XSS-Protection: 1; mode=block
X-Frame-Options: SAMEORIGIN
Alt-Svc: quic=":443"; ma=2592000; v="43,42,41,39,35"

<HTML><HEAD><meta http-equiv="content-type" content="text/html;charset=utf-8">
<TITLE>301 Moved</TITLE></HEAD><BODY>
<H1>301 Moved</H1>
The document has moved
<A HREF="https://www.google.com/">here</A>.
</BODY></HTML>

Closing connection, irrespective of the response
./cmitls.exe tls13.cloudflare.com 443
cmitls.exe ===================
cmitls.exe calling FFI_mitls_init
cmitls.exe about to act as client or server
===============================================
Starting test client...
FFI| Setting up certificate callbacks.
FFI| Setting a new server negotiation callback.
TLS| writeHandshake (plaintext)
TLS| HS.next_fragment PlaintextID?
HS | next_fragment
HS | offering ClientHello 1.3
KS | ks_client_init 1.3
CDH| Keygen (initiator) on X255519
NGO| No PSK or 0-RTT disabled
NGO| offering client extensions [ supported_versions key_share server_name session_ticket extended_master_secret signature_algorithms ec_point_formats supported_groups psk_key_exchange_modes ]
NGO| offering cipher suites ; TLS_AES_128_GCM_SHA256; TLS_AES_256_GCM_SHA384; TLS_CHACHA20_POLY1305_SHA256; TLS_ECDHE_ECDSA_WITH_AES_128_GCM_SHA256; TLS_ECDHE_RSA_WITH_AES_128_GCM_SHA256; TLS_DHE_RSA_WITH_AES_128_GCM_SHA256; TLS_ECDHE_ECDSA_WITH_AES_256_GCM_SHA384; TLS_ECDHE_RSA_WITH_AES_256_GCM_SHA384; TLS_DHE_RSA_WITH_AES_256_GCM_SHA384; TLS_ECDHE_ECDSA_WITH_CHACHA20_POLY1305_SHA256; TLS_ECDHE_RSA_WITH_CHACHA20_POLY1305_SHA256; TLS_DHE_RSA_WITH_CHACHA20_POLY1305_SHA256
HSL| emit ClientHello
TLS| HS.next_fragment returned a fragment
TLS| sendHandshake
TLS| send Handshake fragment with index PlaintextID
TLS| Sending fragment of length 218
REC| record headers: 16030300da
TLS| writeHandshake (plaintext)
TLS| HS.next_fragment PlaintextID?
HS | next_fragment
TLS| HS.next_fragment returned nothing
TLS| sendHandshake
TLS| read: WrittenHS, Ctrl/Ctrl, nothing
TLS| Read fragment at epoch index: -1 of length 90
TLS| read Handshake fragment
HS | recv_fragment
HSL| parsed ServerHello
HSL| end of flight
HS | client_ServerHello
NGO| processing server extensions [ key_share supported_versions ]
NGO| negotiated 1.3 TLS_AES_128_GCM_SHA256
HS | Running TLS 1.3
KS | ks_client_13_sh hashed_log = 94037c5f0532cbc810b51912779262730aab400f7d5798a66bc24c37fff81aae
KS | no PSK negotiated. Early secret: 33ad0a1c607ec03b09e6cd9893680ce210adf300aa1f2660e1b22e10f170f92a
KS | handshake salt:                  6f2615a108c702c5678f54fc9dbab69716c076189c48250cebeac3576c3611ba
CDH| DH initiator on X255519
KS | DH shared secret: edbabee1193fb31d37de1572c7323e756e38656c205b0f4cb9dc047cd18dec2b
KS | handshake secret:                b6607b3c0617606a2b148ae5b9c39b521d9633a7e377364aedaf8d28aecc4c8a
KS | handshake traffic secret[C]:     8bab3dceb70c6cb99ed2e2eefd9890492c307c9a8e5e48aef98a367010ce322f
KS | handshake traffic secret[S]:     75b318765b59adcf51a3b4d17945e85ab62e51def2f8fd15d271b35ce26a2ce1
KS | handshake key[C]:                a4d6480fdc2667c2a24a37433409facf, IV=a9bac80900dd13083799624b
KS | handshake key[S]:                333f36f27f68fadc8c5678f37816e88a, IV=2118cc221a138d75de4c9bfa
KS | finished key[C]: 889eb4f65f2f8c19dcb7754c03fc60dee396be550328ace642a6d7e34461b6b7
KS | finished key[S]: e8d1de5dcd7f5795bc582533e4e9fbbd598a185a1fda8b559c174e18a7475dd8
KS | application salt:                2a4593550c6b82cd4074f586336aa8753f8f05fba69194f450142a21b59fc62c
KS | application secret:              f326f553fa3e567e692afa36641d388f7d5edab681d6905d63c77865fdd012cc
AEP| LowProvider: COERCE(K=a4d6480fdc2667c2a24a37433409facf)
AEP| LowProvider: COERCE(K=333f36f27f68fadc8c5678f37816e88a)
EPO| reader++ 0/-1
TLS| readOne ReadAgain
TLS| writeHandshake (plaintext)
TLS| HS.next_fragment PlaintextID?
HS | next_fragment
TLS| HS.next_fragment returned nothing
TLS| sendHandshake
TLS| read: WrittenHS, Ctrl/Ctrl, nothing
TLS| Read fragment at epoch index: 0 of length 1
TLS| Ignoring a CCS
TLS| Read fragment at epoch index: 0 of length 3365
TLS| StAE decrypt correct.
TLS| read Handshake fragment
HS | recv_fragment
HSL| parsed EncryptedExtensions
HSL| parsed Certificate13
HSL| parsed CertificateVerify
HSL| parsed Finished
HSL| end of flight
NGO| Nego.clientComplete_13
NGO| EE: 
NGO| Negotiation callback to process application extensions.
@@@@ Nego callback for TLS 1.3 @@@@
Offered extensions:
0000
No application cookie (fist connection).
@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
NGO| Certificate & signature 1.3 callback result: valid
KS | ks_client_13_sf hashed_log = a4dec08f72be363edd99051d3cce016127b220006c685a1234f9fdeccd5d6c58
KS | application traffic secret[C]:   734c4be781329c0f0d508fa72ab49a0290453c9432c777fa3bd9c1abcf7f35fd
KS | application traffic secret[S]:   962db194c6f27447335effdfe406ff61663993c86b3ad17fb5f94c5bfec1c5e5
KS | exporter master secret:          49ba64166a1d40c3e990f391d7f9db2fa01f4ef9dbc42c782b28d922aadfbaa8
KS | application key[C]:              6d329b0ecf003a15df180795d6e3e872, IV=5550b743237a461c736ed96b
KS | application key[S]:              1716e93e80846de1183874c2c787df18, IV=cee5358c47e9a010fc4bf64a
AEP| LowProvider: COERCE(K=6d329b0ecf003a15df180795d6e3e872)
AEP| LowProvider: COERCE(K=1716e93e80846de1183874c2c787df18)
HS | exporting a key
HS | Early data rejected
+ cd mitls-fstar/apps/quicMinusNet
EPO| writer++ 0/0
HSL| emit Finished and hash
+ make test
KS | ks_client_13_cf hashed_log = d98245bbc9a43c048ebfe984bcc3dc954e81faf82b98f40ecdf4196867473ea6
KS | resumption master secret:        1d2678287d598dbe0ea7d35e0105d6b52a655eb6aca0eb38a47b6976ee14e973
EPO| reader++ 1/0
TLS| readOne ReadAgain
TLS| writeHandshake (encrypted)
TLS| HS.next_fragment ID13?
HS | next_fragment
TLS| HS.next_fragment returned a fragment; next_keys (for all data); complete
TLS| sendHandshake
TLS| send Handshake fragment with index ID13
TLS| Encrypting with key 637c777bf26b6fc53001672bfed7ab76
TLS| Sending fragment of length 53
REC| record headers: 1703030035
EPO| writer++ 1/1
TLS| read: WrittenHS, Open/Open, new writer: complete
FFI| Read returned Complete
Read OK, sending HTTP request...
TLS| writeHandshake (encrypted)
TLS| HS.next_fragment ID13?
HS | next_fragment
TLS| HS.next_fragment returned nothing
TLS| sendHandshake
TLS| send Data fragment with index ID13
TLS| Encrypting with key 637c777bf26b6fc53001672bfed7ab76
TLS| Sending fragment of length 63
REC| record headers: 170303003f
TLS| writeHandshake (encrypted)
TLS| HS.next_fragment ID13?
HS | next_fragment
TLS| HS.next_fragment returned nothing
TLS| sendHandshake
TLS| read: WrittenHS, Open/Open, nothing
TLS| Read fragment at epoch index: 1 of length 461
TLS| StAE decrypt correct.
TLS| read Handshake fragment
HS | recv_fragment
HSL| parsed NewSessionTicket13
HSL| end of flight (bytes waiting)
HS | Received ticket: ecd4bc7d9d1776d4c53d7f957b8bc72561552aadcb5d3c0e9d268a4b2d84db9a7c5b2b819acc6a9987ff46c1355190c50163f5435e1dbd2d3d46515f17741013145490be1604fb05fe5a85616cd518117b3ef1dc49c549cdfcbd4b4e13d8ea23596c43599aa61d2ae81b6185b6436f464b3bbfb90611eda6dd8050bc6f562dd90ec4af1ca91e77feedbfce5c3810b2b2b323429dbaf6beac25d48607030e62ba62a13baa422f89a2627ea11b926202380062094804ad6ac32312c48918fc83a4
KS | ks_client_13_rms
KS | Recall RMS: 1d2678287d598dbe0ea7d35e0105d6b52a655eb6aca0eb38a47b6976ee14e973
TLS| readOne ReadAgain
TLS| writeHandshake (encrypted)
TLS| HS.next_fragment ID13?
HS | next_fragment
TLS| HS.next_fragment returned nothing
TLS| sendHandshake
TLS| read: WrittenHS, Open/Open, nothing
TLS| Read fragment at epoch index: 1 of length 1386
TLS| StAE decrypt correct.
TLS| read Data fragment
TLS| readOne Read 1369 bytes of data
Received 1369 bytes of data:
Download speed: 1.#INF00kB/s
HTTP/1.1 521 Origin Down
Date: Thu, 14 Jun 2018 22:15:34 GMT
Content-Type: text/html; charset=UTF-8
Transfer-Encoding: chunked
Connection: keep-alive
Set-Cookie: __cfduid=d5ea4cb90086f2673ef32a48f7b830a011529014534; expires=Fri, 14-Jun-19 22:15:34 GMT; path=/; domain=.cloudflare.com; HttpOnly
Expires: Thu, 01 Jan 1970 00:00:01 GMT
Cache-Control: no-store, no-cache, must-revalidate, post-check=0, pre-check=0
Pragma: no-cache
X-Frame-Options: SAMEORIGIN
Set-Cookie: cf_use_ob=443; expires=Thu, 14-Jun-18 22:16:04 GMT; path=/
Set-Cookie: cf_ob_info=521:42b028059bf07a2f:SEA; expires=Thu, 14-Jun-18 22:16:04 GMT; path=/
Strict-Transport-Security: max-age=15780000; includeSubDomains
Expect-CT: max-age=604800, report-uri="https://report-uri.cloudflare.com/cdn-cgi/beacon/expect-ct"
Server: cloudflare
CF-RAY: 42b028059bf07a2f-SEA

11c7
<!DOCTYPE html>
<!--[if lt IE 7]> <html class="no-js ie6 oldie" lang="en-US"> <![endif]-->
<!--[if IE 7]>    <html class="no-js ie7 oldie" lang="en-US"> <![endif]-->
<!--[if IE 8]>    <html class="no-js ie8 oldie" lang="en-US"> <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en-US"> <!--<![endif]-->
<head>
<meta http-equiv="refresh" content="0">

<title>tls13.cloudflare.com | 521: Web server is down</title>
<meta charset="UTF-8" />
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8
Closing connection, irrespective of the response
./quic.exe
server create
FFI| offering custom extension 001a
FFI| extension contents: ffff00050a0b0c0d0e
FFI| setting early data limit to ffffffff
FFI| Setting a new ticket callback.
FFI| Setting a new server negotiation callback.
FFI| Setting up certificate callbacks.
client create
FFI| offering custom extension 001a
FFI| extension contents: ffff00050a0b0c0d0e
FFI| setting early data limit to ffffffff
FFI| Setting a new ticket callback.
FFI| Setting a new server negotiation callback.
FFI| Setting up certificate callbacks.
client call clen=8192 slen=   0
TLS| writeHandshake (plaintext)
TLS| HS.next_fragment PlaintextID?
HS | next_fragment
HS | offering ClientHello 1.3
KS | ks_client_init 1.3
CDH| Keygen (initiator) on X255519
NGO| No PSK or 0-RTT disabled
NGO| offering client extensions [ 001a supported_versions key_share server_name alpn extended_master_secret signature_algorithms supported_groups psk_key_exchange_modes ]
NGO| offering cipher suites ; TLS_CHACHA20_POLY1305_SHA256; TLS_AES_128_GCM_SHA256
HSL| emit ClientHello
TLS| HS.next_fragment returned a fragment
TLS| sendHandshake
TLS| send Handshake fragment with index PlaintextID
TLS| Sending fragment of length 170
REC| record headers: 16030300aa
TLS| writeHandshake (plaintext)
TLS| HS.next_fragment PlaintextID?
HS | next_fragment
TLS| HS.next_fragment returned nothing
TLS| sendHandshake
TLS| read: WrittenHS, Ctrl/Ctrl, nothing
REC| WouldBlock
TLS| readOne ReadWouldBlock
client done clen= 175 slen=   0 status=would_block
16030300aa010000a603035b22e90611d40e92b00513f248d6be6941ca5da04d
70033853b94788a025539f0000041303130101000079001a0009ffff00050a0b
0c0d0e002b0003027f1c003300260024001d0020de8d2d725c7643d38b074163
97f56fd7ab1d26ea45262cef41b69148b7c9f2440000000e000c0000096c6f63
616c686f73740010000800060568712d313000170000000d0006000408040403
000a00040002001d002d0003020001
server call clen= 175 slen=8192
TLS| writeHandshake (plaintext)
TLS| HS.next_fragment PlaintextID?
HS | next_fragment
TLS| HS.next_fragment returned nothing
TLS| sendHandshake
TLS| read: WrittenHS, Ctrl/Ctrl, nothing
TLS| Read fragment at epoch index: -1 of length 170
TLS| read Handshake fragment
HS | recv_fragment
HSL| parsed [ClientHello] -- end of flight 
HS | Processing ClientHello
NGO| offered client extensions [ 001a supported_versions key_share server_name alpn extended_master_secret signature_algorithms supported_groups psk_key_exchange_modes ]
NGO| offered cipher suites ; TLS_CHACHA20_POLY1305_SHA256; TLS_AES_128_GCM_SHA256
NGO| offered versions 1.3
NGO| Negotiated Pure EDH key exchange
NGO| Negotiated ECDSA_SECP256R1_SHA256
NGO| Negotiation callback to handle extra extensions and query for stateless retry.
NGO| Application data in cookie: none
@@@@ Nego callback for TLS 1.3 @@@@
Offered extensions:
003d001a0009ffff00050a0b0c0d0e0000000e000c0000096c6f63616c686f73
740010000800060568712d3130000d0006000408040403000a00040002001d
Transport parameters offered:
ffff00050a0b0c0d0e
No application cookie (fist connection).
Adding server transport parameters:
000102
@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
NGO| negotiated 1.3 TLS_CHACHA20_POLY1305_SHA256
KS | ks_server_init
KS | No PSK selected.
KS | Computed early secret:           33ad0a1c607ec03b09e6cd9893680ce210adf300aa1f2660e1b22e10f170f92a
KS | Handshake salt:                  6f2615a108c702c5678f54fc9dbab69716c076189c48250cebeac3576c3611ba
CDH| Keygen (responder) on X255519
CDH| DH initiator on X255519
KS | DH shared secret: 9c45eb89a8ef9101ad04307fd6d4bdb07414d7f3de4ac361c1aa2e6145f56d22
KS | Handshake secret:                95c3a3bc1641014d6b9aae6986a4cdea875d0188027f5aaa99113da646e86d1e
NGO| processing client extensions [ 001a supported_versions key_share server_name alpn extended_master_secret signature_algorithms supported_groups psk_key_exchange_modes ]
NGO| including server extensions (SH + EE) [ supported_versions key_share alpn supported_groups ]
NGO| extra extensions from application callback: 001a 
HSL| emit ServerHello and hash
HS | derive handshake keys
KS | ks_server_13_sh, hashed log = dd949a9625e53d4c97b1ae3c9b8505e8282e4ea5a4f508b419eb1af700bcfa9b
KS | handshake traffic secret[C]:     33082045fe14c7cd0788b2622e1b347fec80098fb39ef62ac423c0df71902724
KS | handshake traffic secret[S]:     6d1a08156febb8bdab251b0b3afdb41489ca21727eddfd20d1dfee12447bb87e
KS | handshake key[C]:                9477c0aae4d1c02e97937d5fcde9a1913b0f6f5adec42da2571b4b4af91a8648, IV=7077635f93d4f0341386e321
KS | handshake key[S]: ebf88fb07d77e15f3e32741fa4b996f0de620bd182d1ff466aabcc9c88b4cc62, IV=8902fcb8630b3fdbb809d4eb
AEP| LowProvider: COERCE(K=ebf88fb07d77e15f3e32741fa4b996f0de620bd182d1ff466aabcc9c88b4cc62)
AEP| LowProvider: COERCE(K=9477c0aae4d1c02e97937d5fcde9a1913b0f6f5adec42da2571b4b4af91a8648)
KS | finished key[C]:                 4ad21ddfac3c2921e08be36e268ae1590ceeb9fc880d6c2b851202ef0be8218d
KS | finished key[S]:                 dab0309684b313b71fe597577bf7bf5f9fefd73a5cfdd01ee45441f45603c91c
KS | Application salt:                26e68e62d945ca24f574aebd90df94c4b6c1538e4f5f855ca86c3b145851051e
KS | Application secret:              4192ffb334bd6f00a53bc74e7d86842c57f89593ca55bcd33e84512d85ad0909
TLS| readOne ReadAgain
TLS| writeHandshake (plaintext)
TLS| HS.next_fragment PlaintextID?
HS | next_fragment
TLS| HS.next_fragment returned a fragment; next_keys (for handshake only
TLS| sendHandshake
TLS| send Handshake fragment with index PlaintextID
TLS| Sending fragment of length 90
REC| record headers: 160303005a
EPO| writer++ -1/0
TLS| writeHandshake (encrypted)
TLS| HS.next_fragment ID13?
HS | next_fragment
HS | prepare Server Finished
HSL| emit EncryptedExtensions
HSL| emit Certificate13 and hash
======== TO BE SIGNED <0403>: (130 octets) ========
2020202020202020202020202020202020202020202020202020202020202020
2020202020202020202020202020202020202020202020202020202020202020
544c5320312e332c207365727665722043657274696669636174655665726966
7900d283143a9af0f55b9827599121bf037d26da6e72dd38665ff449fd160af8
ba40
===================================================
HSL| emit CertificateVerify and hash
HSL| emit Finished and hash
KS | ks_server_13_sf hashed_log = ab37c21a239187b827c5b66672699d5526711ded1ca0b5858e996bc4412e6dfc
KS | application traffic secret[C]:   2af0978d9602526edc4085e1db0c4632b0069116838e15b9fcca7026bae3e63a
KS | application traffic secret[S]:   a4ee82cb4eaf136f4553fd0704d91dca58b33e92bc4f008b80a52f80aa3ee7b6
KS | exporter master secret:          0e15291be3c000b999d23eb1c55aebee63c416e70059e136f059500385c78a5d
KS | application key[C]:              537e95806c4129e570d1428ef2a3104313f9d0ba35c8a42700d801ce6458f23b, IV=a82b27be07e596ce0d73e784
KS | application key[S]:              ecaad97db0ef51d8270a08c9dc386c500f63f88b64bea0fe02d5a40f7f32c1d1, IV=ef25b8d8881ca6af608f9184
AEP| LowProvider: COERCE(K=ecaad97db0ef51d8270a08c9dc386c500f63f88b64bea0fe02d5a40f7f32c1d1)
AEP| LowProvider: COERCE(K=537e95806c4129e570d1428ef2a3104313f9d0ba35c8a42700d801ce6458f23b)
HS | exporting a key
EPO| reader++ 0/0
TLS| HS.next_fragment returned a fragment; next_keys (for all data)
TLS| sendHandshake
TLS| send Handshake fragment with index ID13
+ set +x
TLS| Encrypting with key ebf88fb07d77e15f3e32741fa4b996f0de620bd182d1ff466aabcc9c88b4cc62
TLS| Sending fragment of length 734
REC| record headers: 17030302de
EPO| writer++ 0/1
TLS| read: WrittenHS, Ctrl/Open, new writer: writable
sender done clen= 175 slen= 834 status=server_accept
160303005a0200005603035b22e906643a73fa96a6e5f3d6444db854c69c8ce7
1cf960309b7c71053938d700130300002e002b00027f1c00330024001d0020e3
2d57daa1e4909de8a936803df8f20cb6c0d83a48b09f504c3d7869af02de4117
030302de90d8e40dd314a08fafdf950bf7fb32f64687778c0a170e58e22c2644
539dd2c73805b29a6d8a497922af2efd6d596f1b9986c1174f1576b074476604
042ea8a7a3920942031cd97dc13813bca52dd59166b66ba427b19786b70ae39d
7ad723ba3293b6cecf4ad9ef3d9a4e85d4a78a4bcfd6722a13ed722a87ccd125
d3bd2a7f75c0b897bc48ac90f4cc931eba3bfb6810ee8a7904fecc37e9246d67
35c4b3d10095e9816999e378057293ac17b668b2a45ec8964d2550ee1f413d34
2025038a1a8d0b409d598e0e36d30ab4580235f93354e6e75c22e87c07add86f
56c7d2503547bef9267592b7901f268506eea41522fc757d2bbaf7dbf2d0be48
b2035a804ad6b8c115c98e02500f3b684e369e7041127eeb37fbe64a81109bed
46ae5a248eac4c6233903007a975a8f98721151bf7a7de5e385aa1dcd43cc8bd
c6c131ded141b303ccd3cfbd872b0fc2d3998facd18ba3edda1616b667f087ca
bc42b623c1209aa31ed04007f00faf39baa7af97450f2a309ab565f8a6eaea86
6a60a8e83ff9125e12d1d71804bcb2290b7144a2a14e3b4e6b1047d5ce781968
cd83f3a2c6c178c1dfd85ef805ae4d3660897eee5e9322be30e3b6fa3c474eac
cbcc96bdbf5ed5d82f97b37aa7508efdf04246c291e0c5df0f55292a78323b16
447d4db97f1b8ae80ea724e50bf467451021a2f1e0de5e2ef87e90b7eb9ffff7
ba5badbc45c92b9be9bcec5296a9d210474f60b66b1c95a461f6362b043900d2
c1565da37dc8752537f884134e59e5ebf8ebbff5df29bbb9c2a704096eead881
553ab8b432bd1b6359bb90528459d5a389b198d8d3f5ca550a3a2e72520e637c
261a99da94e63cd7139b201f6fa6f8e3bbb68bebf916efc5a5d97992399193f4
414724ab56aa4303b2b0b6e45fdca5ab92c9b5256228fe136dcf4ec18dfe9373
9e386ac453883130e013e937e7dca5addd8104b5f18e2968d1b5e6d54b539df4
9b81823b8009273821a748bbfece267098de8d642239240f9eb0971d889aa682
1e9e
client call clen=8017 slen= 834
TLS| writeHandshake (plaintext)
TLS| HS.next_fragment PlaintextID?
HS | next_fragment
TLS| HS.next_fragment returned nothing
TLS| sendHandshake
TLS| read: WrittenHS, Ctrl/Ctrl, nothing
TLS| Read fragment at epoch index: -1 of length 90
TLS| read Handshake fragment
HS | recv_fragment
HSL| parsed ServerHello
HSL| end of flight
HS | client_ServerHello
NGO| processing server extensions [ supported_versions key_share ]
NGO| negotiated 1.3 TLS_CHACHA20_POLY1305_SHA256
HS | Running TLS 1.3
KS | ks_client_13_sh hashed_log = dd949a9625e53d4c97b1ae3c9b8505e8282e4ea5a4f508b419eb1af700bcfa9b
KS | no PSK negotiated. Early secret: 33ad0a1c607ec03b09e6cd9893680ce210adf300aa1f2660e1b22e10f170f92a
KS | handshake salt:                  6f2615a108c702c5678f54fc9dbab69716c076189c48250cebeac3576c3611ba
CDH| DH initiator on X255519
KS | DH shared secret: 9c45eb89a8ef9101ad04307fd6d4bdb07414d7f3de4ac361c1aa2e6145f56d22
KS | handshake secret:                95c3a3bc1641014d6b9aae6986a4cdea875d0188027f5aaa99113da646e86d1e
KS | handshake traffic secret[C]:     33082045fe14c7cd0788b2622e1b347fec80098fb39ef62ac423c0df71902724
KS | handshake traffic secret[S]:     6d1a08156febb8bdab251b0b3afdb41489ca21727eddfd20d1dfee12447bb87e
KS | handshake key[C]:                9477c0aae4d1c02e97937d5fcde9a1913b0f6f5adec42da2571b4b4af91a8648, IV=7077635f93d4f0341386e321
KS | handshake key[S]:                ebf88fb07d77e15f3e32741fa4b996f0de620bd182d1ff466aabcc9c88b4cc62, IV=8902fcb8630b3fdbb809d4eb
KS | finished key[C]: 4ad21ddfac3c2921e08be36e268ae1590ceeb9fc880d6c2b851202ef0be8218d
KS | finished key[S]: dab0309684b313b71fe597577bf7bf5f9fefd73a5cfdd01ee45441f45603c91c
KS | application salt:                26e68e62d945ca24f574aebd90df94c4b6c1538e4f5f855ca86c3b145851051e
KS | application secret:              4192ffb334bd6f00a53bc74e7d86842c57f89593ca55bcd33e84512d85ad0909
AEP| LowProvider: COERCE(K=9477c0aae4d1c02e97937d5fcde9a1913b0f6f5adec42da2571b4b4af91a8648)
AEP| LowProvider: COERCE(K=ebf88fb07d77e15f3e32741fa4b996f0de620bd182d1ff466aabcc9c88b4cc62)
EPO| reader++ 0/-1
TLS| readOne ReadAgain
TLS| writeHandshake (plaintext)
TLS| HS.next_fragment PlaintextID?
HS | next_fragment
TLS| HS.next_fragment returned nothing
TLS| sendHandshake
TLS| read: WrittenHS, Ctrl/Ctrl, nothing
TLS| Read fragment at epoch index: 0 of length 734
TLS| StAE decrypt correct.
TLS| read Handshake fragment
HS | recv_fragment
HSL| parsed EncryptedExtensions
HSL| parsed Certificate13
HSL| parsed CertificateVerify
HSL| parsed Finished
HSL| end of flight
NGO| Nego.clientComplete_13
NGO| EE: alpn supported_groups 001a 
NGO| Negotiation callback to process application extensions.
@@@@ Nego callback for TLS 1.3 @@@@
Offered extensions:
001b0010000800060568712d3130000a00040002001d001a0003000102
Transport parameters offered:
000102
No application cookie (fist connection).
Adding server transport parameters:
000102
@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
WARNING: chain validation failed, ignoring.
NGO| Certificate & signature 1.3 callback result: valid
KS | ks_client_13_sf hashed_log = ab37c21a239187b827c5b66672699d5526711ded1ca0b5858e996bc4412e6dfc
KS | application traffic secret[C]:   2af0978d9602526edc4085e1db0c4632b0069116838e15b9fcca7026bae3e63a
KS | application traffic secret[S]:   a4ee82cb4eaf136f4553fd0704d91dca58b33e92bc4f008b80a52f80aa3ee7b6
KS | exporter master secret:          0e15291be3c000b999d23eb1c55aebee63c416e70059e136f059500385c78a5d
KS | application key[C]:              537e95806c4129e570d1428ef2a3104313f9d0ba35c8a42700d801ce6458f23b, IV=a82b27be07e596ce0d73e784
KS | application key[S]:              ecaad97db0ef51d8270a08c9dc386c500f63f88b64bea0fe02d5a40f7f32c1d1, IV=ef25b8d8881ca6af608f9184
AEP| LowProvider: COERCE(K=537e95806c4129e570d1428ef2a3104313f9d0ba35c8a42700d801ce6458f23b)
AEP| LowProvider: COERCE(K=ecaad97db0ef51d8270a08c9dc386c500f63f88b64bea0fe02d5a40f7f32c1d1)
HS | exporting a key
HS | Early data rejected
EPO| writer++ 0/0
HSL| emit Finished and hash
KS | ks_client_13_cf hashed_log = 1033889537d523378ff116c5735b69900f697d6165206822742e9fc99928ec25
KS | resumption master secret:        53b5d70593c66fe138966db2c01f0b225a58e1f776cf59f1fdb566df8d95212e
EPO| reader++ 1/0
TLS| readOne ReadAgain
TLS| writeHandshake (encrypted)
TLS| HS.next_fragment ID13?
HS | next_fragment
TLS| HS.next_fragment returned a fragment; next_keys (for all data); complete
TLS| sendHandshake
TLS| send Handshake fragment with index ID13
TLS| Encrypting with key 9477c0aae4d1c02e97937d5fcde9a1913b0f6f5adec42da2571b4b4af91a8648
TLS| Sending fragment of length 53
REC| record headers: 1703030035
EPO| writer++ 1/1
TLS| read: WrittenHS, Open/Open, new writer: complete
client done clen=  58 slen= 834 status=client_complete
1703030035abe37a00c2ff860d265074ce2f62d0899e1a6607605bdec6825193
b59b20760b3bbb1ce103c14481e66c7c1b530ba2cf7e42b10b9e
server call clen=  58 slen=7358
TLS| writeHandshake (encrypted)
TLS| HS.next_fragment ID13?
HS | next_fragment
TLS| HS.next_fragment returned nothing
TLS| sendHandshake
TLS| read: WrittenHS, Ctrl/Open, nothing
TLS| Read fragment at epoch index: 0 of length 53
TLS| StAE decrypt correct.
TLS| read Handshake fragment
HS | recv_fragment
HSL| parsed Finished
HSL| end of flight
HS | Process Client Finished
KS | ks_server_13_cf hashed_log = 1033889537d523378ff116c5735b69900f697d6165206822742e9fc99928ec25
KS | resumption master secret:        53b5d70593c66fe138966db2c01f0b225a58e1f776cf59f1fdb566df8d95212e
AEP| LowProvider: COERCE(K=5a7fe16dd59ad4b6beac884fb392909e78b3c4cba914fd1bd9b8b7a711e47d97)
HS | Sending ticket: 76cd8f09575cf3c24c904a4405e16e40f523c9feb8d95c8c9e8f2d52b97d41dd7a51e626cb7e5cc217338930f77b708aea76b0279a053e49947f7462b334b6f935df7b90c8a7714317ed1306
HSL| emit NewSessionTicket13
EPO| reader++ 1/1
TLS| readOne Complete
sender done clen=  58 slen=   0 status=server_complete
=== Exporter secret ===
0e15291be3c000b999d23eb1c55aebee63c416e70059e136f059500385c78a5d
=== QUIC 1-RTT secrets ===
C: 3974d9b614917c80dd2e0e5337b1218f858cec9d40d24c66a2e023d7ffa4ab81
S: 33c0942d64182147d5edcc1659776f645f38f31f27048fc1987d8dfa8f469bb0
=== AEAD client key test ===
5b698b8439bb8a2a0764e01517be2e8297a72a9acd07457d261bea
=== Decrypt successful ===
Ok
./quic.exe 0rtt

INITIAL ECDHE HANDSHAKE (NO EARLY SECRET)

server create
FFI| offering custom extension 001a
FFI| extension contents: ffff00050a0b0c0d0e
FFI| setting early data limit to ffffffff
FFI| Setting a new ticket callback.
FFI| Setting a new server negotiation callback.
FFI| Setting up certificate callbacks.
client create
FFI| offering custom extension 001a
FFI| extension contents: ffff00050a0b0c0d0e
FFI| setting early data limit to ffffffff
FFI| Setting a new ticket callback.
FFI| Setting a new server negotiation callback.
FFI| Setting up certificate callbacks.
TLS| writeHandshake (plaintext)
TLS| HS.next_fragment PlaintextID?
HS | next_fragment
HS | offering ClientHello 1.3
KS | ks_client_init 1.3
CDH| Keygen (initiator) on X255519
NGO| No PSK or 0-RTT disabled
NGO| offering client extensions [ 001a supported_versions key_share server_name alpn extended_master_secret signature_algorithms supported_groups psk_key_exchange_modes ]
NGO| offering cipher suites ; TLS_CHACHA20_POLY1305_SHA256; TLS_AES_128_GCM_SHA256
HSL| emit ClientHello
TLS| HS.next_fragment returned a fragment
TLS| sendHandshake
TLS| send Handshake fragment with index PlaintextID
TLS| Sending fragment of length 170
REC| record headers: 16030300aa
TLS| writeHandshake (plaintext)
TLS| HS.next_fragment PlaintextID?
HS | next_fragment
TLS| HS.next_fragment returned nothing
TLS| sendHandshake
TLS| read: WrittenHS, Ctrl/Ctrl, nothing
REC| WouldBlock
TLS| readOne ReadWouldBlock
client returns would_block clen=175 slen=0
ClientHello[ 175] ---->

TLS| writeHandshake (plaintext)
TLS| HS.next_fragment PlaintextID?
HS | next_fragment
TLS| HS.next_fragment returned nothing
TLS| sendHandshake
TLS| read: WrittenHS, Ctrl/Ctrl, nothing
TLS| Read fragment at epoch index: -1 of length 170
TLS| read Handshake fragment
HS | recv_fragment
HSL| parsed [ClientHello] -- end of flight 
HS | Processing ClientHello
NGO| offered client extensions [ 001a supported_versions key_share server_name alpn extended_master_secret signature_algorithms supported_groups psk_key_exchange_modes ]
NGO| offered cipher suites ; TLS_CHACHA20_POLY1305_SHA256; TLS_AES_128_GCM_SHA256
NGO| offered versions 1.3
NGO| Negotiated Pure EDH key exchange
NGO| Negotiated ECDSA_SECP256R1_SHA256
NGO| Negotiation callback to handle extra extensions and query for stateless retry.
NGO| Application data in cookie: none
@@@@ Nego callback for TLS 1.3 @@@@
Offered extensions:
003d001a0009ffff00050a0b0c0d0e0000000e000c0000096c6f63616c686f73
740010000800060568712d3130000d0006000408040403000a00040002001d
Transport parameters offered:
ffff00050a0b0c0d0e
No application cookie (fist connection).
Adding server transport parameters:
000102
@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
NGO| negotiated 1.3 TLS_CHACHA20_POLY1305_SHA256
KS | ks_server_init
KS | No PSK selected.
KS | Computed early secret:           33ad0a1c607ec03b09e6cd9893680ce210adf300aa1f2660e1b22e10f170f92a
KS | Handshake salt:                  6f2615a108c702c5678f54fc9dbab69716c076189c48250cebeac3576c3611ba
CDH| Keygen (responder) on X255519
CDH| DH initiator on X255519
KS | DH shared secret: 99836a38d1496c5b1e6108f068a5cac6578e07d6bd6fee2563c36ea9ea578706
KS | Handshake secret:                fa9c661b3ae23e6bf66fca3572d2cc20a01eca793d0e6e0ce7bd9656775ae323
NGO| processing client extensions [ 001a supported_versions key_share server_name alpn extended_master_secret signature_algorithms supported_groups psk_key_exchange_modes ]
NGO| including server extensions (SH + EE) [ supported_versions key_share alpn supported_groups ]
NGO| extra extensions from application callback: 001a 
HSL| emit ServerHello and hash
HS | derive handshake keys
KS | ks_server_13_sh, hashed log = 9d4c4c008970d2d75e450d4dec1836359be97db0e42ba5ec7b4ec47a02921f0f
KS | handshake traffic secret[C]:     d3f1d0acdffde41115fa7a17dea79b9652015d4fc6e35df29f3cf55ac329ff3d
KS | handshake traffic secret[S]:     3bfecd0494d34202e5587bcc43c7547e2c7419c93922d74d2dc992a1d62bdbc1
KS | handshake key[C]:                5f757611ced0cc64f9ecabb21c6e2186e42c0fe9c68e98ab8ee062afaecf5315, IV=aca07ee5aaa6bf2d5ab674be
KS | handshake key[S]: 05c8fda8ccc1b7997a71efd49f9d3dec896408603976ab034c2724d96ea18e45, IV=cac62314e083fd59aa0fa2f5
AEP| LowProvider: COERCE(K=05c8fda8ccc1b7997a71efd49f9d3dec896408603976ab034c2724d96ea18e45)
AEP| LowProvider: COERCE(K=5f757611ced0cc64f9ecabb21c6e2186e42c0fe9c68e98ab8ee062afaecf5315)
KS | finished key[C]:                 112f15883bea4aba73799c8f19f769e404c6d4d7d9efa21c28916c91255a9c5b
KS | finished key[S]:                 b2bd805dd3f129d9e1aba223839e6346cfcb3290f4b4cce97fa53ad101fd61d6
KS | Application salt:                45617c4dd47e7069262c900cbe432d9e34b49b45ecabb1f92d9fb95812d481e5
KS | Application secret:              0c51e32042be3702657c0837d2d06894fcd341864eaf01e18ec25e5609d8e904
TLS| readOne ReadAgain
TLS| writeHandshake (plaintext)
TLS| HS.next_fragment PlaintextID?
HS | next_fragment
TLS| HS.next_fragment returned a fragment; next_keys (for handshake only
TLS| sendHandshake
TLS| send Handshake fragment with index PlaintextID
TLS| Sending fragment of length 90
REC| record headers: 160303005a
EPO| writer++ -1/0
TLS| writeHandshake (encrypted)
TLS| HS.next_fragment ID13?
HS | next_fragment
HS | prepare Server Finished
HSL| emit EncryptedExtensions
HSL| emit Certificate13 and hash
======== TO BE SIGNED <0403>: (130 octets) ========
2020202020202020202020202020202020202020202020202020202020202020
2020202020202020202020202020202020202020202020202020202020202020
544c5320312e332c207365727665722043657274696669636174655665726966
7900df0310565aa2cc76e6e3142e49217e0bcde5c51daeb2612858a23678d443
4d59
===================================================
HSL| emit CertificateVerify and hash
HSL| emit Finished and hash
KS | ks_server_13_sf hashed_log = 60218f749b664f9335ca41bf1a563aa77b0da66d5bfc79b9d4891b0eb5c33165
KS | application traffic secret[C]:   84a085f5f2c3877d2dfaefa19c2aef838c1e2d8e61e640d98c4a032ecae91788
KS | application traffic secret[S]:   1b6b7b5139eea161f398206f72874ae57e70ff16583b36999638e9fb81df5fff
KS | exporter master secret:          1e82babed28f75894ee99e0402b9eed3faca39cca60f3a631d2d5a142a9c284e
KS | application key[C]:              888ab0a92284420d93f8de53bd6ab51b1f81ba59ef5e02dd6f3bbc7ac884e7a4, IV=47ae874b40534f3fa4ce94a9
KS | application key[S]:              79266fe76d01129229e72e1ddf0115af3824d240cf67d037bd5f3033eb0a3be3, IV=a64137c46171eacf71e1705c
AEP| LowProvider: COERCE(K=79266fe76d01129229e72e1ddf0115af3824d240cf67d037bd5f3033eb0a3be3)
AEP| LowProvider: COERCE(K=888ab0a92284420d93f8de53bd6ab51b1f81ba59ef5e02dd6f3bbc7ac884e7a4)
HS | exporting a key
EPO| reader++ 0/0
TLS| HS.next_fragment returned a fragment; next_keys (for all data)
TLS| sendHandshake
TLS| send Handshake fragment with index ID13
TLS| Encrypting with key 05c8fda8ccc1b7997a71efd49f9d3dec896408603976ab034c2724d96ea18e45
TLS| Sending fragment of length 734
REC| record headers: 17030302de
EPO| writer++ 0/1
TLS| read: WrittenHS, Ctrl/Open, new writer: writable
server returns server_accept clen=175 slen=834
secret=1e82babed28f75894ee99e0402b9eed3faca39cca60f3a631d2d5a142a9c284e
<---- ServerHello;(EncryptedExtensions; Certificate; CertVerify; Finished)[ 834]

TLS| writeHandshake (plaintext)
TLS| HS.next_fragment PlaintextID?
HS | next_fragment
TLS| HS.next_fragment returned nothing
TLS| sendHandshake
TLS| read: WrittenHS, Ctrl/Ctrl, nothing
TLS| Read fragment at epoch index: -1 of length 90
TLS| read Handshake fragment
HS | recv_fragment
HSL| parsed ServerHello
HSL| end of flight
HS | client_ServerHello
NGO| processing server extensions [ supported_versions key_share ]
NGO| negotiated 1.3 TLS_CHACHA20_POLY1305_SHA256
HS | Running TLS 1.3
KS | ks_client_13_sh hashed_log = 9d4c4c008970d2d75e450d4dec1836359be97db0e42ba5ec7b4ec47a02921f0f
KS | no PSK negotiated. Early secret: 33ad0a1c607ec03b09e6cd9893680ce210adf300aa1f2660e1b22e10f170f92a
KS | handshake salt:                  6f2615a108c702c5678f54fc9dbab69716c076189c48250cebeac3576c3611ba
CDH| DH initiator on X255519
KS | DH shared secret: 99836a38d1496c5b1e6108f068a5cac6578e07d6bd6fee2563c36ea9ea578706
KS | handshake secret:                fa9c661b3ae23e6bf66fca3572d2cc20a01eca793d0e6e0ce7bd9656775ae323
KS | handshake traffic secret[C]:     d3f1d0acdffde41115fa7a17dea79b9652015d4fc6e35df29f3cf55ac329ff3d
KS | handshake traffic secret[S]:     3bfecd0494d34202e5587bcc43c7547e2c7419c93922d74d2dc992a1d62bdbc1
KS | handshake key[C]:                5f757611ced0cc64f9ecabb21c6e2186e42c0fe9c68e98ab8ee062afaecf5315, IV=aca07ee5aaa6bf2d5ab674be
KS | handshake key[S]:                05c8fda8ccc1b7997a71efd49f9d3dec896408603976ab034c2724d96ea18e45, IV=cac62314e083fd59aa0fa2f5
KS | finished key[C]: 112f15883bea4aba73799c8f19f769e404c6d4d7d9efa21c28916c91255a9c5b
KS | finished key[S]: b2bd805dd3f129d9e1aba223839e6346cfcb3290f4b4cce97fa53ad101fd61d6
KS | application salt:                45617c4dd47e7069262c900cbe432d9e34b49b45ecabb1f92d9fb95812d481e5
KS | application secret:              0c51e32042be3702657c0837d2d06894fcd341864eaf01e18ec25e5609d8e904
AEP| LowProvider: COERCE(K=5f757611ced0cc64f9ecabb21c6e2186e42c0fe9c68e98ab8ee062afaecf5315)
AEP| LowProvider: COERCE(K=05c8fda8ccc1b7997a71efd49f9d3dec896408603976ab034c2724d96ea18e45)
EPO| reader++ 0/-1
TLS| readOne ReadAgain
TLS| writeHandshake (plaintext)
TLS| HS.next_fragment PlaintextID?
HS | next_fragment
TLS| HS.next_fragment returned nothing
TLS| sendHandshake
TLS| read: WrittenHS, Ctrl/Ctrl, nothing
TLS| Read fragment at epoch index: 0 of length 734
TLS| StAE decrypt correct.
TLS| read Handshake fragment
HS | recv_fragment
HSL| parsed EncryptedExtensions
HSL| parsed Certificate13
HSL| parsed CertificateVerify
HSL| parsed Finished
HSL| end of flight
NGO| Nego.clientComplete_13
NGO| EE: alpn supported_groups 001a 
NGO| Negotiation callback to process application extensions.
@@@@ Nego callback for TLS 1.3 @@@@
Offered extensions:
001b0010000800060568712d3130000a00040002001d001a0003000102
Transport parameters offered:
000102
No application cookie (fist connection).
Adding server transport parameters:
000102
@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
WARNING: chain validation failed, ignoring.
NGO| Certificate & signature 1.3 callback result: valid
KS | ks_client_13_sf hashed_log = 60218f749b664f9335ca41bf1a563aa77b0da66d5bfc79b9d4891b0eb5c33165
KS | application traffic secret[C]:   84a085f5f2c3877d2dfaefa19c2aef838c1e2d8e61e640d98c4a032ecae91788
KS | application traffic secret[S]:   1b6b7b5139eea161f398206f72874ae57e70ff16583b36999638e9fb81df5fff
KS | exporter master secret:          1e82babed28f75894ee99e0402b9eed3faca39cca60f3a631d2d5a142a9c284e
KS | application key[C]:              888ab0a92284420d93f8de53bd6ab51b1f81ba59ef5e02dd6f3bbc7ac884e7a4, IV=47ae874b40534f3fa4ce94a9
KS | application key[S]:              79266fe76d01129229e72e1ddf0115af3824d240cf67d037bd5f3033eb0a3be3, IV=a64137c46171eacf71e1705c
AEP| LowProvider: COERCE(K=888ab0a92284420d93f8de53bd6ab51b1f81ba59ef5e02dd6f3bbc7ac884e7a4)
AEP| LowProvider: COERCE(K=79266fe76d01129229e72e1ddf0115af3824d240cf67d037bd5f3033eb0a3be3)
HS | exporting a key
HS | Early data rejected
EPO| writer++ 0/0
HSL| emit Finished and hash
KS | ks_client_13_cf hashed_log = 9ddb6a7e3bc5736f2d05a208d5e94b49a11d81867bb59c1ed8f08ec3f0e135bc
KS | resumption master secret:        febf9cd38765752bac2bf5705137346c83ca56db974a126208a3da08f48af5e5
EPO| reader++ 1/0
TLS| readOne ReadAgain
TLS| writeHandshake (encrypted)
TLS| HS.next_fragment ID13?
HS | next_fragment
TLS| HS.next_fragment returned a fragment; next_keys (for all data); complete
TLS| sendHandshake
TLS| send Handshake fragment with index ID13
TLS| Encrypting with key 5f757611ced0cc64f9ecabb21c6e2186e42c0fe9c68e98ab8ee062afaecf5315
TLS| Sending fragment of length 53
REC| record headers: 1703030035
EPO| writer++ 1/1
TLS| read: WrittenHS, Open/Open, new writer: complete
client returns client_complete clen=58 slen=834
secret=1e82babed28f75894ee99e0402b9eed3faca39cca60f3a631d2d5a142a9c284e
(Finished) [  58] ---->

TLS| writeHandshake (encrypted)
TLS| HS.next_fragment ID13?
HS | next_fragment
TLS| HS.next_fragment returned nothing
TLS| sendHandshake
TLS| read: WrittenHS, Ctrl/Open, nothing
TLS| Read fragment at epoch index: 0 of length 53
TLS| StAE decrypt correct.
TLS| read Handshake fragment
HS | recv_fragment
HSL| parsed Finished
HSL| end of flight
HS | Process Client Finished
KS | ks_server_13_cf hashed_log = 9ddb6a7e3bc5736f2d05a208d5e94b49a11d81867bb59c1ed8f08ec3f0e135bc
KS | resumption master secret:        febf9cd38765752bac2bf5705137346c83ca56db974a126208a3da08f48af5e5
AEP| LowProvider: COERCE(K=01be28284393960c21b46bf4ac80287000a51beaaa47df4326b676653ae5898d)
HS | Sending ticket: 44cbbcb4b5d388b63ab7931524717c1438d6eec05af49105538e93a6870a286866b0c392b8c9dade1cad0dfa2005cec4d88e625c077ed7c9dff4b41e54b9081c58234cf412999f3dda7b7cb0
HSL| emit NewSessionTicket13
EPO| reader++ 1/1
TLS| readOne Complete
server returns server_complete clen=58 slen=0
TLS| writeHandshake (encrypted)
TLS| HS.next_fragment ID13?
HS | next_fragment
TLS| HS.next_fragment returned a fragment
TLS| sendHandshake
TLS| send Handshake fragment with index ID13
TLS| Encrypting with key 79266fe76d01129229e72e1ddf0115af3824d240cf67d037bd5f3033eb0a3be3
TLS| Sending fragment of length 130
REC| record headers: 1703030082
TLS| writeHandshake (encrypted)
TLS| HS.next_fragment ID13?
HS | next_fragment
TLS| HS.next_fragment returned nothing
TLS| sendHandshake
TLS| read: WrittenHS, Open/Open, nothing
REC| WouldBlock
TLS| readOne ReadWouldBlock
server returns would_block clen=0 slen=135
<---- {Ticket}[ 135]
TLS| writeHandshake (encrypted)
TLS| HS.next_fragment ID13?
HS | next_fragment
TLS| HS.next_fragment returned nothing
TLS| sendHandshake
TLS| read: WrittenHS, Open/Open, nothing
TLS| Read fragment at epoch index: 1 of length 130
TLS| StAE decrypt correct.
TLS| read Handshake fragment
HS | recv_fragment
HSL| parsed NewSessionTicket13
HSL| end of flight
HS | Received ticket: 44cbbcb4b5d388b63ab7931524717c1438d6eec05af49105538e93a6870a286866b0c392b8c9dade1cad0dfa2005cec4d88e625c077ed7c9dff4b41e54b9081c58234cf412999f3dda7b7cb0
KS | ks_client_13_rms
KS | Recall RMS: febf9cd38765752bac2bf5705137346c83ca56db974a126208a3da08f48af5e5
AEP| LowProvider: COERCE(K=a8a2aaeadc12764ed7ce1ed7ed2052dea83557e4f012113527218343b291c59c)

##### New session ticket received! #####
Host: localhost
Ticket:
44cbbcb4b5d388b63ab7931524717c1438d6eec05af49105538e93a6870a2868
66b0c392b8c9dade1cad0dfa2005cec4d88e625c077ed7c9dff4b41e54b9081c
58234cf412999f3dda7b7cb0
########################################
TLS| readOne ReadAgain
TLS| writeHandshake (encrypted)
TLS| HS.next_fragment ID13?
HS | next_fragment
TLS| HS.next_fragment returned nothing
TLS| sendHandshake
TLS| read: WrittenHS, Open/Open, nothing
REC| WouldBlock
TLS| readOne ReadWouldBlock
client returns clen=0 slen=135 status=would_block

TICKET-BASED RESUMPTION

server create
FFI| offering custom extension 001a
FFI| extension contents: ffff00050a0b0c0d0e
FFI| setting early data limit to ffffffff
FFI| Setting a new ticket callback.
FFI| Setting a new server negotiation callback.
FFI| Setting up certificate callbacks.
client create
FFI| offering custom extension 001a
FFI| extension contents: ffff00050a0b0c0d0e
FFI| setting early data limit to ffffffff
FFI| Setting a new ticket callback.
FFI| Setting a new server negotiation callback.
FFI| Setting up certificate callbacks.
TCK| Decrypting ticket 6c676b4cb130c41bb0638e00c8caff35169c38e343be8eb8aa47f4b35a563bd05c226c5c43fa4270e6402b2fb5266cda7f36082c4ea3ca5a085e5e2af441985df91e53d2c13b6472735f6e02
TCK| Parsing ticket 030413035b22e906cf74b8c400000020aa077b7865e1d7d4582059ecde6f29ef663944fdc6f8ececddfbf29346b45993
TLS| writeHandshake (plaintext)
TLS| HS.next_fragment PlaintextID?
HS | next_fragment
HS | offering ClientHello 1.3
KS | ks_client_init 1.3
CDH| Keygen (initiator) on X255519
NGO| Offering a PSK compatible with 0-RTT
NGO| offering client extensions [ 001a supported_versions key_share server_name alpn extended_master_secret signature_algorithms supported_groups psk_key_exchange_modes early_data pre_shared_key ]
NGO| offering cipher suites ; TLS_CHACHA20_POLY1305_SHA256; TLS_AES_128_GCM_SHA256
HSL| emit ClientHello
KS | Loaded pre-shared key 44cbbcb4b5d388b63ab7931524717c1438d6eec05af49105538e93a6870a286866b0c392b8c9dade1cad0dfa2005cec4d88e625c077ed7c9dff4b41e54b9081c58234cf412999f3dda7b7cb0: aa077b7865e1d7d4582059ecde6f29ef663944fdc6f8ececddfbf29346b45993
KS | Early secret: 7780a9e2ecf2e64b8ad04b18878c6cde7bf622ff0fe83ab09e90cea0b7e46d37
KS | Binder key[res binder]: 7f0b8bc1d0e055cee5f4b993c73150922507db01f0fe5d3caeec2147f84d2055
KS | Binder Finished key: a4d48a795dcd88214d49bc53a91aba70ba1a6e9fa3c5cf24a71819162f30d95a
HSL| emit Binders
HS | setting up 0RTT
KS | ks_client_13_ch log=ef5d9724c5db7f56bf5045b4235ee7d63b1e60b8b80fdb85d26d9d15f92d3ecf
KS | Client early traffic secret:     d10ea800c3b8f1f6f278630183b24ef2ff6b6dda87183f64a674977c454caa4d
KS | Early exporter master secret:    ef4d7e7aa54a2d356d201939620236fa8fae7ff63da116ca9e21c3220bf1e25e
KS | Client 0-RTT key:                1e023eb49788486848acab4edffd5c6b838139028ea339f3c9fcf3f98a571b8e, IV=db5f2e93824ef0225c0963e2
AEP| LowProvider: COERCE(K=1e023eb49788486848acab4edffd5c6b838139028ea339f3c9fcf3f98a571b8e)
HS | exporting a key
TLS| HS.next_fragment returned a fragment; next_keys (for all data)
TLS| sendHandshake
TLS| send Handshake fragment with index PlaintextID
TLS| Sending fragment of length 297
REC| record headers: 1603030129
EPO| writer++ -1/0
TLS| read: WrittenHS, Ctrl/Open, new writer: writable
client returns client_early_data clen=302 slen=0
early secret=ef4d7e7aa54a2d356d201939620236fa8fae7ff63da116ca9e21c3220bf1e25e
ClientHello[ 302] ---->

TLS| writeHandshake (plaintext)
TLS| HS.next_fragment PlaintextID?
HS | next_fragment
TLS| HS.next_fragment returned nothing
TLS| sendHandshake
TLS| read: WrittenHS, Ctrl/Ctrl, nothing
TLS| Read fragment at epoch index: -1 of length 297
TLS| read Handshake fragment
HS | recv_fragment
HSL| parsed [ClientHello; Binders] -- end of flight 
HS | Processing ClientHello with 1 binder(s)
NGO| offered client extensions [ 001a supported_versions key_share server_name alpn extended_master_secret signature_algorithms supported_groups psk_key_exchange_modes early_data pre_shared_key ]
NGO| offered cipher suites ; TLS_CHACHA20_POLY1305_SHA256; TLS_AES_128_GCM_SHA256
NGO| offered versions 1.3
TCK| Decrypting ticket 44cbbcb4b5d388b63ab7931524717c1438d6eec05af49105538e93a6870a286866b0c392b8c9dade1cad0dfa2005cec4d88e625c077ed7c9dff4b41e54b9081c58234cf412999f3dda7b7cb0
TCK| Parsing ticket 030413035b22e906cf74b8c400000020febf9cd38765752bac2bf5705137346c83ca56db974a126208a3da08f48af5e5
NGO| Negotiated PSK_EDH key exchange
NGO| Negotiation callback to handle extra extensions and query for stateless retry.
NGO| Application data in cookie: none
@@@@ Nego callback for TLS 1.3 @@@@
Offered extensions:
003d001a0009ffff00050a0b0c0d0e0000000e000c0000096c6f63616c686f73
740010000800060568712d3130000d0006000408040403000a00040002001d
Transport parameters offered:
ffff00050a0b0c0d0e
No application cookie (fist connection).
Adding server transport parameters:
000102
@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
NGO| negotiated 1.3 TLS_CHACHA20_POLY1305_SHA256
HS | accepted TLS 1.3 psk #0
KS | ks_server_init
KS | Using negotiated PSK identity: 44cbbcb4b5d388b63ab7931524717c1438d6eec05af49105538e93a6870a286866b0c392b8c9dade1cad0dfa2005cec4d88e625c077ed7c9dff4b41e54b9081c58234cf412999f3dda7b7cb0
TCK| Decrypting ticket 44cbbcb4b5d388b63ab7931524717c1438d6eec05af49105538e93a6870a286866b0c392b8c9dade1cad0dfa2005cec4d88e625c077ed7c9dff4b41e54b9081c58234cf412999f3dda7b7cb0
TCK| Parsing ticket 030413035b22e906cf74b8c400000020febf9cd38765752bac2bf5705137346c83ca56db974a126208a3da08f48af5e5
KS | Ticket RMS: febf9cd38765752bac2bf5705137346c83ca56db974a126208a3da08f48af5e5
KS | Pre-shared key: aa077b7865e1d7d4582059ecde6f29ef663944fdc6f8ececddfbf29346b45993
KS | binder key:                      7f0b8bc1d0e055cee5f4b993c73150922507db01f0fe5d3caeec2147f84d2055
KS | binder Finished key:             a4d48a795dcd88214d49bc53a91aba70ba1a6e9fa3c5cf24a71819162f30d95a
KS | Computed early secret:           7780a9e2ecf2e64b8ad04b18878c6cde7bf622ff0fe83ab09e90cea0b7e46d37
KS | Handshake salt:                  1c890d9c8ab3797d70ad85d794994e2b4df2000beeab1b0cbf75a5bc5084a4b3
CDH| Keygen (responder) on X255519
CDH| DH initiator on X255519
KS | DH shared secret: f52811618fa9b73a233e6db9860895b9f04a7fce235c683a05b43522f62dc549
KS | Handshake secret:                f56ab860fc13132aad67fda4b328f7814bc97db5984935b234289f8eb231f030
NGO| processing client extensions [ 001a supported_versions key_share server_name alpn extended_master_secret signature_algorithms supported_groups psk_key_exchange_modes early_data pre_shared_key ]
NGO| including server extensions (SH + EE) [ supported_versions key_share alpn supported_groups early_data pre_shared_key ]
NGO| extra extensions from application callback: 001a 
HSL| emit ServerHello and hash
KS | ks_server_13_0rtt_key
KS | Client early traffic secret:     d10ea800c3b8f1f6f278630183b24ef2ff6b6dda87183f64a674977c454caa4d
KS | Early exporter master secret:    ef4d7e7aa54a2d356d201939620236fa8fae7ff63da116ca9e21c3220bf1e25e
KS | Client 0-RTT key:                1e023eb49788486848acab4edffd5c6b838139028ea339f3c9fcf3f98a571b8e, IV=db5f2e93824ef0225c0963e2
AEP| LowProvider: COERCE(K=1e023eb49788486848acab4edffd5c6b838139028ea339f3c9fcf3f98a571b8e)
HS | exporting a key
HS | derive handshake keys
KS | ks_server_13_sh, hashed log = 9d581789ce307fc9a0543d378e8a1d238de378026edd35bcc8bc5b61da10348b
KS | handshake traffic secret[C]:     7b3a2ff5a00cd2777a13adceb11c6488dfb9dd85c3d8b41b98614af718898ceb
KS | handshake traffic secret[S]:     fb72ef98ea8552c2838a3de02679420ad91bb6744890192f4ff3d3cd2c7153a5
KS | handshake key[C]:                cbc94d05331b620d58a3aa70a5cec1e32b811d9de6e9ce4060f13635357c56ba, IV=5e6f72c7fed5964a43889b3d
KS | handshake key[S]: 9687a4bd729c7dedff06f3aec7f8e5ec43a1b43619aa3b47dce3ff421ab907e0, IV=0bc9eece20c3359ec3472e0e
AEP| LowProvider: COERCE(K=9687a4bd729c7dedff06f3aec7f8e5ec43a1b43619aa3b47dce3ff421ab907e0)
AEP| LowProvider: COERCE(K=cbc94d05331b620d58a3aa70a5cec1e32b811d9de6e9ce4060f13635357c56ba)
KS | finished key[C]:                 ae33b06e35361416b41d5d0d68f8655c36687a7b73e3029e2c261df4f359f5d4
KS | finished key[S]:                 c01d5541ac311b53d26921e2071c7774e20f10a6deed3b343275b9ee7868f341
KS | Application salt:                0d59688ceb69d7ad68811795544ed6356842917292ef7833a4b709e1310a2a93
KS | Application secret:              b412ba4fae643c595101434635b9700daf58d637acdf9fbbbc8a3b0941780052
TLS| readOne ReadAgain
TLS| writeHandshake (plaintext)
TLS| HS.next_fragment PlaintextID?
HS | next_fragment
TLS| HS.next_fragment returned a fragment; next_keys (for handshake only skipping 0RTT
TLS| sendHandshake
TLS| send Handshake fragment with index PlaintextID
TLS| Sending fragment of length 96
REC| record headers: 1603030060
EPO| writer++ -1/0
EPO| writer++ -1/1
TLS| writeHandshake (encrypted)
TLS| HS.next_fragment ID13?
HS | next_fragment
HS | prepare Server Finished
HSL| emit EncryptedExtensions and hash
HSL| emit Finished and hash
KS | ks_server_13_sf hashed_log = a496cd6ce4745405223bd2ed31294bc6debac2d8374d9502aab264d7d35df9dd
KS | application traffic secret[C]:   2b0d51bd77139865efefcb14c85e8b82c76832e56e8eaea08c78045e95f2c2b3
KS | application traffic secret[S]:   73bcdda68998c8d6b9d939dc67200563c14f589f744e74b41543b37d23ded2c5
KS | exporter master secret:          659afecfc8a0ad88d552fac46fed440ab53db0b9d7d3a170f907225031eac6c7
KS | application key[C]:              4a0cda1c2f8d0e05d44c459509e174b38061d718e8628448106ffbccbb610f94, IV=fc14797588e2ae16d1370049
KS | application key[S]:              7fb54b605a99fcf4d8478810b18d63fb8cfbf507bfd62779bdf638e7e26206bf, IV=ba3cb494e10db17e9de9c864
AEP| LowProvider: COERCE(K=7fb54b605a99fcf4d8478810b18d63fb8cfbf507bfd62779bdf638e7e26206bf)
AEP| LowProvider: COERCE(K=4a0cda1c2f8d0e05d44c459509e174b38061d718e8628448106ffbccbb610f94)
HS | exporting a key
EPO| reader++ 0/1
TLS| HS.next_fragment returned a fragment; next_keys (for all data)
TLS| sendHandshake
TLS| send Handshake fragment with index ID13
TLS| Encrypting with key 9687a4bd729c7dedff06f3aec7f8e5ec43a1b43619aa3b47dce3ff421ab907e0
TLS| Sending fragment of length 90
REC| record headers: 170303005a
EPO| writer++ 0/2
TLS| read: WrittenHS, Ctrl/Open, new writer: writable
server returns server_accept_early_data clen=302 slen=196
early secret=ef4d7e7aa54a2d356d201939620236fa8fae7ff63da116ca9e21c3220bf1e25e
secret=659afecfc8a0ad88d552fac46fed440ab53db0b9d7d3a170f907225031eac6c7
<---- ServerHello;(EncryptedExtensions; Certificate; CertVerify; Finished)[ 196]

TLS| writeHandshake (encrypted)
TLS| HS.next_fragment ID13?
HS | next_fragment
TLS| HS.next_fragment returned nothing
TLS| sendHandshake
TLS| read: WrittenHS, Ctrl/Open, nothing
TLS| Read fragment at epoch index: -1 of length 96
TLS| read Handshake fragment
HS | recv_fragment
HSL| parsed ServerHello
HSL| end of flight
HS | client_ServerHello
NGO| processing server extensions [ supported_versions key_share pre_shared_key ]
NGO| negotiated 1.3 TLS_CHACHA20_POLY1305_SHA256
HS | Running TLS 1.3
KS | ks_client_13_sh hashed_log = 9d581789ce307fc9a0543d378e8a1d238de378026edd35bcc8bc5b61da10348b
KS | recallPSK early secret:          7780a9e2ecf2e64b8ad04b18878c6cde7bf622ff0fe83ab09e90cea0b7e46d37
KS | handshake salt:                  1c890d9c8ab3797d70ad85d794994e2b4df2000beeab1b0cbf75a5bc5084a4b3
CDH| DH initiator on X255519
KS | DH shared secret: f52811618fa9b73a233e6db9860895b9f04a7fce235c683a05b43522f62dc549
KS | handshake secret:                f56ab860fc13132aad67fda4b328f7814bc97db5984935b234289f8eb231f030
KS | handshake traffic secret[C]:     7b3a2ff5a00cd2777a13adceb11c6488dfb9dd85c3d8b41b98614af718898ceb
KS | handshake traffic secret[S]:     fb72ef98ea8552c2838a3de02679420ad91bb6744890192f4ff3d3cd2c7153a5
KS | handshake key[C]:                cbc94d05331b620d58a3aa70a5cec1e32b811d9de6e9ce4060f13635357c56ba, IV=5e6f72c7fed5964a43889b3d
KS | handshake key[S]:                9687a4bd729c7dedff06f3aec7f8e5ec43a1b43619aa3b47dce3ff421ab907e0, IV=0bc9eece20c3359ec3472e0e
KS | finished key[C]: ae33b06e35361416b41d5d0d68f8655c36687a7b73e3029e2c261df4f359f5d4
KS | finished key[S]: c01d5541ac311b53d26921e2071c7774e20f10a6deed3b343275b9ee7868f341
KS | application salt:                0d59688ceb69d7ad68811795544ed6356842917292ef7833a4b709e1310a2a93
KS | application secret:              b412ba4fae643c595101434635b9700daf58d637acdf9fbbbc8a3b0941780052
AEP| LowProvider: COERCE(K=cbc94d05331b620d58a3aa70a5cec1e32b811d9de6e9ce4060f13635357c56ba)
AEP| LowProvider: COERCE(K=9687a4bd729c7dedff06f3aec7f8e5ec43a1b43619aa3b47dce3ff421ab907e0)
HS | 0RTT potentially accepted (wait for EE to confirm)
EPO| reader++ 0/0
EPO| reader++ 1/0
TLS| readOne ReadAgain
TLS| writeHandshake (encrypted)
TLS| HS.next_fragment ID13?
HS | next_fragment
TLS| HS.next_fragment returned nothing
TLS| sendHandshake
TLS| read: WrittenHS, Ctrl/Open, nothing
TLS| Read fragment at epoch index: 1 of length 90
TLS| StAE decrypt correct.
TLS| read Handshake fragment
HS | recv_fragment
HSL| parsed EncryptedExtensions
HSL| parsed Finished
HSL| end of flight
NGO| Nego.clientComplete_13
NGO| EE: alpn supported_groups early_data 001a 
NGO| Negotiation callback to process application extensions.
@@@@ Nego callback for TLS 1.3 @@@@
Offered extensions:
001b0010000800060568712d3130000a00040002001d001a0003000102
Transport parameters offered:
000102
No application cookie (fist connection).
Adding server transport parameters:
000102
@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
NGO| Certificate & signature 1.3 callback result: valid
KS | ks_client_13_sf hashed_log = a496cd6ce4745405223bd2ed31294bc6debac2d8374d9502aab264d7d35df9dd
KS | application traffic secret[C]:   2b0d51bd77139865efefcb14c85e8b82c76832e56e8eaea08c78045e95f2c2b3
KS | application traffic secret[S]:   73bcdda68998c8d6b9d939dc67200563c14f589f744e74b41543b37d23ded2c5
KS | exporter master secret:          659afecfc8a0ad88d552fac46fed440ab53db0b9d7d3a170f907225031eac6c7
KS | application key[C]:              4a0cda1c2f8d0e05d44c459509e174b38061d718e8628448106ffbccbb610f94, IV=fc14797588e2ae16d1370049
KS | application key[S]:              7fb54b605a99fcf4d8478810b18d63fb8cfbf507bfd62779bdf638e7e26206bf, IV=ba3cb494e10db17e9de9c864
AEP| LowProvider: COERCE(K=4a0cda1c2f8d0e05d44c459509e174b38061d718e8628448106ffbccbb610f94)
AEP| LowProvider: COERCE(K=7fb54b605a99fcf4d8478810b18d63fb8cfbf507bfd62779bdf638e7e26206bf)
HS | exporting a key
HS | Early data accepted; emitting EOED.
HSL| emit EndOfEarlyData and hash
TLS| readOne ReadAgain
TLS| writeHandshake (encrypted)
TLS| HS.next_fragment ID13?
HS | next_fragment
TLS| HS.next_fragment returned a fragment; next_keys (for handshake only
TLS| sendHandshake
TLS| send Handshake fragment with index ID13
TLS| Encrypting with key 1e023eb49788486848acab4edffd5c6b838139028ea339f3c9fcf3f98a571b8e
TLS| Sending fragment of length 21
REC| record headers: 1703030015
EPO| writer++ 1/1
TLS| writeHandshake (encrypted)
TLS| HS.next_fragment ID13?
HS | next_fragment
HSL| emit Finished and hash
KS | ks_client_13_cf hashed_log = 2070d55cd9a59b44353645be9a2689d3aad57c16e3f38c332025ca5b4e18b6e5
KS | resumption master secret:        0763a87046ea4991e9e91c4346daa7af02fafc368b338639e864760bdb559343
EPO| reader++ 2/1
TLS| HS.next_fragment returned a fragment; next_keys (for all data); complete
TLS| sendHandshake
TLS| send Handshake fragment with index ID13
TLS| Encrypting with key cbc94d05331b620d58a3aa70a5cec1e32b811d9de6e9ce4060f13635357c56ba
TLS| Sending fragment of length 53
REC| record headers: 1703030035
EPO| writer++ 2/2
TLS| read: WrittenHS, Open/Open, new writer: complete
client returns client_complete_early_data clen=84 slen=196
secret=659afecfc8a0ad88d552fac46fed440ab53db0b9d7d3a170f907225031eac6c7
(Finished) [  84] ---->

TLS| writeHandshake (encrypted)
TLS| HS.next_fragment ID13?
HS | next_fragment
TLS| HS.next_fragment returned nothing
TLS| sendHandshake
TLS| read: WrittenHS, Ctrl/Open, nothing
TLS| Read fragment at epoch index: 0 of length 21
TLS| StAE decrypt correct.
TLS| read Handshake fragment
HS | recv_fragment
HSL| parsed EndOfEarlyData
HSL| end of flight
HS | Process EOED (increment reader to HS key)
EPO| reader++ 1/2
TLS| readOne ReadAgain
TLS| writeHandshake (encrypted)
TLS| HS.next_fragment ID13?
HS | next_fragment
TLS| HS.next_fragment returned nothing
TLS| sendHandshake
TLS| read: WrittenHS, Ctrl/Open, nothing
TLS| Read fragment at epoch index: 1 of length 53
TLS| StAE decrypt correct.
TLS| read Handshake fragment
HS | recv_fragment
HSL| parsed Finished
HSL| end of flight
HS | Process Client Finished
KS | ks_server_13_cf hashed_log = 2070d55cd9a59b44353645be9a2689d3aad57c16e3f38c332025ca5b4e18b6e5
KS | resumption master secret:        0763a87046ea4991e9e91c4346daa7af02fafc368b338639e864760bdb559343
HS | Sending ticket: 4e48d424a4470c0934d87b411a4234808de493b30e131e79156bf495c6b7391e52a79abdc21429bf275489b10fe136aed6af7c38e0d713c345b0e8ed1d94586930fd5452010e8cf746e04da6
HSL| emit NewSessionTicket13
EPO| reader++ 2/2
TLS| readOne Complete
server returns clen=84 slen=0 status=server_complete
TLS| writeHandshake (encrypted)
TLS| HS.next_fragment ID13?
HS | next_fragment
TLS| HS.next_fragment returned a fragment
TLS| sendHandshake
TLS| send Handshake fragment with index ID13
TLS| Encrypting with key 7fb54b605a99fcf4d8478810b18d63fb8cfbf507bfd62779bdf638e7e26206bf
TLS| Sending fragment of length 130
REC| record headers: 1703030082
TLS| writeHandshake (encrypted)
TLS| HS.next_fragment ID13?
HS | next_fragment
TLS| HS.next_fragment returned nothing
TLS| sendHandshake
TLS| read: WrittenHS, Open/Open, nothing
REC| WouldBlock
TLS| readOne ReadWouldBlock
server returns would_block clen=0 slen=135
<---- {Ticket}[ 135]
TLS| writeHandshake (encrypted)
TLS| HS.next_fragment ID13?
HS | next_fragment
TLS| HS.next_fragment returned nothing
TLS| sendHandshake
TLS| read: WrittenHS, Open/Open, nothing
TLS| Read fragment at epoch index: 2 of length 130
TLS| StAE decrypt correct.
TLS| read Handshake fragment
HS | recv_fragment
HSL| parsed NewSessionTicket13
HSL| end of flight
HS | Received ticket: 4e48d424a4470c0934d87b411a4234808de493b30e131e79156bf495c6b7391e52a79abdc21429bf275489b10fe136aed6af7c38e0d713c345b0e8ed1d94586930fd5452010e8cf746e04da6
KS | ks_client_13_rms
KS | Recall RMS: 0763a87046ea4991e9e91c4346daa7af02fafc368b338639e864760bdb559343

##### New session ticket received! #####
Host: localhost
Ticket:
4e48d424a4470c0934d87b411a4234808de493b30e131e79156bf495c6b7391e
52a79abdc21429bf275489b10fe136aed6af7c38e0d713c345b0e8ed1d945869
30fd5452010e8cf746e04da6
########################################
TLS| readOne ReadAgain
TLS| writeHandshake (encrypted)
TLS| HS.next_fragment ID13?
HS | next_fragment
TLS| HS.next_fragment returned nothing
TLS| sendHandshake
TLS| read: WrittenHS, Open/Open, nothing
REC| WouldBlock
TLS| readOne ReadWouldBlock
client returns clen=0 slen=135 status=would_block
Ok
./quic.exe hrr

STATELESS RETRY TEST

server create
FFI| offering custom extension 001a
FFI| extension contents: ffff00050a0b0c0d0e
FFI| setting early data limit to ffffffff
FFI| Setting a new ticket callback.
FFI| Setting a new server negotiation callback.
FFI| Setting up certificate callbacks.
client create
FFI| offering custom extension 001a
FFI| extension contents: ffff00050a0b0c0d0e
FFI| setting early data limit to ffffffff
FFI| Setting a new ticket callback.
FFI| Setting a new server negotiation callback.
FFI| Setting up certificate callbacks.
TLS| writeHandshake (plaintext)
TLS| HS.next_fragment PlaintextID?
HS | next_fragment
HS | offering ClientHello 1.3
KS | ks_client_init 1.3
CDH| Keygen (initiator) on X255519
NGO| No PSK or 0-RTT disabled
NGO| offering client extensions [ 001a supported_versions key_share server_name alpn extended_master_secret signature_algorithms supported_groups psk_key_exchange_modes ]
NGO| offering cipher suites ; TLS_CHACHA20_POLY1305_SHA256; TLS_AES_128_GCM_SHA256
HSL| emit ClientHello
TLS| HS.next_fragment returned a fragment
TLS| sendHandshake
TLS| send Handshake fragment with index PlaintextID
TLS| Sending fragment of length 170
REC| record headers: 16030300aa
TLS| writeHandshake (plaintext)
TLS| HS.next_fragment PlaintextID?
HS | next_fragment
TLS| HS.next_fragment returned nothing
TLS| sendHandshake
TLS| read: WrittenHS, Ctrl/Ctrl, nothing
REC| WouldBlock
TLS| readOne ReadWouldBlock
client returns would_block clen=175 slen=0
ClientHello[ 175] ---->

~~~~~~~~~ Client Hello Summary ~~~~~~~~~~~
~ SNI = localhost
~ ALPN = 00060568712d3130
~ Cookie = NULL
~ Extensions = 0079001a0009ffff00050a0b0c0d0e002b0003027f1c003300260024001d0020
6865bcff4227dbed9ccf9c37f7c6a45e5b4ee990ff5264e453029fb33fd47c15
0000000e000c0000096c6f63616c686f73740010000800060568712d31300017
0000000d0006000408040403000a00040002001d002d0003020001
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
TLS| writeHandshake (plaintext)
TLS| HS.next_fragment PlaintextID?
HS | next_fragment
TLS| HS.next_fragment returned nothing
TLS| sendHandshake
TLS| read: WrittenHS, Ctrl/Ctrl, nothing
TLS| Read fragment at epoch index: -1 of length 170
TLS| read Handshake fragment
HS | recv_fragment
HSL| parsed [ClientHello] -- end of flight 
HS | Processing ClientHello
NGO| offered client extensions [ 001a supported_versions key_share server_name alpn extended_master_secret signature_algorithms supported_groups psk_key_exchange_modes ]
NGO| offered cipher suites ; TLS_CHACHA20_POLY1305_SHA256; TLS_AES_128_GCM_SHA256
NGO| offered versions 1.3
NGO| Negotiated Pure EDH key exchange
NGO| Negotiated ECDSA_SECP256R1_SHA256
NGO| Negotiation callback to handle extra extensions and query for stateless retry.
NGO| Application data in cookie: none
@@@@ Nego callback for TLS 1.3 @@@@
Offered extensions:
003d001a0009ffff00050a0b0c0d0e0000000e000c0000096c6f63616c686f73
740010000800060568712d3130000d0006000408040403000a00040002001d
Transport parameters offered:
ffff00050a0b0c0d0e
No application cookie (fist connection).
Adding server transport parameters:
000102
@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
AEP| LowProvider: COERCE(K=11d08f7895408006a71bb7941042e51c723af70b7e327dec7e2be17da631f9c2)
TCK| Encrypting cookie: 0000320200002e0303cf21ad74e59a6111be1d8c021e65b891c2a211167abb8c5e079e09e2c8a8339c001303000006002b00027f1c20c48de6f1e80bc4c0fc1d60293eacb8515800b85ec4b3848baee441da0df5f61e000b48656c6c6f20576f726c64
TCK| Encrypted cookie:  c02a031251101c182741d646edc99d76d9064555b525be198602beacd835cdafaae68f3618bffb19642fd506a2d7a5e7a35a4ad7235af47a8f6d6b9c6c1a1aa802e5d20fbad698ad838d325b992e2373b6188a0d00a4e0e0b28fad04307a734dd7b322d710ed2d226b9c944c42d4939ba5be7f6325837d2021f6ee1a531c0b
HSL| emit HelloRetryRequest
TLS| readOne ReadAgain
TLS| writeHandshake (plaintext)
TLS| HS.next_fragment PlaintextID?
HS | next_fragment
TLS| HS.next_fragment returned a fragment
TLS| sendHandshake
TLS| send Handshake fragment with index PlaintextID
TLS| Sending fragment of length 183
REC| record headers: 16030300b7
TLS| writeHandshake (plaintext)
TLS| HS.next_fragment PlaintextID?
HS | next_fragment
TLS| HS.next_fragment returned nothing
TLS| sendHandshake
TLS| read: WrittenHS, Ctrl/Ctrl, nothing
REC| WouldBlock
TLS| readOne ReadWouldBlock
server returns server_stateless_retry clen=175 slen=188
<---- HRR[ 188]

server re-create
FFI| offering custom extension 001a
FFI| extension contents: ffff00050a0b0c0d0e
FFI| setting early data limit to ffffffff
FFI| Setting a new ticket callback.
FFI| Setting a new server negotiation callback.
FFI| Setting up certificate callbacks.
TLS| writeHandshake (plaintext)
TLS| HS.next_fragment PlaintextID?
HS | next_fragment
TLS| HS.next_fragment returned nothing
TLS| sendHandshake
TLS| read: WrittenHS, Ctrl/Ctrl, nothing
TLS| Read fragment at epoch index: -1 of length 183
TLS| read Handshake fragment
HS | recv_fragment
HSL| parsed HelloRetryRequest
HSL| end of flight
HSL| Replacing CH1 in transcript with fe000020c48de6f1e80bc4c0fc1d60293eacb8515800b85ec4b3848baee441da0df5f61e
HSL| HRR bytes: 020000b30303cf21ad74e59a6111be1d8c021e65b891c2a211167abb8c5e079e09e2c8a8339c00130300008b002c0081007fc02a031251101c182741d646edc99d76d9064555b525be198602beacd835cdafaae68f3618bffb19642fd506a2d7a5e7a35a4ad7235af47a8f6d6b9c6c1a1aa802e5d20fbad698ad838d325b992e2373b6188a0d00a4e0e0b28fad04307a734dd7b322d710ed2d226b9c944c42d4939ba5be7f6325837d2021f6ee1a531c0b002b00027f1c
HS | client_HelloRetryRequest
HS | Server did not specify a group in HRR, re-using the previous choice
NGO| Got HRR, extensions: [cookie supported_versions ]
HSL| emit ClientHello
TLS| readOne ReadAgain
TLS| writeHandshake (plaintext)
TLS| HS.next_fragment PlaintextID?
HS | next_fragment
TLS| HS.next_fragment returned a fragment
TLS| sendHandshake
TLS| send Handshake fragment with index PlaintextID
TLS| Sending fragment of length 303
REC| record headers: 160303012f
TLS| writeHandshake (plaintext)
TLS| HS.next_fragment PlaintextID?
HS | next_fragment
TLS| HS.next_fragment returned nothing
TLS| sendHandshake
TLS| read: WrittenHS, Ctrl/Ctrl, nothing
REC| WouldBlock
TLS| readOne ReadWouldBlock
client returns would_block clen=308 slen=188
ClientHello2[ 308] ---->

TCK| Decrypting cookie c02a031251101c182741d646edc99d76d9064555b525be198602beacd835cdafaae68f3618bffb19642fd506a2d7a5e7a35a4ad7235af47a8f6d6b9c6c1a1aa802e5d20fbad698ad838d325b992e2373b6188a0d00a4e0e0b28fad04307a734dd7b322d710ed2d226b9c944c42d4939ba5be7f6325837d2021f6ee1a531c0b
TCK| Plain cookie: 0000320200002e0303cf21ad74e59a6111be1d8c021e65b891c2a211167abb8c5e079e09e2c8a8339c001303000006002b00027f1c20c48de6f1e80bc4c0fc1d60293eacb8515800b85ec4b3848baee441da0df5f61e000b48656c6c6f20576f726c64
~~~~~~~~~ Client Hello Summary ~~~~~~~~~~~
~ SNI = localhost
~ ALPN = 00060568712d3130
~ Cookie = 48656c6c6f20576f726c64
~ Extensions = 00fe002c0081007fc02a031251101c182741d646edc99d76d9064555b525be19
8602beacd835cdafaae68f3618bffb19642fd506a2d7a5e7a35a4ad7235af47a
8f6d6b9c6c1a1aa802e5d20fbad698ad838d325b992e2373b6188a0d00a4e0e0
b28fad04307a734dd7b322d710ed2d226b9c944c42d4939ba5be7f6325837d20
21f6ee1a531c0b001a0009ffff00050a0b0c0d0e002b0003027f1c0033002600
24001d00206865bcff4227dbed9ccf9c37f7c6a45e5b4ee990ff5264e453029f
b33fd47c150000000e000c0000096c6f63616c686f7374001000080006056871
2d313000170000000d0006000408040403000a00040002001d002d0003020001
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
TLS| writeHandshake (plaintext)
TLS| HS.next_fragment PlaintextID?
HS | next_fragment
TLS| HS.next_fragment returned nothing
TLS| sendHandshake
TLS| read: WrittenHS, Ctrl/Ctrl, nothing
TLS| Read fragment at epoch index: -1 of length 303
TLS| read Handshake fragment
HS | recv_fragment
HSL| parsed [ClientHello] -- end of flight 
HS | Processing ClientHello
NGO| offered client extensions [ cookie 001a supported_versions key_share server_name alpn extended_master_secret signature_algorithms supported_groups psk_key_exchange_modes ]
NGO| offered cipher suites ; TLS_CHACHA20_POLY1305_SHA256; TLS_AES_128_GCM_SHA256
NGO| offered versions 1.3
NGO| Negotiated Pure EDH key exchange
NGO| Negotiated ECDSA_SECP256R1_SHA256
TCK| Decrypting cookie c02a031251101c182741d646edc99d76d9064555b525be198602beacd835cdafaae68f3618bffb19642fd506a2d7a5e7a35a4ad7235af47a8f6d6b9c6c1a1aa802e5d20fbad698ad838d325b992e2373b6188a0d00a4e0e0b28fad04307a734dd7b322d710ed2d226b9c944c42d4939ba5be7f6325837d2021f6ee1a531c0b
TCK| Plain cookie: 0000320200002e0303cf21ad74e59a6111be1d8c021e65b891c2a211167abb8c5e079e09e2c8a8339c001303000006002b00027f1c20c48de6f1e80bc4c0fc1d60293eacb8515800b85ec4b3848baee441da0df5f61e000b48656c6c6f20576f726c64
NGO| Loaded stateless retry cookie c02a031251101c182741d646edc99d76d9064555b525be198602beacd835cdafaae68f3618bffb19642fd506a2d7a5e7a35a4ad7235af47a8f6d6b9c6c1a1aa802e5d20fbad698ad838d325b992e2373b6188a0d00a4e0e0b28fad04307a734dd7b322d710ed2d226b9c944c42d4939ba5be7f6325837d2021f6ee1a531c0b
NGO| Overwriting the transcript digest with CH1 hash c48de6f1e80bc4c0fc1d60293eacb8515800b85ec4b3848baee441da0df5f61e
HSL| Installing prefix to transcript: fe000020c48de6f1e80bc4c0fc1d60293eacb8515800b85ec4b3848baee441da0df5f61e
HSL| HRR bytes: 020000b30303cf21ad74e59a6111be1d8c021e65b891c2a211167abb8c5e079e09e2c8a8339c00130300008b002c0081007fc02a031251101c182741d646edc99d76d9064555b525be198602beacd835cdafaae68f3618bffb19642fd506a2d7a5e7a35a4ad7235af47a8f6d6b9c6c1a1aa802e5d20fbad698ad838d325b992e2373b6188a0d00a4e0e0b28fad04307a734dd7b322d710ed2d226b9c944c42d4939ba5be7f6325837d2021f6ee1a531c0b002b00027f1c
NGO| Negotiation callback to handle extra extensions and query for stateless retry.
NGO| Application data in cookie: 48656c6c6f20576f726c64
@@@@ Nego callback for TLS 1.3 @@@@
Offered extensions:
003d001a0009ffff00050a0b0c0d0e0000000e000c0000096c6f63616c686f73
740010000800060568712d3130000d0006000408040403000a00040002001d
Transport parameters offered:
ffff00050a0b0c0d0e
Stateless cookie found, application contents:
48656c6c6f20576f726c64
Adding server transport parameters:
000102
@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
NGO| negotiated 1.3 TLS_CHACHA20_POLY1305_SHA256
KS | ks_server_init
KS | No PSK selected.
KS | Computed early secret:           33ad0a1c607ec03b09e6cd9893680ce210adf300aa1f2660e1b22e10f170f92a
KS | Handshake salt:                  6f2615a108c702c5678f54fc9dbab69716c076189c48250cebeac3576c3611ba
CDH| Keygen (responder) on X255519
CDH| DH initiator on X255519
KS | DH shared secret: 30f584f5b1e1a23579a5a254ea776144de75c3013ce7772be1af123fb690f72f
KS | Handshake secret:                90f422dc4ac32cfe5dae1219f306e5e4fab96632b43017e7280f2dd25c1bea5d
NGO| processing client extensions [ cookie 001a supported_versions key_share server_name alpn extended_master_secret signature_algorithms supported_groups psk_key_exchange_modes ]
NGO| including server extensions (SH + EE) [ supported_versions key_share alpn supported_groups ]
NGO| extra extensions from application callback: 001a 
HSL| emit ServerHello and hash
HS | derive handshake keys
KS | ks_server_13_sh, hashed log = 86cebf24cc974e06d0ff15d93bbba94bb68a17c9f5fd3d32bb0ece4e1a5013cb
KS | handshake traffic secret[C]:     af1106a697e54242209b56dd28d934075addf87ed9e801c32011148d1e69265e
KS | handshake traffic secret[S]:     80b744cd40f862423f26765915d4808652d87ebbca4238e0a5ca6d7a49fefc8e
KS | handshake key[C]:                2bc639f7311522474189ef3cab2a71ad06f85c2c3ed31a110ef8db02bc16ab59, IV=86d6c1205d73989b0e97fba5
KS | handshake key[S]: 552637fb0cfd45918ea635182d394f17f59e769cc89ac5454dae1a02b9484a31, IV=d1527182aaf552216b28e64e
AEP| LowProvider: COERCE(K=552637fb0cfd45918ea635182d394f17f59e769cc89ac5454dae1a02b9484a31)
AEP| LowProvider: COERCE(K=2bc639f7311522474189ef3cab2a71ad06f85c2c3ed31a110ef8db02bc16ab59)
KS | finished key[C]:                 69ff943290c397d70a7e8ae5e0623063e637d2d3d3e61a7516e5ff6a69592386
KS | finished key[S]:                 5318699d04d987316e62fdc1e2b69d211dd68a6ec2c37903ed176697758dd73c
KS | Application salt:                fa17e1b3711ba6c6cfb2a1f8b295e48b58b8e0314072284c797be040503bdd9b
KS | Application secret:              33c144822fd35737be3f0326932b8cdcacfb6e557c40945b853391a2ed7e7ece
TLS| readOne ReadAgain
TLS| writeHandshake (plaintext)
TLS| HS.next_fragment PlaintextID?
HS | next_fragment
TLS| HS.next_fragment returned a fragment; next_keys (for handshake only
TLS| sendHandshake
TLS| send Handshake fragment with index PlaintextID
TLS| Sending fragment of length 90
REC| record headers: 160303005a
EPO| writer++ -1/0
TLS| writeHandshake (encrypted)
TLS| HS.next_fragment ID13?
HS | next_fragment
HS | prepare Server Finished
HSL| emit EncryptedExtensions
HSL| emit Certificate13 and hash
======== TO BE SIGNED <0403>: (130 octets) ========
2020202020202020202020202020202020202020202020202020202020202020
2020202020202020202020202020202020202020202020202020202020202020
544c5320312e332c207365727665722043657274696669636174655665726966
79002036fda0df0ccebda1e1c69d46f870dff5e82b8a26a7d1bbc7670c667699
0eaa
===================================================
HSL| emit CertificateVerify and hash
HSL| emit Finished and hash
KS | ks_server_13_sf hashed_log = 653d39ec548eb727df8ae5c08fe68e3d59edc692f18b37105c43f43f1cf7892a
KS | application traffic secret[C]:   8e460c43a86d1b82ceb816d6ae90a078661144bc45f21f73781f97b432d0d77a
KS | application traffic secret[S]:   07df439164dffb330ea488b9bd04603e3404f68571d1cfd4c4706832731fb8b8
KS | exporter master secret:          bfaaf4a616d27d1f03d79de54db89e04c06311178e846fa41de8646e8dda1c2e
KS | application key[C]:              dcfa751d588b96fb4d2b28a6e81f39700ac07ca4bfd864c9ac76f52cac22aa52, IV=260bdb22b5ca9b16c4380f0c
KS | application key[S]:              eb5f4425314ced0c65f744fe4089e4ec95df2d020feff753f01a45caa620ad83, IV=4b9682583337c4adedc6be93
AEP| LowProvider: COERCE(K=eb5f4425314ced0c65f744fe4089e4ec95df2d020feff753f01a45caa620ad83)
AEP| LowProvider: COERCE(K=dcfa751d588b96fb4d2b28a6e81f39700ac07ca4bfd864c9ac76f52cac22aa52)
HS | exporting a key
EPO| reader++ 0/0
TLS| HS.next_fragment returned a fragment; next_keys (for all data)
TLS| sendHandshake
TLS| send Handshake fragment with index ID13
TLS| Encrypting with key 552637fb0cfd45918ea635182d394f17f59e769cc89ac5454dae1a02b9484a31
TLS| Sending fragment of length 735
REC| record headers: 17030302df
EPO| writer++ 0/1
TLS| read: WrittenHS, Ctrl/Open, new writer: writable
server returns server_accept clen=308 slen=835
secret=bfaaf4a616d27d1f03d79de54db89e04c06311178e846fa41de8646e8dda1c2e
<---- ServerHello;(EncryptedExtensions; Certificate; CertVerify; Finished)[ 835]

TLS| writeHandshake (plaintext)
TLS| HS.next_fragment PlaintextID?
HS | next_fragment
TLS| HS.next_fragment returned nothing
TLS| sendHandshake
TLS| read: WrittenHS, Ctrl/Ctrl, nothing
TLS| Read fragment at epoch index: -1 of length 90
TLS| read Handshake fragment
HS | recv_fragment
HSL| parsed ServerHello
HSL| end of flight
HS | client_ServerHello
NGO| processing server extensions [ supported_versions key_share ]
NGO| negotiated 1.3 TLS_CHACHA20_POLY1305_SHA256
HS | Running TLS 1.3
KS | ks_client_13_sh hashed_log = 86cebf24cc974e06d0ff15d93bbba94bb68a17c9f5fd3d32bb0ece4e1a5013cb
KS | no PSK negotiated. Early secret: 33ad0a1c607ec03b09e6cd9893680ce210adf300aa1f2660e1b22e10f170f92a
KS | handshake salt:                  6f2615a108c702c5678f54fc9dbab69716c076189c48250cebeac3576c3611ba
CDH| DH initiator on X255519
KS | DH shared secret: 30f584f5b1e1a23579a5a254ea776144de75c3013ce7772be1af123fb690f72f
KS | handshake secret:                90f422dc4ac32cfe5dae1219f306e5e4fab96632b43017e7280f2dd25c1bea5d
KS | handshake traffic secret[C]:     af1106a697e54242209b56dd28d934075addf87ed9e801c32011148d1e69265e
KS | handshake traffic secret[S]:     80b744cd40f862423f26765915d4808652d87ebbca4238e0a5ca6d7a49fefc8e
KS | handshake key[C]:                2bc639f7311522474189ef3cab2a71ad06f85c2c3ed31a110ef8db02bc16ab59, IV=86d6c1205d73989b0e97fba5
KS | handshake key[S]:                552637fb0cfd45918ea635182d394f17f59e769cc89ac5454dae1a02b9484a31, IV=d1527182aaf552216b28e64e
KS | finished key[C]: 69ff943290c397d70a7e8ae5e0623063e637d2d3d3e61a7516e5ff6a69592386
KS | finished key[S]: 5318699d04d987316e62fdc1e2b69d211dd68a6ec2c37903ed176697758dd73c
KS | application salt:                fa17e1b3711ba6c6cfb2a1f8b295e48b58b8e0314072284c797be040503bdd9b
KS | application secret:              33c144822fd35737be3f0326932b8cdcacfb6e557c40945b853391a2ed7e7ece
AEP| LowProvider: COERCE(K=2bc639f7311522474189ef3cab2a71ad06f85c2c3ed31a110ef8db02bc16ab59)
AEP| LowProvider: COERCE(K=552637fb0cfd45918ea635182d394f17f59e769cc89ac5454dae1a02b9484a31)
EPO| reader++ 0/-1
TLS| readOne ReadAgain
TLS| writeHandshake (plaintext)
TLS| HS.next_fragment PlaintextID?
HS | next_fragment
TLS| HS.next_fragment returned nothing
TLS| sendHandshake
TLS| read: WrittenHS, Ctrl/Ctrl, nothing
TLS| Read fragment at epoch index: 0 of length 735
TLS| StAE decrypt correct.
TLS| read Handshake fragment
HS | recv_fragment
HSL| parsed EncryptedExtensions
HSL| parsed Certificate13
HSL| parsed CertificateVerify
HSL| parsed Finished
HSL| end of flight
NGO| Nego.clientComplete_13
NGO| EE: alpn supported_groups 001a 
NGO| Negotiation callback to process application extensions.
@@@@ Nego callback for TLS 1.3 @@@@
Offered extensions:
001b0010000800060568712d3130000a00040002001d001a0003000102
Transport parameters offered:
000102
No application cookie (fist connection).
Adding server transport parameters:
000102
@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
WARNING: chain validation failed, ignoring.
NGO| Certificate & signature 1.3 callback result: valid
KS | ks_client_13_sf hashed_log = 653d39ec548eb727df8ae5c08fe68e3d59edc692f18b37105c43f43f1cf7892a
KS | application traffic secret[C]:   8e460c43a86d1b82ceb816d6ae90a078661144bc45f21f73781f97b432d0d77a
KS | application traffic secret[S]:   07df439164dffb330ea488b9bd04603e3404f68571d1cfd4c4706832731fb8b8
KS | exporter master secret:          bfaaf4a616d27d1f03d79de54db89e04c06311178e846fa41de8646e8dda1c2e
KS | application key[C]:              dcfa751d588b96fb4d2b28a6e81f39700ac07ca4bfd864c9ac76f52cac22aa52, IV=260bdb22b5ca9b16c4380f0c
KS | application key[S]:              eb5f4425314ced0c65f744fe4089e4ec95df2d020feff753f01a45caa620ad83, IV=4b9682583337c4adedc6be93
AEP| LowProvider: COERCE(K=dcfa751d588b96fb4d2b28a6e81f39700ac07ca4bfd864c9ac76f52cac22aa52)
AEP| LowProvider: COERCE(K=eb5f4425314ced0c65f744fe4089e4ec95df2d020feff753f01a45caa620ad83)
HS | exporting a key
HS | Early data rejected
EPO| writer++ 0/0
HSL| emit Finished and hash
KS | ks_client_13_cf hashed_log = 3e3e16b6f947cdc72924c46651ae92766a6a4cb94a6b4c24d5f308000f0ed954
KS | resumption master secret:        910beecfaecffdbf17488e9e6aef47c34bbfcb5cdc1f3351a3e2d861a89d3206
EPO| reader++ 1/0
TLS| readOne ReadAgain
TLS| writeHandshake (encrypted)
TLS| HS.next_fragment ID13?
HS | next_fragment
TLS| HS.next_fragment returned a fragment; next_keys (for all data); complete
TLS| sendHandshake
TLS| send Handshake fragment with index ID13
TLS| Encrypting with key 2bc639f7311522474189ef3cab2a71ad06f85c2c3ed31a110ef8db02bc16ab59
TLS| Sending fragment of length 53
REC| record headers: 1703030035
EPO| writer++ 1/1
TLS| read: WrittenHS, Open/Open, new writer: complete
client returns client_complete clen=58 slen=835
secret=bfaaf4a616d27d1f03d79de54db89e04c06311178e846fa41de8646e8dda1c2e
(Finished) [  58] ---->

TLS| writeHandshake (encrypted)
TLS| HS.next_fragment ID13?
HS | next_fragment
TLS| HS.next_fragment returned nothing
TLS| sendHandshake
TLS| read: WrittenHS, Ctrl/Open, nothing
TLS| Read fragment at epoch index: 0 of length 53
TLS| StAE decrypt correct.
TLS| read Handshake fragment
HS | recv_fragment
HSL| parsed Finished
HSL| end of flight
HS | Process Client Finished
KS | ks_server_13_cf hashed_log = 3e3e16b6f947cdc72924c46651ae92766a6a4cb94a6b4c24d5f308000f0ed954
KS | resumption master secret:        910beecfaecffdbf17488e9e6aef47c34bbfcb5cdc1f3351a3e2d861a89d3206
HS | Sending ticket: 9c71fcd092085d51369bbeac26e5e73e254d87e18dfb662f531f16a2d0c44447eb6a6d9502161d3f4b1eabfb25bd0892fa3e4ea8609c498899f5cd97d63ae9a2edf307adb635318b78db5437
HSL| emit NewSessionTicket13
EPO| reader++ 1/1
TLS| readOne Complete
server returns server_complete clen=58 slen=0
TLS| writeHandshake (encrypted)
TLS| HS.next_fragment ID13?
HS | next_fragment
TLS| HS.next_fragment returned a fragment
TLS| sendHandshake
TLS| send Handshake fragment with index ID13
TLS| Encrypting with key eb5f4425314ced0c65f744fe4089e4ec95df2d020feff753f01a45caa620ad83
TLS| Sending fragment of length 130
REC| record headers: 1703030082
TLS| writeHandshake (encrypted)
TLS| HS.next_fragment ID13?
HS | next_fragment
TLS| HS.next_fragment returned nothing
TLS| sendHandshake
TLS| read: WrittenHS, Open/Open, nothing
REC| WouldBlock
TLS| readOne ReadWouldBlock
server returns would_block clen=0 slen=135
<---- {Ticket}[ 135]
TLS| writeHandshake (encrypted)
TLS| HS.next_fragment ID13?
HS | next_fragment
TLS| HS.next_fragment returned nothing
TLS| sendHandshake
TLS| read: WrittenHS, Open/Open, nothing
TLS| Read fragment at epoch index: 1 of length 130
TLS| StAE decrypt correct.
TLS| read Handshake fragment
HS | recv_fragment
HSL| parsed NewSessionTicket13
HSL| end of flight
HS | Received ticket: 9c71fcd092085d51369bbeac26e5e73e254d87e18dfb662f531f16a2d0c44447eb6a6d9502161d3f4b1eabfb25bd0892fa3e4ea8609c498899f5cd97d63ae9a2edf307adb635318b78db5437
KS | ks_client_13_rms
KS | Recall RMS: 910beecfaecffdbf17488e9e6aef47c34bbfcb5cdc1f3351a3e2d861a89d3206
AEP| LowProvider: COERCE(K=1aef7038b8d88f292e8134324a326aa93b3c47aa2f1bac75eebb7770af23f47d)

##### New session ticket received! #####
Host: localhost
Ticket:
9c71fcd092085d51369bbeac26e5e73e254d87e18dfb662f531f16a2d0c44447
eb6a6d9502161d3f4b1eabfb25bd0892fa3e4ea8609c498899f5cd97d63ae9a2
edf307adb635318b78db5437
########################################
TLS| readOne ReadAgain
TLS| writeHandshake (encrypted)
TLS| HS.next_fragment ID13?
HS | next_fragment
TLS| HS.next_fragment returned nothing
TLS| sendHandshake
TLS| read: WrittenHS, Open/Open, nothing
REC| WouldBlock
TLS| readOne ReadWouldBlock
client returns clen=0 slen=135 status=would_block
Ok
================================================================================
