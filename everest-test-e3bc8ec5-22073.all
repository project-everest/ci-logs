This is /home/everbld/everest-ci/ci
Working directory: /cygdrive/c/build/agent2/_work/6/s
About to run: ./everest --yes -j 16 test
BUILD_SOURCEBRANCHNAME: protz_uint128
BUILD_DEFINITIONNAME: Everest-CI-Windows
BUILD_BUILDID: 22073
DEFINITIONNAME:
Z3 is /home/everbld/everest/z3-4.5.1.1f29cebd4df6-x64-win/bin/z3
# Switching to the everest directory ... now in /cygdrive/c/build/agent2/_work/6/s

exported FSTAR_HOME=C:/build/agent2/_work/6/s/FStar
exported OPENSSL_HOME=C:/build/agent2/_work/6/s/MLCrypto/openssl
exported KREMLIN_HOME=C:/build/agent2/_work/6/s/kremlin
exported VALE_HOME=C:/build/agent2/_work/6/s/vale
exported HACL_HOME=C:/build/agent2/_work/6/s/hacl-star
exported MLCRYPTO_HOME=C:/build/agent2/_work/6/s/MLCrypto
exported PATH=/cygdrive/c/build/agent2/_work/6/s/MLCrypto/openssl:/cygdrive/c/build/agent2/_work/6/s/FStar/bin:/cygdrive/c/build/agent2/_work/6/s/kremlin:/home/everbld/.opam/4.05.0+mingw64c/bin:/cygdrive/c/Windows/Microsoft.NET/Framework64/v4.0.30319/:/home/everbld/everest/nuget/bin:/home/everbld/everest/z3-4.5.1.1f29cebd4df6-x64-win/bin:/cygdrive/c/PROGRA~2/MICROS~1.0/VC/bin/amd64:/cygdrive/c/PROGRA~2/MICROS~1.0/VC/bin:/cygdrive/c/PROGRA~2/MICROS~4/F#/4.0/FRAMEW~1/v4.0/:/usr/x86_64-w64-mingw32/sys-root/mingw/bin:/usr/local/bin:/usr/bin:/cygdrive/c/build/agent2/externals/git/cmd:/cygdrive/c/Python36/Scripts:/cygdrive/c/Python36:/cygdrive/c/Docker/Resources/bin:/cygdrive/c/windows/system32:/cygdrive/c/windows:/cygdrive/c/windows/System32/Wbem:/cygdrive/c/windows/System32/WindowsPowerShell/v1.0:/cygdrive/c/Users/everbld/AppData/Local/Microsoft/WindowsApps:/cygdrive/c/Program Files/Docker/Docker/resources/bin:%USERPROFILE%/.dnx/bin:/cygdrive/c/Program Files/Microsoft DNX/Dnvm:/cygdrive/c/Program Files/Microsoft SQL Server/120/Tools/Binn:/cygdrive/c/Program Files/Microsoft SQL Server/130/Tools/Binn:/cygdrive/c/Program Files/dotnet:/cygdrive/c/Program Files/nodejs:/usr/bin:/cygdrive/c/Program Files/Git/mingw64/bin:/cygdrive/c/Users/everbld/AppData/Roaming/npm:/cygdrive/c/build/agent2/bin:/cygdrive/c/build/agent2/bin
================================================================================
+ hacl-star/secure_api/out/vale_aes_concrete_id/krml-test.exe
Running tests (commands shown below)
test()
+ hacl-star/secure_api/out/hacl_aes_concrete_id/krml-test.exe
[test] expected output cipher is d31a8d34648e60db7b86afbc53ef7ec2a4aded51296e08fea9e2b5a736ee62d63dbea45e8ca9671282fafb69da92728b1a71de0a9e060b2905d6a5b67ecd3b3692ddbd7f2d778b8c9803aee328091b58fab324e4fad675945585808b4831d7bc3ff4def08e4b7a9de576d26586cec64b61161ae10b594f09e26a7e902ecbd0600691
[test] computed output cipher is d31a8d34648e60db7b86afbc53ef7ec2a4aded51296e08fea9e2b5a736ee62d63dbea45e8ca9671282fafb69da92728b1a71de0a9e060b2905d6a5b67ecd3b3692ddbd7f2d778b8c9803aee328091b58fab324e4fad675945585808b4831d7bc3ff4def08e4b7a9de576d26586cec64b61161ae10b594f09e26a7e902ecbd0600691
[test] cipher is a success
[test] expected output decryption is 4c616469657320616e642047656e746c656d656e206f662074686520636c617373206f66202739393a204966204920636f756c64206f6666657220796f75206f6e6c79206f6e652074697020666f7220746865206675747572652c2073756e73637265656e20776f756c642062652069742e
[test] computed output decryption is 4c616469657320616e642047656e746c656d656e206f662074686520636c617373206f66202739393a204966204920636f756c64206f6666657220796f75206f6e6c79206f6e652074697020666f7220746865206675747572652c2073756e73637265656e20776f756c642062652069742e
[test] decryption is a success
test_aes_gcm_0()
[test] expected output cipher is 58e2fccefa7e3061367f1d57a4e7455a
[test] computed output cipher is 58e2fccefa7e3061367f1d57a4e7455a
[test] cipher is a success
[test] expected output decryption is 
[test] computed output decryption is 
[test] decryption is a success
test_aes_gcm_1()
[test] expected output cipher is 530f8afbc74536b9a963b4f1c4cb738b
[test] computed output cipher is 530f8afbc74536b9a963b4f1c4cb738b
[test] cipher is a success
+ make -C hacl-star/secure_api -f Makefile.extract test
[test] expected output decryption is 
[test] computed output decryption is 
[test] decryption is a success
test_aes_gcm_2()
[test] expected output cipher is cea7403d4d606b6e074ec5d3baf39d18d0d1c8a799996bf0265b98b5d48ab919
[test] computed output cipher is cea7403d4d606b6e074ec5d3baf39d18d0d1c8a799996bf0265b98b5d48ab919
[test] cipher is a success
[test] expected output decryption is 00000000000000000000000000000000
[test] computed output decryption is 00000000000000000000000000000000
[test] decryption is a success
test_aes_gcm_3()
[test] expected output cipher is 522dc1f099567d07f47f37a32a84427d643a8cdcbfe5c0c97598a2bd2555d1aa8cb08e48590dbb3da7b08b1056828838c5f61e6393ba7a0abcc9f662898015adb094dac5d93471bdec1a502270e3cc6c
[test] computed output cipher is 522dc1f099567d07f47f37a32a84427d643a8cdcbfe5c0c97598a2bd2555d1aa8cb08e48590dbb3da7b08b1056828838c5f61e6393ba7a0abcc9f662898015adb094dac5d93471bdec1a502270e3cc6c
[test] cipher is a success
[test] expected output decryption is d9313225f88406e5a55909c5aff5269a86a7a9531534f7da2e4c303d8a318a721c3c0c95956809532fcf0e2449a6b525b16aedf5aa0de657ba637b391aafd255
[test] computed output decryption is d9313225f88406e5a55909c5aff5269a86a7a9531534f7da2e4c303d8a318a721c3c0c95956809532fcf0e2449a6b525b16aedf5aa0de657ba637b391aafd255
[test] decryption is a success
test_aes_gcm_4()
[test] expected output cipher is 522dc1f099567d07f47f37a32a84427d643a8cdcbfe5c0c97598a2bd2555d1aa8cb08e48590dbb3da7b08b1056828838c5f61e6393ba7a0abcc9f66276fc6ece0f4e1768cddf8853bb2d551b
[test] computed output cipher is 522dc1f099567d07f47f37a32a84427d643a8cdcbfe5c0c97598a2bd2555d1aa8cb08e48590dbb3da7b08b1056828838c5f61e6393ba7a0abcc9f66276fc6ece0f4e1768cddf8853bb2d551b
[test] cipher is a success
[test] expected output decryption is d9313225f88406e5a55909c5aff5269a86a7a9531534f7da2e4c303d8a318a721c3c0c95956809532fcf0e2449a6b525b16aedf5aa0de657ba637b39
[test] computed output decryption is d9313225f88406e5a55909c5aff5269a86a7a9531534f7da2e4c303d8a318a721c3c0c95956809532fcf0e2449a6b525b16aedf5aa0de657ba637b39
[test] decryption is a success
test()
[test] expected output cipher is d31a8d34648e60db7b86afbc53ef7ec2a4aded51296e08fea9e2b5a736ee62d63dbea45e8ca9671282fafb69da92728b1a71de0a9e060b2905d6a5b67ecd3b3692ddbd7f2d778b8c9803aee328091b58fab324e4fad675945585808b4831d7bc3ff4def08e4b7a9de576d26586cec64b61161ae10b594f09e26a7e902ecbd0600691
[test] computed output cipher is d31a8d34648e60db7b86afbc53ef7ec2a4aded51296e08fea9e2b5a736ee62d63dbea45e8ca9671282fafb69da92728b1a71de0a9e060b2905d6a5b67ecd3b3692ddbd7f2d778b8c9803aee328091b58fab324e4fad675945585808b4831d7bc3ff4def08e4b7a9de576d26586cec64b61161ae10b594f09e26a7e902ecbd0600691
[test] cipher is a success
[test] expected output decryption is 4c616469657320616e642047656e746c656d656e206f662074686520636c617373206f66202739393a204966204920636f756c64206f6666657220796f75206f6e6c79206f6e652074697020666f7220746865206675747572652c2073756e73637265656e20776f756c642062652069742e
[test] computed output decryption is 4c616469657320616e642047656e746c656d656e206f662074686520636c617373206f66202739393a204966204920636f756c64206f6666657220796f75206f6e6c79206f6e652074697020666f7220746865206675747572652c2073756e73637265656e20776f756c642062652069742e
[test] decryption is a success
test_aes_gcm_0()
[test] expected output cipher is 58e2fccefa7e3061367f1d57a4e7455a
[test] computed output cipher is 58e2fccefa7e3061367f1d57a4e7455a
[test] cipher is a success
[test] expected output decryption is 
[test] computed output decryption is 
[test] decryption is a success
test_aes_gcm_1()
[test] expected output cipher is 530f8afbc74536b9a963b4f1c4cb738b
[test] computed output cipher is 530f8afbc74536b9a963b4f1c4cb738b
[test] cipher is a success
[test] expected output decryption is 
[test] computed output decryption is 
[test] decryption is a success
test_aes_gcm_2()
[test] expected output cipher is cea7403d4d606b6e074ec5d3baf39d18d0d1c8a799996bf0265b98b5d48ab919
[test] computed output cipher is cea7403d4d606b6e074ec5d3baf39d18d0d1c8a799996bf0265b98b5d48ab919
[test] cipher is a success
[test] expected output decryption is 00000000000000000000000000000000
[test] computed output decryption is 00000000000000000000000000000000
[test] decryption is a success
test_aes_gcm_3()
[test] expected output cipher is 522dc1f099567d07f47f37a32a84427d643a8cdcbfe5c0c97598a2bd2555d1aa8cb08e48590dbb3da7b08b1056828838c5f61e6393ba7a0abcc9f662898015adb094dac5d93471bdec1a502270e3cc6c
[test] computed output cipher is 522dc1f099567d07f47f37a32a84427d643a8cdcbfe5c0c97598a2bd2555d1aa8cb08e48590dbb3da7b08b1056828838c5f61e6393ba7a0abcc9f662898015adb094dac5d93471bdec1a502270e3cc6c
[test] cipher is a success
[test] expected output decryption is d9313225f88406e5a55909c5aff5269a86a7a9531534f7da2e4c303d8a318a721c3c0c95956809532fcf0e2449a6b525b16aedf5aa0de657ba637b391aafd255
[test] computed output decryption is d9313225f88406e5a55909c5aff5269a86a7a9531534f7da2e4c303d8a318a721c3c0c95956809532fcf0e2449a6b525b16aedf5aa0de657ba637b391aafd255
[test] decryption is a success
test_aes_gcm_4()
[test] expected output cipher is 522dc1f099567d07f47f37a32a84427d643a8cdcbfe5c0c97598a2bd2555d1aa8cb08e48590dbb3da7b08b1056828838c5f61e6393ba7a0abcc9f66276fc6ece0f4e1768cddf8853bb2d551b
[test] computed output cipher is 522dc1f099567d07f47f37a32a84427d643a8cdcbfe5c0c97598a2bd2555d1aa8cb08e48590dbb3da7b08b1056828838c5f61e6393ba7a0abcc9f66276fc6ece0f4e1768cddf8853bb2d551b
[test] cipher is a success
[test] expected output decryption is d9313225f88406e5a55909c5aff5269a86a7a9531534f7da2e4c303d8a318a721c3c0c95956809532fcf0e2449a6b525b16aedf5aa0de657ba637b39
[test] computed output decryption is d9313225f88406e5a55909c5aff5269a86a7a9531534f7da2e4c303d8a318a721c3c0c95956809532fcf0e2449a6b525b16aedf5aa0de657ba637b39
[test] decryption is a success
make: Entering directory '/cygdrive/c/build/agent2/_work/6/s/hacl-star/secure_api'
C:/build/agent2/_work/6/s/FStar/bin/fstar.exe --print_z3_statistics --use_hints --query_stats --cache_dir ../secure_api/out/runtime_switch/cache --cache_checked_modules --include ../specs --include ../code/bignum --include ../code/experimental/aesgcm --include ../code/lib/kremlin --include ../code/poly1305 --include ../code/hash --include ../code/salsa-family --include C:/build/agent2/_work/6/s/kremlin/kremlib --include ../secure_api --include ../secure_api/aead --include ../secure_api/prf --include ../secure_api/hkdf --include ../secure_api/vale --include ../secure_api/uf1cma --include ../secure_api/utils --include ../secure_api/LowCProvider/fst --include C:/build/agent2/_work/6/s/FStar/contrib/CoreCrypto/fst --include ../secure_api/concrete_specializations --include ../secure_api/concrete_specializations/runtime_switch --include ../secure_api/test --odir ../secure_api/out/runtime_switch/extracted --use_hints --lax \
prims.fst \
--codegen Kremlin \
--extract_module prims
All verification conditions discharged successfully
TOTAL TIME 46 ms: C:\build\agent2\_work\6\s\FStar\bin\fstar.exe --print_z3_statistics --use_hints --query_stats --cache_dir ../secure_api/out/runtime_switch/cache --cache_checked_modules --include ../specs --include ../code/bignum --include ../code/experimental/aesgcm --include ../code/lib/kremlin --include ../code/poly1305 --include ../code/hash --include ../code/salsa-family --include C:/build/agent2/_work/6/s/kremlin/kremlib --include ../secure_api --include ../secure_api/aead --include ../secure_api/prf --include ../secure_api/hkdf --include ../secure_api/vale --include ../secure_api/uf1cma --include ../secure_api/utils --include ../secure_api/LowCProvider/fst --include C:/build/agent2/_work/6/s/FStar/contrib/CoreCrypto/fst --include ../secure_api/concrete_specializations --include ../secure_api/concrete_specializations/runtime_switch --include ../secure_api/test --odir ../secure_api/out/runtime_switch/extracted --use_hints --lax prims.fst --codegen Kremlin --extract_module prims
C:/build/agent2/_work/6/s/kremlin/krml  -no-prefix KrmlTest -bundle \
Hacl.Impl.Poly1305_64+Hacl.Impl.Chacha20=Hacl.*,Spec,Spec.* -bundle \
Crypto.AEAD.Main=Crypto.* -tmpdir ../secure_api/out/runtime_switch/extracted \
-add-include '"kremlin/internal/compat.h"' \
../secure_api/out/runtime_switch/extracted/prims.krml ../secure_api/out/runtime_switch/extracted/FStar_Pervasives_Native.krml ../secure_api/out/runtime_switch/extracted/FStar_Pervasives.krml ../secure_api/out/runtime_switch/extracted/FStar_Mul.krml ../secure_api/out/runtime_switch/extracted/FStar_Math_Lib.krml ../secure_api/out/runtime_switch/extracted/FStar_Math_Lemmas.krml ../secure_api/out/runtime_switch/extracted/FStar_Squash.krml ../secure_api/out/runtime_switch/extracted/FStar_StrongExcludedMiddle.krml ../secure_api/out/runtime_switch/extracted/FStar_Classical.krml ../secure_api/out/runtime_switch/extracted/FStar_List_Tot_Base.krml ../secure_api/out/runtime_switch/extracted/FStar_List_Tot_Properties.krml ../secure_api/out/runtime_switch/extracted/FStar_List_Tot.krml ../secure_api/out/runtime_switch/extracted/FStar_Seq_Base.krml ../secure_api/out/runtime_switch/extracted/FStar_Seq_Properties.krml ../secure_api/out/runtime_switch/extracted/FStar_Seq.krml ../secure_api/out/runtime_switch/extracted/FStar_BitVector.krml ../secure_api/out/runtime_switch/extracted/FStar_UInt.krml ../secure_api/out/runtime_switch/extracted/FStar_UInt32.krml ../secure_api/out/runtime_switch/extracted/FStar_Int.krml ../secure_api/out/runtime_switch/extracted/FStar_Int64.krml ../secure_api/out/runtime_switch/extracted/FStar_Int63.krml ../secure_api/out/runtime_switch/extracted/FStar_Int32.krml ../secure_api/out/runtime_switch/extracted/FStar_Int16.krml ../secure_api/out/runtime_switch/extracted/FStar_Int8.krml ../secure_api/out/runtime_switch/extracted/FStar_UInt64.krml ../secure_api/out/runtime_switch/extracted/FStar_UInt63.krml ../secure_api/out/runtime_switch/extracted/FStar_UInt16.krml ../secure_api/out/runtime_switch/extracted/FStar_UInt8.krml ../secure_api/out/runtime_switch/extracted/FStar_Int_Cast.krml ../secure_api/out/runtime_switch/extracted/FStar_UInt128.krml ../secure_api/out/runtime_switch/extracted/Hacl_UInt64.krml ../secure_api/out/runtime_switch/extracted/FStar_Preorder.krml ../secure_api/out/runtime_switch/extracted/FStar_Ghost.krml ../secure_api/out/runtime_switch/extracted/FStar_ErasedLogic.krml ../secure_api/out/runtime_switch/extracted/FStar_FunctionalExtensionality.krml ../secure_api/out/runtime_switch/extracted/FStar_Set.krml ../secure_api/out/runtime_switch/extracted/FStar_PropositionalExtensionality.krml ../secure_api/out/runtime_switch/extracted/FStar_PredicateExtensionality.krml ../secure_api/out/runtime_switch/extracted/FStar_TSet.krml ../secure_api/out/runtime_switch/extracted/FStar_Monotonic_Heap.krml ../secure_api/out/runtime_switch/extracted/FStar_Heap.krml ../secure_api/out/runtime_switch/extracted/FStar_Map.krml ../secure_api/out/runtime_switch/extracted/FStar_Monotonic_HyperHeap.krml ../secure_api/out/runtime_switch/extracted/FStar_Monotonic_HyperStack.krml ../secure_api/out/runtime_switch/extracted/FStar_HyperStack.krml ../secure_api/out/runtime_switch/extracted/FStar_Monotonic_Witnessed.krml ../secure_api/out/runtime_switch/extracted/FStar_HyperStack_ST.krml ../secure_api/out/runtime_switch/extracted/FStar_HyperStack_All.krml ../secure_api/out/runtime_switch/extracted/Hacl_UInt128.krml ../secure_api/out/runtime_switch/extracted/Hacl_UInt8.krml ../secure_api/out/runtime_switch/extracted/Hacl_Bignum_Constants.krml ../secure_api/out/runtime_switch/extracted/Hacl_UInt32.krml ../secure_api/out/runtime_switch/extracted/FStar_Int_Cast_Full.krml ../secure_api/out/runtime_switch/extracted/Hacl_Cast.krml ../secure_api/out/runtime_switch/extracted/FStar_Buffer.krml ../secure_api/out/runtime_switch/extracted/Hacl_Bignum_Parameters.krml ../secure_api/out/runtime_switch/extracted/Hacl_Bignum_Wide.krml ../secure_api/out/runtime_switch/extracted/Spec_Loops.krml ../secure_api/out/runtime_switch/extracted/Hacl_Bignum_Limb.krml ../secure_api/out/runtime_switch/extracted/Hacl_Spec_Bignum_Field.krml ../secure_api/out/runtime_switch/extracted/Hacl_Spec_Bignum_Bigint.krml ../secure_api/out/runtime_switch/extracted/Hacl_Spec_Bignum_Modulo.krml ../secure_api/out/runtime_switch/extracted/Hacl_Spec_Bignum_Fproduct.krml ../secure_api/out/runtime_switch/extracted/Hacl_Spec_Bignum_Fmul.krml ../secure_api/out/runtime_switch/extracted/FStar_Endianness.krml ../secure_api/out/runtime_switch/extracted/Spec_Poly1305_Lemmas.krml ../secure_api/out/runtime_switch/extracted/FStar_Kremlin_Endianness.krml ../secure_api/out/runtime_switch/extracted/C_Endianness.krml ../secure_api/out/runtime_switch/extracted/C.krml ../secure_api/out/runtime_switch/extracted/Hacl_UInt16.krml ../secure_api/out/runtime_switch/extracted/Hacl_Spec_Endianness.krml ../secure_api/out/runtime_switch/extracted/Hacl_Endianness.krml ../secure_api/out/runtime_switch/extracted/Spec_Lib.krml ../secure_api/out/runtime_switch/extracted/Seq_Create.krml ../secure_api/out/runtime_switch/extracted/Spec_SHA2_256.krml ../secure_api/out/runtime_switch/extracted/C_Loops.krml ../secure_api/out/runtime_switch/extracted/Hacl_Hash_Lib_LoadStore.krml ../secure_api/out/runtime_switch/extracted/Hacl_Hash_Lib_Create.krml ../secure_api/out/runtime_switch/extracted/Hacl_Impl_SHA2_256_Lemmas.krml ../secure_api/out/runtime_switch/extracted/Hacl_Impl_SHA2_256.krml ../secure_api/out/runtime_switch/extracted/Hacl_Spec_Bignum_Fsum.krml ../secure_api/out/runtime_switch/extracted/Hacl_Bignum_Fsum.krml ../secure_api/out/runtime_switch/extracted/Crypto_AEAD_BufferUtils.krml ../secure_api/out/runtime_switch/extracted/Vale_AES.krml ../secure_api/out/runtime_switch/extracted/Hacl_Impl_Xor_Lemmas.krml ../secure_api/out/runtime_switch/extracted/Spec_CTR_Lemmas.krml ../secure_api/out/runtime_switch/extracted/Spec_CTR.krml ../secure_api/out/runtime_switch/extracted/Hacl_Lib_LoadStore32.krml ../secure_api/out/runtime_switch/extracted/Spec_Chacha20_Lemmas.krml ../secure_api/out/runtime_switch/extracted/Spec_Chacha20.krml ../secure_api/out/runtime_switch/extracted/Hacl_Impl_Chacha20.krml ../secure_api/out/runtime_switch/extracted/Hacl_SecureAPI_Chacha20.krml ../secure_api/out/runtime_switch/extracted/Crypto_Indexing.krml ../secure_api/out/runtime_switch/extracted/Flag.krml ../secure_api/out/runtime_switch/extracted/Crypto_Symmetric_AES.krml ../secure_api/out/runtime_switch/extracted/Crypto_Symmetric_AES128.krml ../secure_api/out/runtime_switch/extracted/FStar_Float.krml ../secure_api/out/runtime_switch/extracted/FStar_Exn.krml ../secure_api/out/runtime_switch/extracted/FStar_ST.krml ../secure_api/out/runtime_switch/extracted/FStar_All.krml ../secure_api/out/runtime_switch/extracted/FStar_IO.krml ../secure_api/out/runtime_switch/extracted/Buffer_Utils.krml ../secure_api/out/runtime_switch/extracted/Crypto_Symmetric_Bytes.krml ../secure_api/out/runtime_switch/extracted/Crypto_Symmetric_Cipher.krml ../secure_api/out/runtime_switch/extracted/C_Nullity.krml ../secure_api/out/runtime_switch/extracted/Hacl_Spec_Bignum_AddAndMultiply.krml ../secure_api/out/runtime_switch/extracted/Spec_Poly1305.krml ../secure_api/out/runtime_switch/extracted/Hacl_Bignum_Modulo.krml ../secure_api/out/runtime_switch/extracted/Hacl_Bignum_Fproduct.krml ../secure_api/out/runtime_switch/extracted/Hacl_Spec_Poly1305_64_State.krml ../secure_api/out/runtime_switch/extracted/Hacl_Spec_Poly1305_64.krml ../secure_api/out/runtime_switch/extracted/Hacl_Impl_Poly1305_64_State.krml ../secure_api/out/runtime_switch/extracted/Hacl_Bignum_Fmul.krml ../secure_api/out/runtime_switch/extracted/Hacl_Bignum_AddAndMultiply.krml ../secure_api/out/runtime_switch/extracted/Hacl_Spe_Poly1305_64.krml ../secure_api/out/runtime_switch/extracted/Hacl_Impl_Poly1305_64.krml ../secure_api/out/runtime_switch/extracted/Spec_GaloisField.krml ../secure_api/out/runtime_switch/extracted/Spec_GF128.krml ../secure_api/out/runtime_switch/extracted/Crypto_Symmetric_GF128.krml ../secure_api/out/runtime_switch/extracted/Crypto_Symmetric_MAC.krml ../secure_api/out/runtime_switch/extracted/Crypto_Symmetric_UF1CMA.krml ../secure_api/out/runtime_switch/extracted/Crypto_Plain.krml ../secure_api/out/runtime_switch/extracted/Crypto_Symmetric_PRF.krml ../secure_api/out/runtime_switch/extracted/Crypto_AEAD_Encoding.krml ../secure_api/out/runtime_switch/extracted/Crypto_AEAD_Invariant.krml ../secure_api/out/runtime_switch/extracted/Crypto_AEAD_Encrypt_Invariant.krml ../secure_api/out/runtime_switch/extracted/Crypto_AEAD_Wrappers_PRF.krml ../secure_api/out/runtime_switch/extracted/Crypto_AEAD_Wrappers_Encoding.krml ../secure_api/out/runtime_switch/extracted/Crypto_AEAD_Wrappers_CMA.krml ../secure_api/out/runtime_switch/extracted/Crypto_AEAD_EnxorDexor.krml ../secure_api/out/runtime_switch/extracted/Crypto_AEAD_Decrypt.krml ../secure_api/out/runtime_switch/extracted/Spec_HMAC_SHA2_256.krml ../secure_api/out/runtime_switch/extracted/Spec_SHA2_512.krml ../secure_api/out/runtime_switch/extracted/Hacl_Impl_SHA2_512_Lemmas.krml ../secure_api/out/runtime_switch/extracted/Hacl_Impl_SHA2_512.krml ../secure_api/out/runtime_switch/extracted/Spec_SHA2_384.krml ../secure_api/out/runtime_switch/extracted/Hacl_Impl_SHA2_384_Lemmas.krml ../secure_api/out/runtime_switch/extracted/Hacl_Impl_SHA2_384.krml ../secure_api/out/runtime_switch/extracted/Crypto_HMAC.krml ../secure_api/out/runtime_switch/extracted/Crypto_AEAD_Encrypt_Ideal_Invariant.krml ../secure_api/out/runtime_switch/extracted/Crypto_AEAD_MAC_Wrapper_Invariant.krml ../secure_api/out/runtime_switch/extracted/Crypto_AEAD_Enxor_Invariant.krml ../secure_api/out/runtime_switch/extracted/Crypto_AEAD_Encrypt.krml ../secure_api/out/runtime_switch/extracted/Crypto_AEAD.krml ../secure_api/out/runtime_switch/extracted/FStar_List.krml ../secure_api/out/runtime_switch/extracted/FStar_Char.krml ../secure_api/out/runtime_switch/extracted/FStar_String.krml ../secure_api/out/runtime_switch/extracted/C_String.krml ../secure_api/out/runtime_switch/extracted/TestLib.krml ../secure_api/out/runtime_switch/extracted/FStar_Bytes.krml ../secure_api/out/runtime_switch/extracted/Crypto_AEAD_Main.krml ../secure_api/out/runtime_switch/extracted/CryptoTypes.krml ../secure_api/out/runtime_switch/extracted/Crypto_HKDF.krml ../secure_api/out/runtime_switch/extracted/HaclProvider.krml ../secure_api/out/runtime_switch/extracted/KrmlTest.krml ../secure_api/out/runtime_switch/extracted/LowCProvider.krml vale/asm/sha256_main_i.o vale/asm/sha256-x86_64.o vale/asm/Vale_Hash_SHA2_256.o vale/asm/vale_aes_glue.o vale/asm/aes-x86_64.o -o ../secure_api/out/runtime_switch/krml-test.exe \
-drop HaclProvider,LowCProvider,CryptoTypes
Warning 10: : -drop is deprecated
use a combination of -bundle and -d reachability to make sure the functions are eliminated as you wish
Warning 6: in top-level declaration Crypto.Plain.create, in file Crypto_AEAD_Main: stack newbuf @1 @0 is a non-constant size, stack-allocated array; this is not supported by CompCert and requires the use of alloca(3) for MSVC
Warning 6: in the definition of keyBuffer, after the definition of h0, in the last element of the sequence, after the definition of macId, in top-level declaration Crypto.Symmetric.PRF.prf_mac, in file Crypto_AEAD_Main: stack newbuf 0uint8 Crypto.Symmetric.UF1CMA.keylen @5 is a non-constant size, stack-allocated array; this is not supported by CompCert and requires the use of alloca(3) for MSVC
Warning 6: in the definition of cipher1, after the definition of cipherlen, in the last element of the sequence, in top-level declaration KrmlTest.test, in file KrmlTest: stack newbuf 0uint8 @0 is a non-constant size, stack-allocated array; this is not supported by CompCert and requires the use of alloca(3) for MSVC
Warning 6: in the definition of cipher1, after the definition of cipherlen, in the last element of the sequence, in top-level declaration KrmlTest.test_aes_gcm, in file KrmlTest: stack newbuf 2uint8 @0 is a non-constant size, stack-allocated array; this is not supported by CompCert and requires the use of alloca(3) for MSVC
Warning 6: in the definition of plain, after the definition of plainlen, in top-level declaration KrmlTest.test_aes_gcm_0, in file KrmlTest: stack newbuf 0uint8 @0 is a non-constant size, stack-allocated array; this is not supported by CompCert and requires the use of alloca(3) for MSVC
Warning 6: in the definition of aad, after the definition of aadlen, in top-level declaration KrmlTest.test_aes_gcm_0, in file KrmlTest: stack newbuf 0uint8 @0 is a non-constant size, stack-allocated array; this is not supported by CompCert and requires the use of alloca(3) for MSVC
Warning 6: in the definition of plain, after the definition of plainlen, in top-level declaration KrmlTest.test_aes_gcm_1, in file KrmlTest: stack newbuf 0uint8 @0 is a non-constant size, stack-allocated array; this is not supported by CompCert and requires the use of alloca(3) for MSVC
Warning 6: in the definition of aad, after the definition of aadlen, in top-level declaration KrmlTest.test_aes_gcm_1, in file KrmlTest: stack newbuf 0uint8 @0 is a non-constant size, stack-allocated array; this is not supported by CompCert and requires the use of alloca(3) for MSVC
Warning 6: in the definition of plain, after the definition of plainlen, in top-level declaration KrmlTest.test_aes_gcm_2, in file KrmlTest: stack newbuf 0uint8 @0 is a non-constant size, stack-allocated array; this is not supported by CompCert and requires the use of alloca(3) for MSVC
Warning 6: in the definition of aad, after the definition of aadlen, in top-level declaration KrmlTest.test_aes_gcm_2, in file KrmlTest: stack newbuf 0uint8 @0 is a non-constant size, stack-allocated array; this is not supported by CompCert and requires the use of alloca(3) for MSVC
Warning 6: in the definition of aad, after the definition of aadlen, in top-level declaration KrmlTest.test_aes_gcm_3, in file KrmlTest: stack newbuf 0uint8 @0 is a non-constant size, stack-allocated array; this is not supported by CompCert and requires the use of alloca(3) for MSVC
[38;5;119m‚úî[0m [Monomorphization] ‚è±Ô∏è 78ms
[38;5;119m‚úî[0m [Inlining] ‚è±Ô∏è 63ms
[38;5;119m‚úî[0m [Pattern matches compilation] ‚è±Ô∏è 78ms
[38;5;119m‚úî[0m [Simplify 2] ‚è±Ô∏è 313ms
Warning 7: : After inlining, Crypto.Symmetric.MAC.update (going into Crypto_AEAD_Main) calls Hacl.Impl.Poly1305_64.State.poly1305_state (going into Hacl_Impl_Poly1305_64_Hacl_Impl_Chacha20) -- removing the static qualifier from Hacl.Impl.Poly1305_64.State.poly1305_state
Warning 8: : After inlining, Crypto.Symmetric.MAC.update (going into Crypto_AEAD_Main) calls Hacl.Impl.Poly1305_64.poly1305_update (going into Hacl_Impl_Poly1305_64_Hacl_Impl_Chacha20). This is a call across translation units but Hacl.Impl.Poly1305_64.poly1305_update has a C "inline" qualifier. The C standard allows removing Hacl.Impl.Poly1305_64.poly1305_update from its translation unit (see C11 6.7.3 ¬ß5), and CompCert will do it. 
Warning 8: : After inlining, Crypto.Symmetric.MAC.finish (going into Crypto_AEAD_Main) calls Hacl.Impl.Poly1305_64.poly1305_process_last_block (going into Hacl_Impl_Poly1305_64_Hacl_Impl_Chacha20). This is a call across translation units but Hacl.Impl.Poly1305_64.poly1305_process_last_block has a C "inline" qualifier. The C standard allows removing Hacl.Impl.Poly1305_64.poly1305_process_last_block from its translation unit (see C11 6.7.3 ¬ß5), and CompCert will do it. 
Warning 8: : After inlining, Crypto.Symmetric.Cipher.compute (going into Crypto_AEAD_Main) calls Hacl.Impl.Chacha20.setup (going into Hacl_Impl_Poly1305_64_Hacl_Impl_Chacha20). This is a call across translation units but Hacl.Impl.Chacha20.setup has a C "inline" qualifier. The C standard allows removing Hacl.Impl.Chacha20.setup from its translation unit (see C11 6.7.3 ¬ß5), and CompCert will do it. 
Warning 8: : After inlining, Crypto.Symmetric.Cipher.compute (going into Crypto_AEAD_Main) calls Hacl.Impl.Chacha20.copy_state (going into Hacl_Impl_Poly1305_64_Hacl_Impl_Chacha20). This is a call across translation units but Hacl.Impl.Chacha20.copy_state has a C "inline" qualifier. The C standard allows removing Hacl.Impl.Chacha20.copy_state from its translation unit (see C11 6.7.3 ¬ß5), and CompCert will do it. 
Warning 8: : After inlining, Crypto.Symmetric.Cipher.compute (going into Crypto_AEAD_Main) calls Hacl.Impl.Chacha20.rounds (going into Hacl_Impl_Poly1305_64_Hacl_Impl_Chacha20). This is a call across translation units but Hacl.Impl.Chacha20.rounds has a C "inline" qualifier. The C standard allows removing Hacl.Impl.Chacha20.rounds from its translation unit (see C11 6.7.3 ¬ß5), and CompCert will do it. 
Warning 8: : After inlining, Crypto.Symmetric.Cipher.compute (going into Crypto_AEAD_Main) calls Hacl.Impl.Chacha20.sum_states (going into Hacl_Impl_Poly1305_64_Hacl_Impl_Chacha20). This is a call across translation units but Hacl.Impl.Chacha20.sum_states has a C "inline" qualifier. The C standard allows removing Hacl.Impl.Chacha20.sum_states from its translation unit (see C11 6.7.3 ¬ß5), and CompCert will do it. 
Warning 7: : After inlining, Crypto.Symmetric.Cipher.compute (going into Crypto_AEAD_Main) calls Hacl.Lib.LoadStore32.uint32s_to_le_bytes (going into Hacl_Impl_Poly1305_64_Hacl_Impl_Chacha20) -- removing the static qualifier from Hacl.Lib.LoadStore32.uint32s_to_le_bytes
[38;5;119m‚úî[0m [Structs + Simplify 2] ‚è±Ô∏è 328ms
Warning 7: : After inlining, KrmlTest.test (going into KrmlTest) calls Crypto.Indexing.id (going into Crypto_AEAD_Main) -- removing the static qualifier from Crypto.Indexing.id
Warning 7: : After inlining, KrmlTest.test (going into KrmlTest) calls Crypto.Indexing.aeadAlg (going into Crypto_AEAD_Main) -- removing the static qualifier from Crypto.Indexing.aeadAlg
[38;5;119m‚úî[0m [Drop] ‚è±Ô∏è 16ms
Warning 7: : After inlining, KrmlTest.test (going into KrmlTest) calls Crypto.Indexing.testId (going into Crypto_AEAD_Main) -- removing the static qualifier from Crypto.Indexing.testId
Warning 7: : After inlining, KrmlTest.test (going into KrmlTest) calls Crypto.Plain.unsafe_hide_buffer (going into Crypto_AEAD_Main) -- removing the static qualifier from Crypto.Plain.unsafe_hide_buffer
Warning 7: : After inlining, KrmlTest.test (going into KrmlTest) calls Crypto.Symmetric.Bytes.load_bytes (going into Crypto_AEAD_Main) -- removing the static qualifier from Crypto.Symmetric.Bytes.load_bytes
Warning 7: : After inlining, KrmlTest.test (going into KrmlTest) calls Crypto.Symmetric.Bytes.load_uint128 (going into Crypto_AEAD_Main) -- removing the static qualifier from Crypto.Symmetric.Bytes.load_uint128
Warning 7: : After inlining, KrmlTest.test (going into KrmlTest) calls Crypto.AEAD.Invariant.aead_state (going into Crypto_AEAD_Main) -- removing the static qualifier from Crypto.AEAD.Invariant.aead_state
Warning 7: : After inlining, KrmlTest.test (going into KrmlTest) calls Crypto.Plain.bufferRepr (going into Crypto_AEAD_Main) -- removing the static qualifier from Crypto.Plain.bufferRepr
Warning 7: : After inlining, Flag.cipher_prf (going into Flag) calls Crypto.Indexing.cipherAlg (going into Crypto_AEAD_Main) -- removing the static qualifier from Crypto.Indexing.cipherAlg
[38;5;119m‚úî[0m [AstToCStar] ‚è±Ô∏è 16ms
Warning 7: : After inlining, Flag.mac_int1cma (going into Flag) calls Crypto.Indexing.macAlg (going into Crypto_AEAD_Main) -- removing the static qualifier from Crypto.Indexing.macAlg
[38;5;119m‚úî[0m [CStarToC] ‚è±Ô∏è <1ms
Warning 14: : Crypto.AEAD.Invariant.safelen is not Low*; it uses mathematical integers and runtime checks may fail; rewrite your code to use machine integers, or if you must, use -add-include '"prims_int.h"'; if this declaration is for specification purposes only, consider marking it noextract or using -bundle <name-of-the-module> to only keep reachable definitions.
Warning 14: : Crypto.AEAD.Invariant.maxplain is not Low*; it uses mathematical integers and runtime checks may fail; rewrite your code to use machine integers, or if you must, use -add-include '"prims_int.h"'; if this declaration is for specification purposes only, consider marking it noextract or using -bundle <name-of-the-module> to only keep reachable definitions.
Warning 14: : FStar.Seq.Base.cons__uint8_t is not Low*; it uses a garbage-collected type (e.g. list) and will leak memory; you need to link with a garbage-collector; if this declaration is for specification purposes only, consider marking it noextract or using -bundle <name-of-the-module> to only keep reachable definitions.
Warning 14: : FStar.Seq.Base.append__uint8_t is not Low*; it uses a garbage-collected type (e.g. list) and will leak memory; you need to link with a garbage-collector; if this declaration is for specification purposes only, consider marking it noextract or using -bundle <name-of-the-module> to only keep reachable definitions.
Warning 14: : FStar.Seq.Base.createEmpty__uint8_t is not Low*; it uses a garbage-collected type (e.g. list) and will leak memory; you need to link with a garbage-collector; if this declaration is for specification purposes only, consider marking it noextract or using -bundle <name-of-the-module> to only keep reachable definitions.
Warning 14: : FStar.Seq.Base.seq__uint8_t is not Low*; it uses a garbage-collected type (e.g. list) and will leak memory; you need to link with a garbage-collector; if this declaration is for specification purposes only, consider marking it noextract or using -bundle <name-of-the-module> to only keep reachable definitions.
Warning 14: : Prims.list__uint8_t is not Low*; it uses a garbage-collected type (e.g. list) and will leak memory; you need to link with a garbage-collector; if this declaration is for specification purposes only, consider marking it noextract or using -bundle <name-of-the-module> to only keep reachable definitions.
Warning 14: : Prims.pow2 is not Low*; it uses mathematical integers and runtime checks may fail; rewrite your code to use machine integers, or if you must, use -add-include '"prims_int.h"'; if this declaration is for specification purposes only, consider marking it noextract or using -bundle <name-of-the-module> to only keep reachable definitions.
Warning 14: : Prims.op_LessThanOrEqual is not Low*; it uses mathematical integers and runtime checks may fail; rewrite your code to use machine integers, or if you must, use -add-include '"prims_int.h"'; if this declaration is for specification purposes only, consider marking it noextract or using -bundle <name-of-the-module> to only keep reachable definitions.
Warning 14: : Prims.op_Addition is not Low*; it uses mathematical integers and runtime checks may fail; rewrite your code to use machine integers, or if you must, use -add-include '"prims_int.h"'; if this declaration is for specification purposes only, consider marking it noextract or using -bundle <name-of-the-module> to only keep reachable definitions.
Warning 14: : Prims.op_Subtraction is not Low*; it uses mathematical integers and runtime checks may fail; rewrite your code to use machine integers, or if you must, use -add-include '"prims_int.h"'; if this declaration is for specification purposes only, consider marking it noextract or using -bundle <name-of-the-module> to only keep reachable definitions.
Warning 14: : Prims.op_Multiply is not Low*; it uses mathematical integers and runtime checks may fail; rewrite your code to use machine integers, or if you must, use -add-include '"prims_int.h"'; if this declaration is for specification purposes only, consider marking it noextract or using -bundle <name-of-the-module> to only keep reachable definitions.
Warning 14: : C.String.of_literal is not Low*; it uses F*'s Prims.string type and will leak memory; you need to link with a garbage-collector; if this declaration is for specification purposes only, consider marking it noextract or using -bundle <name-of-the-module> to only keep reachable definitions; if you are looking to use C strings, look into C.String (in kremlib/) and Server (in test/). See the KreMLin tutorial for more information.
[38;5;81m‚öô KreMLin auto-detecting tools.[0m Here's what we found:
[4mreadlink is:[0m readlink
[4mKreMLin called via:[0m C:\build\agent2\_work\6\s\kremlin\_build\src\Kremlin.native
[4mthe Kremlin executable is:[0m C:\build\agent2\_work\6\s\kremlin\_build\src\Kremlin.native
[4mKreMLin home is:[0m C:/build/agent2/_work/6/s/kremlin
[38;5;81m‚öô KreMLin will drive F*.[0m Here's what we found:
read FSTAR_HOME via the environment
[4mfstar converted to windows path:[0m C:/build/agent2/_work/6/s/FStar/bin/fstar.exe
[4mfstar home converted to windows path:[0m C:/build/agent2/_work/6/s/FStar
[4mfstar lib converted to windows path:[0m C:/build/agent2/_work/6/s/FStar/ulib
fstar is on [38;5;202mbranch protz_uint128[0m
[4mfstar is:[0m C:/build/agent2/_work/6/s/FStar/bin/fstar.exe C:/build/agent2/_work/6/s/kremlin/runtime/WasmSupport.fst C:/build/agent2/_work/6/s/FStar/ulib/FStar.UInt128.fst --trace_error --cache_checked_modules --expose_interfaces --include C:/build/agent2/_work/6/s/kremlin/include --include C:/build/agent2/_work/6/s/kremlin/kremlib
[38;5;119m‚úî[0m [PrettyPrinting] ‚è±Ô∏è 16ms
KreMLin: wrote out .c files for C_String, TestLib, C_Loops_Spec_Loops, Prims, FStar, Buffer_Utils, C_Endianness, C_Nullity, Vale_AES, Seq_Create, C, Hacl_Impl_Poly1305_64_Hacl_Impl_Chacha20, Crypto_AEAD_Main, KrmlTest, Flag, LowStar
KreMLin: wrote out .h files for C_String, TestLib, C_Loops_Spec_Loops, Prims, FStar, Buffer_Utils, C_Endianness, C_Nullity, Vale_AES, Seq_Create, C, Hacl_Impl_Poly1305_64_Hacl_Impl_Chacha20, Crypto_AEAD_Main, KrmlTest, Flag, LowStar
[38;5;81m‚öô KreMLin will drive the C compiler.[0m Here's what we found:
[4mgcc is:[0m x86_64-w64-mingw32-gcc
[4mx86_64-w64-mingw32-gcc options are:[0m -I C:/build/agent2/_work/6/s/kremlin/include -I C:/build/agent2/_work/6/s/kremlin/kremlib -I ../secure_api/out/runtime_switch/extracted -Wall -Werror -Wno-unused-variable -Wno-unknown-warning-option -Wno-unused-but-set-variable -g -fwrapv -fstack-check -D_BSD_SOURCE -D_DEFAULT_SOURCE -D__USE_MINGW_ANSI_STDIO -Wno-parentheses -std=c11
[38;5;81m‚ö° Generating object files[0m
[38;5;119m‚úî[0m [CC,../secure_api/out/runtime_switch/extracted/C_String.c] (use -verbose to see the output)
[38;5;119m‚úî[0m [CC,../secure_api/out/runtime_switch/extracted/TestLib.c] (use -verbose to see the output)
[38;5;119m‚úî[0m [CC,../secure_api/out/runtime_switch/extracted/C_Loops_Spec_Loops.c] (use -verbose to see the output)
[38;5;119m‚úî[0m [CC,../secure_api/out/runtime_switch/extracted/Prims.c] (use -verbose to see the output)
[38;5;119m‚úî[0m [CC,../secure_api/out/runtime_switch/extracted/FStar.c] (use -verbose to see the output)
[38;5;119m‚úî[0m [CC,../secure_api/out/runtime_switch/extracted/Buffer_Utils.c] (use -verbose to see the output)
[38;5;119m‚úî[0m [CC,../secure_api/out/runtime_switch/extracted/C_Endianness.c] (use -verbose to see the output)
[38;5;119m‚úî[0m [CC,../secure_api/out/runtime_switch/extracted/C_Nullity.c] (use -verbose to see the output)
[38;5;119m‚úî[0m [CC,../secure_api/out/runtime_switch/extracted/Vale_AES.c] (use -verbose to see the output)
[38;5;119m‚úî[0m [CC,../secure_api/out/runtime_switch/extracted/Seq_Create.c] (use -verbose to see the output)
[38;5;119m‚úî[0m [CC,../secure_api/out/runtime_switch/extracted/C.c] (use -verbose to see the output)
[38;5;119m‚úî[0m [CC,../secure_api/out/runtime_switch/extracted/Hacl_Impl_Poly1305_64_Hacl_Impl_Chacha20.c] (use -verbose to see the output)
[38;5;119m‚úî[0m [CC,../secure_api/out/runtime_switch/extracted/Crypto_AEAD_Main.c] (use -verbose to see the output)
[38;5;119m‚úî[0m [CC,../secure_api/out/runtime_switch/extracted/KrmlTest.c] (use -verbose to see the output)
[38;5;119m‚úî[0m [CC,../secure_api/out/runtime_switch/extracted/Flag.c] (use -verbose to see the output)
[38;5;119m‚úî[0m [CC,../secure_api/out/runtime_switch/extracted/LowStar.c] (use -verbose to see the output)
[38;5;119m‚úî[0m [LD] (use -verbose to see the output)
[38;5;119mAll files linked successfully[0m üëç
./../secure_api/out/runtime_switch/krml-test.exe
test()
[test] expected output cipher is d31a8d34648e60db7b86afbc53ef7ec2a4aded51296e08fea9e2b5a736ee62d63dbea45e8ca9671282fafb69da92728b1a71de0a9e060b2905d6a5b67ecd3b3692ddbd7f2d778b8c9803aee328091b58fab324e4fad675945585808b4831d7bc3ff4def08e4b7a9de576d26586cec64b61161ae10b594f09e26a7e902ecbd0600691
[test] computed output cipher is d31a8d34648e60db7b86afbc53ef7ec2a4aded51296e08fea9e2b5a736ee62d63dbea45e8ca9671282fafb69da92728b1a71de0a9e060b2905d6a5b67ecd3b3692ddbd7f2d778b8c9803aee328091b58fab324e4fad675945585808b4831d7bc3ff4def08e4b7a9de576d26586cec64b61161ae10b594f09e26a7e902ecbd0600691
[test] cipher is a success
[test] expected output decryption is 4c616469657320616e642047656e746c656d656e206f662074686520636c617373206f66202739393a204966204920636f756c64206f6666657220796f75206f6e6c79206f6e652074697020666f7220746865206675747572652c2073756e73637265656e20776f756c642062652069742e
[test] computed output decryption is 4c616469657320616e642047656e746c656d656e206f662074686520636c617373206f66202739393a204966204920636f756c64206f6666657220796f75206f6e6c79206f6e652074697020666f7220746865206675747572652c2073756e73637265656e20776f756c642062652069742e
[test] decryption is a success
test_aes_gcm_0()
[test] expected output cipher is 58e2fccefa7e3061367f1d57a4e7455a
[test] computed output cipher is 58e2fccefa7e3061367f1d57a4e7455a
[test] cipher is a success
[test] expected output decryption is 
[test] computed output decryption is 
[test] decryption is a success
test_aes_gcm_1()
[test] expected output cipher is 530f8afbc74536b9a963b4f1c4cb738b
[test] computed output cipher is 530f8afbc74536b9a963b4f1c4cb738b
[test] cipher is a success
[test] expected output decryption is 
[test] computed output decryption is 
[test] decryption is a success
test_aes_gcm_2()
[test] expected output cipher is cea7403d4d606b6e074ec5d3baf39d18d0d1c8a799996bf0265b98b5d48ab919
[test] computed output cipher is cea7403d4d606b6e074ec5d3baf39d18d0d1c8a799996bf0265b98b5d48ab919
[test] cipher is a success
[test] expected output decryption is 00000000000000000000000000000000
[test] computed output decryption is 00000000000000000000000000000000
[test] decryption is a success
test_aes_gcm_3()
[test] expected output cipher is 522dc1f099567d07f47f37a32a84427d643a8cdcbfe5c0c97598a2bd2555d1aa8cb08e48590dbb3da7b08b1056828838c5f61e6393ba7a0abcc9f662898015adb094dac5d93471bdec1a502270e3cc6c
[test] computed output cipher is 522dc1f099567d07f47f37a32a84427d643a8cdcbfe5c0c97598a2bd2555d1aa8cb08e48590dbb3da7b08b1056828838c5f61e6393ba7a0abcc9f662898015adb094dac5d93471bdec1a502270e3cc6c
[test] cipher is a success
[test] expected output decryption is d9313225f88406e5a55909c5aff5269a86a7a9531534f7da2e4c303d8a318a721c3c0c95956809532fcf0e2449a6b525b16aedf5aa0de657ba637b391aafd255
[test] computed output decryption is d9313225f88406e5a55909c5aff5269a86a7a9531534f7da2e4c303d8a318a721c3c0c95956809532fcf0e2449a6b525b16aedf5aa0de657ba637b391aafd255
[test] decryption is a success
test_aes_gcm_4()
[test] expected output cipher is 522dc1f099567d07f47f37a32a84427d643a8cdcbfe5c0c97598a2bd2555d1aa8cb08e48590dbb3da7b08b1056828838c5f61e6393ba7a0abcc9f66276fc6ece0f4e1768cddf8853bb2d551b
[test] computed output cipher is 522dc1f099567d07f47f37a32a84427d643a8cdcbfe5c0c97598a2bd2555d1aa8cb08e48590dbb3da7b08b1056828838c5f61e6393ba7a0abcc9f66276fc6ece0f4e1768cddf8853bb2d551b
[test] cipher is a success
[test] expected output decryption is d9313225f88406e5a55909c5aff5269a86a7a9531534f7da2e4c303d8a318a721c3c0c95956809532fcf0e2449a6b525b16aedf5aa0de657ba637b39
[test] computed output decryption is d9313225f88406e5a55909c5aff5269a86a7a9531534f7da2e4c303d8a318a721c3c0c95956809532fcf0e2449a6b525b16aedf5aa0de657ba637b39
[test] decryption is a success
make -C C:/build/agent2/_work/6/s/MLCrypto
make[1]: Entering directory '/cygdrive/c/build/agent2/_work/6/s/MLCrypto'
make[1]: Nothing to be done for 'all'.
make[1]: Leaving directory '/cygdrive/c/build/agent2/_work/6/s/MLCrypto'
OCAMLPATH="C:/build/agent2/_work/6/s/FStar/bin" ocamlfind opt -package fstarlib,zarith -g -I C:/build/agent2/_work/6/s/FStar/ulib/ml -c LowCProvider/LowCProvider.ml -I LowCProvider -I ../secure_api/out/runtime_switch -I ../secure_api/out/runtime_switch/extracted -I C:/build/agent2/_work/6/s/MLCrypto -o LowCProvider/LowCProvider.cmx
C:/build/agent2/_work/6/s/kremlin/krml  -bundle 'Crypto_Symmetric_Bytes=*' -minimal -skip-compilation \
-tmpdir ../secure_api/out/runtime_switch/crypto ../secure_api/out/runtime_switch/extracted/prims.krml ../secure_api/out/runtime_switch/extracted/FStar_Pervasives_Native.krml ../secure_api/out/runtime_switch/extracted/FStar_Pervasives.krml ../secure_api/out/runtime_switch/extracted/FStar_Mul.krml ../secure_api/out/runtime_switch/extracted/FStar_Math_Lib.krml ../secure_api/out/runtime_switch/extracted/FStar_Math_Lemmas.krml ../secure_api/out/runtime_switch/extracted/FStar_Squash.krml ../secure_api/out/runtime_switch/extracted/FStar_StrongExcludedMiddle.krml ../secure_api/out/runtime_switch/extracted/FStar_Classical.krml ../secure_api/out/runtime_switch/extracted/FStar_List_Tot_Base.krml ../secure_api/out/runtime_switch/extracted/FStar_List_Tot_Properties.krml ../secure_api/out/runtime_switch/extracted/FStar_List_Tot.krml ../secure_api/out/runtime_switch/extracted/FStar_Seq_Base.krml ../secure_api/out/runtime_switch/extracted/FStar_Seq_Properties.krml ../secure_api/out/runtime_switch/extracted/FStar_Seq.krml ../secure_api/out/runtime_switch/extracted/FStar_BitVector.krml ../secure_api/out/runtime_switch/extracted/FStar_UInt.krml ../secure_api/out/runtime_switch/extracted/FStar_UInt32.krml ../secure_api/out/runtime_switch/extracted/FStar_Int.krml ../secure_api/out/runtime_switch/extracted/FStar_Int64.krml ../secure_api/out/runtime_switch/extracted/FStar_Int63.krml ../secure_api/out/runtime_switch/extracted/FStar_Int32.krml ../secure_api/out/runtime_switch/extracted/FStar_Int16.krml ../secure_api/out/runtime_switch/extracted/FStar_Int8.krml ../secure_api/out/runtime_switch/extracted/FStar_UInt64.krml ../secure_api/out/runtime_switch/extracted/FStar_UInt63.krml ../secure_api/out/runtime_switch/extracted/FStar_UInt16.krml ../secure_api/out/runtime_switch/extracted/FStar_UInt8.krml ../secure_api/out/runtime_switch/extracted/FStar_Int_Cast.krml ../secure_api/out/runtime_switch/extracted/FStar_UInt128.krml ../secure_api/out/runtime_switch/extracted/Hacl_UInt64.krml ../secure_api/out/runtime_switch/extracted/FStar_Preorder.krml ../secure_api/out/runtime_switch/extracted/FStar_Ghost.krml ../secure_api/out/runtime_switch/extracted/FStar_ErasedLogic.krml ../secure_api/out/runtime_switch/extracted/FStar_FunctionalExtensionality.krml ../secure_api/out/runtime_switch/extracted/FStar_Set.krml ../secure_api/out/runtime_switch/extracted/FStar_PropositionalExtensionality.krml ../secure_api/out/runtime_switch/extracted/FStar_PredicateExtensionality.krml ../secure_api/out/runtime_switch/extracted/FStar_TSet.krml ../secure_api/out/runtime_switch/extracted/FStar_Monotonic_Heap.krml ../secure_api/out/runtime_switch/extracted/FStar_Heap.krml ../secure_api/out/runtime_switch/extracted/FStar_Map.krml ../secure_api/out/runtime_switch/extracted/FStar_Monotonic_HyperHeap.krml ../secure_api/out/runtime_switch/extracted/FStar_Monotonic_HyperStack.krml ../secure_api/out/runtime_switch/extracted/FStar_HyperStack.krml ../secure_api/out/runtime_switch/extracted/FStar_Monotonic_Witnessed.krml ../secure_api/out/runtime_switch/extracted/FStar_HyperStack_ST.krml ../secure_api/out/runtime_switch/extracted/FStar_HyperStack_All.krml ../secure_api/out/runtime_switch/extracted/Hacl_UInt128.krml ../secure_api/out/runtime_switch/extracted/Hacl_UInt8.krml ../secure_api/out/runtime_switch/extracted/Hacl_Bignum_Constants.krml ../secure_api/out/runtime_switch/extracted/Hacl_UInt32.krml ../secure_api/out/runtime_switch/extracted/FStar_Int_Cast_Full.krml ../secure_api/out/runtime_switch/extracted/Hacl_Cast.krml ../secure_api/out/runtime_switch/extracted/FStar_Buffer.krml ../secure_api/out/runtime_switch/extracted/Hacl_Bignum_Parameters.krml ../secure_api/out/runtime_switch/extracted/Hacl_Bignum_Wide.krml ../secure_api/out/runtime_switch/extracted/Spec_Loops.krml ../secure_api/out/runtime_switch/extracted/Hacl_Bignum_Limb.krml ../secure_api/out/runtime_switch/extracted/Hacl_Spec_Bignum_Field.krml ../secure_api/out/runtime_switch/extracted/Hacl_Spec_Bignum_Bigint.krml ../secure_api/out/runtime_switch/extracted/Hacl_Spec_Bignum_Modulo.krml ../secure_api/out/runtime_switch/extracted/Hacl_Spec_Bignum_Fproduct.krml ../secure_api/out/runtime_switch/extracted/Hacl_Spec_Bignum_Fmul.krml ../secure_api/out/runtime_switch/extracted/FStar_Endianness.krml ../secure_api/out/runtime_switch/extracted/Spec_Poly1305_Lemmas.krml ../secure_api/out/runtime_switch/extracted/FStar_Kremlin_Endianness.krml ../secure_api/out/runtime_switch/extracted/C_Endianness.krml ../secure_api/out/runtime_switch/extracted/C.krml ../secure_api/out/runtime_switch/extracted/Hacl_UInt16.krml ../secure_api/out/runtime_switch/extracted/Hacl_Spec_Endianness.krml ../secure_api/out/runtime_switch/extracted/Hacl_Endianness.krml ../secure_api/out/runtime_switch/extracted/Spec_Lib.krml ../secure_api/out/runtime_switch/extracted/Seq_Create.krml ../secure_api/out/runtime_switch/extracted/Spec_SHA2_256.krml ../secure_api/out/runtime_switch/extracted/C_Loops.krml ../secure_api/out/runtime_switch/extracted/Hacl_Hash_Lib_LoadStore.krml ../secure_api/out/runtime_switch/extracted/Hacl_Hash_Lib_Create.krml ../secure_api/out/runtime_switch/extracted/Hacl_Impl_SHA2_256_Lemmas.krml ../secure_api/out/runtime_switch/extracted/Hacl_Impl_SHA2_256.krml ../secure_api/out/runtime_switch/extracted/Hacl_Spec_Bignum_Fsum.krml ../secure_api/out/runtime_switch/extracted/Hacl_Bignum_Fsum.krml ../secure_api/out/runtime_switch/extracted/Crypto_AEAD_BufferUtils.krml ../secure_api/out/runtime_switch/extracted/Vale_AES.krml ../secure_api/out/runtime_switch/extracted/Hacl_Impl_Xor_Lemmas.krml ../secure_api/out/runtime_switch/extracted/Spec_CTR_Lemmas.krml ../secure_api/out/runtime_switch/extracted/Spec_CTR.krml ../secure_api/out/runtime_switch/extracted/Hacl_Lib_LoadStore32.krml ../secure_api/out/runtime_switch/extracted/Spec_Chacha20_Lemmas.krml ../secure_api/out/runtime_switch/extracted/Spec_Chacha20.krml ../secure_api/out/runtime_switch/extracted/Hacl_Impl_Chacha20.krml ../secure_api/out/runtime_switch/extracted/Hacl_SecureAPI_Chacha20.krml ../secure_api/out/runtime_switch/extracted/Crypto_Indexing.krml ../secure_api/out/runtime_switch/extracted/Flag.krml ../secure_api/out/runtime_switch/extracted/Crypto_Symmetric_AES.krml ../secure_api/out/runtime_switch/extracted/Crypto_Symmetric_AES128.krml ../secure_api/out/runtime_switch/extracted/FStar_Float.krml ../secure_api/out/runtime_switch/extracted/FStar_Exn.krml ../secure_api/out/runtime_switch/extracted/FStar_ST.krml ../secure_api/out/runtime_switch/extracted/FStar_All.krml ../secure_api/out/runtime_switch/extracted/FStar_IO.krml ../secure_api/out/runtime_switch/extracted/Buffer_Utils.krml ../secure_api/out/runtime_switch/extracted/Crypto_Symmetric_Bytes.krml ../secure_api/out/runtime_switch/extracted/Crypto_Symmetric_Cipher.krml ../secure_api/out/runtime_switch/extracted/C_Nullity.krml ../secure_api/out/runtime_switch/extracted/Hacl_Spec_Bignum_AddAndMultiply.krml ../secure_api/out/runtime_switch/extracted/Spec_Poly1305.krml ../secure_api/out/runtime_switch/extracted/Hacl_Bignum_Modulo.krml ../secure_api/out/runtime_switch/extracted/Hacl_Bignum_Fproduct.krml ../secure_api/out/runtime_switch/extracted/Hacl_Spec_Poly1305_64_State.krml ../secure_api/out/runtime_switch/extracted/Hacl_Spec_Poly1305_64.krml ../secure_api/out/runtime_switch/extracted/Hacl_Impl_Poly1305_64_State.krml ../secure_api/out/runtime_switch/extracted/Hacl_Bignum_Fmul.krml ../secure_api/out/runtime_switch/extracted/Hacl_Bignum_AddAndMultiply.krml ../secure_api/out/runtime_switch/extracted/Hacl_Spe_Poly1305_64.krml ../secure_api/out/runtime_switch/extracted/Hacl_Impl_Poly1305_64.krml ../secure_api/out/runtime_switch/extracted/Spec_GaloisField.krml ../secure_api/out/runtime_switch/extracted/Spec_GF128.krml ../secure_api/out/runtime_switch/extracted/Crypto_Symmetric_GF128.krml ../secure_api/out/runtime_switch/extracted/Crypto_Symmetric_MAC.krml ../secure_api/out/runtime_switch/extracted/Crypto_Symmetric_UF1CMA.krml ../secure_api/out/runtime_switch/extracted/Crypto_Plain.krml ../secure_api/out/runtime_switch/extracted/Crypto_Symmetric_PRF.krml ../secure_api/out/runtime_switch/extracted/Crypto_AEAD_Encoding.krml ../secure_api/out/runtime_switch/extracted/Crypto_AEAD_Invariant.krml ../secure_api/out/runtime_switch/extracted/Crypto_AEAD_Encrypt_Invariant.krml ../secure_api/out/runtime_switch/extracted/Crypto_AEAD_Wrappers_PRF.krml ../secure_api/out/runtime_switch/extracted/Crypto_AEAD_Wrappers_Encoding.krml ../secure_api/out/runtime_switch/extracted/Crypto_AEAD_Wrappers_CMA.krml ../secure_api/out/runtime_switch/extracted/Crypto_AEAD_EnxorDexor.krml ../secure_api/out/runtime_switch/extracted/Crypto_AEAD_Decrypt.krml ../secure_api/out/runtime_switch/extracted/Spec_HMAC_SHA2_256.krml ../secure_api/out/runtime_switch/extracted/Spec_SHA2_512.krml ../secure_api/out/runtime_switch/extracted/Hacl_Impl_SHA2_512_Lemmas.krml ../secure_api/out/runtime_switch/extracted/Hacl_Impl_SHA2_512.krml ../secure_api/out/runtime_switch/extracted/Spec_SHA2_384.krml ../secure_api/out/runtime_switch/extracted/Hacl_Impl_SHA2_384_Lemmas.krml ../secure_api/out/runtime_switch/extracted/Hacl_Impl_SHA2_384.krml ../secure_api/out/runtime_switch/extracted/Crypto_HMAC.krml ../secure_api/out/runtime_switch/extracted/Crypto_AEAD_Encrypt_Ideal_Invariant.krml ../secure_api/out/runtime_switch/extracted/Crypto_AEAD_MAC_Wrapper_Invariant.krml ../secure_api/out/runtime_switch/extracted/Crypto_AEAD_Enxor_Invariant.krml ../secure_api/out/runtime_switch/extracted/Crypto_AEAD_Encrypt.krml ../secure_api/out/runtime_switch/extracted/Crypto_AEAD.krml ../secure_api/out/runtime_switch/extracted/FStar_List.krml ../secure_api/out/runtime_switch/extracted/FStar_Char.krml ../secure_api/out/runtime_switch/extracted/FStar_String.krml ../secure_api/out/runtime_switch/extracted/C_String.krml ../secure_api/out/runtime_switch/extracted/TestLib.krml ../secure_api/out/runtime_switch/extracted/FStar_Bytes.krml ../secure_api/out/runtime_switch/extracted/Crypto_AEAD_Main.krml ../secure_api/out/runtime_switch/extracted/CryptoTypes.krml ../secure_api/out/runtime_switch/extracted/Crypto_HKDF.krml ../secure_api/out/runtime_switch/extracted/HaclProvider.krml ../secure_api/out/runtime_switch/extracted/KrmlTest.krml ../secure_api/out/runtime_switch/extracted/LowCProvider.krml -add-include '"kremlib.h"' -add-include '"kremlin/internal/compat.h"' \

Warning 6: in the definition of buf, after the definition of m0, in the last element of the sequence, in top-level declaration Crypto.Symmetric.Bytes.random_bytes, in file Crypto_Symmetric_Bytes: stack newbuf 0uint8 @1 is a non-constant size, stack-allocated array; this is not supported by CompCert and requires the use of alloca(3) for MSVC
[38;5;119m‚úî[0m [Monomorphization] ‚è±Ô∏è 31ms
[38;5;119m‚úî[0m [Inlining] ‚è±Ô∏è 16ms
[38;5;119m‚úî[0m [Pattern matches compilation] ‚è±Ô∏è <1ms
[38;5;119m‚úî[0m [Simplify 2] ‚è±Ô∏è <1ms
[38;5;119m‚úî[0m [Structs + Simplify 2] ‚è±Ô∏è <1ms
[38;5;119m‚úî[0m [Drop] ‚è±Ô∏è <1ms
Warning 14: : Crypto.Symmetric.Bytes.hex2 is not Low*; it uses F*'s Prims.string type and will leak memory; you need to link with a garbage-collector; if this declaration is for specification purposes only, consider marking it noextract or using -bundle <name-of-the-module> to only keep reachable definitions; if you are looking to use C strings, look into C.String (in kremlib/) and Server (in test/). See the KreMLin tutorial for more information.
[38;5;119m‚úî[0m [AstToCStar] ‚è±Ô∏è <1ms
[38;5;119m‚úî[0m [CStarToC] ‚è±Ô∏è <1ms
Warning 14: : Crypto.Symmetric.Bytes.hex1 is not Low*; it uses F*'s Prims.string type and will leak memory; you need to link with a garbage-collector; if this declaration is for specification purposes only, consider marking it noextract or using -bundle <name-of-the-module> to only keep reachable definitions; if you are looking to use C strings, look into C.String (in kremlib/) and Server (in test/). See the KreMLin tutorial for more information.
Warning 14: : FStar.IO.debug_print_string is not Low*; it uses F*'s Prims.string type and will leak memory; you need to link with a garbage-collector; if this declaration is for specification purposes only, consider marking it noextract or using -bundle <name-of-the-module> to only keep reachable definitions; if you are looking to use C strings, look into C.String (in kremlib/) and Server (in test/). See the KreMLin tutorial for more information.
Warning 14: : FStar.Seq.Base.append__uint8_t is not Low*; it uses a garbage-collected type (e.g. list) and will leak memory; you need to link with a garbage-collector; if this declaration is for specification purposes only, consider marking it noextract or using -bundle <name-of-the-module> to only keep reachable definitions.
Warning 14: : FStar.Seq.Base.createEmpty__uint8_t is not Low*; it uses a garbage-collected type (e.g. list) and will leak memory; you need to link with a garbage-collector; if this declaration is for specification purposes only, consider marking it noextract or using -bundle <name-of-the-module> to only keep reachable definitions.
Warning 14: : FStar.Seq.Properties.last__uint8_t is not Low*; it uses mathematical integers and runtime checks may fail; rewrite your code to use machine integers, or if you must, use -add-include '"prims_int.h"'; if this declaration is for specification purposes only, consider marking it noextract or using -bundle <name-of-the-module> to only keep reachable definitions.
Warning 14: : FStar.Seq.Base.hd__uint8_t is not Low*; it uses a garbage-collected type (e.g. list) and will leak memory; you need to link with a garbage-collector; if this declaration is for specification purposes only, consider marking it noextract or using -bundle <name-of-the-module> to only keep reachable definitions.
Warning 14: : FStar.Seq.Base.cons__uint8_t is not Low*; it uses a garbage-collected type (e.g. list) and will leak memory; you need to link with a garbage-collector; if this declaration is for specification purposes only, consider marking it noextract or using -bundle <name-of-the-module> to only keep reachable definitions.
Warning 14: : FStar.Seq.Base.tl__uint8_t is not Low*; it uses a garbage-collected type (e.g. list) and will leak memory; you need to link with a garbage-collector; if this declaration is for specification purposes only, consider marking it noextract or using -bundle <name-of-the-module> to only keep reachable definitions.
Warning 14: : FStar.Seq.Base.index__uint8_t is not Low*; it uses a garbage-collected type (e.g. list) and will leak memory; you need to link with a garbage-collector; if this declaration is for specification purposes only, consider marking it noextract or using -bundle <name-of-the-module> to only keep reachable definitions.
Warning 14: : FStar.List.Tot.Base.tl__uint8_t is not Low*; it uses a garbage-collected type (e.g. list) and will leak memory; you need to link with a garbage-collector; if this declaration is for specification purposes only, consider marking it noextract or using -bundle <name-of-the-module> to only keep reachable definitions.
Warning 14: : FStar.List.Tot.Base.tail__uint8_t is not Low*; it uses a garbage-collected type (e.g. list) and will leak memory; you need to link with a garbage-collector; if this declaration is for specification purposes only, consider marking it noextract or using -bundle <name-of-the-module> to only keep reachable definitions.
Warning 14: : FStar.List.Tot.Base.hd__uint8_t is not Low*; it uses a garbage-collected type (e.g. list) and will leak memory; you need to link with a garbage-collector; if this declaration is for specification purposes only, consider marking it noextract or using -bundle <name-of-the-module> to only keep reachable definitions.
Warning 14: : FStar.Seq.Base.length__uint8_t is not Low*; it uses a garbage-collected type (e.g. list) and will leak memory; you need to link with a garbage-collector; if this declaration is for specification purposes only, consider marking it noextract or using -bundle <name-of-the-module> to only keep reachable definitions.
Warning 14: : FStar.Seq.Base.seq__uint8_t is not Low*; it uses a garbage-collected type (e.g. list) and will leak memory; you need to link with a garbage-collector; if this declaration is for specification purposes only, consider marking it noextract or using -bundle <name-of-the-module> to only keep reachable definitions.
Warning 14: : Prims.list__uint8_t is not Low*; it uses a garbage-collected type (e.g. list) and will leak memory; you need to link with a garbage-collector; if this declaration is for specification purposes only, consider marking it noextract or using -bundle <name-of-the-module> to only keep reachable definitions.
Warning 14: : FStar.UInt8.to_string is not Low*; it uses F*'s Prims.string type and will leak memory; you need to link with a garbage-collector; if this declaration is for specification purposes only, consider marking it noextract or using -bundle <name-of-the-module> to only keep reachable definitions; if you are looking to use C strings, look into C.String (in kremlib/) and Server (in test/). See the KreMLin tutorial for more information.
Warning 14: : Prims.strcat is not Low*; it uses F*'s Prims.string type and will leak memory; you need to link with a garbage-collector; if this declaration is for specification purposes only, consider marking it noextract or using -bundle <name-of-the-module> to only keep reachable definitions; if you are looking to use C strings, look into C.String (in kremlib/) and Server (in test/). See the KreMLin tutorial for more information.
Warning 14: : Prims.pow2 is not Low*; it uses mathematical integers and runtime checks may fail; rewrite your code to use machine integers, or if you must, use -add-include '"prims_int.h"'; if this declaration is for specification purposes only, consider marking it noextract or using -bundle <name-of-the-module> to only keep reachable definitions.
Warning 14: : Prims.op_GreaterThan is not Low*; it uses mathematical integers and runtime checks may fail; rewrite your code to use machine integers, or if you must, use -add-include '"prims_int.h"'; if this declaration is for specification purposes only, consider marking it noextract or using -bundle <name-of-the-module> to only keep reachable definitions.
Warning 14: : Prims.op_Modulus is not Low*; it uses mathematical integers and runtime checks may fail; rewrite your code to use machine integers, or if you must, use -add-include '"prims_int.h"'; if this declaration is for specification purposes only, consider marking it noextract or using -bundle <name-of-the-module> to only keep reachable definitions.
Warning 14: : Prims.op_Addition is not Low*; it uses mathematical integers and runtime checks may fail; rewrite your code to use machine integers, or if you must, use -add-include '"prims_int.h"'; if this declaration is for specification purposes only, consider marking it noextract or using -bundle <name-of-the-module> to only keep reachable definitions.
Warning 14: : Prims.op_Subtraction is not Low*; it uses mathematical integers and runtime checks may fail; rewrite your code to use machine integers, or if you must, use -add-include '"prims_int.h"'; if this declaration is for specification purposes only, consider marking it noextract or using -bundle <name-of-the-module> to only keep reachable definitions.
Warning 14: : Prims.op_Division is not Low*; it uses mathematical integers and runtime checks may fail; rewrite your code to use machine integers, or if you must, use -add-include '"prims_int.h"'; if this declaration is for specification purposes only, consider marking it noextract or using -bundle <name-of-the-module> to only keep reachable definitions.
Warning 14: : Prims.op_Multiply is not Low*; it uses mathematical integers and runtime checks may fail; rewrite your code to use machine integers, or if you must, use -add-include '"prims_int.h"'; if this declaration is for specification purposes only, consider marking it noextract or using -bundle <name-of-the-module> to only keep reachable definitions.
[38;5;81m‚öô KreMLin auto-detecting tools.[0m Here's what we found:
[4mreadlink is:[0m readlink
[4mKreMLin called via:[0m C:\build\agent2\_work\6\s\kremlin\_build\src\Kremlin.native
[4mthe Kremlin executable is:[0m C:\build\agent2\_work\6\s\kremlin\_build\src\Kremlin.native
[4mKreMLin home is:[0m C:/build/agent2/_work/6/s/kremlin
[38;5;81m‚öô KreMLin will drive F*.[0m Here's what we found:
read FSTAR_HOME via the environment
[4mfstar converted to windows path:[0m C:/build/agent2/_work/6/s/FStar/bin/fstar.exe
[4mfstar home converted to windows path:[0m C:/build/agent2/_work/6/s/FStar
[4mfstar lib converted to windows path:[0m C:/build/agent2/_work/6/s/FStar/ulib
fstar is on [38;5;202mbranch protz_uint128[0m
[4mfstar is:[0m C:/build/agent2/_work/6/s/FStar/bin/fstar.exe C:/build/agent2/_work/6/s/kremlin/runtime/WasmSupport.fst C:/build/agent2/_work/6/s/FStar/ulib/FStar.UInt128.fst --trace_error --cache_checked_modules --expose_interfaces --include C:/build/agent2/_work/6/s/kremlin/include --include C:/build/agent2/_work/6/s/kremlin/kremlib
[38;5;119m‚úî[0m [PrettyPrinting] ‚è±Ô∏è <1ms
KreMLin: wrote out .c files for Crypto_Symmetric_Bytes
KreMLin: wrote out .h files for Crypto_Symmetric_Bytes
C:/build/agent2/_work/6/s/kremlin/krml  -bundle 'Crypto_AEAD_Main+Crypto_Symmetric_Cipher+Crypto_Indexing=*' -minimal -skip-compilation \
-tmpdir ../secure_api/out/runtime_switch/crypto ../secure_api/out/runtime_switch/extracted/prims.krml ../secure_api/out/runtime_switch/extracted/FStar_Pervasives_Native.krml ../secure_api/out/runtime_switch/extracted/FStar_Pervasives.krml ../secure_api/out/runtime_switch/extracted/FStar_Mul.krml ../secure_api/out/runtime_switch/extracted/FStar_Math_Lib.krml ../secure_api/out/runtime_switch/extracted/FStar_Math_Lemmas.krml ../secure_api/out/runtime_switch/extracted/FStar_Squash.krml ../secure_api/out/runtime_switch/extracted/FStar_StrongExcludedMiddle.krml ../secure_api/out/runtime_switch/extracted/FStar_Classical.krml ../secure_api/out/runtime_switch/extracted/FStar_List_Tot_Base.krml ../secure_api/out/runtime_switch/extracted/FStar_List_Tot_Properties.krml ../secure_api/out/runtime_switch/extracted/FStar_List_Tot.krml ../secure_api/out/runtime_switch/extracted/FStar_Seq_Base.krml ../secure_api/out/runtime_switch/extracted/FStar_Seq_Properties.krml ../secure_api/out/runtime_switch/extracted/FStar_Seq.krml ../secure_api/out/runtime_switch/extracted/FStar_BitVector.krml ../secure_api/out/runtime_switch/extracted/FStar_UInt.krml ../secure_api/out/runtime_switch/extracted/FStar_UInt32.krml ../secure_api/out/runtime_switch/extracted/FStar_Int.krml ../secure_api/out/runtime_switch/extracted/FStar_Int64.krml ../secure_api/out/runtime_switch/extracted/FStar_Int63.krml ../secure_api/out/runtime_switch/extracted/FStar_Int32.krml ../secure_api/out/runtime_switch/extracted/FStar_Int16.krml ../secure_api/out/runtime_switch/extracted/FStar_Int8.krml ../secure_api/out/runtime_switch/extracted/FStar_UInt64.krml ../secure_api/out/runtime_switch/extracted/FStar_UInt63.krml ../secure_api/out/runtime_switch/extracted/FStar_UInt16.krml ../secure_api/out/runtime_switch/extracted/FStar_UInt8.krml ../secure_api/out/runtime_switch/extracted/FStar_Int_Cast.krml ../secure_api/out/runtime_switch/extracted/FStar_UInt128.krml ../secure_api/out/runtime_switch/extracted/Hacl_UInt64.krml ../secure_api/out/runtime_switch/extracted/FStar_Preorder.krml ../secure_api/out/runtime_switch/extracted/FStar_Ghost.krml ../secure_api/out/runtime_switch/extracted/FStar_ErasedLogic.krml ../secure_api/out/runtime_switch/extracted/FStar_FunctionalExtensionality.krml ../secure_api/out/runtime_switch/extracted/FStar_Set.krml ../secure_api/out/runtime_switch/extracted/FStar_PropositionalExtensionality.krml ../secure_api/out/runtime_switch/extracted/FStar_PredicateExtensionality.krml ../secure_api/out/runtime_switch/extracted/FStar_TSet.krml ../secure_api/out/runtime_switch/extracted/FStar_Monotonic_Heap.krml ../secure_api/out/runtime_switch/extracted/FStar_Heap.krml ../secure_api/out/runtime_switch/extracted/FStar_Map.krml ../secure_api/out/runtime_switch/extracted/FStar_Monotonic_HyperHeap.krml ../secure_api/out/runtime_switch/extracted/FStar_Monotonic_HyperStack.krml ../secure_api/out/runtime_switch/extracted/FStar_HyperStack.krml ../secure_api/out/runtime_switch/extracted/FStar_Monotonic_Witnessed.krml ../secure_api/out/runtime_switch/extracted/FStar_HyperStack_ST.krml ../secure_api/out/runtime_switch/extracted/FStar_HyperStack_All.krml ../secure_api/out/runtime_switch/extracted/Hacl_UInt128.krml ../secure_api/out/runtime_switch/extracted/Hacl_UInt8.krml ../secure_api/out/runtime_switch/extracted/Hacl_Bignum_Constants.krml ../secure_api/out/runtime_switch/extracted/Hacl_UInt32.krml ../secure_api/out/runtime_switch/extracted/FStar_Int_Cast_Full.krml ../secure_api/out/runtime_switch/extracted/Hacl_Cast.krml ../secure_api/out/runtime_switch/extracted/FStar_Buffer.krml ../secure_api/out/runtime_switch/extracted/Hacl_Bignum_Parameters.krml ../secure_api/out/runtime_switch/extracted/Hacl_Bignum_Wide.krml ../secure_api/out/runtime_switch/extracted/Spec_Loops.krml ../secure_api/out/runtime_switch/extracted/Hacl_Bignum_Limb.krml ../secure_api/out/runtime_switch/extracted/Hacl_Spec_Bignum_Field.krml ../secure_api/out/runtime_switch/extracted/Hacl_Spec_Bignum_Bigint.krml ../secure_api/out/runtime_switch/extracted/Hacl_Spec_Bignum_Modulo.krml ../secure_api/out/runtime_switch/extracted/Hacl_Spec_Bignum_Fproduct.krml ../secure_api/out/runtime_switch/extracted/Hacl_Spec_Bignum_Fmul.krml ../secure_api/out/runtime_switch/extracted/FStar_Endianness.krml ../secure_api/out/runtime_switch/extracted/Spec_Poly1305_Lemmas.krml ../secure_api/out/runtime_switch/extracted/FStar_Kremlin_Endianness.krml ../secure_api/out/runtime_switch/extracted/C_Endianness.krml ../secure_api/out/runtime_switch/extracted/C.krml ../secure_api/out/runtime_switch/extracted/Hacl_UInt16.krml ../secure_api/out/runtime_switch/extracted/Hacl_Spec_Endianness.krml ../secure_api/out/runtime_switch/extracted/Hacl_Endianness.krml ../secure_api/out/runtime_switch/extracted/Spec_Lib.krml ../secure_api/out/runtime_switch/extracted/Seq_Create.krml ../secure_api/out/runtime_switch/extracted/Spec_SHA2_256.krml ../secure_api/out/runtime_switch/extracted/C_Loops.krml ../secure_api/out/runtime_switch/extracted/Hacl_Hash_Lib_LoadStore.krml ../secure_api/out/runtime_switch/extracted/Hacl_Hash_Lib_Create.krml ../secure_api/out/runtime_switch/extracted/Hacl_Impl_SHA2_256_Lemmas.krml ../secure_api/out/runtime_switch/extracted/Hacl_Impl_SHA2_256.krml ../secure_api/out/runtime_switch/extracted/Hacl_Spec_Bignum_Fsum.krml ../secure_api/out/runtime_switch/extracted/Hacl_Bignum_Fsum.krml ../secure_api/out/runtime_switch/extracted/Crypto_AEAD_BufferUtils.krml ../secure_api/out/runtime_switch/extracted/Vale_AES.krml ../secure_api/out/runtime_switch/extracted/Hacl_Impl_Xor_Lemmas.krml ../secure_api/out/runtime_switch/extracted/Spec_CTR_Lemmas.krml ../secure_api/out/runtime_switch/extracted/Spec_CTR.krml ../secure_api/out/runtime_switch/extracted/Hacl_Lib_LoadStore32.krml ../secure_api/out/runtime_switch/extracted/Spec_Chacha20_Lemmas.krml ../secure_api/out/runtime_switch/extracted/Spec_Chacha20.krml ../secure_api/out/runtime_switch/extracted/Hacl_Impl_Chacha20.krml ../secure_api/out/runtime_switch/extracted/Hacl_SecureAPI_Chacha20.krml ../secure_api/out/runtime_switch/extracted/Crypto_Indexing.krml ../secure_api/out/runtime_switch/extracted/Flag.krml ../secure_api/out/runtime_switch/extracted/Crypto_Symmetric_AES.krml ../secure_api/out/runtime_switch/extracted/Crypto_Symmetric_AES128.krml ../secure_api/out/runtime_switch/extracted/FStar_Float.krml ../secure_api/out/runtime_switch/extracted/FStar_Exn.krml ../secure_api/out/runtime_switch/extracted/FStar_ST.krml ../secure_api/out/runtime_switch/extracted/FStar_All.krml ../secure_api/out/runtime_switch/extracted/FStar_IO.krml ../secure_api/out/runtime_switch/extracted/Buffer_Utils.krml ../secure_api/out/runtime_switch/extracted/Crypto_Symmetric_Bytes.krml ../secure_api/out/runtime_switch/extracted/Crypto_Symmetric_Cipher.krml ../secure_api/out/runtime_switch/extracted/C_Nullity.krml ../secure_api/out/runtime_switch/extracted/Hacl_Spec_Bignum_AddAndMultiply.krml ../secure_api/out/runtime_switch/extracted/Spec_Poly1305.krml ../secure_api/out/runtime_switch/extracted/Hacl_Bignum_Modulo.krml ../secure_api/out/runtime_switch/extracted/Hacl_Bignum_Fproduct.krml ../secure_api/out/runtime_switch/extracted/Hacl_Spec_Poly1305_64_State.krml ../secure_api/out/runtime_switch/extracted/Hacl_Spec_Poly1305_64.krml ../secure_api/out/runtime_switch/extracted/Hacl_Impl_Poly1305_64_State.krml ../secure_api/out/runtime_switch/extracted/Hacl_Bignum_Fmul.krml ../secure_api/out/runtime_switch/extracted/Hacl_Bignum_AddAndMultiply.krml ../secure_api/out/runtime_switch/extracted/Hacl_Spe_Poly1305_64.krml ../secure_api/out/runtime_switch/extracted/Hacl_Impl_Poly1305_64.krml ../secure_api/out/runtime_switch/extracted/Spec_GaloisField.krml ../secure_api/out/runtime_switch/extracted/Spec_GF128.krml ../secure_api/out/runtime_switch/extracted/Crypto_Symmetric_GF128.krml ../secure_api/out/runtime_switch/extracted/Crypto_Symmetric_MAC.krml ../secure_api/out/runtime_switch/extracted/Crypto_Symmetric_UF1CMA.krml ../secure_api/out/runtime_switch/extracted/Crypto_Plain.krml ../secure_api/out/runtime_switch/extracted/Crypto_Symmetric_PRF.krml ../secure_api/out/runtime_switch/extracted/Crypto_AEAD_Encoding.krml ../secure_api/out/runtime_switch/extracted/Crypto_AEAD_Invariant.krml ../secure_api/out/runtime_switch/extracted/Crypto_AEAD_Encrypt_Invariant.krml ../secure_api/out/runtime_switch/extracted/Crypto_AEAD_Wrappers_PRF.krml ../secure_api/out/runtime_switch/extracted/Crypto_AEAD_Wrappers_Encoding.krml ../secure_api/out/runtime_switch/extracted/Crypto_AEAD_Wrappers_CMA.krml ../secure_api/out/runtime_switch/extracted/Crypto_AEAD_EnxorDexor.krml ../secure_api/out/runtime_switch/extracted/Crypto_AEAD_Decrypt.krml ../secure_api/out/runtime_switch/extracted/Spec_HMAC_SHA2_256.krml ../secure_api/out/runtime_switch/extracted/Spec_SHA2_512.krml ../secure_api/out/runtime_switch/extracted/Hacl_Impl_SHA2_512_Lemmas.krml ../secure_api/out/runtime_switch/extracted/Hacl_Impl_SHA2_512.krml ../secure_api/out/runtime_switch/extracted/Spec_SHA2_384.krml ../secure_api/out/runtime_switch/extracted/Hacl_Impl_SHA2_384_Lemmas.krml ../secure_api/out/runtime_switch/extracted/Hacl_Impl_SHA2_384.krml ../secure_api/out/runtime_switch/extracted/Crypto_HMAC.krml ../secure_api/out/runtime_switch/extracted/Crypto_AEAD_Encrypt_Ideal_Invariant.krml ../secure_api/out/runtime_switch/extracted/Crypto_AEAD_MAC_Wrapper_Invariant.krml ../secure_api/out/runtime_switch/extracted/Crypto_AEAD_Enxor_Invariant.krml ../secure_api/out/runtime_switch/extracted/Crypto_AEAD_Encrypt.krml ../secure_api/out/runtime_switch/extracted/Crypto_AEAD.krml ../secure_api/out/runtime_switch/extracted/FStar_List.krml ../secure_api/out/runtime_switch/extracted/FStar_Char.krml ../secure_api/out/runtime_switch/extracted/FStar_String.krml ../secure_api/out/runtime_switch/extracted/C_String.krml ../secure_api/out/runtime_switch/extracted/TestLib.krml ../secure_api/out/runtime_switch/extracted/FStar_Bytes.krml ../secure_api/out/runtime_switch/extracted/Crypto_AEAD_Main.krml ../secure_api/out/runtime_switch/extracted/CryptoTypes.krml ../secure_api/out/runtime_switch/extracted/Crypto_HKDF.krml ../secure_api/out/runtime_switch/extracted/HaclProvider.krml ../secure_api/out/runtime_switch/extracted/KrmlTest.krml ../secure_api/out/runtime_switch/extracted/LowCProvider.krml -add-include '"kremlib.h"' -add-include '"kremlin/internal/compat.h"' \

Warning 6: in the definition of keyBuffer, after the definition of h0, in the last element of the sequence, after the definition of macId, in top-level declaration Crypto.Symmetric.PRF.prf_mac, in file Crypto_AEAD_Main_Crypto_Symmetric_Cipher_Crypto_Indexing: stack newbuf 0uint8 Crypto.Symmetric.UF1CMA.keylen @5 is a non-constant size, stack-allocated array; this is not supported by CompCert and requires the use of alloca(3) for MSVC
[38;5;119m‚úî[0m [Monomorphization] ‚è±Ô∏è 78ms
[38;5;119m‚úî[0m [Inlining] ‚è±Ô∏è 63ms
[38;5;119m‚úî[0m [Pattern matches compilation] ‚è±Ô∏è 47ms
[38;5;119m‚úî[0m [Simplify 2] ‚è±Ô∏è 297ms
[38;5;119m‚úî[0m [Structs + Simplify 2] ‚è±Ô∏è 328ms
[38;5;119m‚úî[0m [Drop] ‚è±Ô∏è <1ms
Warning 14: : Crypto.AEAD.Invariant.safelen is not Low*; it uses mathematical integers and runtime checks may fail; rewrite your code to use machine integers, or if you must, use -add-include '"prims_int.h"'; if this declaration is for specification purposes only, consider marking it noextract or using -bundle <name-of-the-module> to only keep reachable definitions.
Warning 14: : Crypto.AEAD.Invariant.maxplain is not Low*; it uses mathematical integers and runtime checks may fail; rewrite your code to use machine integers, or if you must, use -add-include '"prims_int.h"'; if this declaration is for specification purposes only, consider marking it noextract or using -bundle <name-of-the-module> to only keep reachable definitions.
Warning 14: : Prims.pow2 is not Low*; it uses mathematical integers and runtime checks may fail; rewrite your code to use machine integers, or if you must, use -add-include '"prims_int.h"'; if this declaration is for specification purposes only, consider marking it noextract or using -bundle <name-of-the-module> to only keep reachable definitions.
Warning 14: : Prims.op_LessThanOrEqual is not Low*; it uses mathematical integers and runtime checks may fail; rewrite your code to use machine integers, or if you must, use -add-include '"prims_int.h"'; if this declaration is for specification purposes only, consider marking it noextract or using -bundle <name-of-the-module> to only keep reachable definitions.
Warning 14: : Prims.op_Addition is not Low*; it uses mathematical integers and runtime checks may fail; rewrite your code to use machine integers, or if you must, use -add-include '"prims_int.h"'; if this declaration is for specification purposes only, consider marking it noextract or using -bundle <name-of-the-module> to only keep reachable definitions.
[38;5;119m‚úî[0m [AstToCStar] ‚è±Ô∏è 16ms
[38;5;119m‚úî[0m [CStarToC] ‚è±Ô∏è <1ms
Warning 14: : Prims.op_Multiply is not Low*; it uses mathematical integers and runtime checks may fail; rewrite your code to use machine integers, or if you must, use -add-include '"prims_int.h"'; if this declaration is for specification purposes only, consider marking it noextract or using -bundle <name-of-the-module> to only keep reachable definitions.
[38;5;81m‚öô KreMLin auto-detecting tools.[0m Here's what we found:
[4mreadlink is:[0m readlink
[4mKreMLin called via:[0m C:\build\agent2\_work\6\s\kremlin\_build\src\Kremlin.native
[4mthe Kremlin executable is:[0m C:\build\agent2\_work\6\s\kremlin\_build\src\Kremlin.native
[4mKreMLin home is:[0m C:/build/agent2/_work/6/s/kremlin
[38;5;81m‚öô KreMLin will drive F*.[0m Here's what we found:
read FSTAR_HOME via the environment
[4mfstar converted to windows path:[0m C:/build/agent2/_work/6/s/FStar/bin/fstar.exe
[4mfstar home converted to windows path:[0m C:/build/agent2/_work/6/s/FStar
[4mfstar lib converted to windows path:[0m C:/build/agent2/_work/6/s/FStar/ulib
fstar is on [38;5;202mbranch protz_uint128[0m
[4mfstar is:[0m C:/build/agent2/_work/6/s/FStar/bin/fstar.exe C:/build/agent2/_work/6/s/kremlin/runtime/WasmSupport.fst C:/build/agent2/_work/6/s/FStar/ulib/FStar.UInt128.fst --trace_error --cache_checked_modules --expose_interfaces --include C:/build/agent2/_work/6/s/kremlin/include --include C:/build/agent2/_work/6/s/kremlin/kremlib
[38;5;119m‚úî[0m [PrettyPrinting] ‚è±Ô∏è <1ms
KreMLin: wrote out .c files for Crypto_AEAD_Main_Crypto_Symmetric_Cipher_Crypto_Indexing
KreMLin: wrote out .h files for Crypto_AEAD_Main_Crypto_Symmetric_Cipher_Crypto_Indexing
C:/build/agent2/_work/6/s/kremlin/krml  -bundle 'Crypto_HKDF+Crypto_HMAC=*' -minimal -skip-compilation \
-tmpdir ../secure_api/out/runtime_switch/crypto ../secure_api/out/runtime_switch/extracted/prims.krml ../secure_api/out/runtime_switch/extracted/FStar_Pervasives_Native.krml ../secure_api/out/runtime_switch/extracted/FStar_Pervasives.krml ../secure_api/out/runtime_switch/extracted/FStar_Mul.krml ../secure_api/out/runtime_switch/extracted/FStar_Math_Lib.krml ../secure_api/out/runtime_switch/extracted/FStar_Math_Lemmas.krml ../secure_api/out/runtime_switch/extracted/FStar_Squash.krml ../secure_api/out/runtime_switch/extracted/FStar_StrongExcludedMiddle.krml ../secure_api/out/runtime_switch/extracted/FStar_Classical.krml ../secure_api/out/runtime_switch/extracted/FStar_List_Tot_Base.krml ../secure_api/out/runtime_switch/extracted/FStar_List_Tot_Properties.krml ../secure_api/out/runtime_switch/extracted/FStar_List_Tot.krml ../secure_api/out/runtime_switch/extracted/FStar_Seq_Base.krml ../secure_api/out/runtime_switch/extracted/FStar_Seq_Properties.krml ../secure_api/out/runtime_switch/extracted/FStar_Seq.krml ../secure_api/out/runtime_switch/extracted/FStar_BitVector.krml ../secure_api/out/runtime_switch/extracted/FStar_UInt.krml ../secure_api/out/runtime_switch/extracted/FStar_UInt32.krml ../secure_api/out/runtime_switch/extracted/FStar_Int.krml ../secure_api/out/runtime_switch/extracted/FStar_Int64.krml ../secure_api/out/runtime_switch/extracted/FStar_Int63.krml ../secure_api/out/runtime_switch/extracted/FStar_Int32.krml ../secure_api/out/runtime_switch/extracted/FStar_Int16.krml ../secure_api/out/runtime_switch/extracted/FStar_Int8.krml ../secure_api/out/runtime_switch/extracted/FStar_UInt64.krml ../secure_api/out/runtime_switch/extracted/FStar_UInt63.krml ../secure_api/out/runtime_switch/extracted/FStar_UInt16.krml ../secure_api/out/runtime_switch/extracted/FStar_UInt8.krml ../secure_api/out/runtime_switch/extracted/FStar_Int_Cast.krml ../secure_api/out/runtime_switch/extracted/FStar_UInt128.krml ../secure_api/out/runtime_switch/extracted/Hacl_UInt64.krml ../secure_api/out/runtime_switch/extracted/FStar_Preorder.krml ../secure_api/out/runtime_switch/extracted/FStar_Ghost.krml ../secure_api/out/runtime_switch/extracted/FStar_ErasedLogic.krml ../secure_api/out/runtime_switch/extracted/FStar_FunctionalExtensionality.krml ../secure_api/out/runtime_switch/extracted/FStar_Set.krml ../secure_api/out/runtime_switch/extracted/FStar_PropositionalExtensionality.krml ../secure_api/out/runtime_switch/extracted/FStar_PredicateExtensionality.krml ../secure_api/out/runtime_switch/extracted/FStar_TSet.krml ../secure_api/out/runtime_switch/extracted/FStar_Monotonic_Heap.krml ../secure_api/out/runtime_switch/extracted/FStar_Heap.krml ../secure_api/out/runtime_switch/extracted/FStar_Map.krml ../secure_api/out/runtime_switch/extracted/FStar_Monotonic_HyperHeap.krml ../secure_api/out/runtime_switch/extracted/FStar_Monotonic_HyperStack.krml ../secure_api/out/runtime_switch/extracted/FStar_HyperStack.krml ../secure_api/out/runtime_switch/extracted/FStar_Monotonic_Witnessed.krml ../secure_api/out/runtime_switch/extracted/FStar_HyperStack_ST.krml ../secure_api/out/runtime_switch/extracted/FStar_HyperStack_All.krml ../secure_api/out/runtime_switch/extracted/Hacl_UInt128.krml ../secure_api/out/runtime_switch/extracted/Hacl_UInt8.krml ../secure_api/out/runtime_switch/extracted/Hacl_Bignum_Constants.krml ../secure_api/out/runtime_switch/extracted/Hacl_UInt32.krml ../secure_api/out/runtime_switch/extracted/FStar_Int_Cast_Full.krml ../secure_api/out/runtime_switch/extracted/Hacl_Cast.krml ../secure_api/out/runtime_switch/extracted/FStar_Buffer.krml ../secure_api/out/runtime_switch/extracted/Hacl_Bignum_Parameters.krml ../secure_api/out/runtime_switch/extracted/Hacl_Bignum_Wide.krml ../secure_api/out/runtime_switch/extracted/Spec_Loops.krml ../secure_api/out/runtime_switch/extracted/Hacl_Bignum_Limb.krml ../secure_api/out/runtime_switch/extracted/Hacl_Spec_Bignum_Field.krml ../secure_api/out/runtime_switch/extracted/Hacl_Spec_Bignum_Bigint.krml ../secure_api/out/runtime_switch/extracted/Hacl_Spec_Bignum_Modulo.krml ../secure_api/out/runtime_switch/extracted/Hacl_Spec_Bignum_Fproduct.krml ../secure_api/out/runtime_switch/extracted/Hacl_Spec_Bignum_Fmul.krml ../secure_api/out/runtime_switch/extracted/FStar_Endianness.krml ../secure_api/out/runtime_switch/extracted/Spec_Poly1305_Lemmas.krml ../secure_api/out/runtime_switch/extracted/FStar_Kremlin_Endianness.krml ../secure_api/out/runtime_switch/extracted/C_Endianness.krml ../secure_api/out/runtime_switch/extracted/C.krml ../secure_api/out/runtime_switch/extracted/Hacl_UInt16.krml ../secure_api/out/runtime_switch/extracted/Hacl_Spec_Endianness.krml ../secure_api/out/runtime_switch/extracted/Hacl_Endianness.krml ../secure_api/out/runtime_switch/extracted/Spec_Lib.krml ../secure_api/out/runtime_switch/extracted/Seq_Create.krml ../secure_api/out/runtime_switch/extracted/Spec_SHA2_256.krml ../secure_api/out/runtime_switch/extracted/C_Loops.krml ../secure_api/out/runtime_switch/extracted/Hacl_Hash_Lib_LoadStore.krml ../secure_api/out/runtime_switch/extracted/Hacl_Hash_Lib_Create.krml ../secure_api/out/runtime_switch/extracted/Hacl_Impl_SHA2_256_Lemmas.krml ../secure_api/out/runtime_switch/extracted/Hacl_Impl_SHA2_256.krml ../secure_api/out/runtime_switch/extracted/Hacl_Spec_Bignum_Fsum.krml ../secure_api/out/runtime_switch/extracted/Hacl_Bignum_Fsum.krml ../secure_api/out/runtime_switch/extracted/Crypto_AEAD_BufferUtils.krml ../secure_api/out/runtime_switch/extracted/Vale_AES.krml ../secure_api/out/runtime_switch/extracted/Hacl_Impl_Xor_Lemmas.krml ../secure_api/out/runtime_switch/extracted/Spec_CTR_Lemmas.krml ../secure_api/out/runtime_switch/extracted/Spec_CTR.krml ../secure_api/out/runtime_switch/extracted/Hacl_Lib_LoadStore32.krml ../secure_api/out/runtime_switch/extracted/Spec_Chacha20_Lemmas.krml ../secure_api/out/runtime_switch/extracted/Spec_Chacha20.krml ../secure_api/out/runtime_switch/extracted/Hacl_Impl_Chacha20.krml ../secure_api/out/runtime_switch/extracted/Hacl_SecureAPI_Chacha20.krml ../secure_api/out/runtime_switch/extracted/Crypto_Indexing.krml ../secure_api/out/runtime_switch/extracted/Flag.krml ../secure_api/out/runtime_switch/extracted/Crypto_Symmetric_AES.krml ../secure_api/out/runtime_switch/extracted/Crypto_Symmetric_AES128.krml ../secure_api/out/runtime_switch/extracted/FStar_Float.krml ../secure_api/out/runtime_switch/extracted/FStar_Exn.krml ../secure_api/out/runtime_switch/extracted/FStar_ST.krml ../secure_api/out/runtime_switch/extracted/FStar_All.krml ../secure_api/out/runtime_switch/extracted/FStar_IO.krml ../secure_api/out/runtime_switch/extracted/Buffer_Utils.krml ../secure_api/out/runtime_switch/extracted/Crypto_Symmetric_Bytes.krml ../secure_api/out/runtime_switch/extracted/Crypto_Symmetric_Cipher.krml ../secure_api/out/runtime_switch/extracted/C_Nullity.krml ../secure_api/out/runtime_switch/extracted/Hacl_Spec_Bignum_AddAndMultiply.krml ../secure_api/out/runtime_switch/extracted/Spec_Poly1305.krml ../secure_api/out/runtime_switch/extracted/Hacl_Bignum_Modulo.krml ../secure_api/out/runtime_switch/extracted/Hacl_Bignum_Fproduct.krml ../secure_api/out/runtime_switch/extracted/Hacl_Spec_Poly1305_64_State.krml ../secure_api/out/runtime_switch/extracted/Hacl_Spec_Poly1305_64.krml ../secure_api/out/runtime_switch/extracted/Hacl_Impl_Poly1305_64_State.krml ../secure_api/out/runtime_switch/extracted/Hacl_Bignum_Fmul.krml ../secure_api/out/runtime_switch/extracted/Hacl_Bignum_AddAndMultiply.krml ../secure_api/out/runtime_switch/extracted/Hacl_Spe_Poly1305_64.krml ../secure_api/out/runtime_switch/extracted/Hacl_Impl_Poly1305_64.krml ../secure_api/out/runtime_switch/extracted/Spec_GaloisField.krml ../secure_api/out/runtime_switch/extracted/Spec_GF128.krml ../secure_api/out/runtime_switch/extracted/Crypto_Symmetric_GF128.krml ../secure_api/out/runtime_switch/extracted/Crypto_Symmetric_MAC.krml ../secure_api/out/runtime_switch/extracted/Crypto_Symmetric_UF1CMA.krml ../secure_api/out/runtime_switch/extracted/Crypto_Plain.krml ../secure_api/out/runtime_switch/extracted/Crypto_Symmetric_PRF.krml ../secure_api/out/runtime_switch/extracted/Crypto_AEAD_Encoding.krml ../secure_api/out/runtime_switch/extracted/Crypto_AEAD_Invariant.krml ../secure_api/out/runtime_switch/extracted/Crypto_AEAD_Encrypt_Invariant.krml ../secure_api/out/runtime_switch/extracted/Crypto_AEAD_Wrappers_PRF.krml ../secure_api/out/runtime_switch/extracted/Crypto_AEAD_Wrappers_Encoding.krml ../secure_api/out/runtime_switch/extracted/Crypto_AEAD_Wrappers_CMA.krml ../secure_api/out/runtime_switch/extracted/Crypto_AEAD_EnxorDexor.krml ../secure_api/out/runtime_switch/extracted/Crypto_AEAD_Decrypt.krml ../secure_api/out/runtime_switch/extracted/Spec_HMAC_SHA2_256.krml ../secure_api/out/runtime_switch/extracted/Spec_SHA2_512.krml ../secure_api/out/runtime_switch/extracted/Hacl_Impl_SHA2_512_Lemmas.krml ../secure_api/out/runtime_switch/extracted/Hacl_Impl_SHA2_512.krml ../secure_api/out/runtime_switch/extracted/Spec_SHA2_384.krml ../secure_api/out/runtime_switch/extracted/Hacl_Impl_SHA2_384_Lemmas.krml ../secure_api/out/runtime_switch/extracted/Hacl_Impl_SHA2_384.krml ../secure_api/out/runtime_switch/extracted/Crypto_HMAC.krml ../secure_api/out/runtime_switch/extracted/Crypto_AEAD_Encrypt_Ideal_Invariant.krml ../secure_api/out/runtime_switch/extracted/Crypto_AEAD_MAC_Wrapper_Invariant.krml ../secure_api/out/runtime_switch/extracted/Crypto_AEAD_Enxor_Invariant.krml ../secure_api/out/runtime_switch/extracted/Crypto_AEAD_Encrypt.krml ../secure_api/out/runtime_switch/extracted/Crypto_AEAD.krml ../secure_api/out/runtime_switch/extracted/FStar_List.krml ../secure_api/out/runtime_switch/extracted/FStar_Char.krml ../secure_api/out/runtime_switch/extracted/FStar_String.krml ../secure_api/out/runtime_switch/extracted/C_String.krml ../secure_api/out/runtime_switch/extracted/TestLib.krml ../secure_api/out/runtime_switch/extracted/FStar_Bytes.krml ../secure_api/out/runtime_switch/extracted/Crypto_AEAD_Main.krml ../secure_api/out/runtime_switch/extracted/CryptoTypes.krml ../secure_api/out/runtime_switch/extracted/Crypto_HKDF.krml ../secure_api/out/runtime_switch/extracted/HaclProvider.krml ../secure_api/out/runtime_switch/extracted/KrmlTest.krml ../secure_api/out/runtime_switch/extracted/LowCProvider.krml -add-include '"kremlib.h"' -add-include '"kremlin/internal/compat.h"' \

Warning 6: in the definition of state, after the definition of pos_T, in the last element of the sequence, in top-level declaration Crypto.HKDF.hkdf_expand, in file Crypto_HKDF_Crypto_HMAC: stack newbuf 0uint8 (+,uint32) (+,uint32) @7 @3 @4 is a non-constant size, stack-allocated array; this is not supported by CompCert and requires the use of alloca(3) for MSVC
Warning 6: in the definition of state0, after the definition of h0, in the last element of the sequence, in top-level declaration Crypto.HMAC.hmac_part1, in file Crypto_HKDF_Crypto_HMAC: stack newbuf 0uint32 match @4 with | Œª .  SHA256 () ->  137uint32 | Œª .  SHA384 () ->  338uint32 | Œª .  SHA512 () ->  338uint32 is a non-constant size, stack-allocated array; this is not supported by CompCert and requires the use of alloca(3) for MSVC
Warning 6: in the definition of state1, after the definition of h0, in the last element of the sequence, after the definition of hinit, in top-level declaration Crypto.HMAC.hmac_part2, in file Crypto_HKDF_Crypto_HMAC: stack newbuf 0uint32 match @5 with | Œª .  SHA256 () ->  137uint32 | Œª .  SHA384 () ->  338uint32 | Œª .  SHA512 () ->  338uint32 is a non-constant size, stack-allocated array; this is not supported by CompCert and requires the use of alloca(3) for MSVC
Warning 6: in the definition of ipad, after the definition of h0, in the last element of the sequence, after the definition of h00, in top-level declaration Crypto.HMAC.hmac_core, in file Crypto_HKDF_Crypto_HMAC: stack newbuf 0x36uint8 Crypto.HMAC.block_size @6 is a non-constant size, stack-allocated array; this is not supported by CompCert and requires the use of alloca(3) for MSVC
Warning 6: in the definition of opad, after the definition of ipad, in the last element of the sequence, after the definition of h00, in top-level declaration Crypto.HMAC.hmac_core, in file Crypto_HKDF_Crypto_HMAC: stack newbuf 0x5cuint8 Crypto.HMAC.block_size @7 is a non-constant size, stack-allocated array; this is not supported by CompCert and requires the use of alloca(3) for MSVC
Warning 6: in the definition of nkey, in the last element of the sequence, in top-level declaration Crypto.HMAC.hmac, in file Crypto_HKDF_Crypto_HMAC: stack newbuf 0x00uint8 Crypto.HMAC.block_size @5 is a non-constant size, stack-allocated array; this is not supported by CompCert and requires the use of alloca(3) for MSVC
[38;5;119m‚úî[0m [Monomorphization] ‚è±Ô∏è 63ms
[38;5;119m‚úî[0m [Inlining] ‚è±Ô∏è 47ms
[38;5;119m‚úî[0m [Pattern matches compilation] ‚è±Ô∏è 31ms
[38;5;119m‚úî[0m [Simplify 2] ‚è±Ô∏è 47ms
[38;5;119m‚úî[0m [Structs + Simplify 2] ‚è±Ô∏è 78ms
[38;5;119m‚úî[0m [Drop] ‚è±Ô∏è <1ms
[38;5;119m‚úî[0m [AstToCStar] ‚è±Ô∏è 31ms
[38;5;119m‚úî[0m [CStarToC] ‚è±Ô∏è <1ms
[38;5;81m‚öô KreMLin auto-detecting tools.[0m Here's what we found:
[4mreadlink is:[0m readlink
[4mKreMLin called via:[0m C:\build\agent2\_work\6\s\kremlin\_build\src\Kremlin.native
[4mthe Kremlin executable is:[0m C:\build\agent2\_work\6\s\kremlin\_build\src\Kremlin.native
[4mKreMLin home is:[0m C:/build/agent2/_work/6/s/kremlin
[38;5;81m‚öô KreMLin will drive F*.[0m Here's what we found:
read FSTAR_HOME via the environment
[4mfstar converted to windows path:[0m C:/build/agent2/_work/6/s/FStar/bin/fstar.exe
[4mfstar home converted to windows path:[0m C:/build/agent2/_work/6/s/FStar
[4mfstar lib converted to windows path:[0m C:/build/agent2/_work/6/s/FStar/ulib
fstar is on [38;5;202mbranch protz_uint128[0m
[4mfstar is:[0m C:/build/agent2/_work/6/s/FStar/bin/fstar.exe C:/build/agent2/_work/6/s/kremlin/runtime/WasmSupport.fst C:/build/agent2/_work/6/s/FStar/ulib/FStar.UInt128.fst --trace_error --cache_checked_modules --expose_interfaces --include C:/build/agent2/_work/6/s/kremlin/include --include C:/build/agent2/_work/6/s/kremlin/kremlib
[38;5;119m‚úî[0m [PrettyPrinting] ‚è±Ô∏è <1ms
KreMLin: wrote out .c files for Crypto_HKDF_Crypto_HMAC
KreMLin: wrote out .h files for Crypto_HKDF_Crypto_HMAC
OCAMLPATH="C:/build/agent2/_work/6/s/FStar/bin" ocamlfind opt -package fstarlib,zarith -g -I C:/build/agent2/_work/6/s/FStar/ulib/ml -c LowCProvider/lowc_stub.c -I LowCProvider/ -I ../secure_api/out/runtime_switch -I C:/build/agent2/_work/6/s/kremlin/include -I C:/build/agent2/_work/6/s/MLCrypto \
-I ../../mitls-fstar/libs/ffi -ccopt "-o LowCProvider/lowc_stub.o" -I ../code/salsa-family/chacha-c -I ../code/poly1305/poly-c \
-I ../code/curve25519/x25519-c -I ../secure_api/out/runtime_switch/crypto -I ../code/api/aead-c \
-ccopt -Wall -ccopt -Wextra -ccopt -I -ccopt C:/build/agent2/_work/6/s/kremlin/include -ccopt -Wno-unused-variable -ccopt -Wno-unused-parameter -ccopt -Wno-unused-but-set-variable -ccopt -Wno-parentheses -ccopt -Werror -ccopt -Wno-unknown-warning-option
OCAMLPATH="C:/build/agent2/_work/6/s/FStar/bin" ocamlfind opt -package fstarlib,zarith -g -I C:/build/agent2/_work/6/s/FStar/ulib/ml -c ../secure_api/out/runtime_switch/crypto/Crypto_AEAD_Main_Crypto_Symmetric_Cipher_Crypto_Indexing.c -I ../secure_api/out/runtime_switch/crypto/ -I ../secure_api/out/runtime_switch -I C:/build/agent2/_work/6/s/kremlin/include -I C:/build/agent2/_work/6/s/MLCrypto \
-I ../../mitls-fstar/libs/ffi -ccopt "-o ../secure_api/out/runtime_switch/crypto/Crypto_AEAD_Main_Crypto_Symmetric_Cipher_Crypto_Indexing.o" -I ../code/salsa-family/chacha-c -I ../code/poly1305/poly-c \
-I ../code/curve25519/x25519-c -I ../secure_api/out/runtime_switch/crypto -I ../code/api/aead-c \
-ccopt -Wall -ccopt -Wextra -ccopt -I -ccopt C:/build/agent2/_work/6/s/kremlin/include -ccopt -Wno-unused-variable -ccopt -Wno-unused-parameter -ccopt -Wno-unused-but-set-variable -ccopt -Wno-parentheses -ccopt -Werror -ccopt -Wno-unknown-warning-option
OCAMLPATH="C:/build/agent2/_work/6/s/FStar/bin" ocamlfind opt -package fstarlib,zarith -g -I C:/build/agent2/_work/6/s/FStar/ulib/ml -c ../secure_api/out/runtime_switch/crypto/Crypto_HKDF_Crypto_HMAC.c -I ../secure_api/out/runtime_switch/crypto/ -I ../secure_api/out/runtime_switch -I C:/build/agent2/_work/6/s/kremlin/include -I C:/build/agent2/_work/6/s/MLCrypto \
-I ../../mitls-fstar/libs/ffi -ccopt "-o ../secure_api/out/runtime_switch/crypto/Crypto_HKDF_Crypto_HMAC.o" -I ../code/salsa-family/chacha-c -I ../code/poly1305/poly-c \
-I ../code/curve25519/x25519-c -I ../secure_api/out/runtime_switch/crypto -I ../code/api/aead-c \
-ccopt -Wall -ccopt -Wextra -ccopt -I -ccopt C:/build/agent2/_work/6/s/kremlin/include -ccopt -Wno-unused-variable -ccopt -Wno-unused-parameter -ccopt -Wno-unused-but-set-variable -ccopt -Wno-parentheses -ccopt -Werror -ccopt -Wno-unknown-warning-option
OCAMLPATH="C:/build/agent2/_work/6/s/FStar/bin" ocamlfind opt -package fstarlib,zarith -g -I C:/build/agent2/_work/6/s/FStar/ulib/ml -c ../secure_api/out/runtime_switch/crypto/Crypto_Symmetric_Bytes.c -I ../secure_api/out/runtime_switch/crypto/ -I ../secure_api/out/runtime_switch -I C:/build/agent2/_work/6/s/kremlin/include -I C:/build/agent2/_work/6/s/MLCrypto \
-I ../../mitls-fstar/libs/ffi -ccopt "-o ../secure_api/out/runtime_switch/crypto/Crypto_Symmetric_Bytes.o" -I ../code/salsa-family/chacha-c -I ../code/poly1305/poly-c \
-I ../code/curve25519/x25519-c -I ../secure_api/out/runtime_switch/crypto -I ../code/api/aead-c \
-ccopt -Wall -ccopt -Wextra -ccopt -I -ccopt C:/build/agent2/_work/6/s/kremlin/include -ccopt -Wno-unused-variable -ccopt -Wno-unused-parameter -ccopt -Wno-unused-but-set-variable -ccopt -Wno-parentheses -ccopt -Werror -ccopt -Wno-unknown-warning-option
OCAMLPATH="C:/build/agent2/_work/6/s/FStar/bin" ocamlfind mklib -g -I C:/build/agent2/_work/6/s/FStar/ulib/ml -I ../secure_api/out/runtime_switch/extracted vale/asm/sha256_main_i.o vale/asm/sha256-x86_64.o vale/asm/Vale_Hash_SHA2_256.o vale/asm/vale_aes_glue.o vale/asm/aes-x86_64.o LowCProvider/LowCProvider.cmx LowCProvider/HaclProvider.cmx LowCProvider/lowc_stub.o ../secure_api/out/runtime_switch/crypto/Crypto_AEAD_Main_Crypto_Symmetric_Cipher_Crypto_Indexing.o ../secure_api/out/runtime_switch/crypto/Crypto_HKDF_Crypto_HMAC.o ../code/salsa-family/chacha-c/Hacl_Chacha20.o ../code/poly1305/poly-c/AEAD_Poly1305_64.o ../code/api/policies-c/Hacl_Policies.o ../code/api/aead-c/Hacl_Chacha20Poly1305.o ../secure_api/out/runtime_switch/crypto/Crypto_Symmetric_Bytes.o ../code/curve25519/x25519-c/Hacl_Curve25519.o -o ../secure_api/out/runtime_switch/LowC
OCAMLPATH="C:/build/agent2/_work/6/s/FStar/bin" ocamlfind opt -package fstarlib,zarith -g -I C:/build/agent2/_work/6/s/FStar/ulib/ml -c LowCProvider/Tests.ml -I LowCProvider -I ../secure_api/out/runtime_switch -I ../secure_api/out/runtime_switch/extracted -I C:/build/agent2/_work/6/s/MLCrypto -o LowCProvider/Tests.cmx
OCAMLPATH="C:/build/agent2/_work/6/s/FStar/bin" ocamlfind opt -package fstarlib,zarith -g -I C:/build/agent2/_work/6/s/FStar/ulib/ml -I ../secure_api/out/runtime_switch/extracted -I LowCProvider \
-ccopt -L../secure_api/out/runtime_switch -cclib C:/build/agent2/_work/6/s/kremlin/kremlib/out/libkremlib.a -linkpkg C:/build/agent2/_work/6/s/MLCrypto/CryptoTypes.cmx ../secure_api/out/runtime_switch/LowC.cmxa LowCProvider/Tests.cmx -o ../secure_api/out/runtime_switch/LowCTests.exe
./../secure_api/out/runtime_switch/LowCTests.exe
Tests started
Test 1 OK

Test 2 OK

Test 3 OK

Test 4 OK

Test 5 OK

Test 6 OK

Output cipher:	ed3dc05f9d4877f5db78c69c3a8a3d8e8602646a0b2febe4fca07a426a9ace4163cb26eddbb5b0d5f56d7038512ac73d667397d129c3044e0eb8052e
Output tag:	e6f0c7f7b8920ba02a3942df2b8b2a04
cipher:		AES-128-GCM
key:		"feffe9928665731c6d6a8f9467308308"
iv:		"cafebabefacedbad"
aad:		"feedfacedeadbeeffeedfacedeadbeefabaddad2"
tag:		"3612d2e79e3b0785561be14aaca2fccb"
plaintext:	"d9313225f88406e5a55909c5aff5269a86a7a9531534f7da2e4c303d8a318a721c3c0c95956809532fcf0e2449a6b525b16aedf5aa0de657ba637b39"
ciphertext:	"61353b4c2806934a777ff51fa22a4755699b2a714fcdc6f83766e5f97b6c742373806900e49f24b22b097544d4896b424989b5e1ebac0f07c23f4598"

Test 7 failed, but this is expected because |IV| <> 12 bytes and we don't do IV expansion.
Please disregard.

Output cipher:	8076eba01a51d7702d398c6dc3adaaadfe061c23a7ffc3c4623ea2be7a08d982b8f331d21ac6b8db541df43510561a3fff90b942215b7fb6fbcea43d
Output tag:	1606863da7ad74443b3a89fd2489363d
cipher:		AES-128-GCM
key:		"feffe9928665731c6d6a8f9467308308"
iv:		"9313225df88406e555909c5aff5269aa6a7a9538534f7da1e4c303d2a318a728c3c0c95156809539fcf0e2429a6b525416aedbf5a0de6a57a637b39b"
aad:		"feedfacedeadbeeffeedfacedeadbeefabaddad2"
tag:		"619cc5aefffe0bfa462af43c1699d050"
plaintext:	"d9313225f88406e5a55909c5aff5269a86a7a9531534f7da2e4c303d8a318a721c3c0c95956809532fcf0e2449a6b525b16aedf5aa0de657ba637b39"
ciphertext:	"8ce24998625615b603a033aca13fb894be9112a5c3a211a8ba262a3cca7e2ca701e4a9a4fba43c90ccdcb281d48c7c6fd62875d2aca417034c34aee5"

Test 8 failed, but this is expected because |IV| <> 12 bytes and we don't do IV expansion.
Please disregard.

Test 9 OK

Test 10 OK

Test 11 OK

Test 12 OK

Output cipher:	677a374b4dd797f8ea0252a721fa83784f68c4877cf4e60f8c1f56972e9c20f789efb32096dd6336c6e5ef833b041251fdf04ce41fbcf2fea0d1e83c
Output tag:	91b8ee617f7c50dab5bc75abff3bc1c3
cipher:		AES-256-GCM
key:		"feffe9928665731c6d6a8f9467308308feffe9928665731c6d6a8f9467308308"
iv:		"cafebabefacedbad"
aad:		"feedfacedeadbeeffeedfacedeadbeefabaddad2"
tag:		"3a337dbf46a792c45e454913fe2ea8f2"
plaintext:	"d9313225f88406e5a55909c5aff5269a86a7a9531534f7da2e4c303d8a318a721c3c0c95956809532fcf0e2449a6b525b16aedf5aa0de657ba637b39"
ciphertext:	"c3762df1ca787d32ae47c13bf19844cbaf1ae14d0b976afac52ff7d79bba9de0feb582d33934a4f0954cc2363bc73f7862ac430e64abe499f47c9b1f"

Test 13 failed, but this is expected because |IV| <> 12 bytes and we don't do IV expansion.
Please disregard.

Output cipher:	cf3b9ab7a70a2ac55a7bcf74cda369c5b32e7870a937cb4d7679ef877de6403b7126c8ca2d6c620755e8ff330af0e7fa003585282b2d7a3d8f785bcc
Output tag:	881390e147e8fc6b2923305b6413a594
cipher:		AES-256-GCM
key:		"feffe9928665731c6d6a8f9467308308feffe9928665731c6d6a8f9467308308"
iv:		"9313225df88406e555909c5aff5269aa6a7a9538534f7da1e4c303d2a318a728c3c0c95156809539fcf0e2429a6b525416aedbf5a0de6a57a637b39b"
aad:		"feedfacedeadbeeffeedfacedeadbeefabaddad2"
tag:		"a44a8266ee1c8eb0c8b5d4cf5ae9f19a"
plaintext:	"d9313225f88406e5a55909c5aff5269a86a7a9531534f7da2e4c303d8a318a721c3c0c95956809532fcf0e2449a6b525b16aedf5aa0de657ba637b39"
ciphertext:	"5a8def2f0c9e53f1f75d7853659e2a20eeb2b22aafde6419a058ab4f6f746bf40fc0c3b780f244452da3ebf1c5d82cdea2418997200ef82e44ae7e3f"

Test 14 failed, but this is expected because |IV| <> 12 bytes and we don't do IV expansion.
Please disregard.

Test 15 OK

Test 16 OK

Test 17 OK

Test 18 OK

Output cipher:	eff01b40f151144abb70955cedcbe564afd7d338ce2c3eb2ac13b1228ef785edc5bf4b7501cdc522a855c4e5843a3a0af67e4c8285f641951d9dcb727fb5d53bffe8165999884aa1626b20328a233f189b48820f19d2cf1551f21d0ae749227f1d47344d687533456994f11584dfd15d4791ceedf45f3774821bcd340d4b18ec8ed70e7ce40859ec159363caab3eaa87261cbda3733c01bbd39f03f21d3c4f1b3af2cadd75c67fbe96929c20a13077991908a0d23adbcecd49ed2ed71dd8f659
Output tag:	1f200ef9ef5218a0a69331c8304f873d
cipher:		AES-128-GCM
key:		"00000000000000000000000000000000"
iv:		"ffffffff000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000"
aad:		""
tag:		"566f8ef683078bfdeeffa869d751a017"
plaintext:	"000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000"
ciphertext:	"56b3373ca9ef6e4a2b64fe1e9a17b61425f10d47a75a5fce13efc6bc784af24f4141bdd48cf7c770887afd573cca5418a9aeffcd7c5ceddfc6a78397b9a85b499da558257267caab2ad0b23ca476a53cb17fb41c4b8b475cb4f3f7165094c229c9e8c4dc0a2a5ff1903e501511221376a1cdb8364c5061a20cae74bc4acd76ceb0abc9fd3217ef9f8c90be402ddf6d8697f4f880dff15bfb7a6b28241ec8fe183c2d59e3f9dfff653c7126f0acb9e64211f42bae12af462b1070bef1ab5e3606"

Test 19 failed, but this is expected because |IV| <> 12 bytes and we don't do IV expansion.
Please disregard.

Output cipher:	eff01b40f151144abb70955cedcbe564afd7d338ce2c3eb2ac13b1228ef785edc5bf4b7501cdc522a855c4e5843a3a0af67e4c8285f641951d9dcb727fb5d53bffe8165999884aa1626b20328a233f189b48820f19d2cf1551f21d0ae749227f1d47344d687533456994f11584dfd15d4791ceedf45f3774821bcd340d4b18ec8ed70e7ce40859ec159363caab3eaa87261cbda3733c01bbd39f03f21d3c4f1b3af2cadd75c67fbe96929c20a13077991908a0d23adbcecd49ed2ed71dd8f65954f4ff316fe216dd9e29b1ea55824efb884af85d0e6743d586acfc3088f200284dcb744dcf6fe40745827d98067e32af9b279d8f8354d7e47b8bb6736de3b66479f0d1ee5cb7796d966955cc6dea4ae5e4205b07040a0d9ec6594c2c6d2350a4
Output tag:	99b156f6881899ee456476976e9f5414
cipher:		AES-128-GCM
key:		"00000000000000000000000000000000"
iv:		"ffffffff000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000"
aad:		""
tag:		"8b307f6b33286d0ab026a9ed3fe1e85f"
plaintext:	"000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000"
ciphertext:	"56b3373ca9ef6e4a2b64fe1e9a17b61425f10d47a75a5fce13efc6bc784af24f4141bdd48cf7c770887afd573cca5418a9aeffcd7c5ceddfc6a78397b9a85b499da558257267caab2ad0b23ca476a53cb17fb41c4b8b475cb4f3f7165094c229c9e8c4dc0a2a5ff1903e501511221376a1cdb8364c5061a20cae74bc4acd76ceb0abc9fd3217ef9f8c90be402ddf6d8697f4f880dff15bfb7a6b28241ec8fe183c2d59e3f9dfff653c7126f0acb9e64211f42bae12af462b1070bef1ab5e3606872ca10dee15b3249b1a1b958f23134c4bccb7d03200bce420a2f8eb66dcf3644d1423c1b5699003c13ecef4bf38a3b60eedc34033bac1902783dc6d89e2e774188a439c7ebcc0672dbda4ddcfb2794613b0be41315ef778708a70ee7d75165c"

Test 20 failed, but this is expected because |IV| <> 12 bytes and we don't do IV expansion.
Please disregard.

Test 21 OK

AEAD: 21/21 tests passed
OCAMLPATH="C:/build/agent2/_work/6/s/FStar/bin" ocamlfind opt -package fstarlib,zarith -g -I C:/build/agent2/_work/6/s/FStar/ulib/ml -c QuicProvider/test.c -I QuicProvider/ -I ../secure_api/out/runtime_switch -I C:/build/agent2/_work/6/s/kremlin/include -I C:/build/agent2/_work/6/s/MLCrypto \
-I ../../mitls-fstar/libs/ffi -ccopt "-o QuicProvider/test.o" -I ../code/salsa-family/chacha-c -I ../code/poly1305/poly-c \
-I ../code/curve25519/x25519-c -I ../secure_api/out/runtime_switch/crypto -I ../code/api/aead-c \
-ccopt -Wall -ccopt -Wextra -ccopt -I -ccopt C:/build/agent2/_work/6/s/kremlin/include -ccopt -Wno-unused-variable -ccopt -Wno-unused-parameter -ccopt -Wno-unused-but-set-variable -ccopt -Wno-parentheses -ccopt -Werror -ccopt -Wno-unknown-warning-option
OCAMLPATH="C:/build/agent2/_work/6/s/FStar/bin" ocamlfind opt -package fstarlib,zarith -g -I C:/build/agent2/_work/6/s/FStar/ulib/ml -c QuicProvider/quic_provider.c -I QuicProvider/ -I ../secure_api/out/runtime_switch -I C:/build/agent2/_work/6/s/kremlin/include -I C:/build/agent2/_work/6/s/MLCrypto \
-I ../../mitls-fstar/libs/ffi -ccopt "-o QuicProvider/quic_provider.o" -I ../code/salsa-family/chacha-c -I ../code/poly1305/poly-c \
-I ../code/curve25519/x25519-c -I ../secure_api/out/runtime_switch/crypto -I ../code/api/aead-c \
-ccopt -Wall -ccopt -Wextra -ccopt -I -ccopt C:/build/agent2/_work/6/s/kremlin/include -ccopt -Wno-unused-variable -ccopt -Wno-unused-parameter -ccopt -Wno-unused-but-set-variable -ccopt -Wno-parentheses -ccopt -Werror -ccopt -Wno-unknown-warning-option
x86_64-w64-mingw32-gcc vale/asm/sha256_main_i.o vale/asm/sha256-x86_64.o vale/asm/Vale_Hash_SHA2_256.o vale/asm/vale_aes_glue.o vale/asm/aes-x86_64.o QuicProvider/quic_provider.o ../secure_api/out/runtime_switch/crypto/Crypto_AEAD_Main_Crypto_Symmetric_Cipher_Crypto_Indexing.o ../secure_api/out/runtime_switch/crypto/Crypto_Symmetric_Bytes.o ../secure_api/out/runtime_switch/crypto/Crypto_HKDF_Crypto_HMAC.o ../code/salsa-family/chacha-c/Hacl_Chacha20.o ../code/poly1305/poly-c/AEAD_Poly1305_64.o ../code/api/policies-c/Hacl_Policies.o ../code/api/aead-c/Hacl_Chacha20Poly1305.o C:/build/agent2/_work/6/s/kremlin/kremlib/out/libkremlib.a -o ../secure_api/out/runtime_switch/libquicprovider.dll  -shared
x86_64-w64-mingw32-gcc QuicProvider/test.o -o ../secure_api/out/runtime_switch/quicprovider-test.exe -L../secure_api/out/runtime_switch -lquicprovider C:/build/agent2/_work/6/s/kremlin/kremlib/out/libkremlib.a
./../secure_api/out/runtime_switch/quicprovider-test.exe
==== coverage ====
SHA256('') =
e3b0c44298fc1c149afbf4c8996fb92427ae41e4649b934ca495991b7852b855

SHA384('') = 
38b060a751ac96384cd9327eb1b1e36a21fdb71114be07434c0cc7bf63f6e1da
274edebfe76f65fbd51ad2f14898b95b

SHA512('') = 
cf83e1357eefb8bdf1542850d66d8007d620e4050b5715dc83f4a921d36ce9ce
47d0d13c5d85f2b0ff8318d2877eec2f63b931bd47417a81a538327af927da3e
+ cd mitls-fstar/src/tls

HMAC-SHA256('Jefe', 'what do ya want for nothing?') = 
+ make -j 16 test
5bdcc146bf60754e6a042426089575c75a003f089d2739839dec58b964ec3843

HMAC-SHA384('Jefe', 'what do ya want for nothing?') = 
af45d2e376484031617f78d2b58a6b1b9c7ef464f5a01b47e42ec3736322445e
8e2240ca5e69e2c78b3239ecfab21649

HMAC-SHA512('Jefe', 'what do ya want for nothing?') = 
164b7a7bfcf819e2e395fbe73b56e0a387bd64222e831fd610270cd7ea250554
9758bf75c05a994a6d034f65f8f0e6fdcaeab1a34d4a6b4b636e070a38bce737

prk = HKDF-EXTRACT-SHA256('0x000102030405060708090a0b0c', '0x0b0b0b0b0b0b0b0b0b0b0b0b0b0b0b0b0b0b0b0b0b0b')
077709362c2e32df0ddc3f0dc47bba6390b6c73bb50f9c3122ec844ad7c2b3e5
077709362c2e32df0ddc3f0dc47bba6390b6c73bb50f9c3122ec844ad7c2b3e5

okm = HKDF-EXPAND-SHA256(prk, '0xf0f1f2f3f4f5f6f7f8f9', 42)
3cb25f25faacd57a90434f64d0362f2a2d2d0a90cf1a5a4c5db02d56ecc4c5bf
34007208d5b887185865

AES-128-GCM encrypt test:
5936f46d6c7eb7008dbbfb0d40b491fce5328aedcbc0c5272457d347363fd36d
f238bd17971e982f4449350d
PN encryption mask:
a52e332b
DECRYPT SUCCESS: 
7768617420646f2079612077616e7420666f72206e6f7468696e673f

CHACHA20-POLY1305 encrypt test:
a62fe99f3d6001a4f4214a986f04b1f42ea1e5dcea3236ecf35adb5d8cc57db2
df5e18b278c8c904fcddf440
PN encryption mask:
308ac6f5
DECRYPT SUCCESS: 
7768617420646f2079612077616e7420666f72206e6f7468696e673f
==== PASS:  coverage ====


==== test_crypto(TLS_hash_SHA256,TLS_aead_AES_128_GCM) ====
PASS
==== test_crypto(TLS_hash_SHA384,TLS_aead_AES_128_GCM) ====
PASS
==== test_crypto(TLS_hash_SHA512,TLS_aead_AES_128_GCM) ====
PASS
==== test_crypto(TLS_hash_SHA256,TLS_aead_AES_256_GCM) ====
PASS
==== test_crypto(TLS_hash_SHA384,TLS_aead_AES_256_GCM) ====
PASS
==== test_crypto(TLS_hash_SHA512,TLS_aead_AES_256_GCM) ====
PASS
==== test_crypto(TLS_hash_SHA256,TLS_aead_CHACHA20_POLY1305) ====
PASS
==== test_crypto(TLS_hash_SHA384,TLS_aead_CHACHA20_POLY1305) ====
PASS
==== test_crypto(TLS_hash_SHA512,TLS_aead_CHACHA20_POLY1305) ====
PASS
==== test_pn_encrypt() ====
PN encryption mask: fbb4b174
Decrypted PN: c0000000
==== test_handshake_secrets() ====
==== PASS: test_handshake_secrets ==== 
==== ALL TESTS PASS ====
make: Leaving directory '/cygdrive/c/build/agent2/_work/6/s/hacl-star/secure_api'
rm -f cache/OCaml/.depend cache/Kremlin/.depend cache/Model/.depend
make -f Makefile.Model test
make -f Makefile.Kremlin test
make -f Makefile.OCaml test
make -C ../../apps/quicMinusNet test -k
make[1]: Entering directory '/cygdrive/c/build/agent2/_work/6/s/mitls-fstar/apps/quicMinusNet'
x86_64-w64-mingw32-gcc.exe -fPIC -I../../src/tls/extract/Kremlin-Library/include \
quic.c:1:0: warning: -fPIC ignored for target (all code is position independent)
-I../../src/tls/extract/Kremlin-Library/stub -I../../src/pki \
#define __USE_MINGW_ANSI_STDIO 1
-I../../libs/ffi -I/cygdrive/c/build/agent2/_work/6/s/hacl-star/secure_api/QuicProvider \
quic.c \
^
-L/cygdrive/c/build/agent2/_work/6/s/hacl-star/providers/out -L../../src/pki -L../../src/tls/extract/Kremlin-Library -L/cygdrive/c/build/agent2/_work/6/s/hacl-star/secure_api/out/runtime_switch -L/cygdrive/c/build/agent2/_work/6/s/MLCrypto/openssl \
-lmitls -lquicprovider -lmipki -lbcrypt -o quic.exe
make[1]: Leaving directory '/cygdrive/c/build/agent2/_work/6/s/mitls-fstar/apps/quicMinusNet'
make[1]: Entering directory '/cygdrive/c/build/agent2/_work/6/s/mitls-fstar/apps/quicMinusNet'
./quic.exe
server create
FFI| offering custom extension 001a
FFI| extension contents: ffff00050a0b0c0d0e
FFI| setting early data limit to ffffffff
FFI| Setting a new ticket callback.
FFI| Setting a new server negotiation callback.
FFI| Setting up certificate callbacks.
client create
FFI| offering custom extension 001a
FFI| extension contents: ffff00050a0b0c0d0e
FFI| setting early data limit to ffffffff
FFI| Setting a new ticket callback.
FFI| Setting a new server negotiation callback.
FFI| Setting up certificate callbacks.
client call clen=8192 slen=   0
TLS| writeHandshake (plaintext)
TLS| HS.next_fragment PlaintextID?
HS | next_fragment
HS | offering ClientHello 1.3
KS | ks_client_init 1.3
CDH| Keygen (initiator) on X255519
NGO| No PSK or 0-RTT disabled
NGO| offering client extensions [ 001a supported_versions key_share server_name alpn extended_master_secret signature_algorithms supported_groups psk_key_exchange_modes ]
NGO| offering cipher suites ; TLS_CHACHA20_POLY1305_SHA256; TLS_AES_128_GCM_SHA256
HSL| emit ClientHello
TLS| HS.next_fragment returned a fragment
TLS| sendHandshake
TLS| send Handshake fragment with index PlaintextID
TLS| Sending fragment of length 170
REC| record headers: 16030300aa
TLS| writeHandshake (plaintext)
TLS| HS.next_fragment PlaintextID?
HS | next_fragment
TLS| HS.next_fragment returned nothing
TLS| sendHandshake
TLS| read: WrittenHS, Ctrl/Ctrl, nothing
REC| WouldBlock
TLS| readOne ReadWouldBlock
client done clen= 175 slen=   0 status=would_block
16030300aa010000a603035b22f5d30e2ccbe351e15abda1b56ed22772722149
54c426601dfaced69a84370000041303130101000079001a0009ffff00050a0b
0c0d0e002b0003027f1c003300260024001d0020f7cb235d798193bf26b8dcb6
00c76184bf22724d3604492f895a0f61c509e5600000000e000c0000096c6f63
616c686f73740010000800060568712d313000170000000d0006000408040403
000a00040002001d002d0003020001
server call clen= 175 slen=8192
TLS| writeHandshake (plaintext)
TLS| HS.next_fragment PlaintextID?
HS | next_fragment
TLS| HS.next_fragment returned nothing
TLS| sendHandshake
TLS| read: WrittenHS, Ctrl/Ctrl, nothing
TLS| Read fragment at epoch index: -1 of length 170
TLS| read Handshake fragment
HS | recv_fragment
HSL| parsed [ClientHello] -- end of flight 
HS | Processing ClientHello
NGO| offered client extensions [ 001a supported_versions key_share server_name alpn extended_master_secret signature_algorithms supported_groups psk_key_exchange_modes ]
NGO| offered cipher suites ; TLS_CHACHA20_POLY1305_SHA256; TLS_AES_128_GCM_SHA256
NGO| offered versions 1.3
NGO| Negotiated Pure EDH key exchange
NGO| Negotiated ECDSA_SECP256R1_SHA256
NGO| Negotiation callback to handle extra extensions and query for stateless retry.
NGO| Application data in cookie: none
@@@@ Nego callback for TLS 1.3 @@@@
Offered extensions:
003d001a0009ffff00050a0b0c0d0e0000000e000c0000096c6f63616c686f73
740010000800060568712d3130000d0006000408040403000a00040002001d
Transport parameters offered:
ffff00050a0b0c0d0e
No application cookie (fist connection).
Adding server transport parameters:
000102
@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
NGO| negotiated 1.3 TLS_CHACHA20_POLY1305_SHA256
KS | ks_server_init
KS | No PSK selected.
KS | Computed early secret:           33ad0a1c607ec03b09e6cd9893680ce210adf300aa1f2660e1b22e10f170f92a
KS | Handshake salt:                  6f2615a108c702c5678f54fc9dbab69716c076189c48250cebeac3576c3611ba
CDH| Keygen (responder) on X255519
CDH| DH initiator on X255519
KS | DH shared secret: ac43bdd4fdd252bb32f09c05948930200f6f41695bd190e33f01cabf5142411a
KS | Handshake secret:                71b5ef2724bff2b95b81469113afd216145a2f02a7ba1b49db4d8114efac4dd2
NGO| processing client extensions [ 001a supported_versions key_share server_name alpn extended_master_secret signature_algorithms supported_groups psk_key_exchange_modes ]
NGO| including server extensions (SH + EE) [ supported_versions key_share alpn supported_groups ]
NGO| extra extensions from application callback: 001a 
HSL| emit ServerHello and hash
HS | derive handshake keys
KS | ks_server_13_sh, hashed log = 59c8f5fc74e46339afda365e5a55040b75e75fa1ccef7c5cec7cffb2337001c9
KS | handshake traffic secret[C]:     f3da3b57d9df103cc819081e533325a27784eeb6e4fd702473829bb56f9d3bb1
KS | handshake traffic secret[S]:     5e1ba3b7401ea24a726ab43f1873c14f3bf29f0f52803ea8223890a65d653415
KS | handshake key[C]:                ae271c58939d5ba2bcf7acc03806280f35ac08a2b5a8b96446e336d0527aafd5, IV=4d0df922e082e16f39773a22
KS | handshake key[S]: 87595db7a4fb46de68375c4a14ed1ed4aca0454a5399b8164113baeee6546b50, IV=b76549bd9372681ecc6c507d
AEP| LowProvider: COERCE(K=87595db7a4fb46de68375c4a14ed1ed4aca0454a5399b8164113baeee6546b50)
AEP| LowProvider: COERCE(K=ae271c58939d5ba2bcf7acc03806280f35ac08a2b5a8b96446e336d0527aafd5)
KS | finished key[C]:                 5682d5bbede64853f7b80d83e2a6301b6511df01784522d70249442e5a3d79a2
KS | finished key[S]:                 0afde4f197535752f9d4127c337114fe4d3ec856110dc70b5d7ac39c89f4dbeb
KS | Application salt:                5bf8a24f296267bf65daf719016e96c725beee18a7b02841f35008365f2af92b
KS | Application secret:              210b42c445b7d1d817e3ceaa2a670d6242403da811d426660deba68caf0b57de
TLS| readOne ReadAgain
TLS| writeHandshake (plaintext)
TLS| HS.next_fragment PlaintextID?
HS | next_fragment
TLS| HS.next_fragment returned a fragment; next_keys (for handshake only
TLS| sendHandshake
TLS| send Handshake fragment with index PlaintextID
TLS| Sending fragment of length 90
REC| record headers: 160303005a
EPO| writer++ -1/0
TLS| writeHandshake (encrypted)
TLS| HS.next_fragment ID13?
HS | next_fragment
HS | prepare Server Finished
HSL| emit EncryptedExtensions
HSL| emit Certificate13 and hash
======== TO BE SIGNED <0403>: (130 octets) ========
2020202020202020202020202020202020202020202020202020202020202020
2020202020202020202020202020202020202020202020202020202020202020
544c5320312e332c207365727665722043657274696669636174655665726966
79009ef8a8d7cc16dc0edf09c416b0fe27ba5408ad7bc1e2cec44eff1e6a2183
b3e9
===================================================
HSL| emit CertificateVerify and hash
HSL| emit Finished and hash
KS | ks_server_13_sf hashed_log = e16da8ab7590762e01024d608f33f6fe13af1310b3114a37fdc1acfb299b1c5c
KS | application traffic secret[C]:   7f19e11ec7efe4cfe565245e78ffb885e9f4ddf15f6cf61f7e13bb20d6e462dd
KS | application traffic secret[S]:   d7544025f3c5d400301406112438e3911cf75101dc45bbe0703d04d86d477e07
KS | exporter master secret:          d7914ab46417fc5a665ebb9e2abc5af5c54e0445013fe5b0e0ebc79b12cbba1e
KS | application key[C]:              606e1d9fec2584343e1d71be7b6cbdb099eb1b4a37aee89042833d428e744e07, IV=f61cb7a9c0eb41be4ec6353f
KS | application key[S]:              8d5e5c22321e6c3ad80e326840541cba6584da4a8b44de53cb1b2b6befa5df0f, IV=6d0a0d5bf9144d3898e23548
AEP| LowProvider: COERCE(K=8d5e5c22321e6c3ad80e326840541cba6584da4a8b44de53cb1b2b6befa5df0f)
AEP| LowProvider: COERCE(K=606e1d9fec2584343e1d71be7b6cbdb099eb1b4a37aee89042833d428e744e07)
HS | exporting a key
EPO| reader++ 0/0
TLS| HS.next_fragment returned a fragment; next_keys (for all data)
TLS| sendHandshake
TLS| send Handshake fragment with index ID13
TLS| Encrypting with key 87595db7a4fb46de68375c4a14ed1ed4aca0454a5399b8164113baeee6546b50
TLS| Sending fragment of length 733
REC| record headers: 17030302dd
EPO| writer++ 0/1
TLS| read: WrittenHS, Ctrl/Open, new writer: writable
sender done clen= 175 slen= 833 status=server_accept
160303005a0200005603035b22f5d3480350864c1aafad6bb9ffb458dfd78373
5908b3c34d74f063af936900130300002e002b00027f1c00330024001d0020d0
35d4e7364b4ef95b70f701fb344c9bcb198714887af3969718f7942b3d636217
030302dd355580615487e29d4909bffa666553a9a36f596dca621e1be19b93a5
b8cdc26102e8f4303831583e0bdcb9196353f7a55e566fc5bcd8da2b0586de97
b9d238ac179694e0d601721cedef0ac13b969ce7ae9d2ffbc7845cb69a5ad828
bc18cf4707d6054ffca5523211e168a001c3fbb267946fe931bfd7964bbfc095
45836817aae4788aec2318eb5f7514bb38802a942d6a6d946b3405ccb83d2bde
f4bcb090758cf9f1927a24dd449d0d72f9093bbeca8989d983e05f187e00e51b
baac910e8d8b45f66a80244a2334ce7fc8ba706cc58355860a891557abb5f887
3e272dda1c19c8d597a1e9a35ca7b9d59dc47db817c3fd07164cc22039211fcb
d9166830e57f1bb0acaac49d0d752cb1a90c6f6c3db47f3a762e66349fdd5d47
74f53bc513855280910b1af69958bbd2b010f2b6000f8d3c7bbf2aa0113faaaf
e08d775edcab93309e8279ec76c2b81170d08ab5cab7df880c2241beb02fe5b8
8d9e852c6bd1eab0a6e5c71c6da7b21ca8a1b80a09e0ddd5c688a9b075bd3883
18cf2b6b93b041d047b231a3eaa093a649e70f71e2a46e2df0285f32de1b05d9
48511eb84215d65f971069b462017ec6c23a393f0af879b0f5c7eb179cb48f30
ab966fc5c798e7cd3cbc8709c4aa2e3e4192389b130b3dd9363d1662a14cee96
4721b490a58550981001307b56dbcd7bfdcef7029f53b49fad535421eb2c0da4
97b488ae015108f4229a8ee859de4be605870959493e261c59f893178c124bbc
eb5afabac54f0988f31498bc155d64d7cf7d5eb33a61128e0bc3fa3edcd25206
b5b0689e64d0a69c56a1dedf7d6902dbcf49bfa558f37d6b75447858aefd1eca
1be60f6c39b829559d837b4cad224ed0e3090c6d3cd2522ac186185ee6d4dd8a
40789842c6ff805123bfb5ae4d28dfdd85bc2e4874a05dbe83193992dc4852db
25afb0ec92486459e729efdd5ea0156d376ddaabca99bda7f34a6dd11ad2da45
cde07bc5a6a6620bbd60d572cb9e94e7377309ffdd7d52dd9dccf23af69d4d27
12
client call clen=8017 slen= 833
TLS| writeHandshake (plaintext)
TLS| HS.next_fragment PlaintextID?
HS | next_fragment
TLS| HS.next_fragment returned nothing
TLS| sendHandshake
TLS| read: WrittenHS, Ctrl/Ctrl, nothing
TLS| Read fragment at epoch index: -1 of length 90
TLS| read Handshake fragment
HS | recv_fragment
HSL| parsed ServerHello
HSL| end of flight
HS | client_ServerHello
NGO| processing server extensions [ supported_versions key_share ]
NGO| negotiated 1.3 TLS_CHACHA20_POLY1305_SHA256
HS | Running TLS 1.3
KS | ks_client_13_sh hashed_log = 59c8f5fc74e46339afda365e5a55040b75e75fa1ccef7c5cec7cffb2337001c9
KS | no PSK negotiated. Early secret: 33ad0a1c607ec03b09e6cd9893680ce210adf300aa1f2660e1b22e10f170f92a
KS | handshake salt:                  6f2615a108c702c5678f54fc9dbab69716c076189c48250cebeac3576c3611ba
CDH| DH initiator on X255519
KS | DH shared secret: ac43bdd4fdd252bb32f09c05948930200f6f41695bd190e33f01cabf5142411a
KS | handshake secret:                71b5ef2724bff2b95b81469113afd216145a2f02a7ba1b49db4d8114efac4dd2
KS | handshake traffic secret[C]:     f3da3b57d9df103cc819081e533325a27784eeb6e4fd702473829bb56f9d3bb1
KS | handshake traffic secret[S]:     5e1ba3b7401ea24a726ab43f1873c14f3bf29f0f52803ea8223890a65d653415
KS | handshake key[C]:                ae271c58939d5ba2bcf7acc03806280f35ac08a2b5a8b96446e336d0527aafd5, IV=4d0df922e082e16f39773a22
KS | handshake key[S]:                87595db7a4fb46de68375c4a14ed1ed4aca0454a5399b8164113baeee6546b50, IV=b76549bd9372681ecc6c507d
KS | finished key[C]: 5682d5bbede64853f7b80d83e2a6301b6511df01784522d70249442e5a3d79a2
KS | finished key[S]: 0afde4f197535752f9d4127c337114fe4d3ec856110dc70b5d7ac39c89f4dbeb
KS | application salt:                5bf8a24f296267bf65daf719016e96c725beee18a7b02841f35008365f2af92b
KS | application secret:              210b42c445b7d1d817e3ceaa2a670d6242403da811d426660deba68caf0b57de
AEP| LowProvider: COERCE(K=ae271c58939d5ba2bcf7acc03806280f35ac08a2b5a8b96446e336d0527aafd5)
AEP| LowProvider: COERCE(K=87595db7a4fb46de68375c4a14ed1ed4aca0454a5399b8164113baeee6546b50)
EPO| reader++ 0/-1
TLS| readOne ReadAgain
TLS| writeHandshake (plaintext)
TLS| HS.next_fragment PlaintextID?
HS | next_fragment
TLS| HS.next_fragment returned nothing
TLS| sendHandshake
TLS| read: WrittenHS, Ctrl/Ctrl, nothing
TLS| Read fragment at epoch index: 0 of length 733
TLS| StAE decrypt correct.
TLS| read Handshake fragment
HS | recv_fragment
HSL| parsed EncryptedExtensions
HSL| parsed Certificate13
HSL| parsed CertificateVerify
HSL| parsed Finished
HSL| end of flight
NGO| Nego.clientComplete_13
NGO| EE: alpn supported_groups 001a 
NGO| Negotiation callback to process application extensions.
@@@@ Nego callback for TLS 1.3 @@@@
Offered extensions:
001b0010000800060568712d3130000a00040002001d001a0003000102
Transport parameters offered:
000102
No application cookie (fist connection).
Adding server transport parameters:
000102
@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
WARNING: chain validation failed, ignoring.
NGO| Certificate & signature 1.3 callback result: valid
KS | ks_client_13_sf hashed_log = e16da8ab7590762e01024d608f33f6fe13af1310b3114a37fdc1acfb299b1c5c
KS | application traffic secret[C]:   7f19e11ec7efe4cfe565245e78ffb885e9f4ddf15f6cf61f7e13bb20d6e462dd
KS | application traffic secret[S]:   d7544025f3c5d400301406112438e3911cf75101dc45bbe0703d04d86d477e07
KS | exporter master secret:          d7914ab46417fc5a665ebb9e2abc5af5c54e0445013fe5b0e0ebc79b12cbba1e
KS | application key[C]:              606e1d9fec2584343e1d71be7b6cbdb099eb1b4a37aee89042833d428e744e07, IV=f61cb7a9c0eb41be4ec6353f
KS | application key[S]:              8d5e5c22321e6c3ad80e326840541cba6584da4a8b44de53cb1b2b6befa5df0f, IV=6d0a0d5bf9144d3898e23548
AEP| LowProvider: COERCE(K=606e1d9fec2584343e1d71be7b6cbdb099eb1b4a37aee89042833d428e744e07)
AEP| LowProvider: COERCE(K=8d5e5c22321e6c3ad80e326840541cba6584da4a8b44de53cb1b2b6befa5df0f)
HS | exporting a key
HS | Early data rejected
EPO| writer++ 0/0
HSL| emit Finished and hash
KS | ks_client_13_cf hashed_log = 6c278b999387d32974c9600cc8eb7c25e0cccb19878a4b81fe9ed72bb25f535f
KS | resumption master secret:        97e843004d0e502f89c7483aeaf65d247db81da4b165204e81e2dfd0df4fc27c
EPO| reader++ 1/0
TLS| readOne ReadAgain
TLS| writeHandshake (encrypted)
TLS| HS.next_fragment ID13?
HS | next_fragment
TLS| HS.next_fragment returned a fragment; next_keys (for all data); complete
TLS| sendHandshake
TLS| send Handshake fragment with index ID13
TLS| Encrypting with key ae271c58939d5ba2bcf7acc03806280f35ac08a2b5a8b96446e336d0527aafd5
TLS| Sending fragment of length 53
REC| record headers: 1703030035
EPO| writer++ 1/1
TLS| read: WrittenHS, Open/Open, new writer: complete
client done clen=  58 slen= 833 status=client_complete
1703030035449073ba850a84ac72a574344f54963a4669b17b2e7c54b26d65a7
488f2977858df30e8a20dd86e986617f14132a84e02c0c3991f1
server call clen=  58 slen=7359
TLS| writeHandshake (encrypted)
TLS| HS.next_fragment ID13?
HS | next_fragment
TLS| HS.next_fragment returned nothing
TLS| sendHandshake
TLS| read: WrittenHS, Ctrl/Open, nothing
TLS| Read fragment at epoch index: 0 of length 53
TLS| StAE decrypt correct.
TLS| read Handshake fragment
HS | recv_fragment
HSL| parsed Finished
HSL| end of flight
HS | Process Client Finished
KS | ks_server_13_cf hashed_log = 6c278b999387d32974c9600cc8eb7c25e0cccb19878a4b81fe9ed72bb25f535f
KS | resumption master secret:        97e843004d0e502f89c7483aeaf65d247db81da4b165204e81e2dfd0df4fc27c
AEP| LowProvider: COERCE(K=9f8d27fb6c9c9a74efd8c1709cb9689d9161c07853a3a07101d849f6f1a9aec6)
HS | Sending ticket: fecc29023315e8e6c9227222e0730d8789724a855b627c05dccc92db6edd8b576a377877abf59f43d9333011598bb675c0710006a67c1f86ac456df063ed7866394fb2346b01e58d92dca817
HSL| emit NewSessionTicket13
EPO| reader++ 1/1
TLS| readOne Complete
sender done clen=  58 slen=   0 status=server_complete
=== Exporter secret ===
d7914ab46417fc5a665ebb9e2abc5af5c54e0445013fe5b0e0ebc79b12cbba1e
=== QUIC 1-RTT secrets ===
C: 6f4cfcfdee0ff8232e833efe22a643827160d1152d41423bf4629cee0f6a357a
S: 160af587bb368ffcc668ace1dcb54b72389c86e00a13ff8e7be4e9f11bc4fa8f
=== AEAD client key test ===
b505bf90625ffb5602f1eb5187a454f011a3dea60dd023abbe01bf
=== Decrypt successful ===
Ok
./quic.exe 0rtt

INITIAL ECDHE HANDSHAKE (NO EARLY SECRET)

server create
FFI| offering custom extension 001a
FFI| extension contents: ffff00050a0b0c0d0e
FFI| setting early data limit to ffffffff
FFI| Setting a new ticket callback.
FFI| Setting a new server negotiation callback.
FFI| Setting up certificate callbacks.
client create
FFI| offering custom extension 001a
FFI| extension contents: ffff00050a0b0c0d0e
FFI| setting early data limit to ffffffff
FFI| Setting a new ticket callback.
FFI| Setting a new server negotiation callback.
FFI| Setting up certificate callbacks.
TLS| writeHandshake (plaintext)
TLS| HS.next_fragment PlaintextID?
HS | next_fragment
HS | offering ClientHello 1.3
KS | ks_client_init 1.3
CDH| Keygen (initiator) on X255519
NGO| No PSK or 0-RTT disabled
NGO| offering client extensions [ 001a supported_versions key_share server_name alpn extended_master_secret signature_algorithms supported_groups psk_key_exchange_modes ]
NGO| offering cipher suites ; TLS_CHACHA20_POLY1305_SHA256; TLS_AES_128_GCM_SHA256
HSL| emit ClientHello
TLS| HS.next_fragment returned a fragment
TLS| sendHandshake
TLS| send Handshake fragment with index PlaintextID
TLS| Sending fragment of length 170
REC| record headers: 16030300aa
TLS| writeHandshake (plaintext)
TLS| HS.next_fragment PlaintextID?
HS | next_fragment
TLS| HS.next_fragment returned nothing
TLS| sendHandshake
TLS| read: WrittenHS, Ctrl/Ctrl, nothing
REC| WouldBlock
TLS| readOne ReadWouldBlock
client returns would_block clen=175 slen=0
ClientHello[ 175] ---->

TLS| writeHandshake (plaintext)
TLS| HS.next_fragment PlaintextID?
HS | next_fragment
TLS| HS.next_fragment returned nothing
TLS| sendHandshake
TLS| read: WrittenHS, Ctrl/Ctrl, nothing
TLS| Read fragment at epoch index: -1 of length 170
TLS| read Handshake fragment
HS | recv_fragment
HSL| parsed [ClientHello] -- end of flight 
HS | Processing ClientHello
NGO| offered client extensions [ 001a supported_versions key_share server_name alpn extended_master_secret signature_algorithms supported_groups psk_key_exchange_modes ]
NGO| offered cipher suites ; TLS_CHACHA20_POLY1305_SHA256; TLS_AES_128_GCM_SHA256
NGO| offered versions 1.3
NGO| Negotiated Pure EDH key exchange
NGO| Negotiated ECDSA_SECP256R1_SHA256
NGO| Negotiation callback to handle extra extensions and query for stateless retry.
NGO| Application data in cookie: none
@@@@ Nego callback for TLS 1.3 @@@@
Offered extensions:
003d001a0009ffff00050a0b0c0d0e0000000e000c0000096c6f63616c686f73
740010000800060568712d3130000d0006000408040403000a00040002001d
Transport parameters offered:
ffff00050a0b0c0d0e
No application cookie (fist connection).
Adding server transport parameters:
000102
@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
NGO| negotiated 1.3 TLS_CHACHA20_POLY1305_SHA256
KS | ks_server_init
KS | No PSK selected.
KS | Computed early secret:           33ad0a1c607ec03b09e6cd9893680ce210adf300aa1f2660e1b22e10f170f92a
KS | Handshake salt:                  6f2615a108c702c5678f54fc9dbab69716c076189c48250cebeac3576c3611ba
CDH| Keygen (responder) on X255519
CDH| DH initiator on X255519
KS | DH shared secret: 1fd398dbadd547cd71c4d92fce821c36663974cc08b0e4414163ec18e1262e69
KS | Handshake secret:                84a740f908efcfb460ffaaf5f600ba91c6dcd938397376189aaa2a8b5f4686be
NGO| processing client extensions [ 001a supported_versions key_share server_name alpn extended_master_secret signature_algorithms supported_groups psk_key_exchange_modes ]
NGO| including server extensions (SH + EE) [ supported_versions key_share alpn supported_groups ]
NGO| extra extensions from application callback: 001a 
HSL| emit ServerHello and hash
HS | derive handshake keys
KS | ks_server_13_sh, hashed log = 263455962768fdc9e9e02b5bfddd1f55c1188b6c89f5abcd645369b562ee2e6d
KS | handshake traffic secret[C]:     4feac80c0cf569934c3450b8faf122c3a81a8eb27e5cdb12413bad4a89467801
KS | handshake traffic secret[S]:     a243c28ba2a29a35d12bc89d5c7454824371b2f429ed1aeeea6c62ff5b6fb725
KS | handshake key[C]:                cb6c86506974242f1df36d41375510ea1d6b4a7cfe3af05fab581f86b0522b6f, IV=ad4db07a25dd0bc4150745ab
KS | handshake key[S]: 67dfe95eb5d904524382a943e1f0e44c2ec6dbb0c070fe6d7021526d689aab36, IV=44ec2bbfc621aca202394983
AEP| LowProvider: COERCE(K=67dfe95eb5d904524382a943e1f0e44c2ec6dbb0c070fe6d7021526d689aab36)
AEP| LowProvider: COERCE(K=cb6c86506974242f1df36d41375510ea1d6b4a7cfe3af05fab581f86b0522b6f)
KS | finished key[C]:                 7f84f9a4938c590220e05d4ed1b7fb6057ea6d91be7e15010a9b40c05f8b3e73
KS | finished key[S]:                 e935c8ce7e5d29aeaca952cc9cba0c693c69ce89dcda895aac5c87fa78954e6f
KS | Application salt:                7bad1cf6943d805ba5b9655d53f6b9a22d8b95a5e51866fba64c5b52d413852e
KS | Application secret:              c955d04861119f033d5b6e4ab7266c32c206d65e0bf4b945355640de0f4f3443
TLS| readOne ReadAgain
TLS| writeHandshake (plaintext)
TLS| HS.next_fragment PlaintextID?
HS | next_fragment
TLS| HS.next_fragment returned a fragment; next_keys (for handshake only
TLS| sendHandshake
TLS| send Handshake fragment with index PlaintextID
TLS| Sending fragment of length 90
REC| record headers: 160303005a
EPO| writer++ -1/0
TLS| writeHandshake (encrypted)
TLS| HS.next_fragment ID13?
HS | next_fragment
HS | prepare Server Finished
HSL| emit EncryptedExtensions
HSL| emit Certificate13 and hash
======== TO BE SIGNED <0403>: (130 octets) ========
2020202020202020202020202020202020202020202020202020202020202020
2020202020202020202020202020202020202020202020202020202020202020
544c5320312e332c207365727665722043657274696669636174655665726966
7900e1a6ec08213544f04211262f91523326458f2d6ee3ffad8c89d0bc7fc22b
b5ed
===================================================
HSL| emit CertificateVerify and hash
HSL| emit Finished and hash
KS | ks_server_13_sf hashed_log = a7f9f5d102d7c992a98c91238e9c86b59e2e84a6eabef9d93f1ce8fcb867c6f4
KS | application traffic secret[C]:   4ba07f1bb70148b9c9c3f86a269f342cf16d0cc3597fd688d63c684ea9ea9d84
KS | application traffic secret[S]:   0c62345ef35a1d5fcda9e7c8125202a650427fea1e8441f775a39d214d689c94
KS | exporter master secret:          3a0c66b1b9de7b158a406d1fb8746569a06a8c6df10b9a790f1304a14b7ddbec
KS | application key[C]:              b20b66d87d36f04a2a0615dcf420c6c362ad35443dd247eac5cf5997c97005af, IV=1ccb98456481ab8414bd0a19
KS | application key[S]:              ef2603f7bf83dc680a663a3248fe003748b21b1287eeb12edbeecac48bebe3fa, IV=0b66406bbdefe97debd32376
AEP| LowProvider: COERCE(K=ef2603f7bf83dc680a663a3248fe003748b21b1287eeb12edbeecac48bebe3fa)
AEP| LowProvider: COERCE(K=b20b66d87d36f04a2a0615dcf420c6c362ad35443dd247eac5cf5997c97005af)
HS | exporting a key
EPO| reader++ 0/0
TLS| HS.next_fragment returned a fragment; next_keys (for all data)
TLS| sendHandshake
TLS| send Handshake fragment with index ID13
TLS| Encrypting with key 67dfe95eb5d904524382a943e1f0e44c2ec6dbb0c070fe6d7021526d689aab36
TLS| Sending fragment of length 735
REC| record headers: 17030302df
EPO| writer++ 0/1
TLS| read: WrittenHS, Ctrl/Open, new writer: writable
server returns server_accept clen=175 slen=835
secret=3a0c66b1b9de7b158a406d1fb8746569a06a8c6df10b9a790f1304a14b7ddbec
<---- ServerHello;(EncryptedExtensions; Certificate; CertVerify; Finished)[ 835]

TLS| writeHandshake (plaintext)
TLS| HS.next_fragment PlaintextID?
HS | next_fragment
TLS| HS.next_fragment returned nothing
TLS| sendHandshake
TLS| read: WrittenHS, Ctrl/Ctrl, nothing
TLS| Read fragment at epoch index: -1 of length 90
TLS| read Handshake fragment
HS | recv_fragment
HSL| parsed ServerHello
HSL| end of flight
HS | client_ServerHello
NGO| processing server extensions [ supported_versions key_share ]
NGO| negotiated 1.3 TLS_CHACHA20_POLY1305_SHA256
HS | Running TLS 1.3
KS | ks_client_13_sh hashed_log = 263455962768fdc9e9e02b5bfddd1f55c1188b6c89f5abcd645369b562ee2e6d
KS | no PSK negotiated. Early secret: 33ad0a1c607ec03b09e6cd9893680ce210adf300aa1f2660e1b22e10f170f92a
KS | handshake salt:                  6f2615a108c702c5678f54fc9dbab69716c076189c48250cebeac3576c3611ba
CDH| DH initiator on X255519
KS | DH shared secret: 1fd398dbadd547cd71c4d92fce821c36663974cc08b0e4414163ec18e1262e69
KS | handshake secret:                84a740f908efcfb460ffaaf5f600ba91c6dcd938397376189aaa2a8b5f4686be
KS | handshake traffic secret[C]:     4feac80c0cf569934c3450b8faf122c3a81a8eb27e5cdb12413bad4a89467801
KS | handshake traffic secret[S]:     a243c28ba2a29a35d12bc89d5c7454824371b2f429ed1aeeea6c62ff5b6fb725
KS | handshake key[C]:                cb6c86506974242f1df36d41375510ea1d6b4a7cfe3af05fab581f86b0522b6f, IV=ad4db07a25dd0bc4150745ab
KS | handshake key[S]:                67dfe95eb5d904524382a943e1f0e44c2ec6dbb0c070fe6d7021526d689aab36, IV=44ec2bbfc621aca202394983
KS | finished key[C]: 7f84f9a4938c590220e05d4ed1b7fb6057ea6d91be7e15010a9b40c05f8b3e73
KS | finished key[S]: e935c8ce7e5d29aeaca952cc9cba0c693c69ce89dcda895aac5c87fa78954e6f
KS | application salt:                7bad1cf6943d805ba5b9655d53f6b9a22d8b95a5e51866fba64c5b52d413852e
KS | application secret:              c955d04861119f033d5b6e4ab7266c32c206d65e0bf4b945355640de0f4f3443
AEP| LowProvider: COERCE(K=cb6c86506974242f1df36d41375510ea1d6b4a7cfe3af05fab581f86b0522b6f)
AEP| LowProvider: COERCE(K=67dfe95eb5d904524382a943e1f0e44c2ec6dbb0c070fe6d7021526d689aab36)
EPO| reader++ 0/-1
TLS| readOne ReadAgain
TLS| writeHandshake (plaintext)
TLS| HS.next_fragment PlaintextID?
HS | next_fragment
TLS| HS.next_fragment returned nothing
TLS| sendHandshake
TLS| read: WrittenHS, Ctrl/Ctrl, nothing
TLS| Read fragment at epoch index: 0 of length 735
TLS| StAE decrypt correct.
TLS| read Handshake fragment
HS | recv_fragment
HSL| parsed EncryptedExtensions
HSL| parsed Certificate13
HSL| parsed CertificateVerify
HSL| parsed Finished
HSL| end of flight
NGO| Nego.clientComplete_13
NGO| EE: alpn supported_groups 001a 
NGO| Negotiation callback to process application extensions.
@@@@ Nego callback for TLS 1.3 @@@@
Offered extensions:
001b0010000800060568712d3130000a00040002001d001a0003000102
Transport parameters offered:
000102
No application cookie (fist connection).
Adding server transport parameters:
000102
@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
WARNING: chain validation failed, ignoring.
NGO| Certificate & signature 1.3 callback result: valid
KS | ks_client_13_sf hashed_log = a7f9f5d102d7c992a98c91238e9c86b59e2e84a6eabef9d93f1ce8fcb867c6f4
KS | application traffic secret[C]:   4ba07f1bb70148b9c9c3f86a269f342cf16d0cc3597fd688d63c684ea9ea9d84
KS | application traffic secret[S]:   0c62345ef35a1d5fcda9e7c8125202a650427fea1e8441f775a39d214d689c94
KS | exporter master secret:          3a0c66b1b9de7b158a406d1fb8746569a06a8c6df10b9a790f1304a14b7ddbec
KS | application key[C]:              b20b66d87d36f04a2a0615dcf420c6c362ad35443dd247eac5cf5997c97005af, IV=1ccb98456481ab8414bd0a19
KS | application key[S]:              ef2603f7bf83dc680a663a3248fe003748b21b1287eeb12edbeecac48bebe3fa, IV=0b66406bbdefe97debd32376
AEP| LowProvider: COERCE(K=b20b66d87d36f04a2a0615dcf420c6c362ad35443dd247eac5cf5997c97005af)
AEP| LowProvider: COERCE(K=ef2603f7bf83dc680a663a3248fe003748b21b1287eeb12edbeecac48bebe3fa)
HS | exporting a key
HS | Early data rejected
EPO| writer++ 0/0
HSL| emit Finished and hash
KS | ks_client_13_cf hashed_log = 5f0aad5ee40cfa9753a48de022fad315ba5d4c17ff3de05c4bd87170646e19a2
KS | resumption master secret:        ced6ebbe158066d3eafd709faf1de032a6291cf7a6389305aad286a9f1063eba
EPO| reader++ 1/0
TLS| readOne ReadAgain
TLS| writeHandshake (encrypted)
TLS| HS.next_fragment ID13?
HS | next_fragment
TLS| HS.next_fragment returned a fragment; next_keys (for all data); complete
TLS| sendHandshake
TLS| send Handshake fragment with index ID13
TLS| Encrypting with key cb6c86506974242f1df36d41375510ea1d6b4a7cfe3af05fab581f86b0522b6f
TLS| Sending fragment of length 53
REC| record headers: 1703030035
EPO| writer++ 1/1
TLS| read: WrittenHS, Open/Open, new writer: complete
client returns client_complete clen=58 slen=835
secret=3a0c66b1b9de7b158a406d1fb8746569a06a8c6df10b9a790f1304a14b7ddbec
(Finished) [  58] ---->

TLS| writeHandshake (encrypted)
TLS| HS.next_fragment ID13?
HS | next_fragment
TLS| HS.next_fragment returned nothing
TLS| sendHandshake
TLS| read: WrittenHS, Ctrl/Open, nothing
TLS| Read fragment at epoch index: 0 of length 53
TLS| StAE decrypt correct.
TLS| read Handshake fragment
HS | recv_fragment
HSL| parsed Finished
HSL| end of flight
HS | Process Client Finished
KS | ks_server_13_cf hashed_log = 5f0aad5ee40cfa9753a48de022fad315ba5d4c17ff3de05c4bd87170646e19a2
KS | resumption master secret:        ced6ebbe158066d3eafd709faf1de032a6291cf7a6389305aad286a9f1063eba
AEP| LowProvider: COERCE(K=eaf36571f4ccc4403dc6a422bd70b84d0051729fdaf9e378041ad13ea5e4bcab)
HS | Sending ticket: 573cfc3292bc16e8d19c29818e2013f794c8dec18cd73d2fd2b7c8349b3424500225dbe6e8b9469b514ed889587d254271812c9695249a99ab7acc9f12a28b1a268677a14d2e4edad18f1e80
HSL| emit NewSessionTicket13
EPO| reader++ 1/1
TLS| readOne Complete
server returns server_complete clen=58 slen=0
TLS| writeHandshake (encrypted)
TLS| HS.next_fragment ID13?
HS | next_fragment
TLS| HS.next_fragment returned a fragment
TLS| sendHandshake
TLS| send Handshake fragment with index ID13
TLS| Encrypting with key ef2603f7bf83dc680a663a3248fe003748b21b1287eeb12edbeecac48bebe3fa
TLS| Sending fragment of length 130
REC| record headers: 1703030082
TLS| writeHandshake (encrypted)
TLS| HS.next_fragment ID13?
HS | next_fragment
TLS| HS.next_fragment returned nothing
TLS| sendHandshake
TLS| read: WrittenHS, Open/Open, nothing
REC| WouldBlock
TLS| readOne ReadWouldBlock
server returns would_block clen=0 slen=135
<---- {Ticket}[ 135]
TLS| writeHandshake (encrypted)
TLS| HS.next_fragment ID13?
HS | next_fragment
TLS| HS.next_fragment returned nothing
TLS| sendHandshake
TLS| read: WrittenHS, Open/Open, nothing
TLS| Read fragment at epoch index: 1 of length 130
TLS| StAE decrypt correct.
TLS| read Handshake fragment
HS | recv_fragment
HSL| parsed NewSessionTicket13
HSL| end of flight
HS | Received ticket: 573cfc3292bc16e8d19c29818e2013f794c8dec18cd73d2fd2b7c8349b3424500225dbe6e8b9469b514ed889587d254271812c9695249a99ab7acc9f12a28b1a268677a14d2e4edad18f1e80
KS | ks_client_13_rms
KS | Recall RMS: ced6ebbe158066d3eafd709faf1de032a6291cf7a6389305aad286a9f1063eba
AEP| LowProvider: COERCE(K=edc0a911b24bb6a4d960c7ab428f224b968492d7f2b0cf3b7e9da34ef8f8a291)

##### New session ticket received! #####
Host: localhost
Ticket:
573cfc3292bc16e8d19c29818e2013f794c8dec18cd73d2fd2b7c8349b342450
0225dbe6e8b9469b514ed889587d254271812c9695249a99ab7acc9f12a28b1a
268677a14d2e4edad18f1e80
########################################
TLS| readOne ReadAgain
TLS| writeHandshake (encrypted)
TLS| HS.next_fragment ID13?
HS | next_fragment
TLS| HS.next_fragment returned nothing
TLS| sendHandshake
TLS| read: WrittenHS, Open/Open, nothing
REC| WouldBlock
TLS| readOne ReadWouldBlock
client returns clen=0 slen=135 status=would_block

TICKET-BASED RESUMPTION

server create
FFI| offering custom extension 001a
FFI| extension contents: ffff00050a0b0c0d0e
FFI| setting early data limit to ffffffff
FFI| Setting a new ticket callback.
FFI| Setting a new server negotiation callback.
FFI| Setting up certificate callbacks.
client create
FFI| offering custom extension 001a
FFI| extension contents: ffff00050a0b0c0d0e
FFI| setting early data limit to ffffffff
FFI| Setting a new ticket callback.
FFI| Setting a new server negotiation callback.
FFI| Setting up certificate callbacks.
TCK| Decrypting ticket 81acd92cdac05d7dbd9fd9ddfa3ae3bd950305943a977614fb6c77fba5b80d24ffb7f644c5f714dd991b4535f0af9788a0c35503e5eb105d2c06a8dc006b0d5a5d8d0b593a393c543309a9a1
TCK| Parsing ticket 030413035b22f5d35bc7347f00000020257f7512534a466596baf5e1d68494e0fd1fc305811639a25e29c5475287af3a
TLS| writeHandshake (plaintext)
TLS| HS.next_fragment PlaintextID?
HS | next_fragment
HS | offering ClientHello 1.3
KS | ks_client_init 1.3
CDH| Keygen (initiator) on X255519
NGO| Offering a PSK compatible with 0-RTT
NGO| offering client extensions [ 001a supported_versions key_share server_name alpn extended_master_secret signature_algorithms supported_groups psk_key_exchange_modes early_data pre_shared_key ]
NGO| offering cipher suites ; TLS_CHACHA20_POLY1305_SHA256; TLS_AES_128_GCM_SHA256
HSL| emit ClientHello
KS | Loaded pre-shared key 573cfc3292bc16e8d19c29818e2013f794c8dec18cd73d2fd2b7c8349b3424500225dbe6e8b9469b514ed889587d254271812c9695249a99ab7acc9f12a28b1a268677a14d2e4edad18f1e80: 257f7512534a466596baf5e1d68494e0fd1fc305811639a25e29c5475287af3a
KS | Early secret: a6ece29f19f8662150a99dd749d770ab67f6301918f562efc2dcc742fe5a5893
KS | Binder key[res binder]: c87869f7685154fb4b04764892e5932af7834d03eb9ec3a568f79fa0e923317d
KS | Binder Finished key: 00a580e1e691496cd771d9c4949e4188b7b9b6dd25f3d75d24e06af4b01899b7
HSL| emit Binders
HS | setting up 0RTT
KS | ks_client_13_ch log=4a40510a19fa45c8a0e6850238b11a39d92c79e4592540480b7a67e8b7639210
KS | Client early traffic secret:     ae73a52b519b4aa81fee4d3c742bcaac81015aaf195697e6cfb1b29465c7dbaa
KS | Early exporter master secret:    7af0cb90606585ea637baeba2c3b86dc432a4e180e2e0f368368ef49137199f0
KS | Client 0-RTT key:                2f9840a7373ac311b0186f6248b4c018e931f0752cd054b168ee6fee6a68c0b8, IV=a0674efee9f5664e3e3ae75d
AEP| LowProvider: COERCE(K=2f9840a7373ac311b0186f6248b4c018e931f0752cd054b168ee6fee6a68c0b8)
HS | exporting a key
TLS| HS.next_fragment returned a fragment; next_keys (for all data)
TLS| sendHandshake
TLS| send Handshake fragment with index PlaintextID
TLS| Sending fragment of length 297
REC| record headers: 1603030129
EPO| writer++ -1/0
TLS| read: WrittenHS, Ctrl/Open, new writer: writable
client returns client_early_data clen=302 slen=0
early secret=7af0cb90606585ea637baeba2c3b86dc432a4e180e2e0f368368ef49137199f0
ClientHello[ 302] ---->

TLS| writeHandshake (plaintext)
TLS| HS.next_fragment PlaintextID?
HS | next_fragment
TLS| HS.next_fragment returned nothing
TLS| sendHandshake
TLS| read: WrittenHS, Ctrl/Ctrl, nothing
TLS| Read fragment at epoch index: -1 of length 297
TLS| read Handshake fragment
HS | recv_fragment
HSL| parsed [ClientHello; Binders] -- end of flight 
HS | Processing ClientHello with 1 binder(s)
NGO| offered client extensions [ 001a supported_versions key_share server_name alpn extended_master_secret signature_algorithms supported_groups psk_key_exchange_modes early_data pre_shared_key ]
NGO| offered cipher suites ; TLS_CHACHA20_POLY1305_SHA256; TLS_AES_128_GCM_SHA256
NGO| offered versions 1.3
TCK| Decrypting ticket 573cfc3292bc16e8d19c29818e2013f794c8dec18cd73d2fd2b7c8349b3424500225dbe6e8b9469b514ed889587d254271812c9695249a99ab7acc9f12a28b1a268677a14d2e4edad18f1e80
TCK| Parsing ticket 030413035b22f5d35bc7347f00000020ced6ebbe158066d3eafd709faf1de032a6291cf7a6389305aad286a9f1063eba
NGO| Negotiated PSK_EDH key exchange
NGO| Negotiation callback to handle extra extensions and query for stateless retry.
NGO| Application data in cookie: none
@@@@ Nego callback for TLS 1.3 @@@@
Offered extensions:
003d001a0009ffff00050a0b0c0d0e0000000e000c0000096c6f63616c686f73
740010000800060568712d3130000d0006000408040403000a00040002001d
Transport parameters offered:
ffff00050a0b0c0d0e
No application cookie (fist connection).
Adding server transport parameters:
000102
@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
NGO| negotiated 1.3 TLS_CHACHA20_POLY1305_SHA256
HS | accepted TLS 1.3 psk #0
KS | ks_server_init
KS | Using negotiated PSK identity: 573cfc3292bc16e8d19c29818e2013f794c8dec18cd73d2fd2b7c8349b3424500225dbe6e8b9469b514ed889587d254271812c9695249a99ab7acc9f12a28b1a268677a14d2e4edad18f1e80
TCK| Decrypting ticket 573cfc3292bc16e8d19c29818e2013f794c8dec18cd73d2fd2b7c8349b3424500225dbe6e8b9469b514ed889587d254271812c9695249a99ab7acc9f12a28b1a268677a14d2e4edad18f1e80
TCK| Parsing ticket 030413035b22f5d35bc7347f00000020ced6ebbe158066d3eafd709faf1de032a6291cf7a6389305aad286a9f1063eba
KS | Ticket RMS: ced6ebbe158066d3eafd709faf1de032a6291cf7a6389305aad286a9f1063eba
KS | Pre-shared key: 257f7512534a466596baf5e1d68494e0fd1fc305811639a25e29c5475287af3a
KS | binder key:                      c87869f7685154fb4b04764892e5932af7834d03eb9ec3a568f79fa0e923317d
KS | binder Finished key:             00a580e1e691496cd771d9c4949e4188b7b9b6dd25f3d75d24e06af4b01899b7
KS | Computed early secret:           a6ece29f19f8662150a99dd749d770ab67f6301918f562efc2dcc742fe5a5893
KS | Handshake salt:                  f3a9feff879a3e9b75cf40890f3f56dd5fb02e7be1e06f60bd4777bea4723e44
CDH| Keygen (responder) on X255519
CDH| DH initiator on X255519
KS | DH shared secret: 3879bf684fd97db2c6d59fbc9546e3cb30ccaa56854eab8f717c327be6f3762e
KS | Handshake secret:                d7f58f5e82a8e080c7d0962f4584b85b642b92d13a2531575395de8ed21a4aa5
NGO| processing client extensions [ 001a supported_versions key_share server_name alpn extended_master_secret signature_algorithms supported_groups psk_key_exchange_modes early_data pre_shared_key ]
NGO| including server extensions (SH + EE) [ supported_versions key_share alpn supported_groups early_data pre_shared_key ]
NGO| extra extensions from application callback: 001a 
HSL| emit ServerHello and hash
KS | ks_server_13_0rtt_key
KS | Client early traffic secret:     ae73a52b519b4aa81fee4d3c742bcaac81015aaf195697e6cfb1b29465c7dbaa
KS | Early exporter master secret:    7af0cb90606585ea637baeba2c3b86dc432a4e180e2e0f368368ef49137199f0
KS | Client 0-RTT key:                2f9840a7373ac311b0186f6248b4c018e931f0752cd054b168ee6fee6a68c0b8, IV=a0674efee9f5664e3e3ae75d
AEP| LowProvider: COERCE(K=2f9840a7373ac311b0186f6248b4c018e931f0752cd054b168ee6fee6a68c0b8)
HS | exporting a key
HS | derive handshake keys
KS | ks_server_13_sh, hashed log = 23674c18274997e633da2507bc9f996b70cf87ded2eb3b664c8aa7d64462d1bf
KS | handshake traffic secret[C]:     e88c3e0dd7a35a7740fd40371965739bd1f425764fa8dcc6637af0b3b1ea1fc4
KS | handshake traffic secret[S]:     eda436b3b4b661d0cc27b6ac477f2b90576310553500cecbd719f12aab774f7d
KS | handshake key[C]:                4e899b1ea1142b1a109a74422ca667e86bda0f466622968c96f807e7f1296462, IV=1fedda73240a72f06d277289
KS | handshake key[S]: c87241e090923068f015b142cb24bc0d71c4e00f790c50dd7fb594efd3730b2a, IV=06ccebdf443a8f64bad13c63
AEP| LowProvider: COERCE(K=c87241e090923068f015b142cb24bc0d71c4e00f790c50dd7fb594efd3730b2a)
AEP| LowProvider: COERCE(K=4e899b1ea1142b1a109a74422ca667e86bda0f466622968c96f807e7f1296462)
KS | finished key[C]:                 fd9a1faa9b79283b3df8c1b7dee5a8d82bf14c7c83dd0375d6c2b166218617d0
KS | finished key[S]:                 a1f04316120cb56b69018ed79b8a2b3bf6bdd8bdab8a886660ae9f7a6ff0bd55
KS | Application salt:                35e7a875a0b887a74e4f5e394f638595379beb8ead2dc27f79b7126e650dd530
KS | Application secret:              f79130414dfaef3e8cbe562b67e7f513ca341c4016f4cbe59d714d62b82790e0
TLS| readOne ReadAgain
TLS| writeHandshake (plaintext)
TLS| HS.next_fragment PlaintextID?
HS | next_fragment
TLS| HS.next_fragment returned a fragment; next_keys (for handshake only skipping 0RTT
TLS| sendHandshake
TLS| send Handshake fragment with index PlaintextID
TLS| Sending fragment of length 96
REC| record headers: 1603030060
EPO| writer++ -1/0
EPO| writer++ -1/1
TLS| writeHandshake (encrypted)
TLS| HS.next_fragment ID13?
HS | next_fragment
HS | prepare Server Finished
HSL| emit EncryptedExtensions and hash
HSL| emit Finished and hash
KS | ks_server_13_sf hashed_log = 9806ee7908ffd0c395e1571251a707467df6e2c51fcce2c894a744088f884908
KS | application traffic secret[C]:   cb225ecf324fd2ef5e087d554a88b1d357713441a995e77a9b171789520215b6
KS | application traffic secret[S]:   d9d50ec3b8d70e5eb7d40c42c0d0deaae7f2ae9c506f935c6b72973ec84ebaea
KS | exporter master secret:          a32bbbb459217749c118e234ad48c12abedcaf1590b86a5e99c3591d02b012cf
KS | application key[C]:              68744e9799ab6bbd7ace5754d7a9924d17047fdc4cb2f6fbecad9789aa63a416, IV=88b648bcde1ec529a4e0a845
KS | application key[S]:              c30cfb6c22cb007a26ac674e848e0be9659a7fe8737ef799eb8d8b15720b372f, IV=9d98ef76fa412e1be0702ca8
AEP| LowProvider: COERCE(K=c30cfb6c22cb007a26ac674e848e0be9659a7fe8737ef799eb8d8b15720b372f)
AEP| LowProvider: COERCE(K=68744e9799ab6bbd7ace5754d7a9924d17047fdc4cb2f6fbecad9789aa63a416)
HS | exporting a key
EPO| reader++ 0/1
TLS| HS.next_fragment returned a fragment; next_keys (for all data)
TLS| sendHandshake
TLS| send Handshake fragment with index ID13
TLS| Encrypting with key c87241e090923068f015b142cb24bc0d71c4e00f790c50dd7fb594efd3730b2a
TLS| Sending fragment of length 90
REC| record headers: 170303005a
EPO| writer++ 0/2
TLS| read: WrittenHS, Ctrl/Open, new writer: writable
server returns server_accept_early_data clen=302 slen=196
early secret=7af0cb90606585ea637baeba2c3b86dc432a4e180e2e0f368368ef49137199f0
secret=a32bbbb459217749c118e234ad48c12abedcaf1590b86a5e99c3591d02b012cf
<---- ServerHello;(EncryptedExtensions; Certificate; CertVerify; Finished)[ 196]

TLS| writeHandshake (encrypted)
TLS| HS.next_fragment ID13?
HS | next_fragment
TLS| HS.next_fragment returned nothing
TLS| sendHandshake
TLS| read: WrittenHS, Ctrl/Open, nothing
TLS| Read fragment at epoch index: -1 of length 96
TLS| read Handshake fragment
HS | recv_fragment
HSL| parsed ServerHello
HSL| end of flight
HS | client_ServerHello
NGO| processing server extensions [ supported_versions key_share pre_shared_key ]
NGO| negotiated 1.3 TLS_CHACHA20_POLY1305_SHA256
HS | Running TLS 1.3
KS | ks_client_13_sh hashed_log = 23674c18274997e633da2507bc9f996b70cf87ded2eb3b664c8aa7d64462d1bf
KS | recallPSK early secret:          a6ece29f19f8662150a99dd749d770ab67f6301918f562efc2dcc742fe5a5893
KS | handshake salt:                  f3a9feff879a3e9b75cf40890f3f56dd5fb02e7be1e06f60bd4777bea4723e44
CDH| DH initiator on X255519
KS | DH shared secret: 3879bf684fd97db2c6d59fbc9546e3cb30ccaa56854eab8f717c327be6f3762e
KS | handshake secret:                d7f58f5e82a8e080c7d0962f4584b85b642b92d13a2531575395de8ed21a4aa5
KS | handshake traffic secret[C]:     e88c3e0dd7a35a7740fd40371965739bd1f425764fa8dcc6637af0b3b1ea1fc4
KS | handshake traffic secret[S]:     eda436b3b4b661d0cc27b6ac477f2b90576310553500cecbd719f12aab774f7d
KS | handshake key[C]:                4e899b1ea1142b1a109a74422ca667e86bda0f466622968c96f807e7f1296462, IV=1fedda73240a72f06d277289
KS | handshake key[S]:                c87241e090923068f015b142cb24bc0d71c4e00f790c50dd7fb594efd3730b2a, IV=06ccebdf443a8f64bad13c63
KS | finished key[C]: fd9a1faa9b79283b3df8c1b7dee5a8d82bf14c7c83dd0375d6c2b166218617d0
KS | finished key[S]: a1f04316120cb56b69018ed79b8a2b3bf6bdd8bdab8a886660ae9f7a6ff0bd55
KS | application salt:                35e7a875a0b887a74e4f5e394f638595379beb8ead2dc27f79b7126e650dd530
KS | application secret:              f79130414dfaef3e8cbe562b67e7f513ca341c4016f4cbe59d714d62b82790e0
AEP| LowProvider: COERCE(K=4e899b1ea1142b1a109a74422ca667e86bda0f466622968c96f807e7f1296462)
AEP| LowProvider: COERCE(K=c87241e090923068f015b142cb24bc0d71c4e00f790c50dd7fb594efd3730b2a)
HS | 0RTT potentially accepted (wait for EE to confirm)
EPO| reader++ 0/0
EPO| reader++ 1/0
TLS| readOne ReadAgain
TLS| writeHandshake (encrypted)
TLS| HS.next_fragment ID13?
HS | next_fragment
TLS| HS.next_fragment returned nothing
TLS| sendHandshake
TLS| read: WrittenHS, Ctrl/Open, nothing
TLS| Read fragment at epoch index: 1 of length 90
TLS| StAE decrypt correct.
TLS| read Handshake fragment
HS | recv_fragment
HSL| parsed EncryptedExtensions
HSL| parsed Finished
HSL| end of flight
NGO| Nego.clientComplete_13
NGO| EE: alpn supported_groups early_data 001a 
NGO| Negotiation callback to process application extensions.
@@@@ Nego callback for TLS 1.3 @@@@
Offered extensions:
001b0010000800060568712d3130000a00040002001d001a0003000102
Transport parameters offered:
000102
No application cookie (fist connection).
Adding server transport parameters:
000102
@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
NGO| Certificate & signature 1.3 callback result: valid
KS | ks_client_13_sf hashed_log = 9806ee7908ffd0c395e1571251a707467df6e2c51fcce2c894a744088f884908
KS | application traffic secret[C]:   cb225ecf324fd2ef5e087d554a88b1d357713441a995e77a9b171789520215b6
KS | application traffic secret[S]:   d9d50ec3b8d70e5eb7d40c42c0d0deaae7f2ae9c506f935c6b72973ec84ebaea
KS | exporter master secret:          a32bbbb459217749c118e234ad48c12abedcaf1590b86a5e99c3591d02b012cf
KS | application key[C]:              68744e9799ab6bbd7ace5754d7a9924d17047fdc4cb2f6fbecad9789aa63a416, IV=88b648bcde1ec529a4e0a845
KS | application key[S]:              c30cfb6c22cb007a26ac674e848e0be9659a7fe8737ef799eb8d8b15720b372f, IV=9d98ef76fa412e1be0702ca8
AEP| LowProvider: COERCE(K=68744e9799ab6bbd7ace5754d7a9924d17047fdc4cb2f6fbecad9789aa63a416)
AEP| LowProvider: COERCE(K=c30cfb6c22cb007a26ac674e848e0be9659a7fe8737ef799eb8d8b15720b372f)
HS | exporting a key
HS | Early data accepted; emitting EOED.
HSL| emit EndOfEarlyData and hash
TLS| readOne ReadAgain
TLS| writeHandshake (encrypted)
TLS| HS.next_fragment ID13?
HS | next_fragment
TLS| HS.next_fragment returned a fragment; next_keys (for handshake only
TLS| sendHandshake
TLS| send Handshake fragment with index ID13
TLS| Encrypting with key 2f9840a7373ac311b0186f6248b4c018e931f0752cd054b168ee6fee6a68c0b8
TLS| Sending fragment of length 21
REC| record headers: 1703030015
EPO| writer++ 1/1
TLS| writeHandshake (encrypted)
TLS| HS.next_fragment ID13?
HS | next_fragment
HSL| emit Finished and hash
KS | ks_client_13_cf hashed_log = 750c1e3177d3f19f3c30425b7d81383c203a42ce4daa7a3b7715b33be9f467b2
KS | resumption master secret:        e00b8cf9b3b39dfbb392e62aaf4b69f80471956a4d3385ef037b89864dd45edb
EPO| reader++ 2/1
TLS| HS.next_fragment returned a fragment; next_keys (for all data); complete
TLS| sendHandshake
TLS| send Handshake fragment with index ID13
TLS| Encrypting with key 4e899b1ea1142b1a109a74422ca667e86bda0f466622968c96f807e7f1296462
TLS| Sending fragment of length 53
REC| record headers: 1703030035
EPO| writer++ 2/2
TLS| read: WrittenHS, Open/Open, new writer: complete
client returns client_complete_early_data clen=84 slen=196
secret=a32bbbb459217749c118e234ad48c12abedcaf1590b86a5e99c3591d02b012cf
(Finished) [  84] ---->

TLS| writeHandshake (encrypted)
TLS| HS.next_fragment ID13?
HS | next_fragment
TLS| HS.next_fragment returned nothing
TLS| sendHandshake
TLS| read: WrittenHS, Ctrl/Open, nothing
TLS| Read fragment at epoch index: 0 of length 21
TLS| StAE decrypt correct.
TLS| read Handshake fragment
HS | recv_fragment
HSL| parsed EndOfEarlyData
HSL| end of flight
HS | Process EOED (increment reader to HS key)
EPO| reader++ 1/2
TLS| readOne ReadAgain
TLS| writeHandshake (encrypted)
TLS| HS.next_fragment ID13?
HS | next_fragment
TLS| HS.next_fragment returned nothing
TLS| sendHandshake
TLS| read: WrittenHS, Ctrl/Open, nothing
TLS| Read fragment at epoch index: 1 of length 53
TLS| StAE decrypt correct.
TLS| read Handshake fragment
HS | recv_fragment
HSL| parsed Finished
HSL| end of flight
HS | Process Client Finished
KS | ks_server_13_cf hashed_log = 750c1e3177d3f19f3c30425b7d81383c203a42ce4daa7a3b7715b33be9f467b2
KS | resumption master secret:        e00b8cf9b3b39dfbb392e62aaf4b69f80471956a4d3385ef037b89864dd45edb
HS | Sending ticket: 3c8d0a8b5c56abac966dabb129ee470c31f90737e39e67ebf38a286660ebf1f769ab487ae360f528dccb78c06838db3e92e11332802496e24275846d9c761123ac36f4129e5fee0c8671f457
HSL| emit NewSessionTicket13
EPO| reader++ 2/2
TLS| readOne Complete
server returns clen=84 slen=0 status=server_complete
TLS| writeHandshake (encrypted)
TLS| HS.next_fragment ID13?
HS | next_fragment
TLS| HS.next_fragment returned a fragment
TLS| sendHandshake
TLS| send Handshake fragment with index ID13
TLS| Encrypting with key c30cfb6c22cb007a26ac674e848e0be9659a7fe8737ef799eb8d8b15720b372f
TLS| Sending fragment of length 130
REC| record headers: 1703030082
TLS| writeHandshake (encrypted)
TLS| HS.next_fragment ID13?
HS | next_fragment
TLS| HS.next_fragment returned nothing
TLS| sendHandshake
TLS| read: WrittenHS, Open/Open, nothing
REC| WouldBlock
TLS| readOne ReadWouldBlock
server returns would_block clen=0 slen=135
<---- {Ticket}[ 135]
TLS| writeHandshake (encrypted)
TLS| HS.next_fragment ID13?
HS | next_fragment
TLS| HS.next_fragment returned nothing
TLS| sendHandshake
TLS| read: WrittenHS, Open/Open, nothing
TLS| Read fragment at epoch index: 2 of length 130
TLS| StAE decrypt correct.
TLS| read Handshake fragment
HS | recv_fragment
HSL| parsed NewSessionTicket13
HSL| end of flight
HS | Received ticket: 3c8d0a8b5c56abac966dabb129ee470c31f90737e39e67ebf38a286660ebf1f769ab487ae360f528dccb78c06838db3e92e11332802496e24275846d9c761123ac36f4129e5fee0c8671f457
KS | ks_client_13_rms
KS | Recall RMS: e00b8cf9b3b39dfbb392e62aaf4b69f80471956a4d3385ef037b89864dd45edb

##### New session ticket received! #####
Host: localhost
Ticket:
3c8d0a8b5c56abac966dabb129ee470c31f90737e39e67ebf38a286660ebf1f7
69ab487ae360f528dccb78c06838db3e92e11332802496e24275846d9c761123
ac36f4129e5fee0c8671f457
########################################
TLS| readOne ReadAgain
TLS| writeHandshake (encrypted)
TLS| HS.next_fragment ID13?
HS | next_fragment
TLS| HS.next_fragment returned nothing
TLS| sendHandshake
TLS| read: WrittenHS, Open/Open, nothing
REC| WouldBlock
TLS| readOne ReadWouldBlock
client returns clen=0 slen=135 status=would_block
Ok
./quic.exe hrr

STATELESS RETRY TEST

server create
FFI| offering custom extension 001a
FFI| extension contents: ffff00050a0b0c0d0e
FFI| setting early data limit to ffffffff
FFI| Setting a new ticket callback.
FFI| Setting a new server negotiation callback.
FFI| Setting up certificate callbacks.
client create
FFI| offering custom extension 001a
FFI| extension contents: ffff00050a0b0c0d0e
FFI| setting early data limit to ffffffff
FFI| Setting a new ticket callback.
FFI| Setting a new server negotiation callback.
FFI| Setting up certificate callbacks.
TLS| writeHandshake (plaintext)
TLS| HS.next_fragment PlaintextID?
HS | next_fragment
HS | offering ClientHello 1.3
KS | ks_client_init 1.3
CDH| Keygen (initiator) on X255519
NGO| No PSK or 0-RTT disabled
NGO| offering client extensions [ 001a supported_versions key_share server_name alpn extended_master_secret signature_algorithms supported_groups psk_key_exchange_modes ]
NGO| offering cipher suites ; TLS_CHACHA20_POLY1305_SHA256; TLS_AES_128_GCM_SHA256
HSL| emit ClientHello
TLS| HS.next_fragment returned a fragment
TLS| sendHandshake
TLS| send Handshake fragment with index PlaintextID
TLS| Sending fragment of length 170
REC| record headers: 16030300aa
TLS| writeHandshake (plaintext)
TLS| HS.next_fragment PlaintextID?
HS | next_fragment
TLS| HS.next_fragment returned nothing
TLS| sendHandshake
TLS| read: WrittenHS, Ctrl/Ctrl, nothing
REC| WouldBlock
TLS| readOne ReadWouldBlock
client returns would_block clen=175 slen=0
ClientHello[ 175] ---->

~~~~~~~~~ Client Hello Summary ~~~~~~~~~~~
~ SNI = localhost
~ ALPN = 00060568712d3130
~ Cookie = NULL
~ Extensions = 0079001a0009ffff00050a0b0c0d0e002b0003027f1c003300260024001d0020
fa58900fe129058d1e96eff40136994f48876df72402a9484e030707292b9314
0000000e000c0000096c6f63616c686f73740010000800060568712d31300017
0000000d0006000408040403000a00040002001d002d0003020001
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
TLS| writeHandshake (plaintext)
TLS| HS.next_fragment PlaintextID?
HS | next_fragment
TLS| HS.next_fragment returned nothing
TLS| sendHandshake
TLS| read: WrittenHS, Ctrl/Ctrl, nothing
TLS| Read fragment at epoch index: -1 of length 170
TLS| read Handshake fragment
HS | recv_fragment
HSL| parsed [ClientHello] -- end of flight 
HS | Processing ClientHello
NGO| offered client extensions [ 001a supported_versions key_share server_name alpn extended_master_secret signature_algorithms supported_groups psk_key_exchange_modes ]
NGO| offered cipher suites ; TLS_CHACHA20_POLY1305_SHA256; TLS_AES_128_GCM_SHA256
NGO| offered versions 1.3
NGO| Negotiated Pure EDH key exchange
NGO| Negotiated ECDSA_SECP256R1_SHA256
NGO| Negotiation callback to handle extra extensions and query for stateless retry.
NGO| Application data in cookie: none
@@@@ Nego callback for TLS 1.3 @@@@
Offered extensions:
003d001a0009ffff00050a0b0c0d0e0000000e000c0000096c6f63616c686f73
740010000800060568712d3130000d0006000408040403000a00040002001d
Transport parameters offered:
ffff00050a0b0c0d0e
No application cookie (fist connection).
Adding server transport parameters:
000102
@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
AEP| LowProvider: COERCE(K=bce0cd19f64526f560a2cfbe6c0c1ff7fa4b0a3a1932a6aec85459d3acd91c35)
TCK| Encrypting cookie: 0000320200002e0303cf21ad74e59a6111be1d8c021e65b891c2a211167abb8c5e079e09e2c8a8339c001303000006002b00027f1c2043669994d58b1f54463bcb32313c86f04e1e4c5ecaa8aa6b1c918dbf8f445af8000b48656c6c6f20576f726c64
TCK| Encrypted cookie:  33ec565e37737b3643cca7ec622a4f4af9992890708f2047c241dc7ee606be098a80e12678cfa0ad41fbcd569c0e8dacb88eee46785c5dc81609f7d84f82c76d870a7e938c168ac8d5666bee77139e0f219cb6e82e18fb851875edbe418969135ff9ad15ed00baa1c25557175c54f375bc600725de9e4f9799a75272f0c7e6
HSL| emit HelloRetryRequest
TLS| readOne ReadAgain
TLS| writeHandshake (plaintext)
TLS| HS.next_fragment PlaintextID?
HS | next_fragment
TLS| HS.next_fragment returned a fragment
TLS| sendHandshake
TLS| send Handshake fragment with index PlaintextID
TLS| Sending fragment of length 183
REC| record headers: 16030300b7
TLS| writeHandshake (plaintext)
TLS| HS.next_fragment PlaintextID?
HS | next_fragment
TLS| HS.next_fragment returned nothing
TLS| sendHandshake
TLS| read: WrittenHS, Ctrl/Ctrl, nothing
REC| WouldBlock
TLS| readOne ReadWouldBlock
server returns server_stateless_retry clen=175 slen=188
<---- HRR[ 188]

server re-create
FFI| offering custom extension 001a
FFI| extension contents: ffff00050a0b0c0d0e
FFI| setting early data limit to ffffffff
FFI| Setting a new ticket callback.
FFI| Setting a new server negotiation callback.
FFI| Setting up certificate callbacks.
TLS| writeHandshake (plaintext)
TLS| HS.next_fragment PlaintextID?
HS | next_fragment
TLS| HS.next_fragment returned nothing
TLS| sendHandshake
TLS| read: WrittenHS, Ctrl/Ctrl, nothing
TLS| Read fragment at epoch index: -1 of length 183
TLS| read Handshake fragment
HS | recv_fragment
HSL| parsed HelloRetryRequest
HSL| end of flight
HSL| Replacing CH1 in transcript with fe00002043669994d58b1f54463bcb32313c86f04e1e4c5ecaa8aa6b1c918dbf8f445af8
HSL| HRR bytes: 020000b30303cf21ad74e59a6111be1d8c021e65b891c2a211167abb8c5e079e09e2c8a8339c00130300008b002c0081007f33ec565e37737b3643cca7ec622a4f4af9992890708f2047c241dc7ee606be098a80e12678cfa0ad41fbcd569c0e8dacb88eee46785c5dc81609f7d84f82c76d870a7e938c168ac8d5666bee77139e0f219cb6e82e18fb851875edbe418969135ff9ad15ed00baa1c25557175c54f375bc600725de9e4f9799a75272f0c7e6002b00027f1c
HS | client_HelloRetryRequest
HS | Server did not specify a group in HRR, re-using the previous choice
NGO| Got HRR, extensions: [cookie supported_versions ]
HSL| emit ClientHello
TLS| readOne ReadAgain
TLS| writeHandshake (plaintext)
TLS| HS.next_fragment PlaintextID?
HS | next_fragment
TLS| HS.next_fragment returned a fragment
TLS| sendHandshake
TLS| send Handshake fragment with index PlaintextID
TLS| Sending fragment of length 303
REC| record headers: 160303012f
TLS| writeHandshake (plaintext)
TLS| HS.next_fragment PlaintextID?
HS | next_fragment
TLS| HS.next_fragment returned nothing
TLS| sendHandshake
TLS| read: WrittenHS, Ctrl/Ctrl, nothing
REC| WouldBlock
TLS| readOne ReadWouldBlock
client returns would_block clen=308 slen=188
ClientHello2[ 308] ---->

TCK| Decrypting cookie 33ec565e37737b3643cca7ec622a4f4af9992890708f2047c241dc7ee606be098a80e12678cfa0ad41fbcd569c0e8dacb88eee46785c5dc81609f7d84f82c76d870a7e938c168ac8d5666bee77139e0f219cb6e82e18fb851875edbe418969135ff9ad15ed00baa1c25557175c54f375bc600725de9e4f9799a75272f0c7e6
TCK| Plain cookie: 0000320200002e0303cf21ad74e59a6111be1d8c021e65b891c2a211167abb8c5e079e09e2c8a8339c001303000006002b00027f1c2043669994d58b1f54463bcb32313c86f04e1e4c5ecaa8aa6b1c918dbf8f445af8000b48656c6c6f20576f726c64
~~~~~~~~~ Client Hello Summary ~~~~~~~~~~~
~ SNI = localhost
~ ALPN = 00060568712d3130
~ Cookie = 48656c6c6f20576f726c64
~ Extensions = 00fe002c0081007f33ec565e37737b3643cca7ec622a4f4af9992890708f2047
c241dc7ee606be098a80e12678cfa0ad41fbcd569c0e8dacb88eee46785c5dc8
1609f7d84f82c76d870a7e938c168ac8d5666bee77139e0f219cb6e82e18fb85
1875edbe418969135ff9ad15ed00baa1c25557175c54f375bc600725de9e4f97
99a75272f0c7e6001a0009ffff00050a0b0c0d0e002b0003027f1c0033002600
24001d0020fa58900fe129058d1e96eff40136994f48876df72402a9484e0307
07292b93140000000e000c0000096c6f63616c686f7374001000080006056871
2d313000170000000d0006000408040403000a00040002001d002d0003020001
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
TLS| writeHandshake (plaintext)
TLS| HS.next_fragment PlaintextID?
HS | next_fragment
TLS| HS.next_fragment returned nothing
TLS| sendHandshake
TLS| read: WrittenHS, Ctrl/Ctrl, nothing
TLS| Read fragment at epoch index: -1 of length 303
TLS| read Handshake fragment
HS | recv_fragment
HSL| parsed [ClientHello] -- end of flight 
HS | Processing ClientHello
NGO| offered client extensions [ cookie 001a supported_versions key_share server_name alpn extended_master_secret signature_algorithms supported_groups psk_key_exchange_modes ]
NGO| offered cipher suites ; TLS_CHACHA20_POLY1305_SHA256; TLS_AES_128_GCM_SHA256
NGO| offered versions 1.3
NGO| Negotiated Pure EDH key exchange
NGO| Negotiated ECDSA_SECP256R1_SHA256
TCK| Decrypting cookie 33ec565e37737b3643cca7ec622a4f4af9992890708f2047c241dc7ee606be098a80e12678cfa0ad41fbcd569c0e8dacb88eee46785c5dc81609f7d84f82c76d870a7e938c168ac8d5666bee77139e0f219cb6e82e18fb851875edbe418969135ff9ad15ed00baa1c25557175c54f375bc600725de9e4f9799a75272f0c7e6
TCK| Plain cookie: 0000320200002e0303cf21ad74e59a6111be1d8c021e65b891c2a211167abb8c5e079e09e2c8a8339c001303000006002b00027f1c2043669994d58b1f54463bcb32313c86f04e1e4c5ecaa8aa6b1c918dbf8f445af8000b48656c6c6f20576f726c64
NGO| Loaded stateless retry cookie 33ec565e37737b3643cca7ec622a4f4af9992890708f2047c241dc7ee606be098a80e12678cfa0ad41fbcd569c0e8dacb88eee46785c5dc81609f7d84f82c76d870a7e938c168ac8d5666bee77139e0f219cb6e82e18fb851875edbe418969135ff9ad15ed00baa1c25557175c54f375bc600725de9e4f9799a75272f0c7e6
NGO| Overwriting the transcript digest with CH1 hash 43669994d58b1f54463bcb32313c86f04e1e4c5ecaa8aa6b1c918dbf8f445af8
HSL| Installing prefix to transcript: fe00002043669994d58b1f54463bcb32313c86f04e1e4c5ecaa8aa6b1c918dbf8f445af8
HSL| HRR bytes: 020000b30303cf21ad74e59a6111be1d8c021e65b891c2a211167abb8c5e079e09e2c8a8339c00130300008b002c0081007f33ec565e37737b3643cca7ec622a4f4af9992890708f2047c241dc7ee606be098a80e12678cfa0ad41fbcd569c0e8dacb88eee46785c5dc81609f7d84f82c76d870a7e938c168ac8d5666bee77139e0f219cb6e82e18fb851875edbe418969135ff9ad15ed00baa1c25557175c54f375bc600725de9e4f9799a75272f0c7e6002b00027f1c
NGO| Negotiation callback to handle extra extensions and query for stateless retry.
NGO| Application data in cookie: 48656c6c6f20576f726c64
@@@@ Nego callback for TLS 1.3 @@@@
Offered extensions:
003d001a0009ffff00050a0b0c0d0e0000000e000c0000096c6f63616c686f73
740010000800060568712d3130000d0006000408040403000a00040002001d
Transport parameters offered:
ffff00050a0b0c0d0e
Stateless cookie found, application contents:
48656c6c6f20576f726c64
Adding server transport parameters:
000102
@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
NGO| negotiated 1.3 TLS_CHACHA20_POLY1305_SHA256
KS | ks_server_init
KS | No PSK selected.
KS | Computed early secret:           33ad0a1c607ec03b09e6cd9893680ce210adf300aa1f2660e1b22e10f170f92a
KS | Handshake salt:                  6f2615a108c702c5678f54fc9dbab69716c076189c48250cebeac3576c3611ba
CDH| Keygen (responder) on X255519
CDH| DH initiator on X255519
KS | DH shared secret: 99ef72bb32aaeff2d52a4ec39ec22724e1b0c28e36688c9f37a172351453d252
KS | Handshake secret:                aa36b34f73cfb1ebb00ed012a396664e81e9162984e057e19f597e0ca2e03aff
NGO| processing client extensions [ cookie 001a supported_versions key_share server_name alpn extended_master_secret signature_algorithms supported_groups psk_key_exchange_modes ]
NGO| including server extensions (SH + EE) [ supported_versions key_share alpn supported_groups ]
NGO| extra extensions from application callback: 001a 
HSL| emit ServerHello and hash
HS | derive handshake keys
KS | ks_server_13_sh, hashed log = e3444ec34d36292b2391a1927b9e185b041ec8ba3e3d57a86ea6e46e94cedc99
KS | handshake traffic secret[C]:     eef5dc5109a28e5d078a204514a6b6d34ee2279c887a5813b2f0f0817841de9b
KS | handshake traffic secret[S]:     54bf7b9237d0ad9b93e34b7a788497f273cfec8ffb4a6d495fe7082a4a5a1260
KS | handshake key[C]:                f5be4de207188495bd96f9a5b3e9fbc402a11712e5c52dfdc6e556d32b87d4ab, IV=ff55c4a8643a037be0e4908f
KS | handshake key[S]: 05de5b2f26f5c1d057f9b705ebb8317f6cf33c12e399f636af37ac2880935849, IV=90f1cfe88958700ba13453c5
AEP| LowProvider: COERCE(K=05de5b2f26f5c1d057f9b705ebb8317f6cf33c12e399f636af37ac2880935849)
AEP| LowProvider: COERCE(K=f5be4de207188495bd96f9a5b3e9fbc402a11712e5c52dfdc6e556d32b87d4ab)
KS | finished key[C]:                 8c62b14d05c41c7bae6d988dd5d82c660d282c78fcf92b34623ca17f060fb910
KS | finished key[S]:                 631186f0ef8216bab44a5166c917b8f5ec95fa7959d7d7ac701ba48227ce2cc1
KS | Application salt:                6cb8335ccc72159501571cbb8d51eb39f0896375b08d5a8d6dbf25ab8b4635ea
KS | Application secret:              e82a8c8349af2c73120af5692437fbb2ed49c565b2ac3104d73e51286f45a863
TLS| readOne ReadAgain
TLS| writeHandshake (plaintext)
TLS| HS.next_fragment PlaintextID?
HS | next_fragment
TLS| HS.next_fragment returned a fragment; next_keys (for handshake only
TLS| sendHandshake
TLS| send Handshake fragment with index PlaintextID
TLS| Sending fragment of length 90
REC| record headers: 160303005a
EPO| writer++ -1/0
TLS| writeHandshake (encrypted)
TLS| HS.next_fragment ID13?
HS | next_fragment
HS | prepare Server Finished
HSL| emit EncryptedExtensions
HSL| emit Certificate13 and hash
======== TO BE SIGNED <0403>: (130 octets) ========
2020202020202020202020202020202020202020202020202020202020202020
2020202020202020202020202020202020202020202020202020202020202020
544c5320312e332c207365727665722043657274696669636174655665726966
7900387d96893f414b09c4da4175620e935b22905fd7080e0e4c37d6c3dbc0a6
09b8
===================================================
HSL| emit CertificateVerify and hash
HSL| emit Finished and hash
KS | ks_server_13_sf hashed_log = 75046b7a83f356eaa293ee74cc7954e5347d5f60a7fac0bf71371ec2680bc826
KS | application traffic secret[C]:   734f8b01a9ea4165b9f4962763187983fc372a02962509e065511a4b5d69d637
KS | application traffic secret[S]:   2f66a67f975391ab103960de10101fa7c63df136a215cde99325dd3374ef0fe9
KS | exporter master secret:          b2ac99bea59ba69f114c9e30379e6238d79161cfcc612498fd20e104aacca149
KS | application key[C]:              f70899658dbae7a593954c9d6c742be1c60388005ab0cc33b1ce76e09739be56, IV=38a5a4d9a464c51350af1d79
KS | application key[S]:              32e26c679c694cedf9ba68034b2c6de76351dbf16c6fbbe2b2eb767c0750d86e, IV=92bb7685cdf72b51bb0fa49a
AEP| LowProvider: COERCE(K=32e26c679c694cedf9ba68034b2c6de76351dbf16c6fbbe2b2eb767c0750d86e)
AEP| LowProvider: COERCE(K=f70899658dbae7a593954c9d6c742be1c60388005ab0cc33b1ce76e09739be56)
HS | exporting a key
EPO| reader++ 0/0
TLS| HS.next_fragment returned a fragment; next_keys (for all data)
TLS| sendHandshake
TLS| send Handshake fragment with index ID13
TLS| Encrypting with key 05de5b2f26f5c1d057f9b705ebb8317f6cf33c12e399f636af37ac2880935849
TLS| Sending fragment of length 734
REC| record headers: 17030302de
EPO| writer++ 0/1
TLS| read: WrittenHS, Ctrl/Open, new writer: writable
server returns server_accept clen=308 slen=834
secret=b2ac99bea59ba69f114c9e30379e6238d79161cfcc612498fd20e104aacca149
<---- ServerHello;(EncryptedExtensions; Certificate; CertVerify; Finished)[ 834]

TLS| writeHandshake (plaintext)
TLS| HS.next_fragment PlaintextID?
HS | next_fragment
TLS| HS.next_fragment returned nothing
TLS| sendHandshake
TLS| read: WrittenHS, Ctrl/Ctrl, nothing
TLS| Read fragment at epoch index: -1 of length 90
TLS| read Handshake fragment
HS | recv_fragment
HSL| parsed ServerHello
HSL| end of flight
HS | client_ServerHello
NGO| processing server extensions [ supported_versions key_share ]
NGO| negotiated 1.3 TLS_CHACHA20_POLY1305_SHA256
HS | Running TLS 1.3
KS | ks_client_13_sh hashed_log = e3444ec34d36292b2391a1927b9e185b041ec8ba3e3d57a86ea6e46e94cedc99
KS | no PSK negotiated. Early secret: 33ad0a1c607ec03b09e6cd9893680ce210adf300aa1f2660e1b22e10f170f92a
KS | handshake salt:                  6f2615a108c702c5678f54fc9dbab69716c076189c48250cebeac3576c3611ba
CDH| DH initiator on X255519
KS | DH shared secret: 99ef72bb32aaeff2d52a4ec39ec22724e1b0c28e36688c9f37a172351453d252
KS | handshake secret:                aa36b34f73cfb1ebb00ed012a396664e81e9162984e057e19f597e0ca2e03aff
KS | handshake traffic secret[C]:     eef5dc5109a28e5d078a204514a6b6d34ee2279c887a5813b2f0f0817841de9b
KS | handshake traffic secret[S]:     54bf7b9237d0ad9b93e34b7a788497f273cfec8ffb4a6d495fe7082a4a5a1260
KS | handshake key[C]:                f5be4de207188495bd96f9a5b3e9fbc402a11712e5c52dfdc6e556d32b87d4ab, IV=ff55c4a8643a037be0e4908f
KS | handshake key[S]:                05de5b2f26f5c1d057f9b705ebb8317f6cf33c12e399f636af37ac2880935849, IV=90f1cfe88958700ba13453c5
KS | finished key[C]: 8c62b14d05c41c7bae6d988dd5d82c660d282c78fcf92b34623ca17f060fb910
KS | finished key[S]: 631186f0ef8216bab44a5166c917b8f5ec95fa7959d7d7ac701ba48227ce2cc1
KS | application salt:                6cb8335ccc72159501571cbb8d51eb39f0896375b08d5a8d6dbf25ab8b4635ea
KS | application secret:              e82a8c8349af2c73120af5692437fbb2ed49c565b2ac3104d73e51286f45a863
AEP| LowProvider: COERCE(K=f5be4de207188495bd96f9a5b3e9fbc402a11712e5c52dfdc6e556d32b87d4ab)
AEP| LowProvider: COERCE(K=05de5b2f26f5c1d057f9b705ebb8317f6cf33c12e399f636af37ac2880935849)
EPO| reader++ 0/-1
TLS| readOne ReadAgain
TLS| writeHandshake (plaintext)
TLS| HS.next_fragment PlaintextID?
HS | next_fragment
TLS| HS.next_fragment returned nothing
TLS| sendHandshake
TLS| read: WrittenHS, Ctrl/Ctrl, nothing
TLS| Read fragment at epoch index: 0 of length 734
TLS| StAE decrypt correct.
TLS| read Handshake fragment
HS | recv_fragment
HSL| parsed EncryptedExtensions
HSL| parsed Certificate13
HSL| parsed CertificateVerify
HSL| parsed Finished
HSL| end of flight
NGO| Nego.clientComplete_13
NGO| EE: alpn supported_groups 001a 
NGO| Negotiation callback to process application extensions.
@@@@ Nego callback for TLS 1.3 @@@@
Offered extensions:
001b0010000800060568712d3130000a00040002001d001a0003000102
Transport parameters offered:
000102
No application cookie (fist connection).
Adding server transport parameters:
000102
@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
WARNING: chain validation failed, ignoring.
NGO| Certificate & signature 1.3 callback result: valid
KS | ks_client_13_sf hashed_log = 75046b7a83f356eaa293ee74cc7954e5347d5f60a7fac0bf71371ec2680bc826
KS | application traffic secret[C]:   734f8b01a9ea4165b9f4962763187983fc372a02962509e065511a4b5d69d637
KS | application traffic secret[S]:   2f66a67f975391ab103960de10101fa7c63df136a215cde99325dd3374ef0fe9
KS | exporter master secret:          b2ac99bea59ba69f114c9e30379e6238d79161cfcc612498fd20e104aacca149
KS | application key[C]:              f70899658dbae7a593954c9d6c742be1c60388005ab0cc33b1ce76e09739be56, IV=38a5a4d9a464c51350af1d79
KS | application key[S]:              32e26c679c694cedf9ba68034b2c6de76351dbf16c6fbbe2b2eb767c0750d86e, IV=92bb7685cdf72b51bb0fa49a
AEP| LowProvider: COERCE(K=f70899658dbae7a593954c9d6c742be1c60388005ab0cc33b1ce76e09739be56)
AEP| LowProvider: COERCE(K=32e26c679c694cedf9ba68034b2c6de76351dbf16c6fbbe2b2eb767c0750d86e)
HS | exporting a key
HS | Early data rejected
EPO| writer++ 0/0
HSL| emit Finished and hash
KS | ks_client_13_cf hashed_log = 9c9589ad5e32e7319006328e83f3994adcef2bec1eea57f3193377dc2554d970
KS | resumption master secret:        dacc5445dd592dc9a87124b7c2a4b17884393fd8ea657e5e587d2e37e20506d2
EPO| reader++ 1/0
TLS| readOne ReadAgain
TLS| writeHandshake (encrypted)
TLS| HS.next_fragment ID13?
HS | next_fragment
TLS| HS.next_fragment returned a fragment; next_keys (for all data); complete
TLS| sendHandshake
TLS| send Handshake fragment with index ID13
TLS| Encrypting with key f5be4de207188495bd96f9a5b3e9fbc402a11712e5c52dfdc6e556d32b87d4ab
TLS| Sending fragment of length 53
REC| record headers: 1703030035
EPO| writer++ 1/1
TLS| read: WrittenHS, Open/Open, new writer: complete
client returns client_complete clen=58 slen=834
secret=b2ac99bea59ba69f114c9e30379e6238d79161cfcc612498fd20e104aacca149
(Finished) [  58] ---->

TLS| writeHandshake (encrypted)
TLS| HS.next_fragment ID13?
HS | next_fragment
TLS| HS.next_fragment returned nothing
TLS| sendHandshake
TLS| read: WrittenHS, Ctrl/Open, nothing
TLS| Read fragment at epoch index: 0 of length 53
TLS| StAE decrypt correct.
TLS| read Handshake fragment
HS | recv_fragment
HSL| parsed Finished
HSL| end of flight
HS | Process Client Finished
KS | ks_server_13_cf hashed_log = 9c9589ad5e32e7319006328e83f3994adcef2bec1eea57f3193377dc2554d970
KS | resumption master secret:        dacc5445dd592dc9a87124b7c2a4b17884393fd8ea657e5e587d2e37e20506d2
HS | Sending ticket: 1790257b97e113d443e7a594859aed46837d242358312abea06b6a06a9c7aa09be8b3534431554d685673c39749a1697e524d04c1043baca50ff1b21158d783909ff34d212e2070c89c13909
HSL| emit NewSessionTicket13
EPO| reader++ 1/1
TLS| readOne Complete
server returns server_complete clen=58 slen=0
TLS| writeHandshake (encrypted)
TLS| HS.next_fragment ID13?
HS | next_fragment
TLS| HS.next_fragment returned a fragment
TLS| sendHandshake
TLS| send Handshake fragment with index ID13
TLS| Encrypting with key 32e26c679c694cedf9ba68034b2c6de76351dbf16c6fbbe2b2eb767c0750d86e
TLS| Sending fragment of length 130
REC| record headers: 1703030082
TLS| writeHandshake (encrypted)
TLS| HS.next_fragment ID13?
HS | next_fragment
TLS| HS.next_fragment returned nothing
TLS| sendHandshake
TLS| read: WrittenHS, Open/Open, nothing
REC| WouldBlock
TLS| readOne ReadWouldBlock
server returns would_block clen=0 slen=135
<---- {Ticket}[ 135]
TLS| writeHandshake (encrypted)
TLS| HS.next_fragment ID13?
HS | next_fragment
TLS| HS.next_fragment returned nothing
TLS| sendHandshake
TLS| read: WrittenHS, Open/Open, nothing
TLS| Read fragment at epoch index: 1 of length 130
TLS| StAE decrypt correct.
TLS| read Handshake fragment
HS | recv_fragment
HSL| parsed NewSessionTicket13
HSL| end of flight
HS | Received ticket: 1790257b97e113d443e7a594859aed46837d242358312abea06b6a06a9c7aa09be8b3534431554d685673c39749a1697e524d04c1043baca50ff1b21158d783909ff34d212e2070c89c13909
KS | ks_client_13_rms
KS | Recall RMS: dacc5445dd592dc9a87124b7c2a4b17884393fd8ea657e5e587d2e37e20506d2
AEP| LowProvider: COERCE(K=e0bf77d1bd7a906e9b9bb608016dedba5d316a581acc90ac5812fe38f01eb6de)

##### New session ticket received! #####
Host: localhost
Ticket:
1790257b97e113d443e7a594859aed46837d242358312abea06b6a06a9c7aa09
be8b3534431554d685673c39749a1697e524d04c1043baca50ff1b21158d7839
09ff34d212e2070c89c13909
########################################
TLS| readOne ReadAgain
TLS| writeHandshake (encrypted)
TLS| HS.next_fragment ID13?
HS | next_fragment
TLS| HS.next_fragment returned nothing
TLS| sendHandshake
TLS| read: WrittenHS, Open/Open, nothing
REC| WouldBlock
TLS| readOne ReadWouldBlock
client returns clen=0 slen=135 status=would_block
Ok
make[1]: Leaving directory '/cygdrive/c/build/agent2/_work/6/s/mitls-fstar/apps/quicMinusNet'
make[1]: Entering directory '/cygdrive/c/build/agent2/_work/6/s/mitls-fstar/src/tls'
C:/build/agent2/_work/6/s/FStar/bin/fstar.exe --cache_dir cache/Model --cache_checked_modules --print_z3_statistics --use_hints --query_stats --cache_dir cache/Model --odir extract/Model --extract Nothing --dep full --include C:/build/agent2/_work/6/s/FStar/contrib/CoreCrypto/fst/ --include C:/build/agent2/_work/6/s/hacl-star/secure_api --include C:/build/agent2/_work/6/s/hacl-star/secure_api/utils --include C:/build/agent2/_work/6/s/hacl-star/secure_api/concrete_specializations --include C:/build/agent2/_work/6/s/hacl-star/secure_api/LowCProvider/fst --include C:/build/agent2/_work/6/s/hacl-star/code/curve25519/api --include C:/build/agent2/_work/6/s/hacl-star/code/lib --include C:/build/agent2/_work/6/s/kremlin/include --include C:/build/agent2/_work/6/s/kremlin/kremlib --include ../../libs/ffi --include ../../src/lowparse --include C:/build/agent2/_work/6/s/hacl-star/providers/evercrypt --include ../../src/tls/ideal-flags --include ../../src/tls/concrete-flags/generic --include ./concrete-flags/Debug QUIC.fst Test.Main.fst IV.fst HMAC.UFCMA.fst Token.UF1CMA.fst Pkg.Tree.fst AEAD.Pkg.fst > cache/Model/.depend
sed -i.opt -e "s/cmx/cmo/g" -e "s/source/old/g" cache/Model/.depend
make[1]: Leaving directory '/cygdrive/c/build/agent2/_work/6/s/mitls-fstar/src/tls'
make[1]: Entering directory '/cygdrive/c/build/agent2/_work/6/s/mitls-fstar/src/tls'
C:/build/agent2/_work/6/s/FStar/bin/fstar.exe --cache_dir cache/Kremlin --cache_checked_modules --print_z3_statistics --use_hints --query_stats --cache_dir cache/Kremlin --odir extract/Kremlin --extract '* -DHDB -LowCProvider -FFICallbacks -BufferBytes' --dep full --include C:/build/agent2/_work/6/s/FStar/contrib/CoreCrypto/fst/ --include C:/build/agent2/_work/6/s/hacl-star/secure_api --include C:/build/agent2/_work/6/s/hacl-star/secure_api/utils --include C:/build/agent2/_work/6/s/hacl-star/secure_api/concrete_specializations --include C:/build/agent2/_work/6/s/hacl-star/secure_api/LowCProvider/fst --include C:/build/agent2/_work/6/s/hacl-star/code/curve25519/api --include C:/build/agent2/_work/6/s/hacl-star/code/lib --include C:/build/agent2/_work/6/s/kremlin/include --include C:/build/agent2/_work/6/s/kremlin/kremlib --include ../../libs/ffi --include ../../src/lowparse --include C:/build/agent2/_work/6/s/hacl-star/providers/evercrypt --include ../../src/tls/concrete-flags --include ../../src/tls/concrete-flags/Kremlin --include ./concrete-flags/Debug QUIC.fst Test.Main.fst > cache/Kremlin/.depend
sed -i.opt -e "s/cmx/cmo/g" -e "s/source/old/g" cache/Kremlin/.depend
make[1]: Leaving directory '/cygdrive/c/build/agent2/_work/6/s/mitls-fstar/src/tls'
make[1]: Entering directory '/cygdrive/c/build/agent2/_work/6/s/mitls-fstar/src/tls'
echo No verification-specific tests as of yet.
No verification-specific tests as of yet.
make[1]: Leaving directory '/cygdrive/c/build/agent2/_work/6/s/mitls-fstar/src/tls'
make[1]: Entering directory '/cygdrive/c/build/agent2/_work/6/s/mitls-fstar/src/tls'
C:/build/agent2/_work/6/s/FStar/bin/fstar.exe --cache_dir cache/OCaml --cache_checked_modules --print_z3_statistics --use_hints --query_stats --cache_dir cache/OCaml --odir extract/OCaml --extract '* -Prims -FStar +FStar.Test +FStar.Kremlin.Endianness -CoreCrypto -CryptoTypes -EverCrypt.Bytes -EverCrypt -DHDB -LowCProvider -HaclProvider -FFICallbacks -Crypto.AEAD -Crypto.Symmetric -Crypto.Plain -Spec.Loops -Buffer.Utils -C +C.Loops -LowParse.SLow.Tac -BufferBytes' --dep full --include C:/build/agent2/_work/6/s/FStar/contrib/CoreCrypto/fst/ --include C:/build/agent2/_work/6/s/hacl-star/secure_api --include C:/build/agent2/_work/6/s/hacl-star/secure_api/utils --include C:/build/agent2/_work/6/s/hacl-star/secure_api/concrete_specializations --include C:/build/agent2/_work/6/s/hacl-star/secure_api/LowCProvider/fst --include C:/build/agent2/_work/6/s/hacl-star/code/curve25519/api --include C:/build/agent2/_work/6/s/hacl-star/code/lib --include C:/build/agent2/_work/6/s/kremlin/include --include C:/build/agent2/_work/6/s/kremlin/kremlib --include ../../libs/ffi --include ../../src/lowparse --include C:/build/agent2/_work/6/s/hacl-star/providers/evercrypt --include ../../src/tls/concrete-flags --include ../../src/tls/concrete-flags/OCaml --include ./concrete-flags/Debug QUIC.fst Test.Main.fst > cache/OCaml/.depend
sed -i.opt -e "s/cmx/cmo/g" -e "s/source/old/g" cache/OCaml/.depend
make[1]: Leaving directory '/cygdrive/c/build/agent2/_work/6/s/mitls-fstar/src/tls'
EVEREST_WINDOWS= make -C extract/Kremlin-Internal-Test test
EVEREST_WINDOWS= make -C extract/Kremlin-Library test
make[2]: Nothing to be done for 'test'.
make[2]: 'test' is up to date.
make[1]: Entering directory '/cygdrive/c/build/agent2/_work/6/s/mitls-fstar/src/tls'
OCAMLPATH="C:/build/agent2/_work/6/s/FStar/bin" ocamlfind opt -g -I C:/build/agent2/_work/6/s/FStar/ulib/ml -I extract/OCaml -I C:/build/agent2/_work/6/s/MLCrypto -I ../../libs/ffi -I C:/build/agent2/_work/6/s/hacl-star/secure_api/LowCProvider -I C:/build/agent2/_work/6/s/hacl-star/secure_api/out/runtime_switch/ -I C:/build/agent2/_work/6/s/kremlin/_build/kremlib -I test -I extract/mlstubs -I C:/build/agent2/_work/6/s/hacl-star/providers/evercrypt/ml -I . -package fstarlib,zarith,ctypes,ctypes.foreign -cclib -L../pki -cclib -lmipki \
-cclib -LC:/build/agent2/_work/6/s/hacl-star/providers/out -cclib -levercrypt -linkall \
-linkpkg -g extract/OCaml/BufferBytes.cmx extract/OCaml/Crypto_AEAD_Main.cmx C:/build/agent2/_work/6/s/kremlin/_build/kremlib/C.cmx C:/build/agent2/_work/6/s/MLCrypto/CoreCrypto.cmxa C:/build/agent2/_work/6/s/hacl-star/secure_api/out/runtime_switch/LowC.cmxa ../../libs/ffi/FFICallbacks.cmxa C:/build/agent2/_work/6/s/hacl-star/providers/out/evercrypt.cmxa extract/OCaml/Hashing_Spec.cmx extract/OCaml/Flags.cmx extract/OCaml/TLSError.cmx extract/OCaml/Mem.cmx extract/OCaml/Hashing_OpenSSL.cmx extract/OCaml/Hashing.cmx extract/OCaml/LowParse_Bytes32.cmx extract/OCaml/LowParse_Bytes.cmx extract/OCaml/LowParse_Spec_Base.cmx extract/OCaml/LowParse_Spec_Combinators.cmx extract/OCaml/LowParse_SLow_Base.cmx extract/OCaml/LowParse_SLow_Combinators.cmx extract/OCaml/LowParse_Spec_Enum.cmx extract/OCaml/LowParse_SLow_Enum.cmx extract/OCaml/LowParse_Spec_Sum.cmx extract/OCaml/LowParse_SLow_Sum.cmx extract/OCaml/LowParse_Math.cmx extract/OCaml/FStar_Kremlin_Endianness.cmx extract/OCaml/LowParse_BigEndian.cmx extract/OCaml/LowParse_BigEndianImpl_Base.cmx extract/OCaml/LowParse_BigEndianImpl_SLow.cmx extract/OCaml/LowParse_Spec_FLData.cmx extract/OCaml/LowParse_SLow_FLData.cmx extract/OCaml/LowParse_Spec_VLData.cmx extract/OCaml/LowParse_SLow_VLData.cmx extract/OCaml/LowParse_Spec_Bytes.cmx extract/OCaml/LowParse_SLow_Bytes.cmx extract/OCaml/LowParse_Spec_List.cmx extract/OCaml/LowParse_Spec_Array.cmx extract/OCaml/C_Loops.cmx extract/OCaml/LowParse_SLow_List.cmx extract/OCaml/LowParse_SLow_Array.cmx extract/OCaml/LowParse_Spec_Int_Aux.cmx extract/OCaml/LowParse_Spec_Int.cmx extract/OCaml/LowParse_Spec_Int_Unique.cmx extract/OCaml/LowParse_SLow_Int_Aux.cmx extract/OCaml/LowParse_SLow_Int.cmx extract/OCaml/LowParse_SLow.cmx extract/OCaml/Format_NamedGroup.cmx extract/OCaml/Format_Constants.cmx extract/OCaml/Format_UncompressedPointRepresentation.cmx extract/OCaml/Format_KeyShareEntry.cmx extract/OCaml/Format_ECCurveType.cmx extract/OCaml/TLS_Curve25519.cmx extract/OCaml/Parse.cmx extract/OCaml/ECGroup.cmx extract/OCaml/DHGroup.cmx extract/OCaml/DebugFlags.cmx extract/OCaml/Format_NamedGroupList.cmx extract/OCaml/CommonDH.cmx extract/OCaml/LowParseWrappers.cmx extract/OCaml/QD_TLS_protocolVersion.cmx extract/OCaml/TLSConstants.cmx extract/OCaml/PKI.cmx extract/OCaml/Nonce.cmx extract/OCaml/RSAKey.cmx extract/OCaml/PMS.cmx extract/OCaml/List_Helpers.cmx extract/OCaml/PSK.cmx extract/OCaml/Extensions.cmx extract/OCaml/Cert.cmx extract/OCaml/TLSInfoFlags.cmx extract/OCaml/TLSInfo.cmx extract/OCaml/Crypto_Indexing.cmx extract/OCaml/Flag.cmx extract/OCaml/Specializations_Providers_AEAD.cmx extract/OCaml/AEADOpenssl.cmx extract/OCaml/AEADProvider.cmx extract/OCaml/Range.cmx extract/OCaml/Hashing_CRF.cmx extract/OCaml/HandshakeMessages.cmx extract/OCaml/HandshakeLog.cmx extract/OCaml/HMAC.cmx extract/OCaml/Old_HMAC_UFCMA.cmx extract/OCaml/Test_BufferBytes.cmx extract/OCaml/TLSPRF.cmx extract/OCaml/DataStream.cmx extract/OCaml/Alert.cmx extract/OCaml/Content.cmx extract/OCaml/StreamPlain.cmx extract/OCaml/StreamAE.cmx extract/OCaml/StatefulPlain.cmx extract/OCaml/LHAEPlain.cmx extract/OCaml/AEAD_GCM.cmx extract/OCaml/StatefulLHAE.cmx extract/OCaml/StAE.cmx extract/OCaml/Ticket.cmx extract/OCaml/Old_HKDF.cmx extract/OCaml/Old_KeySchedule.cmx extract/OCaml/FStar_Test.cmx extract/OCaml/Test_CommonDH.cmx extract/OCaml/Negotiation.cmx extract/OCaml/Old_Epochs.cmx extract/OCaml/Old_Handshake.cmx extract/OCaml/Transport.cmx extract/OCaml/Record.cmx extract/OCaml/Connection.cmx extract/OCaml/StreamDeltas.cmx extract/OCaml/TLS.cmx extract/OCaml/FFI.cmx extract/OCaml/QUIC.cmx extract/OCaml/Test_StAE.cmx extract/OCaml/Test_TLSConstants.cmx extract/OCaml/Test_Handshake.cmx extract/OCaml/Test_AEAD.cmx extract/OCaml/Test_Main.cmx extract/OCaml/FFIRegister.cmx C:/build/agent2/_work/6/s/kremlin/kremlib/out/libkremlib.a -o mitls.exe -thread
make[1]: Leaving directory '/cygdrive/c/build/agent2/_work/6/s/mitls-fstar/src/tls'
make[1]: Entering directory '/cygdrive/c/build/agent2/_work/6/s/mitls-fstar/src/tls'
./mitls.exe
make[1]: Leaving directory '/cygdrive/c/build/agent2/_work/6/s/mitls-fstar/src/tls'
+ cd mitls-fstar/apps/cmitls
+ make test
./cmitls.exe google.com 443
cmitls.exe ===================
cmitls.exe calling FFI_mitls_init
cmitls.exe about to act as client or server
===============================================
Starting test client...
FFI| Setting up certificate callbacks.
FFI| Setting a new server negotiation callback.
TLS| writeHandshake (plaintext)
TLS| HS.next_fragment PlaintextID?
HS | next_fragment
HS | offering ClientHello 1.3
KS | ks_client_init 1.3
CDH| Keygen (initiator) on X255519
NGO| No PSK or 0-RTT disabled
NGO| offering client extensions [ supported_versions key_share server_name session_ticket extended_master_secret signature_algorithms ec_point_formats supported_groups psk_key_exchange_modes ]
NGO| offering cipher suites ; TLS_AES_128_GCM_SHA256; TLS_AES_256_GCM_SHA384; TLS_CHACHA20_POLY1305_SHA256; TLS_ECDHE_ECDSA_WITH_AES_128_GCM_SHA256; TLS_ECDHE_RSA_WITH_AES_128_GCM_SHA256; TLS_DHE_RSA_WITH_AES_128_GCM_SHA256; TLS_ECDHE_ECDSA_WITH_AES_256_GCM_SHA384; TLS_ECDHE_RSA_WITH_AES_256_GCM_SHA384; TLS_DHE_RSA_WITH_AES_256_GCM_SHA384; TLS_ECDHE_ECDSA_WITH_CHACHA20_POLY1305_SHA256; TLS_ECDHE_RSA_WITH_CHACHA20_POLY1305_SHA256; TLS_DHE_RSA_WITH_CHACHA20_POLY1305_SHA256
HSL| emit ClientHello
TLS| HS.next_fragment returned a fragment
TLS| sendHandshake
TLS| send Handshake fragment with index PlaintextID
TLS| Sending fragment of length 208
REC| record headers: 16030300d0
TLS| writeHandshake (plaintext)
TLS| HS.next_fragment PlaintextID?
HS | next_fragment
TLS| HS.next_fragment returned nothing
TLS| sendHandshake
TLS| read: WrittenHS, Ctrl/Ctrl, nothing
TLS| Read fragment at epoch index: -1 of length 58
TLS| read Handshake fragment
HS | recv_fragment
HSL| parsed ServerHello
HSL| end of flight
HS | client_ServerHello
NGO| processing server extensions [ extended_master_secret session_ticket ec_point_formats ]
NGO| negotiated 1.2 TLS_ECDHE_ECDSA_WITH_AES_128_GCM_SHA256
HS | Running classic TLS
HS | Offered SID= Server SID=
HS | recv_fragment
HSL| more bytes required
TLS| readOne ReadAgain
TLS| writeHandshake (plaintext)
TLS| HS.next_fragment PlaintextID?
HS | next_fragment
TLS| HS.next_fragment returned nothing
TLS| sendHandshake
TLS| read: WrittenHS, Ctrl/Ctrl, nothing
TLS| Read fragment at epoch index: -1 of length 3072
TLS| read Handshake fragment
HS | recv_fragment
HSL| parsed Certificate
HSL| more bytes required
TLS| readOne ReadAgain
TLS| writeHandshake (plaintext)
TLS| HS.next_fragment PlaintextID?
HS | next_fragment
TLS| HS.next_fragment returned nothing
TLS| sendHandshake
TLS| read: WrittenHS, Ctrl/Ctrl, nothing
TLS| Read fragment at epoch index: -1 of length 115
TLS| read Handshake fragment
HS | recv_fragment
HSL| parsed ServerKeyExchange
HSL| more bytes required
TLS| readOne ReadAgain
TLS| writeHandshake (plaintext)
TLS| HS.next_fragment PlaintextID?
HS | next_fragment
TLS| HS.next_fragment returned nothing
TLS| sendHandshake
TLS| read: WrittenHS, Ctrl/Ctrl, nothing
TLS| Read fragment at epoch index: -1 of length 4
TLS| read Handshake fragment
HS | recv_fragment
HSL| parsed ServerHelloDone
HSL| end of flight
HS | processing ...ServerHelloDone
NGO| ServerKeyExchange signature: Valid
CDH| Keygen (responder) on X255519
CDH| DH initiator on X255519
KS | Share: 88355532cc53acbd06c4c5b9d9199737f8486c3640c5521da6bc2b71d411dc64
KS | Share: 001c6f69d3344d62a935018f353bfce66db09bf206720bdad20cab72cd31f93f
KS | PMS: a7e7a75069fc0fe03335720057e2a93482ff765e0f8304be9bf72623fcba852b
HSL| emit ClientKeyExchange and hash
KS | ks_client_12_set_session_hash hashed_log = 2733b9431c8c3c48179517365e6bde74992ea54780819cbfc7ee76d6a06662a6
KS | extended master secret:30f439410a6f2d5e458757957aca7e8fb2cfaa7cad1350d61baf96950a0dcc18ee5a198c5b3cc456d02fc9c0521ec56e
KS | ks_12_record_key
KS | keystring (CK, CIV, SK, SIV) = ac7b522f3ad950eb5ac9d33715ad5412ebe99b7fadb141006ad3b77566fe8e742c9e92c00c3fd193
AEP| LowProvider: COERCE(K=ac7b522f3ad950eb5ac9d33715ad5412)
AEP| LowProvider: COERCE(K=ebe99b7fadb141006ad3b77566fe8e74)
HS | digest is 2733b9431c8c3c48179517365e6bde74992ea54780819cbfc7ee76d6a06662a6
TLS| readOne ReadAgain
TLS| writeHandshake (plaintext)
TLS| HS.next_fragment PlaintextID?
HS | next_fragment
TLS| HS.next_fragment returned a fragment; CCS; next_keys (for handshake only
TLS| sendHandshake
TLS| send Handshake fragment with index PlaintextID
TLS| Sending fragment of length 37
REC| record headers: 1603030025
TLS| send CCS fragment with index PlaintextID
TLS| Sending fragment of length 1
REC| record headers: 1403030001
EPO| writer++ -1/0
TLS| writeHandshake (encrypted)
TLS| HS.next_fragment ID12?
HS | next_fragment
TLS| HS.next_fragment returned a fragment
TLS| sendHandshake
TLS| send Handshake fragment with index ID12
TLS| Sending fragment of length 40
REC| record headers: 1603030028
TLS| writeHandshake (encrypted)
TLS| HS.next_fragment ID12?
HS | next_fragment
TLS| HS.next_fragment returned nothing
TLS| sendHandshake
TLS| read: WrittenHS, Ctrl/Ctrl, new writer: handshake-only
TLS| ignore handshake-specifc key change; calling read again
TLS| writeHandshake (encrypted)
TLS| HS.next_fragment ID12?
HS | next_fragment
TLS| HS.next_fragment returned nothing
TLS| sendHandshake
TLS| read: WrittenHS, Ctrl/Ctrl, nothing
TLS| Read fragment at epoch index: -1 of length 228
TLS| read Handshake fragment
HS | recv_fragment
HSL| parsed NewSessionTicket
HSL| more bytes required
TLS| readOne ReadAgain
TLS| writeHandshake (encrypted)
TLS| HS.next_fragment ID12?
HS | next_fragment
TLS| HS.next_fragment returned nothing
TLS| sendHandshake
TLS| read: WrittenHS, Ctrl/Ctrl, nothing
TLS| Read fragment at epoch index: -1 of length 1
TLS| read CCS fragment
HS | recv_ccs
HS | Processing server CCS (full handshake). Ticket: 00ed68b0f2fb668fca42a23b5b2cf97c47c2dacb19714d8506032b2186ae00df9382d571304fb9f1a93f5d0eadbb020a0c3f22a151bc2f14758cc314bb86785b033d2cadd208a4bd1abe029dcbf7fc6ee1542dfad1f0aa41b596e2ec49dc71d55ce9a13324b97a2f7aff73a60d3072eaafbe761a1729e96240118b25f2c59d9707eb8d053df5ab8ace53120a0b5073c340136dce58581d82bb7ebe23e0bce4563d403ed2e6dbc47c63728e7798dc8bc11e38f09f0d5100f3f90ee686f5e456caa1a791d62be16e3d645d9ccb5974c4c7b303453251c097a72b67
EPO| reader++ 0/0
TLS| readOne ReadAgainFinishing
TLS| writeHandshake (encrypted)
TLS| HS.next_fragment ID12?
HS | next_fragment
TLS| HS.next_fragment returned nothing
TLS| sendHandshake
TLS| read: WrittenHS, Ctrl/Ctrl, nothing
TLS| Read fragment at epoch index: 0 of length 40
TLS| StAE decrypt correct.
TLS| read Handshake fragment
HS | recv_fragment
HSL| parsed Finished
HSL| end of flight
TLS| readOne Complete
FFI| Read returned Complete
Read OK, sending HTTP request...
TLS| writeHandshake (encrypted)
TLS| HS.next_fragment ID12?
HS | next_fragment
TLS| HS.next_fragment returned nothing
TLS| sendHandshake
TLS| send Data fragment with index ID12
TLS| Sending fragment of length 60
REC| record headers: 170303003c
TLS| writeHandshake (encrypted)
TLS| HS.next_fragment ID12?
HS | next_fragment
TLS| HS.next_fragment returned nothing
TLS| sendHandshake
TLS| read: WrittenHS, Open/Open, nothing
TLS| Read fragment at epoch index: 0 of length 620
TLS| StAE decrypt correct.
TLS| read Data fragment
TLS| readOne Read 596 bytes of data
Received 596 bytes of data:
Download speed: 1.#INF00kB/s
HTTP/1.1 301 Moved Permanently
Location: https://www.google.com/
Content-Type: text/html; charset=UTF-8
Date: Thu, 14 Jun 2018 23:10:19 GMT
Expires: Sat, 14 Jul 2018 23:10:19 GMT
Cache-Control: public, max-age=2592000
Server: gws
Content-Length: 220
X-XSS-Protection: 1; mode=block
X-Frame-Options: SAMEORIGIN
Alt-Svc: quic=":443"; ma=2592000; v="43,42,41,39,35"

<HTML><HEAD><meta http-equiv="content-type" content="text/html;charset=utf-8">
<TITLE>301 Moved</TITLE></HEAD><BODY>
<H1>301 Moved</H1>
The document has moved
<A HREF="https://www.google.com/">here</A>.
</BODY></HTML>

Closing connection, irrespective of the response
./cmitls.exe tls13.cloudflare.com 443
cmitls.exe ===================
cmitls.exe calling FFI_mitls_init
cmitls.exe about to act as client or server
===============================================
Starting test client...
FFI| Setting up certificate callbacks.
FFI| Setting a new server negotiation callback.
TLS| writeHandshake (plaintext)
TLS| HS.next_fragment PlaintextID?
HS | next_fragment
HS | offering ClientHello 1.3
KS | ks_client_init 1.3
CDH| Keygen (initiator) on X255519
NGO| No PSK or 0-RTT disabled
NGO| offering client extensions [ supported_versions key_share server_name session_ticket extended_master_secret signature_algorithms ec_point_formats supported_groups psk_key_exchange_modes ]
NGO| offering cipher suites ; TLS_AES_128_GCM_SHA256; TLS_AES_256_GCM_SHA384; TLS_CHACHA20_POLY1305_SHA256; TLS_ECDHE_ECDSA_WITH_AES_128_GCM_SHA256; TLS_ECDHE_RSA_WITH_AES_128_GCM_SHA256; TLS_DHE_RSA_WITH_AES_128_GCM_SHA256; TLS_ECDHE_ECDSA_WITH_AES_256_GCM_SHA384; TLS_ECDHE_RSA_WITH_AES_256_GCM_SHA384; TLS_DHE_RSA_WITH_AES_256_GCM_SHA384; TLS_ECDHE_ECDSA_WITH_CHACHA20_POLY1305_SHA256; TLS_ECDHE_RSA_WITH_CHACHA20_POLY1305_SHA256; TLS_DHE_RSA_WITH_CHACHA20_POLY1305_SHA256
HSL| emit ClientHello
TLS| HS.next_fragment returned a fragment
TLS| sendHandshake
TLS| send Handshake fragment with index PlaintextID
TLS| Sending fragment of length 218
REC| record headers: 16030300da
TLS| writeHandshake (plaintext)
TLS| HS.next_fragment PlaintextID?
HS | next_fragment
TLS| HS.next_fragment returned nothing
TLS| sendHandshake
TLS| read: WrittenHS, Ctrl/Ctrl, nothing
TLS| Read fragment at epoch index: -1 of length 90
TLS| read Handshake fragment
HS | recv_fragment
HSL| parsed ServerHello
HSL| end of flight
HS | client_ServerHello
NGO| processing server extensions [ key_share supported_versions ]
NGO| negotiated 1.3 TLS_AES_128_GCM_SHA256
HS | Running TLS 1.3
KS | ks_client_13_sh hashed_log = 11b4aa7f702d8ff512b6dd12d628c6f639c47bd5b9943f9446995acbd33361b4
KS | no PSK negotiated. Early secret: 33ad0a1c607ec03b09e6cd9893680ce210adf300aa1f2660e1b22e10f170f92a
KS | handshake salt:                  6f2615a108c702c5678f54fc9dbab69716c076189c48250cebeac3576c3611ba
CDH| DH initiator on X255519
KS | DH shared secret: 5290f329643fe32fbfa44e009981dd8b6ca2a6656700586194f827814e98280c
KS | handshake secret:                4bb6e8ffeb1986ac355df3830a2810161ff177369f8ff5d91dfce31aba24f581
KS | handshake traffic secret[C]:     ded95b61173f558074eac301ab25364a1e760ebf408b53e3c26454cf4a70294e
KS | handshake traffic secret[S]:     018ef510c06e164efc48018dea2e914f9c02b6fc932618c98640aea8d6b40586
KS | handshake key[C]:                6d3d749bff0ab69bd1f006e0b2cfbec1, IV=90bc46f382817e50dc2237a7
KS | handshake key[S]:                ab70beaba212bb52ca91a4efac4ef459, IV=8846226ecc9da942e9d57ada
KS | finished key[C]: cdd3649765f2d2c72f5bb4eb8a5c5c8481d37ddb5d6b11c5730eaf4d87ca3828
KS | finished key[S]: c9a822204ee6e3589e3c49ff837dd20750c92166aa48b93bdd30cccc6cc0e54b
KS | application salt:                dd0c7f181f5265620c28d5c200260363ceeeabd29fa979f4193dda13ab2c14bd
KS | application secret:              6e55c3f9e5b723857700afd8fc5d0257f11a971a1baa499da9a4f0313d6509f2
AEP| LowProvider: COERCE(K=6d3d749bff0ab69bd1f006e0b2cfbec1)
AEP| LowProvider: COERCE(K=ab70beaba212bb52ca91a4efac4ef459)
EPO| reader++ 0/-1
TLS| readOne ReadAgain
TLS| writeHandshake (plaintext)
TLS| HS.next_fragment PlaintextID?
HS | next_fragment
TLS| HS.next_fragment returned nothing
TLS| sendHandshake
TLS| read: WrittenHS, Ctrl/Ctrl, nothing
TLS| Read fragment at epoch index: 0 of length 1
TLS| Ignoring a CCS
TLS| Read fragment at epoch index: 0 of length 3364
TLS| StAE decrypt correct.
TLS| read Handshake fragment
HS | recv_fragment
HSL| parsed EncryptedExtensions
HSL| parsed Certificate13
HSL| parsed CertificateVerify
HSL| parsed Finished
HSL| end of flight
NGO| Nego.clientComplete_13
NGO| EE: 
NGO| Negotiation callback to process application extensions.
@@@@ Nego callback for TLS 1.3 @@@@
Offered extensions:
0000
No application cookie (fist connection).
@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
NGO| Certificate & signature 1.3 callback result: valid
KS | ks_client_13_sf hashed_log = d20ed59bdbf15aebe948e4d13c59e6f242b734bd2447e920571ce6e7378647ab
KS | application traffic secret[C]:   84564ed91dc7416d7de6be61d341ebcd9544386f22c9c046b70913129867ff51
KS | application traffic secret[S]:   e377d01831bb318586e2bda2173d116c14c59f815ea648800e771c8463676e9c
KS | exporter master secret:          803c44a17e9c6ba3fb3d7c2794d2ea25e476ebb79a62af07a57a545926d3bae9
KS | application key[C]:              361c821af6348355cc9553d26e5ee556, IV=31b56e85531a137bc41c08ed
KS | application key[S]:              1276d24d2bfebdf08d8bca9c5abce148, IV=c7326803b333f263a2e37af3
AEP| LowProvider: COERCE(K=361c821af6348355cc9553d26e5ee556)
AEP| LowProvider: COERCE(K=1276d24d2bfebdf08d8bca9c5abce148)
HS | exporting a key
HS | Early data rejected
EPO| writer++ 0/0
+ cd mitls-fstar/apps/quicMinusNet
HSL| emit Finished and hash
KS | ks_client_13_cf hashed_log = 370f17783b58f0b64a095b472080b2c46d2dc17c5c47a2e51026c1b2946abd00
+ make test
KS | resumption master secret:        c6f69e17a4f29a01661137eaae8d4ffed363b6a6882fa5ba59eed0f76a8a70b9
EPO| reader++ 1/0
TLS| readOne ReadAgain
TLS| writeHandshake (encrypted)
TLS| HS.next_fragment ID13?
HS | next_fragment
TLS| HS.next_fragment returned a fragment; next_keys (for all data); complete
TLS| sendHandshake
TLS| send Handshake fragment with index ID13
TLS| Encrypting with key 637c777bf26b6fc53001672bfed7ab76
TLS| Sending fragment of length 53
REC| record headers: 1703030035
EPO| writer++ 1/1
TLS| read: WrittenHS, Open/Open, new writer: complete
FFI| Read returned Complete
Read OK, sending HTTP request...
TLS| writeHandshake (encrypted)
TLS| HS.next_fragment ID13?
HS | next_fragment
TLS| HS.next_fragment returned nothing
TLS| sendHandshake
TLS| send Data fragment with index ID13
TLS| Encrypting with key 637c777bf26b6fc53001672bfed7ab76
TLS| Sending fragment of length 63
REC| record headers: 170303003f
TLS| writeHandshake (encrypted)
TLS| HS.next_fragment ID13?
HS | next_fragment
TLS| HS.next_fragment returned nothing
TLS| sendHandshake
TLS| read: WrittenHS, Open/Open, nothing
TLS| Read fragment at epoch index: 1 of length 461
TLS| StAE decrypt correct.
TLS| read Handshake fragment
HS | recv_fragment
HSL| parsed NewSessionTicket13
HSL| end of flight (bytes waiting)
HS | Received ticket: 7ae86c9d318bd990c0bb71a9ffdb6065a2a21d6866d0e0e6d3f6db876c9ff961cad7a534f0d68c6873299e2fe1571c3295d62ddf2d27ec9846a65a7459312c962cf1590182996d5a6991e7ec1b3781220b0d6af03011f59d0d58ed7f85cc6f5eb2e09ba02065ac14d77d499cdc71665b5bcea45a66a1c533aee5118f122e7d4aa40e642f0418e1dd7195c7c3d932fad64120484b510dd6bf755cd181fc9119839dd39060dd511cd571115bec1a4cf15a54ddac749a9321f3cdc0ad360ef0ff8c
KS | ks_client_13_rms
KS | Recall RMS: c6f69e17a4f29a01661137eaae8d4ffed363b6a6882fa5ba59eed0f76a8a70b9
TLS| readOne ReadAgain
TLS| writeHandshake (encrypted)
TLS| HS.next_fragment ID13?
HS | next_fragment
TLS| HS.next_fragment returned nothing
TLS| sendHandshake
TLS| read: WrittenHS, Open/Open, nothing
TLS| Read fragment at epoch index: 1 of length 1386
TLS| StAE decrypt correct.
TLS| read Data fragment
TLS| readOne Read 1369 bytes of data
Received 1369 bytes of data:
Download speed: 1.#INF00kB/s
HTTP/1.1 521 Origin Down
Date: Thu, 14 Jun 2018 23:10:19 GMT
Content-Type: text/html; charset=UTF-8
Transfer-Encoding: chunked
Connection: keep-alive
Set-Cookie: __cfduid=dc49e70b54c4c675bfb59a4b8c7a85b7e1529017819; expires=Fri, 14-Jun-19 23:10:19 GMT; path=/; domain=.cloudflare.com; HttpOnly
Expires: Thu, 01 Jan 1970 00:00:01 GMT
Cache-Control: no-store, no-cache, must-revalidate, post-check=0, pre-check=0
Pragma: no-cache
X-Frame-Options: SAMEORIGIN
Set-Cookie: cf_use_ob=443; expires=Thu, 14-Jun-18 23:10:49 GMT; path=/
Set-Cookie: cf_ob_info=521:42b0783b28d3bc74:SEA; expires=Thu, 14-Jun-18 23:10:49 GMT; path=/
Strict-Transport-Security: max-age=15780000; includeSubDomains
Expect-CT: max-age=604800, report-uri="https://report-uri.cloudflare.com/cdn-cgi/beacon/expect-ct"
Server: cloudflare
CF-RAY: 42b0783b28d3bc74-SEA

11c8
<!DOCTYPE html>
<!--[if lt IE 7]> <html class="no-js ie6 oldie" lang="en-US"> <![endif]-->
<!--[if IE 7]>    <html class="no-js ie7 oldie" lang="en-US"> <![endif]-->
<!--[if IE 8]>    <html class="no-js ie8 oldie" lang="en-US"> <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en-US"> <!--<![endif]-->
<head>
<meta http-equiv="refresh" content="0">

<title>tls13.cloudflare.com | 521: Web server is down</title>
<meta charset="UTF-8" />
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8
Closing connection, irrespective of the response
./quic.exe
server create
FFI| offering custom extension 001a
FFI| extension contents: ffff00050a0b0c0d0e
FFI| setting early data limit to ffffffff
FFI| Setting a new ticket callback.
FFI| Setting a new server negotiation callback.
FFI| Setting up certificate callbacks.
client create
FFI| offering custom extension 001a
FFI| extension contents: ffff00050a0b0c0d0e
FFI| setting early data limit to ffffffff
FFI| Setting a new ticket callback.
FFI| Setting a new server negotiation callback.
FFI| Setting up certificate callbacks.
client call clen=8192 slen=   0
TLS| writeHandshake (plaintext)
TLS| HS.next_fragment PlaintextID?
HS | next_fragment
HS | offering ClientHello 1.3
KS | ks_client_init 1.3
CDH| Keygen (initiator) on X255519
NGO| No PSK or 0-RTT disabled
NGO| offering client extensions [ 001a supported_versions key_share server_name alpn extended_master_secret signature_algorithms supported_groups psk_key_exchange_modes ]
NGO| offering cipher suites ; TLS_CHACHA20_POLY1305_SHA256; TLS_AES_128_GCM_SHA256
HSL| emit ClientHello
TLS| HS.next_fragment returned a fragment
TLS| sendHandshake
TLS| send Handshake fragment with index PlaintextID
TLS| Sending fragment of length 170
REC| record headers: 16030300aa
TLS| writeHandshake (plaintext)
TLS| HS.next_fragment PlaintextID?
HS | next_fragment
TLS| HS.next_fragment returned nothing
TLS| sendHandshake
TLS| read: WrittenHS, Ctrl/Ctrl, nothing
REC| WouldBlock
TLS| readOne ReadWouldBlock
client done clen= 175 slen=   0 status=would_block
16030300aa010000a603035b22f5dba81c9dc1080131592e7078b197c90d141c
3948f3a9b68bc712e45e350000041303130101000079001a0009ffff00050a0b
0c0d0e002b0003027f1c003300260024001d00206ca1eb2802816c692b071c72
743273611c8172912d763779ae2208aeccb42d670000000e000c0000096c6f63
616c686f73740010000800060568712d313000170000000d0006000408040403
000a00040002001d002d0003020001
server call clen= 175 slen=8192
TLS| writeHandshake (plaintext)
TLS| HS.next_fragment PlaintextID?
HS | next_fragment
TLS| HS.next_fragment returned nothing
TLS| sendHandshake
TLS| read: WrittenHS, Ctrl/Ctrl, nothing
TLS| Read fragment at epoch index: -1 of length 170
TLS| read Handshake fragment
HS | recv_fragment
HSL| parsed [ClientHello] -- end of flight 
HS | Processing ClientHello
NGO| offered client extensions [ 001a supported_versions key_share server_name alpn extended_master_secret signature_algorithms supported_groups psk_key_exchange_modes ]
NGO| offered cipher suites ; TLS_CHACHA20_POLY1305_SHA256; TLS_AES_128_GCM_SHA256
NGO| offered versions 1.3
NGO| Negotiated Pure EDH key exchange
NGO| Negotiated ECDSA_SECP256R1_SHA256
NGO| Negotiation callback to handle extra extensions and query for stateless retry.
NGO| Application data in cookie: none
@@@@ Nego callback for TLS 1.3 @@@@
Offered extensions:
003d001a0009ffff00050a0b0c0d0e0000000e000c0000096c6f63616c686f73
740010000800060568712d3130000d0006000408040403000a00040002001d
Transport parameters offered:
ffff00050a0b0c0d0e
No application cookie (fist connection).
Adding server transport parameters:
000102
@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
NGO| negotiated 1.3 TLS_CHACHA20_POLY1305_SHA256
KS | ks_server_init
KS | No PSK selected.
KS | Computed early secret:           33ad0a1c607ec03b09e6cd9893680ce210adf300aa1f2660e1b22e10f170f92a
KS | Handshake salt:                  6f2615a108c702c5678f54fc9dbab69716c076189c48250cebeac3576c3611ba
CDH| Keygen (responder) on X255519
CDH| DH initiator on X255519
KS | DH shared secret: 34cea650a8ff2136143e5c40589c0402db005a52e23a94f54830d151dc48913f
KS | Handshake secret:                d46becf4b7639dad27e707f964eee3eecc10425e6983186b4a167f6c21d3de55
NGO| processing client extensions [ 001a supported_versions key_share server_name alpn extended_master_secret signature_algorithms supported_groups psk_key_exchange_modes ]
NGO| including server extensions (SH + EE) [ supported_versions key_share alpn supported_groups ]
NGO| extra extensions from application callback: 001a 
HSL| emit ServerHello and hash
HS | derive handshake keys
KS | ks_server_13_sh, hashed log = dfd341604bdb7b6408dbbe09f105a96d0a6f2ce7ba96812b14c3bc4f15a47ca9
KS | handshake traffic secret[C]:     847b9669c91e2463e2406109f75590e6b19c29ae944213e50dcfbf6c66a30344
KS | handshake traffic secret[S]:     6f4eb056ca4b877de9429830a9c932872a9e75d662c1e36e71f22e70811b0dff
KS | handshake key[C]:                7567768726ae8411c4aa3aec19e355a4be902bd04def81418ad6c0f31a6c5845, IV=84bb055c759ac5b75b64acea
KS | handshake key[S]: 13a5a2f74ee2092f75eec01330f065ad999dfcc8e6bba260f99ea385b46934d6, IV=e26d680c522f728e445d450b
AEP| LowProvider: COERCE(K=13a5a2f74ee2092f75eec01330f065ad999dfcc8e6bba260f99ea385b46934d6)
AEP| LowProvider: COERCE(K=7567768726ae8411c4aa3aec19e355a4be902bd04def81418ad6c0f31a6c5845)
KS | finished key[C]:                 fff4b106431c0714d9f898003900d31718a439efcc634f2098f794bd401a0b8c
KS | finished key[S]:                 22aca8a26fde8bb43c758ec567a07f3633a7949d07bdf6db6de4e2128581c06f
KS | Application salt:                e3f0761cd02a1c263f79a401fe0e64affd1013af73d0d5f07142c3338ae8b5e1
KS | Application secret:              a76a0e0141e1ce94379e293f5b34a0c2c4d7cf819318a1b3cb6247ec3392e36d
TLS| readOne ReadAgain
TLS| writeHandshake (plaintext)
TLS| HS.next_fragment PlaintextID?
HS | next_fragment
TLS| HS.next_fragment returned a fragment; next_keys (for handshake only
TLS| sendHandshake
TLS| send Handshake fragment with index PlaintextID
TLS| Sending fragment of length 90
REC| record headers: 160303005a
EPO| writer++ -1/0
TLS| writeHandshake (encrypted)
TLS| HS.next_fragment ID13?
HS | next_fragment
HS | prepare Server Finished
HSL| emit EncryptedExtensions
HSL| emit Certificate13 and hash
======== TO BE SIGNED <0403>: (130 octets) ========
2020202020202020202020202020202020202020202020202020202020202020
2020202020202020202020202020202020202020202020202020202020202020
544c5320312e332c207365727665722043657274696669636174655665726966
7900d7cfcb7a3ff59dd85eccaf60b61248aa3df3aee994fc2e973bf87f21c8b2
17a5
===================================================
HSL| emit CertificateVerify and hash
HSL| emit Finished and hash
KS | ks_server_13_sf hashed_log = 7881863f30f93420479c3fd27ce04395e78a64d697a92badfe5af3a6d28c9d56
KS | application traffic secret[C]:   3262b38da9f47f6c1cbc61d1bb44f17215db6a720276978551e0df8488410d65
KS | application traffic secret[S]:   f10f00c5549b321d20ad041d435cf38b36b8171b61529e90108dd8eedb769f20
KS | exporter master secret:          4261ffb990373fd1fb90c6eb0db6e2b61773484754e4a36f7fb43afa58f65e73
KS | application key[C]:              73e66df57b8f751a0d05900dadc6f89ccf293ba94036e0e2a3e77e0cb5785485, IV=57cd1e48c1cd7c5776766d50
KS | application key[S]:              3bc30dba64442cb0e48b3c34e436498a316df5b8ba59781475df0c20690bc85f, IV=d1ab33c16341545f0ff15a71
AEP| LowProvider: COERCE(K=3bc30dba64442cb0e48b3c34e436498a316df5b8ba59781475df0c20690bc85f)
AEP| LowProvider: COERCE(K=73e66df57b8f751a0d05900dadc6f89ccf293ba94036e0e2a3e77e0cb5785485)
HS | exporting a key
EPO| reader++ 0/0
TLS| HS.next_fragment returned a fragment; next_keys (for all data)
TLS| sendHandshake
TLS| send Handshake fragment with index ID13
+ set +x
TLS| Encrypting with key 13a5a2f74ee2092f75eec01330f065ad999dfcc8e6bba260f99ea385b46934d6
TLS| Sending fragment of length 734
REC| record headers: 17030302de
EPO| writer++ 0/1
TLS| read: WrittenHS, Ctrl/Open, new writer: writable
sender done clen= 175 slen= 834 status=server_accept
160303005a0200005603035b22f5db1d9acb0ef7438114d895849aa2efb2784b
d8dc3fe37a4fba62229b3e00130300002e002b00027f1c00330024001d00208b
2a836ab00a7c80d97cbded9d2289c11fecfada5d5f869afd3982672ece2f4c17
030302de321be9b206c1506d464493b5da628cc42c0b8de7d4bf0362fdcb66ce
78efd4c58cea4e3389b73f425927cf569241ab6bcf4bd95bf05aeb39e25c4fef
2f819d892acfaa36e494109b32733d69ff64da67eb76af9e02a3989e1a45ccad
d9dbceb5faeae20bb20b926abfd85f50e6dec680f8e07e914af6655f9cc93cbf
d0ef0dcefd8815291bfda1245673de5349457b563bc7c05df05fc2ad213860e4
987c6ecd4695123b796cc304a6968e1fbb467ce3106274cb6aa6632f05d9342c
3e6fc1809722e66ae2f6207b3c70582fa06fb0cc1b8c5adce27f23bc8fe86f7b
c27a35a83acca34de30ad424a1fc574c0c0d73e9cab8fdbcdb76575252ff51f9
0880578bd9a2a9ecde2e3016b2aa9c530c5d1e533f9c924bca11c49f2c1eb10b
3d4b1c2cf39ab5104fc1d69fcc6462e817ec68f8eb737b756d1e1b6f3cd77f5b
bcab4c3904ad5dd1eca566dce580204e687daaf7ee2b4ce6eb9b63cfbce4f720
571bbe0ed70547f91ab4855c4a453499ea2c1ec9d9ee45ae559f7c04a28c17b2
a82ad62bdfa14ecf50671ce5e6edf4ab340d4b578e83c0ca3ae21e2c8c001ea7
caa17c22f6955d521614016e0b9f9183b5375ff6077ab1f3f45cd58e1901ef99
0031dc35b72877b4647d2a44c7f47f392e9f516e1e8f31d2a01b74b3dba0f9ae
ba799b31bc6b926b7ceaef3213bd464cf56d63b86f9927526b63206ab8a71657
2b18f786a53c0f4e3f437adb52f1f0c1ec133ed6786c2031888cfaa608a03e5d
2d19b690623c2c16ff3cddd1ffbc8cca30e42ffa7d3129188988a7509150f49e
6b955e96771a2d9a8769201c31b36973f623ab284893b08bc56d6c4d2d823521
33ed8819a52fdf1097d19a62f9cdd6534d60c7381262ffc47d4f870ebb2d11ab
61539719aaf33a54fd504b869153e1483cb52f7cc2b064dce3dc34c86a53f73b
da531dbe8e494b6a962921f184d347660e3d72e8ae738769e6be32f246a67455
e4059543fccbbf4a47176f0e774448609132e6b34eca5d4cbda7deb8a9d81c42
6419
client call clen=8017 slen= 834
TLS| writeHandshake (plaintext)
TLS| HS.next_fragment PlaintextID?
HS | next_fragment
TLS| HS.next_fragment returned nothing
TLS| sendHandshake
TLS| read: WrittenHS, Ctrl/Ctrl, nothing
TLS| Read fragment at epoch index: -1 of length 90
TLS| read Handshake fragment
HS | recv_fragment
HSL| parsed ServerHello
HSL| end of flight
HS | client_ServerHello
NGO| processing server extensions [ supported_versions key_share ]
NGO| negotiated 1.3 TLS_CHACHA20_POLY1305_SHA256
HS | Running TLS 1.3
KS | ks_client_13_sh hashed_log = dfd341604bdb7b6408dbbe09f105a96d0a6f2ce7ba96812b14c3bc4f15a47ca9
KS | no PSK negotiated. Early secret: 33ad0a1c607ec03b09e6cd9893680ce210adf300aa1f2660e1b22e10f170f92a
KS | handshake salt:                  6f2615a108c702c5678f54fc9dbab69716c076189c48250cebeac3576c3611ba
CDH| DH initiator on X255519
KS | DH shared secret: 34cea650a8ff2136143e5c40589c0402db005a52e23a94f54830d151dc48913f
KS | handshake secret:                d46becf4b7639dad27e707f964eee3eecc10425e6983186b4a167f6c21d3de55
KS | handshake traffic secret[C]:     847b9669c91e2463e2406109f75590e6b19c29ae944213e50dcfbf6c66a30344
KS | handshake traffic secret[S]:     6f4eb056ca4b877de9429830a9c932872a9e75d662c1e36e71f22e70811b0dff
KS | handshake key[C]:                7567768726ae8411c4aa3aec19e355a4be902bd04def81418ad6c0f31a6c5845, IV=84bb055c759ac5b75b64acea
KS | handshake key[S]:                13a5a2f74ee2092f75eec01330f065ad999dfcc8e6bba260f99ea385b46934d6, IV=e26d680c522f728e445d450b
KS | finished key[C]: fff4b106431c0714d9f898003900d31718a439efcc634f2098f794bd401a0b8c
KS | finished key[S]: 22aca8a26fde8bb43c758ec567a07f3633a7949d07bdf6db6de4e2128581c06f
KS | application salt:                e3f0761cd02a1c263f79a401fe0e64affd1013af73d0d5f07142c3338ae8b5e1
KS | application secret:              a76a0e0141e1ce94379e293f5b34a0c2c4d7cf819318a1b3cb6247ec3392e36d
AEP| LowProvider: COERCE(K=7567768726ae8411c4aa3aec19e355a4be902bd04def81418ad6c0f31a6c5845)
AEP| LowProvider: COERCE(K=13a5a2f74ee2092f75eec01330f065ad999dfcc8e6bba260f99ea385b46934d6)
EPO| reader++ 0/-1
TLS| readOne ReadAgain
TLS| writeHandshake (plaintext)
TLS| HS.next_fragment PlaintextID?
HS | next_fragment
TLS| HS.next_fragment returned nothing
TLS| sendHandshake
TLS| read: WrittenHS, Ctrl/Ctrl, nothing
TLS| Read fragment at epoch index: 0 of length 734
TLS| StAE decrypt correct.
TLS| read Handshake fragment
HS | recv_fragment
HSL| parsed EncryptedExtensions
HSL| parsed Certificate13
HSL| parsed CertificateVerify
HSL| parsed Finished
HSL| end of flight
NGO| Nego.clientComplete_13
NGO| EE: alpn supported_groups 001a 
NGO| Negotiation callback to process application extensions.
@@@@ Nego callback for TLS 1.3 @@@@
Offered extensions:
001b0010000800060568712d3130000a00040002001d001a0003000102
Transport parameters offered:
000102
No application cookie (fist connection).
Adding server transport parameters:
000102
@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
WARNING: chain validation failed, ignoring.
NGO| Certificate & signature 1.3 callback result: valid
KS | ks_client_13_sf hashed_log = 7881863f30f93420479c3fd27ce04395e78a64d697a92badfe5af3a6d28c9d56
KS | application traffic secret[C]:   3262b38da9f47f6c1cbc61d1bb44f17215db6a720276978551e0df8488410d65
KS | application traffic secret[S]:   f10f00c5549b321d20ad041d435cf38b36b8171b61529e90108dd8eedb769f20
KS | exporter master secret:          4261ffb990373fd1fb90c6eb0db6e2b61773484754e4a36f7fb43afa58f65e73
KS | application key[C]:              73e66df57b8f751a0d05900dadc6f89ccf293ba94036e0e2a3e77e0cb5785485, IV=57cd1e48c1cd7c5776766d50
KS | application key[S]:              3bc30dba64442cb0e48b3c34e436498a316df5b8ba59781475df0c20690bc85f, IV=d1ab33c16341545f0ff15a71
AEP| LowProvider: COERCE(K=73e66df57b8f751a0d05900dadc6f89ccf293ba94036e0e2a3e77e0cb5785485)
AEP| LowProvider: COERCE(K=3bc30dba64442cb0e48b3c34e436498a316df5b8ba59781475df0c20690bc85f)
HS | exporting a key
HS | Early data rejected
EPO| writer++ 0/0
HSL| emit Finished and hash
KS | ks_client_13_cf hashed_log = 6dfa8aa6b25f51a6ec781761fdaeb7d5f0ca576598b94a9011070916cd21684f
KS | resumption master secret:        05baa0fb0faf9e3a034e1462845841f8b05421c2278e003e1c0c905ddf643395
EPO| reader++ 1/0
TLS| readOne ReadAgain
TLS| writeHandshake (encrypted)
TLS| HS.next_fragment ID13?
HS | next_fragment
TLS| HS.next_fragment returned a fragment; next_keys (for all data); complete
TLS| sendHandshake
TLS| send Handshake fragment with index ID13
TLS| Encrypting with key 7567768726ae8411c4aa3aec19e355a4be902bd04def81418ad6c0f31a6c5845
TLS| Sending fragment of length 53
REC| record headers: 1703030035
EPO| writer++ 1/1
TLS| read: WrittenHS, Open/Open, new writer: complete
client done clen=  58 slen= 834 status=client_complete
17030300358b686df736dfe6ddf44a9cb9c9eaad36341b7068d7bed6c09d520e
eea59757ce36a8f211944c3ee4234c52b93b0035ce9b336c297a
server call clen=  58 slen=7358
TLS| writeHandshake (encrypted)
TLS| HS.next_fragment ID13?
HS | next_fragment
TLS| HS.next_fragment returned nothing
TLS| sendHandshake
TLS| read: WrittenHS, Ctrl/Open, nothing
TLS| Read fragment at epoch index: 0 of length 53
TLS| StAE decrypt correct.
TLS| read Handshake fragment
HS | recv_fragment
HSL| parsed Finished
HSL| end of flight
HS | Process Client Finished
KS | ks_server_13_cf hashed_log = 6dfa8aa6b25f51a6ec781761fdaeb7d5f0ca576598b94a9011070916cd21684f
KS | resumption master secret:        05baa0fb0faf9e3a034e1462845841f8b05421c2278e003e1c0c905ddf643395
AEP| LowProvider: COERCE(K=c3004a6ec05fa7990e674672587525a3e031036d391ec62377d894904f58dfa9)
HS | Sending ticket: bf38b8207e8bf04604a30907f8c22cdf5cbbc1db3a99b789a0b2e8fe18dff212600fd5da9349975e1b003ad080a034db5f3161fecf166f9e709edf985f50c8c34d37ca8e4ae9f9fe0f260e68
HSL| emit NewSessionTicket13
EPO| reader++ 1/1
TLS| readOne Complete
sender done clen=  58 slen=   0 status=server_complete
=== Exporter secret ===
4261ffb990373fd1fb90c6eb0db6e2b61773484754e4a36f7fb43afa58f65e73
=== QUIC 1-RTT secrets ===
C: 3b0e609ab13797087615184527d70a2f86c578a58b39c1500d2f8dc63b85c12d
S: a5e647a0b513610de048b358f1a32763a495c5d38a84f763ddfb398294e9e796
=== AEAD client key test ===
63e0138df3aea23341a1942893959aff4b1a623f77577c2e46ab86
=== Decrypt successful ===
Ok
./quic.exe 0rtt

INITIAL ECDHE HANDSHAKE (NO EARLY SECRET)

server create
FFI| offering custom extension 001a
FFI| extension contents: ffff00050a0b0c0d0e
FFI| setting early data limit to ffffffff
FFI| Setting a new ticket callback.
FFI| Setting a new server negotiation callback.
FFI| Setting up certificate callbacks.
client create
FFI| offering custom extension 001a
FFI| extension contents: ffff00050a0b0c0d0e
FFI| setting early data limit to ffffffff
FFI| Setting a new ticket callback.
FFI| Setting a new server negotiation callback.
FFI| Setting up certificate callbacks.
TLS| writeHandshake (plaintext)
TLS| HS.next_fragment PlaintextID?
HS | next_fragment
HS | offering ClientHello 1.3
KS | ks_client_init 1.3
CDH| Keygen (initiator) on X255519
NGO| No PSK or 0-RTT disabled
NGO| offering client extensions [ 001a supported_versions key_share server_name alpn extended_master_secret signature_algorithms supported_groups psk_key_exchange_modes ]
NGO| offering cipher suites ; TLS_CHACHA20_POLY1305_SHA256; TLS_AES_128_GCM_SHA256
HSL| emit ClientHello
TLS| HS.next_fragment returned a fragment
TLS| sendHandshake
TLS| send Handshake fragment with index PlaintextID
TLS| Sending fragment of length 170
REC| record headers: 16030300aa
TLS| writeHandshake (plaintext)
TLS| HS.next_fragment PlaintextID?
HS | next_fragment
TLS| HS.next_fragment returned nothing
TLS| sendHandshake
TLS| read: WrittenHS, Ctrl/Ctrl, nothing
REC| WouldBlock
TLS| readOne ReadWouldBlock
client returns would_block clen=175 slen=0
ClientHello[ 175] ---->

TLS| writeHandshake (plaintext)
TLS| HS.next_fragment PlaintextID?
HS | next_fragment
TLS| HS.next_fragment returned nothing
TLS| sendHandshake
TLS| read: WrittenHS, Ctrl/Ctrl, nothing
TLS| Read fragment at epoch index: -1 of length 170
TLS| read Handshake fragment
HS | recv_fragment
HSL| parsed [ClientHello] -- end of flight 
HS | Processing ClientHello
NGO| offered client extensions [ 001a supported_versions key_share server_name alpn extended_master_secret signature_algorithms supported_groups psk_key_exchange_modes ]
NGO| offered cipher suites ; TLS_CHACHA20_POLY1305_SHA256; TLS_AES_128_GCM_SHA256
NGO| offered versions 1.3
NGO| Negotiated Pure EDH key exchange
NGO| Negotiated ECDSA_SECP256R1_SHA256
NGO| Negotiation callback to handle extra extensions and query for stateless retry.
NGO| Application data in cookie: none
@@@@ Nego callback for TLS 1.3 @@@@
Offered extensions:
003d001a0009ffff00050a0b0c0d0e0000000e000c0000096c6f63616c686f73
740010000800060568712d3130000d0006000408040403000a00040002001d
Transport parameters offered:
ffff00050a0b0c0d0e
No application cookie (fist connection).
Adding server transport parameters:
000102
@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
NGO| negotiated 1.3 TLS_CHACHA20_POLY1305_SHA256
KS | ks_server_init
KS | No PSK selected.
KS | Computed early secret:           33ad0a1c607ec03b09e6cd9893680ce210adf300aa1f2660e1b22e10f170f92a
KS | Handshake salt:                  6f2615a108c702c5678f54fc9dbab69716c076189c48250cebeac3576c3611ba
CDH| Keygen (responder) on X255519
CDH| DH initiator on X255519
KS | DH shared secret: 8abf2dabbfd364ad2e0b01e290fb0bbce972ba859f1e8a3c387c7aed28477044
KS | Handshake secret:                3958a022166c2878efccad2617913753676b87e1b47bd795b8ba2ea358094dc2
NGO| processing client extensions [ 001a supported_versions key_share server_name alpn extended_master_secret signature_algorithms supported_groups psk_key_exchange_modes ]
NGO| including server extensions (SH + EE) [ supported_versions key_share alpn supported_groups ]
NGO| extra extensions from application callback: 001a 
HSL| emit ServerHello and hash
HS | derive handshake keys
KS | ks_server_13_sh, hashed log = 8402607f787b822b948a3f91042410bb9e11ed5667d066000f167aa8eeb515a4
KS | handshake traffic secret[C]:     231dc7ebe1294e238fc91530e7fa49358422042c2e0e21243b0dc8a44ff61253
KS | handshake traffic secret[S]:     e22ea962d9c893f5fcdc4e20c3efe9ed5495568ba3fc2043511b5f2fd7162773
KS | handshake key[C]:                42c57189c2bddaa749eabdd887f5a5cdfc205baa98614146ab4d3fbb71e02bdb, IV=a605669a0da83c8e396015fb
KS | handshake key[S]: f4e0844cf2154bff160fc2a2d3ea490618e66fa9ee9aaf7f874bf5895f1fe023, IV=473aaf9a3825b6607b6603dd
AEP| LowProvider: COERCE(K=f4e0844cf2154bff160fc2a2d3ea490618e66fa9ee9aaf7f874bf5895f1fe023)
AEP| LowProvider: COERCE(K=42c57189c2bddaa749eabdd887f5a5cdfc205baa98614146ab4d3fbb71e02bdb)
KS | finished key[C]:                 8cd6eb5ec7ddd9357f8b463a45a9fcf8f3e73192831f1e3e3cd2d913a0b8d186
KS | finished key[S]:                 03caae13dd9a9592c41d61fe4f810bdc346123fa7042fdb95cad175c0aa5a961
KS | Application salt:                2b1b92d91c5d348b1bedcbff9ddea24cc7a7b7a070673c378b5442d5245ceed5
KS | Application secret:              739e50206c1a8670d67a72460bd5b6322cb4cd7694cc058b20510659d28cb0a6
TLS| readOne ReadAgain
TLS| writeHandshake (plaintext)
TLS| HS.next_fragment PlaintextID?
HS | next_fragment
TLS| HS.next_fragment returned a fragment; next_keys (for handshake only
TLS| sendHandshake
TLS| send Handshake fragment with index PlaintextID
TLS| Sending fragment of length 90
REC| record headers: 160303005a
EPO| writer++ -1/0
TLS| writeHandshake (encrypted)
TLS| HS.next_fragment ID13?
HS | next_fragment
HS | prepare Server Finished
HSL| emit EncryptedExtensions
HSL| emit Certificate13 and hash
======== TO BE SIGNED <0403>: (130 octets) ========
2020202020202020202020202020202020202020202020202020202020202020
2020202020202020202020202020202020202020202020202020202020202020
544c5320312e332c207365727665722043657274696669636174655665726966
7900746012a74a3cfeccfaceb8c4919281c2dd730cbeb476011bcd4131ceecc4
b56c
===================================================
HSL| emit CertificateVerify and hash
HSL| emit Finished and hash
KS | ks_server_13_sf hashed_log = d386754b865d99701cb5e77c3827349162669ccef3e97f8b2afb30d7592cc4c6
KS | application traffic secret[C]:   0f9e2b771d1e85b5b4c5b66f0d2a1e11914c17844d5e0f1222a39385cad1a19f
KS | application traffic secret[S]:   2f344077e75a21bae4ae929aaf0209cc14e358788e742ef00e552f0a9730813e
KS | exporter master secret:          30765697c679e0c8a9e686608de5cc9adafcce199ce1874504f0382298c7a3b9
KS | application key[C]:              f82b3897a63999e8dcf8d8400506237f6063c33acb45f062ed4df200e8b0870c, IV=cf814553ac8efdc238848ddb
KS | application key[S]:              0dfd39e241387e49ee72278a3002f8362bf88318e73386b1f626614c06a45506, IV=a01a4e98a5957c757d59b560
AEP| LowProvider: COERCE(K=0dfd39e241387e49ee72278a3002f8362bf88318e73386b1f626614c06a45506)
AEP| LowProvider: COERCE(K=f82b3897a63999e8dcf8d8400506237f6063c33acb45f062ed4df200e8b0870c)
HS | exporting a key
EPO| reader++ 0/0
TLS| HS.next_fragment returned a fragment; next_keys (for all data)
TLS| sendHandshake
TLS| send Handshake fragment with index ID13
TLS| Encrypting with key f4e0844cf2154bff160fc2a2d3ea490618e66fa9ee9aaf7f874bf5895f1fe023
TLS| Sending fragment of length 734
REC| record headers: 17030302de
EPO| writer++ 0/1
TLS| read: WrittenHS, Ctrl/Open, new writer: writable
server returns server_accept clen=175 slen=834
secret=30765697c679e0c8a9e686608de5cc9adafcce199ce1874504f0382298c7a3b9
<---- ServerHello;(EncryptedExtensions; Certificate; CertVerify; Finished)[ 834]

TLS| writeHandshake (plaintext)
TLS| HS.next_fragment PlaintextID?
HS | next_fragment
TLS| HS.next_fragment returned nothing
TLS| sendHandshake
TLS| read: WrittenHS, Ctrl/Ctrl, nothing
TLS| Read fragment at epoch index: -1 of length 90
TLS| read Handshake fragment
HS | recv_fragment
HSL| parsed ServerHello
HSL| end of flight
HS | client_ServerHello
NGO| processing server extensions [ supported_versions key_share ]
NGO| negotiated 1.3 TLS_CHACHA20_POLY1305_SHA256
HS | Running TLS 1.3
KS | ks_client_13_sh hashed_log = 8402607f787b822b948a3f91042410bb9e11ed5667d066000f167aa8eeb515a4
KS | no PSK negotiated. Early secret: 33ad0a1c607ec03b09e6cd9893680ce210adf300aa1f2660e1b22e10f170f92a
KS | handshake salt:                  6f2615a108c702c5678f54fc9dbab69716c076189c48250cebeac3576c3611ba
CDH| DH initiator on X255519
KS | DH shared secret: 8abf2dabbfd364ad2e0b01e290fb0bbce972ba859f1e8a3c387c7aed28477044
KS | handshake secret:                3958a022166c2878efccad2617913753676b87e1b47bd795b8ba2ea358094dc2
KS | handshake traffic secret[C]:     231dc7ebe1294e238fc91530e7fa49358422042c2e0e21243b0dc8a44ff61253
KS | handshake traffic secret[S]:     e22ea962d9c893f5fcdc4e20c3efe9ed5495568ba3fc2043511b5f2fd7162773
KS | handshake key[C]:                42c57189c2bddaa749eabdd887f5a5cdfc205baa98614146ab4d3fbb71e02bdb, IV=a605669a0da83c8e396015fb
KS | handshake key[S]:                f4e0844cf2154bff160fc2a2d3ea490618e66fa9ee9aaf7f874bf5895f1fe023, IV=473aaf9a3825b6607b6603dd
KS | finished key[C]: 8cd6eb5ec7ddd9357f8b463a45a9fcf8f3e73192831f1e3e3cd2d913a0b8d186
KS | finished key[S]: 03caae13dd9a9592c41d61fe4f810bdc346123fa7042fdb95cad175c0aa5a961
KS | application salt:                2b1b92d91c5d348b1bedcbff9ddea24cc7a7b7a070673c378b5442d5245ceed5
KS | application secret:              739e50206c1a8670d67a72460bd5b6322cb4cd7694cc058b20510659d28cb0a6
AEP| LowProvider: COERCE(K=42c57189c2bddaa749eabdd887f5a5cdfc205baa98614146ab4d3fbb71e02bdb)
AEP| LowProvider: COERCE(K=f4e0844cf2154bff160fc2a2d3ea490618e66fa9ee9aaf7f874bf5895f1fe023)
EPO| reader++ 0/-1
TLS| readOne ReadAgain
TLS| writeHandshake (plaintext)
TLS| HS.next_fragment PlaintextID?
HS | next_fragment
TLS| HS.next_fragment returned nothing
TLS| sendHandshake
TLS| read: WrittenHS, Ctrl/Ctrl, nothing
TLS| Read fragment at epoch index: 0 of length 734
TLS| StAE decrypt correct.
TLS| read Handshake fragment
HS | recv_fragment
HSL| parsed EncryptedExtensions
HSL| parsed Certificate13
HSL| parsed CertificateVerify
HSL| parsed Finished
HSL| end of flight
NGO| Nego.clientComplete_13
NGO| EE: alpn supported_groups 001a 
NGO| Negotiation callback to process application extensions.
@@@@ Nego callback for TLS 1.3 @@@@
Offered extensions:
001b0010000800060568712d3130000a00040002001d001a0003000102
Transport parameters offered:
000102
No application cookie (fist connection).
Adding server transport parameters:
000102
@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
WARNING: chain validation failed, ignoring.
NGO| Certificate & signature 1.3 callback result: valid
KS | ks_client_13_sf hashed_log = d386754b865d99701cb5e77c3827349162669ccef3e97f8b2afb30d7592cc4c6
KS | application traffic secret[C]:   0f9e2b771d1e85b5b4c5b66f0d2a1e11914c17844d5e0f1222a39385cad1a19f
KS | application traffic secret[S]:   2f344077e75a21bae4ae929aaf0209cc14e358788e742ef00e552f0a9730813e
KS | exporter master secret:          30765697c679e0c8a9e686608de5cc9adafcce199ce1874504f0382298c7a3b9
KS | application key[C]:              f82b3897a63999e8dcf8d8400506237f6063c33acb45f062ed4df200e8b0870c, IV=cf814553ac8efdc238848ddb
KS | application key[S]:              0dfd39e241387e49ee72278a3002f8362bf88318e73386b1f626614c06a45506, IV=a01a4e98a5957c757d59b560
AEP| LowProvider: COERCE(K=f82b3897a63999e8dcf8d8400506237f6063c33acb45f062ed4df200e8b0870c)
AEP| LowProvider: COERCE(K=0dfd39e241387e49ee72278a3002f8362bf88318e73386b1f626614c06a45506)
HS | exporting a key
HS | Early data rejected
EPO| writer++ 0/0
HSL| emit Finished and hash
KS | ks_client_13_cf hashed_log = 2e7d59412f5c916fb2869bb884495b5f9180a31d15233fbf0e9f943594c97fa0
KS | resumption master secret:        2e4fb4cd1e0dd36f6ea59528e3c10deff65c78b118a1b758b2e83031b41b9054
EPO| reader++ 1/0
TLS| readOne ReadAgain
TLS| writeHandshake (encrypted)
TLS| HS.next_fragment ID13?
HS | next_fragment
TLS| HS.next_fragment returned a fragment; next_keys (for all data); complete
TLS| sendHandshake
TLS| send Handshake fragment with index ID13
TLS| Encrypting with key 42c57189c2bddaa749eabdd887f5a5cdfc205baa98614146ab4d3fbb71e02bdb
TLS| Sending fragment of length 53
REC| record headers: 1703030035
EPO| writer++ 1/1
TLS| read: WrittenHS, Open/Open, new writer: complete
client returns client_complete clen=58 slen=834
secret=30765697c679e0c8a9e686608de5cc9adafcce199ce1874504f0382298c7a3b9
(Finished) [  58] ---->

TLS| writeHandshake (encrypted)
TLS| HS.next_fragment ID13?
HS | next_fragment
TLS| HS.next_fragment returned nothing
TLS| sendHandshake
TLS| read: WrittenHS, Ctrl/Open, nothing
TLS| Read fragment at epoch index: 0 of length 53
TLS| StAE decrypt correct.
TLS| read Handshake fragment
HS | recv_fragment
HSL| parsed Finished
HSL| end of flight
HS | Process Client Finished
KS | ks_server_13_cf hashed_log = 2e7d59412f5c916fb2869bb884495b5f9180a31d15233fbf0e9f943594c97fa0
KS | resumption master secret:        2e4fb4cd1e0dd36f6ea59528e3c10deff65c78b118a1b758b2e83031b41b9054
AEP| LowProvider: COERCE(K=f989a850ba7ad2e739b917cb6f404e509013085aa5d3b109aae478c450972b88)
HS | Sending ticket: e484cece4d722b84e2b2d4504c4e1e5711aab65421f21cb5ee74ffb8208ef0c6191e6b179b73e0fabc5112a22fc5245d478d72d710f847028b9a398b03754d32c50cd2b2aa19fdc6d8941e10
HSL| emit NewSessionTicket13
EPO| reader++ 1/1
TLS| readOne Complete
server returns server_complete clen=58 slen=0
TLS| writeHandshake (encrypted)
TLS| HS.next_fragment ID13?
HS | next_fragment
TLS| HS.next_fragment returned a fragment
TLS| sendHandshake
TLS| send Handshake fragment with index ID13
TLS| Encrypting with key 0dfd39e241387e49ee72278a3002f8362bf88318e73386b1f626614c06a45506
TLS| Sending fragment of length 130
REC| record headers: 1703030082
TLS| writeHandshake (encrypted)
TLS| HS.next_fragment ID13?
HS | next_fragment
TLS| HS.next_fragment returned nothing
TLS| sendHandshake
TLS| read: WrittenHS, Open/Open, nothing
REC| WouldBlock
TLS| readOne ReadWouldBlock
server returns would_block clen=0 slen=135
<---- {Ticket}[ 135]
TLS| writeHandshake (encrypted)
TLS| HS.next_fragment ID13?
HS | next_fragment
TLS| HS.next_fragment returned nothing
TLS| sendHandshake
TLS| read: WrittenHS, Open/Open, nothing
TLS| Read fragment at epoch index: 1 of length 130
TLS| StAE decrypt correct.
TLS| read Handshake fragment
HS | recv_fragment
HSL| parsed NewSessionTicket13
HSL| end of flight
HS | Received ticket: e484cece4d722b84e2b2d4504c4e1e5711aab65421f21cb5ee74ffb8208ef0c6191e6b179b73e0fabc5112a22fc5245d478d72d710f847028b9a398b03754d32c50cd2b2aa19fdc6d8941e10
KS | ks_client_13_rms
KS | Recall RMS: 2e4fb4cd1e0dd36f6ea59528e3c10deff65c78b118a1b758b2e83031b41b9054
AEP| LowProvider: COERCE(K=49e68888cc2676bfa2f0ed2a6026671a703732b05fa610a38ac1d6507df3fc33)

##### New session ticket received! #####
Host: localhost
Ticket:
e484cece4d722b84e2b2d4504c4e1e5711aab65421f21cb5ee74ffb8208ef0c6
191e6b179b73e0fabc5112a22fc5245d478d72d710f847028b9a398b03754d32
c50cd2b2aa19fdc6d8941e10
########################################
TLS| readOne ReadAgain
TLS| writeHandshake (encrypted)
TLS| HS.next_fragment ID13?
HS | next_fragment
TLS| HS.next_fragment returned nothing
TLS| sendHandshake
TLS| read: WrittenHS, Open/Open, nothing
REC| WouldBlock
TLS| readOne ReadWouldBlock
client returns clen=0 slen=135 status=would_block

TICKET-BASED RESUMPTION

server create
FFI| offering custom extension 001a
FFI| extension contents: ffff00050a0b0c0d0e
FFI| setting early data limit to ffffffff
FFI| Setting a new ticket callback.
FFI| Setting a new server negotiation callback.
FFI| Setting up certificate callbacks.
client create
FFI| offering custom extension 001a
FFI| extension contents: ffff00050a0b0c0d0e
FFI| setting early data limit to ffffffff
FFI| Setting a new ticket callback.
FFI| Setting a new server negotiation callback.
FFI| Setting up certificate callbacks.
TCK| Decrypting ticket d23adace7915f409249aab320297e76f28ae4b064c8d59c8e225268d5c595e0e10a51d2041e1b641fbeedcdd6426a8ff9d8f52385d98b562ca3653ad992c07fa280d12c6ee7921f5e0ab9c0b
TCK| Parsing ticket 030413035b22f5db402cf142000000209c74d50970df44775368644c447ed8297480318eeae4cab2c1375f20022fa77c
TLS| writeHandshake (plaintext)
TLS| HS.next_fragment PlaintextID?
HS | next_fragment
HS | offering ClientHello 1.3
KS | ks_client_init 1.3
CDH| Keygen (initiator) on X255519
NGO| Offering a PSK compatible with 0-RTT
NGO| offering client extensions [ 001a supported_versions key_share server_name alpn extended_master_secret signature_algorithms supported_groups psk_key_exchange_modes early_data pre_shared_key ]
NGO| offering cipher suites ; TLS_CHACHA20_POLY1305_SHA256; TLS_AES_128_GCM_SHA256
HSL| emit ClientHello
KS | Loaded pre-shared key e484cece4d722b84e2b2d4504c4e1e5711aab65421f21cb5ee74ffb8208ef0c6191e6b179b73e0fabc5112a22fc5245d478d72d710f847028b9a398b03754d32c50cd2b2aa19fdc6d8941e10: 9c74d50970df44775368644c447ed8297480318eeae4cab2c1375f20022fa77c
KS | Early secret: 43fc05c9cdf70d47bdc95ca83cf309708a5b1a2950549c5d8ba94d413eef09d4
KS | Binder key[res binder]: 8519f09a0569873415ca8c5d35002d1a113e96c0d9e73003b2a2b9967cac5eba
KS | Binder Finished key: ae50919d2fe63bde4ea3acf35cd0b0a7c88f3f2fd011827ff3b0526b0f2a914a
HSL| emit Binders
HS | setting up 0RTT
KS | ks_client_13_ch log=8146803ed09b6b14f8f444bdac4e1741749b13c0c03f6b8334d2fbab451af23d
KS | Client early traffic secret:     c773c6b63583e2ab01bbc1cbd7981188a41df12152ee474efb3bd5628bf52aec
KS | Early exporter master secret:    bd3612b705bfdfe3abff84b07cb507adcf1310e731ac7eed7ebd30326c8d00a8
KS | Client 0-RTT key:                b56e1d4403cfe3550ba70848a7b7e3a440d69da1d2a6e478a4acce9bab318846, IV=41680dea5b8f758853e35a3a
AEP| LowProvider: COERCE(K=b56e1d4403cfe3550ba70848a7b7e3a440d69da1d2a6e478a4acce9bab318846)
HS | exporting a key
TLS| HS.next_fragment returned a fragment; next_keys (for all data)
TLS| sendHandshake
TLS| send Handshake fragment with index PlaintextID
TLS| Sending fragment of length 297
REC| record headers: 1603030129
EPO| writer++ -1/0
TLS| read: WrittenHS, Ctrl/Open, new writer: writable
client returns client_early_data clen=302 slen=0
early secret=bd3612b705bfdfe3abff84b07cb507adcf1310e731ac7eed7ebd30326c8d00a8
ClientHello[ 302] ---->

TLS| writeHandshake (plaintext)
TLS| HS.next_fragment PlaintextID?
HS | next_fragment
TLS| HS.next_fragment returned nothing
TLS| sendHandshake
TLS| read: WrittenHS, Ctrl/Ctrl, nothing
TLS| Read fragment at epoch index: -1 of length 297
TLS| read Handshake fragment
HS | recv_fragment
HSL| parsed [ClientHello; Binders] -- end of flight 
HS | Processing ClientHello with 1 binder(s)
NGO| offered client extensions [ 001a supported_versions key_share server_name alpn extended_master_secret signature_algorithms supported_groups psk_key_exchange_modes early_data pre_shared_key ]
NGO| offered cipher suites ; TLS_CHACHA20_POLY1305_SHA256; TLS_AES_128_GCM_SHA256
NGO| offered versions 1.3
TCK| Decrypting ticket e484cece4d722b84e2b2d4504c4e1e5711aab65421f21cb5ee74ffb8208ef0c6191e6b179b73e0fabc5112a22fc5245d478d72d710f847028b9a398b03754d32c50cd2b2aa19fdc6d8941e10
TCK| Parsing ticket 030413035b22f5db402cf142000000202e4fb4cd1e0dd36f6ea59528e3c10deff65c78b118a1b758b2e83031b41b9054
NGO| Negotiated PSK_EDH key exchange
NGO| Negotiation callback to handle extra extensions and query for stateless retry.
NGO| Application data in cookie: none
@@@@ Nego callback for TLS 1.3 @@@@
Offered extensions:
003d001a0009ffff00050a0b0c0d0e0000000e000c0000096c6f63616c686f73
740010000800060568712d3130000d0006000408040403000a00040002001d
Transport parameters offered:
ffff00050a0b0c0d0e
No application cookie (fist connection).
Adding server transport parameters:
000102
@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
NGO| negotiated 1.3 TLS_CHACHA20_POLY1305_SHA256
HS | accepted TLS 1.3 psk #0
KS | ks_server_init
KS | Using negotiated PSK identity: e484cece4d722b84e2b2d4504c4e1e5711aab65421f21cb5ee74ffb8208ef0c6191e6b179b73e0fabc5112a22fc5245d478d72d710f847028b9a398b03754d32c50cd2b2aa19fdc6d8941e10
TCK| Decrypting ticket e484cece4d722b84e2b2d4504c4e1e5711aab65421f21cb5ee74ffb8208ef0c6191e6b179b73e0fabc5112a22fc5245d478d72d710f847028b9a398b03754d32c50cd2b2aa19fdc6d8941e10
TCK| Parsing ticket 030413035b22f5db402cf142000000202e4fb4cd1e0dd36f6ea59528e3c10deff65c78b118a1b758b2e83031b41b9054
KS | Ticket RMS: 2e4fb4cd1e0dd36f6ea59528e3c10deff65c78b118a1b758b2e83031b41b9054
KS | Pre-shared key: 9c74d50970df44775368644c447ed8297480318eeae4cab2c1375f20022fa77c
KS | binder key:                      8519f09a0569873415ca8c5d35002d1a113e96c0d9e73003b2a2b9967cac5eba
KS | binder Finished key:             ae50919d2fe63bde4ea3acf35cd0b0a7c88f3f2fd011827ff3b0526b0f2a914a
KS | Computed early secret:           43fc05c9cdf70d47bdc95ca83cf309708a5b1a2950549c5d8ba94d413eef09d4
KS | Handshake salt:                  58968714ac75b2a460e506634b75474456f3b0725a74328456766fc71bd7c8e3
CDH| Keygen (responder) on X255519
CDH| DH initiator on X255519
KS | DH shared secret: 849e8a6dc3190a53e987bacec66b6c80811617adb968e0b54263bc8026fbbc01
KS | Handshake secret:                8ea2dd82a23792a88464a30f9db528fa5759399fddc5f21ff76cfb71660186ca
NGO| processing client extensions [ 001a supported_versions key_share server_name alpn extended_master_secret signature_algorithms supported_groups psk_key_exchange_modes early_data pre_shared_key ]
NGO| including server extensions (SH + EE) [ supported_versions key_share alpn supported_groups early_data pre_shared_key ]
NGO| extra extensions from application callback: 001a 
HSL| emit ServerHello and hash
KS | ks_server_13_0rtt_key
KS | Client early traffic secret:     c773c6b63583e2ab01bbc1cbd7981188a41df12152ee474efb3bd5628bf52aec
KS | Early exporter master secret:    bd3612b705bfdfe3abff84b07cb507adcf1310e731ac7eed7ebd30326c8d00a8
KS | Client 0-RTT key:                b56e1d4403cfe3550ba70848a7b7e3a440d69da1d2a6e478a4acce9bab318846, IV=41680dea5b8f758853e35a3a
AEP| LowProvider: COERCE(K=b56e1d4403cfe3550ba70848a7b7e3a440d69da1d2a6e478a4acce9bab318846)
HS | exporting a key
HS | derive handshake keys
KS | ks_server_13_sh, hashed log = 55caf5df23ab2d0b3895a3967b723d8f13c8258d46c94e8079c0764e2feee420
KS | handshake traffic secret[C]:     690f52369340d952e63e4d0522c401d37374cd8ddea397981faa97886e481a70
KS | handshake traffic secret[S]:     c9088d27d46bc088d92b8873e8ed8f0abb5d6470c55c16d492e5004cf2ff30cb
KS | handshake key[C]:                74120cf18724e8b2434d56003e5479d078af8a6ea97ad5ca336bde8a6ce3391a, IV=c32e669cb7c0b36e6853bdbd
KS | handshake key[S]: 12db38284d52223ee70c796f706583e84bca01ab48b63614831ddad81fccfe17, IV=1b265833c4c9ba2498edd17a
AEP| LowProvider: COERCE(K=12db38284d52223ee70c796f706583e84bca01ab48b63614831ddad81fccfe17)
AEP| LowProvider: COERCE(K=74120cf18724e8b2434d56003e5479d078af8a6ea97ad5ca336bde8a6ce3391a)
KS | finished key[C]:                 6ee194928a6794d50ec0b32bc8ad04ed1ae25b66b8fcdfe8e9e742e80a7445bc
KS | finished key[S]:                 03054cc43ed4df681fd93884b0584ef831cb79f2fdb1831389ce0ca80984caeb
KS | Application salt:                bb7e3b0a88990ef224dad1a13cedf65393caff143c9b2fd99abba9474c19279d
KS | Application secret:              cb91344a44b1ef1725e6db263fc9eca91c20b637264dc6f3ce007d5d363bef24
TLS| readOne ReadAgain
TLS| writeHandshake (plaintext)
TLS| HS.next_fragment PlaintextID?
HS | next_fragment
TLS| HS.next_fragment returned a fragment; next_keys (for handshake only skipping 0RTT
TLS| sendHandshake
TLS| send Handshake fragment with index PlaintextID
TLS| Sending fragment of length 96
REC| record headers: 1603030060
EPO| writer++ -1/0
EPO| writer++ -1/1
TLS| writeHandshake (encrypted)
TLS| HS.next_fragment ID13?
HS | next_fragment
HS | prepare Server Finished
HSL| emit EncryptedExtensions and hash
HSL| emit Finished and hash
KS | ks_server_13_sf hashed_log = 4c3ede4789c70ce03d12fd352bad7eea8e1f83bf0f2f3638838ac0637cf52f24
KS | application traffic secret[C]:   c31e8da5b701c62de2ef688ec10b3a54344120989575f47f9b1ef6c47ae8bd55
KS | application traffic secret[S]:   eb34462b3775a9fe2cd9c0fc20c12b4dc6e4626d3567d7b5479113ddd3d3be6a
KS | exporter master secret:          3b9f6d456d1d8909fbb65ab29478c2a4998e144d412017ca664c495586517001
KS | application key[C]:              643f8a094b4df50ecf0eb7f11c71cf177c08620af27164cf24faadfcf5e510aa, IV=2bec4a271e7a46d0f4f6275f
KS | application key[S]:              7fd4f6cf018c889df150198022688b3cd0d62748dc0cd6daf40f3346bb235e40, IV=e43f20d57ea4051b1dc97072
AEP| LowProvider: COERCE(K=7fd4f6cf018c889df150198022688b3cd0d62748dc0cd6daf40f3346bb235e40)
AEP| LowProvider: COERCE(K=643f8a094b4df50ecf0eb7f11c71cf177c08620af27164cf24faadfcf5e510aa)
HS | exporting a key
EPO| reader++ 0/1
TLS| HS.next_fragment returned a fragment; next_keys (for all data)
TLS| sendHandshake
TLS| send Handshake fragment with index ID13
TLS| Encrypting with key 12db38284d52223ee70c796f706583e84bca01ab48b63614831ddad81fccfe17
TLS| Sending fragment of length 90
REC| record headers: 170303005a
EPO| writer++ 0/2
TLS| read: WrittenHS, Ctrl/Open, new writer: writable
server returns server_accept_early_data clen=302 slen=196
early secret=bd3612b705bfdfe3abff84b07cb507adcf1310e731ac7eed7ebd30326c8d00a8
secret=3b9f6d456d1d8909fbb65ab29478c2a4998e144d412017ca664c495586517001
<---- ServerHello;(EncryptedExtensions; Certificate; CertVerify; Finished)[ 196]

TLS| writeHandshake (encrypted)
TLS| HS.next_fragment ID13?
HS | next_fragment
TLS| HS.next_fragment returned nothing
TLS| sendHandshake
TLS| read: WrittenHS, Ctrl/Open, nothing
TLS| Read fragment at epoch index: -1 of length 96
TLS| read Handshake fragment
HS | recv_fragment
HSL| parsed ServerHello
HSL| end of flight
HS | client_ServerHello
NGO| processing server extensions [ supported_versions key_share pre_shared_key ]
NGO| negotiated 1.3 TLS_CHACHA20_POLY1305_SHA256
HS | Running TLS 1.3
KS | ks_client_13_sh hashed_log = 55caf5df23ab2d0b3895a3967b723d8f13c8258d46c94e8079c0764e2feee420
KS | recallPSK early secret:          43fc05c9cdf70d47bdc95ca83cf309708a5b1a2950549c5d8ba94d413eef09d4
KS | handshake salt:                  58968714ac75b2a460e506634b75474456f3b0725a74328456766fc71bd7c8e3
CDH| DH initiator on X255519
KS | DH shared secret: 849e8a6dc3190a53e987bacec66b6c80811617adb968e0b54263bc8026fbbc01
KS | handshake secret:                8ea2dd82a23792a88464a30f9db528fa5759399fddc5f21ff76cfb71660186ca
KS | handshake traffic secret[C]:     690f52369340d952e63e4d0522c401d37374cd8ddea397981faa97886e481a70
KS | handshake traffic secret[S]:     c9088d27d46bc088d92b8873e8ed8f0abb5d6470c55c16d492e5004cf2ff30cb
KS | handshake key[C]:                74120cf18724e8b2434d56003e5479d078af8a6ea97ad5ca336bde8a6ce3391a, IV=c32e669cb7c0b36e6853bdbd
KS | handshake key[S]:                12db38284d52223ee70c796f706583e84bca01ab48b63614831ddad81fccfe17, IV=1b265833c4c9ba2498edd17a
KS | finished key[C]: 6ee194928a6794d50ec0b32bc8ad04ed1ae25b66b8fcdfe8e9e742e80a7445bc
KS | finished key[S]: 03054cc43ed4df681fd93884b0584ef831cb79f2fdb1831389ce0ca80984caeb
KS | application salt:                bb7e3b0a88990ef224dad1a13cedf65393caff143c9b2fd99abba9474c19279d
KS | application secret:              cb91344a44b1ef1725e6db263fc9eca91c20b637264dc6f3ce007d5d363bef24
AEP| LowProvider: COERCE(K=74120cf18724e8b2434d56003e5479d078af8a6ea97ad5ca336bde8a6ce3391a)
AEP| LowProvider: COERCE(K=12db38284d52223ee70c796f706583e84bca01ab48b63614831ddad81fccfe17)
HS | 0RTT potentially accepted (wait for EE to confirm)
EPO| reader++ 0/0
EPO| reader++ 1/0
TLS| readOne ReadAgain
TLS| writeHandshake (encrypted)
TLS| HS.next_fragment ID13?
HS | next_fragment
TLS| HS.next_fragment returned nothing
TLS| sendHandshake
TLS| read: WrittenHS, Ctrl/Open, nothing
TLS| Read fragment at epoch index: 1 of length 90
TLS| StAE decrypt correct.
TLS| read Handshake fragment
HS | recv_fragment
HSL| parsed EncryptedExtensions
HSL| parsed Finished
HSL| end of flight
NGO| Nego.clientComplete_13
NGO| EE: alpn supported_groups early_data 001a 
NGO| Negotiation callback to process application extensions.
@@@@ Nego callback for TLS 1.3 @@@@
Offered extensions:
001b0010000800060568712d3130000a00040002001d001a0003000102
Transport parameters offered:
000102
No application cookie (fist connection).
Adding server transport parameters:
000102
@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
NGO| Certificate & signature 1.3 callback result: valid
KS | ks_client_13_sf hashed_log = 4c3ede4789c70ce03d12fd352bad7eea8e1f83bf0f2f3638838ac0637cf52f24
KS | application traffic secret[C]:   c31e8da5b701c62de2ef688ec10b3a54344120989575f47f9b1ef6c47ae8bd55
KS | application traffic secret[S]:   eb34462b3775a9fe2cd9c0fc20c12b4dc6e4626d3567d7b5479113ddd3d3be6a
KS | exporter master secret:          3b9f6d456d1d8909fbb65ab29478c2a4998e144d412017ca664c495586517001
KS | application key[C]:              643f8a094b4df50ecf0eb7f11c71cf177c08620af27164cf24faadfcf5e510aa, IV=2bec4a271e7a46d0f4f6275f
KS | application key[S]:              7fd4f6cf018c889df150198022688b3cd0d62748dc0cd6daf40f3346bb235e40, IV=e43f20d57ea4051b1dc97072
AEP| LowProvider: COERCE(K=643f8a094b4df50ecf0eb7f11c71cf177c08620af27164cf24faadfcf5e510aa)
AEP| LowProvider: COERCE(K=7fd4f6cf018c889df150198022688b3cd0d62748dc0cd6daf40f3346bb235e40)
HS | exporting a key
HS | Early data accepted; emitting EOED.
HSL| emit EndOfEarlyData and hash
TLS| readOne ReadAgain
TLS| writeHandshake (encrypted)
TLS| HS.next_fragment ID13?
HS | next_fragment
TLS| HS.next_fragment returned a fragment; next_keys (for handshake only
TLS| sendHandshake
TLS| send Handshake fragment with index ID13
TLS| Encrypting with key b56e1d4403cfe3550ba70848a7b7e3a440d69da1d2a6e478a4acce9bab318846
TLS| Sending fragment of length 21
REC| record headers: 1703030015
EPO| writer++ 1/1
TLS| writeHandshake (encrypted)
TLS| HS.next_fragment ID13?
HS | next_fragment
HSL| emit Finished and hash
KS | ks_client_13_cf hashed_log = 0c9fb89421389878cd5cf5e93d90c4a7f830e84a4d9c4ff83db00f470689c1b2
KS | resumption master secret:        538671b38795df214af997bac38c835bcb4058654446ad0e86be84c918039336
EPO| reader++ 2/1
TLS| HS.next_fragment returned a fragment; next_keys (for all data); complete
TLS| sendHandshake
TLS| send Handshake fragment with index ID13
TLS| Encrypting with key 74120cf18724e8b2434d56003e5479d078af8a6ea97ad5ca336bde8a6ce3391a
TLS| Sending fragment of length 53
REC| record headers: 1703030035
EPO| writer++ 2/2
TLS| read: WrittenHS, Open/Open, new writer: complete
client returns client_complete_early_data clen=84 slen=196
secret=3b9f6d456d1d8909fbb65ab29478c2a4998e144d412017ca664c495586517001
(Finished) [  84] ---->

TLS| writeHandshake (encrypted)
TLS| HS.next_fragment ID13?
HS | next_fragment
TLS| HS.next_fragment returned nothing
TLS| sendHandshake
TLS| read: WrittenHS, Ctrl/Open, nothing
TLS| Read fragment at epoch index: 0 of length 21
TLS| StAE decrypt correct.
TLS| read Handshake fragment
HS | recv_fragment
HSL| parsed EndOfEarlyData
HSL| end of flight
HS | Process EOED (increment reader to HS key)
EPO| reader++ 1/2
TLS| readOne ReadAgain
TLS| writeHandshake (encrypted)
TLS| HS.next_fragment ID13?
HS | next_fragment
TLS| HS.next_fragment returned nothing
TLS| sendHandshake
TLS| read: WrittenHS, Ctrl/Open, nothing
TLS| Read fragment at epoch index: 1 of length 53
TLS| StAE decrypt correct.
TLS| read Handshake fragment
HS | recv_fragment
HSL| parsed Finished
HSL| end of flight
HS | Process Client Finished
KS | ks_server_13_cf hashed_log = 0c9fb89421389878cd5cf5e93d90c4a7f830e84a4d9c4ff83db00f470689c1b2
KS | resumption master secret:        538671b38795df214af997bac38c835bcb4058654446ad0e86be84c918039336
HS | Sending ticket: 634051f05ac94b2a82d7f7ba5ba8bc322146a98320e1738dc05c9ee200a822e167bf0c2f4ccc3bfebef03409fc591171025f74adcfd11a63339196ec8d3c8726be8504a2cea06b6f7f3c992a
HSL| emit NewSessionTicket13
EPO| reader++ 2/2
TLS| readOne Complete
server returns clen=84 slen=0 status=server_complete
TLS| writeHandshake (encrypted)
TLS| HS.next_fragment ID13?
HS | next_fragment
TLS| HS.next_fragment returned a fragment
TLS| sendHandshake
TLS| send Handshake fragment with index ID13
TLS| Encrypting with key 7fd4f6cf018c889df150198022688b3cd0d62748dc0cd6daf40f3346bb235e40
TLS| Sending fragment of length 130
REC| record headers: 1703030082
TLS| writeHandshake (encrypted)
TLS| HS.next_fragment ID13?
HS | next_fragment
TLS| HS.next_fragment returned nothing
TLS| sendHandshake
TLS| read: WrittenHS, Open/Open, nothing
REC| WouldBlock
TLS| readOne ReadWouldBlock
server returns would_block clen=0 slen=135
<---- {Ticket}[ 135]
TLS| writeHandshake (encrypted)
TLS| HS.next_fragment ID13?
HS | next_fragment
TLS| HS.next_fragment returned nothing
TLS| sendHandshake
TLS| read: WrittenHS, Open/Open, nothing
TLS| Read fragment at epoch index: 2 of length 130
TLS| StAE decrypt correct.
TLS| read Handshake fragment
HS | recv_fragment
HSL| parsed NewSessionTicket13
HSL| end of flight
HS | Received ticket: 634051f05ac94b2a82d7f7ba5ba8bc322146a98320e1738dc05c9ee200a822e167bf0c2f4ccc3bfebef03409fc591171025f74adcfd11a63339196ec8d3c8726be8504a2cea06b6f7f3c992a
KS | ks_client_13_rms
KS | Recall RMS: 538671b38795df214af997bac38c835bcb4058654446ad0e86be84c918039336

##### New session ticket received! #####
Host: localhost
Ticket:
634051f05ac94b2a82d7f7ba5ba8bc322146a98320e1738dc05c9ee200a822e1
67bf0c2f4ccc3bfebef03409fc591171025f74adcfd11a63339196ec8d3c8726
be8504a2cea06b6f7f3c992a
########################################
TLS| readOne ReadAgain
TLS| writeHandshake (encrypted)
TLS| HS.next_fragment ID13?
HS | next_fragment
TLS| HS.next_fragment returned nothing
TLS| sendHandshake
TLS| read: WrittenHS, Open/Open, nothing
REC| WouldBlock
TLS| readOne ReadWouldBlock
client returns clen=0 slen=135 status=would_block
Ok
./quic.exe hrr

STATELESS RETRY TEST

server create
FFI| offering custom extension 001a
FFI| extension contents: ffff00050a0b0c0d0e
FFI| setting early data limit to ffffffff
FFI| Setting a new ticket callback.
FFI| Setting a new server negotiation callback.
FFI| Setting up certificate callbacks.
client create
FFI| offering custom extension 001a
FFI| extension contents: ffff00050a0b0c0d0e
FFI| setting early data limit to ffffffff
FFI| Setting a new ticket callback.
FFI| Setting a new server negotiation callback.
FFI| Setting up certificate callbacks.
TLS| writeHandshake (plaintext)
TLS| HS.next_fragment PlaintextID?
HS | next_fragment
HS | offering ClientHello 1.3
KS | ks_client_init 1.3
CDH| Keygen (initiator) on X255519
NGO| No PSK or 0-RTT disabled
NGO| offering client extensions [ 001a supported_versions key_share server_name alpn extended_master_secret signature_algorithms supported_groups psk_key_exchange_modes ]
NGO| offering cipher suites ; TLS_CHACHA20_POLY1305_SHA256; TLS_AES_128_GCM_SHA256
HSL| emit ClientHello
TLS| HS.next_fragment returned a fragment
TLS| sendHandshake
TLS| send Handshake fragment with index PlaintextID
TLS| Sending fragment of length 170
REC| record headers: 16030300aa
TLS| writeHandshake (plaintext)
TLS| HS.next_fragment PlaintextID?
HS | next_fragment
TLS| HS.next_fragment returned nothing
TLS| sendHandshake
TLS| read: WrittenHS, Ctrl/Ctrl, nothing
REC| WouldBlock
TLS| readOne ReadWouldBlock
client returns would_block clen=175 slen=0
ClientHello[ 175] ---->

~~~~~~~~~ Client Hello Summary ~~~~~~~~~~~
~ SNI = localhost
~ ALPN = 00060568712d3130
~ Cookie = NULL
~ Extensions = 0079001a0009ffff00050a0b0c0d0e002b0003027f1c003300260024001d0020
f61d77cd6fa8b16ad06c11a50544d8cb65f149513e2c9c2e05ebe279c4c03822
0000000e000c0000096c6f63616c686f73740010000800060568712d31300017
0000000d0006000408040403000a00040002001d002d0003020001
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
TLS| writeHandshake (plaintext)
TLS| HS.next_fragment PlaintextID?
HS | next_fragment
TLS| HS.next_fragment returned nothing
TLS| sendHandshake
TLS| read: WrittenHS, Ctrl/Ctrl, nothing
TLS| Read fragment at epoch index: -1 of length 170
TLS| read Handshake fragment
HS | recv_fragment
HSL| parsed [ClientHello] -- end of flight 
HS | Processing ClientHello
NGO| offered client extensions [ 001a supported_versions key_share server_name alpn extended_master_secret signature_algorithms supported_groups psk_key_exchange_modes ]
NGO| offered cipher suites ; TLS_CHACHA20_POLY1305_SHA256; TLS_AES_128_GCM_SHA256
NGO| offered versions 1.3
NGO| Negotiated Pure EDH key exchange
NGO| Negotiated ECDSA_SECP256R1_SHA256
NGO| Negotiation callback to handle extra extensions and query for stateless retry.
NGO| Application data in cookie: none
@@@@ Nego callback for TLS 1.3 @@@@
Offered extensions:
003d001a0009ffff00050a0b0c0d0e0000000e000c0000096c6f63616c686f73
740010000800060568712d3130000d0006000408040403000a00040002001d
Transport parameters offered:
ffff00050a0b0c0d0e
No application cookie (fist connection).
Adding server transport parameters:
000102
@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
AEP| LowProvider: COERCE(K=2d9d31690c4a5a867dfc13a302e7ca8c271dc5f27542ae9647274a016d54ffee)
TCK| Encrypting cookie: 0000320200002e0303cf21ad74e59a6111be1d8c021e65b891c2a211167abb8c5e079e09e2c8a8339c001303000006002b00027f1c204e786cc1e879ba9bfd914533300ecdc1cd70e66677dd1d9a654ac6143f48da86000b48656c6c6f20576f726c64
TCK| Encrypted cookie:  92d51054d082209cf36251e0977479d303a23f1efc29413b01065643aa9febde4175416ea31d8d9966db812b3f97c64a849b981412d7c72b70eae63b2de972ae375fb79f69978b488ede87451d597bff4800f23112dbe2bab6cab5b8bb2074015186e7dc044bf801a96ef769fc64c762d487f3ac68fec62037a56060296fb2
HSL| emit HelloRetryRequest
TLS| readOne ReadAgain
TLS| writeHandshake (plaintext)
TLS| HS.next_fragment PlaintextID?
HS | next_fragment
TLS| HS.next_fragment returned a fragment
TLS| sendHandshake
TLS| send Handshake fragment with index PlaintextID
TLS| Sending fragment of length 183
REC| record headers: 16030300b7
TLS| writeHandshake (plaintext)
TLS| HS.next_fragment PlaintextID?
HS | next_fragment
TLS| HS.next_fragment returned nothing
TLS| sendHandshake
TLS| read: WrittenHS, Ctrl/Ctrl, nothing
REC| WouldBlock
TLS| readOne ReadWouldBlock
server returns server_stateless_retry clen=175 slen=188
<---- HRR[ 188]

server re-create
FFI| offering custom extension 001a
FFI| extension contents: ffff00050a0b0c0d0e
FFI| setting early data limit to ffffffff
FFI| Setting a new ticket callback.
FFI| Setting a new server negotiation callback.
FFI| Setting up certificate callbacks.
TLS| writeHandshake (plaintext)
TLS| HS.next_fragment PlaintextID?
HS | next_fragment
TLS| HS.next_fragment returned nothing
TLS| sendHandshake
TLS| read: WrittenHS, Ctrl/Ctrl, nothing
TLS| Read fragment at epoch index: -1 of length 183
TLS| read Handshake fragment
HS | recv_fragment
HSL| parsed HelloRetryRequest
HSL| end of flight
HSL| Replacing CH1 in transcript with fe0000204e786cc1e879ba9bfd914533300ecdc1cd70e66677dd1d9a654ac6143f48da86
HSL| HRR bytes: 020000b30303cf21ad74e59a6111be1d8c021e65b891c2a211167abb8c5e079e09e2c8a8339c00130300008b002c0081007f92d51054d082209cf36251e0977479d303a23f1efc29413b01065643aa9febde4175416ea31d8d9966db812b3f97c64a849b981412d7c72b70eae63b2de972ae375fb79f69978b488ede87451d597bff4800f23112dbe2bab6cab5b8bb2074015186e7dc044bf801a96ef769fc64c762d487f3ac68fec62037a56060296fb2002b00027f1c
HS | client_HelloRetryRequest
HS | Server did not specify a group in HRR, re-using the previous choice
NGO| Got HRR, extensions: [cookie supported_versions ]
HSL| emit ClientHello
TLS| readOne ReadAgain
TLS| writeHandshake (plaintext)
TLS| HS.next_fragment PlaintextID?
HS | next_fragment
TLS| HS.next_fragment returned a fragment
TLS| sendHandshake
TLS| send Handshake fragment with index PlaintextID
TLS| Sending fragment of length 303
REC| record headers: 160303012f
TLS| writeHandshake (plaintext)
TLS| HS.next_fragment PlaintextID?
HS | next_fragment
TLS| HS.next_fragment returned nothing
TLS| sendHandshake
TLS| read: WrittenHS, Ctrl/Ctrl, nothing
REC| WouldBlock
TLS| readOne ReadWouldBlock
client returns would_block clen=308 slen=188
ClientHello2[ 308] ---->

TCK| Decrypting cookie 92d51054d082209cf36251e0977479d303a23f1efc29413b01065643aa9febde4175416ea31d8d9966db812b3f97c64a849b981412d7c72b70eae63b2de972ae375fb79f69978b488ede87451d597bff4800f23112dbe2bab6cab5b8bb2074015186e7dc044bf801a96ef769fc64c762d487f3ac68fec62037a56060296fb2
TCK| Plain cookie: 0000320200002e0303cf21ad74e59a6111be1d8c021e65b891c2a211167abb8c5e079e09e2c8a8339c001303000006002b00027f1c204e786cc1e879ba9bfd914533300ecdc1cd70e66677dd1d9a654ac6143f48da86000b48656c6c6f20576f726c64
~~~~~~~~~ Client Hello Summary ~~~~~~~~~~~
~ SNI = localhost
~ ALPN = 00060568712d3130
~ Cookie = 48656c6c6f20576f726c64
~ Extensions = 00fe002c0081007f92d51054d082209cf36251e0977479d303a23f1efc29413b
01065643aa9febde4175416ea31d8d9966db812b3f97c64a849b981412d7c72b
70eae63b2de972ae375fb79f69978b488ede87451d597bff4800f23112dbe2ba
b6cab5b8bb2074015186e7dc044bf801a96ef769fc64c762d487f3ac68fec620
37a56060296fb2001a0009ffff00050a0b0c0d0e002b0003027f1c0033002600
24001d0020f61d77cd6fa8b16ad06c11a50544d8cb65f149513e2c9c2e05ebe2
79c4c038220000000e000c0000096c6f63616c686f7374001000080006056871
2d313000170000000d0006000408040403000a00040002001d002d0003020001
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
TLS| writeHandshake (plaintext)
TLS| HS.next_fragment PlaintextID?
HS | next_fragment
TLS| HS.next_fragment returned nothing
TLS| sendHandshake
TLS| read: WrittenHS, Ctrl/Ctrl, nothing
TLS| Read fragment at epoch index: -1 of length 303
TLS| read Handshake fragment
HS | recv_fragment
HSL| parsed [ClientHello] -- end of flight 
HS | Processing ClientHello
NGO| offered client extensions [ cookie 001a supported_versions key_share server_name alpn extended_master_secret signature_algorithms supported_groups psk_key_exchange_modes ]
NGO| offered cipher suites ; TLS_CHACHA20_POLY1305_SHA256; TLS_AES_128_GCM_SHA256
NGO| offered versions 1.3
NGO| Negotiated Pure EDH key exchange
NGO| Negotiated ECDSA_SECP256R1_SHA256
TCK| Decrypting cookie 92d51054d082209cf36251e0977479d303a23f1efc29413b01065643aa9febde4175416ea31d8d9966db812b3f97c64a849b981412d7c72b70eae63b2de972ae375fb79f69978b488ede87451d597bff4800f23112dbe2bab6cab5b8bb2074015186e7dc044bf801a96ef769fc64c762d487f3ac68fec62037a56060296fb2
TCK| Plain cookie: 0000320200002e0303cf21ad74e59a6111be1d8c021e65b891c2a211167abb8c5e079e09e2c8a8339c001303000006002b00027f1c204e786cc1e879ba9bfd914533300ecdc1cd70e66677dd1d9a654ac6143f48da86000b48656c6c6f20576f726c64
NGO| Loaded stateless retry cookie 92d51054d082209cf36251e0977479d303a23f1efc29413b01065643aa9febde4175416ea31d8d9966db812b3f97c64a849b981412d7c72b70eae63b2de972ae375fb79f69978b488ede87451d597bff4800f23112dbe2bab6cab5b8bb2074015186e7dc044bf801a96ef769fc64c762d487f3ac68fec62037a56060296fb2
NGO| Overwriting the transcript digest with CH1 hash 4e786cc1e879ba9bfd914533300ecdc1cd70e66677dd1d9a654ac6143f48da86
HSL| Installing prefix to transcript: fe0000204e786cc1e879ba9bfd914533300ecdc1cd70e66677dd1d9a654ac6143f48da86
HSL| HRR bytes: 020000b30303cf21ad74e59a6111be1d8c021e65b891c2a211167abb8c5e079e09e2c8a8339c00130300008b002c0081007f92d51054d082209cf36251e0977479d303a23f1efc29413b01065643aa9febde4175416ea31d8d9966db812b3f97c64a849b981412d7c72b70eae63b2de972ae375fb79f69978b488ede87451d597bff4800f23112dbe2bab6cab5b8bb2074015186e7dc044bf801a96ef769fc64c762d487f3ac68fec62037a56060296fb2002b00027f1c
NGO| Negotiation callback to handle extra extensions and query for stateless retry.
NGO| Application data in cookie: 48656c6c6f20576f726c64
@@@@ Nego callback for TLS 1.3 @@@@
Offered extensions:
003d001a0009ffff00050a0b0c0d0e0000000e000c0000096c6f63616c686f73
740010000800060568712d3130000d0006000408040403000a00040002001d
Transport parameters offered:
ffff00050a0b0c0d0e
Stateless cookie found, application contents:
48656c6c6f20576f726c64
Adding server transport parameters:
000102
@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
NGO| negotiated 1.3 TLS_CHACHA20_POLY1305_SHA256
KS | ks_server_init
KS | No PSK selected.
KS | Computed early secret:           33ad0a1c607ec03b09e6cd9893680ce210adf300aa1f2660e1b22e10f170f92a
KS | Handshake salt:                  6f2615a108c702c5678f54fc9dbab69716c076189c48250cebeac3576c3611ba
CDH| Keygen (responder) on X255519
CDH| DH initiator on X255519
KS | DH shared secret: 456ca1b1b1955d32e66740f7b8730f805ec88589092ccb52009b24b7b4fbb513
KS | Handshake secret:                388a4f2da4105ecdb2a9c921ba76d0cc428918a652042ce22d770c3d3b838aaa
NGO| processing client extensions [ cookie 001a supported_versions key_share server_name alpn extended_master_secret signature_algorithms supported_groups psk_key_exchange_modes ]
NGO| including server extensions (SH + EE) [ supported_versions key_share alpn supported_groups ]
NGO| extra extensions from application callback: 001a 
HSL| emit ServerHello and hash
HS | derive handshake keys
KS | ks_server_13_sh, hashed log = 48c6ccbbbd0d2524a32981c9ad8a353438fcfd483940a45f7b244968d612fb34
KS | handshake traffic secret[C]:     942e0753bb23abc196d937ecc8e80e314afdb549db50159e37908fcc14130acd
KS | handshake traffic secret[S]:     e91857b8bd77aa153ae224980486d80a0da58d4fd61735def4da09b101bc2c73
KS | handshake key[C]:                b342341ccb050b8a09b7f74495c8a972f9977ac55a87e5c05711d3f9dff2fa4c, IV=75fd8007dd95cfe1f231d4b1
KS | handshake key[S]: 53173a0c55c3c68cec9f76548834a23608fe0d570cd857d0eb0be3b91c1eaca7, IV=f2c793990f89b9f74fc9ad18
AEP| LowProvider: COERCE(K=53173a0c55c3c68cec9f76548834a23608fe0d570cd857d0eb0be3b91c1eaca7)
AEP| LowProvider: COERCE(K=b342341ccb050b8a09b7f74495c8a972f9977ac55a87e5c05711d3f9dff2fa4c)
KS | finished key[C]:                 e6196b222c6a2c6e8275bd79aa7c9e6aa9099d4d075e37458b51759a2ccfda2f
KS | finished key[S]:                 073824169ec1361f95c90e1839d5b563bb846c8ee3fe835039489b77a66db11e
KS | Application salt:                1f0c1a460e9b48db444263ab3d40915761013a104938a4dc708a1033a3ffaa2d
KS | Application secret:              baf50b1b6a01a60c16ee68532ec248be63f939ba19187bb4c517f6754871c216
TLS| readOne ReadAgain
TLS| writeHandshake (plaintext)
TLS| HS.next_fragment PlaintextID?
HS | next_fragment
TLS| HS.next_fragment returned a fragment; next_keys (for handshake only
TLS| sendHandshake
TLS| send Handshake fragment with index PlaintextID
TLS| Sending fragment of length 90
REC| record headers: 160303005a
EPO| writer++ -1/0
TLS| writeHandshake (encrypted)
TLS| HS.next_fragment ID13?
HS | next_fragment
HS | prepare Server Finished
HSL| emit EncryptedExtensions
HSL| emit Certificate13 and hash
======== TO BE SIGNED <0403>: (130 octets) ========
2020202020202020202020202020202020202020202020202020202020202020
2020202020202020202020202020202020202020202020202020202020202020
544c5320312e332c207365727665722043657274696669636174655665726966
7900478c4b4e81d586c3b4fba74631fa217121cc0704b2fc24dbfc88368fb4f1
946d
===================================================
HSL| emit CertificateVerify and hash
HSL| emit Finished and hash
KS | ks_server_13_sf hashed_log = 22be3577457292b89bee7d9960ae32f2f6a4b6cb4694b059379661edfc8c4a2e
KS | application traffic secret[C]:   0cf852be32212a815b41296aef54b10cbe7437780adef4e222ea51a74cf3d697
KS | application traffic secret[S]:   1144086527d1ebaab44a4bd2bf3c7ede385e834a3cfe7cf40618a57a04c531e6
KS | exporter master secret:          9abd584f1c0635be2a58e6a0cf87f85e2ba1eec5adc95ccea156982139436535
KS | application key[C]:              0637b1d4feaffceee2ff68e2127ce6e99fe81278cebc7236f96261652733bb30, IV=0abe098fe85ae8b37f46ad5b
KS | application key[S]:              6b2a02b995158fcffda259cf5abbad78bed6d182362274b2e3150eba91369daf, IV=76cfc1fb1bb7aabfeba5a831
AEP| LowProvider: COERCE(K=6b2a02b995158fcffda259cf5abbad78bed6d182362274b2e3150eba91369daf)
AEP| LowProvider: COERCE(K=0637b1d4feaffceee2ff68e2127ce6e99fe81278cebc7236f96261652733bb30)
HS | exporting a key
EPO| reader++ 0/0
TLS| HS.next_fragment returned a fragment; next_keys (for all data)
TLS| sendHandshake
TLS| send Handshake fragment with index ID13
TLS| Encrypting with key 53173a0c55c3c68cec9f76548834a23608fe0d570cd857d0eb0be3b91c1eaca7
TLS| Sending fragment of length 735
REC| record headers: 17030302df
EPO| writer++ 0/1
TLS| read: WrittenHS, Ctrl/Open, new writer: writable
server returns server_accept clen=308 slen=835
secret=9abd584f1c0635be2a58e6a0cf87f85e2ba1eec5adc95ccea156982139436535
<---- ServerHello;(EncryptedExtensions; Certificate; CertVerify; Finished)[ 835]

TLS| writeHandshake (plaintext)
TLS| HS.next_fragment PlaintextID?
HS | next_fragment
TLS| HS.next_fragment returned nothing
TLS| sendHandshake
TLS| read: WrittenHS, Ctrl/Ctrl, nothing
TLS| Read fragment at epoch index: -1 of length 90
TLS| read Handshake fragment
HS | recv_fragment
HSL| parsed ServerHello
HSL| end of flight
HS | client_ServerHello
NGO| processing server extensions [ supported_versions key_share ]
NGO| negotiated 1.3 TLS_CHACHA20_POLY1305_SHA256
HS | Running TLS 1.3
KS | ks_client_13_sh hashed_log = 48c6ccbbbd0d2524a32981c9ad8a353438fcfd483940a45f7b244968d612fb34
KS | no PSK negotiated. Early secret: 33ad0a1c607ec03b09e6cd9893680ce210adf300aa1f2660e1b22e10f170f92a
KS | handshake salt:                  6f2615a108c702c5678f54fc9dbab69716c076189c48250cebeac3576c3611ba
CDH| DH initiator on X255519
KS | DH shared secret: 456ca1b1b1955d32e66740f7b8730f805ec88589092ccb52009b24b7b4fbb513
KS | handshake secret:                388a4f2da4105ecdb2a9c921ba76d0cc428918a652042ce22d770c3d3b838aaa
KS | handshake traffic secret[C]:     942e0753bb23abc196d937ecc8e80e314afdb549db50159e37908fcc14130acd
KS | handshake traffic secret[S]:     e91857b8bd77aa153ae224980486d80a0da58d4fd61735def4da09b101bc2c73
KS | handshake key[C]:                b342341ccb050b8a09b7f74495c8a972f9977ac55a87e5c05711d3f9dff2fa4c, IV=75fd8007dd95cfe1f231d4b1
KS | handshake key[S]:                53173a0c55c3c68cec9f76548834a23608fe0d570cd857d0eb0be3b91c1eaca7, IV=f2c793990f89b9f74fc9ad18
KS | finished key[C]: e6196b222c6a2c6e8275bd79aa7c9e6aa9099d4d075e37458b51759a2ccfda2f
KS | finished key[S]: 073824169ec1361f95c90e1839d5b563bb846c8ee3fe835039489b77a66db11e
KS | application salt:                1f0c1a460e9b48db444263ab3d40915761013a104938a4dc708a1033a3ffaa2d
KS | application secret:              baf50b1b6a01a60c16ee68532ec248be63f939ba19187bb4c517f6754871c216
AEP| LowProvider: COERCE(K=b342341ccb050b8a09b7f74495c8a972f9977ac55a87e5c05711d3f9dff2fa4c)
AEP| LowProvider: COERCE(K=53173a0c55c3c68cec9f76548834a23608fe0d570cd857d0eb0be3b91c1eaca7)
EPO| reader++ 0/-1
TLS| readOne ReadAgain
TLS| writeHandshake (plaintext)
TLS| HS.next_fragment PlaintextID?
HS | next_fragment
TLS| HS.next_fragment returned nothing
TLS| sendHandshake
TLS| read: WrittenHS, Ctrl/Ctrl, nothing
TLS| Read fragment at epoch index: 0 of length 735
TLS| StAE decrypt correct.
TLS| read Handshake fragment
HS | recv_fragment
HSL| parsed EncryptedExtensions
HSL| parsed Certificate13
HSL| parsed CertificateVerify
HSL| parsed Finished
HSL| end of flight
NGO| Nego.clientComplete_13
NGO| EE: alpn supported_groups 001a 
NGO| Negotiation callback to process application extensions.
@@@@ Nego callback for TLS 1.3 @@@@
Offered extensions:
001b0010000800060568712d3130000a00040002001d001a0003000102
Transport parameters offered:
000102
No application cookie (fist connection).
Adding server transport parameters:
000102
@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
WARNING: chain validation failed, ignoring.
NGO| Certificate & signature 1.3 callback result: valid
KS | ks_client_13_sf hashed_log = 22be3577457292b89bee7d9960ae32f2f6a4b6cb4694b059379661edfc8c4a2e
KS | application traffic secret[C]:   0cf852be32212a815b41296aef54b10cbe7437780adef4e222ea51a74cf3d697
KS | application traffic secret[S]:   1144086527d1ebaab44a4bd2bf3c7ede385e834a3cfe7cf40618a57a04c531e6
KS | exporter master secret:          9abd584f1c0635be2a58e6a0cf87f85e2ba1eec5adc95ccea156982139436535
KS | application key[C]:              0637b1d4feaffceee2ff68e2127ce6e99fe81278cebc7236f96261652733bb30, IV=0abe098fe85ae8b37f46ad5b
KS | application key[S]:              6b2a02b995158fcffda259cf5abbad78bed6d182362274b2e3150eba91369daf, IV=76cfc1fb1bb7aabfeba5a831
AEP| LowProvider: COERCE(K=0637b1d4feaffceee2ff68e2127ce6e99fe81278cebc7236f96261652733bb30)
AEP| LowProvider: COERCE(K=6b2a02b995158fcffda259cf5abbad78bed6d182362274b2e3150eba91369daf)
HS | exporting a key
HS | Early data rejected
EPO| writer++ 0/0
HSL| emit Finished and hash
KS | ks_client_13_cf hashed_log = c7a8d28b319414b1936a4831ddcad4166ca8c653c18e1acd85127ddf9e9afae8
KS | resumption master secret:        5630edbedc8b787fec1af873ddc33302d622a6b79c82ba013451a8035d9f4772
EPO| reader++ 1/0
TLS| readOne ReadAgain
TLS| writeHandshake (encrypted)
TLS| HS.next_fragment ID13?
HS | next_fragment
TLS| HS.next_fragment returned a fragment; next_keys (for all data); complete
TLS| sendHandshake
TLS| send Handshake fragment with index ID13
TLS| Encrypting with key b342341ccb050b8a09b7f74495c8a972f9977ac55a87e5c05711d3f9dff2fa4c
TLS| Sending fragment of length 53
REC| record headers: 1703030035
EPO| writer++ 1/1
TLS| read: WrittenHS, Open/Open, new writer: complete
client returns client_complete clen=58 slen=835
secret=9abd584f1c0635be2a58e6a0cf87f85e2ba1eec5adc95ccea156982139436535
(Finished) [  58] ---->

TLS| writeHandshake (encrypted)
TLS| HS.next_fragment ID13?
HS | next_fragment
TLS| HS.next_fragment returned nothing
TLS| sendHandshake
TLS| read: WrittenHS, Ctrl/Open, nothing
TLS| Read fragment at epoch index: 0 of length 53
TLS| StAE decrypt correct.
TLS| read Handshake fragment
HS | recv_fragment
HSL| parsed Finished
HSL| end of flight
HS | Process Client Finished
KS | ks_server_13_cf hashed_log = c7a8d28b319414b1936a4831ddcad4166ca8c653c18e1acd85127ddf9e9afae8
KS | resumption master secret:        5630edbedc8b787fec1af873ddc33302d622a6b79c82ba013451a8035d9f4772
HS | Sending ticket: 09c7d930980c72d87275e70b08a3926b1be28a3d2b05afb6c7e7dc60378296b58e61f1f000d8014491ab5b58099699c10bf61bc9d5503aa0ccc61e678b62414c82ef920252e242c0d6566191
HSL| emit NewSessionTicket13
EPO| reader++ 1/1
TLS| readOne Complete
server returns server_complete clen=58 slen=0
TLS| writeHandshake (encrypted)
TLS| HS.next_fragment ID13?
HS | next_fragment
TLS| HS.next_fragment returned a fragment
TLS| sendHandshake
TLS| send Handshake fragment with index ID13
TLS| Encrypting with key 6b2a02b995158fcffda259cf5abbad78bed6d182362274b2e3150eba91369daf
TLS| Sending fragment of length 130
REC| record headers: 1703030082
TLS| writeHandshake (encrypted)
TLS| HS.next_fragment ID13?
HS | next_fragment
TLS| HS.next_fragment returned nothing
TLS| sendHandshake
TLS| read: WrittenHS, Open/Open, nothing
REC| WouldBlock
TLS| readOne ReadWouldBlock
server returns would_block clen=0 slen=135
<---- {Ticket}[ 135]
TLS| writeHandshake (encrypted)
TLS| HS.next_fragment ID13?
HS | next_fragment
TLS| HS.next_fragment returned nothing
TLS| sendHandshake
TLS| read: WrittenHS, Open/Open, nothing
TLS| Read fragment at epoch index: 1 of length 130
TLS| StAE decrypt correct.
TLS| read Handshake fragment
HS | recv_fragment
HSL| parsed NewSessionTicket13
HSL| end of flight
HS | Received ticket: 09c7d930980c72d87275e70b08a3926b1be28a3d2b05afb6c7e7dc60378296b58e61f1f000d8014491ab5b58099699c10bf61bc9d5503aa0ccc61e678b62414c82ef920252e242c0d6566191
KS | ks_client_13_rms
KS | Recall RMS: 5630edbedc8b787fec1af873ddc33302d622a6b79c82ba013451a8035d9f4772
AEP| LowProvider: COERCE(K=3587bd43daef194a681ea9e40b1cc32b179545edee65336a16ba2b09b70551c1)

##### New session ticket received! #####
Host: localhost
Ticket:
09c7d930980c72d87275e70b08a3926b1be28a3d2b05afb6c7e7dc60378296b5
8e61f1f000d8014491ab5b58099699c10bf61bc9d5503aa0ccc61e678b62414c
82ef920252e242c0d6566191
########################################
TLS| readOne ReadAgain
TLS| writeHandshake (encrypted)
TLS| HS.next_fragment ID13?
HS | next_fragment
TLS| HS.next_fragment returned nothing
TLS| sendHandshake
TLS| read: WrittenHS, Open/Open, nothing
REC| WouldBlock
TLS| readOne ReadWouldBlock
client returns clen=0 slen=135 status=would_block
Ok
================================================================================
