This is /home/everbld/everest-ci/ci
Working directory: /cygdrive/c/build/agent2/_work/12/s
About to run: ./everest --yes -windows -j 16 test
BUILD_SOURCEBRANCHNAME: quic2c
BUILD_DEFINITIONNAME: Everest-CI-Windows-fnouint128
BUILD_BUILDID: 20053
DEFINITIONNAME:
Z3 is /home/everbld/everest/z3-4.5.1.1f29cebd4df6-x64-win/bin/z3
# Switching to the everest directory ... now in /cygdrive/c/build/agent2/_work/12/s

exported FSTAR_HOME=C:/build/agent2/_work/12/s/FStar
exported OPENSSL_HOME=C:/build/agent2/_work/12/s/MLCrypto/openssl
exported KREMLIN_HOME=C:/build/agent2/_work/12/s/kremlin
exported VALE_HOME=C:/build/agent2/_work/12/s/vale
exported HACL_HOME=C:/build/agent2/_work/12/s/hacl-star
exported MLCRYPTO_HOME=C:/build/agent2/_work/12/s/MLCrypto
exported PATH=/cygdrive/c/build/agent2/_work/12/s/MLCrypto/openssl:/cygdrive/c/build/agent2/_work/12/s/FStar/bin:/cygdrive/c/build/agent2/_work/12/s/kremlin:/home/everbld/.opam/4.05.0+mingw64c/bin:/cygdrive/c/Windows/Microsoft.NET/Framework64/v4.0.30319/:/home/everbld/everest/nuget/bin:/home/everbld/everest/z3-4.5.1.1f29cebd4df6-x64-win/bin:/cygdrive/c/PROGRA~2/MICROS~1.0/VC/bin/amd64:/cygdrive/c/PROGRA~2/MICROS~1.0/VC/bin:/cygdrive/c/PROGRA~2/MICROS~4/F#/4.0/FRAMEW~1/v4.0/:/usr/x86_64-w64-mingw32/sys-root/mingw/bin:/usr/local/bin:/usr/bin:/cygdrive/c/build/agent2/externals/git/cmd:/cygdrive/c/Python36/Scripts:/cygdrive/c/Python36:/cygdrive/c/Docker/Resources/bin:/cygdrive/c/windows/system32:/cygdrive/c/windows:/cygdrive/c/windows/System32/Wbem:/cygdrive/c/windows/System32/WindowsPowerShell/v1.0:/cygdrive/c/Users/everbld/AppData/Local/Microsoft/WindowsApps:/cygdrive/c/Program Files/Docker/Docker/resources/bin:%USERPROFILE%/.dnx/bin:/cygdrive/c/Program Files/Microsoft DNX/Dnvm:/cygdrive/c/Program Files/Microsoft SQL Server/120/Tools/Binn:/cygdrive/c/Program Files/Microsoft SQL Server/130/Tools/Binn:/cygdrive/c/Program Files/dotnet:/cygdrive/c/Program Files/nodejs:/usr/bin:/cygdrive/c/Program Files/Git/mingw64/bin:/cygdrive/c/Users/everbld/AppData/Roaming/npm:/cygdrive/c/build/agent2/bin:/cygdrive/c/build/agent2/bin
+ hacl-star/secure_api/out/vale_aes_concrete_id/krml-test.exe
================================================================================
Running tests (commands shown below)
test()
[test] expected output cipher is d31a8d34648e60db7b86afbc53ef7ec2a4aded51296e08fea9e2b5a736ee62d63dbea45e8ca9671282fafb69da92728b1a71de0a9e060b2905d6a5b67ecd3b3692ddbd7f2d778b8c9803aee328091b58fab324e4fad675945585808b4831d7bc3ff4def08e4b7a9de576d26586cec64b61161ae10b594f09e26a7e902ecbd0600691
+ hacl-star/secure_api/out/hacl_aes_concrete_id/krml-test.exe
[test] computed output cipher is d31a8d34648e60db7b86afbc53ef7ec2a4aded51296e08fea9e2b5a736ee62d63dbea45e8ca9671282fafb69da92728b1a71de0a9e060b2905d6a5b67ecd3b3692ddbd7f2d778b8c9803aee328091b58fab324e4fad675945585808b4831d7bc3ff4def08e4b7a9de576d26586cec64b61161ae10b594f09e26a7e902ecbd0600691
[test] cipher is a success
[test] expected output decryption is 4c616469657320616e642047656e746c656d656e206f662074686520636c617373206f66202739393a204966204920636f756c64206f6666657220796f75206f6e6c79206f6e652074697020666f7220746865206675747572652c2073756e73637265656e20776f756c642062652069742e
[test] computed output decryption is 4c616469657320616e642047656e746c656d656e206f662074686520636c617373206f66202739393a204966204920636f756c64206f6666657220796f75206f6e6c79206f6e652074697020666f7220746865206675747572652c2073756e73637265656e20776f756c642062652069742e
[test] decryption is a success
test_aes_gcm_0()
[test] expected output cipher is 58e2fccefa7e3061367f1d57a4e7455a
[test] computed output cipher is 58e2fccefa7e3061367f1d57a4e7455a
[test] cipher is a success
[test] expected output decryption is 
[test] computed output decryption is 
[test] decryption is a success
+ make -C hacl-star/secure_api -f Makefile.extract test
test_aes_gcm_1()
[test] expected output cipher is 530f8afbc74536b9a963b4f1c4cb738b
[test] computed output cipher is 530f8afbc74536b9a963b4f1c4cb738b
[test] cipher is a success
[test] expected output decryption is 
[test] computed output decryption is 
[test] decryption is a success
test_aes_gcm_2()
[test] expected output cipher is cea7403d4d606b6e074ec5d3baf39d18d0d1c8a799996bf0265b98b5d48ab919
[test] computed output cipher is cea7403d4d606b6e074ec5d3baf39d18d0d1c8a799996bf0265b98b5d48ab919
[test] cipher is a success
[test] expected output decryption is 00000000000000000000000000000000
[test] computed output decryption is 00000000000000000000000000000000
[test] decryption is a success
test_aes_gcm_3()
[test] expected output cipher is 522dc1f099567d07f47f37a32a84427d643a8cdcbfe5c0c97598a2bd2555d1aa8cb08e48590dbb3da7b08b1056828838c5f61e6393ba7a0abcc9f662898015adb094dac5d93471bdec1a502270e3cc6c
[test] computed output cipher is 522dc1f099567d07f47f37a32a84427d643a8cdcbfe5c0c97598a2bd2555d1aa8cb08e48590dbb3da7b08b1056828838c5f61e6393ba7a0abcc9f662898015adb094dac5d93471bdec1a502270e3cc6c
[test] cipher is a success
[test] expected output decryption is d9313225f88406e5a55909c5aff5269a86a7a9531534f7da2e4c303d8a318a721c3c0c95956809532fcf0e2449a6b525b16aedf5aa0de657ba637b391aafd255
[test] computed output decryption is d9313225f88406e5a55909c5aff5269a86a7a9531534f7da2e4c303d8a318a721c3c0c95956809532fcf0e2449a6b525b16aedf5aa0de657ba637b391aafd255
[test] decryption is a success
test_aes_gcm_4()
[test] expected output cipher is 522dc1f099567d07f47f37a32a84427d643a8cdcbfe5c0c97598a2bd2555d1aa8cb08e48590dbb3da7b08b1056828838c5f61e6393ba7a0abcc9f66276fc6ece0f4e1768cddf8853bb2d551b
[test] computed output cipher is 522dc1f099567d07f47f37a32a84427d643a8cdcbfe5c0c97598a2bd2555d1aa8cb08e48590dbb3da7b08b1056828838c5f61e6393ba7a0abcc9f66276fc6ece0f4e1768cddf8853bb2d551b
[test] cipher is a success
[test] expected output decryption is d9313225f88406e5a55909c5aff5269a86a7a9531534f7da2e4c303d8a318a721c3c0c95956809532fcf0e2449a6b525b16aedf5aa0de657ba637b39
[test] computed output decryption is d9313225f88406e5a55909c5aff5269a86a7a9531534f7da2e4c303d8a318a721c3c0c95956809532fcf0e2449a6b525b16aedf5aa0de657ba637b39
[test] decryption is a success
test()
[test] expected output cipher is d31a8d34648e60db7b86afbc53ef7ec2a4aded51296e08fea9e2b5a736ee62d63dbea45e8ca9671282fafb69da92728b1a71de0a9e060b2905d6a5b67ecd3b3692ddbd7f2d778b8c9803aee328091b58fab324e4fad675945585808b4831d7bc3ff4def08e4b7a9de576d26586cec64b61161ae10b594f09e26a7e902ecbd0600691
[test] computed output cipher is d31a8d34648e60db7b86afbc53ef7ec2a4aded51296e08fea9e2b5a736ee62d63dbea45e8ca9671282fafb69da92728b1a71de0a9e060b2905d6a5b67ecd3b3692ddbd7f2d778b8c9803aee328091b58fab324e4fad675945585808b4831d7bc3ff4def08e4b7a9de576d26586cec64b61161ae10b594f09e26a7e902ecbd0600691
[test] cipher is a success
[test] expected output decryption is 4c616469657320616e642047656e746c656d656e206f662074686520636c617373206f66202739393a204966204920636f756c64206f6666657220796f75206f6e6c79206f6e652074697020666f7220746865206675747572652c2073756e73637265656e20776f756c642062652069742e
[test] computed output decryption is 4c616469657320616e642047656e746c656d656e206f662074686520636c617373206f66202739393a204966204920636f756c64206f6666657220796f75206f6e6c79206f6e652074697020666f7220746865206675747572652c2073756e73637265656e20776f756c642062652069742e
[test] decryption is a success
test_aes_gcm_0()
[test] expected output cipher is 58e2fccefa7e3061367f1d57a4e7455a
[test] computed output cipher is 58e2fccefa7e3061367f1d57a4e7455a
[test] cipher is a success
[test] expected output decryption is 
[test] computed output decryption is 
[test] decryption is a success
test_aes_gcm_1()
[test] expected output cipher is 530f8afbc74536b9a963b4f1c4cb738b
[test] computed output cipher is 530f8afbc74536b9a963b4f1c4cb738b
[test] cipher is a success
[test] expected output decryption is 
[test] computed output decryption is 
[test] decryption is a success
test_aes_gcm_2()
[test] expected output cipher is cea7403d4d606b6e074ec5d3baf39d18d0d1c8a799996bf0265b98b5d48ab919
[test] computed output cipher is cea7403d4d606b6e074ec5d3baf39d18d0d1c8a799996bf0265b98b5d48ab919
[test] cipher is a success
[test] expected output decryption is 00000000000000000000000000000000
[test] computed output decryption is 00000000000000000000000000000000
[test] decryption is a success
test_aes_gcm_3()
[test] expected output cipher is 522dc1f099567d07f47f37a32a84427d643a8cdcbfe5c0c97598a2bd2555d1aa8cb08e48590dbb3da7b08b1056828838c5f61e6393ba7a0abcc9f662898015adb094dac5d93471bdec1a502270e3cc6c
[test] computed output cipher is 522dc1f099567d07f47f37a32a84427d643a8cdcbfe5c0c97598a2bd2555d1aa8cb08e48590dbb3da7b08b1056828838c5f61e6393ba7a0abcc9f662898015adb094dac5d93471bdec1a502270e3cc6c
[test] cipher is a success
[test] expected output decryption is d9313225f88406e5a55909c5aff5269a86a7a9531534f7da2e4c303d8a318a721c3c0c95956809532fcf0e2449a6b525b16aedf5aa0de657ba637b391aafd255
[test] computed output decryption is d9313225f88406e5a55909c5aff5269a86a7a9531534f7da2e4c303d8a318a721c3c0c95956809532fcf0e2449a6b525b16aedf5aa0de657ba637b391aafd255
[test] decryption is a success
test_aes_gcm_4()
[test] expected output cipher is 522dc1f099567d07f47f37a32a84427d643a8cdcbfe5c0c97598a2bd2555d1aa8cb08e48590dbb3da7b08b1056828838c5f61e6393ba7a0abcc9f66276fc6ece0f4e1768cddf8853bb2d551b
[test] computed output cipher is 522dc1f099567d07f47f37a32a84427d643a8cdcbfe5c0c97598a2bd2555d1aa8cb08e48590dbb3da7b08b1056828838c5f61e6393ba7a0abcc9f66276fc6ece0f4e1768cddf8853bb2d551b
[test] cipher is a success
[test] expected output decryption is d9313225f88406e5a55909c5aff5269a86a7a9531534f7da2e4c303d8a318a721c3c0c95956809532fcf0e2449a6b525b16aedf5aa0de657ba637b39
[test] computed output decryption is d9313225f88406e5a55909c5aff5269a86a7a9531534f7da2e4c303d8a318a721c3c0c95956809532fcf0e2449a6b525b16aedf5aa0de657ba637b39
[test] decryption is a success
make: Entering directory '/cygdrive/c/build/agent2/_work/12/s/hacl-star/secure_api'
./../secure_api/out/runtime_switch/krml-test.exe
test()
[test] expected output cipher is d31a8d34648e60db7b86afbc53ef7ec2a4aded51296e08fea9e2b5a736ee62d63dbea45e8ca9671282fafb69da92728b1a71de0a9e060b2905d6a5b67ecd3b3692ddbd7f2d778b8c9803aee328091b58fab324e4fad675945585808b4831d7bc3ff4def08e4b7a9de576d26586cec64b61161ae10b594f09e26a7e902ecbd0600691
[test] computed output cipher is d31a8d34648e60db7b86afbc53ef7ec2a4aded51296e08fea9e2b5a736ee62d63dbea45e8ca9671282fafb69da92728b1a71de0a9e060b2905d6a5b67ecd3b3692ddbd7f2d778b8c9803aee328091b58fab324e4fad675945585808b4831d7bc3ff4def08e4b7a9de576d26586cec64b61161ae10b594f09e26a7e902ecbd0600691
[test] cipher is a success
[test] expected output decryption is 4c616469657320616e642047656e746c656d656e206f662074686520636c617373206f66202739393a204966204920636f756c64206f6666657220796f75206f6e6c79206f6e652074697020666f7220746865206675747572652c2073756e73637265656e20776f756c642062652069742e
[test] computed output decryption is 4c616469657320616e642047656e746c656d656e206f662074686520636c617373206f66202739393a204966204920636f756c64206f6666657220796f75206f6e6c79206f6e652074697020666f7220746865206675747572652c2073756e73637265656e20776f756c642062652069742e
[test] decryption is a success
test_aes_gcm_0()
[test] expected output cipher is 58e2fccefa7e3061367f1d57a4e7455a
[test] computed output cipher is 58e2fccefa7e3061367f1d57a4e7455a
[test] cipher is a success
[test] expected output decryption is 
[test] computed output decryption is 
[test] decryption is a success
test_aes_gcm_1()
[test] expected output cipher is 530f8afbc74536b9a963b4f1c4cb738b
[test] computed output cipher is 530f8afbc74536b9a963b4f1c4cb738b
[test] cipher is a success
[test] expected output decryption is 
[test] computed output decryption is 
[test] decryption is a success
test_aes_gcm_2()
[test] expected output cipher is cea7403d4d606b6e074ec5d3baf39d18d0d1c8a799996bf0265b98b5d48ab919
[test] computed output cipher is cea7403d4d606b6e074ec5d3baf39d18d0d1c8a799996bf0265b98b5d48ab919
[test] cipher is a success
[test] expected output decryption is 00000000000000000000000000000000
[test] computed output decryption is 00000000000000000000000000000000
[test] decryption is a success
test_aes_gcm_3()
[test] expected output cipher is 522dc1f099567d07f47f37a32a84427d643a8cdcbfe5c0c97598a2bd2555d1aa8cb08e48590dbb3da7b08b1056828838c5f61e6393ba7a0abcc9f662898015adb094dac5d93471bdec1a502270e3cc6c
[test] computed output cipher is 522dc1f099567d07f47f37a32a84427d643a8cdcbfe5c0c97598a2bd2555d1aa8cb08e48590dbb3da7b08b1056828838c5f61e6393ba7a0abcc9f662898015adb094dac5d93471bdec1a502270e3cc6c
[test] cipher is a success
[test] expected output decryption is d9313225f88406e5a55909c5aff5269a86a7a9531534f7da2e4c303d8a318a721c3c0c95956809532fcf0e2449a6b525b16aedf5aa0de657ba637b391aafd255
[test] computed output decryption is d9313225f88406e5a55909c5aff5269a86a7a9531534f7da2e4c303d8a318a721c3c0c95956809532fcf0e2449a6b525b16aedf5aa0de657ba637b391aafd255
[test] decryption is a success
test_aes_gcm_4()
[test] expected output cipher is 522dc1f099567d07f47f37a32a84427d643a8cdcbfe5c0c97598a2bd2555d1aa8cb08e48590dbb3da7b08b1056828838c5f61e6393ba7a0abcc9f66276fc6ece0f4e1768cddf8853bb2d551b
[test] computed output cipher is 522dc1f099567d07f47f37a32a84427d643a8cdcbfe5c0c97598a2bd2555d1aa8cb08e48590dbb3da7b08b1056828838c5f61e6393ba7a0abcc9f66276fc6ece0f4e1768cddf8853bb2d551b
[test] cipher is a success
[test] expected output decryption is d9313225f88406e5a55909c5aff5269a86a7a9531534f7da2e4c303d8a318a721c3c0c95956809532fcf0e2449a6b525b16aedf5aa0de657ba637b39
[test] computed output decryption is d9313225f88406e5a55909c5aff5269a86a7a9531534f7da2e4c303d8a318a721c3c0c95956809532fcf0e2449a6b525b16aedf5aa0de657ba637b39
[test] decryption is a success
make -C C:/build/agent2/_work/12/s/MLCrypto
make[1]: Entering directory '/cygdrive/c/build/agent2/_work/12/s/MLCrypto'
make[1]: Nothing to be done for 'all'.
make[1]: Leaving directory '/cygdrive/c/build/agent2/_work/12/s/MLCrypto'
OCAMLPATH="C:/build/agent2/_work/12/s/FStar/bin" ocamlfind opt -package fstarlib,zarith -g -I C:/build/agent2/_work/12/s/FStar/ulib/ml -c LowCProvider/LowCProvider.ml -I LowCProvider -I ../secure_api/out/runtime_switch -I ../secure_api/out/runtime_switch/extracted -I C:/build/agent2/_work/12/s/MLCrypto -o LowCProvider/LowCProvider.cmx
OCAMLPATH="C:/build/agent2/_work/12/s/FStar/bin" ocamlfind mklib -package fstarlib,zarith -g -I C:/build/agent2/_work/12/s/FStar/ulib/ml -I ../secure_api/out/runtime_switch/extracted ../secure_api/out/runtime_switch/uint128/uint128_wrapper.o LowCProvider/LowCProvider.cmx LowCProvider/HaclProvider.cmx LowCProvider/lowc_stub.o ../secure_api/out/runtime_switch/crypto/Crypto_AEAD_Main_Crypto_Indexing.o ../secure_api/out/runtime_switch/crypto/Crypto_HKDF_Crypto_HMAC.o ../secure_api/out/runtime_switch/crypto/Crypto_Symmetric_Bytes.o ../code/curve25519/x25519-c/Curve25519.o ../code/curve25519/x25519-c/FStar.o vale/asm/sha256_main_i.o vale/asm/sha256-x86_64.o vale/asm/Vale_Hash_SHA2_256.o vale/asm/vale_aes_glue.o vale/asm/aes-x86_64.o -o ../secure_api/out/runtime_switch/LowC
OCAMLPATH="C:/build/agent2/_work/12/s/FStar/bin" ocamlfind opt -package fstarlib,zarith -g -I C:/build/agent2/_work/12/s/FStar/ulib/ml -c LowCProvider/Tests.ml -I LowCProvider -I ../secure_api/out/runtime_switch -I ../secure_api/out/runtime_switch/extracted -I C:/build/agent2/_work/12/s/MLCrypto -o LowCProvider/Tests.cmx
OCAMLPATH="C:/build/agent2/_work/12/s/FStar/bin" ocamlfind opt -package fstarlib,zarith -g -I C:/build/agent2/_work/12/s/FStar/ulib/ml -I ../secure_api/out/runtime_switch/extracted -I LowCProvider \
-ccopt -L../secure_api/out/runtime_switch -linkpkg ../secure_api/out/runtime_switch/copied/kremstr.o C:/build/agent2/_work/12/s/MLCrypto/CryptoTypes.cmx ../secure_api/out/runtime_switch/LowC.cmxa LowCProvider/Tests.cmx -o ../secure_api/out/runtime_switch/LowCTests.exe
./../secure_api/out/runtime_switch/LowCTests.exe
Tests started
Test 1 OK

Test 2 OK

Test 3 OK

Test 4 OK

Test 5 OK

Test 6 OK

Output cipher:	ed3dc05f9d4877f5db78c69c3a8a3d8e8602646a0b2febe4fca07a426a9ace4163cb26eddbb5b0d5f56d7038512ac73d667397d129c3044e0eb8052e
Output tag:	e6f0c7f7b8920ba02a3942df2b8b2a04
cipher:		AES-128-GCM
key:		"feffe9928665731c6d6a8f9467308308"
iv:		"cafebabefacedbad"
aad:		"feedfacedeadbeeffeedfacedeadbeefabaddad2"
tag:		"3612d2e79e3b0785561be14aaca2fccb"
plaintext:	"d9313225f88406e5a55909c5aff5269a86a7a9531534f7da2e4c303d8a318a721c3c0c95956809532fcf0e2449a6b525b16aedf5aa0de657ba637b39"
ciphertext:	"61353b4c2806934a777ff51fa22a4755699b2a714fcdc6f83766e5f97b6c742373806900e49f24b22b097544d4896b424989b5e1ebac0f07c23f4598"

+ cd mitls-fstar/src/tls
Test 7 failed, but this is expected because |IV| <> 12 bytes and we don't do IV expansion.
Please disregard.

+ make -j 16 test
Output cipher:	8076eba01a51d7702d398c6dc3adaaadfe061c23a7ffc3c4623ea2be7a08d982b8f331d21ac6b8db541df43510561a3fff90b942215b7fb6fbcea43d
Output tag:	1606863da7ad74443b3a89fd2489363d
cipher:		AES-128-GCM
key:		"feffe9928665731c6d6a8f9467308308"
iv:		"9313225df88406e555909c5aff5269aa6a7a9538534f7da1e4c303d2a318a728c3c0c95156809539fcf0e2429a6b525416aedbf5a0de6a57a637b39b"
aad:		"feedfacedeadbeeffeedfacedeadbeefabaddad2"
tag:		"619cc5aefffe0bfa462af43c1699d050"
plaintext:	"d9313225f88406e5a55909c5aff5269a86a7a9531534f7da2e4c303d8a318a721c3c0c95956809532fcf0e2449a6b525b16aedf5aa0de657ba637b39"
ciphertext:	"8ce24998625615b603a033aca13fb894be9112a5c3a211a8ba262a3cca7e2ca701e4a9a4fba43c90ccdcb281d48c7c6fd62875d2aca417034c34aee5"

Test 8 failed, but this is expected because |IV| <> 12 bytes and we don't do IV expansion.
Please disregard.

Test 9 OK

Test 10 OK

Test 11 OK

Test 12 OK

Output cipher:	677a374b4dd797f8ea0252a721fa83784f68c4877cf4e60f8c1f56972e9c20f789efb32096dd6336c6e5ef833b041251fdf04ce41fbcf2fea0d1e83c
Output tag:	91b8ee617f7c50dab5bc75abff3bc1c3
cipher:		AES-256-GCM
key:		"feffe9928665731c6d6a8f9467308308feffe9928665731c6d6a8f9467308308"
iv:		"cafebabefacedbad"
aad:		"feedfacedeadbeeffeedfacedeadbeefabaddad2"
tag:		"3a337dbf46a792c45e454913fe2ea8f2"
plaintext:	"d9313225f88406e5a55909c5aff5269a86a7a9531534f7da2e4c303d8a318a721c3c0c95956809532fcf0e2449a6b525b16aedf5aa0de657ba637b39"
ciphertext:	"c3762df1ca787d32ae47c13bf19844cbaf1ae14d0b976afac52ff7d79bba9de0feb582d33934a4f0954cc2363bc73f7862ac430e64abe499f47c9b1f"

Test 13 failed, but this is expected because |IV| <> 12 bytes and we don't do IV expansion.
Please disregard.

Output cipher:	cf3b9ab7a70a2ac55a7bcf74cda369c5b32e7870a937cb4d7679ef877de6403b7126c8ca2d6c620755e8ff330af0e7fa003585282b2d7a3d8f785bcc
Output tag:	881390e147e8fc6b2923305b6413a594
cipher:		AES-256-GCM
key:		"feffe9928665731c6d6a8f9467308308feffe9928665731c6d6a8f9467308308"
iv:		"9313225df88406e555909c5aff5269aa6a7a9538534f7da1e4c303d2a318a728c3c0c95156809539fcf0e2429a6b525416aedbf5a0de6a57a637b39b"
aad:		"feedfacedeadbeeffeedfacedeadbeefabaddad2"
tag:		"a44a8266ee1c8eb0c8b5d4cf5ae9f19a"
plaintext:	"d9313225f88406e5a55909c5aff5269a86a7a9531534f7da2e4c303d8a318a721c3c0c95956809532fcf0e2449a6b525b16aedf5aa0de657ba637b39"
ciphertext:	"5a8def2f0c9e53f1f75d7853659e2a20eeb2b22aafde6419a058ab4f6f746bf40fc0c3b780f244452da3ebf1c5d82cdea2418997200ef82e44ae7e3f"

Test 14 failed, but this is expected because |IV| <> 12 bytes and we don't do IV expansion.
Please disregard.

Test 15 OK

Test 16 OK

Test 17 OK

Test 18 OK

Output cipher:	eff01b40f151144abb70955cedcbe564afd7d338ce2c3eb2ac13b1228ef785edc5bf4b7501cdc522a855c4e5843a3a0af67e4c8285f641951d9dcb727fb5d53bffe8165999884aa1626b20328a233f189b48820f19d2cf1551f21d0ae749227f1d47344d687533456994f11584dfd15d4791ceedf45f3774821bcd340d4b18ec8ed70e7ce40859ec159363caab3eaa87261cbda3733c01bbd39f03f21d3c4f1b3af2cadd75c67fbe96929c20a13077991908a0d23adbcecd49ed2ed71dd8f659
Output tag:	1f200ef9ef5218a0a69331c8304f873d
cipher:		AES-128-GCM
key:		"00000000000000000000000000000000"
iv:		"ffffffff000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000"
aad:		""
tag:		"566f8ef683078bfdeeffa869d751a017"
plaintext:	"000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000"
ciphertext:	"56b3373ca9ef6e4a2b64fe1e9a17b61425f10d47a75a5fce13efc6bc784af24f4141bdd48cf7c770887afd573cca5418a9aeffcd7c5ceddfc6a78397b9a85b499da558257267caab2ad0b23ca476a53cb17fb41c4b8b475cb4f3f7165094c229c9e8c4dc0a2a5ff1903e501511221376a1cdb8364c5061a20cae74bc4acd76ceb0abc9fd3217ef9f8c90be402ddf6d8697f4f880dff15bfb7a6b28241ec8fe183c2d59e3f9dfff653c7126f0acb9e64211f42bae12af462b1070bef1ab5e3606"

Test 19 failed, but this is expected because |IV| <> 12 bytes and we don't do IV expansion.
Please disregard.

Output cipher:	eff01b40f151144abb70955cedcbe564afd7d338ce2c3eb2ac13b1228ef785edc5bf4b7501cdc522a855c4e5843a3a0af67e4c8285f641951d9dcb727fb5d53bffe8165999884aa1626b20328a233f189b48820f19d2cf1551f21d0ae749227f1d47344d687533456994f11584dfd15d4791ceedf45f3774821bcd340d4b18ec8ed70e7ce40859ec159363caab3eaa87261cbda3733c01bbd39f03f21d3c4f1b3af2cadd75c67fbe96929c20a13077991908a0d23adbcecd49ed2ed71dd8f65954f4ff316fe216dd9e29b1ea55824efb884af85d0e6743d586acfc3088f200284dcb744dcf6fe40745827d98067e32af9b279d8f8354d7e47b8bb6736de3b66479f0d1ee5cb7796d966955cc6dea4ae5e4205b07040a0d9ec6594c2c6d2350a4
Output tag:	99b156f6881899ee456476976e9f5414
cipher:		AES-128-GCM
key:		"00000000000000000000000000000000"
iv:		"ffffffff000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000"
aad:		""
tag:		"8b307f6b33286d0ab026a9ed3fe1e85f"
plaintext:	"000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000"
ciphertext:	"56b3373ca9ef6e4a2b64fe1e9a17b61425f10d47a75a5fce13efc6bc784af24f4141bdd48cf7c770887afd573cca5418a9aeffcd7c5ceddfc6a78397b9a85b499da558257267caab2ad0b23ca476a53cb17fb41c4b8b475cb4f3f7165094c229c9e8c4dc0a2a5ff1903e501511221376a1cdb8364c5061a20cae74bc4acd76ceb0abc9fd3217ef9f8c90be402ddf6d8697f4f880dff15bfb7a6b28241ec8fe183c2d59e3f9dfff653c7126f0acb9e64211f42bae12af462b1070bef1ab5e3606872ca10dee15b3249b1a1b958f23134c4bccb7d03200bce420a2f8eb66dcf3644d1423c1b5699003c13ecef4bf38a3b60eedc34033bac1902783dc6d89e2e774188a439c7ebcc0672dbda4ddcfb2794613b0be41315ef778708a70ee7d75165c"

Test 20 failed, but this is expected because |IV| <> 12 bytes and we don't do IV expansion.
Please disregard.

Test 21 OK

AEAD: 21/21 tests passed
./../secure_api/out/runtime_switch/quicprovider-test.exe
==== coverage ====
SHA256('') =
e3b0c44298fc1c149afbf4c8996fb92427ae41e4649b934ca495991b7852b855

SHA384('') = 
38b060a751ac96384cd9327eb1b1e36a21fdb71114be07434c0cc7bf63f6e1da
274edebfe76f65fbd51ad2f14898b95b

SHA512('') = 
cf83e1357eefb8bdf1542850d66d8007d620e4050b5715dc83f4a921d36ce9ce
47d0d13c5d85f2b0ff8318d2877eec2f63b931bd47417a81a538327af927da3e

HMAC-SHA256('Jefe', 'what do ya want for nothing?') = 
5bdcc146bf60754e6a042426089575c75a003f089d2739839dec58b964ec3843

HMAC-SHA384('Jefe', 'what do ya want for nothing?') = 
af45d2e376484031617f78d2b58a6b1b9c7ef464f5a01b47e42ec3736322445e
8e2240ca5e69e2c78b3239ecfab21649

HMAC-SHA512('Jefe', 'what do ya want for nothing?') = 
164b7a7bfcf819e2e395fbe73b56e0a387bd64222e831fd610270cd7ea250554
9758bf75c05a994a6d034f65f8f0e6fdcaeab1a34d4a6b4b636e070a38bce737

prk = HKDF-EXTRACT-SHA256('0x000102030405060708090a0b0c', '0x0b0b0b0b0b0b0b0b0b0b0b0b0b0b0b0b0b0b0b0b0b0b')
077709362c2e32df0ddc3f0dc47bba6390b6c73bb50f9c3122ec844ad7c2b3e5
077709362c2e32df0ddc3f0dc47bba6390b6c73bb50f9c3122ec844ad7c2b3e5

okm = HKDF-EXPAND-SHA256(prk, '0xf0f1f2f3f4f5f6f7f8f9', 42)
3cb25f25faacd57a90434f64d0362f2a2d2d0a90cf1a5a4c5db02d56ecc4c5bf
34007208d5b887185865

AES-128-GCM encrypt test:
5936f46d6c7eb7008dbbfb0d40b491fce5328aedcbc0c5272457d347363fd36d
f238bd17971e982f4449350d
DECRYPT SUCCES: 
7768617420646f2079612077616e7420666f72206e6f7468696e673f

CHACHA20-POLY1305 encrypt test:
a62fe99f3d6001a4f4214a986f04b1f42ea1e5dcea3236ecf35adb5d8cc57db2
df5e18b278c8c904fcddf440
DECRYPT SUCCES: 
7768617420646f2079612077616e7420666f72206e6f7468696e673f
==== PASS:  coverage ====


==== test_crypto(TLS_hash_SHA256,TLS_aead_AES_128_GCM) ====
PASS
==== test_crypto(TLS_hash_SHA384,TLS_aead_AES_128_GCM) ====
PASS
==== test_crypto(TLS_hash_SHA512,TLS_aead_AES_128_GCM) ====
PASS
==== test_crypto(TLS_hash_SHA256,TLS_aead_AES_256_GCM) ====
PASS
==== test_crypto(TLS_hash_SHA384,TLS_aead_AES_256_GCM) ====
PASS
==== test_crypto(TLS_hash_SHA512,TLS_aead_AES_256_GCM) ====
PASS
==== test_crypto(TLS_hash_SHA256,TLS_aead_CHACHA20_POLY1305) ====
PASS
==== test_crypto(TLS_hash_SHA384,TLS_aead_CHACHA20_POLY1305) ====
PASS
==== test_crypto(TLS_hash_SHA512,TLS_aead_CHACHA20_POLY1305) ====
PASS
==== test_handshake_secrets() ====
==== PASS: test_handshake_secrets ==== 
==== ALL TESTS PASS ====
make: Leaving directory '/cygdrive/c/build/agent2/_work/12/s/hacl-star/secure_api'
rm -f cache/OCaml/.depend cache/Kremlin/.depend cache/Model/.depend
make -f Makefile.Kremlin test
make -f Makefile.OCaml test
make -C ../../apps/quicMinusNet test -k
make[1]: Entering directory '/cygdrive/c/build/agent2/_work/12/s/mitls-fstar/apps/quicMinusNet'
./quic.exe
server create
client create
client call clen=8192 slen=   0
client done clen= 175 slen=   0 status=would_block
16030300aa010000a603035ae8742fb43a9f106c29db2328e4977935857f5488
f45b6933f67b848c8c438e0000041303130101000079001a0009ffff00050a0b
0c0d0e002b0003027f1c003300260024001d00206a5664c2b7b69a3f90e472be
b3b3f974a2bde7122889601ff5867c8d081cb9510000000e000c0000096c6f63
616c686f73740010000800060568712d303800170000000d0006000408040403
000a00040002001d002d0003020001
server call clen= 175 slen=8192
@@@@ Nego callback for TLS 1.3 @@@@
Offered extensions:
003d001a0009ffff00050a0b0c0d0e0000000e000c0000096c6f63616c686f73
740010000800060568712d3038000d0006000408040403000a00040002001d
Transport parameters offered:
ffff00050a0b0c0d0e
No application cookie (fist connection).
Adding server transport parameters:
000102
@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
======== TO BE SIGNED <0403>: (130 octets) ========
2020202020202020202020202020202020202020202020202020202020202020
2020202020202020202020202020202020202020202020202020202020202020
544c5320312e332c207365727665722043657274696669636174655665726966
790085e0e2cf79e253648a8aed2fe6a0e32c1f7b5142e765ec0a04a8e999b76d
a6e2
===================================================
sender done clen= 175 slen= 834 status=server_accept
160303005a0200005603035ae8742f5394e1f61dee4552c475cd00ce209212c6
9e38195a18614d023610e700130300002e002b00027f1c00330024001d0020eb
7a13ba9e5e5748a8f13c0e5f54bfe4fa9b7f2f4e75a8e12d849ee3e596c12817
030302def265d1e33dbdafe9471163500e8197ce88092dfd5d7f293cfdca530e
fd570bded95a33ba6445b3d0c0881237de6a9e75205a30dc6bccc16b557ca460
5dd7ba044b0d510a9b5ad703b37c533172bebe63939eed18155fccc70bd284e2
accbc8bab3a4a2aa1e5a827046580cfbdae775c7811b90cbcefb6abc61240329
728e17d2290c1c9912273d64ff73f2a3b0792f0fbe4454622807b20e73aab9bc
5d3b14d588d0ca97b3e3235b94b23475b3d5c4f1a04ba71b4250adae0bd351a0
cec0cd6a3e77e86fad18fcc16387f4cd0c64aeca635fda93041939d3d2353969
fc9baaa7acaa2c98cfbe700c6d5ff7ca416f1bb073d5e759ade5d0dbf2b2cef8
736166a0e868d1c2b9528a035217c327232855768075d6c54ef15ac154c8deb4
f25d94ce32a418a7d065f5cc35db41aa57d734d355773f454b35288b7a05d021
99c9444b7c21f655b3a61a4739f62608e488350849b8255a7ff8219cb93d7b65
8defae85705f411a8ca97214f311003880e86a61e8e60ad5753c0602c83084a5
01e9916dc76e4a45553ff5996820703cd1b6d8ffd5f611fdf52e115e2f9c2c35
be9f9ef9a8c10d5267563811216e78f47b6949e1d006741269091b12717d6c01
35cc390eaa9a5abf203c47a1c5e2b92980b1ecf0752e196f7896edcbf7b40f09
f2b1ee5af4ce7afcf42dc7c4a51349d0c74d4a3a33533282e7f02c8e30bc6467
0f1b5ea657d12e4b712d7cc44028934d133659d21588f0fbc72c699f26249a19
41d3ad01ba0724c42ed404f0cfeef6f670dd7652d6275af08553dd247e2865ba
13f6b65ce6c2db7b2272ceaad46ab329151a16042da916c1b1b89308ae6cc2f7
797aa69027eb992d9fcd78a5521bf474fa8f92e118a56d9bb99f7488ec1845b5
896e3b92301cb0095aee3d5a8062b4059aaded259d45492cdd1e1a611639d5aa
852a9e3d763b7d917d3bf9c65b8c3b0dd7b32978c6dda37c66d5b3b5b8c69248
b3ae9ae240ad33ef99dc856692fa701813761a094d60351341e090d759b31b88
abd5
client call clen=8017 slen= 834
@@@@ Nego callback for TLS 1.3 @@@@
Offered extensions:
001b0010000800060568712d3038000a00040002001d001a0003000102
Transport parameters offered:
000102
No application cookie (fist connection).
Adding server transport parameters:
000102
@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
WARNING: chain validation failed, ignoring.
client done clen=  58 slen= 834 status=client_complete
17030300357107521b12da7941fb44d5c9934d9bfd261dd4422938bb6c2dda5b
21f4c94c886dbeb53f0abd2b53d967081863c58678824391e3d7
server call clen=  58 slen=7358
sender done clen=  58 slen=   0 status=server_complete
=== Exporter secret ===
efeba6ab301631cd7d22bc8bf1387e97337442f432bb31e967b5c60c431d9ab5
=== QUIC 1-RTT secrets ===
C: 349dff6f2bfc8a6e9f9ca9446216d8426a55050feb60e1772801734cf177454a
S: 7b0547615bf713145183bff4c502b2e8fc1e5edceab906b3fa381628c7fa85b2
=== AEAD client key test ===
8806d48c6853898b3a583ed337150880a90f9288110a8811489da9
=== Decrypt successful ===
Ok
./quic.exe 0rtt

INITIAL ECDHE HANDSHAKE (NO EARLY SECRET)

server create
client create
client returns would_block clen=175 slen=0
ClientHello[ 175] ---->

@@@@ Nego callback for TLS 1.3 @@@@
Offered extensions:
003d001a0009ffff00050a0b0c0d0e0000000e000c0000096c6f63616c686f73
740010000800060568712d3038000d0006000408040403000a00040002001d
Transport parameters offered:
ffff00050a0b0c0d0e
No application cookie (fist connection).
Adding server transport parameters:
000102
@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
======== TO BE SIGNED <0403>: (130 octets) ========
2020202020202020202020202020202020202020202020202020202020202020
2020202020202020202020202020202020202020202020202020202020202020
544c5320312e332c207365727665722043657274696669636174655665726966
7900f512e98102f6faf2d34a42cb665d34f56b0d528b5c6ec8ff5ed044bf5b54
b3cc
===================================================
server returns server_accept clen=175 slen=834
secret=3a62d07a5772695f98e13925ac50bac31a9f469e6840f2be60cd5e823d315618
<---- ServerHello;(EncryptedExtensions; Certificate; CertVerify; Finished)[ 834]

@@@@ Nego callback for TLS 1.3 @@@@
Offered extensions:
001b0010000800060568712d3038000a00040002001d001a0003000102
Transport parameters offered:
000102
No application cookie (fist connection).
Adding server transport parameters:
000102
@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
WARNING: chain validation failed, ignoring.
client returns client_complete clen=58 slen=834
secret=3a62d07a5772695f98e13925ac50bac31a9f469e6840f2be60cd5e823d315618
(Finished) [  58] ---->

server returns server_complete clen=58 slen=0
server returns would_block clen=0 slen=135
<---- {Ticket}[ 135]

##### New session ticket received! #####
Host: localhost
Ticket:
cce5a6364caf5c0eb2d3c721508a93231ebbad2c1e320ce1a34afe557895205e
753a69d396aa39a5418c23e548b263217bd7f0de44b7364fbda1d7433f70ea9e
13849d4ad9ec19ae40af7ca6
########################################
client returns clen=0 slen=135 status=would_block

TICKET-BASED RESUMPTION

server create
client create
client returns client_early_data clen=302 slen=0
early secret=2df24f6b70a63c3f76cdede537924a090006079c1a621ca76019176990b05a91
ClientHello[ 302] ---->

@@@@ Nego callback for TLS 1.3 @@@@
Offered extensions:
003d001a0009ffff00050a0b0c0d0e0000000e000c0000096c6f63616c686f73
740010000800060568712d3038000d0006000408040403000a00040002001d
Transport parameters offered:
ffff00050a0b0c0d0e
No application cookie (fist connection).
Adding server transport parameters:
000102
@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
server returns server_accept_early_data clen=302 slen=196
early secret=2df24f6b70a63c3f76cdede537924a090006079c1a621ca76019176990b05a91
secret=9526c499c7f1a905cdbad7075d3aab97c46b01266414dd62a2533ae5a8364f67
<---- ServerHello;(EncryptedExtensions; Certificate; CertVerify; Finished)[ 196]

@@@@ Nego callback for TLS 1.3 @@@@
Offered extensions:
001b0010000800060568712d3038000a00040002001d001a0003000102
Transport parameters offered:
000102
No application cookie (fist connection).
Adding server transport parameters:
000102
@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
client returns client_complete_early_data clen=84 slen=196
secret=9526c499c7f1a905cdbad7075d3aab97c46b01266414dd62a2533ae5a8364f67
(Finished) [  84] ---->

server returns clen=84 slen=0 status=server_complete
server returns would_block clen=0 slen=135
<---- {Ticket}[ 135]

##### New session ticket received! #####
Host: localhost
Ticket:
3e03a063ee3db973d1e72dab5d2dc0a6649f2487476019a1be33e4f45b2e81a0
8baf230852ae913bdd85b3bfff1aace2f8f6a5ff04096ecc35b4ddb7302baba7
619661a98466904089d31431
########################################
client returns clen=0 slen=135 status=would_block
Ok
./quic.exe hrr

STATELESS RETRY TEST

server create
client create
client returns would_block clen=175 slen=0
ClientHello[ 175] ---->

~~~~~~~~~ Client Hello Summary ~~~~~~~~~~~
~ SNI = localhost
~ ALPN = 00060568712d3038
~ Cookie = NULL
~ Extensions = 0079001a0009ffff00050a0b0c0d0e002b0003027f1c003300260024001d0020
6b58042b26b2f929e6200414e1bfd022082279a85f4ae6333a1ed98abd700310
0000000e000c0000096c6f63616c686f73740010000800060568712d30380017
0000000d0006000408040403000a00040002001d002d0003020001
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
@@@@ Nego callback for TLS 1.3 @@@@
Offered extensions:
003d001a0009ffff00050a0b0c0d0e0000000e000c0000096c6f63616c686f73
740010000800060568712d3038000d0006000408040403000a00040002001d
Transport parameters offered:
ffff00050a0b0c0d0e
No application cookie (fist connection).
Adding server transport parameters:
000102
@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
server returns server_stateless_retry clen=175 slen=188
<---- HRR[ 188]

server re-create
client returns would_block clen=308 slen=188
ClientHello2[ 308] ---->

~~~~~~~~~ Client Hello Summary ~~~~~~~~~~~
~ SNI = localhost
~ ALPN = 00060568712d3038
~ Cookie = 48656c6c6f20576f726c64
~ Extensions = 00fe002c0081007fbe797a281ae0e86c2c4a4655f36df72cc164565eb9749732
1a419a79de5675c64dcb0b718a904f3254e91a9a4aec51962f54153f203c65e1
57c6d1a7ca6fc3d5e467d4918be027b6230c53f661f4f8ac0a8daad1e4ca2404
9aa3afa4dbb35d734c7007743f8a077da193b6e5def1be9cd19bddfaa7e9382c
979bb28f95bd7c001a0009ffff00050a0b0c0d0e002b0003027f1c0033002600
24001d00206b58042b26b2f929e6200414e1bfd022082279a85f4ae6333a1ed9
8abd7003100000000e000c0000096c6f63616c686f7374001000080006056871
2d303800170000000d0006000408040403000a00040002001d002d0003020001
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
@@@@ Nego callback for TLS 1.3 @@@@
Offered extensions:
003d001a0009ffff00050a0b0c0d0e0000000e000c0000096c6f63616c686f73
740010000800060568712d3038000d0006000408040403000a00040002001d
Transport parameters offered:
ffff00050a0b0c0d0e
Stateless cookie found, application contents:
48656c6c6f20576f726c64
Adding server transport parameters:
000102
@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
======== TO BE SIGNED <0403>: (130 octets) ========
2020202020202020202020202020202020202020202020202020202020202020
2020202020202020202020202020202020202020202020202020202020202020
544c5320312e332c207365727665722043657274696669636174655665726966
790016e3365a0d95ad8588bfc93687edce53fca50ebf93eb0c3ba12705f0d163
a1ed
===================================================
server returns server_accept clen=308 slen=834
secret=f5ca5d51a350b9f12607b5c46a25036f75772469bd98b8f5641144823cb0193b
<---- ServerHello;(EncryptedExtensions; Certificate; CertVerify; Finished)[ 834]

@@@@ Nego callback for TLS 1.3 @@@@
Offered extensions:
001b0010000800060568712d3038000a00040002001d001a0003000102
Transport parameters offered:
000102
No application cookie (fist connection).
Adding server transport parameters:
000102
@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
WARNING: chain validation failed, ignoring.
client returns client_complete clen=58 slen=834
secret=f5ca5d51a350b9f12607b5c46a25036f75772469bd98b8f5641144823cb0193b
(Finished) [  58] ---->

server returns server_complete clen=58 slen=0
server returns would_block clen=0 slen=135
<---- {Ticket}[ 135]

##### New session ticket received! #####
Host: localhost
Ticket:
5ad01eb11a5b1ef7b41bee4e988bcb067993d12f5132fba704e45659eed3e521
f671b4a8d9620dd6f36b08e0ff1dbca5fe82d1454245e5895bfd33c472da6cdc
659ba0854c83ccddf89cd1b7
########################################
client returns clen=0 slen=135 status=would_block
Ok
make[1]: Leaving directory '/cygdrive/c/build/agent2/_work/12/s/mitls-fstar/apps/quicMinusNet'
make[1]: Entering directory '/cygdrive/c/build/agent2/_work/12/s/mitls-fstar/src/tls'
C:/build/agent2/_work/12/s/FStar/bin/fstar.exe --cache_dir cache/Kremlin --cache_checked_modules --print_z3_statistics --use_hints --query_stats --cache_dir cache/Kremlin --odir extract/Kremlin --extract '* -DHDB -LowCProvider -FFICallbacks -BufferBytes' --dep full --include C:/build/agent2/_work/12/s/FStar/contrib/CoreCrypto/fst/ --include C:/build/agent2/_work/12/s/hacl-star/secure_api --include C:/build/agent2/_work/12/s/hacl-star/secure_api/utils --include C:/build/agent2/_work/12/s/hacl-star/secure_api/concrete_specializations --include C:/build/agent2/_work/12/s/hacl-star/secure_api/LowCProvider/fst --include C:/build/agent2/_work/12/s/hacl-star/code/curve25519/api --include C:/build/agent2/_work/12/s/hacl-star/code/lib --include C:/build/agent2/_work/12/s/kremlin/kremlib --include ../../libs/ffi --include ../../src/tls/concrete-flags --include ../../src/tls/concrete-flags/Kremlin --include ./concrete-flags/Debug QUIC.fst Test.Main.fst  > cache/Kremlin/.depend
make[1]: Leaving directory '/cygdrive/c/build/agent2/_work/12/s/mitls-fstar/src/tls'
make[1]: Entering directory '/cygdrive/c/build/agent2/_work/12/s/mitls-fstar/src/tls'
C:/build/agent2/_work/12/s/FStar/bin/fstar.exe --cache_dir cache/OCaml --cache_checked_modules --print_z3_statistics --use_hints --query_stats --cache_dir cache/OCaml --odir extract/OCaml --extract '* -Prims -FStar +FStar.Test +FStar.Kremlin.Endianness -CoreCrypto -CryptoTypes -DHDB -LowCProvider -HaclProvider -FFICallbacks -Crypto.AEAD -Crypto.Symmetric -Crypto.Plain -Spec.Loops -Buffer.Utils -C +C.Loops -LowParse.SLow.Tac -BufferBytes' --dep full --include C:/build/agent2/_work/12/s/FStar/contrib/CoreCrypto/fst/ --include C:/build/agent2/_work/12/s/hacl-star/secure_api --include C:/build/agent2/_work/12/s/hacl-star/secure_api/utils --include C:/build/agent2/_work/12/s/hacl-star/secure_api/concrete_specializations --include C:/build/agent2/_work/12/s/hacl-star/secure_api/LowCProvider/fst --include C:/build/agent2/_work/12/s/hacl-star/code/curve25519/api --include C:/build/agent2/_work/12/s/hacl-star/code/lib --include C:/build/agent2/_work/12/s/kremlin/kremlib --include ../../libs/ffi --include ../../src/tls/concrete-flags --include ../../src/tls/concrete-flags/OCaml --include ./concrete-flags/Debug QUIC.fst Test.Main.fst  > cache/OCaml/.depend
make[1]: Leaving directory '/cygdrive/c/build/agent2/_work/12/s/mitls-fstar/src/tls'
make -C extract/Kremlin-Internal-Test test
make[2]: Entering directory '/cygdrive/c/build/agent2/_work/12/s/mitls-fstar/src/tls/extract/Kremlin-Internal-Test'
cp ../../../../data/CAFile.pem .
make[2]: Leaving directory '/cygdrive/c/build/agent2/_work/12/s/mitls-fstar/src/tls/extract/Kremlin-Internal-Test'
make[2]: Entering directory '/cygdrive/c/build/agent2/_work/12/s/mitls-fstar/src/tls/extract/Kremlin-Internal-Test'
cp ../../../../data/server-ecdsa.crt .
make[2]: Leaving directory '/cygdrive/c/build/agent2/_work/12/s/mitls-fstar/src/tls/extract/Kremlin-Internal-Test'
make[2]: Entering directory '/cygdrive/c/build/agent2/_work/12/s/mitls-fstar/src/tls/extract/Kremlin-Internal-Test'
cp ../../../../data/server-ecdsa.key .
make[2]: Leaving directory '/cygdrive/c/build/agent2/_work/12/s/mitls-fstar/src/tls/extract/Kremlin-Internal-Test'
make[1]: Entering directory '/cygdrive/c/build/agent2/_work/12/s/mitls-fstar/src/tls'
cp ../../data/CAFile.pem .
make[1]: Leaving directory '/cygdrive/c/build/agent2/_work/12/s/mitls-fstar/src/tls'
make[1]: Entering directory '/cygdrive/c/build/agent2/_work/12/s/mitls-fstar/src/tls'
cp ../../data/server-ecdsa.crt .
make[1]: Leaving directory '/cygdrive/c/build/agent2/_work/12/s/mitls-fstar/src/tls'
make[1]: Entering directory '/cygdrive/c/build/agent2/_work/12/s/mitls-fstar/src/tls'
cp ../../data/server-ecdsa.key .
make[1]: Leaving directory '/cygdrive/c/build/agent2/_work/12/s/mitls-fstar/src/tls'
make[2]: Entering directory '/cygdrive/c/build/agent2/_work/12/s/mitls-fstar/src/tls/extract/Kremlin-Internal-Test'
./test.exe
✔ RNG initialization
b1 = 1234567890abcdef1234567890abcdef
b2 = cafedecafbabedeadbeeffeec0ffee33
b12= 1234567890abcdef1234567890abcdefcafedecafbabedeadbeeffeec0ffee33
b3 = 1234567890abcdef1234567890abcdefcafedecafbabedeadbeeffeec0ffee33
✔ BufferBytes
✔ TLSConstants
✔ AEAD
AEP| LowProvider: COERCE(K=feffe9928665731c6d6a8f9467308308feffe9928665731c6d6a8f9467308308)
Test.StAE: c0 size=33 data=000000000000000017b5db7a6412522a62d32d2b5a94a9348c80cbc7b20bdcfa5c.
Test.StAE: c1 size=28 data=0000000000000001a93cd0e67431db38a93a169cd79b29c82f69d7e4.
Test.StAE: start.
Test.StAE: decryption fails on wrong cipher.
Test.StAE: decryption fails on wrong sequence number.
Test.StAE: decryption fails on wrong CT.
Test.StAE: first decryption succeeds.
Test.StAE: second decryption succeeds.
AEP| LowProvider: COERCE(K=feffe9928665731c6d6a8f9467308308feffe9928665731c6d6a8f9467308308)
Test.StAE: c0 size=26 data=d12a84f232589f6bc797322d5f5d3f43e95bc07640538c50dded.
Test.StAE: c1 size=21 data=2adba81a76d2814ee2aba4406c861ecbc19825461a.
Test.StAE: start.
Test.StAE: decryption fails on wrong cipher.
Test.StAE: decryption fails on wrong sequence number.
Test.StAE: TLS 1.3 does not intend to provide outer CT authentication.
Test.StAE: first decryption succeeds.
Test.StAE: second decryption succeeds.
✔ StAE
Test.CommonDH: Testing FFDHE2048.
CDH| Keygen on FFDHE2048
CDH| DH responder on FFDHE2048
CDH| Keygen on FFDHE2048
CDH| DH initiator on FFDHE2048
CDH| DH initiator on FFDHE2048
Test.CommonDH: Testing FFDHE3072.
CDH| Keygen on FFDHE3072
CDH| DH responder on FFDHE3072
CDH| Keygen on FFDHE3072
CDH| DH initiator on FFDHE3072
CDH| DH initiator on FFDHE3072
Test.CommonDH: Testing FFDHE4096.
CDH| Keygen on FFDHE4096
CDH| DH responder on FFDHE4096
CDH| Keygen on FFDHE4096
CDH| DH initiator on FFDHE4096
CDH| DH initiator on FFDHE4096
Test.CommonDH: Testing FFDHE6144.
CDH| Keygen on FFDHE6144
CDH| DH responder on FFDHE6144
CDH| Keygen on FFDHE6144
CDH| DH initiator on FFDHE6144
CDH| DH initiator on FFDHE6144
Test.CommonDH: Testing FFDHE8192.
CDH| Keygen on FFDHE8192
CDH| DH responder on FFDHE8192
CDH| Keygen on FFDHE8192
CDH| DH initiator on FFDHE8192
CDH| DH initiator on FFDHE8192
Test.CommonDH: Testing P256.
CDH| Keygen on P256
CDH| DH responder on P256
CDH| Keygen on P256
CDH| DH initiator on P256
CDH| DH initiator on P256
Test.CommonDH: Testing P384.
CDH| Keygen on P384
CDH| DH responder on P384
CDH| Keygen on P384
CDH| DH initiator on P384
CDH| DH initiator on P384
Test.CommonDH: Testing P521.
CDH| Keygen on P521
CDH| DH responder on P521
CDH| Keygen on P521
CDH| DH initiator on P521
CDH| DH initiator on P521
Test.CommonDH: Testing X255519.
CDH| Keygen on X255519
CDH| DH responder on X255519
CDH| Keygen on X255519
CDH| DH initiator on X255519
CDH| DH initiator on X255519
✔ CommonDH
HS | next_fragment
HS | offering ClientHello 1.3
KS | ks_client_init 1.3
CDH| Keygen on X255519
NGO| No PSK or 0-RTT disabled
NGO| offering client extensions [ supported_versions key_share extended_master_secret signature_algorithms ec_point_formats supported_groups psk_key_exchange_modes ]
NGO| offering cipher suites ; TLS_AES_128_GCM_SHA256; TLS_AES_256_GCM_SHA384; TLS_CHACHA20_POLY1305_SHA256; TLS_ECDHE_ECDSA_WITH_AES_128_GCM_SHA256; TLS_ECDHE_RSA_WITH_AES_128_GCM_SHA256; TLS_DHE_RSA_WITH_AES_128_GCM_SHA256; TLS_ECDHE_ECDSA_WITH_AES_256_GCM_SHA384; TLS_ECDHE_RSA_WITH_AES_256_GCM_SHA384; TLS_DHE_RSA_WITH_AES_256_GCM_SHA384; TLS_ECDHE_ECDSA_WITH_CHACHA20_POLY1305_SHA256; TLS_ECDHE_RSA_WITH_CHACHA20_POLY1305_SHA256; TLS_DHE_RSA_WITH_CHACHA20_POLY1305_SHA256
HSL| emit ClientHello
Test.Handshake: ----client-hello---> 010000b303035ae87433...010100002d0003020001 (183 bytes).
HS | recv_fragment
HSL| parsed [ClientHello] -- end of flight 
HS | Processing ClientHello
NGO| offered client extensions [ supported_versions key_share extended_master_secret signature_algorithms ec_point_formats supported_groups psk_key_exchange_modes ]
NGO| offered cipher suites ; TLS_AES_128_GCM_SHA256; TLS_AES_256_GCM_SHA384; TLS_CHACHA20_POLY1305_SHA256; TLS_ECDHE_ECDSA_WITH_AES_128_GCM_SHA256; TLS_ECDHE_RSA_WITH_AES_128_GCM_SHA256; TLS_DHE_RSA_WITH_AES_128_GCM_SHA256; TLS_ECDHE_ECDSA_WITH_AES_256_GCM_SHA384; TLS_ECDHE_RSA_WITH_AES_256_GCM_SHA384; TLS_DHE_RSA_WITH_AES_256_GCM_SHA384; TLS_ECDHE_ECDSA_WITH_CHACHA20_POLY1305_SHA256; TLS_ECDHE_RSA_WITH_CHACHA20_POLY1305_SHA256; TLS_DHE_RSA_WITH_CHACHA20_POLY1305_SHA256
NGO| offered versions 1.3
NGO| Negotiated Pure EDH key exchange
NGO| Negotiated ECDSA_SHA1
NGO| Negotiation callback to handle extra extensions and query for stateless retry.
NGO| Application data in cookie: none
NGO| negotiated 1.3 TLS_AES_128_GCM_SHA256
KS | ks_server_init
KS | No PSK selected.
KS | Computed early secret:           33ad0a1c607ec03b09e6cd9893680ce210adf300aa1f2660e1b22e10f170f92a
KS | Handshake salt:                  6f2615a108c702c5678f54fc9dbab69716c076189c48250cebeac3576c3611ba
CDH| DH responder on X255519
CDH| Keygen on X255519
CDH| DH initiator on X255519
KS | DH shared secret: 8546b37557fef4516f0c58c03d1b609d52786d96c98ac870cf740c9755ea8d4a
KS | Handshake secret:                607d46f2087e3837c9b799d433e18f360e421d118cc869f0f8de736e58729105
NGO| processing client extensions [ supported_versions key_share extended_master_secret signature_algorithms ec_point_formats supported_groups psk_key_exchange_modes ]
NGO| including server extensions (SH + EE) [ supported_versions key_share supported_groups ]
NGO| extra extensions from application callback: 
HSL| emit ServerHello and hash
HS | derive handshake keys
KS | ks_server_13_sh, hashed log = ac6216a98c402733473452a96980dea7cb1a5183ecd9491d22feccd9044a7b32
KS | handshake traffic secret[C]:     f32057645e92ffda10c247b4f4d3dcf109ac4a335e7d21b1af0bfb433fd39566
KS | handshake traffic secret[S]:     8ff23e028f94ea2d42c8d65c8aa36efe53ad412afcea014a8deadd871db7d7b5
KS | handshake key[C]:                1c28653886fa77404fc30d0a112aa426, IV=4d6efe0f8744a307f78bdb86
KS | handshake key[S]: a0941d7481f686b996764943e7a0fd5c, IV=56a62ec325b32647ee12d49f
AEP| LowProvider: COERCE(K=a0941d7481f686b996764943e7a0fd5c)
AEP| LowProvider: COERCE(K=1c28653886fa77404fc30d0a112aa426)
KS | finished key[C]:                 da5ba73ad9bba68e516326f6a6939c12d2c38f2586a57c4a5e0003b1fabe19d5
KS | finished key[S]:                 7b84264d912dca551647b61ef61469266a1c4ab6a5da62ac0c9d47a42037c9db
KS | Application salt:                5b95e362cb734c368a6b728d81bf9f38c52d679a99e9a3b35f11c7e810223efb
KS | Application secret:              997a0b2b7a7e6bf5148f331ce54e212e5ca334b191aea9dd5482fe7ec77b4a5b
HS | next_fragment
Test.Handshake: <---server-hello---- 0200005603035ae87433...aeae58ed332a6b52ea77 (90 bytes).
HS | recv_fragment
HSL| parsed ServerHello
HSL| end of flight
HS | client_ServerHello
NGO| processing server extensions [ supported_versions key_share ]
NGO| negotiated 1.3 TLS_AES_128_GCM_SHA256
HS | Running TLS 1.3
KS | ks_client_13_sh hashed_log = ac6216a98c402733473452a96980dea7cb1a5183ecd9491d22feccd9044a7b32
KS | no PSK negotiated. Early secret: 33ad0a1c607ec03b09e6cd9893680ce210adf300aa1f2660e1b22e10f170f92a
KS | handshake salt:                  6f2615a108c702c5678f54fc9dbab69716c076189c48250cebeac3576c3611ba
CDH| DH initiator on X255519
KS | DH shared secret: 8546b37557fef4516f0c58c03d1b609d52786d96c98ac870cf740c9755ea8d4a
KS | handshake secret:                607d46f2087e3837c9b799d433e18f360e421d118cc869f0f8de736e58729105
KS | handshake traffic secret[C]:     f32057645e92ffda10c247b4f4d3dcf109ac4a335e7d21b1af0bfb433fd39566
KS | handshake traffic secret[S]:     8ff23e028f94ea2d42c8d65c8aa36efe53ad412afcea014a8deadd871db7d7b5
KS | handshake key[C]:                1c28653886fa77404fc30d0a112aa426, IV=4d6efe0f8744a307f78bdb86
KS | handshake key[S]:                a0941d7481f686b996764943e7a0fd5c, IV=56a62ec325b32647ee12d49f
KS | finished key[C]: da5ba73ad9bba68e516326f6a6939c12d2c38f2586a57c4a5e0003b1fabe19d5
KS | finished key[S]: 7b84264d912dca551647b61ef61469266a1c4ab6a5da62ac0c9d47a42037c9db
KS | application salt:                5b95e362cb734c368a6b728d81bf9f38c52d679a99e9a3b35f11c7e810223efb
KS | application secret:              997a0b2b7a7e6bf5148f331ce54e212e5ca334b191aea9dd5482fe7ec77b4a5b
AEP| LowProvider: COERCE(K=1c28653886fa77404fc30d0a112aa426)
AEP| LowProvider: COERCE(K=a0941d7481f686b996764943e7a0fd5c)
EPO| reader++ 0/-1
HS | next_fragment
HS | prepare Server Finished
HSL| emit EncryptedExtensions
HSL| emit Certificate13 and hash
HSL| emit CertificateVerify and hash
HSL| emit Finished and hash
KS | ks_server_13_sf hashed_log = 4b0f9fa72786763087c697fd090c153c3b626bf3ccb820679eab010ab6682898
KS | application traffic secret[C]:   7a2f5df8cf2d2b94cfcd8ef57b0fdfa3104d02bebdc728f8b24c626a9afe4056
KS | application traffic secret[S]:   d7746af7ccc4e9471e7fd6fb16cd24f7f1203e51f5b630b59ea9672da4686130
KS | exporter master secret:          6b939dd0691722aa5a69d00e1bda9cea7caa38671972357a7bac2a25ab4b4dc5
KS | application key[C]:              0750da0a7331f78391158a6b495b6a35, IV=12eb6cd6523a2f93d99cbab5
KS | application key[S]:              ea302faf6f5e9e351da011ca91e6a009, IV=2f11974fbed3504e91c259df
AEP| LowProvider: COERCE(K=ea302faf6f5e9e351da011ca91e6a009)
AEP| LowProvider: COERCE(K=0750da0a7331f78391158a6b495b6a35)
HS | exporting a key
EPO| reader++ 0/-1
Test.Handshake: <--server-finished-- 080000160014000a0010...2f5c392fa7ba4a85e5ad (711 bytes).
HS | recv_fragment
HSL| parsed EncryptedExtensions
HSL| parsed Certificate13
HSL| parsed CertificateVerify
HSL| parsed Finished
HSL| end of flight
NGO| Nego.clientComplete_13
NGO| EE: supported_groups 
NGO| Negotiation callback to process application extensions.
NGO| Certificate & signature 1.3 callback result: valid
KS | ks_client_13_sf hashed_log = 4b0f9fa72786763087c697fd090c153c3b626bf3ccb820679eab010ab6682898
KS | application traffic secret[C]:   7a2f5df8cf2d2b94cfcd8ef57b0fdfa3104d02bebdc728f8b24c626a9afe4056
KS | application traffic secret[S]:   d7746af7ccc4e9471e7fd6fb16cd24f7f1203e51f5b630b59ea9672da4686130
KS | exporter master secret:          6b939dd0691722aa5a69d00e1bda9cea7caa38671972357a7bac2a25ab4b4dc5
KS | application key[C]:              0750da0a7331f78391158a6b495b6a35, IV=12eb6cd6523a2f93d99cbab5
KS | application key[S]:              ea302faf6f5e9e351da011ca91e6a009, IV=2f11974fbed3504e91c259df
AEP| LowProvider: COERCE(K=0750da0a7331f78391158a6b495b6a35)
AEP| LowProvider: COERCE(K=ea302faf6f5e9e351da011ca91e6a009)
HS | exporting a key
HS | Early data rejected
EPO| writer++ 0/0
HSL| emit Finished and hash
KS | ks_client_13_cf hashed_log = 765ae066bc7412c04a5a967cafb239c2a87589c266918d30c74c6ace009728fe
KS | resumption master secret:        467e207f5e64dea0803e1842aed6c62509be17697c83e244408c717af0760d90
EPO| reader++ 1/0
HS | next_fragment
Test.Handshake: --client-finished---> 14000020c3ff5a772732...e9cd3b1f6eef17bd3395 (36 bytes).
HS | recv_fragment
HSL| parsed Finished
HSL| end of flight
HS | Process Client Finished
KS | ks_server_13_cf hashed_log = 765ae066bc7412c04a5a967cafb239c2a87589c266918d30c74c6ace009728fe
KS | resumption master secret:        467e207f5e64dea0803e1842aed6c62509be17697c83e244408c717af0760d90
AEP| LowProvider: COERCE(K=88b02f0be9e785fca07d10d8dcfec8eb8592d662304966fa353f3704396a5ced)
HS | Sending ticket: f67200f73f5219184109ad51910644795b62df9b6041a85834ef96914d1fdc95c184066707b7cd41733cfaac83825b5b7762d25df5d7ed990361afbea5d5eb2ff5f72be23fb147055f1f0a88
HSL| emit NewSessionTicket13
EPO| reader++ 1/-1
HS | next_fragment
Test.Handshake: <--session-ticket-- 0400006500000e105117...3fb147055f1f0a880000 (105 bytes).
HS | recv_fragment
HSL| parsed NewSessionTicket13
HSL| end of flight
HS | Received ticket: f67200f73f5219184109ad51910644795b62df9b6041a85834ef96914d1fdc95c184066707b7cd41733cfaac83825b5b7762d25df5d7ed990361afbea5d5eb2ff5f72be23fb147055f1f0a88
KS | ks_client_13_rms
KS | Recall RMS: 467e207f5e64dea0803e1842aed6c62509be17697c83e244408c717af0760d90
Test.Handshake: Done.
✔ Handshake
make[2]: Leaving directory '/cygdrive/c/build/agent2/_work/12/s/mitls-fstar/src/tls/extract/Kremlin-Internal-Test'
make[1]: Entering directory '/cygdrive/c/build/agent2/_work/12/s/mitls-fstar/src/tls'
OCAMLPATH="C:/build/agent2/_work/12/s/FStar/bin" ocamlfind opt -package fstarlib,zarith,ctypes,ctypes.foreign -g -I C:/build/agent2/_work/12/s/FStar/ulib/ml -I extract/OCaml -I C:/build/agent2/_work/12/s/MLCrypto -I ../../libs/ffi -I C:/build/agent2/_work/12/s/hacl-star/secure_api/LowCProvider -I C:/build/agent2/_work/12/s/hacl-star/secure_api/out/runtime_switch/ -I C:/build/agent2/_work/12/s/kremlin/_build/kremlib -I test -I extract/mlstubs -I . -cclib -L../pki -cclib -lmipki -linkall -linkpkg -g extract/OCaml/BufferBytes.cmx extract/OCaml/Crypto_AEAD_Main.cmx C:/build/agent2/_work/12/s/kremlin/_build/kremlib/C.cmx C:/build/agent2/_work/12/s/MLCrypto/CoreCrypto.cmxa C:/build/agent2/_work/12/s/hacl-star/secure_api/out/runtime_switch/LowC.cmxa ../../libs/ffi/FFICallbacks.cmxa extract/OCaml/Hashing_Spec.cmx extract/OCaml/Hashing_OpenSSL.cmx extract/OCaml/Hashing.cmx extract/OCaml/Flags.cmx extract/OCaml/TLSError.cmx extract/OCaml/Parse.cmx extract/OCaml/TLSConstants.cmx extract/OCaml/PKI.cmx extract/OCaml/Nonce.cmx extract/OCaml/TLS_Curve25519.cmx extract/OCaml/ECGroup.cmx extract/OCaml/DHGroup.cmx extract/OCaml/DebugFlags.cmx extract/OCaml/CommonDH.cmx extract/OCaml/Hashing_Flags.cmx extract/OCaml/Hashing_CRF.cmx extract/OCaml/PSK.cmx extract/OCaml/Extensions.cmx extract/OCaml/Cert.cmx extract/OCaml/RSAKey.cmx extract/OCaml/PMS.cmx extract/OCaml/TLSInfoFlags.cmx extract/OCaml/TLSInfo.cmx extract/OCaml/Crypto_Indexing.cmx extract/OCaml/Flag.cmx extract/OCaml/Specializations_Providers_AEAD.cmx extract/OCaml/C_Loops.cmx extract/OCaml/AEADOpenssl.cmx extract/OCaml/AEADProvider.cmx extract/OCaml/Range.cmx extract/OCaml/HandshakeMessages.cmx extract/OCaml/HandshakeLog.cmx extract/OCaml/FStar_Kremlin_Endianness.cmx extract/OCaml/Test_BufferBytes.cmx extract/OCaml/Ticket.cmx extract/OCaml/HMAC.cmx extract/OCaml/TLSPRF.cmx extract/OCaml/HMAC_UFCMA.cmx extract/OCaml/DataStream.cmx extract/OCaml/Alert.cmx extract/OCaml/Content.cmx extract/OCaml/StreamPlain.cmx extract/OCaml/StreamAE.cmx extract/OCaml/StatefulPlain.cmx extract/OCaml/LHAEPlain.cmx extract/OCaml/AEAD_GCM.cmx extract/OCaml/StatefulLHAE.cmx extract/OCaml/StAE.cmx extract/OCaml/HKDF.cmx extract/OCaml/KeySchedule.cmx extract/OCaml/Negotiation.cmx extract/OCaml/Epochs.cmx extract/OCaml/Handshake.cmx extract/OCaml/FStar_Test.cmx extract/OCaml/Test_CommonDH.cmx extract/OCaml/Transport.cmx extract/OCaml/Record.cmx extract/OCaml/Connection.cmx extract/OCaml/StreamDeltas.cmx extract/OCaml/TLS.cmx extract/OCaml/FFI.cmx extract/OCaml/QUIC.cmx extract/OCaml/Test_StAE.cmx extract/OCaml/Test_TLSConstants.cmx extract/OCaml/Test_Handshake.cmx extract/OCaml/Test_AEAD.cmx extract/OCaml/Test_Main.cmx extract/OCaml/FFIRegister.cmx extract/copied/kremstr.o test/mitls.cmx -o mitls.exe -thread
make[1]: Leaving directory '/cygdrive/c/build/agent2/_work/12/s/mitls-fstar/src/tls'
make[1]: Entering directory '/cygdrive/c/build/agent2/_work/12/s/mitls-fstar/src/tls'
./mitls.exe
✔ RNG initialization
b1 = 1234567890abcdef1234567890abcdef
b2 = cafedecafbabedeadbeeffeec0ffee33
b12= 1234567890abcdef1234567890abcdefcafedecafbabedeadbeeffeec0ffee33
b3 = 1234567890abcdef1234567890abcdefcafedecafbabedeadbeeffeec0ffee33
+ cd mitls-fstar/apps/cmitls
✔ BufferBytes
✔ TLSConstants
+ make test
✔ AEAD
AEP| LowCProvider: COERCE(K=feffe9928665731c6d6a8f9467308308feffe9928665731c6d6a8f9467308308)
Test.StAE: c0 size=33 data=000000000000000017b5db7a6412522a62d32d2b5a94a9348c80cbc7b20bdcfa5c.
Test.StAE: c1 size=28 data=0000000000000001a93cd0e67431db38a93a169cd79b29c82f69d7e4.
Test.StAE: start.
Test.StAE: decryption fails on wrong cipher.
Test.StAE: decryption fails on wrong sequence number.
Test.StAE: decryption fails on wrong CT.
Test.StAE: first decryption succeeds.
Test.StAE: second decryption succeeds.
AEP| LowCProvider: COERCE(K=feffe9928665731c6d6a8f9467308308feffe9928665731c6d6a8f9467308308)
Test.StAE: c0 size=26 data=d12a84f232589f6bc797322d5f5d3f43e95bc07640538c50dded.
Test.StAE: c1 size=21 data=2adba81a76d2814ee2aba4406c861ecbc19825461a.
Test.StAE: start.
Test.StAE: decryption fails on wrong cipher.
Test.StAE: decryption fails on wrong sequence number.
Test.StAE: TLS 1.3 does not intend to provide outer CT authentication.
Test.StAE: first decryption succeeds.
Test.StAE: second decryption succeeds.
✔ StAE
Test.CommonDH: Testing FFDHE2048.
CDH| Keygen on FFDHE2048
CDH| DH responder on FFDHE2048
CDH| Keygen on FFDHE2048
CDH| DH initiator on FFDHE2048
CDH| DH initiator on FFDHE2048
Test.CommonDH: Testing FFDHE3072.
CDH| Keygen on FFDHE3072
CDH| DH responder on FFDHE3072
CDH| Keygen on FFDHE3072
CDH| DH initiator on FFDHE3072
CDH| DH initiator on FFDHE3072
Test.CommonDH: Testing FFDHE4096.
CDH| Keygen on FFDHE4096
CDH| DH responder on FFDHE4096
CDH| Keygen on FFDHE4096
CDH| DH initiator on FFDHE4096
CDH| DH initiator on FFDHE4096
Test.CommonDH: Testing FFDHE6144.
CDH| Keygen on FFDHE6144
CDH| DH responder on FFDHE6144
CDH| Keygen on FFDHE6144
CDH| DH initiator on FFDHE6144
CDH| DH initiator on FFDHE6144
Test.CommonDH: Testing FFDHE8192.
CDH| Keygen on FFDHE8192
CDH| DH responder on FFDHE8192
CDH| Keygen on FFDHE8192
CDH| DH initiator on FFDHE8192
CDH| DH initiator on FFDHE8192
Test.CommonDH: Testing P256.
CDH| Keygen on P256
CDH| DH responder on P256
CDH| Keygen on P256
CDH| DH initiator on P256
CDH| DH initiator on P256
Test.CommonDH: Testing P384.
CDH| Keygen on P384
CDH| DH responder on P384
CDH| Keygen on P384
CDH| DH initiator on P384
CDH| DH initiator on P384
Test.CommonDH: Testing P521.
CDH| Keygen on P521
CDH| DH responder on P521
CDH| Keygen on P521
CDH| DH initiator on P521
CDH| DH initiator on P521
Test.CommonDH: Testing X255519.
CDH| Keygen on X255519
CDH| DH responder on X255519
CDH| Keygen on X255519
CDH| DH initiator on X255519
CDH| DH initiator on X255519
✔ CommonDH
HS | next_fragment
HS | offering ClientHello 1.3
KS | ks_client_init 1.3
CDH| Keygen on X255519
NGO| No PSK or 0-RTT disabled
NGO| offering client extensions [ supported_versions key_share extended_master_secret signature_algorithms ec_point_formats supported_groups psk_key_exchange_modes ]
NGO| offering cipher suites ; TLS_AES_128_GCM_SHA256; TLS_AES_256_GCM_SHA384; TLS_CHACHA20_POLY1305_SHA256; TLS_ECDHE_ECDSA_WITH_AES_128_GCM_SHA256; TLS_ECDHE_RSA_WITH_AES_128_GCM_SHA256; TLS_DHE_RSA_WITH_AES_128_GCM_SHA256; TLS_ECDHE_ECDSA_WITH_AES_256_GCM_SHA384; TLS_ECDHE_RSA_WITH_AES_256_GCM_SHA384; TLS_DHE_RSA_WITH_AES_256_GCM_SHA384; TLS_ECDHE_ECDSA_WITH_CHACHA20_POLY1305_SHA256; TLS_ECDHE_RSA_WITH_CHACHA20_POLY1305_SHA256; TLS_DHE_RSA_WITH_CHACHA20_POLY1305_SHA256
HSL| emit ClientHello
Test.Handshake: ----client-hello---> 010000b303035ae87436...010100002d0003020001 (183 bytes).
HS | recv_fragment
HSL| parsed [ClientHello] -- end of flight 
HS | Processing ClientHello
NGO| offered client extensions [ supported_versions key_share extended_master_secret signature_algorithms ec_point_formats supported_groups psk_key_exchange_modes ]
NGO| offered cipher suites ; TLS_AES_128_GCM_SHA256; TLS_AES_256_GCM_SHA384; TLS_CHACHA20_POLY1305_SHA256; TLS_ECDHE_ECDSA_WITH_AES_128_GCM_SHA256; TLS_ECDHE_RSA_WITH_AES_128_GCM_SHA256; TLS_DHE_RSA_WITH_AES_128_GCM_SHA256; TLS_ECDHE_ECDSA_WITH_AES_256_GCM_SHA384; TLS_ECDHE_RSA_WITH_AES_256_GCM_SHA384; TLS_DHE_RSA_WITH_AES_256_GCM_SHA384; TLS_ECDHE_ECDSA_WITH_CHACHA20_POLY1305_SHA256; TLS_ECDHE_RSA_WITH_CHACHA20_POLY1305_SHA256; TLS_DHE_RSA_WITH_CHACHA20_POLY1305_SHA256
NGO| offered versions 1.3
NGO| Negotiated Pure EDH key exchange
NGO| Negotiated ECDSA_SHA1
NGO| Negotiation callback to handle extra extensions and query for stateless retry.
NGO| Application data in cookie: none
NGO| negotiated 1.3 TLS_AES_128_GCM_SHA256
KS | ks_server_init
KS | No PSK selected.
KS | Computed early secret:           33AD0A1C607EC03B09E6CD9893680CE210ADF300AA1F2660E1B22E10F170F92A
KS | Handshake salt:                  6F2615A108C702C5678F54FC9DBAB69716C076189C48250CEBEAC3576C3611BA
CDH| DH responder on X255519
CDH| Keygen on X255519
CDH| DH initiator on X255519
KS | DH shared secret: 652EA07F92F7EA0AA76C3581CBA148AABC0785B9A32847D97AE001A081BA2B7E
KS | Handshake secret:                2181ABC73E18FB762BAE57289393C0DDFB683394E625F4A34A5FEB707CDC24CB
NGO| processing client extensions [ supported_versions key_share extended_master_secret signature_algorithms ec_point_formats supported_groups psk_key_exchange_modes ]
NGO| including server extensions (SH + EE) [ supported_versions key_share supported_groups ]
NGO| extra extensions from application callback: 
HSL| emit ServerHello and hash
HS | derive handshake keys
KS | ks_server_13_sh, hashed log = 7579FECC00752AA3A8B41F154D53A1CB50005289EB81DF07DA753E5B6403C799
KS | handshake traffic secret[C]:     C4B8EB1158B54834DE638FD4662ABD8C9F44EBE900EBBF49EB680C810F09BABD
KS | handshake traffic secret[S]:     DD17E58A97C50B1043FEEE7209ACF5DE649B3A8BB07A708248D1EA19ADE75A3D
KS | handshake key[C]:                9222E3070FAE2454E1C34258214C6E2B, IV=3EEEE8421CCF84F89E5E00C8
KS | handshake key[S]: 19A7C81D9A7955649B3557F783EE9B52, IV=1071D4261C894C8780367D9B
AEP| LowCProvider: COERCE(K=19a7c81d9a7955649b3557f783ee9b52)
AEP| LowCProvider: COERCE(K=9222e3070fae2454e1c34258214c6e2b)
KS | finished key[C]:                 CFB4BD8AD06B7EDF0F0D0D9C971DF70C40D21417CA3C02DC5478C3A4B3327505
KS | finished key[S]:                 CB2372E2A7E09881B81EC65AA9CDD0C6A784A0D614D90868B0110F885BDB3155
KS | Application salt:                8756CC954BE31120FEBD221BFD298D41DC0D41E519BB01D663116669A40EEA4F
KS | Application secret:              E3D51DED56382F9F950EA8B0C228BF33540FB58FCF28FCCC3406A3799E7521AE
HS | next_fragment
Test.Handshake: <---server-hello---- 0200005603035ae87436...742bae6b490720de9b3a (90 bytes).
HS | recv_fragment
HSL| parsed ServerHello
HSL| end of flight
HS | client_ServerHello
NGO| processing server extensions [ supported_versions key_share ]
NGO| negotiated 1.3 TLS_AES_128_GCM_SHA256
HS | Running TLS 1.3
KS | ks_client_13_sh hashed_log = 7579FECC00752AA3A8B41F154D53A1CB50005289EB81DF07DA753E5B6403C799
KS | no PSK negotiated. Early secret: 33AD0A1C607EC03B09E6CD9893680CE210ADF300AA1F2660E1B22E10F170F92A
KS | handshake salt:                  6F2615A108C702C5678F54FC9DBAB69716C076189C48250CEBEAC3576C3611BA
CDH| DH initiator on X255519
KS | DH shared secret: 652EA07F92F7EA0AA76C3581CBA148AABC0785B9A32847D97AE001A081BA2B7E
KS | handshake secret:                2181ABC73E18FB762BAE57289393C0DDFB683394E625F4A34A5FEB707CDC24CB
KS | handshake traffic secret[C]:     C4B8EB1158B54834DE638FD4662ABD8C9F44EBE900EBBF49EB680C810F09BABD
KS | handshake traffic secret[S]:     DD17E58A97C50B1043FEEE7209ACF5DE649B3A8BB07A708248D1EA19ADE75A3D
KS | handshake key[C]:                9222E3070FAE2454E1C34258214C6E2B, IV=3EEEE8421CCF84F89E5E00C8
KS | handshake key[S]:                19A7C81D9A7955649B3557F783EE9B52, IV=1071D4261C894C8780367D9B
KS | finished key[C]: CFB4BD8AD06B7EDF0F0D0D9C971DF70C40D21417CA3C02DC5478C3A4B3327505
KS | finished key[S]: CB2372E2A7E09881B81EC65AA9CDD0C6A784A0D614D90868B0110F885BDB3155
KS | application salt:                8756CC954BE31120FEBD221BFD298D41DC0D41E519BB01D663116669A40EEA4F
KS | application secret:              E3D51DED56382F9F950EA8B0C228BF33540FB58FCF28FCCC3406A3799E7521AE
AEP| LowCProvider: COERCE(K=9222e3070fae2454e1c34258214c6e2b)
AEP| LowCProvider: COERCE(K=19a7c81d9a7955649b3557f783ee9b52)
EPO| reader++ 0/-1
HS | next_fragment
HS | prepare Server Finished
HSL| emit EncryptedExtensions
HSL| emit Certificate13 and hash
HSL| emit CertificateVerify and hash
HSL| emit Finished and hash
KS | ks_server_13_sf hashed_log = C071793C919B4798A42150D682B87DCFA2E209F0D827626C0A86647C6EFC57D4
KS | application traffic secret[C]:   A733EB2B2AC17DCDB5AEBB066F4E0C3DEFCCB10BC68FD45196B91B55453B1D09
KS | application traffic secret[S]:   305DF20E6297B2E3502127402E8EEFABBD76886266EC2736139B7EADD7FBE011
KS | exporter master secret:          DEAA93CCFB234A981C70E28B3F2F9FC62CE2EAC04E400DD965B5FBD2243FF08D
KS | application key[C]:              7FD59FB6B3E9026AB500A4BDCF8AA3DE, IV=C1F43820BD297A14DCB74066
KS | application key[S]:              129AAB65E1AC86F6CAEA444BCBCDDF6F, IV=2893DB8BD9B8325CC0F7A595
AEP| LowCProvider: COERCE(K=129aab65e1ac86f6caea444bcbcddf6f)
AEP| LowCProvider: COERCE(K=7fd59fb6b3e9026ab500a4bdcf8aa3de)
HS | exporting a key
EPO| reader++ 0/-1
Test.Handshake: <--server-finished-- 080000160014000a0010...1ef9b8f934b6923674fd (710 bytes).
HS | recv_fragment
HSL| parsed EncryptedExtensions
HSL| parsed Certificate13
HSL| parsed CertificateVerify
HSL| parsed Finished
HSL| end of flight
NGO| Nego.clientComplete_13
NGO| EE: supported_groups 
NGO| Negotiation callback to process application extensions.
NGO| Certificate & signature 1.3 callback result: valid
KS | ks_client_13_sf hashed_log = C071793C919B4798A42150D682B87DCFA2E209F0D827626C0A86647C6EFC57D4
KS | application traffic secret[C]:   A733EB2B2AC17DCDB5AEBB066F4E0C3DEFCCB10BC68FD45196B91B55453B1D09
KS | application traffic secret[S]:   305DF20E6297B2E3502127402E8EEFABBD76886266EC2736139B7EADD7FBE011
KS | exporter master secret:          DEAA93CCFB234A981C70E28B3F2F9FC62CE2EAC04E400DD965B5FBD2243FF08D
KS | application key[C]:              7FD59FB6B3E9026AB500A4BDCF8AA3DE, IV=C1F43820BD297A14DCB74066
KS | application key[S]:              129AAB65E1AC86F6CAEA444BCBCDDF6F, IV=2893DB8BD9B8325CC0F7A595
AEP| LowCProvider: COERCE(K=7fd59fb6b3e9026ab500a4bdcf8aa3de)
AEP| LowCProvider: COERCE(K=129aab65e1ac86f6caea444bcbcddf6f)
HS | exporting a key
HS | Early data rejected
EPO| writer++ 0/0
HSL| emit Finished and hash
KS | ks_client_13_cf hashed_log = E4B7C804C32BCB3FA7693E9F7DF7DB9E317DBB0C547143230802A6E3875C6F08
KS | resumption master secret:        71C569C50546ECF6CE3E1FAEC168D17E1634E3B80C637C1D1C340688DC56B10D
EPO| reader++ 1/0
HS | next_fragment
Test.Handshake: --client-finished---> 14000020127c7ba6952d...4d1922975392100b9b63 (36 bytes).
HS | recv_fragment
HSL| parsed Finished
HSL| end of flight
HS | Process Client Finished
KS | ks_server_13_cf hashed_log = E4B7C804C32BCB3FA7693E9F7DF7DB9E317DBB0C547143230802A6E3875C6F08
KS | resumption master secret:        71C569C50546ECF6CE3E1FAEC168D17E1634E3B80C637C1D1C340688DC56B10D
AEP| LowCProvider: COERCE(K=e707f477442e53c5d3a33776debf06f94c8550ae4757bb8f6550819d303e868d)
HS | Sending ticket: 9E1F540B83B4CBBF4DB2090FD0E089CC3FCB32C78071275A871A9C61BF1F0377FA459EA2A30BA5873E5A044974AE964CC254D92E2B77F2C7490F3BE35E1EEC9F9CA69E5C6A75A32AA0065957
HSL| emit NewSessionTicket13
EPO| reader++ 1/-1
HS | next_fragment
Test.Handshake: <--session-ticket-- 0400006500000e10a7c1...6a75a32aa00659570000 (105 bytes).
HS | recv_fragment
HSL| parsed NewSessionTicket13
HSL| end of flight
HS | Received ticket: 9e1f540b83b4cbbf4db2090fd0e089cc3fcb32c78071275a871a9c61bf1f0377fa459ea2a30ba5873e5a044974ae964cc254d92e2b77f2c7490f3be35e1eec9f9ca69e5c6a75a32aa0065957
KS | ks_client_13_rms
KS | Recall RMS: 71c569c50546ecf6ce3e1faec168d17e1634e3b80c637c1d1c340688dc56b10d
Test.Handshake: Done.
✔ Handshake
make[1]: Leaving directory '/cygdrive/c/build/agent2/_work/12/s/mitls-fstar/src/tls'
./cmitls.exe google.com 443
cmitls.exe ===================
cmitls.exe calling FFI_mitls_init
cmitls.exe about to act as client or server
===============================================
Starting test client...
Read OK, sending HTTP request...
Received 693 bytes of data:
Download speed: 1.#INF00kB/s
HTTP/1.1 301 Moved Permanently
Location: https://www.google.com/
Content-Type: text/html; charset=UTF-8
Date: Tue, 01 May 2018 14:05:43 GMT
Expires: Thu, 31 May 2018 14:05:43 GMT
Cache-Control: public, max-age=2592000
Server: gws
Content-Length: 220
X-XSS-Protection: 1; mode=block
X-Frame-Options: SAMEORIGIN
Alt-Svc: hq=":443"; ma=2592000; quic=51303433; quic=51303432; quic=51303431; quic=51303339; quic=51303335,quic=":443"; ma=2592000; v="43,42,41,39,35"

<HTML><HEAD><meta http-equiv="content-type" content="text/html;charset=utf-8">
<TITLE>301 Moved</TITLE></HEAD><BODY>
<H1>301 Moved</H1>
The document has moved
<A HREF="https://www.google.com/">here</A>.
</BODY></HTML>

Closing connection, irrespective of the response
./cmitls.exe tls13.cloudflare.com 443
cmitls.exe ===================
cmitls.exe calling FFI_mitls_init
cmitls.exe about to act as client or server
===============================================
Starting test client...
Read OK, sending HTTP request...
Received 1369 bytes of data:
Download speed: 1.#INF00kB/s
HTTP/1.1 521 Origin Down
+ cd mitls-fstar/apps/quicMinusNet
Date: Tue, 01 May 2018 14:05:43 GMT
Content-Type: text/html; charset=UTF-8
Transfer-Encoding: chunked
+ make test
Connection: keep-alive
Set-Cookie: __cfduid=dabd58a0f4cc4436e9230f64655d3d1d91525183543; expires=Wed, 01-May-19 14:05:43 GMT; path=/; domain=.cloudflare.com; HttpOnly
Expires: Thu, 01 Jan 1970 00:00:01 GMT
Cache-Control: no-store, no-cache, must-revalidate, post-check=0, pre-check=0
Pragma: no-cache
X-Frame-Options: SAMEORIGIN
Set-Cookie: cf_use_ob=443; expires=Tue, 01-May-18 14:06:13 GMT; path=/
Set-Cookie: cf_ob_info=521:4142cdf928a22a9d:SEA; expires=Tue, 01-May-18 14:06:13 GMT; path=/
Strict-Transport-Security: max-age=15780000; includeSubDomains
Expect-CT: max-age=604800, report-uri="https://report-uri.cloudflare.com/cdn-cgi/beacon/expect-ct"
Server: cloudflare
CF-RAY: 4142cdf928a22a9d-SEA

11c7
<!DOCTYPE html>
<!--[if lt IE 7]> <html class="no-js ie6 oldie" lang="en-US"> <![endif]-->
<!--[if IE 7]>    <html class="no-js ie7 oldie" lang="en-US"> <![endif]-->
<!--[if IE 8]>    <html class="no-js ie8 oldie" lang="en-US"> <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en-US"> <!--<![endif]-->
<head>
<meta http-equiv="refresh" content="0">

<title>tls13.cloudflare.com | 521: Web server is down</title>
<meta charset="UTF-8" />
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8
Closing connection, irrespective of the response
./quic.exe
server create
client create
client call clen=8192 slen=   0
client done clen= 175 slen=   0 status=would_block
16030300aa010000a603035ae87437ec69ee1f88b0100a9ddf9ef834ec5f1341
b7f6322c14728cefa09d530000041303130101000079001a0009ffff00050a0b
0c0d0e002b0003027f1c003300260024001d00205f110993a1eadca4af718c5d
c0407890e180ed7232d96406ac27ee045a4b121f0000000e000c0000096c6f63
616c686f73740010000800060568712d303800170000000d0006000408040403
000a00040002001d002d0003020001
server call clen= 175 slen=8192
@@@@ Nego callback for TLS 1.3 @@@@
Offered extensions:
003d001a0009ffff00050a0b0c0d0e0000000e000c0000096c6f63616c686f73
740010000800060568712d3038000d0006000408040403000a00040002001d
Transport parameters offered:
ffff00050a0b0c0d0e
No application cookie (fist connection).
Adding server transport parameters:
000102
@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
======== TO BE SIGNED <0403>: (130 octets) ========
2020202020202020202020202020202020202020202020202020202020202020
2020202020202020202020202020202020202020202020202020202020202020
544c5320312e332c207365727665722043657274696669636174655665726966
7900e369cbdc7b32be49430687366ccfdd9e2b4a183d4080e34021ea489d57ae
bb45
===================================================
sender done clen= 175 slen= 834 status=server_accept
160303005a0200005603035ae874375bb776561a4394309a5a7c4e32f9733eef
6edeaffbf3a14f781a55ba00130300002e002b00027f1c00330024001d002000
894b7329a49d03b952d054edb572283a0a8be9302ec97b5708fb118c7d263217
030302deeaaf3209ed7716b28fb37fa5f6b2b98c7306e4d4629e9c609efa6679
5cf2da8745c765c6fd97aa0004eb0b0ab5906316aa4656fd9aa771e1df148ab6
64bb6952f484bc59a9c5f24b1704cbc13ce2b9970eeaf900cb9170ac74ac257b
1dad7b276e201e131e2bfed47df8e4b3c76f3187fdc77e94618dd676fc9a1425
a5e93730dee2111a4e3b27f7d22a08160d1773bb5629a8cca7bfdec0e698c233
351926153f28b1b2902f60a10dd5d6f55f64edc2192a227e68331d6ad18f9474
01b71fd7e2f01197c33868bd2df1075ebc39de10a5ea6b86346fae34c7020d16
c318a0d4da083f2902c1c64069abdd26f0ea5329c863daef60de5c84491959c1
cab99bdc15115e87af76fc18f282093221a6ce621d0d691a50f54aa5cf59909a
fbb937199426e4c3c564c8d41e9d0a76fa0f788526338be49c0f81d4899c022c
d2909cb733d9d5b329934c87d734ef0875f6cabb30cb0951b5b56e40ae06f54a
ab0b9523d25f28b9533fb78994aa16f147d8875b9145e238012d053c118bae69
e15f3b7bcc24c1b7ce01ea24e34ff70b968e96d82c42521cc00ad2d3600cbed4
fbf460b7ecd882881fee681777e0f9132d7f1544dfb288d9340d0eb1e6aa970c
27b1b6afa619b3448c01f7b2e7a08914567a6d8cc86615d8f4d0cfe3161b98b5
08bf5cde7aa55ec7e91330fa8d54010a975d6c44207249deeb532a86d2a16bb5
712c115c4502c87a8c2daa043d89a69ec5341f6a040cc24e8a477f4a8c5e709f
f74ac58a5e002e97b41fc3111117927c636080e6f8249e997957bac04c507bfd
51b17a61be528eabbef968d1325d98e95d7541c87ddeebcaf850c2159b64629f
14ec7d6b9965849bc32e419e5feb0a6d655e96680a974c8d937309d2ee0e505b
b397946f292e7bd6e8a0373828dd318821d82845def9ab748761ccf24d34274f
2f469e5bb44846d15975ecaf3bb405184b56e41cbcd4b754b464b0abee1a63b4
29a6b3d7defdef00668aad2c970821b2d9918232ec0a2be1d0f10799b4a65879
d887
client call clen=8017 slen= 834
@@@@ Nego callback for TLS 1.3 @@@@
Offered extensions:
001b0010000800060568712d3038000a00040002001d001a0003000102
Transport parameters offered:
000102
No application cookie (fist connection).
Adding server transport parameters:
000102
@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
WARNING: chain validation failed, ignoring.
client done clen=  58 slen= 834 status=client_complete
170303003527235bc06d8c2cd568bddb317287674a9ff1f748e1a074ff46bcf2
dc47be67583b985768775bc4f75f5d9740a92956c84fb5a624ba
server call clen=  58 slen=7358
sender done clen=  58 slen=   0 status=server_complete
=== Exporter secret ===
cb9800858884c4f34e4aa394d343bb5eeaaacd6a6957b46c2823c8a5a5e81d83
=== QUIC 1-RTT secrets ===
C: 42bebf31dfe2d7186a4a946895ba8c330b9f898d83beb3bc529992d5aa9365ef
S: 178db66c2e9f81672dc32c55b946d5b7a099999aac1e9bd33e4e2da81c3aa31e
=== AEAD client key test ===
fc7be2194c560e54eaabe49d61834621b77b2b80cff2604b827ec3
=== Decrypt successful ===
Ok
./quic.exe 0rtt

INITIAL ECDHE HANDSHAKE (NO EARLY SECRET)

server create
client create
client returns would_block clen=175 slen=0
ClientHello[ 175] ---->

@@@@ Nego callback for TLS 1.3 @@@@
Offered extensions:
003d001a0009ffff00050a0b0c0d0e0000000e000c0000096c6f63616c686f73
740010000800060568712d3038000d0006000408040403000a00040002001d
Transport parameters offered:
ffff00050a0b0c0d0e
No application cookie (fist connection).
Adding server transport parameters:
000102
@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
======== TO BE SIGNED <0403>: (130 octets) ========
2020202020202020202020202020202020202020202020202020202020202020
2020202020202020202020202020202020202020202020202020202020202020
544c5320312e332c207365727665722043657274696669636174655665726966
7900cf102cc491e5b1b272cfe31b2c14d67906de9690d3356a90f287fabac649
c45d
===================================================
server returns server_accept clen=175 slen=835
secret=50674fe118ef2f93b2fca78a705a064e8d7a2a92ac04c497b4385b4f98d9d72c
<---- ServerHello;(EncryptedExtensions; Certificate; CertVerify; Finished)[ 835]

@@@@ Nego callback for TLS 1.3 @@@@
+ set +x
Offered extensions:
001b0010000800060568712d3038000a00040002001d001a0003000102
Transport parameters offered:
000102
No application cookie (fist connection).
Adding server transport parameters:
000102
@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
WARNING: chain validation failed, ignoring.
client returns client_complete clen=58 slen=835
secret=50674fe118ef2f93b2fca78a705a064e8d7a2a92ac04c497b4385b4f98d9d72c
(Finished) [  58] ---->

server returns server_complete clen=58 slen=0
server returns would_block clen=0 slen=135
<---- {Ticket}[ 135]

##### New session ticket received! #####
Host: localhost
Ticket:
9fe6df6956ba169479cc6e7a0248512d88ddabdf59b2f6d105e451dec4ea1b1e
52320f6ee98eaeda70b5c70c7e56ffde24744a9ea5f9c68854654de2049110c0
8267f1b647ea72ed7db519fd
########################################
client returns clen=0 slen=135 status=would_block

TICKET-BASED RESUMPTION

server create
client create
client returns client_early_data clen=302 slen=0
early secret=9fb3caf0262671d1cd2c5f41f3cffcd645092739b1e30b6f1e9218f581c62c49
ClientHello[ 302] ---->

@@@@ Nego callback for TLS 1.3 @@@@
Offered extensions:
003d001a0009ffff00050a0b0c0d0e0000000e000c0000096c6f63616c686f73
740010000800060568712d3038000d0006000408040403000a00040002001d
Transport parameters offered:
ffff00050a0b0c0d0e
No application cookie (fist connection).
Adding server transport parameters:
000102
@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
server returns server_accept_early_data clen=302 slen=196
early secret=9fb3caf0262671d1cd2c5f41f3cffcd645092739b1e30b6f1e9218f581c62c49
secret=ba449a37482a3c1a93dc8e2323a3507abb3cdb94292bd23b95afb7077c7c4f44
<---- ServerHello;(EncryptedExtensions; Certificate; CertVerify; Finished)[ 196]

@@@@ Nego callback for TLS 1.3 @@@@
Offered extensions:
001b0010000800060568712d3038000a00040002001d001a0003000102
Transport parameters offered:
000102
No application cookie (fist connection).
Adding server transport parameters:
000102
@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
client returns client_complete_early_data clen=84 slen=196
secret=ba449a37482a3c1a93dc8e2323a3507abb3cdb94292bd23b95afb7077c7c4f44
(Finished) [  84] ---->

server returns clen=84 slen=0 status=server_complete
server returns would_block clen=0 slen=135
<---- {Ticket}[ 135]

##### New session ticket received! #####
Host: localhost
Ticket:
7716be6cdbbcc6b7332605e1e3dc1efc5cb9ddd58932fb28c26ed04f6dd15d17
2a8060e61c2eddc769dee66bfe9f31a0283b54d6ba5a43cea6295b14856fecd8
a6fb35e11b22ea5ffe511f38
########################################
client returns clen=0 slen=135 status=would_block
Ok
./quic.exe hrr

STATELESS RETRY TEST

server create
client create
client returns would_block clen=175 slen=0
ClientHello[ 175] ---->

~~~~~~~~~ Client Hello Summary ~~~~~~~~~~~
~ SNI = localhost
~ ALPN = 00060568712d3038
~ Cookie = NULL
~ Extensions = 0079001a0009ffff00050a0b0c0d0e002b0003027f1c003300260024001d0020
2200bf98cfad34426c5f6f68b00385b0defb959dfa5abb18c402933654c34520
0000000e000c0000096c6f63616c686f73740010000800060568712d30380017
0000000d0006000408040403000a00040002001d002d0003020001
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
@@@@ Nego callback for TLS 1.3 @@@@
Offered extensions:
003d001a0009ffff00050a0b0c0d0e0000000e000c0000096c6f63616c686f73
740010000800060568712d3038000d0006000408040403000a00040002001d
Transport parameters offered:
ffff00050a0b0c0d0e
No application cookie (fist connection).
Adding server transport parameters:
000102
@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
server returns server_stateless_retry clen=175 slen=188
<---- HRR[ 188]

server re-create
client returns would_block clen=308 slen=188
ClientHello2[ 308] ---->

~~~~~~~~~ Client Hello Summary ~~~~~~~~~~~
~ SNI = localhost
~ ALPN = 00060568712d3038
~ Cookie = 48656c6c6f20576f726c64
~ Extensions = 00fe002c0081007f90ed21df85493e536b7d197dbbded79619a6f731a13a2a34
a97c5de16097bb5900ef44e0556cbebe4e2636c2ed1ac0cea89c6be8ebfc2444
604e98087fa787a8997f6ca9419b9adf0fbb4751319bc2284a95e43b698ba29b
5694ebf7c1ece73a468957af3c19b1b7b0211b1b689484f547f373ff0b81a683
d589f80d564a9a001a0009ffff00050a0b0c0d0e002b0003027f1c0033002600
24001d00202200bf98cfad34426c5f6f68b00385b0defb959dfa5abb18c40293
3654c345200000000e000c0000096c6f63616c686f7374001000080006056871
2d303800170000000d0006000408040403000a00040002001d002d0003020001
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
@@@@ Nego callback for TLS 1.3 @@@@
Offered extensions:
003d001a0009ffff00050a0b0c0d0e0000000e000c0000096c6f63616c686f73
740010000800060568712d3038000d0006000408040403000a00040002001d
Transport parameters offered:
ffff00050a0b0c0d0e
Stateless cookie found, application contents:
48656c6c6f20576f726c64
Adding server transport parameters:
000102
@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
======== TO BE SIGNED <0403>: (130 octets) ========
2020202020202020202020202020202020202020202020202020202020202020
2020202020202020202020202020202020202020202020202020202020202020
544c5320312e332c207365727665722043657274696669636174655665726966
7900a987eece96d156908c3637a0d3c571e7ba6c64dcfaef6fa670262d16779a
e7e0
===================================================
server returns server_accept clen=308 slen=833
secret=983858ee981bf76328395809743407c39cd68efe46e22f80ce4e1cb3612a035d
<---- ServerHello;(EncryptedExtensions; Certificate; CertVerify; Finished)[ 833]

@@@@ Nego callback for TLS 1.3 @@@@
Offered extensions:
001b0010000800060568712d3038000a00040002001d001a0003000102
Transport parameters offered:
000102
No application cookie (fist connection).
Adding server transport parameters:
000102
@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
WARNING: chain validation failed, ignoring.
client returns client_complete clen=58 slen=833
secret=983858ee981bf76328395809743407c39cd68efe46e22f80ce4e1cb3612a035d
(Finished) [  58] ---->

server returns server_complete clen=58 slen=0
server returns would_block clen=0 slen=135
<---- {Ticket}[ 135]

##### New session ticket received! #####
Host: localhost
Ticket:
bcfa30ba2bf11136d03fbbfa4d706fea1968b058fef059e2c1238555a49b5109
2d744a531df9a9b82e79b4054454f61e364a7cf4a7297f85ca860f44245ef426
724d14421ca5a8ecc52f3e9e
########################################
client returns clen=0 slen=135 status=would_block
Ok
================================================================================
