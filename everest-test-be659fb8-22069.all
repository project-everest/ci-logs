This is /home/everbld/everest-ci/ci
Working directory: /cygdrive/c/build/agent2/_work/6/s
About to run: ./everest --yes -j 16 test
BUILD_SOURCEBRANCHNAME: protz_uint128
BUILD_DEFINITIONNAME: Everest-CI-Windows
BUILD_BUILDID: 22069
DEFINITIONNAME:
Z3 is /home/everbld/everest/z3-4.5.1.1f29cebd4df6-x64-win/bin/z3
# Switching to the everest directory ... now in /cygdrive/c/build/agent2/_work/6/s

exported FSTAR_HOME=C:/build/agent2/_work/6/s/FStar
exported OPENSSL_HOME=C:/build/agent2/_work/6/s/MLCrypto/openssl
exported KREMLIN_HOME=C:/build/agent2/_work/6/s/kremlin
exported VALE_HOME=C:/build/agent2/_work/6/s/vale
exported HACL_HOME=C:/build/agent2/_work/6/s/hacl-star
exported MLCRYPTO_HOME=C:/build/agent2/_work/6/s/MLCrypto
exported PATH=/cygdrive/c/build/agent2/_work/6/s/MLCrypto/openssl:/cygdrive/c/build/agent2/_work/6/s/FStar/bin:/cygdrive/c/build/agent2/_work/6/s/kremlin:/home/everbld/.opam/4.05.0+mingw64c/bin:/cygdrive/c/Windows/Microsoft.NET/Framework64/v4.0.30319/:/home/everbld/everest/nuget/bin:/home/everbld/everest/z3-4.5.1.1f29cebd4df6-x64-win/bin:/cygdrive/c/PROGRA~2/MICROS~1.0/VC/bin/amd64:/cygdrive/c/PROGRA~2/MICROS~1.0/VC/bin:/cygdrive/c/PROGRA~2/MICROS~4/F#/4.0/FRAMEW~1/v4.0/:/usr/x86_64-w64-mingw32/sys-root/mingw/bin:/usr/local/bin:/usr/bin:/cygdrive/c/build/agent2/externals/git/cmd:/cygdrive/c/Python36/Scripts:/cygdrive/c/Python36:/cygdrive/c/Docker/Resources/bin:/cygdrive/c/windows/system32:/cygdrive/c/windows:/cygdrive/c/windows/System32/Wbem:/cygdrive/c/windows/System32/WindowsPowerShell/v1.0:/cygdrive/c/Users/everbld/AppData/Local/Microsoft/WindowsApps:/cygdrive/c/Program Files/Docker/Docker/resources/bin:%USERPROFILE%/.dnx/bin:/cygdrive/c/Program Files/Microsoft DNX/Dnvm:/cygdrive/c/Program Files/Microsoft SQL Server/120/Tools/Binn:/cygdrive/c/Program Files/Microsoft SQL Server/130/Tools/Binn:/cygdrive/c/Program Files/dotnet:/cygdrive/c/Program Files/nodejs:/usr/bin:/cygdrive/c/Program Files/Git/mingw64/bin:/cygdrive/c/Users/everbld/AppData/Roaming/npm:/cygdrive/c/build/agent2/bin:/cygdrive/c/build/agent2/bin
+ hacl-star/secure_api/out/vale_aes_concrete_id/krml-test.exe
================================================================================
Running tests (commands shown below)
test()
[test] expected output cipher is d31a8d34648e60db7b86afbc53ef7ec2a4aded51296e08fea9e2b5a736ee62d63dbea45e8ca9671282fafb69da92728b1a71de0a9e060b2905d6a5b67ecd3b3692ddbd7f2d778b8c9803aee328091b58fab324e4fad675945585808b4831d7bc3ff4def08e4b7a9de576d26586cec64b61161ae10b594f09e26a7e902ecbd0600691
+ hacl-star/secure_api/out/hacl_aes_concrete_id/krml-test.exe
[test] computed output cipher is d31a8d34648e60db7b86afbc53ef7ec2a4aded51296e08fea9e2b5a736ee62d63dbea45e8ca9671282fafb69da92728b1a71de0a9e060b2905d6a5b67ecd3b3692ddbd7f2d778b8c9803aee328091b58fab324e4fad675945585808b4831d7bc3ff4def08e4b7a9de576d26586cec64b61161ae10b594f09e26a7e902ecbd0600691
[test] cipher is a success
[test] expected output decryption is 4c616469657320616e642047656e746c656d656e206f662074686520636c617373206f66202739393a204966204920636f756c64206f6666657220796f75206f6e6c79206f6e652074697020666f7220746865206675747572652c2073756e73637265656e20776f756c642062652069742e
[test] computed output decryption is 4c616469657320616e642047656e746c656d656e206f662074686520636c617373206f66202739393a204966204920636f756c64206f6666657220796f75206f6e6c79206f6e652074697020666f7220746865206675747572652c2073756e73637265656e20776f756c642062652069742e
[test] decryption is a success
test_aes_gcm_0()
[test] expected output cipher is 58e2fccefa7e3061367f1d57a4e7455a
[test] computed output cipher is 58e2fccefa7e3061367f1d57a4e7455a
[test] cipher is a success
[test] expected output decryption is 
[test] computed output decryption is 
[test] decryption is a success
test_aes_gcm_1()
[test] expected output cipher is 530f8afbc74536b9a963b4f1c4cb738b
[test] computed output cipher is 530f8afbc74536b9a963b4f1c4cb738b
[test] cipher is a success
[test] expected output decryption is 
[test] computed output decryption is 
+ make -C hacl-star/secure_api -f Makefile.extract test
[test] decryption is a success
test_aes_gcm_2()
[test] expected output cipher is cea7403d4d606b6e074ec5d3baf39d18d0d1c8a799996bf0265b98b5d48ab919
[test] computed output cipher is cea7403d4d606b6e074ec5d3baf39d18d0d1c8a799996bf0265b98b5d48ab919
[test] cipher is a success
[test] expected output decryption is 00000000000000000000000000000000
[test] computed output decryption is 00000000000000000000000000000000
[test] decryption is a success
test_aes_gcm_3()
[test] expected output cipher is 522dc1f099567d07f47f37a32a84427d643a8cdcbfe5c0c97598a2bd2555d1aa8cb08e48590dbb3da7b08b1056828838c5f61e6393ba7a0abcc9f662898015adb094dac5d93471bdec1a502270e3cc6c
[test] computed output cipher is 522dc1f099567d07f47f37a32a84427d643a8cdcbfe5c0c97598a2bd2555d1aa8cb08e48590dbb3da7b08b1056828838c5f61e6393ba7a0abcc9f662898015adb094dac5d93471bdec1a502270e3cc6c
[test] cipher is a success
[test] expected output decryption is d9313225f88406e5a55909c5aff5269a86a7a9531534f7da2e4c303d8a318a721c3c0c95956809532fcf0e2449a6b525b16aedf5aa0de657ba637b391aafd255
[test] computed output decryption is d9313225f88406e5a55909c5aff5269a86a7a9531534f7da2e4c303d8a318a721c3c0c95956809532fcf0e2449a6b525b16aedf5aa0de657ba637b391aafd255
[test] decryption is a success
test_aes_gcm_4()
[test] expected output cipher is 522dc1f099567d07f47f37a32a84427d643a8cdcbfe5c0c97598a2bd2555d1aa8cb08e48590dbb3da7b08b1056828838c5f61e6393ba7a0abcc9f66276fc6ece0f4e1768cddf8853bb2d551b
[test] computed output cipher is 522dc1f099567d07f47f37a32a84427d643a8cdcbfe5c0c97598a2bd2555d1aa8cb08e48590dbb3da7b08b1056828838c5f61e6393ba7a0abcc9f66276fc6ece0f4e1768cddf8853bb2d551b
[test] cipher is a success
[test] expected output decryption is d9313225f88406e5a55909c5aff5269a86a7a9531534f7da2e4c303d8a318a721c3c0c95956809532fcf0e2449a6b525b16aedf5aa0de657ba637b39
[test] computed output decryption is d9313225f88406e5a55909c5aff5269a86a7a9531534f7da2e4c303d8a318a721c3c0c95956809532fcf0e2449a6b525b16aedf5aa0de657ba637b39
[test] decryption is a success
test()
[test] expected output cipher is d31a8d34648e60db7b86afbc53ef7ec2a4aded51296e08fea9e2b5a736ee62d63dbea45e8ca9671282fafb69da92728b1a71de0a9e060b2905d6a5b67ecd3b3692ddbd7f2d778b8c9803aee328091b58fab324e4fad675945585808b4831d7bc3ff4def08e4b7a9de576d26586cec64b61161ae10b594f09e26a7e902ecbd0600691
[test] computed output cipher is d31a8d34648e60db7b86afbc53ef7ec2a4aded51296e08fea9e2b5a736ee62d63dbea45e8ca9671282fafb69da92728b1a71de0a9e060b2905d6a5b67ecd3b3692ddbd7f2d778b8c9803aee328091b58fab324e4fad675945585808b4831d7bc3ff4def08e4b7a9de576d26586cec64b61161ae10b594f09e26a7e902ecbd0600691
[test] cipher is a success
[test] expected output decryption is 4c616469657320616e642047656e746c656d656e206f662074686520636c617373206f66202739393a204966204920636f756c64206f6666657220796f75206f6e6c79206f6e652074697020666f7220746865206675747572652c2073756e73637265656e20776f756c642062652069742e
[test] computed output decryption is 4c616469657320616e642047656e746c656d656e206f662074686520636c617373206f66202739393a204966204920636f756c64206f6666657220796f75206f6e6c79206f6e652074697020666f7220746865206675747572652c2073756e73637265656e20776f756c642062652069742e
[test] decryption is a success
test_aes_gcm_0()
[test] expected output cipher is 58e2fccefa7e3061367f1d57a4e7455a
[test] computed output cipher is 58e2fccefa7e3061367f1d57a4e7455a
[test] cipher is a success
[test] expected output decryption is 
[test] computed output decryption is 
[test] decryption is a success
test_aes_gcm_1()
[test] expected output cipher is 530f8afbc74536b9a963b4f1c4cb738b
[test] computed output cipher is 530f8afbc74536b9a963b4f1c4cb738b
[test] cipher is a success
[test] expected output decryption is 
[test] computed output decryption is 
[test] decryption is a success
test_aes_gcm_2()
[test] expected output cipher is cea7403d4d606b6e074ec5d3baf39d18d0d1c8a799996bf0265b98b5d48ab919
[test] computed output cipher is cea7403d4d606b6e074ec5d3baf39d18d0d1c8a799996bf0265b98b5d48ab919
[test] cipher is a success
[test] expected output decryption is 00000000000000000000000000000000
[test] computed output decryption is 00000000000000000000000000000000
[test] decryption is a success
test_aes_gcm_3()
[test] expected output cipher is 522dc1f099567d07f47f37a32a84427d643a8cdcbfe5c0c97598a2bd2555d1aa8cb08e48590dbb3da7b08b1056828838c5f61e6393ba7a0abcc9f662898015adb094dac5d93471bdec1a502270e3cc6c
[test] computed output cipher is 522dc1f099567d07f47f37a32a84427d643a8cdcbfe5c0c97598a2bd2555d1aa8cb08e48590dbb3da7b08b1056828838c5f61e6393ba7a0abcc9f662898015adb094dac5d93471bdec1a502270e3cc6c
[test] cipher is a success
[test] expected output decryption is d9313225f88406e5a55909c5aff5269a86a7a9531534f7da2e4c303d8a318a721c3c0c95956809532fcf0e2449a6b525b16aedf5aa0de657ba637b391aafd255
[test] computed output decryption is d9313225f88406e5a55909c5aff5269a86a7a9531534f7da2e4c303d8a318a721c3c0c95956809532fcf0e2449a6b525b16aedf5aa0de657ba637b391aafd255
[test] decryption is a success
test_aes_gcm_4()
[test] expected output cipher is 522dc1f099567d07f47f37a32a84427d643a8cdcbfe5c0c97598a2bd2555d1aa8cb08e48590dbb3da7b08b1056828838c5f61e6393ba7a0abcc9f66276fc6ece0f4e1768cddf8853bb2d551b
[test] computed output cipher is 522dc1f099567d07f47f37a32a84427d643a8cdcbfe5c0c97598a2bd2555d1aa8cb08e48590dbb3da7b08b1056828838c5f61e6393ba7a0abcc9f66276fc6ece0f4e1768cddf8853bb2d551b
[test] cipher is a success
[test] expected output decryption is d9313225f88406e5a55909c5aff5269a86a7a9531534f7da2e4c303d8a318a721c3c0c95956809532fcf0e2449a6b525b16aedf5aa0de657ba637b39
[test] computed output decryption is d9313225f88406e5a55909c5aff5269a86a7a9531534f7da2e4c303d8a318a721c3c0c95956809532fcf0e2449a6b525b16aedf5aa0de657ba637b39
[test] decryption is a success
make: Entering directory '/cygdrive/c/build/agent2/_work/6/s/hacl-star/secure_api'
C:/build/agent2/_work/6/s/FStar/bin/fstar.exe --print_z3_statistics --use_hints --query_stats --cache_dir ../secure_api/out/runtime_switch/cache --cache_checked_modules --include ../specs --include ../code/bignum --include ../code/experimental/aesgcm --include ../code/lib/kremlin --include ../code/poly1305 --include ../code/hash --include ../code/salsa-family --include C:/build/agent2/_work/6/s/kremlin/kremlib --include ../secure_api --include ../secure_api/aead --include ../secure_api/prf --include ../secure_api/hkdf --include ../secure_api/vale --include ../secure_api/uf1cma --include ../secure_api/utils --include ../secure_api/LowCProvider/fst --include C:/build/agent2/_work/6/s/FStar/contrib/CoreCrypto/fst --include ../secure_api/concrete_specializations --include ../secure_api/concrete_specializations/runtime_switch --include ../secure_api/test --odir ../secure_api/out/runtime_switch/extracted --use_hints --lax \
prims.fst \
--codegen Kremlin \
--extract_module prims
All verification conditions discharged successfully
TOTAL TIME 40 ms: C:\build\agent2\_work\6\s\FStar\bin\fstar.exe --print_z3_statistics --use_hints --query_stats --cache_dir ../secure_api/out/runtime_switch/cache --cache_checked_modules --include ../specs --include ../code/bignum --include ../code/experimental/aesgcm --include ../code/lib/kremlin --include ../code/poly1305 --include ../code/hash --include ../code/salsa-family --include C:/build/agent2/_work/6/s/kremlin/kremlib --include ../secure_api --include ../secure_api/aead --include ../secure_api/prf --include ../secure_api/hkdf --include ../secure_api/vale --include ../secure_api/uf1cma --include ../secure_api/utils --include ../secure_api/LowCProvider/fst --include C:/build/agent2/_work/6/s/FStar/contrib/CoreCrypto/fst --include ../secure_api/concrete_specializations --include ../secure_api/concrete_specializations/runtime_switch --include ../secure_api/test --odir ../secure_api/out/runtime_switch/extracted --use_hints --lax prims.fst --codegen Kremlin --extract_module prims
C:/build/agent2/_work/6/s/kremlin/krml  -no-prefix KrmlTest -bundle \
Hacl.Impl.Poly1305_64+Hacl.Impl.Chacha20=Hacl.*,Spec,Spec.* -bundle \
Crypto.AEAD.Main=Crypto.* -tmpdir ../secure_api/out/runtime_switch/extracted \
-add-include '"kremlin/internal/compat.h"' \
../secure_api/out/runtime_switch/extracted/prims.krml ../secure_api/out/runtime_switch/extracted/FStar_Pervasives_Native.krml ../secure_api/out/runtime_switch/extracted/FStar_Pervasives.krml ../secure_api/out/runtime_switch/extracted/FStar_Mul.krml ../secure_api/out/runtime_switch/extracted/FStar_Math_Lib.krml ../secure_api/out/runtime_switch/extracted/FStar_Math_Lemmas.krml ../secure_api/out/runtime_switch/extracted/FStar_Squash.krml ../secure_api/out/runtime_switch/extracted/FStar_StrongExcludedMiddle.krml ../secure_api/out/runtime_switch/extracted/FStar_Classical.krml ../secure_api/out/runtime_switch/extracted/FStar_List_Tot_Base.krml ../secure_api/out/runtime_switch/extracted/FStar_List_Tot_Properties.krml ../secure_api/out/runtime_switch/extracted/FStar_List_Tot.krml ../secure_api/out/runtime_switch/extracted/FStar_Seq_Base.krml ../secure_api/out/runtime_switch/extracted/FStar_Seq_Properties.krml ../secure_api/out/runtime_switch/extracted/FStar_Seq.krml ../secure_api/out/runtime_switch/extracted/FStar_BitVector.krml ../secure_api/out/runtime_switch/extracted/FStar_UInt.krml ../secure_api/out/runtime_switch/extracted/FStar_UInt32.krml ../secure_api/out/runtime_switch/extracted/FStar_Int.krml ../secure_api/out/runtime_switch/extracted/FStar_Int64.krml ../secure_api/out/runtime_switch/extracted/FStar_Int63.krml ../secure_api/out/runtime_switch/extracted/FStar_Int32.krml ../secure_api/out/runtime_switch/extracted/FStar_Int16.krml ../secure_api/out/runtime_switch/extracted/FStar_Int8.krml ../secure_api/out/runtime_switch/extracted/FStar_UInt64.krml ../secure_api/out/runtime_switch/extracted/FStar_UInt63.krml ../secure_api/out/runtime_switch/extracted/FStar_UInt16.krml ../secure_api/out/runtime_switch/extracted/FStar_UInt8.krml ../secure_api/out/runtime_switch/extracted/FStar_Int_Cast.krml ../secure_api/out/runtime_switch/extracted/FStar_UInt128.krml ../secure_api/out/runtime_switch/extracted/Hacl_UInt64.krml ../secure_api/out/runtime_switch/extracted/FStar_Preorder.krml ../secure_api/out/runtime_switch/extracted/FStar_Ghost.krml ../secure_api/out/runtime_switch/extracted/FStar_ErasedLogic.krml ../secure_api/out/runtime_switch/extracted/FStar_FunctionalExtensionality.krml ../secure_api/out/runtime_switch/extracted/FStar_Set.krml ../secure_api/out/runtime_switch/extracted/FStar_PropositionalExtensionality.krml ../secure_api/out/runtime_switch/extracted/FStar_PredicateExtensionality.krml ../secure_api/out/runtime_switch/extracted/FStar_TSet.krml ../secure_api/out/runtime_switch/extracted/FStar_Monotonic_Heap.krml ../secure_api/out/runtime_switch/extracted/FStar_Heap.krml ../secure_api/out/runtime_switch/extracted/FStar_Map.krml ../secure_api/out/runtime_switch/extracted/FStar_Monotonic_HyperHeap.krml ../secure_api/out/runtime_switch/extracted/FStar_Monotonic_HyperStack.krml ../secure_api/out/runtime_switch/extracted/FStar_HyperStack.krml ../secure_api/out/runtime_switch/extracted/FStar_Monotonic_Witnessed.krml ../secure_api/out/runtime_switch/extracted/FStar_HyperStack_ST.krml ../secure_api/out/runtime_switch/extracted/FStar_HyperStack_All.krml ../secure_api/out/runtime_switch/extracted/Hacl_UInt128.krml ../secure_api/out/runtime_switch/extracted/Hacl_UInt8.krml ../secure_api/out/runtime_switch/extracted/Hacl_Bignum_Constants.krml ../secure_api/out/runtime_switch/extracted/Hacl_UInt32.krml ../secure_api/out/runtime_switch/extracted/FStar_Int_Cast_Full.krml ../secure_api/out/runtime_switch/extracted/Hacl_Cast.krml ../secure_api/out/runtime_switch/extracted/FStar_Buffer.krml ../secure_api/out/runtime_switch/extracted/Hacl_Bignum_Parameters.krml ../secure_api/out/runtime_switch/extracted/Hacl_Bignum_Wide.krml ../secure_api/out/runtime_switch/extracted/Spec_Loops.krml ../secure_api/out/runtime_switch/extracted/Hacl_Bignum_Limb.krml ../secure_api/out/runtime_switch/extracted/Hacl_Spec_Bignum_Field.krml ../secure_api/out/runtime_switch/extracted/Hacl_Spec_Bignum_Bigint.krml ../secure_api/out/runtime_switch/extracted/Hacl_Spec_Bignum_Modulo.krml ../secure_api/out/runtime_switch/extracted/Hacl_Spec_Bignum_Fproduct.krml ../secure_api/out/runtime_switch/extracted/Hacl_Spec_Bignum_Fmul.krml ../secure_api/out/runtime_switch/extracted/FStar_Endianness.krml ../secure_api/out/runtime_switch/extracted/Spec_Poly1305_Lemmas.krml ../secure_api/out/runtime_switch/extracted/FStar_Kremlin_Endianness.krml ../secure_api/out/runtime_switch/extracted/C_Endianness.krml ../secure_api/out/runtime_switch/extracted/C.krml ../secure_api/out/runtime_switch/extracted/Hacl_UInt16.krml ../secure_api/out/runtime_switch/extracted/Hacl_Spec_Endianness.krml ../secure_api/out/runtime_switch/extracted/Hacl_Endianness.krml ../secure_api/out/runtime_switch/extracted/Spec_Lib.krml ../secure_api/out/runtime_switch/extracted/Seq_Create.krml ../secure_api/out/runtime_switch/extracted/Spec_SHA2_256.krml ../secure_api/out/runtime_switch/extracted/C_Loops.krml ../secure_api/out/runtime_switch/extracted/Hacl_Hash_Lib_LoadStore.krml ../secure_api/out/runtime_switch/extracted/Hacl_Hash_Lib_Create.krml ../secure_api/out/runtime_switch/extracted/Hacl_Impl_SHA2_256_Lemmas.krml ../secure_api/out/runtime_switch/extracted/Hacl_Impl_SHA2_256.krml ../secure_api/out/runtime_switch/extracted/Hacl_Spec_Bignum_Fsum.krml ../secure_api/out/runtime_switch/extracted/Hacl_Bignum_Fsum.krml ../secure_api/out/runtime_switch/extracted/Crypto_AEAD_BufferUtils.krml ../secure_api/out/runtime_switch/extracted/Vale_AES.krml ../secure_api/out/runtime_switch/extracted/Hacl_Impl_Xor_Lemmas.krml ../secure_api/out/runtime_switch/extracted/Spec_CTR_Lemmas.krml ../secure_api/out/runtime_switch/extracted/Spec_CTR.krml ../secure_api/out/runtime_switch/extracted/Hacl_Lib_LoadStore32.krml ../secure_api/out/runtime_switch/extracted/Spec_Chacha20_Lemmas.krml ../secure_api/out/runtime_switch/extracted/Spec_Chacha20.krml ../secure_api/out/runtime_switch/extracted/Hacl_Impl_Chacha20.krml ../secure_api/out/runtime_switch/extracted/Hacl_SecureAPI_Chacha20.krml ../secure_api/out/runtime_switch/extracted/Crypto_Indexing.krml ../secure_api/out/runtime_switch/extracted/Flag.krml ../secure_api/out/runtime_switch/extracted/Crypto_Symmetric_AES.krml ../secure_api/out/runtime_switch/extracted/Crypto_Symmetric_AES128.krml ../secure_api/out/runtime_switch/extracted/FStar_Float.krml ../secure_api/out/runtime_switch/extracted/FStar_Exn.krml ../secure_api/out/runtime_switch/extracted/FStar_ST.krml ../secure_api/out/runtime_switch/extracted/FStar_All.krml ../secure_api/out/runtime_switch/extracted/FStar_IO.krml ../secure_api/out/runtime_switch/extracted/Buffer_Utils.krml ../secure_api/out/runtime_switch/extracted/Crypto_Symmetric_Bytes.krml ../secure_api/out/runtime_switch/extracted/Crypto_Symmetric_Cipher.krml ../secure_api/out/runtime_switch/extracted/C_Nullity.krml ../secure_api/out/runtime_switch/extracted/Hacl_Spec_Bignum_AddAndMultiply.krml ../secure_api/out/runtime_switch/extracted/Spec_Poly1305.krml ../secure_api/out/runtime_switch/extracted/Hacl_Bignum_Modulo.krml ../secure_api/out/runtime_switch/extracted/Hacl_Bignum_Fproduct.krml ../secure_api/out/runtime_switch/extracted/Hacl_Spec_Poly1305_64_State.krml ../secure_api/out/runtime_switch/extracted/Hacl_Spec_Poly1305_64.krml ../secure_api/out/runtime_switch/extracted/Hacl_Impl_Poly1305_64_State.krml ../secure_api/out/runtime_switch/extracted/Hacl_Bignum_Fmul.krml ../secure_api/out/runtime_switch/extracted/Hacl_Bignum_AddAndMultiply.krml ../secure_api/out/runtime_switch/extracted/Hacl_Spe_Poly1305_64.krml ../secure_api/out/runtime_switch/extracted/Hacl_Impl_Poly1305_64.krml ../secure_api/out/runtime_switch/extracted/Spec_GaloisField.krml ../secure_api/out/runtime_switch/extracted/Spec_GF128.krml ../secure_api/out/runtime_switch/extracted/Crypto_Symmetric_GF128.krml ../secure_api/out/runtime_switch/extracted/Crypto_Symmetric_MAC.krml ../secure_api/out/runtime_switch/extracted/Crypto_Symmetric_UF1CMA.krml ../secure_api/out/runtime_switch/extracted/Crypto_Plain.krml ../secure_api/out/runtime_switch/extracted/Crypto_Symmetric_PRF.krml ../secure_api/out/runtime_switch/extracted/Crypto_AEAD_Encoding.krml ../secure_api/out/runtime_switch/extracted/Crypto_AEAD_Invariant.krml ../secure_api/out/runtime_switch/extracted/Crypto_AEAD_Encrypt_Invariant.krml ../secure_api/out/runtime_switch/extracted/Crypto_AEAD_Wrappers_PRF.krml ../secure_api/out/runtime_switch/extracted/Crypto_AEAD_Wrappers_Encoding.krml ../secure_api/out/runtime_switch/extracted/Crypto_AEAD_Wrappers_CMA.krml ../secure_api/out/runtime_switch/extracted/Crypto_AEAD_EnxorDexor.krml ../secure_api/out/runtime_switch/extracted/Crypto_AEAD_Decrypt.krml ../secure_api/out/runtime_switch/extracted/Spec_HMAC_SHA2_256.krml ../secure_api/out/runtime_switch/extracted/Spec_SHA2_512.krml ../secure_api/out/runtime_switch/extracted/Hacl_Impl_SHA2_512_Lemmas.krml ../secure_api/out/runtime_switch/extracted/Hacl_Impl_SHA2_512.krml ../secure_api/out/runtime_switch/extracted/Spec_SHA2_384.krml ../secure_api/out/runtime_switch/extracted/Hacl_Impl_SHA2_384_Lemmas.krml ../secure_api/out/runtime_switch/extracted/Hacl_Impl_SHA2_384.krml ../secure_api/out/runtime_switch/extracted/Crypto_HMAC.krml ../secure_api/out/runtime_switch/extracted/Crypto_AEAD_Encrypt_Ideal_Invariant.krml ../secure_api/out/runtime_switch/extracted/Crypto_AEAD_MAC_Wrapper_Invariant.krml ../secure_api/out/runtime_switch/extracted/Crypto_AEAD_Enxor_Invariant.krml ../secure_api/out/runtime_switch/extracted/Crypto_AEAD_Encrypt.krml ../secure_api/out/runtime_switch/extracted/Crypto_AEAD.krml ../secure_api/out/runtime_switch/extracted/FStar_List.krml ../secure_api/out/runtime_switch/extracted/FStar_Char.krml ../secure_api/out/runtime_switch/extracted/FStar_String.krml ../secure_api/out/runtime_switch/extracted/C_String.krml ../secure_api/out/runtime_switch/extracted/TestLib.krml ../secure_api/out/runtime_switch/extracted/FStar_Bytes.krml ../secure_api/out/runtime_switch/extracted/Crypto_AEAD_Main.krml ../secure_api/out/runtime_switch/extracted/CryptoTypes.krml ../secure_api/out/runtime_switch/extracted/Crypto_HKDF.krml ../secure_api/out/runtime_switch/extracted/HaclProvider.krml ../secure_api/out/runtime_switch/extracted/KrmlTest.krml ../secure_api/out/runtime_switch/extracted/LowCProvider.krml vale/asm/sha256_main_i.o vale/asm/sha256-x86_64.o vale/asm/Vale_Hash_SHA2_256.o vale/asm/vale_aes_glue.o vale/asm/aes-x86_64.o -o ../secure_api/out/runtime_switch/krml-test.exe \
-drop HaclProvider,LowCProvider,CryptoTypes
Warning 10: : -drop is deprecated
use a combination of -bundle and -d reachability to make sure the functions are eliminated as you wish
Warning 6: in top-level declaration Crypto.Plain.create, in file Crypto_AEAD_Main: stack newbuf @1 @0 is a non-constant size, stack-allocated array; this is not supported by CompCert and requires the use of alloca(3) for MSVC
Warning 6: in the definition of keyBuffer, after the definition of h0, in the last element of the sequence, after the definition of macId, in top-level declaration Crypto.Symmetric.PRF.prf_mac, in file Crypto_AEAD_Main: stack newbuf 0uint8 Crypto.Symmetric.UF1CMA.keylen @5 is a non-constant size, stack-allocated array; this is not supported by CompCert and requires the use of alloca(3) for MSVC
Warning 6: in the definition of cipher1, after the definition of cipherlen, in the last element of the sequence, in top-level declaration KrmlTest.test, in file KrmlTest: stack newbuf 0uint8 @0 is a non-constant size, stack-allocated array; this is not supported by CompCert and requires the use of alloca(3) for MSVC
Warning 6: in the definition of cipher1, after the definition of cipherlen, in the last element of the sequence, in top-level declaration KrmlTest.test_aes_gcm, in file KrmlTest: stack newbuf 2uint8 @0 is a non-constant size, stack-allocated array; this is not supported by CompCert and requires the use of alloca(3) for MSVC
Warning 6: in the definition of plain, after the definition of plainlen, in top-level declaration KrmlTest.test_aes_gcm_0, in file KrmlTest: stack newbuf 0uint8 @0 is a non-constant size, stack-allocated array; this is not supported by CompCert and requires the use of alloca(3) for MSVC
Warning 6: in the definition of aad, after the definition of aadlen, in top-level declaration KrmlTest.test_aes_gcm_0, in file KrmlTest: stack newbuf 0uint8 @0 is a non-constant size, stack-allocated array; this is not supported by CompCert and requires the use of alloca(3) for MSVC
Warning 6: in the definition of plain, after the definition of plainlen, in top-level declaration KrmlTest.test_aes_gcm_1, in file KrmlTest: stack newbuf 0uint8 @0 is a non-constant size, stack-allocated array; this is not supported by CompCert and requires the use of alloca(3) for MSVC
Warning 6: in the definition of aad, after the definition of aadlen, in top-level declaration KrmlTest.test_aes_gcm_1, in file KrmlTest: stack newbuf 0uint8 @0 is a non-constant size, stack-allocated array; this is not supported by CompCert and requires the use of alloca(3) for MSVC
Warning 6: in the definition of plain, after the definition of plainlen, in top-level declaration KrmlTest.test_aes_gcm_2, in file KrmlTest: stack newbuf 0uint8 @0 is a non-constant size, stack-allocated array; this is not supported by CompCert and requires the use of alloca(3) for MSVC
Warning 6: in the definition of aad, after the definition of aadlen, in top-level declaration KrmlTest.test_aes_gcm_2, in file KrmlTest: stack newbuf 0uint8 @0 is a non-constant size, stack-allocated array; this is not supported by CompCert and requires the use of alloca(3) for MSVC
Warning 6: in the definition of aad, after the definition of aadlen, in top-level declaration KrmlTest.test_aes_gcm_3, in file KrmlTest: stack newbuf 0uint8 @0 is a non-constant size, stack-allocated array; this is not supported by CompCert and requires the use of alloca(3) for MSVC
[38;5;119m✔[0m [Monomorphization] ⏱️ 78ms
[38;5;119m✔[0m [Inlining] ⏱️ 78ms
[38;5;119m✔[0m [Pattern matches compilation] ⏱️ 63ms
[38;5;119m✔[0m [Simplify 2] ⏱️ 328ms
Warning 7: : After inlining, Crypto.Symmetric.MAC.update (going into Crypto_AEAD_Main) calls Hacl.Impl.Poly1305_64.State.poly1305_state (going into Hacl_Impl_Poly1305_64_Hacl_Impl_Chacha20) -- removing the static qualifier from Hacl.Impl.Poly1305_64.State.poly1305_state
Warning 8: : After inlining, Crypto.Symmetric.MAC.update (going into Crypto_AEAD_Main) calls Hacl.Impl.Poly1305_64.poly1305_update (going into Hacl_Impl_Poly1305_64_Hacl_Impl_Chacha20). This is a call across translation units but Hacl.Impl.Poly1305_64.poly1305_update has a C "inline" qualifier. The C standard allows removing Hacl.Impl.Poly1305_64.poly1305_update from its translation unit (see C11 6.7.3 §5), and CompCert will do it. 
Warning 8: : After inlining, Crypto.Symmetric.MAC.finish (going into Crypto_AEAD_Main) calls Hacl.Impl.Poly1305_64.poly1305_process_last_block (going into Hacl_Impl_Poly1305_64_Hacl_Impl_Chacha20). This is a call across translation units but Hacl.Impl.Poly1305_64.poly1305_process_last_block has a C "inline" qualifier. The C standard allows removing Hacl.Impl.Poly1305_64.poly1305_process_last_block from its translation unit (see C11 6.7.3 §5), and CompCert will do it. 
Warning 8: : After inlining, Crypto.Symmetric.Cipher.compute (going into Crypto_AEAD_Main) calls Hacl.Impl.Chacha20.setup (going into Hacl_Impl_Poly1305_64_Hacl_Impl_Chacha20). This is a call across translation units but Hacl.Impl.Chacha20.setup has a C "inline" qualifier. The C standard allows removing Hacl.Impl.Chacha20.setup from its translation unit (see C11 6.7.3 §5), and CompCert will do it. 
Warning 8: : After inlining, Crypto.Symmetric.Cipher.compute (going into Crypto_AEAD_Main) calls Hacl.Impl.Chacha20.copy_state (going into Hacl_Impl_Poly1305_64_Hacl_Impl_Chacha20). This is a call across translation units but Hacl.Impl.Chacha20.copy_state has a C "inline" qualifier. The C standard allows removing Hacl.Impl.Chacha20.copy_state from its translation unit (see C11 6.7.3 §5), and CompCert will do it. 
Warning 8: : After inlining, Crypto.Symmetric.Cipher.compute (going into Crypto_AEAD_Main) calls Hacl.Impl.Chacha20.rounds (going into Hacl_Impl_Poly1305_64_Hacl_Impl_Chacha20). This is a call across translation units but Hacl.Impl.Chacha20.rounds has a C "inline" qualifier. The C standard allows removing Hacl.Impl.Chacha20.rounds from its translation unit (see C11 6.7.3 §5), and CompCert will do it. 
Warning 8: : After inlining, Crypto.Symmetric.Cipher.compute (going into Crypto_AEAD_Main) calls Hacl.Impl.Chacha20.sum_states (going into Hacl_Impl_Poly1305_64_Hacl_Impl_Chacha20). This is a call across translation units but Hacl.Impl.Chacha20.sum_states has a C "inline" qualifier. The C standard allows removing Hacl.Impl.Chacha20.sum_states from its translation unit (see C11 6.7.3 §5), and CompCert will do it. 
Warning 7: : After inlining, Crypto.Symmetric.Cipher.compute (going into Crypto_AEAD_Main) calls Hacl.Lib.LoadStore32.uint32s_to_le_bytes (going into Hacl_Impl_Poly1305_64_Hacl_Impl_Chacha20) -- removing the static qualifier from Hacl.Lib.LoadStore32.uint32s_to_le_bytes
Warning 7: : After inlining, KrmlTest.test (going into KrmlTest) calls Crypto.Indexing.id (going into Crypto_AEAD_Main) -- removing the static qualifier from Crypto.Indexing.id
[38;5;119m✔[0m [Structs + Simplify 2] ⏱️ 359ms
Warning 7: : After inlining, KrmlTest.test (going into KrmlTest) calls Crypto.Indexing.aeadAlg (going into Crypto_AEAD_Main) -- removing the static qualifier from Crypto.Indexing.aeadAlg
[38;5;119m✔[0m [Drop] ⏱️ <1ms
Warning 7: : After inlining, KrmlTest.test (going into KrmlTest) calls Crypto.Indexing.testId (going into Crypto_AEAD_Main) -- removing the static qualifier from Crypto.Indexing.testId
Warning 7: : After inlining, KrmlTest.test (going into KrmlTest) calls Crypto.Plain.unsafe_hide_buffer (going into Crypto_AEAD_Main) -- removing the static qualifier from Crypto.Plain.unsafe_hide_buffer
Warning 7: : After inlining, KrmlTest.test (going into KrmlTest) calls Crypto.Symmetric.Bytes.load_bytes (going into Crypto_AEAD_Main) -- removing the static qualifier from Crypto.Symmetric.Bytes.load_bytes
Warning 7: : After inlining, KrmlTest.test (going into KrmlTest) calls Crypto.Symmetric.Bytes.load_uint128 (going into Crypto_AEAD_Main) -- removing the static qualifier from Crypto.Symmetric.Bytes.load_uint128
Warning 7: : After inlining, KrmlTest.test (going into KrmlTest) calls Crypto.AEAD.Invariant.aead_state (going into Crypto_AEAD_Main) -- removing the static qualifier from Crypto.AEAD.Invariant.aead_state
Warning 7: : After inlining, KrmlTest.test (going into KrmlTest) calls Crypto.Plain.bufferRepr (going into Crypto_AEAD_Main) -- removing the static qualifier from Crypto.Plain.bufferRepr
Warning 7: : After inlining, Flag.cipher_prf (going into Flag) calls Crypto.Indexing.cipherAlg (going into Crypto_AEAD_Main) -- removing the static qualifier from Crypto.Indexing.cipherAlg
Warning 7: : After inlining, Flag.mac_int1cma (going into Flag) calls Crypto.Indexing.macAlg (going into Crypto_AEAD_Main) -- removing the static qualifier from Crypto.Indexing.macAlg
[38;5;119m✔[0m [AstToCStar] ⏱️ 16ms
[38;5;119m✔[0m [CStarToC] ⏱️ 16ms
Warning 14: : Crypto.AEAD.Invariant.safelen is not Low*; it uses mathematical integers and runtime checks may fail; rewrite your code to use machine integers, or if you must, use -add-include '"prims_int.h"'; if this declaration is for specification purposes only, consider marking it noextract or using -bundle <name-of-the-module> to only keep reachable definitions.
Warning 14: : Crypto.AEAD.Invariant.maxplain is not Low*; it uses mathematical integers and runtime checks may fail; rewrite your code to use machine integers, or if you must, use -add-include '"prims_int.h"'; if this declaration is for specification purposes only, consider marking it noextract or using -bundle <name-of-the-module> to only keep reachable definitions.
Warning 14: : FStar.Seq.Base.cons__uint8_t is not Low*; it uses a garbage-collected type (e.g. list) and will leak memory; you need to link with a garbage-collector; if this declaration is for specification purposes only, consider marking it noextract or using -bundle <name-of-the-module> to only keep reachable definitions.
Warning 14: : FStar.Seq.Base.append__uint8_t is not Low*; it uses a garbage-collected type (e.g. list) and will leak memory; you need to link with a garbage-collector; if this declaration is for specification purposes only, consider marking it noextract or using -bundle <name-of-the-module> to only keep reachable definitions.
Warning 14: : FStar.Seq.Base.createEmpty__uint8_t is not Low*; it uses a garbage-collected type (e.g. list) and will leak memory; you need to link with a garbage-collector; if this declaration is for specification purposes only, consider marking it noextract or using -bundle <name-of-the-module> to only keep reachable definitions.
Warning 14: : FStar.Seq.Base.seq__uint8_t is not Low*; it uses a garbage-collected type (e.g. list) and will leak memory; you need to link with a garbage-collector; if this declaration is for specification purposes only, consider marking it noextract or using -bundle <name-of-the-module> to only keep reachable definitions.
Warning 14: : Prims.list__uint8_t is not Low*; it uses a garbage-collected type (e.g. list) and will leak memory; you need to link with a garbage-collector; if this declaration is for specification purposes only, consider marking it noextract or using -bundle <name-of-the-module> to only keep reachable definitions.
Warning 14: : Prims.pow2 is not Low*; it uses mathematical integers and runtime checks may fail; rewrite your code to use machine integers, or if you must, use -add-include '"prims_int.h"'; if this declaration is for specification purposes only, consider marking it noextract or using -bundle <name-of-the-module> to only keep reachable definitions.
Warning 14: : Prims.op_LessThanOrEqual is not Low*; it uses mathematical integers and runtime checks may fail; rewrite your code to use machine integers, or if you must, use -add-include '"prims_int.h"'; if this declaration is for specification purposes only, consider marking it noextract or using -bundle <name-of-the-module> to only keep reachable definitions.
Warning 14: : Prims.op_Addition is not Low*; it uses mathematical integers and runtime checks may fail; rewrite your code to use machine integers, or if you must, use -add-include '"prims_int.h"'; if this declaration is for specification purposes only, consider marking it noextract or using -bundle <name-of-the-module> to only keep reachable definitions.
Warning 14: : Prims.op_Subtraction is not Low*; it uses mathematical integers and runtime checks may fail; rewrite your code to use machine integers, or if you must, use -add-include '"prims_int.h"'; if this declaration is for specification purposes only, consider marking it noextract or using -bundle <name-of-the-module> to only keep reachable definitions.
Warning 14: : Prims.op_Multiply is not Low*; it uses mathematical integers and runtime checks may fail; rewrite your code to use machine integers, or if you must, use -add-include '"prims_int.h"'; if this declaration is for specification purposes only, consider marking it noextract or using -bundle <name-of-the-module> to only keep reachable definitions.
Warning 14: : C.String.of_literal is not Low*; it uses F*'s Prims.string type and will leak memory; you need to link with a garbage-collector; if this declaration is for specification purposes only, consider marking it noextract or using -bundle <name-of-the-module> to only keep reachable definitions; if you are looking to use C strings, look into C.String (in kremlib/) and Server (in test/). See the KreMLin tutorial for more information.
[38;5;81m⚙ KreMLin auto-detecting tools.[0m Here's what we found:
[4mreadlink is:[0m readlink
[4mKreMLin called via:[0m C:\build\agent2\_work\6\s\kremlin\_build\src\Kremlin.native
[4mthe Kremlin executable is:[0m C:\build\agent2\_work\6\s\kremlin\_build\src\Kremlin.native
[4mKreMLin home is:[0m C:/build/agent2/_work/6/s/kremlin
[38;5;81m⚙ KreMLin will drive F*.[0m Here's what we found:
read FSTAR_HOME via the environment
[4mfstar converted to windows path:[0m C:/build/agent2/_work/6/s/FStar/bin/fstar.exe
[4mfstar home converted to windows path:[0m C:/build/agent2/_work/6/s/FStar
[4mfstar lib converted to windows path:[0m C:/build/agent2/_work/6/s/FStar/ulib
fstar is on [38;5;202mbranch protz_uint128[0m
[4mfstar is:[0m C:/build/agent2/_work/6/s/FStar/bin/fstar.exe C:/build/agent2/_work/6/s/kremlin/runtime/WasmSupport.fst C:/build/agent2/_work/6/s/FStar/ulib/FStar.UInt128.fst --trace_error --cache_checked_modules --expose_interfaces --include C:/build/agent2/_work/6/s/kremlin/include --include C:/build/agent2/_work/6/s/kremlin/kremlib
[38;5;119m✔[0m [PrettyPrinting] ⏱️ 16ms
KreMLin: wrote out .c files for C_String, TestLib, C_Loops_Spec_Loops, Prims, FStar, Buffer_Utils, C_Endianness, C_Nullity, Vale_AES, Seq_Create, C, Hacl_Impl_Poly1305_64_Hacl_Impl_Chacha20, Crypto_AEAD_Main, KrmlTest, Flag, LowStar
KreMLin: wrote out .h files for C_String, TestLib, C_Loops_Spec_Loops, Prims, FStar, Buffer_Utils, C_Endianness, C_Nullity, Vale_AES, Seq_Create, C, Hacl_Impl_Poly1305_64_Hacl_Impl_Chacha20, Crypto_AEAD_Main, KrmlTest, Flag, LowStar
[38;5;81m⚙ KreMLin will drive the C compiler.[0m Here's what we found:
[4mgcc is:[0m x86_64-w64-mingw32-gcc
[4mx86_64-w64-mingw32-gcc options are:[0m -I C:/build/agent2/_work/6/s/kremlin/include -I C:/build/agent2/_work/6/s/kremlin/kremlib -I ../secure_api/out/runtime_switch/extracted -Wall -Werror -Wno-unused-variable -Wno-unknown-warning-option -Wno-unused-but-set-variable -g -fwrapv -fstack-check -D_BSD_SOURCE -D_DEFAULT_SOURCE -D__USE_MINGW_ANSI_STDIO -Wno-parentheses -std=c11
[38;5;81m⚡ Generating object files[0m
[38;5;119m✔[0m [CC,../secure_api/out/runtime_switch/extracted/C_String.c] (use -verbose to see the output)
[38;5;119m✔[0m [CC,../secure_api/out/runtime_switch/extracted/TestLib.c] (use -verbose to see the output)
[38;5;119m✔[0m [CC,../secure_api/out/runtime_switch/extracted/C_Loops_Spec_Loops.c] (use -verbose to see the output)
[38;5;119m✔[0m [CC,../secure_api/out/runtime_switch/extracted/Prims.c] (use -verbose to see the output)
[38;5;119m✔[0m [CC,../secure_api/out/runtime_switch/extracted/FStar.c] (use -verbose to see the output)
[38;5;119m✔[0m [CC,../secure_api/out/runtime_switch/extracted/Buffer_Utils.c] (use -verbose to see the output)
[38;5;119m✔[0m [CC,../secure_api/out/runtime_switch/extracted/C_Endianness.c] (use -verbose to see the output)
[38;5;119m✔[0m [CC,../secure_api/out/runtime_switch/extracted/C_Nullity.c] (use -verbose to see the output)
[38;5;119m✔[0m [CC,../secure_api/out/runtime_switch/extracted/Vale_AES.c] (use -verbose to see the output)
[38;5;119m✔[0m [CC,../secure_api/out/runtime_switch/extracted/Seq_Create.c] (use -verbose to see the output)
[38;5;119m✔[0m [CC,../secure_api/out/runtime_switch/extracted/C.c] (use -verbose to see the output)
[38;5;119m✔[0m [CC,../secure_api/out/runtime_switch/extracted/Hacl_Impl_Poly1305_64_Hacl_Impl_Chacha20.c] (use -verbose to see the output)
[38;5;119m✔[0m [CC,../secure_api/out/runtime_switch/extracted/Crypto_AEAD_Main.c] (use -verbose to see the output)
[38;5;119m✔[0m [CC,../secure_api/out/runtime_switch/extracted/KrmlTest.c] (use -verbose to see the output)
[38;5;119m✔[0m [CC,../secure_api/out/runtime_switch/extracted/Flag.c] (use -verbose to see the output)
[38;5;119m✔[0m [CC,../secure_api/out/runtime_switch/extracted/LowStar.c] (use -verbose to see the output)
[38;5;119m✔[0m [LD] (use -verbose to see the output)
[38;5;119mAll files linked successfully[0m 👍
./../secure_api/out/runtime_switch/krml-test.exe
test()
[test] expected output cipher is d31a8d34648e60db7b86afbc53ef7ec2a4aded51296e08fea9e2b5a736ee62d63dbea45e8ca9671282fafb69da92728b1a71de0a9e060b2905d6a5b67ecd3b3692ddbd7f2d778b8c9803aee328091b58fab324e4fad675945585808b4831d7bc3ff4def08e4b7a9de576d26586cec64b61161ae10b594f09e26a7e902ecbd0600691
[test] computed output cipher is d31a8d34648e60db7b86afbc53ef7ec2a4aded51296e08fea9e2b5a736ee62d63dbea45e8ca9671282fafb69da92728b1a71de0a9e060b2905d6a5b67ecd3b3692ddbd7f2d778b8c9803aee328091b58fab324e4fad675945585808b4831d7bc3ff4def08e4b7a9de576d26586cec64b61161ae10b594f09e26a7e902ecbd0600691
[test] cipher is a success
[test] expected output decryption is 4c616469657320616e642047656e746c656d656e206f662074686520636c617373206f66202739393a204966204920636f756c64206f6666657220796f75206f6e6c79206f6e652074697020666f7220746865206675747572652c2073756e73637265656e20776f756c642062652069742e
[test] computed output decryption is 4c616469657320616e642047656e746c656d656e206f662074686520636c617373206f66202739393a204966204920636f756c64206f6666657220796f75206f6e6c79206f6e652074697020666f7220746865206675747572652c2073756e73637265656e20776f756c642062652069742e
[test] decryption is a success
test_aes_gcm_0()
[test] expected output cipher is 58e2fccefa7e3061367f1d57a4e7455a
[test] computed output cipher is 58e2fccefa7e3061367f1d57a4e7455a
[test] cipher is a success
[test] expected output decryption is 
[test] computed output decryption is 
[test] decryption is a success
test_aes_gcm_1()
[test] expected output cipher is 530f8afbc74536b9a963b4f1c4cb738b
[test] computed output cipher is 530f8afbc74536b9a963b4f1c4cb738b
[test] cipher is a success
[test] expected output decryption is 
[test] computed output decryption is 
[test] decryption is a success
test_aes_gcm_2()
[test] expected output cipher is cea7403d4d606b6e074ec5d3baf39d18d0d1c8a799996bf0265b98b5d48ab919
[test] computed output cipher is cea7403d4d606b6e074ec5d3baf39d18d0d1c8a799996bf0265b98b5d48ab919
[test] cipher is a success
[test] expected output decryption is 00000000000000000000000000000000
[test] computed output decryption is 00000000000000000000000000000000
[test] decryption is a success
test_aes_gcm_3()
[test] expected output cipher is 522dc1f099567d07f47f37a32a84427d643a8cdcbfe5c0c97598a2bd2555d1aa8cb08e48590dbb3da7b08b1056828838c5f61e6393ba7a0abcc9f662898015adb094dac5d93471bdec1a502270e3cc6c
[test] computed output cipher is 522dc1f099567d07f47f37a32a84427d643a8cdcbfe5c0c97598a2bd2555d1aa8cb08e48590dbb3da7b08b1056828838c5f61e6393ba7a0abcc9f662898015adb094dac5d93471bdec1a502270e3cc6c
[test] cipher is a success
[test] expected output decryption is d9313225f88406e5a55909c5aff5269a86a7a9531534f7da2e4c303d8a318a721c3c0c95956809532fcf0e2449a6b525b16aedf5aa0de657ba637b391aafd255
[test] computed output decryption is d9313225f88406e5a55909c5aff5269a86a7a9531534f7da2e4c303d8a318a721c3c0c95956809532fcf0e2449a6b525b16aedf5aa0de657ba637b391aafd255
[test] decryption is a success
test_aes_gcm_4()
[test] expected output cipher is 522dc1f099567d07f47f37a32a84427d643a8cdcbfe5c0c97598a2bd2555d1aa8cb08e48590dbb3da7b08b1056828838c5f61e6393ba7a0abcc9f66276fc6ece0f4e1768cddf8853bb2d551b
[test] computed output cipher is 522dc1f099567d07f47f37a32a84427d643a8cdcbfe5c0c97598a2bd2555d1aa8cb08e48590dbb3da7b08b1056828838c5f61e6393ba7a0abcc9f66276fc6ece0f4e1768cddf8853bb2d551b
[test] cipher is a success
[test] expected output decryption is d9313225f88406e5a55909c5aff5269a86a7a9531534f7da2e4c303d8a318a721c3c0c95956809532fcf0e2449a6b525b16aedf5aa0de657ba637b39
[test] computed output decryption is d9313225f88406e5a55909c5aff5269a86a7a9531534f7da2e4c303d8a318a721c3c0c95956809532fcf0e2449a6b525b16aedf5aa0de657ba637b39
[test] decryption is a success
make -C C:/build/agent2/_work/6/s/MLCrypto
make[1]: Entering directory '/cygdrive/c/build/agent2/_work/6/s/MLCrypto'
make[1]: Nothing to be done for 'all'.
make[1]: Leaving directory '/cygdrive/c/build/agent2/_work/6/s/MLCrypto'
OCAMLPATH="C:/build/agent2/_work/6/s/FStar/bin" ocamlfind opt -package fstarlib,zarith -g -I C:/build/agent2/_work/6/s/FStar/ulib/ml -c LowCProvider/LowCProvider.ml -I LowCProvider -I ../secure_api/out/runtime_switch -I ../secure_api/out/runtime_switch/extracted -I C:/build/agent2/_work/6/s/MLCrypto -o LowCProvider/LowCProvider.cmx
C:/build/agent2/_work/6/s/kremlin/krml  -bundle 'Crypto_Symmetric_Bytes=*' -minimal -skip-compilation \
-tmpdir ../secure_api/out/runtime_switch/crypto ../secure_api/out/runtime_switch/extracted/prims.krml ../secure_api/out/runtime_switch/extracted/FStar_Pervasives_Native.krml ../secure_api/out/runtime_switch/extracted/FStar_Pervasives.krml ../secure_api/out/runtime_switch/extracted/FStar_Mul.krml ../secure_api/out/runtime_switch/extracted/FStar_Math_Lib.krml ../secure_api/out/runtime_switch/extracted/FStar_Math_Lemmas.krml ../secure_api/out/runtime_switch/extracted/FStar_Squash.krml ../secure_api/out/runtime_switch/extracted/FStar_StrongExcludedMiddle.krml ../secure_api/out/runtime_switch/extracted/FStar_Classical.krml ../secure_api/out/runtime_switch/extracted/FStar_List_Tot_Base.krml ../secure_api/out/runtime_switch/extracted/FStar_List_Tot_Properties.krml ../secure_api/out/runtime_switch/extracted/FStar_List_Tot.krml ../secure_api/out/runtime_switch/extracted/FStar_Seq_Base.krml ../secure_api/out/runtime_switch/extracted/FStar_Seq_Properties.krml ../secure_api/out/runtime_switch/extracted/FStar_Seq.krml ../secure_api/out/runtime_switch/extracted/FStar_BitVector.krml ../secure_api/out/runtime_switch/extracted/FStar_UInt.krml ../secure_api/out/runtime_switch/extracted/FStar_UInt32.krml ../secure_api/out/runtime_switch/extracted/FStar_Int.krml ../secure_api/out/runtime_switch/extracted/FStar_Int64.krml ../secure_api/out/runtime_switch/extracted/FStar_Int63.krml ../secure_api/out/runtime_switch/extracted/FStar_Int32.krml ../secure_api/out/runtime_switch/extracted/FStar_Int16.krml ../secure_api/out/runtime_switch/extracted/FStar_Int8.krml ../secure_api/out/runtime_switch/extracted/FStar_UInt64.krml ../secure_api/out/runtime_switch/extracted/FStar_UInt63.krml ../secure_api/out/runtime_switch/extracted/FStar_UInt16.krml ../secure_api/out/runtime_switch/extracted/FStar_UInt8.krml ../secure_api/out/runtime_switch/extracted/FStar_Int_Cast.krml ../secure_api/out/runtime_switch/extracted/FStar_UInt128.krml ../secure_api/out/runtime_switch/extracted/Hacl_UInt64.krml ../secure_api/out/runtime_switch/extracted/FStar_Preorder.krml ../secure_api/out/runtime_switch/extracted/FStar_Ghost.krml ../secure_api/out/runtime_switch/extracted/FStar_ErasedLogic.krml ../secure_api/out/runtime_switch/extracted/FStar_FunctionalExtensionality.krml ../secure_api/out/runtime_switch/extracted/FStar_Set.krml ../secure_api/out/runtime_switch/extracted/FStar_PropositionalExtensionality.krml ../secure_api/out/runtime_switch/extracted/FStar_PredicateExtensionality.krml ../secure_api/out/runtime_switch/extracted/FStar_TSet.krml ../secure_api/out/runtime_switch/extracted/FStar_Monotonic_Heap.krml ../secure_api/out/runtime_switch/extracted/FStar_Heap.krml ../secure_api/out/runtime_switch/extracted/FStar_Map.krml ../secure_api/out/runtime_switch/extracted/FStar_Monotonic_HyperHeap.krml ../secure_api/out/runtime_switch/extracted/FStar_Monotonic_HyperStack.krml ../secure_api/out/runtime_switch/extracted/FStar_HyperStack.krml ../secure_api/out/runtime_switch/extracted/FStar_Monotonic_Witnessed.krml ../secure_api/out/runtime_switch/extracted/FStar_HyperStack_ST.krml ../secure_api/out/runtime_switch/extracted/FStar_HyperStack_All.krml ../secure_api/out/runtime_switch/extracted/Hacl_UInt128.krml ../secure_api/out/runtime_switch/extracted/Hacl_UInt8.krml ../secure_api/out/runtime_switch/extracted/Hacl_Bignum_Constants.krml ../secure_api/out/runtime_switch/extracted/Hacl_UInt32.krml ../secure_api/out/runtime_switch/extracted/FStar_Int_Cast_Full.krml ../secure_api/out/runtime_switch/extracted/Hacl_Cast.krml ../secure_api/out/runtime_switch/extracted/FStar_Buffer.krml ../secure_api/out/runtime_switch/extracted/Hacl_Bignum_Parameters.krml ../secure_api/out/runtime_switch/extracted/Hacl_Bignum_Wide.krml ../secure_api/out/runtime_switch/extracted/Spec_Loops.krml ../secure_api/out/runtime_switch/extracted/Hacl_Bignum_Limb.krml ../secure_api/out/runtime_switch/extracted/Hacl_Spec_Bignum_Field.krml ../secure_api/out/runtime_switch/extracted/Hacl_Spec_Bignum_Bigint.krml ../secure_api/out/runtime_switch/extracted/Hacl_Spec_Bignum_Modulo.krml ../secure_api/out/runtime_switch/extracted/Hacl_Spec_Bignum_Fproduct.krml ../secure_api/out/runtime_switch/extracted/Hacl_Spec_Bignum_Fmul.krml ../secure_api/out/runtime_switch/extracted/FStar_Endianness.krml ../secure_api/out/runtime_switch/extracted/Spec_Poly1305_Lemmas.krml ../secure_api/out/runtime_switch/extracted/FStar_Kremlin_Endianness.krml ../secure_api/out/runtime_switch/extracted/C_Endianness.krml ../secure_api/out/runtime_switch/extracted/C.krml ../secure_api/out/runtime_switch/extracted/Hacl_UInt16.krml ../secure_api/out/runtime_switch/extracted/Hacl_Spec_Endianness.krml ../secure_api/out/runtime_switch/extracted/Hacl_Endianness.krml ../secure_api/out/runtime_switch/extracted/Spec_Lib.krml ../secure_api/out/runtime_switch/extracted/Seq_Create.krml ../secure_api/out/runtime_switch/extracted/Spec_SHA2_256.krml ../secure_api/out/runtime_switch/extracted/C_Loops.krml ../secure_api/out/runtime_switch/extracted/Hacl_Hash_Lib_LoadStore.krml ../secure_api/out/runtime_switch/extracted/Hacl_Hash_Lib_Create.krml ../secure_api/out/runtime_switch/extracted/Hacl_Impl_SHA2_256_Lemmas.krml ../secure_api/out/runtime_switch/extracted/Hacl_Impl_SHA2_256.krml ../secure_api/out/runtime_switch/extracted/Hacl_Spec_Bignum_Fsum.krml ../secure_api/out/runtime_switch/extracted/Hacl_Bignum_Fsum.krml ../secure_api/out/runtime_switch/extracted/Crypto_AEAD_BufferUtils.krml ../secure_api/out/runtime_switch/extracted/Vale_AES.krml ../secure_api/out/runtime_switch/extracted/Hacl_Impl_Xor_Lemmas.krml ../secure_api/out/runtime_switch/extracted/Spec_CTR_Lemmas.krml ../secure_api/out/runtime_switch/extracted/Spec_CTR.krml ../secure_api/out/runtime_switch/extracted/Hacl_Lib_LoadStore32.krml ../secure_api/out/runtime_switch/extracted/Spec_Chacha20_Lemmas.krml ../secure_api/out/runtime_switch/extracted/Spec_Chacha20.krml ../secure_api/out/runtime_switch/extracted/Hacl_Impl_Chacha20.krml ../secure_api/out/runtime_switch/extracted/Hacl_SecureAPI_Chacha20.krml ../secure_api/out/runtime_switch/extracted/Crypto_Indexing.krml ../secure_api/out/runtime_switch/extracted/Flag.krml ../secure_api/out/runtime_switch/extracted/Crypto_Symmetric_AES.krml ../secure_api/out/runtime_switch/extracted/Crypto_Symmetric_AES128.krml ../secure_api/out/runtime_switch/extracted/FStar_Float.krml ../secure_api/out/runtime_switch/extracted/FStar_Exn.krml ../secure_api/out/runtime_switch/extracted/FStar_ST.krml ../secure_api/out/runtime_switch/extracted/FStar_All.krml ../secure_api/out/runtime_switch/extracted/FStar_IO.krml ../secure_api/out/runtime_switch/extracted/Buffer_Utils.krml ../secure_api/out/runtime_switch/extracted/Crypto_Symmetric_Bytes.krml ../secure_api/out/runtime_switch/extracted/Crypto_Symmetric_Cipher.krml ../secure_api/out/runtime_switch/extracted/C_Nullity.krml ../secure_api/out/runtime_switch/extracted/Hacl_Spec_Bignum_AddAndMultiply.krml ../secure_api/out/runtime_switch/extracted/Spec_Poly1305.krml ../secure_api/out/runtime_switch/extracted/Hacl_Bignum_Modulo.krml ../secure_api/out/runtime_switch/extracted/Hacl_Bignum_Fproduct.krml ../secure_api/out/runtime_switch/extracted/Hacl_Spec_Poly1305_64_State.krml ../secure_api/out/runtime_switch/extracted/Hacl_Spec_Poly1305_64.krml ../secure_api/out/runtime_switch/extracted/Hacl_Impl_Poly1305_64_State.krml ../secure_api/out/runtime_switch/extracted/Hacl_Bignum_Fmul.krml ../secure_api/out/runtime_switch/extracted/Hacl_Bignum_AddAndMultiply.krml ../secure_api/out/runtime_switch/extracted/Hacl_Spe_Poly1305_64.krml ../secure_api/out/runtime_switch/extracted/Hacl_Impl_Poly1305_64.krml ../secure_api/out/runtime_switch/extracted/Spec_GaloisField.krml ../secure_api/out/runtime_switch/extracted/Spec_GF128.krml ../secure_api/out/runtime_switch/extracted/Crypto_Symmetric_GF128.krml ../secure_api/out/runtime_switch/extracted/Crypto_Symmetric_MAC.krml ../secure_api/out/runtime_switch/extracted/Crypto_Symmetric_UF1CMA.krml ../secure_api/out/runtime_switch/extracted/Crypto_Plain.krml ../secure_api/out/runtime_switch/extracted/Crypto_Symmetric_PRF.krml ../secure_api/out/runtime_switch/extracted/Crypto_AEAD_Encoding.krml ../secure_api/out/runtime_switch/extracted/Crypto_AEAD_Invariant.krml ../secure_api/out/runtime_switch/extracted/Crypto_AEAD_Encrypt_Invariant.krml ../secure_api/out/runtime_switch/extracted/Crypto_AEAD_Wrappers_PRF.krml ../secure_api/out/runtime_switch/extracted/Crypto_AEAD_Wrappers_Encoding.krml ../secure_api/out/runtime_switch/extracted/Crypto_AEAD_Wrappers_CMA.krml ../secure_api/out/runtime_switch/extracted/Crypto_AEAD_EnxorDexor.krml ../secure_api/out/runtime_switch/extracted/Crypto_AEAD_Decrypt.krml ../secure_api/out/runtime_switch/extracted/Spec_HMAC_SHA2_256.krml ../secure_api/out/runtime_switch/extracted/Spec_SHA2_512.krml ../secure_api/out/runtime_switch/extracted/Hacl_Impl_SHA2_512_Lemmas.krml ../secure_api/out/runtime_switch/extracted/Hacl_Impl_SHA2_512.krml ../secure_api/out/runtime_switch/extracted/Spec_SHA2_384.krml ../secure_api/out/runtime_switch/extracted/Hacl_Impl_SHA2_384_Lemmas.krml ../secure_api/out/runtime_switch/extracted/Hacl_Impl_SHA2_384.krml ../secure_api/out/runtime_switch/extracted/Crypto_HMAC.krml ../secure_api/out/runtime_switch/extracted/Crypto_AEAD_Encrypt_Ideal_Invariant.krml ../secure_api/out/runtime_switch/extracted/Crypto_AEAD_MAC_Wrapper_Invariant.krml ../secure_api/out/runtime_switch/extracted/Crypto_AEAD_Enxor_Invariant.krml ../secure_api/out/runtime_switch/extracted/Crypto_AEAD_Encrypt.krml ../secure_api/out/runtime_switch/extracted/Crypto_AEAD.krml ../secure_api/out/runtime_switch/extracted/FStar_List.krml ../secure_api/out/runtime_switch/extracted/FStar_Char.krml ../secure_api/out/runtime_switch/extracted/FStar_String.krml ../secure_api/out/runtime_switch/extracted/C_String.krml ../secure_api/out/runtime_switch/extracted/TestLib.krml ../secure_api/out/runtime_switch/extracted/FStar_Bytes.krml ../secure_api/out/runtime_switch/extracted/Crypto_AEAD_Main.krml ../secure_api/out/runtime_switch/extracted/CryptoTypes.krml ../secure_api/out/runtime_switch/extracted/Crypto_HKDF.krml ../secure_api/out/runtime_switch/extracted/HaclProvider.krml ../secure_api/out/runtime_switch/extracted/KrmlTest.krml ../secure_api/out/runtime_switch/extracted/LowCProvider.krml -add-include '"kremlib.h"' -add-include '"kremlin/internal/compat.h"' \

Warning 6: in the definition of buf, after the definition of m0, in the last element of the sequence, in top-level declaration Crypto.Symmetric.Bytes.random_bytes, in file Crypto_Symmetric_Bytes: stack newbuf 0uint8 @1 is a non-constant size, stack-allocated array; this is not supported by CompCert and requires the use of alloca(3) for MSVC
[38;5;119m✔[0m [Monomorphization] ⏱️ 47ms
[38;5;119m✔[0m [Inlining] ⏱️ 16ms
[38;5;119m✔[0m [Pattern matches compilation] ⏱️ <1ms
[38;5;119m✔[0m [Simplify 2] ⏱️ <1ms
[38;5;119m✔[0m [Structs + Simplify 2] ⏱️ 16ms
[38;5;119m✔[0m [Drop] ⏱️ <1ms
Warning 14: : Crypto.Symmetric.Bytes.hex2 is not Low*; it uses F*'s Prims.string type and will leak memory; you need to link with a garbage-collector; if this declaration is for specification purposes only, consider marking it noextract or using -bundle <name-of-the-module> to only keep reachable definitions; if you are looking to use C strings, look into C.String (in kremlib/) and Server (in test/). See the KreMLin tutorial for more information.
[38;5;119m✔[0m [AstToCStar] ⏱️ <1ms
[38;5;119m✔[0m [CStarToC] ⏱️ <1ms
Warning 14: : Crypto.Symmetric.Bytes.hex1 is not Low*; it uses F*'s Prims.string type and will leak memory; you need to link with a garbage-collector; if this declaration is for specification purposes only, consider marking it noextract or using -bundle <name-of-the-module> to only keep reachable definitions; if you are looking to use C strings, look into C.String (in kremlib/) and Server (in test/). See the KreMLin tutorial for more information.
Warning 14: : FStar.IO.debug_print_string is not Low*; it uses F*'s Prims.string type and will leak memory; you need to link with a garbage-collector; if this declaration is for specification purposes only, consider marking it noextract or using -bundle <name-of-the-module> to only keep reachable definitions; if you are looking to use C strings, look into C.String (in kremlib/) and Server (in test/). See the KreMLin tutorial for more information.
Warning 14: : FStar.Seq.Base.append__uint8_t is not Low*; it uses a garbage-collected type (e.g. list) and will leak memory; you need to link with a garbage-collector; if this declaration is for specification purposes only, consider marking it noextract or using -bundle <name-of-the-module> to only keep reachable definitions.
Warning 14: : FStar.Seq.Base.createEmpty__uint8_t is not Low*; it uses a garbage-collected type (e.g. list) and will leak memory; you need to link with a garbage-collector; if this declaration is for specification purposes only, consider marking it noextract or using -bundle <name-of-the-module> to only keep reachable definitions.
Warning 14: : FStar.Seq.Properties.last__uint8_t is not Low*; it uses mathematical integers and runtime checks may fail; rewrite your code to use machine integers, or if you must, use -add-include '"prims_int.h"'; if this declaration is for specification purposes only, consider marking it noextract or using -bundle <name-of-the-module> to only keep reachable definitions.
Warning 14: : FStar.Seq.Base.hd__uint8_t is not Low*; it uses a garbage-collected type (e.g. list) and will leak memory; you need to link with a garbage-collector; if this declaration is for specification purposes only, consider marking it noextract or using -bundle <name-of-the-module> to only keep reachable definitions.
Warning 14: : FStar.Seq.Base.cons__uint8_t is not Low*; it uses a garbage-collected type (e.g. list) and will leak memory; you need to link with a garbage-collector; if this declaration is for specification purposes only, consider marking it noextract or using -bundle <name-of-the-module> to only keep reachable definitions.
Warning 14: : FStar.Seq.Base.tl__uint8_t is not Low*; it uses a garbage-collected type (e.g. list) and will leak memory; you need to link with a garbage-collector; if this declaration is for specification purposes only, consider marking it noextract or using -bundle <name-of-the-module> to only keep reachable definitions.
Warning 14: : FStar.Seq.Base.index__uint8_t is not Low*; it uses a garbage-collected type (e.g. list) and will leak memory; you need to link with a garbage-collector; if this declaration is for specification purposes only, consider marking it noextract or using -bundle <name-of-the-module> to only keep reachable definitions.
Warning 14: : FStar.List.Tot.Base.tl__uint8_t is not Low*; it uses a garbage-collected type (e.g. list) and will leak memory; you need to link with a garbage-collector; if this declaration is for specification purposes only, consider marking it noextract or using -bundle <name-of-the-module> to only keep reachable definitions.
Warning 14: : FStar.List.Tot.Base.tail__uint8_t is not Low*; it uses a garbage-collected type (e.g. list) and will leak memory; you need to link with a garbage-collector; if this declaration is for specification purposes only, consider marking it noextract or using -bundle <name-of-the-module> to only keep reachable definitions.
Warning 14: : FStar.List.Tot.Base.hd__uint8_t is not Low*; it uses a garbage-collected type (e.g. list) and will leak memory; you need to link with a garbage-collector; if this declaration is for specification purposes only, consider marking it noextract or using -bundle <name-of-the-module> to only keep reachable definitions.
Warning 14: : FStar.Seq.Base.length__uint8_t is not Low*; it uses a garbage-collected type (e.g. list) and will leak memory; you need to link with a garbage-collector; if this declaration is for specification purposes only, consider marking it noextract or using -bundle <name-of-the-module> to only keep reachable definitions.
Warning 14: : FStar.Seq.Base.seq__uint8_t is not Low*; it uses a garbage-collected type (e.g. list) and will leak memory; you need to link with a garbage-collector; if this declaration is for specification purposes only, consider marking it noextract or using -bundle <name-of-the-module> to only keep reachable definitions.
Warning 14: : Prims.list__uint8_t is not Low*; it uses a garbage-collected type (e.g. list) and will leak memory; you need to link with a garbage-collector; if this declaration is for specification purposes only, consider marking it noextract or using -bundle <name-of-the-module> to only keep reachable definitions.
Warning 14: : FStar.UInt8.to_string is not Low*; it uses F*'s Prims.string type and will leak memory; you need to link with a garbage-collector; if this declaration is for specification purposes only, consider marking it noextract or using -bundle <name-of-the-module> to only keep reachable definitions; if you are looking to use C strings, look into C.String (in kremlib/) and Server (in test/). See the KreMLin tutorial for more information.
Warning 14: : Prims.strcat is not Low*; it uses F*'s Prims.string type and will leak memory; you need to link with a garbage-collector; if this declaration is for specification purposes only, consider marking it noextract or using -bundle <name-of-the-module> to only keep reachable definitions; if you are looking to use C strings, look into C.String (in kremlib/) and Server (in test/). See the KreMLin tutorial for more information.
Warning 14: : Prims.pow2 is not Low*; it uses mathematical integers and runtime checks may fail; rewrite your code to use machine integers, or if you must, use -add-include '"prims_int.h"'; if this declaration is for specification purposes only, consider marking it noextract or using -bundle <name-of-the-module> to only keep reachable definitions.
Warning 14: : Prims.op_GreaterThan is not Low*; it uses mathematical integers and runtime checks may fail; rewrite your code to use machine integers, or if you must, use -add-include '"prims_int.h"'; if this declaration is for specification purposes only, consider marking it noextract or using -bundle <name-of-the-module> to only keep reachable definitions.
Warning 14: : Prims.op_Modulus is not Low*; it uses mathematical integers and runtime checks may fail; rewrite your code to use machine integers, or if you must, use -add-include '"prims_int.h"'; if this declaration is for specification purposes only, consider marking it noextract or using -bundle <name-of-the-module> to only keep reachable definitions.
Warning 14: : Prims.op_Addition is not Low*; it uses mathematical integers and runtime checks may fail; rewrite your code to use machine integers, or if you must, use -add-include '"prims_int.h"'; if this declaration is for specification purposes only, consider marking it noextract or using -bundle <name-of-the-module> to only keep reachable definitions.
Warning 14: : Prims.op_Subtraction is not Low*; it uses mathematical integers and runtime checks may fail; rewrite your code to use machine integers, or if you must, use -add-include '"prims_int.h"'; if this declaration is for specification purposes only, consider marking it noextract or using -bundle <name-of-the-module> to only keep reachable definitions.
Warning 14: : Prims.op_Division is not Low*; it uses mathematical integers and runtime checks may fail; rewrite your code to use machine integers, or if you must, use -add-include '"prims_int.h"'; if this declaration is for specification purposes only, consider marking it noextract or using -bundle <name-of-the-module> to only keep reachable definitions.
Warning 14: : Prims.op_Multiply is not Low*; it uses mathematical integers and runtime checks may fail; rewrite your code to use machine integers, or if you must, use -add-include '"prims_int.h"'; if this declaration is for specification purposes only, consider marking it noextract or using -bundle <name-of-the-module> to only keep reachable definitions.
[38;5;81m⚙ KreMLin auto-detecting tools.[0m Here's what we found:
[4mreadlink is:[0m readlink
[4mKreMLin called via:[0m C:\build\agent2\_work\6\s\kremlin\_build\src\Kremlin.native
[4mthe Kremlin executable is:[0m C:\build\agent2\_work\6\s\kremlin\_build\src\Kremlin.native
[4mKreMLin home is:[0m C:/build/agent2/_work/6/s/kremlin
[38;5;81m⚙ KreMLin will drive F*.[0m Here's what we found:
read FSTAR_HOME via the environment
[4mfstar converted to windows path:[0m C:/build/agent2/_work/6/s/FStar/bin/fstar.exe
[4mfstar home converted to windows path:[0m C:/build/agent2/_work/6/s/FStar
[4mfstar lib converted to windows path:[0m C:/build/agent2/_work/6/s/FStar/ulib
fstar is on [38;5;202mbranch protz_uint128[0m
[4mfstar is:[0m C:/build/agent2/_work/6/s/FStar/bin/fstar.exe C:/build/agent2/_work/6/s/kremlin/runtime/WasmSupport.fst C:/build/agent2/_work/6/s/FStar/ulib/FStar.UInt128.fst --trace_error --cache_checked_modules --expose_interfaces --include C:/build/agent2/_work/6/s/kremlin/include --include C:/build/agent2/_work/6/s/kremlin/kremlib
[38;5;119m✔[0m [PrettyPrinting] ⏱️ <1ms
KreMLin: wrote out .c files for Crypto_Symmetric_Bytes
KreMLin: wrote out .h files for Crypto_Symmetric_Bytes
C:/build/agent2/_work/6/s/kremlin/krml  -bundle 'Crypto_AEAD_Main+Crypto_Symmetric_Cipher+Crypto_Indexing=*' -minimal -skip-compilation \
-tmpdir ../secure_api/out/runtime_switch/crypto ../secure_api/out/runtime_switch/extracted/prims.krml ../secure_api/out/runtime_switch/extracted/FStar_Pervasives_Native.krml ../secure_api/out/runtime_switch/extracted/FStar_Pervasives.krml ../secure_api/out/runtime_switch/extracted/FStar_Mul.krml ../secure_api/out/runtime_switch/extracted/FStar_Math_Lib.krml ../secure_api/out/runtime_switch/extracted/FStar_Math_Lemmas.krml ../secure_api/out/runtime_switch/extracted/FStar_Squash.krml ../secure_api/out/runtime_switch/extracted/FStar_StrongExcludedMiddle.krml ../secure_api/out/runtime_switch/extracted/FStar_Classical.krml ../secure_api/out/runtime_switch/extracted/FStar_List_Tot_Base.krml ../secure_api/out/runtime_switch/extracted/FStar_List_Tot_Properties.krml ../secure_api/out/runtime_switch/extracted/FStar_List_Tot.krml ../secure_api/out/runtime_switch/extracted/FStar_Seq_Base.krml ../secure_api/out/runtime_switch/extracted/FStar_Seq_Properties.krml ../secure_api/out/runtime_switch/extracted/FStar_Seq.krml ../secure_api/out/runtime_switch/extracted/FStar_BitVector.krml ../secure_api/out/runtime_switch/extracted/FStar_UInt.krml ../secure_api/out/runtime_switch/extracted/FStar_UInt32.krml ../secure_api/out/runtime_switch/extracted/FStar_Int.krml ../secure_api/out/runtime_switch/extracted/FStar_Int64.krml ../secure_api/out/runtime_switch/extracted/FStar_Int63.krml ../secure_api/out/runtime_switch/extracted/FStar_Int32.krml ../secure_api/out/runtime_switch/extracted/FStar_Int16.krml ../secure_api/out/runtime_switch/extracted/FStar_Int8.krml ../secure_api/out/runtime_switch/extracted/FStar_UInt64.krml ../secure_api/out/runtime_switch/extracted/FStar_UInt63.krml ../secure_api/out/runtime_switch/extracted/FStar_UInt16.krml ../secure_api/out/runtime_switch/extracted/FStar_UInt8.krml ../secure_api/out/runtime_switch/extracted/FStar_Int_Cast.krml ../secure_api/out/runtime_switch/extracted/FStar_UInt128.krml ../secure_api/out/runtime_switch/extracted/Hacl_UInt64.krml ../secure_api/out/runtime_switch/extracted/FStar_Preorder.krml ../secure_api/out/runtime_switch/extracted/FStar_Ghost.krml ../secure_api/out/runtime_switch/extracted/FStar_ErasedLogic.krml ../secure_api/out/runtime_switch/extracted/FStar_FunctionalExtensionality.krml ../secure_api/out/runtime_switch/extracted/FStar_Set.krml ../secure_api/out/runtime_switch/extracted/FStar_PropositionalExtensionality.krml ../secure_api/out/runtime_switch/extracted/FStar_PredicateExtensionality.krml ../secure_api/out/runtime_switch/extracted/FStar_TSet.krml ../secure_api/out/runtime_switch/extracted/FStar_Monotonic_Heap.krml ../secure_api/out/runtime_switch/extracted/FStar_Heap.krml ../secure_api/out/runtime_switch/extracted/FStar_Map.krml ../secure_api/out/runtime_switch/extracted/FStar_Monotonic_HyperHeap.krml ../secure_api/out/runtime_switch/extracted/FStar_Monotonic_HyperStack.krml ../secure_api/out/runtime_switch/extracted/FStar_HyperStack.krml ../secure_api/out/runtime_switch/extracted/FStar_Monotonic_Witnessed.krml ../secure_api/out/runtime_switch/extracted/FStar_HyperStack_ST.krml ../secure_api/out/runtime_switch/extracted/FStar_HyperStack_All.krml ../secure_api/out/runtime_switch/extracted/Hacl_UInt128.krml ../secure_api/out/runtime_switch/extracted/Hacl_UInt8.krml ../secure_api/out/runtime_switch/extracted/Hacl_Bignum_Constants.krml ../secure_api/out/runtime_switch/extracted/Hacl_UInt32.krml ../secure_api/out/runtime_switch/extracted/FStar_Int_Cast_Full.krml ../secure_api/out/runtime_switch/extracted/Hacl_Cast.krml ../secure_api/out/runtime_switch/extracted/FStar_Buffer.krml ../secure_api/out/runtime_switch/extracted/Hacl_Bignum_Parameters.krml ../secure_api/out/runtime_switch/extracted/Hacl_Bignum_Wide.krml ../secure_api/out/runtime_switch/extracted/Spec_Loops.krml ../secure_api/out/runtime_switch/extracted/Hacl_Bignum_Limb.krml ../secure_api/out/runtime_switch/extracted/Hacl_Spec_Bignum_Field.krml ../secure_api/out/runtime_switch/extracted/Hacl_Spec_Bignum_Bigint.krml ../secure_api/out/runtime_switch/extracted/Hacl_Spec_Bignum_Modulo.krml ../secure_api/out/runtime_switch/extracted/Hacl_Spec_Bignum_Fproduct.krml ../secure_api/out/runtime_switch/extracted/Hacl_Spec_Bignum_Fmul.krml ../secure_api/out/runtime_switch/extracted/FStar_Endianness.krml ../secure_api/out/runtime_switch/extracted/Spec_Poly1305_Lemmas.krml ../secure_api/out/runtime_switch/extracted/FStar_Kremlin_Endianness.krml ../secure_api/out/runtime_switch/extracted/C_Endianness.krml ../secure_api/out/runtime_switch/extracted/C.krml ../secure_api/out/runtime_switch/extracted/Hacl_UInt16.krml ../secure_api/out/runtime_switch/extracted/Hacl_Spec_Endianness.krml ../secure_api/out/runtime_switch/extracted/Hacl_Endianness.krml ../secure_api/out/runtime_switch/extracted/Spec_Lib.krml ../secure_api/out/runtime_switch/extracted/Seq_Create.krml ../secure_api/out/runtime_switch/extracted/Spec_SHA2_256.krml ../secure_api/out/runtime_switch/extracted/C_Loops.krml ../secure_api/out/runtime_switch/extracted/Hacl_Hash_Lib_LoadStore.krml ../secure_api/out/runtime_switch/extracted/Hacl_Hash_Lib_Create.krml ../secure_api/out/runtime_switch/extracted/Hacl_Impl_SHA2_256_Lemmas.krml ../secure_api/out/runtime_switch/extracted/Hacl_Impl_SHA2_256.krml ../secure_api/out/runtime_switch/extracted/Hacl_Spec_Bignum_Fsum.krml ../secure_api/out/runtime_switch/extracted/Hacl_Bignum_Fsum.krml ../secure_api/out/runtime_switch/extracted/Crypto_AEAD_BufferUtils.krml ../secure_api/out/runtime_switch/extracted/Vale_AES.krml ../secure_api/out/runtime_switch/extracted/Hacl_Impl_Xor_Lemmas.krml ../secure_api/out/runtime_switch/extracted/Spec_CTR_Lemmas.krml ../secure_api/out/runtime_switch/extracted/Spec_CTR.krml ../secure_api/out/runtime_switch/extracted/Hacl_Lib_LoadStore32.krml ../secure_api/out/runtime_switch/extracted/Spec_Chacha20_Lemmas.krml ../secure_api/out/runtime_switch/extracted/Spec_Chacha20.krml ../secure_api/out/runtime_switch/extracted/Hacl_Impl_Chacha20.krml ../secure_api/out/runtime_switch/extracted/Hacl_SecureAPI_Chacha20.krml ../secure_api/out/runtime_switch/extracted/Crypto_Indexing.krml ../secure_api/out/runtime_switch/extracted/Flag.krml ../secure_api/out/runtime_switch/extracted/Crypto_Symmetric_AES.krml ../secure_api/out/runtime_switch/extracted/Crypto_Symmetric_AES128.krml ../secure_api/out/runtime_switch/extracted/FStar_Float.krml ../secure_api/out/runtime_switch/extracted/FStar_Exn.krml ../secure_api/out/runtime_switch/extracted/FStar_ST.krml ../secure_api/out/runtime_switch/extracted/FStar_All.krml ../secure_api/out/runtime_switch/extracted/FStar_IO.krml ../secure_api/out/runtime_switch/extracted/Buffer_Utils.krml ../secure_api/out/runtime_switch/extracted/Crypto_Symmetric_Bytes.krml ../secure_api/out/runtime_switch/extracted/Crypto_Symmetric_Cipher.krml ../secure_api/out/runtime_switch/extracted/C_Nullity.krml ../secure_api/out/runtime_switch/extracted/Hacl_Spec_Bignum_AddAndMultiply.krml ../secure_api/out/runtime_switch/extracted/Spec_Poly1305.krml ../secure_api/out/runtime_switch/extracted/Hacl_Bignum_Modulo.krml ../secure_api/out/runtime_switch/extracted/Hacl_Bignum_Fproduct.krml ../secure_api/out/runtime_switch/extracted/Hacl_Spec_Poly1305_64_State.krml ../secure_api/out/runtime_switch/extracted/Hacl_Spec_Poly1305_64.krml ../secure_api/out/runtime_switch/extracted/Hacl_Impl_Poly1305_64_State.krml ../secure_api/out/runtime_switch/extracted/Hacl_Bignum_Fmul.krml ../secure_api/out/runtime_switch/extracted/Hacl_Bignum_AddAndMultiply.krml ../secure_api/out/runtime_switch/extracted/Hacl_Spe_Poly1305_64.krml ../secure_api/out/runtime_switch/extracted/Hacl_Impl_Poly1305_64.krml ../secure_api/out/runtime_switch/extracted/Spec_GaloisField.krml ../secure_api/out/runtime_switch/extracted/Spec_GF128.krml ../secure_api/out/runtime_switch/extracted/Crypto_Symmetric_GF128.krml ../secure_api/out/runtime_switch/extracted/Crypto_Symmetric_MAC.krml ../secure_api/out/runtime_switch/extracted/Crypto_Symmetric_UF1CMA.krml ../secure_api/out/runtime_switch/extracted/Crypto_Plain.krml ../secure_api/out/runtime_switch/extracted/Crypto_Symmetric_PRF.krml ../secure_api/out/runtime_switch/extracted/Crypto_AEAD_Encoding.krml ../secure_api/out/runtime_switch/extracted/Crypto_AEAD_Invariant.krml ../secure_api/out/runtime_switch/extracted/Crypto_AEAD_Encrypt_Invariant.krml ../secure_api/out/runtime_switch/extracted/Crypto_AEAD_Wrappers_PRF.krml ../secure_api/out/runtime_switch/extracted/Crypto_AEAD_Wrappers_Encoding.krml ../secure_api/out/runtime_switch/extracted/Crypto_AEAD_Wrappers_CMA.krml ../secure_api/out/runtime_switch/extracted/Crypto_AEAD_EnxorDexor.krml ../secure_api/out/runtime_switch/extracted/Crypto_AEAD_Decrypt.krml ../secure_api/out/runtime_switch/extracted/Spec_HMAC_SHA2_256.krml ../secure_api/out/runtime_switch/extracted/Spec_SHA2_512.krml ../secure_api/out/runtime_switch/extracted/Hacl_Impl_SHA2_512_Lemmas.krml ../secure_api/out/runtime_switch/extracted/Hacl_Impl_SHA2_512.krml ../secure_api/out/runtime_switch/extracted/Spec_SHA2_384.krml ../secure_api/out/runtime_switch/extracted/Hacl_Impl_SHA2_384_Lemmas.krml ../secure_api/out/runtime_switch/extracted/Hacl_Impl_SHA2_384.krml ../secure_api/out/runtime_switch/extracted/Crypto_HMAC.krml ../secure_api/out/runtime_switch/extracted/Crypto_AEAD_Encrypt_Ideal_Invariant.krml ../secure_api/out/runtime_switch/extracted/Crypto_AEAD_MAC_Wrapper_Invariant.krml ../secure_api/out/runtime_switch/extracted/Crypto_AEAD_Enxor_Invariant.krml ../secure_api/out/runtime_switch/extracted/Crypto_AEAD_Encrypt.krml ../secure_api/out/runtime_switch/extracted/Crypto_AEAD.krml ../secure_api/out/runtime_switch/extracted/FStar_List.krml ../secure_api/out/runtime_switch/extracted/FStar_Char.krml ../secure_api/out/runtime_switch/extracted/FStar_String.krml ../secure_api/out/runtime_switch/extracted/C_String.krml ../secure_api/out/runtime_switch/extracted/TestLib.krml ../secure_api/out/runtime_switch/extracted/FStar_Bytes.krml ../secure_api/out/runtime_switch/extracted/Crypto_AEAD_Main.krml ../secure_api/out/runtime_switch/extracted/CryptoTypes.krml ../secure_api/out/runtime_switch/extracted/Crypto_HKDF.krml ../secure_api/out/runtime_switch/extracted/HaclProvider.krml ../secure_api/out/runtime_switch/extracted/KrmlTest.krml ../secure_api/out/runtime_switch/extracted/LowCProvider.krml -add-include '"kremlib.h"' -add-include '"kremlin/internal/compat.h"' \

Warning 6: in the definition of keyBuffer, after the definition of h0, in the last element of the sequence, after the definition of macId, in top-level declaration Crypto.Symmetric.PRF.prf_mac, in file Crypto_AEAD_Main_Crypto_Symmetric_Cipher_Crypto_Indexing: stack newbuf 0uint8 Crypto.Symmetric.UF1CMA.keylen @5 is a non-constant size, stack-allocated array; this is not supported by CompCert and requires the use of alloca(3) for MSVC
[38;5;119m✔[0m [Monomorphization] ⏱️ 63ms
[38;5;119m✔[0m [Inlining] ⏱️ 63ms
[38;5;119m✔[0m [Pattern matches compilation] ⏱️ 47ms
[38;5;119m✔[0m [Simplify 2] ⏱️ 281ms
[38;5;119m✔[0m [Structs + Simplify 2] ⏱️ 344ms
[38;5;119m✔[0m [Drop] ⏱️ <1ms
Warning 14: : Crypto.AEAD.Invariant.safelen is not Low*; it uses mathematical integers and runtime checks may fail; rewrite your code to use machine integers, or if you must, use -add-include '"prims_int.h"'; if this declaration is for specification purposes only, consider marking it noextract or using -bundle <name-of-the-module> to only keep reachable definitions.
Warning 14: : Crypto.AEAD.Invariant.maxplain is not Low*; it uses mathematical integers and runtime checks may fail; rewrite your code to use machine integers, or if you must, use -add-include '"prims_int.h"'; if this declaration is for specification purposes only, consider marking it noextract or using -bundle <name-of-the-module> to only keep reachable definitions.
Warning 14: : Prims.pow2 is not Low*; it uses mathematical integers and runtime checks may fail; rewrite your code to use machine integers, or if you must, use -add-include '"prims_int.h"'; if this declaration is for specification purposes only, consider marking it noextract or using -bundle <name-of-the-module> to only keep reachable definitions.
Warning 14: : Prims.op_LessThanOrEqual is not Low*; it uses mathematical integers and runtime checks may fail; rewrite your code to use machine integers, or if you must, use -add-include '"prims_int.h"'; if this declaration is for specification purposes only, consider marking it noextract or using -bundle <name-of-the-module> to only keep reachable definitions.
Warning 14: : Prims.op_Addition is not Low*; it uses mathematical integers and runtime checks may fail; rewrite your code to use machine integers, or if you must, use -add-include '"prims_int.h"'; if this declaration is for specification purposes only, consider marking it noextract or using -bundle <name-of-the-module> to only keep reachable definitions.
[38;5;119m✔[0m [AstToCStar] ⏱️ 16ms
[38;5;119m✔[0m [CStarToC] ⏱️ <1ms
Warning 14: : Prims.op_Multiply is not Low*; it uses mathematical integers and runtime checks may fail; rewrite your code to use machine integers, or if you must, use -add-include '"prims_int.h"'; if this declaration is for specification purposes only, consider marking it noextract or using -bundle <name-of-the-module> to only keep reachable definitions.
[38;5;81m⚙ KreMLin auto-detecting tools.[0m Here's what we found:
[4mreadlink is:[0m readlink
[4mKreMLin called via:[0m C:\build\agent2\_work\6\s\kremlin\_build\src\Kremlin.native
[4mthe Kremlin executable is:[0m C:\build\agent2\_work\6\s\kremlin\_build\src\Kremlin.native
[4mKreMLin home is:[0m C:/build/agent2/_work/6/s/kremlin
[38;5;81m⚙ KreMLin will drive F*.[0m Here's what we found:
read FSTAR_HOME via the environment
[4mfstar converted to windows path:[0m C:/build/agent2/_work/6/s/FStar/bin/fstar.exe
[4mfstar home converted to windows path:[0m C:/build/agent2/_work/6/s/FStar
[4mfstar lib converted to windows path:[0m C:/build/agent2/_work/6/s/FStar/ulib
fstar is on [38;5;202mbranch protz_uint128[0m
[4mfstar is:[0m C:/build/agent2/_work/6/s/FStar/bin/fstar.exe C:/build/agent2/_work/6/s/kremlin/runtime/WasmSupport.fst C:/build/agent2/_work/6/s/FStar/ulib/FStar.UInt128.fst --trace_error --cache_checked_modules --expose_interfaces --include C:/build/agent2/_work/6/s/kremlin/include --include C:/build/agent2/_work/6/s/kremlin/kremlib
[38;5;119m✔[0m [PrettyPrinting] ⏱️ 31ms
KreMLin: wrote out .c files for Crypto_AEAD_Main_Crypto_Symmetric_Cipher_Crypto_Indexing
KreMLin: wrote out .h files for Crypto_AEAD_Main_Crypto_Symmetric_Cipher_Crypto_Indexing
C:/build/agent2/_work/6/s/kremlin/krml  -bundle 'Crypto_HKDF+Crypto_HMAC=*' -minimal -skip-compilation \
-tmpdir ../secure_api/out/runtime_switch/crypto ../secure_api/out/runtime_switch/extracted/prims.krml ../secure_api/out/runtime_switch/extracted/FStar_Pervasives_Native.krml ../secure_api/out/runtime_switch/extracted/FStar_Pervasives.krml ../secure_api/out/runtime_switch/extracted/FStar_Mul.krml ../secure_api/out/runtime_switch/extracted/FStar_Math_Lib.krml ../secure_api/out/runtime_switch/extracted/FStar_Math_Lemmas.krml ../secure_api/out/runtime_switch/extracted/FStar_Squash.krml ../secure_api/out/runtime_switch/extracted/FStar_StrongExcludedMiddle.krml ../secure_api/out/runtime_switch/extracted/FStar_Classical.krml ../secure_api/out/runtime_switch/extracted/FStar_List_Tot_Base.krml ../secure_api/out/runtime_switch/extracted/FStar_List_Tot_Properties.krml ../secure_api/out/runtime_switch/extracted/FStar_List_Tot.krml ../secure_api/out/runtime_switch/extracted/FStar_Seq_Base.krml ../secure_api/out/runtime_switch/extracted/FStar_Seq_Properties.krml ../secure_api/out/runtime_switch/extracted/FStar_Seq.krml ../secure_api/out/runtime_switch/extracted/FStar_BitVector.krml ../secure_api/out/runtime_switch/extracted/FStar_UInt.krml ../secure_api/out/runtime_switch/extracted/FStar_UInt32.krml ../secure_api/out/runtime_switch/extracted/FStar_Int.krml ../secure_api/out/runtime_switch/extracted/FStar_Int64.krml ../secure_api/out/runtime_switch/extracted/FStar_Int63.krml ../secure_api/out/runtime_switch/extracted/FStar_Int32.krml ../secure_api/out/runtime_switch/extracted/FStar_Int16.krml ../secure_api/out/runtime_switch/extracted/FStar_Int8.krml ../secure_api/out/runtime_switch/extracted/FStar_UInt64.krml ../secure_api/out/runtime_switch/extracted/FStar_UInt63.krml ../secure_api/out/runtime_switch/extracted/FStar_UInt16.krml ../secure_api/out/runtime_switch/extracted/FStar_UInt8.krml ../secure_api/out/runtime_switch/extracted/FStar_Int_Cast.krml ../secure_api/out/runtime_switch/extracted/FStar_UInt128.krml ../secure_api/out/runtime_switch/extracted/Hacl_UInt64.krml ../secure_api/out/runtime_switch/extracted/FStar_Preorder.krml ../secure_api/out/runtime_switch/extracted/FStar_Ghost.krml ../secure_api/out/runtime_switch/extracted/FStar_ErasedLogic.krml ../secure_api/out/runtime_switch/extracted/FStar_FunctionalExtensionality.krml ../secure_api/out/runtime_switch/extracted/FStar_Set.krml ../secure_api/out/runtime_switch/extracted/FStar_PropositionalExtensionality.krml ../secure_api/out/runtime_switch/extracted/FStar_PredicateExtensionality.krml ../secure_api/out/runtime_switch/extracted/FStar_TSet.krml ../secure_api/out/runtime_switch/extracted/FStar_Monotonic_Heap.krml ../secure_api/out/runtime_switch/extracted/FStar_Heap.krml ../secure_api/out/runtime_switch/extracted/FStar_Map.krml ../secure_api/out/runtime_switch/extracted/FStar_Monotonic_HyperHeap.krml ../secure_api/out/runtime_switch/extracted/FStar_Monotonic_HyperStack.krml ../secure_api/out/runtime_switch/extracted/FStar_HyperStack.krml ../secure_api/out/runtime_switch/extracted/FStar_Monotonic_Witnessed.krml ../secure_api/out/runtime_switch/extracted/FStar_HyperStack_ST.krml ../secure_api/out/runtime_switch/extracted/FStar_HyperStack_All.krml ../secure_api/out/runtime_switch/extracted/Hacl_UInt128.krml ../secure_api/out/runtime_switch/extracted/Hacl_UInt8.krml ../secure_api/out/runtime_switch/extracted/Hacl_Bignum_Constants.krml ../secure_api/out/runtime_switch/extracted/Hacl_UInt32.krml ../secure_api/out/runtime_switch/extracted/FStar_Int_Cast_Full.krml ../secure_api/out/runtime_switch/extracted/Hacl_Cast.krml ../secure_api/out/runtime_switch/extracted/FStar_Buffer.krml ../secure_api/out/runtime_switch/extracted/Hacl_Bignum_Parameters.krml ../secure_api/out/runtime_switch/extracted/Hacl_Bignum_Wide.krml ../secure_api/out/runtime_switch/extracted/Spec_Loops.krml ../secure_api/out/runtime_switch/extracted/Hacl_Bignum_Limb.krml ../secure_api/out/runtime_switch/extracted/Hacl_Spec_Bignum_Field.krml ../secure_api/out/runtime_switch/extracted/Hacl_Spec_Bignum_Bigint.krml ../secure_api/out/runtime_switch/extracted/Hacl_Spec_Bignum_Modulo.krml ../secure_api/out/runtime_switch/extracted/Hacl_Spec_Bignum_Fproduct.krml ../secure_api/out/runtime_switch/extracted/Hacl_Spec_Bignum_Fmul.krml ../secure_api/out/runtime_switch/extracted/FStar_Endianness.krml ../secure_api/out/runtime_switch/extracted/Spec_Poly1305_Lemmas.krml ../secure_api/out/runtime_switch/extracted/FStar_Kremlin_Endianness.krml ../secure_api/out/runtime_switch/extracted/C_Endianness.krml ../secure_api/out/runtime_switch/extracted/C.krml ../secure_api/out/runtime_switch/extracted/Hacl_UInt16.krml ../secure_api/out/runtime_switch/extracted/Hacl_Spec_Endianness.krml ../secure_api/out/runtime_switch/extracted/Hacl_Endianness.krml ../secure_api/out/runtime_switch/extracted/Spec_Lib.krml ../secure_api/out/runtime_switch/extracted/Seq_Create.krml ../secure_api/out/runtime_switch/extracted/Spec_SHA2_256.krml ../secure_api/out/runtime_switch/extracted/C_Loops.krml ../secure_api/out/runtime_switch/extracted/Hacl_Hash_Lib_LoadStore.krml ../secure_api/out/runtime_switch/extracted/Hacl_Hash_Lib_Create.krml ../secure_api/out/runtime_switch/extracted/Hacl_Impl_SHA2_256_Lemmas.krml ../secure_api/out/runtime_switch/extracted/Hacl_Impl_SHA2_256.krml ../secure_api/out/runtime_switch/extracted/Hacl_Spec_Bignum_Fsum.krml ../secure_api/out/runtime_switch/extracted/Hacl_Bignum_Fsum.krml ../secure_api/out/runtime_switch/extracted/Crypto_AEAD_BufferUtils.krml ../secure_api/out/runtime_switch/extracted/Vale_AES.krml ../secure_api/out/runtime_switch/extracted/Hacl_Impl_Xor_Lemmas.krml ../secure_api/out/runtime_switch/extracted/Spec_CTR_Lemmas.krml ../secure_api/out/runtime_switch/extracted/Spec_CTR.krml ../secure_api/out/runtime_switch/extracted/Hacl_Lib_LoadStore32.krml ../secure_api/out/runtime_switch/extracted/Spec_Chacha20_Lemmas.krml ../secure_api/out/runtime_switch/extracted/Spec_Chacha20.krml ../secure_api/out/runtime_switch/extracted/Hacl_Impl_Chacha20.krml ../secure_api/out/runtime_switch/extracted/Hacl_SecureAPI_Chacha20.krml ../secure_api/out/runtime_switch/extracted/Crypto_Indexing.krml ../secure_api/out/runtime_switch/extracted/Flag.krml ../secure_api/out/runtime_switch/extracted/Crypto_Symmetric_AES.krml ../secure_api/out/runtime_switch/extracted/Crypto_Symmetric_AES128.krml ../secure_api/out/runtime_switch/extracted/FStar_Float.krml ../secure_api/out/runtime_switch/extracted/FStar_Exn.krml ../secure_api/out/runtime_switch/extracted/FStar_ST.krml ../secure_api/out/runtime_switch/extracted/FStar_All.krml ../secure_api/out/runtime_switch/extracted/FStar_IO.krml ../secure_api/out/runtime_switch/extracted/Buffer_Utils.krml ../secure_api/out/runtime_switch/extracted/Crypto_Symmetric_Bytes.krml ../secure_api/out/runtime_switch/extracted/Crypto_Symmetric_Cipher.krml ../secure_api/out/runtime_switch/extracted/C_Nullity.krml ../secure_api/out/runtime_switch/extracted/Hacl_Spec_Bignum_AddAndMultiply.krml ../secure_api/out/runtime_switch/extracted/Spec_Poly1305.krml ../secure_api/out/runtime_switch/extracted/Hacl_Bignum_Modulo.krml ../secure_api/out/runtime_switch/extracted/Hacl_Bignum_Fproduct.krml ../secure_api/out/runtime_switch/extracted/Hacl_Spec_Poly1305_64_State.krml ../secure_api/out/runtime_switch/extracted/Hacl_Spec_Poly1305_64.krml ../secure_api/out/runtime_switch/extracted/Hacl_Impl_Poly1305_64_State.krml ../secure_api/out/runtime_switch/extracted/Hacl_Bignum_Fmul.krml ../secure_api/out/runtime_switch/extracted/Hacl_Bignum_AddAndMultiply.krml ../secure_api/out/runtime_switch/extracted/Hacl_Spe_Poly1305_64.krml ../secure_api/out/runtime_switch/extracted/Hacl_Impl_Poly1305_64.krml ../secure_api/out/runtime_switch/extracted/Spec_GaloisField.krml ../secure_api/out/runtime_switch/extracted/Spec_GF128.krml ../secure_api/out/runtime_switch/extracted/Crypto_Symmetric_GF128.krml ../secure_api/out/runtime_switch/extracted/Crypto_Symmetric_MAC.krml ../secure_api/out/runtime_switch/extracted/Crypto_Symmetric_UF1CMA.krml ../secure_api/out/runtime_switch/extracted/Crypto_Plain.krml ../secure_api/out/runtime_switch/extracted/Crypto_Symmetric_PRF.krml ../secure_api/out/runtime_switch/extracted/Crypto_AEAD_Encoding.krml ../secure_api/out/runtime_switch/extracted/Crypto_AEAD_Invariant.krml ../secure_api/out/runtime_switch/extracted/Crypto_AEAD_Encrypt_Invariant.krml ../secure_api/out/runtime_switch/extracted/Crypto_AEAD_Wrappers_PRF.krml ../secure_api/out/runtime_switch/extracted/Crypto_AEAD_Wrappers_Encoding.krml ../secure_api/out/runtime_switch/extracted/Crypto_AEAD_Wrappers_CMA.krml ../secure_api/out/runtime_switch/extracted/Crypto_AEAD_EnxorDexor.krml ../secure_api/out/runtime_switch/extracted/Crypto_AEAD_Decrypt.krml ../secure_api/out/runtime_switch/extracted/Spec_HMAC_SHA2_256.krml ../secure_api/out/runtime_switch/extracted/Spec_SHA2_512.krml ../secure_api/out/runtime_switch/extracted/Hacl_Impl_SHA2_512_Lemmas.krml ../secure_api/out/runtime_switch/extracted/Hacl_Impl_SHA2_512.krml ../secure_api/out/runtime_switch/extracted/Spec_SHA2_384.krml ../secure_api/out/runtime_switch/extracted/Hacl_Impl_SHA2_384_Lemmas.krml ../secure_api/out/runtime_switch/extracted/Hacl_Impl_SHA2_384.krml ../secure_api/out/runtime_switch/extracted/Crypto_HMAC.krml ../secure_api/out/runtime_switch/extracted/Crypto_AEAD_Encrypt_Ideal_Invariant.krml ../secure_api/out/runtime_switch/extracted/Crypto_AEAD_MAC_Wrapper_Invariant.krml ../secure_api/out/runtime_switch/extracted/Crypto_AEAD_Enxor_Invariant.krml ../secure_api/out/runtime_switch/extracted/Crypto_AEAD_Encrypt.krml ../secure_api/out/runtime_switch/extracted/Crypto_AEAD.krml ../secure_api/out/runtime_switch/extracted/FStar_List.krml ../secure_api/out/runtime_switch/extracted/FStar_Char.krml ../secure_api/out/runtime_switch/extracted/FStar_String.krml ../secure_api/out/runtime_switch/extracted/C_String.krml ../secure_api/out/runtime_switch/extracted/TestLib.krml ../secure_api/out/runtime_switch/extracted/FStar_Bytes.krml ../secure_api/out/runtime_switch/extracted/Crypto_AEAD_Main.krml ../secure_api/out/runtime_switch/extracted/CryptoTypes.krml ../secure_api/out/runtime_switch/extracted/Crypto_HKDF.krml ../secure_api/out/runtime_switch/extracted/HaclProvider.krml ../secure_api/out/runtime_switch/extracted/KrmlTest.krml ../secure_api/out/runtime_switch/extracted/LowCProvider.krml -add-include '"kremlib.h"' -add-include '"kremlin/internal/compat.h"' \

Warning 6: in the definition of state, after the definition of pos_T, in the last element of the sequence, in top-level declaration Crypto.HKDF.hkdf_expand, in file Crypto_HKDF_Crypto_HMAC: stack newbuf 0uint8 (+,uint32) (+,uint32) @7 @3 @4 is a non-constant size, stack-allocated array; this is not supported by CompCert and requires the use of alloca(3) for MSVC
Warning 6: in the definition of state0, after the definition of h0, in the last element of the sequence, in top-level declaration Crypto.HMAC.hmac_part1, in file Crypto_HKDF_Crypto_HMAC: stack newbuf 0uint32 match @4 with | λ .  SHA256 () ->  137uint32 | λ .  SHA384 () ->  338uint32 | λ .  SHA512 () ->  338uint32 is a non-constant size, stack-allocated array; this is not supported by CompCert and requires the use of alloca(3) for MSVC
Warning 6: in the definition of state1, after the definition of h0, in the last element of the sequence, after the definition of hinit, in top-level declaration Crypto.HMAC.hmac_part2, in file Crypto_HKDF_Crypto_HMAC: stack newbuf 0uint32 match @5 with | λ .  SHA256 () ->  137uint32 | λ .  SHA384 () ->  338uint32 | λ .  SHA512 () ->  338uint32 is a non-constant size, stack-allocated array; this is not supported by CompCert and requires the use of alloca(3) for MSVC
Warning 6: in the definition of ipad, after the definition of h0, in the last element of the sequence, after the definition of h00, in top-level declaration Crypto.HMAC.hmac_core, in file Crypto_HKDF_Crypto_HMAC: stack newbuf 0x36uint8 Crypto.HMAC.block_size @6 is a non-constant size, stack-allocated array; this is not supported by CompCert and requires the use of alloca(3) for MSVC
Warning 6: in the definition of opad, after the definition of ipad, in the last element of the sequence, after the definition of h00, in top-level declaration Crypto.HMAC.hmac_core, in file Crypto_HKDF_Crypto_HMAC: stack newbuf 0x5cuint8 Crypto.HMAC.block_size @7 is a non-constant size, stack-allocated array; this is not supported by CompCert and requires the use of alloca(3) for MSVC
Warning 6: in the definition of nkey, in the last element of the sequence, in top-level declaration Crypto.HMAC.hmac, in file Crypto_HKDF_Crypto_HMAC: stack newbuf 0x00uint8 Crypto.HMAC.block_size @5 is a non-constant size, stack-allocated array; this is not supported by CompCert and requires the use of alloca(3) for MSVC
[38;5;119m✔[0m [Monomorphization] ⏱️ 47ms
[38;5;119m✔[0m [Inlining] ⏱️ 47ms
[38;5;119m✔[0m [Pattern matches compilation] ⏱️ 31ms
[38;5;119m✔[0m [Simplify 2] ⏱️ 47ms
[38;5;119m✔[0m [Structs + Simplify 2] ⏱️ 94ms
[38;5;119m✔[0m [Drop] ⏱️ <1ms
[38;5;119m✔[0m [AstToCStar] ⏱️ 16ms
[38;5;119m✔[0m [CStarToC] ⏱️ <1ms
[38;5;81m⚙ KreMLin auto-detecting tools.[0m Here's what we found:
[4mreadlink is:[0m readlink
[4mKreMLin called via:[0m C:\build\agent2\_work\6\s\kremlin\_build\src\Kremlin.native
[4mthe Kremlin executable is:[0m C:\build\agent2\_work\6\s\kremlin\_build\src\Kremlin.native
[4mKreMLin home is:[0m C:/build/agent2/_work/6/s/kremlin
[38;5;81m⚙ KreMLin will drive F*.[0m Here's what we found:
read FSTAR_HOME via the environment
[4mfstar converted to windows path:[0m C:/build/agent2/_work/6/s/FStar/bin/fstar.exe
[4mfstar home converted to windows path:[0m C:/build/agent2/_work/6/s/FStar
[4mfstar lib converted to windows path:[0m C:/build/agent2/_work/6/s/FStar/ulib
fstar is on [38;5;202mbranch protz_uint128[0m
[4mfstar is:[0m C:/build/agent2/_work/6/s/FStar/bin/fstar.exe C:/build/agent2/_work/6/s/kremlin/runtime/WasmSupport.fst C:/build/agent2/_work/6/s/FStar/ulib/FStar.UInt128.fst --trace_error --cache_checked_modules --expose_interfaces --include C:/build/agent2/_work/6/s/kremlin/include --include C:/build/agent2/_work/6/s/kremlin/kremlib
[38;5;119m✔[0m [PrettyPrinting] ⏱️ <1ms
KreMLin: wrote out .c files for Crypto_HKDF_Crypto_HMAC
KreMLin: wrote out .h files for Crypto_HKDF_Crypto_HMAC
OCAMLPATH="C:/build/agent2/_work/6/s/FStar/bin" ocamlfind opt -package fstarlib,zarith -g -I C:/build/agent2/_work/6/s/FStar/ulib/ml -c LowCProvider/lowc_stub.c -I LowCProvider/ -I ../secure_api/out/runtime_switch -I C:/build/agent2/_work/6/s/kremlin/include -I C:/build/agent2/_work/6/s/MLCrypto \
-I ../../mitls-fstar/libs/ffi -ccopt "-o LowCProvider/lowc_stub.o" -I ../code/salsa-family/chacha-c -I ../code/poly1305/poly-c \
-I ../code/curve25519/x25519-c -I ../secure_api/out/runtime_switch/crypto -I ../code/api/aead-c \
-ccopt -Wall -ccopt -Wextra -ccopt -I -ccopt C:/build/agent2/_work/6/s/kremlin/include -ccopt -Wno-unused-variable -ccopt -Wno-unused-parameter -ccopt -Wno-unused-but-set-variable -ccopt -Wno-parentheses -ccopt -Werror -ccopt -Wno-unknown-warning-option
OCAMLPATH="C:/build/agent2/_work/6/s/FStar/bin" ocamlfind opt -package fstarlib,zarith -g -I C:/build/agent2/_work/6/s/FStar/ulib/ml -c ../secure_api/out/runtime_switch/crypto/Crypto_AEAD_Main_Crypto_Symmetric_Cipher_Crypto_Indexing.c -I ../secure_api/out/runtime_switch/crypto/ -I ../secure_api/out/runtime_switch -I C:/build/agent2/_work/6/s/kremlin/include -I C:/build/agent2/_work/6/s/MLCrypto \
-I ../../mitls-fstar/libs/ffi -ccopt "-o ../secure_api/out/runtime_switch/crypto/Crypto_AEAD_Main_Crypto_Symmetric_Cipher_Crypto_Indexing.o" -I ../code/salsa-family/chacha-c -I ../code/poly1305/poly-c \
-I ../code/curve25519/x25519-c -I ../secure_api/out/runtime_switch/crypto -I ../code/api/aead-c \
-ccopt -Wall -ccopt -Wextra -ccopt -I -ccopt C:/build/agent2/_work/6/s/kremlin/include -ccopt -Wno-unused-variable -ccopt -Wno-unused-parameter -ccopt -Wno-unused-but-set-variable -ccopt -Wno-parentheses -ccopt -Werror -ccopt -Wno-unknown-warning-option
OCAMLPATH="C:/build/agent2/_work/6/s/FStar/bin" ocamlfind opt -package fstarlib,zarith -g -I C:/build/agent2/_work/6/s/FStar/ulib/ml -c ../secure_api/out/runtime_switch/crypto/Crypto_HKDF_Crypto_HMAC.c -I ../secure_api/out/runtime_switch/crypto/ -I ../secure_api/out/runtime_switch -I C:/build/agent2/_work/6/s/kremlin/include -I C:/build/agent2/_work/6/s/MLCrypto \
-I ../../mitls-fstar/libs/ffi -ccopt "-o ../secure_api/out/runtime_switch/crypto/Crypto_HKDF_Crypto_HMAC.o" -I ../code/salsa-family/chacha-c -I ../code/poly1305/poly-c \
-I ../code/curve25519/x25519-c -I ../secure_api/out/runtime_switch/crypto -I ../code/api/aead-c \
-ccopt -Wall -ccopt -Wextra -ccopt -I -ccopt C:/build/agent2/_work/6/s/kremlin/include -ccopt -Wno-unused-variable -ccopt -Wno-unused-parameter -ccopt -Wno-unused-but-set-variable -ccopt -Wno-parentheses -ccopt -Werror -ccopt -Wno-unknown-warning-option
OCAMLPATH="C:/build/agent2/_work/6/s/FStar/bin" ocamlfind opt -package fstarlib,zarith -g -I C:/build/agent2/_work/6/s/FStar/ulib/ml -c ../secure_api/out/runtime_switch/crypto/Crypto_Symmetric_Bytes.c -I ../secure_api/out/runtime_switch/crypto/ -I ../secure_api/out/runtime_switch -I C:/build/agent2/_work/6/s/kremlin/include -I C:/build/agent2/_work/6/s/MLCrypto \
-I ../../mitls-fstar/libs/ffi -ccopt "-o ../secure_api/out/runtime_switch/crypto/Crypto_Symmetric_Bytes.o" -I ../code/salsa-family/chacha-c -I ../code/poly1305/poly-c \
-I ../code/curve25519/x25519-c -I ../secure_api/out/runtime_switch/crypto -I ../code/api/aead-c \
-ccopt -Wall -ccopt -Wextra -ccopt -I -ccopt C:/build/agent2/_work/6/s/kremlin/include -ccopt -Wno-unused-variable -ccopt -Wno-unused-parameter -ccopt -Wno-unused-but-set-variable -ccopt -Wno-parentheses -ccopt -Werror -ccopt -Wno-unknown-warning-option
OCAMLPATH="C:/build/agent2/_work/6/s/FStar/bin" ocamlfind mklib -g -I C:/build/agent2/_work/6/s/FStar/ulib/ml -I ../secure_api/out/runtime_switch/extracted vale/asm/sha256_main_i.o vale/asm/sha256-x86_64.o vale/asm/Vale_Hash_SHA2_256.o vale/asm/vale_aes_glue.o vale/asm/aes-x86_64.o LowCProvider/LowCProvider.cmx LowCProvider/HaclProvider.cmx LowCProvider/lowc_stub.o ../secure_api/out/runtime_switch/crypto/Crypto_AEAD_Main_Crypto_Symmetric_Cipher_Crypto_Indexing.o ../secure_api/out/runtime_switch/crypto/Crypto_HKDF_Crypto_HMAC.o ../code/salsa-family/chacha-c/Hacl_Chacha20.o ../code/poly1305/poly-c/AEAD_Poly1305_64.o ../code/api/policies-c/Hacl_Policies.o ../code/api/aead-c/Hacl_Chacha20Poly1305.o ../secure_api/out/runtime_switch/crypto/Crypto_Symmetric_Bytes.o ../code/curve25519/x25519-c/Hacl_Curve25519.o -o ../secure_api/out/runtime_switch/LowC
OCAMLPATH="C:/build/agent2/_work/6/s/FStar/bin" ocamlfind opt -package fstarlib,zarith -g -I C:/build/agent2/_work/6/s/FStar/ulib/ml -c LowCProvider/Tests.ml -I LowCProvider -I ../secure_api/out/runtime_switch -I ../secure_api/out/runtime_switch/extracted -I C:/build/agent2/_work/6/s/MLCrypto -o LowCProvider/Tests.cmx
OCAMLPATH="C:/build/agent2/_work/6/s/FStar/bin" ocamlfind opt -package fstarlib,zarith -g -I C:/build/agent2/_work/6/s/FStar/ulib/ml -I ../secure_api/out/runtime_switch/extracted -I LowCProvider \
-ccopt -L../secure_api/out/runtime_switch -cclib C:/build/agent2/_work/6/s/kremlin/kremlib/out/libkremlib.a -linkpkg C:/build/agent2/_work/6/s/MLCrypto/CryptoTypes.cmx ../secure_api/out/runtime_switch/LowC.cmxa LowCProvider/Tests.cmx -o ../secure_api/out/runtime_switch/LowCTests.exe
./../secure_api/out/runtime_switch/LowCTests.exe
Tests started
Test 1 OK

Test 2 OK

Test 3 OK

Test 4 OK

Test 5 OK

Test 6 OK

Output cipher:	ed3dc05f9d4877f5db78c69c3a8a3d8e8602646a0b2febe4fca07a426a9ace4163cb26eddbb5b0d5f56d7038512ac73d667397d129c3044e0eb8052e
Output tag:	e6f0c7f7b8920ba02a3942df2b8b2a04
cipher:		AES-128-GCM
key:		"feffe9928665731c6d6a8f9467308308"
iv:		"cafebabefacedbad"
aad:		"feedfacedeadbeeffeedfacedeadbeefabaddad2"
tag:		"3612d2e79e3b0785561be14aaca2fccb"
plaintext:	"d9313225f88406e5a55909c5aff5269a86a7a9531534f7da2e4c303d8a318a721c3c0c95956809532fcf0e2449a6b525b16aedf5aa0de657ba637b39"
ciphertext:	"61353b4c2806934a777ff51fa22a4755699b2a714fcdc6f83766e5f97b6c742373806900e49f24b22b097544d4896b424989b5e1ebac0f07c23f4598"

Test 7 failed, but this is expected because |IV| <> 12 bytes and we don't do IV expansion.
Please disregard.

Output cipher:	8076eba01a51d7702d398c6dc3adaaadfe061c23a7ffc3c4623ea2be7a08d982b8f331d21ac6b8db541df43510561a3fff90b942215b7fb6fbcea43d
Output tag:	1606863da7ad74443b3a89fd2489363d
cipher:		AES-128-GCM
key:		"feffe9928665731c6d6a8f9467308308"
iv:		"9313225df88406e555909c5aff5269aa6a7a9538534f7da1e4c303d2a318a728c3c0c95156809539fcf0e2429a6b525416aedbf5a0de6a57a637b39b"
aad:		"feedfacedeadbeeffeedfacedeadbeefabaddad2"
tag:		"619cc5aefffe0bfa462af43c1699d050"
plaintext:	"d9313225f88406e5a55909c5aff5269a86a7a9531534f7da2e4c303d8a318a721c3c0c95956809532fcf0e2449a6b525b16aedf5aa0de657ba637b39"
ciphertext:	"8ce24998625615b603a033aca13fb894be9112a5c3a211a8ba262a3cca7e2ca701e4a9a4fba43c90ccdcb281d48c7c6fd62875d2aca417034c34aee5"

Test 8 failed, but this is expected because |IV| <> 12 bytes and we don't do IV expansion.
Please disregard.

Test 9 OK

Test 10 OK

Test 11 OK

Test 12 OK

Output cipher:	677a374b4dd797f8ea0252a721fa83784f68c4877cf4e60f8c1f56972e9c20f789efb32096dd6336c6e5ef833b041251fdf04ce41fbcf2fea0d1e83c
Output tag:	91b8ee617f7c50dab5bc75abff3bc1c3
cipher:		AES-256-GCM
key:		"feffe9928665731c6d6a8f9467308308feffe9928665731c6d6a8f9467308308"
iv:		"cafebabefacedbad"
aad:		"feedfacedeadbeeffeedfacedeadbeefabaddad2"
tag:		"3a337dbf46a792c45e454913fe2ea8f2"
plaintext:	"d9313225f88406e5a55909c5aff5269a86a7a9531534f7da2e4c303d8a318a721c3c0c95956809532fcf0e2449a6b525b16aedf5aa0de657ba637b39"
ciphertext:	"c3762df1ca787d32ae47c13bf19844cbaf1ae14d0b976afac52ff7d79bba9de0feb582d33934a4f0954cc2363bc73f7862ac430e64abe499f47c9b1f"

Test 13 failed, but this is expected because |IV| <> 12 bytes and we don't do IV expansion.
Please disregard.

Output cipher:	cf3b9ab7a70a2ac55a7bcf74cda369c5b32e7870a937cb4d7679ef877de6403b7126c8ca2d6c620755e8ff330af0e7fa003585282b2d7a3d8f785bcc
Output tag:	881390e147e8fc6b2923305b6413a594
cipher:		AES-256-GCM
key:		"feffe9928665731c6d6a8f9467308308feffe9928665731c6d6a8f9467308308"
iv:		"9313225df88406e555909c5aff5269aa6a7a9538534f7da1e4c303d2a318a728c3c0c95156809539fcf0e2429a6b525416aedbf5a0de6a57a637b39b"
aad:		"feedfacedeadbeeffeedfacedeadbeefabaddad2"
tag:		"a44a8266ee1c8eb0c8b5d4cf5ae9f19a"
plaintext:	"d9313225f88406e5a55909c5aff5269a86a7a9531534f7da2e4c303d8a318a721c3c0c95956809532fcf0e2449a6b525b16aedf5aa0de657ba637b39"
ciphertext:	"5a8def2f0c9e53f1f75d7853659e2a20eeb2b22aafde6419a058ab4f6f746bf40fc0c3b780f244452da3ebf1c5d82cdea2418997200ef82e44ae7e3f"

Test 14 failed, but this is expected because |IV| <> 12 bytes and we don't do IV expansion.
Please disregard.

Test 15 OK

Test 16 OK

Test 17 OK

Test 18 OK

Output cipher:	eff01b40f151144abb70955cedcbe564afd7d338ce2c3eb2ac13b1228ef785edc5bf4b7501cdc522a855c4e5843a3a0af67e4c8285f641951d9dcb727fb5d53bffe8165999884aa1626b20328a233f189b48820f19d2cf1551f21d0ae749227f1d47344d687533456994f11584dfd15d4791ceedf45f3774821bcd340d4b18ec8ed70e7ce40859ec159363caab3eaa87261cbda3733c01bbd39f03f21d3c4f1b3af2cadd75c67fbe96929c20a13077991908a0d23adbcecd49ed2ed71dd8f659
Output tag:	1f200ef9ef5218a0a69331c8304f873d
cipher:		AES-128-GCM
key:		"00000000000000000000000000000000"
iv:		"ffffffff000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000"
aad:		""
tag:		"566f8ef683078bfdeeffa869d751a017"
plaintext:	"000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000"
ciphertext:	"56b3373ca9ef6e4a2b64fe1e9a17b61425f10d47a75a5fce13efc6bc784af24f4141bdd48cf7c770887afd573cca5418a9aeffcd7c5ceddfc6a78397b9a85b499da558257267caab2ad0b23ca476a53cb17fb41c4b8b475cb4f3f7165094c229c9e8c4dc0a2a5ff1903e501511221376a1cdb8364c5061a20cae74bc4acd76ceb0abc9fd3217ef9f8c90be402ddf6d8697f4f880dff15bfb7a6b28241ec8fe183c2d59e3f9dfff653c7126f0acb9e64211f42bae12af462b1070bef1ab5e3606"

Test 19 failed, but this is expected because |IV| <> 12 bytes and we don't do IV expansion.
Please disregard.

Output cipher:	eff01b40f151144abb70955cedcbe564afd7d338ce2c3eb2ac13b1228ef785edc5bf4b7501cdc522a855c4e5843a3a0af67e4c8285f641951d9dcb727fb5d53bffe8165999884aa1626b20328a233f189b48820f19d2cf1551f21d0ae749227f1d47344d687533456994f11584dfd15d4791ceedf45f3774821bcd340d4b18ec8ed70e7ce40859ec159363caab3eaa87261cbda3733c01bbd39f03f21d3c4f1b3af2cadd75c67fbe96929c20a13077991908a0d23adbcecd49ed2ed71dd8f65954f4ff316fe216dd9e29b1ea55824efb884af85d0e6743d586acfc3088f200284dcb744dcf6fe40745827d98067e32af9b279d8f8354d7e47b8bb6736de3b66479f0d1ee5cb7796d966955cc6dea4ae5e4205b07040a0d9ec6594c2c6d2350a4
Output tag:	99b156f6881899ee456476976e9f5414
cipher:		AES-128-GCM
key:		"00000000000000000000000000000000"
iv:		"ffffffff000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000"
aad:		""
tag:		"8b307f6b33286d0ab026a9ed3fe1e85f"
plaintext:	"000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000"
ciphertext:	"56b3373ca9ef6e4a2b64fe1e9a17b61425f10d47a75a5fce13efc6bc784af24f4141bdd48cf7c770887afd573cca5418a9aeffcd7c5ceddfc6a78397b9a85b499da558257267caab2ad0b23ca476a53cb17fb41c4b8b475cb4f3f7165094c229c9e8c4dc0a2a5ff1903e501511221376a1cdb8364c5061a20cae74bc4acd76ceb0abc9fd3217ef9f8c90be402ddf6d8697f4f880dff15bfb7a6b28241ec8fe183c2d59e3f9dfff653c7126f0acb9e64211f42bae12af462b1070bef1ab5e3606872ca10dee15b3249b1a1b958f23134c4bccb7d03200bce420a2f8eb66dcf3644d1423c1b5699003c13ecef4bf38a3b60eedc34033bac1902783dc6d89e2e774188a439c7ebcc0672dbda4ddcfb2794613b0be41315ef778708a70ee7d75165c"

Test 20 failed, but this is expected because |IV| <> 12 bytes and we don't do IV expansion.
Please disregard.

Test 21 OK

AEAD: 21/21 tests passed
OCAMLPATH="C:/build/agent2/_work/6/s/FStar/bin" ocamlfind opt -package fstarlib,zarith -g -I C:/build/agent2/_work/6/s/FStar/ulib/ml -c QuicProvider/test.c -I QuicProvider/ -I ../secure_api/out/runtime_switch -I C:/build/agent2/_work/6/s/kremlin/include -I C:/build/agent2/_work/6/s/MLCrypto \
-I ../../mitls-fstar/libs/ffi -ccopt "-o QuicProvider/test.o" -I ../code/salsa-family/chacha-c -I ../code/poly1305/poly-c \
-I ../code/curve25519/x25519-c -I ../secure_api/out/runtime_switch/crypto -I ../code/api/aead-c \
-ccopt -Wall -ccopt -Wextra -ccopt -I -ccopt C:/build/agent2/_work/6/s/kremlin/include -ccopt -Wno-unused-variable -ccopt -Wno-unused-parameter -ccopt -Wno-unused-but-set-variable -ccopt -Wno-parentheses -ccopt -Werror -ccopt -Wno-unknown-warning-option
OCAMLPATH="C:/build/agent2/_work/6/s/FStar/bin" ocamlfind opt -package fstarlib,zarith -g -I C:/build/agent2/_work/6/s/FStar/ulib/ml -c QuicProvider/quic_provider.c -I QuicProvider/ -I ../secure_api/out/runtime_switch -I C:/build/agent2/_work/6/s/kremlin/include -I C:/build/agent2/_work/6/s/MLCrypto \
-I ../../mitls-fstar/libs/ffi -ccopt "-o QuicProvider/quic_provider.o" -I ../code/salsa-family/chacha-c -I ../code/poly1305/poly-c \
-I ../code/curve25519/x25519-c -I ../secure_api/out/runtime_switch/crypto -I ../code/api/aead-c \
-ccopt -Wall -ccopt -Wextra -ccopt -I -ccopt C:/build/agent2/_work/6/s/kremlin/include -ccopt -Wno-unused-variable -ccopt -Wno-unused-parameter -ccopt -Wno-unused-but-set-variable -ccopt -Wno-parentheses -ccopt -Werror -ccopt -Wno-unknown-warning-option
x86_64-w64-mingw32-gcc vale/asm/sha256_main_i.o vale/asm/sha256-x86_64.o vale/asm/Vale_Hash_SHA2_256.o vale/asm/vale_aes_glue.o vale/asm/aes-x86_64.o QuicProvider/quic_provider.o ../secure_api/out/runtime_switch/crypto/Crypto_AEAD_Main_Crypto_Symmetric_Cipher_Crypto_Indexing.o ../secure_api/out/runtime_switch/crypto/Crypto_Symmetric_Bytes.o ../secure_api/out/runtime_switch/crypto/Crypto_HKDF_Crypto_HMAC.o ../code/salsa-family/chacha-c/Hacl_Chacha20.o ../code/poly1305/poly-c/AEAD_Poly1305_64.o ../code/api/policies-c/Hacl_Policies.o ../code/api/aead-c/Hacl_Chacha20Poly1305.o C:/build/agent2/_work/6/s/kremlin/kremlib/out/libkremlib.a -o ../secure_api/out/runtime_switch/libquicprovider.dll  -shared
x86_64-w64-mingw32-gcc QuicProvider/test.o -o ../secure_api/out/runtime_switch/quicprovider-test.exe -L../secure_api/out/runtime_switch -lquicprovider C:/build/agent2/_work/6/s/kremlin/kremlib/out/libkremlib.a
./../secure_api/out/runtime_switch/quicprovider-test.exe
==== coverage ====
SHA256('') =
e3b0c44298fc1c149afbf4c8996fb92427ae41e4649b934ca495991b7852b855

SHA384('') = 
38b060a751ac96384cd9327eb1b1e36a21fdb71114be07434c0cc7bf63f6e1da
274edebfe76f65fbd51ad2f14898b95b

SHA512('') = 
cf83e1357eefb8bdf1542850d66d8007d620e4050b5715dc83f4a921d36ce9ce
47d0d13c5d85f2b0ff8318d2877eec2f63b931bd47417a81a538327af927da3e
+ cd mitls-fstar/src/tls

HMAC-SHA256('Jefe', 'what do ya want for nothing?') = 
+ make -j 16 test
5bdcc146bf60754e6a042426089575c75a003f089d2739839dec58b964ec3843

HMAC-SHA384('Jefe', 'what do ya want for nothing?') = 
af45d2e376484031617f78d2b58a6b1b9c7ef464f5a01b47e42ec3736322445e
8e2240ca5e69e2c78b3239ecfab21649

HMAC-SHA512('Jefe', 'what do ya want for nothing?') = 
164b7a7bfcf819e2e395fbe73b56e0a387bd64222e831fd610270cd7ea250554
9758bf75c05a994a6d034f65f8f0e6fdcaeab1a34d4a6b4b636e070a38bce737

prk = HKDF-EXTRACT-SHA256('0x000102030405060708090a0b0c', '0x0b0b0b0b0b0b0b0b0b0b0b0b0b0b0b0b0b0b0b0b0b0b')
077709362c2e32df0ddc3f0dc47bba6390b6c73bb50f9c3122ec844ad7c2b3e5
077709362c2e32df0ddc3f0dc47bba6390b6c73bb50f9c3122ec844ad7c2b3e5

okm = HKDF-EXPAND-SHA256(prk, '0xf0f1f2f3f4f5f6f7f8f9', 42)
3cb25f25faacd57a90434f64d0362f2a2d2d0a90cf1a5a4c5db02d56ecc4c5bf
34007208d5b887185865

AES-128-GCM encrypt test:
5936f46d6c7eb7008dbbfb0d40b491fce5328aedcbc0c5272457d347363fd36d
f238bd17971e982f4449350d
PN encryption mask:
a52e332b
DECRYPT SUCCESS: 
7768617420646f2079612077616e7420666f72206e6f7468696e673f

CHACHA20-POLY1305 encrypt test:
a62fe99f3d6001a4f4214a986f04b1f42ea1e5dcea3236ecf35adb5d8cc57db2
df5e18b278c8c904fcddf440
PN encryption mask:
308ac6f5
DECRYPT SUCCESS: 
7768617420646f2079612077616e7420666f72206e6f7468696e673f
==== PASS:  coverage ====


==== test_crypto(TLS_hash_SHA256,TLS_aead_AES_128_GCM) ====
PASS
==== test_crypto(TLS_hash_SHA384,TLS_aead_AES_128_GCM) ====
PASS
==== test_crypto(TLS_hash_SHA512,TLS_aead_AES_128_GCM) ====
PASS
==== test_crypto(TLS_hash_SHA256,TLS_aead_AES_256_GCM) ====
PASS
==== test_crypto(TLS_hash_SHA384,TLS_aead_AES_256_GCM) ====
PASS
==== test_crypto(TLS_hash_SHA512,TLS_aead_AES_256_GCM) ====
PASS
==== test_crypto(TLS_hash_SHA256,TLS_aead_CHACHA20_POLY1305) ====
PASS
==== test_crypto(TLS_hash_SHA384,TLS_aead_CHACHA20_POLY1305) ====
PASS
==== test_crypto(TLS_hash_SHA512,TLS_aead_CHACHA20_POLY1305) ====
PASS
==== test_pn_encrypt() ====
PN encryption mask: fbb4b174
Decrypted PN: c0000000
==== test_handshake_secrets() ====
==== PASS: test_handshake_secrets ==== 
==== ALL TESTS PASS ====
make: Leaving directory '/cygdrive/c/build/agent2/_work/6/s/hacl-star/secure_api'
rm -f cache/OCaml/.depend cache/Kremlin/.depend cache/Model/.depend
make -f Makefile.Model test
make -f Makefile.Kremlin test
make -f Makefile.OCaml test
make -C ../../apps/quicMinusNet test -k
make[1]: Entering directory '/cygdrive/c/build/agent2/_work/6/s/mitls-fstar/apps/quicMinusNet'
quic.c:1:0: warning: -fPIC ignored for target (all code is position independent)
x86_64-w64-mingw32-gcc.exe -fPIC -I../../src/tls/extract/Kremlin-Library/include \
-I../../src/tls/extract/Kremlin-Library/stub -I../../src/pki \
#define __USE_MINGW_ANSI_STDIO 1
-I../../libs/ffi -I/cygdrive/c/build/agent2/_work/6/s/hacl-star/secure_api/QuicProvider \
quic.c \
^
-L/cygdrive/c/build/agent2/_work/6/s/hacl-star/providers/out -L../../src/pki -L../../src/tls/extract/Kremlin-Library -L/cygdrive/c/build/agent2/_work/6/s/hacl-star/secure_api/out/runtime_switch -L/cygdrive/c/build/agent2/_work/6/s/MLCrypto/openssl \
-lmitls -lquicprovider -lmipki -lbcrypt -o quic.exe
make[1]: Leaving directory '/cygdrive/c/build/agent2/_work/6/s/mitls-fstar/apps/quicMinusNet'
make[1]: Entering directory '/cygdrive/c/build/agent2/_work/6/s/mitls-fstar/apps/quicMinusNet'
./quic.exe
server create
FFI| offering custom extension 001a
FFI| extension contents: ffff00050a0b0c0d0e
FFI| setting early data limit to ffffffff
FFI| Setting a new ticket callback.
FFI| Setting a new server negotiation callback.
FFI| Setting up certificate callbacks.
client create
FFI| offering custom extension 001a
FFI| extension contents: ffff00050a0b0c0d0e
FFI| setting early data limit to ffffffff
FFI| Setting a new ticket callback.
FFI| Setting a new server negotiation callback.
FFI| Setting up certificate callbacks.
client call clen=8192 slen=   0
TLS| writeHandshake (plaintext)
TLS| HS.next_fragment PlaintextID?
HS | next_fragment
HS | offering ClientHello 1.3
KS | ks_client_init 1.3
CDH| Keygen (initiator) on X255519
NGO| No PSK or 0-RTT disabled
NGO| offering client extensions [ 001a supported_versions key_share server_name alpn extended_master_secret signature_algorithms supported_groups psk_key_exchange_modes ]
NGO| offering cipher suites ; TLS_CHACHA20_POLY1305_SHA256; TLS_AES_128_GCM_SHA256
HSL| emit ClientHello
TLS| HS.next_fragment returned a fragment
TLS| sendHandshake
TLS| send Handshake fragment with index PlaintextID
TLS| Sending fragment of length 170
REC| record headers: 16030300aa
TLS| writeHandshake (plaintext)
TLS| HS.next_fragment PlaintextID?
HS | next_fragment
TLS| HS.next_fragment returned nothing
TLS| sendHandshake
TLS| read: WrittenHS, Ctrl/Ctrl, nothing
REC| WouldBlock
TLS| readOne ReadWouldBlock
client done clen= 175 slen=   0 status=would_block
16030300aa010000a603035b22e43df97dd91344415e1ed4ee9c8a860a69b8ac
db136a86db56e25e0be9590000041303130101000079001a0009ffff00050a0b
0c0d0e002b0003027f1c003300260024001d0020060321b46f0d104600c354a5
fc4d026800b1cacea672aabbf3b601da95f48b0b0000000e000c0000096c6f63
616c686f73740010000800060568712d313000170000000d0006000408040403
000a00040002001d002d0003020001
server call clen= 175 slen=8192
TLS| writeHandshake (plaintext)
TLS| HS.next_fragment PlaintextID?
HS | next_fragment
TLS| HS.next_fragment returned nothing
TLS| sendHandshake
TLS| read: WrittenHS, Ctrl/Ctrl, nothing
TLS| Read fragment at epoch index: -1 of length 170
TLS| read Handshake fragment
HS | recv_fragment
HSL| parsed [ClientHello] -- end of flight 
HS | Processing ClientHello
NGO| offered client extensions [ 001a supported_versions key_share server_name alpn extended_master_secret signature_algorithms supported_groups psk_key_exchange_modes ]
NGO| offered cipher suites ; TLS_CHACHA20_POLY1305_SHA256; TLS_AES_128_GCM_SHA256
NGO| offered versions 1.3
NGO| Negotiated Pure EDH key exchange
NGO| Negotiated ECDSA_SECP256R1_SHA256
NGO| Negotiation callback to handle extra extensions and query for stateless retry.
NGO| Application data in cookie: none
@@@@ Nego callback for TLS 1.3 @@@@
Offered extensions:
003d001a0009ffff00050a0b0c0d0e0000000e000c0000096c6f63616c686f73
740010000800060568712d3130000d0006000408040403000a00040002001d
Transport parameters offered:
ffff00050a0b0c0d0e
No application cookie (fist connection).
Adding server transport parameters:
000102
@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
NGO| negotiated 1.3 TLS_CHACHA20_POLY1305_SHA256
KS | ks_server_init
KS | No PSK selected.
KS | Computed early secret:           33ad0a1c607ec03b09e6cd9893680ce210adf300aa1f2660e1b22e10f170f92a
KS | Handshake salt:                  6f2615a108c702c5678f54fc9dbab69716c076189c48250cebeac3576c3611ba
CDH| Keygen (responder) on X255519
CDH| DH initiator on X255519
KS | DH shared secret: bea09cbe59efed10e22f43916c727092dc16c7dacba063146583790f48b46905
KS | Handshake secret:                b8afb47474bf7be8b2f339251be1ae7e23789043921a4711a6d810644f5cbba1
NGO| processing client extensions [ 001a supported_versions key_share server_name alpn extended_master_secret signature_algorithms supported_groups psk_key_exchange_modes ]
NGO| including server extensions (SH + EE) [ supported_versions key_share alpn supported_groups ]
NGO| extra extensions from application callback: 001a 
HSL| emit ServerHello and hash
HS | derive handshake keys
KS | ks_server_13_sh, hashed log = 8911674838755ed52f09f347532646f64fb9743500d5e315d043d2733e28fe4b
KS | handshake traffic secret[C]:     29838215834312852f55c7b02dc14955f45695fa92c53bb36362cbcdde14e349
KS | handshake traffic secret[S]:     fb88038f8fbd554104a4ed05e7152e330ab65f77e7fee8596cb633dd163f87d0
KS | handshake key[C]:                ad160e8310cbe45320840da62a7ba763fc5281f5a15e0931855fea438bc1621a, IV=a3e5dc3381f30e9bd3b7d511
KS | handshake key[S]: 6ca67031faf50c81489f6d161758073efacf8c9ffed0b20e619d4ef6375e3091, IV=5eed7bf758341b8244c4fcb6
AEP| LowProvider: COERCE(K=6ca67031faf50c81489f6d161758073efacf8c9ffed0b20e619d4ef6375e3091)
AEP| LowProvider: COERCE(K=ad160e8310cbe45320840da62a7ba763fc5281f5a15e0931855fea438bc1621a)
KS | finished key[C]:                 dbfb3904cbefb944429e8cb7b4742893a5c853175f8c4971e0531a5f365e7847
KS | finished key[S]:                 e6c1fe7f1d0176941a5ff9a1459535dc89978b74b8d7973c48ed3976d49998d1
KS | Application salt:                96a36334490b90f9aca207cc50424b5d091b6d1f2ef131b2e892bd52e306df9a
KS | Application secret:              9b7c51a080b247e9e1f0020cdeb77e2f1a02f9d76c0d8409df0f4410882cbedc
TLS| readOne ReadAgain
TLS| writeHandshake (plaintext)
TLS| HS.next_fragment PlaintextID?
HS | next_fragment
TLS| HS.next_fragment returned a fragment; next_keys (for handshake only
TLS| sendHandshake
TLS| send Handshake fragment with index PlaintextID
TLS| Sending fragment of length 90
REC| record headers: 160303005a
EPO| writer++ -1/0
TLS| writeHandshake (encrypted)
TLS| HS.next_fragment ID13?
HS | next_fragment
HS | prepare Server Finished
HSL| emit EncryptedExtensions
HSL| emit Certificate13 and hash
======== TO BE SIGNED <0403>: (130 octets) ========
2020202020202020202020202020202020202020202020202020202020202020
2020202020202020202020202020202020202020202020202020202020202020
544c5320312e332c207365727665722043657274696669636174655665726966
7900ad89a95a0cf207c5278918a3e3ed38ee742d7c1aa9a4994cbfbc595b51e9
d77c
===================================================
HSL| emit CertificateVerify and hash
HSL| emit Finished and hash
KS | ks_server_13_sf hashed_log = 3c2259b4117bec0cf1172147a4fa9378307406be827350d6a37a1b464a34e0bf
KS | application traffic secret[C]:   2c52af687897b12daa9c104ed959b1b863d5bf72aa23bd3caef054f03d0361cf
KS | application traffic secret[S]:   ef7adfaf6506d26b2081dcadd5ceeb21b5df9821a8e331a5f3b1a3d24d86d666
KS | exporter master secret:          82465b60819dd4318e07e2659141733813b8016f2561e572e6934f9e73d5f16c
KS | application key[C]:              962b204b65a004e26f78ed7a83956dac694df63d0378a985ba76a65324b7abaa, IV=f8fc171c08163156b9de6baf
KS | application key[S]:              e382a953c3f09df134e9e766ef03135a2c93f5117da23609dc56d6b6fe45e30b, IV=4c16f12489b73b63c6fdd0d4
AEP| LowProvider: COERCE(K=e382a953c3f09df134e9e766ef03135a2c93f5117da23609dc56d6b6fe45e30b)
AEP| LowProvider: COERCE(K=962b204b65a004e26f78ed7a83956dac694df63d0378a985ba76a65324b7abaa)
HS | exporting a key
EPO| reader++ 0/0
TLS| HS.next_fragment returned a fragment; next_keys (for all data)
TLS| sendHandshake
TLS| send Handshake fragment with index ID13
TLS| Encrypting with key 6ca67031faf50c81489f6d161758073efacf8c9ffed0b20e619d4ef6375e3091
TLS| Sending fragment of length 734
REC| record headers: 17030302de
EPO| writer++ 0/1
TLS| read: WrittenHS, Ctrl/Open, new writer: writable
sender done clen= 175 slen= 834 status=server_accept
160303005a0200005603035b22e43d1155d8a69d86366411278070ebe113994f
154bd80558f302ee1eb9b000130300002e002b00027f1c00330024001d0020aa
0941fb76877c78bb1e9da370423f6358f390248f401bb302a1030c43bece7817
030302dee0ba98408fd3b670ce67d631e4fdaa65c7e6f7231a305cd36c0812ee
8ac0838647c73952eb6cf68ec1ff267c45f8e382ce9996ce5aa49abb0c94256b
591a04a440bc9022a7ca0c1ac31b2a096842aa2a92c6bcfe2e6aebd7b938b39a
a9aca71599ae961f6afe3456a790035bc20804faa020777291e7a54e98c6a17a
dd8a748ef34a707d862dd6335b2efad6394c620f94dd268ac4564d87531e5ff3
df9d363c3090a4c357054978f7fade758b6d00bed59ea9d7134c787fa72f1057
be265aa9f844c45047d3823e65699be435a4d5ecc63970f9284026da7aa1722b
3614518e4d88f054075402d85a6cd942e3bde260c9992023b787a491d0cde126
87fa2e756e79670353e51c9ca66b22f15ea32c37866cca4b6e5f52da485a8de7
c4ba995dd4a866db2443ce5da262407dbec6ca183364a9b535c587d062c8f83a
860bb8fb67b59bb1262ea1ab4c11e67811afd7060daf42a37de30a84246abec9
5028a4d8feed71aecb4f07a681279530233c576daf503d7effe02914bc48e8d2
c38e145b0b01c84bcc7196cf5b48c8cc5b7fa52a7b6ff3e64cbc4d213ff80c6d
473d59ca0cf02f89d69e3b8a2743b4163032bf20578a9729c0895a10e7a72048
6544f622cfa5d40b540d6a5514c2e82ca12a858535cbfffe53255e2289b3d60d
6b3245360a55e945816c132b35ad89e4175d1ae4f67c13d276a9d75afaf1527d
fbba71cf60cb5cb83d7b58d12f4669f9ec30bb49f17b9446475a8e4097b02016
6621704c4a919ddfa4f973f72f4d9a97fe8c66995571f971d79419a00cd8cba5
dfb554cf9998576f60be376f0edbb67aee85b7fc05266041e1168f3244433883
dde0effe57606a802a731f9e07186e0ac621f3e7b50fe221464a3a5206631390
e07e458c85cdacb4f64f0ecf6a1046e5b9298f1dcb7a8707658fb0cecfd29a7a
fab32507df9d2b45d01b681d8f3d38a9e6a00d5bb466a5b402e0c0b561a52cd8
1fd6b007fb7b148f3563c00973dd8757f5883b5323ab3e85fc3d07f545031f86
c9c2
client call clen=8017 slen= 834
TLS| writeHandshake (plaintext)
TLS| HS.next_fragment PlaintextID?
HS | next_fragment
TLS| HS.next_fragment returned nothing
TLS| sendHandshake
TLS| read: WrittenHS, Ctrl/Ctrl, nothing
TLS| Read fragment at epoch index: -1 of length 90
TLS| read Handshake fragment
HS | recv_fragment
HSL| parsed ServerHello
HSL| end of flight
HS | client_ServerHello
NGO| processing server extensions [ supported_versions key_share ]
NGO| negotiated 1.3 TLS_CHACHA20_POLY1305_SHA256
HS | Running TLS 1.3
KS | ks_client_13_sh hashed_log = 8911674838755ed52f09f347532646f64fb9743500d5e315d043d2733e28fe4b
KS | no PSK negotiated. Early secret: 33ad0a1c607ec03b09e6cd9893680ce210adf300aa1f2660e1b22e10f170f92a
KS | handshake salt:                  6f2615a108c702c5678f54fc9dbab69716c076189c48250cebeac3576c3611ba
CDH| DH initiator on X255519
KS | DH shared secret: bea09cbe59efed10e22f43916c727092dc16c7dacba063146583790f48b46905
KS | handshake secret:                b8afb47474bf7be8b2f339251be1ae7e23789043921a4711a6d810644f5cbba1
KS | handshake traffic secret[C]:     29838215834312852f55c7b02dc14955f45695fa92c53bb36362cbcdde14e349
KS | handshake traffic secret[S]:     fb88038f8fbd554104a4ed05e7152e330ab65f77e7fee8596cb633dd163f87d0
KS | handshake key[C]:                ad160e8310cbe45320840da62a7ba763fc5281f5a15e0931855fea438bc1621a, IV=a3e5dc3381f30e9bd3b7d511
KS | handshake key[S]:                6ca67031faf50c81489f6d161758073efacf8c9ffed0b20e619d4ef6375e3091, IV=5eed7bf758341b8244c4fcb6
KS | finished key[C]: dbfb3904cbefb944429e8cb7b4742893a5c853175f8c4971e0531a5f365e7847
KS | finished key[S]: e6c1fe7f1d0176941a5ff9a1459535dc89978b74b8d7973c48ed3976d49998d1
KS | application salt:                96a36334490b90f9aca207cc50424b5d091b6d1f2ef131b2e892bd52e306df9a
KS | application secret:              9b7c51a080b247e9e1f0020cdeb77e2f1a02f9d76c0d8409df0f4410882cbedc
AEP| LowProvider: COERCE(K=ad160e8310cbe45320840da62a7ba763fc5281f5a15e0931855fea438bc1621a)
AEP| LowProvider: COERCE(K=6ca67031faf50c81489f6d161758073efacf8c9ffed0b20e619d4ef6375e3091)
EPO| reader++ 0/-1
TLS| readOne ReadAgain
TLS| writeHandshake (plaintext)
TLS| HS.next_fragment PlaintextID?
HS | next_fragment
TLS| HS.next_fragment returned nothing
TLS| sendHandshake
TLS| read: WrittenHS, Ctrl/Ctrl, nothing
TLS| Read fragment at epoch index: 0 of length 734
TLS| StAE decrypt correct.
TLS| read Handshake fragment
HS | recv_fragment
HSL| parsed EncryptedExtensions
HSL| parsed Certificate13
HSL| parsed CertificateVerify
HSL| parsed Finished
HSL| end of flight
NGO| Nego.clientComplete_13
NGO| EE: alpn supported_groups 001a 
NGO| Negotiation callback to process application extensions.
@@@@ Nego callback for TLS 1.3 @@@@
Offered extensions:
001b0010000800060568712d3130000a00040002001d001a0003000102
Transport parameters offered:
000102
No application cookie (fist connection).
Adding server transport parameters:
000102
@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
WARNING: chain validation failed, ignoring.
NGO| Certificate & signature 1.3 callback result: valid
KS | ks_client_13_sf hashed_log = 3c2259b4117bec0cf1172147a4fa9378307406be827350d6a37a1b464a34e0bf
KS | application traffic secret[C]:   2c52af687897b12daa9c104ed959b1b863d5bf72aa23bd3caef054f03d0361cf
KS | application traffic secret[S]:   ef7adfaf6506d26b2081dcadd5ceeb21b5df9821a8e331a5f3b1a3d24d86d666
KS | exporter master secret:          82465b60819dd4318e07e2659141733813b8016f2561e572e6934f9e73d5f16c
KS | application key[C]:              962b204b65a004e26f78ed7a83956dac694df63d0378a985ba76a65324b7abaa, IV=f8fc171c08163156b9de6baf
KS | application key[S]:              e382a953c3f09df134e9e766ef03135a2c93f5117da23609dc56d6b6fe45e30b, IV=4c16f12489b73b63c6fdd0d4
AEP| LowProvider: COERCE(K=962b204b65a004e26f78ed7a83956dac694df63d0378a985ba76a65324b7abaa)
AEP| LowProvider: COERCE(K=e382a953c3f09df134e9e766ef03135a2c93f5117da23609dc56d6b6fe45e30b)
HS | exporting a key
HS | Early data rejected
EPO| writer++ 0/0
HSL| emit Finished and hash
KS | ks_client_13_cf hashed_log = 81ad2dfd5f71076a9731852d5c4885f92282b4da1822aba48c2936b54e9494b8
KS | resumption master secret:        9ac4e4072df1ff24c81d988a6e985f3e45aafcaccebdde0ee72cf8707217472e
EPO| reader++ 1/0
TLS| readOne ReadAgain
TLS| writeHandshake (encrypted)
TLS| HS.next_fragment ID13?
HS | next_fragment
TLS| HS.next_fragment returned a fragment; next_keys (for all data); complete
TLS| sendHandshake
TLS| send Handshake fragment with index ID13
TLS| Encrypting with key ad160e8310cbe45320840da62a7ba763fc5281f5a15e0931855fea438bc1621a
TLS| Sending fragment of length 53
REC| record headers: 1703030035
EPO| writer++ 1/1
TLS| read: WrittenHS, Open/Open, new writer: complete
client done clen=  58 slen= 834 status=client_complete
1703030035d5511adf356c7961890c6db20a4b7d82daf84a4e942e02573bdf78
9a08c9f2efdc70b05ce142ab7efbc082ed10cfbff083d69451f4
server call clen=  58 slen=7358
TLS| writeHandshake (encrypted)
TLS| HS.next_fragment ID13?
HS | next_fragment
TLS| HS.next_fragment returned nothing
TLS| sendHandshake
TLS| read: WrittenHS, Ctrl/Open, nothing
TLS| Read fragment at epoch index: 0 of length 53
TLS| StAE decrypt correct.
TLS| read Handshake fragment
HS | recv_fragment
HSL| parsed Finished
HSL| end of flight
HS | Process Client Finished
KS | ks_server_13_cf hashed_log = 81ad2dfd5f71076a9731852d5c4885f92282b4da1822aba48c2936b54e9494b8
KS | resumption master secret:        9ac4e4072df1ff24c81d988a6e985f3e45aafcaccebdde0ee72cf8707217472e
AEP| LowProvider: COERCE(K=950bb8b181cbacc6c3ed88f7cb663e3e0230d9355695df3796423d284266ab1e)
HS | Sending ticket: 51ed082733b117f29ab64fb13ece3a41a72680112e384e1481369f193cdb8ca94ab93cd87c681b3c138a19ad8974ebbb4c86c84fee646fb791e2beab678a44d27490a64b1161b278ec62999c
HSL| emit NewSessionTicket13
EPO| reader++ 1/1
TLS| readOne Complete
sender done clen=  58 slen=   0 status=server_complete
=== Exporter secret ===
82465b60819dd4318e07e2659141733813b8016f2561e572e6934f9e73d5f16c
=== QUIC 1-RTT secrets ===
C: e03e5c74ec75687adbcb7015d44e985fb3530ecc6fc9f17c514e3a03022b1955
S: 33d018d00e7c11efa4cfc74b2d9f74c4f28bb51ca420d5e0dc45ad383be207cb
=== AEAD client key test ===
dbb607fcf6891cf0859617a331b70d2d1689de96a03c6c7d5507f8
=== Decrypt successful ===
Ok
./quic.exe 0rtt

INITIAL ECDHE HANDSHAKE (NO EARLY SECRET)

server create
FFI| offering custom extension 001a
FFI| extension contents: ffff00050a0b0c0d0e
FFI| setting early data limit to ffffffff
FFI| Setting a new ticket callback.
FFI| Setting a new server negotiation callback.
FFI| Setting up certificate callbacks.
client create
FFI| offering custom extension 001a
FFI| extension contents: ffff00050a0b0c0d0e
FFI| setting early data limit to ffffffff
FFI| Setting a new ticket callback.
FFI| Setting a new server negotiation callback.
FFI| Setting up certificate callbacks.
TLS| writeHandshake (plaintext)
TLS| HS.next_fragment PlaintextID?
HS | next_fragment
HS | offering ClientHello 1.3
KS | ks_client_init 1.3
CDH| Keygen (initiator) on X255519
NGO| No PSK or 0-RTT disabled
NGO| offering client extensions [ 001a supported_versions key_share server_name alpn extended_master_secret signature_algorithms supported_groups psk_key_exchange_modes ]
NGO| offering cipher suites ; TLS_CHACHA20_POLY1305_SHA256; TLS_AES_128_GCM_SHA256
HSL| emit ClientHello
TLS| HS.next_fragment returned a fragment
TLS| sendHandshake
TLS| send Handshake fragment with index PlaintextID
TLS| Sending fragment of length 170
REC| record headers: 16030300aa
TLS| writeHandshake (plaintext)
TLS| HS.next_fragment PlaintextID?
HS | next_fragment
TLS| HS.next_fragment returned nothing
TLS| sendHandshake
TLS| read: WrittenHS, Ctrl/Ctrl, nothing
REC| WouldBlock
TLS| readOne ReadWouldBlock
client returns would_block clen=175 slen=0
ClientHello[ 175] ---->

TLS| writeHandshake (plaintext)
TLS| HS.next_fragment PlaintextID?
HS | next_fragment
TLS| HS.next_fragment returned nothing
TLS| sendHandshake
TLS| read: WrittenHS, Ctrl/Ctrl, nothing
TLS| Read fragment at epoch index: -1 of length 170
TLS| read Handshake fragment
HS | recv_fragment
HSL| parsed [ClientHello] -- end of flight 
HS | Processing ClientHello
NGO| offered client extensions [ 001a supported_versions key_share server_name alpn extended_master_secret signature_algorithms supported_groups psk_key_exchange_modes ]
NGO| offered cipher suites ; TLS_CHACHA20_POLY1305_SHA256; TLS_AES_128_GCM_SHA256
NGO| offered versions 1.3
NGO| Negotiated Pure EDH key exchange
NGO| Negotiated ECDSA_SECP256R1_SHA256
NGO| Negotiation callback to handle extra extensions and query for stateless retry.
NGO| Application data in cookie: none
@@@@ Nego callback for TLS 1.3 @@@@
Offered extensions:
003d001a0009ffff00050a0b0c0d0e0000000e000c0000096c6f63616c686f73
740010000800060568712d3130000d0006000408040403000a00040002001d
Transport parameters offered:
ffff00050a0b0c0d0e
No application cookie (fist connection).
Adding server transport parameters:
000102
@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
NGO| negotiated 1.3 TLS_CHACHA20_POLY1305_SHA256
KS | ks_server_init
KS | No PSK selected.
KS | Computed early secret:           33ad0a1c607ec03b09e6cd9893680ce210adf300aa1f2660e1b22e10f170f92a
KS | Handshake salt:                  6f2615a108c702c5678f54fc9dbab69716c076189c48250cebeac3576c3611ba
CDH| Keygen (responder) on X255519
CDH| DH initiator on X255519
KS | DH shared secret: 0fd6a0aadd99846feab8617d6354ccf9472d5985822710d3983f6a1f8d124b2c
KS | Handshake secret:                017af5004649cde600dd30823f2c31659279e7e57afb99778d8f54a683b93f15
NGO| processing client extensions [ 001a supported_versions key_share server_name alpn extended_master_secret signature_algorithms supported_groups psk_key_exchange_modes ]
NGO| including server extensions (SH + EE) [ supported_versions key_share alpn supported_groups ]
NGO| extra extensions from application callback: 001a 
HSL| emit ServerHello and hash
HS | derive handshake keys
KS | ks_server_13_sh, hashed log = faf1a94540a1b126f3bfce55591c94c1506aa4716176f976611843571fe648f4
KS | handshake traffic secret[C]:     3f977c1263b8d3208a202b9efb761156f4017ae2a8b68452c35a67b70c2a8e53
KS | handshake traffic secret[S]:     d7b95cdec1f924566fb1129bdfbe66fed7153d1adb8b736dcc2857b6c9900639
KS | handshake key[C]:                1a96b46671098bc7bb55bd151edd0b2cad150a4e4439a27645849e3990754cd0, IV=705cf1ad468614ce9c9195fd
KS | handshake key[S]: c5117681d3486c7ef5595fe1c85ffa7eb0fe5b32843a476e3bc7ffd5599dc3aa, IV=1a718a110e02570274d9cb76
AEP| LowProvider: COERCE(K=c5117681d3486c7ef5595fe1c85ffa7eb0fe5b32843a476e3bc7ffd5599dc3aa)
AEP| LowProvider: COERCE(K=1a96b46671098bc7bb55bd151edd0b2cad150a4e4439a27645849e3990754cd0)
KS | finished key[C]:                 c66b528316e3d02671803c67fada601fca8e252ac8de4319a842bdf9625c1a6e
KS | finished key[S]:                 fb31c93b84bbec3597d8f43ef1942efbf34ea02b044c57e69866d19b2a03942b
KS | Application salt:                06e1dee3c7260cdf51028bf137940cf5a100b882e5b0ba4dc596c6a8ca8844c0
KS | Application secret:              a2f811c1090306e2bc3892aac1375b2c0333a87408d549b466c9befc2f1c3fe7
TLS| readOne ReadAgain
TLS| writeHandshake (plaintext)
TLS| HS.next_fragment PlaintextID?
HS | next_fragment
TLS| HS.next_fragment returned a fragment; next_keys (for handshake only
TLS| sendHandshake
TLS| send Handshake fragment with index PlaintextID
TLS| Sending fragment of length 90
REC| record headers: 160303005a
EPO| writer++ -1/0
TLS| writeHandshake (encrypted)
TLS| HS.next_fragment ID13?
HS | next_fragment
HS | prepare Server Finished
HSL| emit EncryptedExtensions
HSL| emit Certificate13 and hash
======== TO BE SIGNED <0403>: (130 octets) ========
2020202020202020202020202020202020202020202020202020202020202020
2020202020202020202020202020202020202020202020202020202020202020
544c5320312e332c207365727665722043657274696669636174655665726966
7900e7c86c4c2493d858bf99f6054eee99d6c4dad14c2c9b0088a81ceb31f7bf
4375
===================================================
HSL| emit CertificateVerify and hash
HSL| emit Finished and hash
KS | ks_server_13_sf hashed_log = c9cc1dbafdb43f0bb7f87d280637bc0273ed5ef8a5756e31931f2e9b46d22287
KS | application traffic secret[C]:   a89b37538786a6383b7062cb26ad41196b89de36dd2f191fbaa1ce1d33344d2f
KS | application traffic secret[S]:   d46adc66fc24b167824fdc7feb389fa6c70030b18059d8a963f09e3d12b5a325
KS | exporter master secret:          d8677afe29fa40597f61bdcacba7f4e33ee647e0be7e349abe6235e7deda7ec8
KS | application key[C]:              35a7dc0c6e7d09ce3714ef549faa4a9a3040dd39de8073918de952d58a55874b, IV=84e4ad1474cf1a3da6de501f
KS | application key[S]:              b840c9a89519d3f698626e90c9311243db9cf0b5eb1e909bbc3a71e0e220d179, IV=8b86406b08dbe71598c55f8b
AEP| LowProvider: COERCE(K=b840c9a89519d3f698626e90c9311243db9cf0b5eb1e909bbc3a71e0e220d179)
AEP| LowProvider: COERCE(K=35a7dc0c6e7d09ce3714ef549faa4a9a3040dd39de8073918de952d58a55874b)
HS | exporting a key
EPO| reader++ 0/0
TLS| HS.next_fragment returned a fragment; next_keys (for all data)
TLS| sendHandshake
TLS| send Handshake fragment with index ID13
TLS| Encrypting with key c5117681d3486c7ef5595fe1c85ffa7eb0fe5b32843a476e3bc7ffd5599dc3aa
TLS| Sending fragment of length 733
REC| record headers: 17030302dd
EPO| writer++ 0/1
TLS| read: WrittenHS, Ctrl/Open, new writer: writable
server returns server_accept clen=175 slen=833
secret=d8677afe29fa40597f61bdcacba7f4e33ee647e0be7e349abe6235e7deda7ec8
<---- ServerHello;(EncryptedExtensions; Certificate; CertVerify; Finished)[ 833]

TLS| writeHandshake (plaintext)
TLS| HS.next_fragment PlaintextID?
HS | next_fragment
TLS| HS.next_fragment returned nothing
TLS| sendHandshake
TLS| read: WrittenHS, Ctrl/Ctrl, nothing
TLS| Read fragment at epoch index: -1 of length 90
TLS| read Handshake fragment
HS | recv_fragment
HSL| parsed ServerHello
HSL| end of flight
HS | client_ServerHello
NGO| processing server extensions [ supported_versions key_share ]
NGO| negotiated 1.3 TLS_CHACHA20_POLY1305_SHA256
HS | Running TLS 1.3
KS | ks_client_13_sh hashed_log = faf1a94540a1b126f3bfce55591c94c1506aa4716176f976611843571fe648f4
KS | no PSK negotiated. Early secret: 33ad0a1c607ec03b09e6cd9893680ce210adf300aa1f2660e1b22e10f170f92a
KS | handshake salt:                  6f2615a108c702c5678f54fc9dbab69716c076189c48250cebeac3576c3611ba
CDH| DH initiator on X255519
KS | DH shared secret: 0fd6a0aadd99846feab8617d6354ccf9472d5985822710d3983f6a1f8d124b2c
KS | handshake secret:                017af5004649cde600dd30823f2c31659279e7e57afb99778d8f54a683b93f15
KS | handshake traffic secret[C]:     3f977c1263b8d3208a202b9efb761156f4017ae2a8b68452c35a67b70c2a8e53
KS | handshake traffic secret[S]:     d7b95cdec1f924566fb1129bdfbe66fed7153d1adb8b736dcc2857b6c9900639
KS | handshake key[C]:                1a96b46671098bc7bb55bd151edd0b2cad150a4e4439a27645849e3990754cd0, IV=705cf1ad468614ce9c9195fd
KS | handshake key[S]:                c5117681d3486c7ef5595fe1c85ffa7eb0fe5b32843a476e3bc7ffd5599dc3aa, IV=1a718a110e02570274d9cb76
KS | finished key[C]: c66b528316e3d02671803c67fada601fca8e252ac8de4319a842bdf9625c1a6e
KS | finished key[S]: fb31c93b84bbec3597d8f43ef1942efbf34ea02b044c57e69866d19b2a03942b
KS | application salt:                06e1dee3c7260cdf51028bf137940cf5a100b882e5b0ba4dc596c6a8ca8844c0
KS | application secret:              a2f811c1090306e2bc3892aac1375b2c0333a87408d549b466c9befc2f1c3fe7
AEP| LowProvider: COERCE(K=1a96b46671098bc7bb55bd151edd0b2cad150a4e4439a27645849e3990754cd0)
AEP| LowProvider: COERCE(K=c5117681d3486c7ef5595fe1c85ffa7eb0fe5b32843a476e3bc7ffd5599dc3aa)
EPO| reader++ 0/-1
TLS| readOne ReadAgain
TLS| writeHandshake (plaintext)
TLS| HS.next_fragment PlaintextID?
HS | next_fragment
TLS| HS.next_fragment returned nothing
TLS| sendHandshake
TLS| read: WrittenHS, Ctrl/Ctrl, nothing
TLS| Read fragment at epoch index: 0 of length 733
TLS| StAE decrypt correct.
TLS| read Handshake fragment
HS | recv_fragment
HSL| parsed EncryptedExtensions
HSL| parsed Certificate13
HSL| parsed CertificateVerify
HSL| parsed Finished
HSL| end of flight
NGO| Nego.clientComplete_13
NGO| EE: alpn supported_groups 001a 
NGO| Negotiation callback to process application extensions.
@@@@ Nego callback for TLS 1.3 @@@@
Offered extensions:
001b0010000800060568712d3130000a00040002001d001a0003000102
Transport parameters offered:
000102
No application cookie (fist connection).
Adding server transport parameters:
000102
@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
WARNING: chain validation failed, ignoring.
NGO| Certificate & signature 1.3 callback result: valid
KS | ks_client_13_sf hashed_log = c9cc1dbafdb43f0bb7f87d280637bc0273ed5ef8a5756e31931f2e9b46d22287
KS | application traffic secret[C]:   a89b37538786a6383b7062cb26ad41196b89de36dd2f191fbaa1ce1d33344d2f
KS | application traffic secret[S]:   d46adc66fc24b167824fdc7feb389fa6c70030b18059d8a963f09e3d12b5a325
KS | exporter master secret:          d8677afe29fa40597f61bdcacba7f4e33ee647e0be7e349abe6235e7deda7ec8
KS | application key[C]:              35a7dc0c6e7d09ce3714ef549faa4a9a3040dd39de8073918de952d58a55874b, IV=84e4ad1474cf1a3da6de501f
KS | application key[S]:              b840c9a89519d3f698626e90c9311243db9cf0b5eb1e909bbc3a71e0e220d179, IV=8b86406b08dbe71598c55f8b
AEP| LowProvider: COERCE(K=35a7dc0c6e7d09ce3714ef549faa4a9a3040dd39de8073918de952d58a55874b)
AEP| LowProvider: COERCE(K=b840c9a89519d3f698626e90c9311243db9cf0b5eb1e909bbc3a71e0e220d179)
HS | exporting a key
HS | Early data rejected
EPO| writer++ 0/0
HSL| emit Finished and hash
KS | ks_client_13_cf hashed_log = 991358bcda8678fb7d5753a08efd858b0294ab8948a47e03701d47501cc5efde
KS | resumption master secret:        77d06fb69ae27078cbb247235f9c36ec1ccbb57d01354a195ccf9d1ef0a5ccb3
EPO| reader++ 1/0
TLS| readOne ReadAgain
TLS| writeHandshake (encrypted)
TLS| HS.next_fragment ID13?
HS | next_fragment
TLS| HS.next_fragment returned a fragment; next_keys (for all data); complete
TLS| sendHandshake
TLS| send Handshake fragment with index ID13
TLS| Encrypting with key 1a96b46671098bc7bb55bd151edd0b2cad150a4e4439a27645849e3990754cd0
TLS| Sending fragment of length 53
REC| record headers: 1703030035
EPO| writer++ 1/1
TLS| read: WrittenHS, Open/Open, new writer: complete
client returns client_complete clen=58 slen=833
secret=d8677afe29fa40597f61bdcacba7f4e33ee647e0be7e349abe6235e7deda7ec8
(Finished) [  58] ---->

TLS| writeHandshake (encrypted)
TLS| HS.next_fragment ID13?
HS | next_fragment
TLS| HS.next_fragment returned nothing
TLS| sendHandshake
TLS| read: WrittenHS, Ctrl/Open, nothing
TLS| Read fragment at epoch index: 0 of length 53
TLS| StAE decrypt correct.
TLS| read Handshake fragment
HS | recv_fragment
HSL| parsed Finished
HSL| end of flight
HS | Process Client Finished
KS | ks_server_13_cf hashed_log = 991358bcda8678fb7d5753a08efd858b0294ab8948a47e03701d47501cc5efde
KS | resumption master secret:        77d06fb69ae27078cbb247235f9c36ec1ccbb57d01354a195ccf9d1ef0a5ccb3
AEP| LowProvider: COERCE(K=e2c122c03487717f88ce21ea76e5e0ffd034f9bcb6939791c0fd13bdb3a32465)
HS | Sending ticket: 5d5034605d5a63669fc8c20805f7a65b1cd51403c87eed1f8472f2eb16fd63f79fbdd8312885f10f43cc9de51c38cffc14c45040ddc1605303e1dc1265c60dcb444580f1bece3d7800c96548
HSL| emit NewSessionTicket13
EPO| reader++ 1/1
TLS| readOne Complete
server returns server_complete clen=58 slen=0
TLS| writeHandshake (encrypted)
TLS| HS.next_fragment ID13?
HS | next_fragment
TLS| HS.next_fragment returned a fragment
TLS| sendHandshake
TLS| send Handshake fragment with index ID13
TLS| Encrypting with key b840c9a89519d3f698626e90c9311243db9cf0b5eb1e909bbc3a71e0e220d179
TLS| Sending fragment of length 130
REC| record headers: 1703030082
TLS| writeHandshake (encrypted)
TLS| HS.next_fragment ID13?
HS | next_fragment
TLS| HS.next_fragment returned nothing
TLS| sendHandshake
TLS| read: WrittenHS, Open/Open, nothing
REC| WouldBlock
TLS| readOne ReadWouldBlock
server returns would_block clen=0 slen=135
<---- {Ticket}[ 135]
TLS| writeHandshake (encrypted)
TLS| HS.next_fragment ID13?
HS | next_fragment
TLS| HS.next_fragment returned nothing
TLS| sendHandshake
TLS| read: WrittenHS, Open/Open, nothing
TLS| Read fragment at epoch index: 1 of length 130
TLS| StAE decrypt correct.
TLS| read Handshake fragment
HS | recv_fragment
HSL| parsed NewSessionTicket13
HSL| end of flight
HS | Received ticket: 5d5034605d5a63669fc8c20805f7a65b1cd51403c87eed1f8472f2eb16fd63f79fbdd8312885f10f43cc9de51c38cffc14c45040ddc1605303e1dc1265c60dcb444580f1bece3d7800c96548
KS | ks_client_13_rms
KS | Recall RMS: 77d06fb69ae27078cbb247235f9c36ec1ccbb57d01354a195ccf9d1ef0a5ccb3
AEP| LowProvider: COERCE(K=3e5e563ecefce7bff29550907ee209c0e23cf8560237c53ff6c7ddfd12a5c024)

##### New session ticket received! #####
Host: localhost
Ticket:
5d5034605d5a63669fc8c20805f7a65b1cd51403c87eed1f8472f2eb16fd63f7
9fbdd8312885f10f43cc9de51c38cffc14c45040ddc1605303e1dc1265c60dcb
444580f1bece3d7800c96548
########################################
TLS| readOne ReadAgain
TLS| writeHandshake (encrypted)
TLS| HS.next_fragment ID13?
HS | next_fragment
TLS| HS.next_fragment returned nothing
TLS| sendHandshake
TLS| read: WrittenHS, Open/Open, nothing
REC| WouldBlock
TLS| readOne ReadWouldBlock
client returns clen=0 slen=135 status=would_block

TICKET-BASED RESUMPTION

server create
FFI| offering custom extension 001a
FFI| extension contents: ffff00050a0b0c0d0e
FFI| setting early data limit to ffffffff
FFI| Setting a new ticket callback.
FFI| Setting a new server negotiation callback.
FFI| Setting up certificate callbacks.
client create
FFI| offering custom extension 001a
FFI| extension contents: ffff00050a0b0c0d0e
FFI| setting early data limit to ffffffff
FFI| Setting a new ticket callback.
FFI| Setting a new server negotiation callback.
FFI| Setting up certificate callbacks.
TCK| Decrypting ticket bb8a5121dbc5d001b6451f72c925d5b7004fe8581e3f2eb19d9d4a7d5d699a880155310571e188ebe58d539e84d2ac72ede4928bdb1b39c147543098af265274683108139889b5804323bf9c
TCK| Parsing ticket 030413035b22e43e4c9ef2a7000000201f4a1fd4fb35cb9e6fc6b1efc934cae8930ae4aebdcfe089e9eccdd5692b4cb6
TLS| writeHandshake (plaintext)
TLS| HS.next_fragment PlaintextID?
HS | next_fragment
HS | offering ClientHello 1.3
KS | ks_client_init 1.3
CDH| Keygen (initiator) on X255519
NGO| Offering a PSK compatible with 0-RTT
NGO| offering client extensions [ 001a supported_versions key_share server_name alpn extended_master_secret signature_algorithms supported_groups psk_key_exchange_modes early_data pre_shared_key ]
NGO| offering cipher suites ; TLS_CHACHA20_POLY1305_SHA256; TLS_AES_128_GCM_SHA256
HSL| emit ClientHello
KS | Loaded pre-shared key 5d5034605d5a63669fc8c20805f7a65b1cd51403c87eed1f8472f2eb16fd63f79fbdd8312885f10f43cc9de51c38cffc14c45040ddc1605303e1dc1265c60dcb444580f1bece3d7800c96548: 1f4a1fd4fb35cb9e6fc6b1efc934cae8930ae4aebdcfe089e9eccdd5692b4cb6
KS | Early secret: b03a65b9d73549c822bb75a5f16f0978605a73ec8172c77d0fc68b5cf7981020
KS | Binder key[res binder]: b26066a27e31ec006003ca901d938a2b5777118096ca8cb922d8f37eddf36481
KS | Binder Finished key: dd2b04ccabd49b3b87907deb268f761e443160be604cd5321ad85572dfae6fc4
HSL| emit Binders
HS | setting up 0RTT
KS | ks_client_13_ch log=647f19131ee4d6a548ec67c510aecb19a1a9c6ddc0c80decb2b944e779e0706a
KS | Client early traffic secret:     658b0850f629cee0eca0a3a2391c2c65fd797e0c14dd9004c63e2363521d2c90
KS | Early exporter master secret:    6675da02705be39c13e632a7641dad78c459370b665549d8f43f86c760e1757b
KS | Client 0-RTT key:                75b74cf9726250ce3003a427535413cd043928327e2ea9fb6b21c185a1260b96, IV=e5b2f83a64fb7c7a2e8ca0a1
AEP| LowProvider: COERCE(K=75b74cf9726250ce3003a427535413cd043928327e2ea9fb6b21c185a1260b96)
HS | exporting a key
TLS| HS.next_fragment returned a fragment; next_keys (for all data)
TLS| sendHandshake
TLS| send Handshake fragment with index PlaintextID
TLS| Sending fragment of length 297
REC| record headers: 1603030129
EPO| writer++ -1/0
TLS| read: WrittenHS, Ctrl/Open, new writer: writable
client returns client_early_data clen=302 slen=0
early secret=6675da02705be39c13e632a7641dad78c459370b665549d8f43f86c760e1757b
ClientHello[ 302] ---->

TLS| writeHandshake (plaintext)
TLS| HS.next_fragment PlaintextID?
HS | next_fragment
TLS| HS.next_fragment returned nothing
TLS| sendHandshake
TLS| read: WrittenHS, Ctrl/Ctrl, nothing
TLS| Read fragment at epoch index: -1 of length 297
TLS| read Handshake fragment
HS | recv_fragment
HSL| parsed [ClientHello; Binders] -- end of flight 
HS | Processing ClientHello with 1 binder(s)
NGO| offered client extensions [ 001a supported_versions key_share server_name alpn extended_master_secret signature_algorithms supported_groups psk_key_exchange_modes early_data pre_shared_key ]
NGO| offered cipher suites ; TLS_CHACHA20_POLY1305_SHA256; TLS_AES_128_GCM_SHA256
NGO| offered versions 1.3
TCK| Decrypting ticket 5d5034605d5a63669fc8c20805f7a65b1cd51403c87eed1f8472f2eb16fd63f79fbdd8312885f10f43cc9de51c38cffc14c45040ddc1605303e1dc1265c60dcb444580f1bece3d7800c96548
TCK| Parsing ticket 030413035b22e43e4c9ef2a70000002077d06fb69ae27078cbb247235f9c36ec1ccbb57d01354a195ccf9d1ef0a5ccb3
NGO| Negotiated PSK_EDH key exchange
NGO| Negotiation callback to handle extra extensions and query for stateless retry.
NGO| Application data in cookie: none
@@@@ Nego callback for TLS 1.3 @@@@
Offered extensions:
003d001a0009ffff00050a0b0c0d0e0000000e000c0000096c6f63616c686f73
740010000800060568712d3130000d0006000408040403000a00040002001d
Transport parameters offered:
ffff00050a0b0c0d0e
No application cookie (fist connection).
Adding server transport parameters:
000102
@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
NGO| negotiated 1.3 TLS_CHACHA20_POLY1305_SHA256
HS | accepted TLS 1.3 psk #0
KS | ks_server_init
KS | Using negotiated PSK identity: 5d5034605d5a63669fc8c20805f7a65b1cd51403c87eed1f8472f2eb16fd63f79fbdd8312885f10f43cc9de51c38cffc14c45040ddc1605303e1dc1265c60dcb444580f1bece3d7800c96548
TCK| Decrypting ticket 5d5034605d5a63669fc8c20805f7a65b1cd51403c87eed1f8472f2eb16fd63f79fbdd8312885f10f43cc9de51c38cffc14c45040ddc1605303e1dc1265c60dcb444580f1bece3d7800c96548
TCK| Parsing ticket 030413035b22e43e4c9ef2a70000002077d06fb69ae27078cbb247235f9c36ec1ccbb57d01354a195ccf9d1ef0a5ccb3
KS | Ticket RMS: 77d06fb69ae27078cbb247235f9c36ec1ccbb57d01354a195ccf9d1ef0a5ccb3
KS | Pre-shared key: 1f4a1fd4fb35cb9e6fc6b1efc934cae8930ae4aebdcfe089e9eccdd5692b4cb6
KS | binder key:                      b26066a27e31ec006003ca901d938a2b5777118096ca8cb922d8f37eddf36481
KS | binder Finished key:             dd2b04ccabd49b3b87907deb268f761e443160be604cd5321ad85572dfae6fc4
KS | Computed early secret:           b03a65b9d73549c822bb75a5f16f0978605a73ec8172c77d0fc68b5cf7981020
KS | Handshake salt:                  69a3b9bf26e85d4e4b3a6826f5a9a8c6e12b50da82d1f6e49580cd367a520f60
CDH| Keygen (responder) on X255519
CDH| DH initiator on X255519
KS | DH shared secret: 01f22ff0099b7ce431f5bb8592f63517cfe3d673cd5e18c31da238fe74f2733c
KS | Handshake secret:                c56ae512b3cb0e40420e806e6bf9fc5eeb61a0054c0e4b27631980c738a9dc16
NGO| processing client extensions [ 001a supported_versions key_share server_name alpn extended_master_secret signature_algorithms supported_groups psk_key_exchange_modes early_data pre_shared_key ]
NGO| including server extensions (SH + EE) [ supported_versions key_share alpn supported_groups early_data pre_shared_key ]
NGO| extra extensions from application callback: 001a 
HSL| emit ServerHello and hash
KS | ks_server_13_0rtt_key
KS | Client early traffic secret:     658b0850f629cee0eca0a3a2391c2c65fd797e0c14dd9004c63e2363521d2c90
KS | Early exporter master secret:    6675da02705be39c13e632a7641dad78c459370b665549d8f43f86c760e1757b
KS | Client 0-RTT key:                75b74cf9726250ce3003a427535413cd043928327e2ea9fb6b21c185a1260b96, IV=e5b2f83a64fb7c7a2e8ca0a1
AEP| LowProvider: COERCE(K=75b74cf9726250ce3003a427535413cd043928327e2ea9fb6b21c185a1260b96)
HS | exporting a key
HS | derive handshake keys
KS | ks_server_13_sh, hashed log = a994c8e7b4b83e77fc85435282756d451709550bb62451306f80d6a23334b8a5
KS | handshake traffic secret[C]:     c82e48660c50a50531bd6a487a5a38c3be800c9af4bf7b34ad0b4309c00a09c8
KS | handshake traffic secret[S]:     bb6f28a34a8cd65231953b1d76f9d8ab3aeaf1c3a22455b45d01c87f2dcec47f
KS | handshake key[C]:                4ee04f81057a24480b29eb1b5e144945da56a8355fd4a6de30c2004ec437ce3e, IV=ece8653a945c58ae8a359132
KS | handshake key[S]: 4844c3d3950ed9a2cfdecc831a420a3be827c70d89a4b57e02e92aa350e8ed07, IV=b0f8b2c54d45d94afbdbb3b1
AEP| LowProvider: COERCE(K=4844c3d3950ed9a2cfdecc831a420a3be827c70d89a4b57e02e92aa350e8ed07)
AEP| LowProvider: COERCE(K=4ee04f81057a24480b29eb1b5e144945da56a8355fd4a6de30c2004ec437ce3e)
KS | finished key[C]:                 3bc9d9c073f6c5d37a901870c122f29b7b5bd7bc3936bf502ae1012d8bfc2c46
KS | finished key[S]:                 12e458f6e390a82dd2cb636f9e483a5c4de6e7c492fd776f00a014743191d3c7
KS | Application salt:                3645130ead832d3b19bc4e0532049fe1b8fdfeaf3d1d26096b6404c78ec77d35
KS | Application secret:              e20b669cb80de511c07b645d2acf4400885384f52dc9cc09ccf064b8b4a02a8d
TLS| readOne ReadAgain
TLS| writeHandshake (plaintext)
TLS| HS.next_fragment PlaintextID?
HS | next_fragment
TLS| HS.next_fragment returned a fragment; next_keys (for handshake only skipping 0RTT
TLS| sendHandshake
TLS| send Handshake fragment with index PlaintextID
TLS| Sending fragment of length 96
REC| record headers: 1603030060
EPO| writer++ -1/0
EPO| writer++ -1/1
TLS| writeHandshake (encrypted)
TLS| HS.next_fragment ID13?
HS | next_fragment
HS | prepare Server Finished
HSL| emit EncryptedExtensions and hash
HSL| emit Finished and hash
KS | ks_server_13_sf hashed_log = c268974350f6678b899c0b8409746a426a0a48fb3419ba80251f883aadddaec2
KS | application traffic secret[C]:   ea4b047734576d193c65c6b32b2f93a5f6ad4fa7145c01f048cb949be6eb9b8e
KS | application traffic secret[S]:   25ee9d6f56e34fa5023a4288403540ef1ebdbc88c893cb147d57c67857cd42e7
KS | exporter master secret:          e72cb86f70fb7871589a459f6ccf188a7cf97f0246fe5123846d82ef65e701cf
KS | application key[C]:              41566d05856578998ae92e679e3b5051defa6712f3017c31d27d1f58e72efbbb, IV=6cbeeb04749544f020af2177
KS | application key[S]:              b57f433306a16b41bea8fd35b3405c87fbebdd16b96088318a3f8dc63cc7e2d9, IV=02488ae5a0be4eeb70300fa8
AEP| LowProvider: COERCE(K=b57f433306a16b41bea8fd35b3405c87fbebdd16b96088318a3f8dc63cc7e2d9)
AEP| LowProvider: COERCE(K=41566d05856578998ae92e679e3b5051defa6712f3017c31d27d1f58e72efbbb)
HS | exporting a key
EPO| reader++ 0/1
TLS| HS.next_fragment returned a fragment; next_keys (for all data)
TLS| sendHandshake
TLS| send Handshake fragment with index ID13
TLS| Encrypting with key 4844c3d3950ed9a2cfdecc831a420a3be827c70d89a4b57e02e92aa350e8ed07
TLS| Sending fragment of length 90
REC| record headers: 170303005a
EPO| writer++ 0/2
TLS| read: WrittenHS, Ctrl/Open, new writer: writable
server returns server_accept_early_data clen=302 slen=196
early secret=6675da02705be39c13e632a7641dad78c459370b665549d8f43f86c760e1757b
secret=e72cb86f70fb7871589a459f6ccf188a7cf97f0246fe5123846d82ef65e701cf
<---- ServerHello;(EncryptedExtensions; Certificate; CertVerify; Finished)[ 196]

TLS| writeHandshake (encrypted)
TLS| HS.next_fragment ID13?
HS | next_fragment
TLS| HS.next_fragment returned nothing
TLS| sendHandshake
TLS| read: WrittenHS, Ctrl/Open, nothing
TLS| Read fragment at epoch index: -1 of length 96
TLS| read Handshake fragment
HS | recv_fragment
HSL| parsed ServerHello
HSL| end of flight
HS | client_ServerHello
NGO| processing server extensions [ supported_versions key_share pre_shared_key ]
NGO| negotiated 1.3 TLS_CHACHA20_POLY1305_SHA256
HS | Running TLS 1.3
KS | ks_client_13_sh hashed_log = a994c8e7b4b83e77fc85435282756d451709550bb62451306f80d6a23334b8a5
KS | recallPSK early secret:          b03a65b9d73549c822bb75a5f16f0978605a73ec8172c77d0fc68b5cf7981020
KS | handshake salt:                  69a3b9bf26e85d4e4b3a6826f5a9a8c6e12b50da82d1f6e49580cd367a520f60
CDH| DH initiator on X255519
KS | DH shared secret: 01f22ff0099b7ce431f5bb8592f63517cfe3d673cd5e18c31da238fe74f2733c
KS | handshake secret:                c56ae512b3cb0e40420e806e6bf9fc5eeb61a0054c0e4b27631980c738a9dc16
KS | handshake traffic secret[C]:     c82e48660c50a50531bd6a487a5a38c3be800c9af4bf7b34ad0b4309c00a09c8
KS | handshake traffic secret[S]:     bb6f28a34a8cd65231953b1d76f9d8ab3aeaf1c3a22455b45d01c87f2dcec47f
KS | handshake key[C]:                4ee04f81057a24480b29eb1b5e144945da56a8355fd4a6de30c2004ec437ce3e, IV=ece8653a945c58ae8a359132
KS | handshake key[S]:                4844c3d3950ed9a2cfdecc831a420a3be827c70d89a4b57e02e92aa350e8ed07, IV=b0f8b2c54d45d94afbdbb3b1
KS | finished key[C]: 3bc9d9c073f6c5d37a901870c122f29b7b5bd7bc3936bf502ae1012d8bfc2c46
KS | finished key[S]: 12e458f6e390a82dd2cb636f9e483a5c4de6e7c492fd776f00a014743191d3c7
KS | application salt:                3645130ead832d3b19bc4e0532049fe1b8fdfeaf3d1d26096b6404c78ec77d35
KS | application secret:              e20b669cb80de511c07b645d2acf4400885384f52dc9cc09ccf064b8b4a02a8d
AEP| LowProvider: COERCE(K=4ee04f81057a24480b29eb1b5e144945da56a8355fd4a6de30c2004ec437ce3e)
AEP| LowProvider: COERCE(K=4844c3d3950ed9a2cfdecc831a420a3be827c70d89a4b57e02e92aa350e8ed07)
HS | 0RTT potentially accepted (wait for EE to confirm)
EPO| reader++ 0/0
EPO| reader++ 1/0
TLS| readOne ReadAgain
TLS| writeHandshake (encrypted)
TLS| HS.next_fragment ID13?
HS | next_fragment
TLS| HS.next_fragment returned nothing
TLS| sendHandshake
TLS| read: WrittenHS, Ctrl/Open, nothing
TLS| Read fragment at epoch index: 1 of length 90
TLS| StAE decrypt correct.
TLS| read Handshake fragment
HS | recv_fragment
HSL| parsed EncryptedExtensions
HSL| parsed Finished
HSL| end of flight
NGO| Nego.clientComplete_13
NGO| EE: alpn supported_groups early_data 001a 
NGO| Negotiation callback to process application extensions.
@@@@ Nego callback for TLS 1.3 @@@@
Offered extensions:
001b0010000800060568712d3130000a00040002001d001a0003000102
Transport parameters offered:
000102
No application cookie (fist connection).
Adding server transport parameters:
000102
@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
NGO| Certificate & signature 1.3 callback result: valid
KS | ks_client_13_sf hashed_log = c268974350f6678b899c0b8409746a426a0a48fb3419ba80251f883aadddaec2
KS | application traffic secret[C]:   ea4b047734576d193c65c6b32b2f93a5f6ad4fa7145c01f048cb949be6eb9b8e
KS | application traffic secret[S]:   25ee9d6f56e34fa5023a4288403540ef1ebdbc88c893cb147d57c67857cd42e7
KS | exporter master secret:          e72cb86f70fb7871589a459f6ccf188a7cf97f0246fe5123846d82ef65e701cf
KS | application key[C]:              41566d05856578998ae92e679e3b5051defa6712f3017c31d27d1f58e72efbbb, IV=6cbeeb04749544f020af2177
KS | application key[S]:              b57f433306a16b41bea8fd35b3405c87fbebdd16b96088318a3f8dc63cc7e2d9, IV=02488ae5a0be4eeb70300fa8
AEP| LowProvider: COERCE(K=41566d05856578998ae92e679e3b5051defa6712f3017c31d27d1f58e72efbbb)
AEP| LowProvider: COERCE(K=b57f433306a16b41bea8fd35b3405c87fbebdd16b96088318a3f8dc63cc7e2d9)
HS | exporting a key
HS | Early data accepted; emitting EOED.
HSL| emit EndOfEarlyData and hash
TLS| readOne ReadAgain
TLS| writeHandshake (encrypted)
TLS| HS.next_fragment ID13?
HS | next_fragment
TLS| HS.next_fragment returned a fragment; next_keys (for handshake only
TLS| sendHandshake
TLS| send Handshake fragment with index ID13
TLS| Encrypting with key 75b74cf9726250ce3003a427535413cd043928327e2ea9fb6b21c185a1260b96
TLS| Sending fragment of length 21
REC| record headers: 1703030015
EPO| writer++ 1/1
TLS| writeHandshake (encrypted)
TLS| HS.next_fragment ID13?
HS | next_fragment
HSL| emit Finished and hash
KS | ks_client_13_cf hashed_log = a540c591a74aff91e787a2a58b0249cb349f9d4cd031c160d5736a0bc735d932
KS | resumption master secret:        b279eaccf972552591204985254399c0c02de8d0e2903c1467a078c510646f49
EPO| reader++ 2/1
TLS| HS.next_fragment returned a fragment; next_keys (for all data); complete
TLS| sendHandshake
TLS| send Handshake fragment with index ID13
TLS| Encrypting with key 4ee04f81057a24480b29eb1b5e144945da56a8355fd4a6de30c2004ec437ce3e
TLS| Sending fragment of length 53
REC| record headers: 1703030035
EPO| writer++ 2/2
TLS| read: WrittenHS, Open/Open, new writer: complete
client returns client_complete_early_data clen=84 slen=196
secret=e72cb86f70fb7871589a459f6ccf188a7cf97f0246fe5123846d82ef65e701cf
(Finished) [  84] ---->

TLS| writeHandshake (encrypted)
TLS| HS.next_fragment ID13?
HS | next_fragment
TLS| HS.next_fragment returned nothing
TLS| sendHandshake
TLS| read: WrittenHS, Ctrl/Open, nothing
TLS| Read fragment at epoch index: 0 of length 21
TLS| StAE decrypt correct.
TLS| read Handshake fragment
HS | recv_fragment
HSL| parsed EndOfEarlyData
HSL| end of flight
HS | Process EOED (increment reader to HS key)
EPO| reader++ 1/2
TLS| readOne ReadAgain
TLS| writeHandshake (encrypted)
TLS| HS.next_fragment ID13?
HS | next_fragment
TLS| HS.next_fragment returned nothing
TLS| sendHandshake
TLS| read: WrittenHS, Ctrl/Open, nothing
TLS| Read fragment at epoch index: 1 of length 53
TLS| StAE decrypt correct.
TLS| read Handshake fragment
HS | recv_fragment
HSL| parsed Finished
HSL| end of flight
HS | Process Client Finished
KS | ks_server_13_cf hashed_log = a540c591a74aff91e787a2a58b0249cb349f9d4cd031c160d5736a0bc735d932
KS | resumption master secret:        b279eaccf972552591204985254399c0c02de8d0e2903c1467a078c510646f49
HS | Sending ticket: 4f0697f4ba338d269c8fbfe8fe77ecddcd2ca272fa0e3e1a752bfdcade824163c95f11dcb4e85109573f89e29c9d72ea929bb6793eb75dfd12e2fc688c369f3b62f88c03875775adc830b5bc
HSL| emit NewSessionTicket13
EPO| reader++ 2/2
TLS| readOne Complete
server returns clen=84 slen=0 status=server_complete
TLS| writeHandshake (encrypted)
TLS| HS.next_fragment ID13?
HS | next_fragment
TLS| HS.next_fragment returned a fragment
TLS| sendHandshake
TLS| send Handshake fragment with index ID13
TLS| Encrypting with key b57f433306a16b41bea8fd35b3405c87fbebdd16b96088318a3f8dc63cc7e2d9
TLS| Sending fragment of length 130
REC| record headers: 1703030082
TLS| writeHandshake (encrypted)
TLS| HS.next_fragment ID13?
HS | next_fragment
TLS| HS.next_fragment returned nothing
TLS| sendHandshake
TLS| read: WrittenHS, Open/Open, nothing
REC| WouldBlock
TLS| readOne ReadWouldBlock
server returns would_block clen=0 slen=135
<---- {Ticket}[ 135]
TLS| writeHandshake (encrypted)
TLS| HS.next_fragment ID13?
HS | next_fragment
TLS| HS.next_fragment returned nothing
TLS| sendHandshake
TLS| read: WrittenHS, Open/Open, nothing
TLS| Read fragment at epoch index: 2 of length 130
TLS| StAE decrypt correct.
TLS| read Handshake fragment
HS | recv_fragment
HSL| parsed NewSessionTicket13
HSL| end of flight
HS | Received ticket: 4f0697f4ba338d269c8fbfe8fe77ecddcd2ca272fa0e3e1a752bfdcade824163c95f11dcb4e85109573f89e29c9d72ea929bb6793eb75dfd12e2fc688c369f3b62f88c03875775adc830b5bc
KS | ks_client_13_rms
KS | Recall RMS: b279eaccf972552591204985254399c0c02de8d0e2903c1467a078c510646f49

##### New session ticket received! #####
Host: localhost
Ticket:
4f0697f4ba338d269c8fbfe8fe77ecddcd2ca272fa0e3e1a752bfdcade824163
c95f11dcb4e85109573f89e29c9d72ea929bb6793eb75dfd12e2fc688c369f3b
62f88c03875775adc830b5bc
########################################
TLS| readOne ReadAgain
TLS| writeHandshake (encrypted)
TLS| HS.next_fragment ID13?
HS | next_fragment
TLS| HS.next_fragment returned nothing
TLS| sendHandshake
TLS| read: WrittenHS, Open/Open, nothing
REC| WouldBlock
TLS| readOne ReadWouldBlock
client returns clen=0 slen=135 status=would_block
Ok
./quic.exe hrr

STATELESS RETRY TEST

server create
FFI| offering custom extension 001a
FFI| extension contents: ffff00050a0b0c0d0e
FFI| setting early data limit to ffffffff
FFI| Setting a new ticket callback.
FFI| Setting a new server negotiation callback.
FFI| Setting up certificate callbacks.
client create
FFI| offering custom extension 001a
FFI| extension contents: ffff00050a0b0c0d0e
FFI| setting early data limit to ffffffff
FFI| Setting a new ticket callback.
FFI| Setting a new server negotiation callback.
FFI| Setting up certificate callbacks.
TLS| writeHandshake (plaintext)
TLS| HS.next_fragment PlaintextID?
HS | next_fragment
HS | offering ClientHello 1.3
KS | ks_client_init 1.3
CDH| Keygen (initiator) on X255519
NGO| No PSK or 0-RTT disabled
NGO| offering client extensions [ 001a supported_versions key_share server_name alpn extended_master_secret signature_algorithms supported_groups psk_key_exchange_modes ]
NGO| offering cipher suites ; TLS_CHACHA20_POLY1305_SHA256; TLS_AES_128_GCM_SHA256
HSL| emit ClientHello
TLS| HS.next_fragment returned a fragment
TLS| sendHandshake
TLS| send Handshake fragment with index PlaintextID
TLS| Sending fragment of length 170
REC| record headers: 16030300aa
TLS| writeHandshake (plaintext)
TLS| HS.next_fragment PlaintextID?
HS | next_fragment
TLS| HS.next_fragment returned nothing
TLS| sendHandshake
TLS| read: WrittenHS, Ctrl/Ctrl, nothing
REC| WouldBlock
TLS| readOne ReadWouldBlock
client returns would_block clen=175 slen=0
ClientHello[ 175] ---->

~~~~~~~~~ Client Hello Summary ~~~~~~~~~~~
~ SNI = localhost
~ ALPN = 00060568712d3130
~ Cookie = NULL
~ Extensions = 0079001a0009ffff00050a0b0c0d0e002b0003027f1c003300260024001d0020
59603bcfea9408e17c13079b40eb75c6397a417a797d338065525d17e826e83a
0000000e000c0000096c6f63616c686f73740010000800060568712d31300017
0000000d0006000408040403000a00040002001d002d0003020001
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
TLS| writeHandshake (plaintext)
TLS| HS.next_fragment PlaintextID?
HS | next_fragment
TLS| HS.next_fragment returned nothing
TLS| sendHandshake
TLS| read: WrittenHS, Ctrl/Ctrl, nothing
TLS| Read fragment at epoch index: -1 of length 170
TLS| read Handshake fragment
HS | recv_fragment
HSL| parsed [ClientHello] -- end of flight 
HS | Processing ClientHello
NGO| offered client extensions [ 001a supported_versions key_share server_name alpn extended_master_secret signature_algorithms supported_groups psk_key_exchange_modes ]
NGO| offered cipher suites ; TLS_CHACHA20_POLY1305_SHA256; TLS_AES_128_GCM_SHA256
NGO| offered versions 1.3
NGO| Negotiated Pure EDH key exchange
NGO| Negotiated ECDSA_SECP256R1_SHA256
NGO| Negotiation callback to handle extra extensions and query for stateless retry.
NGO| Application data in cookie: none
@@@@ Nego callback for TLS 1.3 @@@@
Offered extensions:
003d001a0009ffff00050a0b0c0d0e0000000e000c0000096c6f63616c686f73
740010000800060568712d3130000d0006000408040403000a00040002001d
Transport parameters offered:
ffff00050a0b0c0d0e
No application cookie (fist connection).
Adding server transport parameters:
000102
@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
AEP| LowProvider: COERCE(K=11c4323f47036e4fbb976277643b26d4252bc9809b64a5eb71c611b758aa4ca4)
TCK| Encrypting cookie: 0000320200002e0303cf21ad74e59a6111be1d8c021e65b891c2a211167abb8c5e079e09e2c8a8339c001303000006002b00027f1c20cc802072e2076c6f5c3554a5cf66fbdfb9873dc911af23483ed71d5ff33d2e00000b48656c6c6f20576f726c64
TCK| Encrypted cookie:  525f5ffeb3a755154909a9103b6e6f9f669945a5cb955b6cd278b2e5990332d33a70a5078789ea69af603b16e3e78767843b4d427c01bbd2d92525e82f9b881509b62265dba17a576d4c4119262c75e70b0d5a186b3db167baab9fe4ed91f9cf823e2594e4706d4c3117b42b0c9531a7ecf3964b1d9d36e09defc7c8eab854
HSL| emit HelloRetryRequest
TLS| readOne ReadAgain
TLS| writeHandshake (plaintext)
TLS| HS.next_fragment PlaintextID?
HS | next_fragment
TLS| HS.next_fragment returned a fragment
TLS| sendHandshake
TLS| send Handshake fragment with index PlaintextID
TLS| Sending fragment of length 183
REC| record headers: 16030300b7
TLS| writeHandshake (plaintext)
TLS| HS.next_fragment PlaintextID?
HS | next_fragment
TLS| HS.next_fragment returned nothing
TLS| sendHandshake
TLS| read: WrittenHS, Ctrl/Ctrl, nothing
REC| WouldBlock
TLS| readOne ReadWouldBlock
server returns server_stateless_retry clen=175 slen=188
<---- HRR[ 188]

server re-create
FFI| offering custom extension 001a
FFI| extension contents: ffff00050a0b0c0d0e
FFI| setting early data limit to ffffffff
FFI| Setting a new ticket callback.
FFI| Setting a new server negotiation callback.
FFI| Setting up certificate callbacks.
TLS| writeHandshake (plaintext)
TLS| HS.next_fragment PlaintextID?
HS | next_fragment
TLS| HS.next_fragment returned nothing
TLS| sendHandshake
TLS| read: WrittenHS, Ctrl/Ctrl, nothing
TLS| Read fragment at epoch index: -1 of length 183
TLS| read Handshake fragment
HS | recv_fragment
HSL| parsed HelloRetryRequest
HSL| end of flight
HSL| Replacing CH1 in transcript with fe000020cc802072e2076c6f5c3554a5cf66fbdfb9873dc911af23483ed71d5ff33d2e00
HSL| HRR bytes: 020000b30303cf21ad74e59a6111be1d8c021e65b891c2a211167abb8c5e079e09e2c8a8339c00130300008b002c0081007f525f5ffeb3a755154909a9103b6e6f9f669945a5cb955b6cd278b2e5990332d33a70a5078789ea69af603b16e3e78767843b4d427c01bbd2d92525e82f9b881509b62265dba17a576d4c4119262c75e70b0d5a186b3db167baab9fe4ed91f9cf823e2594e4706d4c3117b42b0c9531a7ecf3964b1d9d36e09defc7c8eab854002b00027f1c
HS | client_HelloRetryRequest
HS | Server did not specify a group in HRR, re-using the previous choice
NGO| Got HRR, extensions: [cookie supported_versions ]
HSL| emit ClientHello
TLS| readOne ReadAgain
TLS| writeHandshake (plaintext)
TLS| HS.next_fragment PlaintextID?
HS | next_fragment
TLS| HS.next_fragment returned a fragment
TLS| sendHandshake
TLS| send Handshake fragment with index PlaintextID
TLS| Sending fragment of length 303
REC| record headers: 160303012f
TLS| writeHandshake (plaintext)
TLS| HS.next_fragment PlaintextID?
HS | next_fragment
TLS| HS.next_fragment returned nothing
TLS| sendHandshake
TLS| read: WrittenHS, Ctrl/Ctrl, nothing
REC| WouldBlock
TLS| readOne ReadWouldBlock
client returns would_block clen=308 slen=188
ClientHello2[ 308] ---->

TCK| Decrypting cookie 525f5ffeb3a755154909a9103b6e6f9f669945a5cb955b6cd278b2e5990332d33a70a5078789ea69af603b16e3e78767843b4d427c01bbd2d92525e82f9b881509b62265dba17a576d4c4119262c75e70b0d5a186b3db167baab9fe4ed91f9cf823e2594e4706d4c3117b42b0c9531a7ecf3964b1d9d36e09defc7c8eab854
TCK| Plain cookie: 0000320200002e0303cf21ad74e59a6111be1d8c021e65b891c2a211167abb8c5e079e09e2c8a8339c001303000006002b00027f1c20cc802072e2076c6f5c3554a5cf66fbdfb9873dc911af23483ed71d5ff33d2e00000b48656c6c6f20576f726c64
~~~~~~~~~ Client Hello Summary ~~~~~~~~~~~
~ SNI = localhost
~ ALPN = 00060568712d3130
~ Cookie = 48656c6c6f20576f726c64
~ Extensions = 00fe002c0081007f525f5ffeb3a755154909a9103b6e6f9f669945a5cb955b6c
d278b2e5990332d33a70a5078789ea69af603b16e3e78767843b4d427c01bbd2
d92525e82f9b881509b62265dba17a576d4c4119262c75e70b0d5a186b3db167
baab9fe4ed91f9cf823e2594e4706d4c3117b42b0c9531a7ecf3964b1d9d36e0
9defc7c8eab854001a0009ffff00050a0b0c0d0e002b0003027f1c0033002600
24001d002059603bcfea9408e17c13079b40eb75c6397a417a797d338065525d
17e826e83a0000000e000c0000096c6f63616c686f7374001000080006056871
2d313000170000000d0006000408040403000a00040002001d002d0003020001
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
TLS| writeHandshake (plaintext)
TLS| HS.next_fragment PlaintextID?
HS | next_fragment
TLS| HS.next_fragment returned nothing
TLS| sendHandshake
TLS| read: WrittenHS, Ctrl/Ctrl, nothing
TLS| Read fragment at epoch index: -1 of length 303
TLS| read Handshake fragment
HS | recv_fragment
HSL| parsed [ClientHello] -- end of flight 
HS | Processing ClientHello
NGO| offered client extensions [ cookie 001a supported_versions key_share server_name alpn extended_master_secret signature_algorithms supported_groups psk_key_exchange_modes ]
NGO| offered cipher suites ; TLS_CHACHA20_POLY1305_SHA256; TLS_AES_128_GCM_SHA256
NGO| offered versions 1.3
NGO| Negotiated Pure EDH key exchange
NGO| Negotiated ECDSA_SECP256R1_SHA256
TCK| Decrypting cookie 525f5ffeb3a755154909a9103b6e6f9f669945a5cb955b6cd278b2e5990332d33a70a5078789ea69af603b16e3e78767843b4d427c01bbd2d92525e82f9b881509b62265dba17a576d4c4119262c75e70b0d5a186b3db167baab9fe4ed91f9cf823e2594e4706d4c3117b42b0c9531a7ecf3964b1d9d36e09defc7c8eab854
TCK| Plain cookie: 0000320200002e0303cf21ad74e59a6111be1d8c021e65b891c2a211167abb8c5e079e09e2c8a8339c001303000006002b00027f1c20cc802072e2076c6f5c3554a5cf66fbdfb9873dc911af23483ed71d5ff33d2e00000b48656c6c6f20576f726c64
NGO| Loaded stateless retry cookie 525f5ffeb3a755154909a9103b6e6f9f669945a5cb955b6cd278b2e5990332d33a70a5078789ea69af603b16e3e78767843b4d427c01bbd2d92525e82f9b881509b62265dba17a576d4c4119262c75e70b0d5a186b3db167baab9fe4ed91f9cf823e2594e4706d4c3117b42b0c9531a7ecf3964b1d9d36e09defc7c8eab854
NGO| Overwriting the transcript digest with CH1 hash cc802072e2076c6f5c3554a5cf66fbdfb9873dc911af23483ed71d5ff33d2e00
HSL| Installing prefix to transcript: fe000020cc802072e2076c6f5c3554a5cf66fbdfb9873dc911af23483ed71d5ff33d2e00
HSL| HRR bytes: 020000b30303cf21ad74e59a6111be1d8c021e65b891c2a211167abb8c5e079e09e2c8a8339c00130300008b002c0081007f525f5ffeb3a755154909a9103b6e6f9f669945a5cb955b6cd278b2e5990332d33a70a5078789ea69af603b16e3e78767843b4d427c01bbd2d92525e82f9b881509b62265dba17a576d4c4119262c75e70b0d5a186b3db167baab9fe4ed91f9cf823e2594e4706d4c3117b42b0c9531a7ecf3964b1d9d36e09defc7c8eab854002b00027f1c
NGO| Negotiation callback to handle extra extensions and query for stateless retry.
NGO| Application data in cookie: 48656c6c6f20576f726c64
@@@@ Nego callback for TLS 1.3 @@@@
Offered extensions:
003d001a0009ffff00050a0b0c0d0e0000000e000c0000096c6f63616c686f73
740010000800060568712d3130000d0006000408040403000a00040002001d
Transport parameters offered:
ffff00050a0b0c0d0e
Stateless cookie found, application contents:
48656c6c6f20576f726c64
Adding server transport parameters:
000102
@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
NGO| negotiated 1.3 TLS_CHACHA20_POLY1305_SHA256
KS | ks_server_init
KS | No PSK selected.
KS | Computed early secret:           33ad0a1c607ec03b09e6cd9893680ce210adf300aa1f2660e1b22e10f170f92a
KS | Handshake salt:                  6f2615a108c702c5678f54fc9dbab69716c076189c48250cebeac3576c3611ba
CDH| Keygen (responder) on X255519
CDH| DH initiator on X255519
KS | DH shared secret: 0b85ffd144886acb0ece7b2861704d173e64b170fa0f0be9a796a1147f1d5c7b
KS | Handshake secret:                e13dcff9745bb1f63014efdccd5f08bf50a00bc19ade13c1511f645eb56ee74e
NGO| processing client extensions [ cookie 001a supported_versions key_share server_name alpn extended_master_secret signature_algorithms supported_groups psk_key_exchange_modes ]
NGO| including server extensions (SH + EE) [ supported_versions key_share alpn supported_groups ]
NGO| extra extensions from application callback: 001a 
HSL| emit ServerHello and hash
HS | derive handshake keys
KS | ks_server_13_sh, hashed log = 736f34dce7668bda6fb1077a7b513fe3743e31d5af8d24f91d72c328cc87fa52
KS | handshake traffic secret[C]:     f48e22f5283f10c6a82b4e1cc36318cb6b167dcb625c7fb27ab9800d0a906d1c
KS | handshake traffic secret[S]:     fd7b74d7f0adaa495ff004885ad087a3e41fd00d5bc62b9680e781efc4a69d45
KS | handshake key[C]:                94e2aa96a54dc5be3c3f732f7e6639bfdb6c4095c4e5be98aa3bfe1459eabc1f, IV=2e72dc8017d53acf55e54af7
KS | handshake key[S]: 60d854ec79d31b3992deaaa151c43ad769f25384c57b54010acec7b020e3711e, IV=3cef4a0084b82bec609e5c5e
AEP| LowProvider: COERCE(K=60d854ec79d31b3992deaaa151c43ad769f25384c57b54010acec7b020e3711e)
AEP| LowProvider: COERCE(K=94e2aa96a54dc5be3c3f732f7e6639bfdb6c4095c4e5be98aa3bfe1459eabc1f)
KS | finished key[C]:                 22de3f605cb7b4bfeb9cc6c4fc09dfe97ca2645cca0a320192637cf10565bb19
KS | finished key[S]:                 29df2f8fed7ec8b0811ff28da398f2d521aed604501900468d5c523cf4839ae8
KS | Application salt:                94f1f409625af444a093443cc3f3f7159550e623a9599c8ba741ff72c1960d95
KS | Application secret:              4bbfbb0d7a383f8c2412e611c4b5c7e52e1f29013d379f901dd1d670319c1e26
TLS| readOne ReadAgain
TLS| writeHandshake (plaintext)
TLS| HS.next_fragment PlaintextID?
HS | next_fragment
TLS| HS.next_fragment returned a fragment; next_keys (for handshake only
TLS| sendHandshake
TLS| send Handshake fragment with index PlaintextID
TLS| Sending fragment of length 90
REC| record headers: 160303005a
EPO| writer++ -1/0
TLS| writeHandshake (encrypted)
TLS| HS.next_fragment ID13?
HS | next_fragment
HS | prepare Server Finished
HSL| emit EncryptedExtensions
HSL| emit Certificate13 and hash
======== TO BE SIGNED <0403>: (130 octets) ========
2020202020202020202020202020202020202020202020202020202020202020
2020202020202020202020202020202020202020202020202020202020202020
544c5320312e332c207365727665722043657274696669636174655665726966
7900ca19f85de9c91d30a0a9f068d411194ddab33832c11e91ccc5651d3d796f
3760
===================================================
HSL| emit CertificateVerify and hash
HSL| emit Finished and hash
KS | ks_server_13_sf hashed_log = 896619eaaa85278687428760e0826d017ea7e84e2489f0be4bc3513ce6637483
KS | application traffic secret[C]:   405cedf28e390da88ff99e930c9e9c1751f33af4ba31646269fad43bd1cf1290
KS | application traffic secret[S]:   97e95cf238f9f8daa55544292d5f2d0313e045519c59cf1f682247103ea989d2
KS | exporter master secret:          9bd5d35212175fd78d2bf3decde21739b47aca000accccc07cdce53dee20af63
KS | application key[C]:              38b148c0300e3e01e7d9247b0cfac5cc1e19984e0e5f5bb3fe0eebd5445d3ffc, IV=ac3bf775d4e949fe9cf0800b
KS | application key[S]:              3b9c5f699e8723dfb35cf8012f2e5878ca08be5fba2ba56f86f0e431ec61802b, IV=77c3d8f6ccf47ea09791d9bb
AEP| LowProvider: COERCE(K=3b9c5f699e8723dfb35cf8012f2e5878ca08be5fba2ba56f86f0e431ec61802b)
AEP| LowProvider: COERCE(K=38b148c0300e3e01e7d9247b0cfac5cc1e19984e0e5f5bb3fe0eebd5445d3ffc)
HS | exporting a key
EPO| reader++ 0/0
TLS| HS.next_fragment returned a fragment; next_keys (for all data)
TLS| sendHandshake
TLS| send Handshake fragment with index ID13
TLS| Encrypting with key 60d854ec79d31b3992deaaa151c43ad769f25384c57b54010acec7b020e3711e
TLS| Sending fragment of length 734
REC| record headers: 17030302de
EPO| writer++ 0/1
TLS| read: WrittenHS, Ctrl/Open, new writer: writable
server returns server_accept clen=308 slen=834
secret=9bd5d35212175fd78d2bf3decde21739b47aca000accccc07cdce53dee20af63
<---- ServerHello;(EncryptedExtensions; Certificate; CertVerify; Finished)[ 834]

TLS| writeHandshake (plaintext)
TLS| HS.next_fragment PlaintextID?
HS | next_fragment
TLS| HS.next_fragment returned nothing
TLS| sendHandshake
TLS| read: WrittenHS, Ctrl/Ctrl, nothing
TLS| Read fragment at epoch index: -1 of length 90
TLS| read Handshake fragment
HS | recv_fragment
HSL| parsed ServerHello
HSL| end of flight
HS | client_ServerHello
NGO| processing server extensions [ supported_versions key_share ]
NGO| negotiated 1.3 TLS_CHACHA20_POLY1305_SHA256
HS | Running TLS 1.3
KS | ks_client_13_sh hashed_log = 736f34dce7668bda6fb1077a7b513fe3743e31d5af8d24f91d72c328cc87fa52
KS | no PSK negotiated. Early secret: 33ad0a1c607ec03b09e6cd9893680ce210adf300aa1f2660e1b22e10f170f92a
KS | handshake salt:                  6f2615a108c702c5678f54fc9dbab69716c076189c48250cebeac3576c3611ba
CDH| DH initiator on X255519
KS | DH shared secret: 0b85ffd144886acb0ece7b2861704d173e64b170fa0f0be9a796a1147f1d5c7b
KS | handshake secret:                e13dcff9745bb1f63014efdccd5f08bf50a00bc19ade13c1511f645eb56ee74e
KS | handshake traffic secret[C]:     f48e22f5283f10c6a82b4e1cc36318cb6b167dcb625c7fb27ab9800d0a906d1c
KS | handshake traffic secret[S]:     fd7b74d7f0adaa495ff004885ad087a3e41fd00d5bc62b9680e781efc4a69d45
KS | handshake key[C]:                94e2aa96a54dc5be3c3f732f7e6639bfdb6c4095c4e5be98aa3bfe1459eabc1f, IV=2e72dc8017d53acf55e54af7
KS | handshake key[S]:                60d854ec79d31b3992deaaa151c43ad769f25384c57b54010acec7b020e3711e, IV=3cef4a0084b82bec609e5c5e
KS | finished key[C]: 22de3f605cb7b4bfeb9cc6c4fc09dfe97ca2645cca0a320192637cf10565bb19
KS | finished key[S]: 29df2f8fed7ec8b0811ff28da398f2d521aed604501900468d5c523cf4839ae8
KS | application salt:                94f1f409625af444a093443cc3f3f7159550e623a9599c8ba741ff72c1960d95
KS | application secret:              4bbfbb0d7a383f8c2412e611c4b5c7e52e1f29013d379f901dd1d670319c1e26
AEP| LowProvider: COERCE(K=94e2aa96a54dc5be3c3f732f7e6639bfdb6c4095c4e5be98aa3bfe1459eabc1f)
AEP| LowProvider: COERCE(K=60d854ec79d31b3992deaaa151c43ad769f25384c57b54010acec7b020e3711e)
EPO| reader++ 0/-1
TLS| readOne ReadAgain
TLS| writeHandshake (plaintext)
TLS| HS.next_fragment PlaintextID?
HS | next_fragment
TLS| HS.next_fragment returned nothing
TLS| sendHandshake
TLS| read: WrittenHS, Ctrl/Ctrl, nothing
TLS| Read fragment at epoch index: 0 of length 734
TLS| StAE decrypt correct.
TLS| read Handshake fragment
HS | recv_fragment
HSL| parsed EncryptedExtensions
HSL| parsed Certificate13
HSL| parsed CertificateVerify
HSL| parsed Finished
HSL| end of flight
NGO| Nego.clientComplete_13
NGO| EE: alpn supported_groups 001a 
NGO| Negotiation callback to process application extensions.
@@@@ Nego callback for TLS 1.3 @@@@
Offered extensions:
001b0010000800060568712d3130000a00040002001d001a0003000102
Transport parameters offered:
000102
No application cookie (fist connection).
Adding server transport parameters:
000102
@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
WARNING: chain validation failed, ignoring.
NGO| Certificate & signature 1.3 callback result: valid
KS | ks_client_13_sf hashed_log = 896619eaaa85278687428760e0826d017ea7e84e2489f0be4bc3513ce6637483
KS | application traffic secret[C]:   405cedf28e390da88ff99e930c9e9c1751f33af4ba31646269fad43bd1cf1290
KS | application traffic secret[S]:   97e95cf238f9f8daa55544292d5f2d0313e045519c59cf1f682247103ea989d2
KS | exporter master secret:          9bd5d35212175fd78d2bf3decde21739b47aca000accccc07cdce53dee20af63
KS | application key[C]:              38b148c0300e3e01e7d9247b0cfac5cc1e19984e0e5f5bb3fe0eebd5445d3ffc, IV=ac3bf775d4e949fe9cf0800b
KS | application key[S]:              3b9c5f699e8723dfb35cf8012f2e5878ca08be5fba2ba56f86f0e431ec61802b, IV=77c3d8f6ccf47ea09791d9bb
AEP| LowProvider: COERCE(K=38b148c0300e3e01e7d9247b0cfac5cc1e19984e0e5f5bb3fe0eebd5445d3ffc)
AEP| LowProvider: COERCE(K=3b9c5f699e8723dfb35cf8012f2e5878ca08be5fba2ba56f86f0e431ec61802b)
HS | exporting a key
HS | Early data rejected
EPO| writer++ 0/0
HSL| emit Finished and hash
KS | ks_client_13_cf hashed_log = 7c5b1539ab8bd3e5fe00764cbe80a2970bfe356e255663f6ca3a31765daad677
KS | resumption master secret:        ad5a30ad4ee2669b0721a5ffe9091648b0e32c018c3a4f21543f659ff5ea498f
EPO| reader++ 1/0
TLS| readOne ReadAgain
TLS| writeHandshake (encrypted)
TLS| HS.next_fragment ID13?
HS | next_fragment
TLS| HS.next_fragment returned a fragment; next_keys (for all data); complete
TLS| sendHandshake
TLS| send Handshake fragment with index ID13
TLS| Encrypting with key 94e2aa96a54dc5be3c3f732f7e6639bfdb6c4095c4e5be98aa3bfe1459eabc1f
TLS| Sending fragment of length 53
REC| record headers: 1703030035
EPO| writer++ 1/1
TLS| read: WrittenHS, Open/Open, new writer: complete
client returns client_complete clen=58 slen=834
secret=9bd5d35212175fd78d2bf3decde21739b47aca000accccc07cdce53dee20af63
(Finished) [  58] ---->

TLS| writeHandshake (encrypted)
TLS| HS.next_fragment ID13?
HS | next_fragment
TLS| HS.next_fragment returned nothing
TLS| sendHandshake
TLS| read: WrittenHS, Ctrl/Open, nothing
TLS| Read fragment at epoch index: 0 of length 53
TLS| StAE decrypt correct.
TLS| read Handshake fragment
HS | recv_fragment
HSL| parsed Finished
HSL| end of flight
HS | Process Client Finished
KS | ks_server_13_cf hashed_log = 7c5b1539ab8bd3e5fe00764cbe80a2970bfe356e255663f6ca3a31765daad677
KS | resumption master secret:        ad5a30ad4ee2669b0721a5ffe9091648b0e32c018c3a4f21543f659ff5ea498f
HS | Sending ticket: 98cb779e5dfe2cdd23b4ceac4abaeb3bb7d6a20202f389fb9f207d32883a749a389c6dd21ae678cc5d9b6742d63983ec80c7477bcaebbfaf5bb477193879f38e0fa4221ec4f81d4121760738
HSL| emit NewSessionTicket13
EPO| reader++ 1/1
TLS| readOne Complete
server returns server_complete clen=58 slen=0
TLS| writeHandshake (encrypted)
TLS| HS.next_fragment ID13?
HS | next_fragment
TLS| HS.next_fragment returned a fragment
TLS| sendHandshake
TLS| send Handshake fragment with index ID13
TLS| Encrypting with key 3b9c5f699e8723dfb35cf8012f2e5878ca08be5fba2ba56f86f0e431ec61802b
TLS| Sending fragment of length 130
REC| record headers: 1703030082
TLS| writeHandshake (encrypted)
TLS| HS.next_fragment ID13?
HS | next_fragment
TLS| HS.next_fragment returned nothing
TLS| sendHandshake
TLS| read: WrittenHS, Open/Open, nothing
REC| WouldBlock
TLS| readOne ReadWouldBlock
server returns would_block clen=0 slen=135
<---- {Ticket}[ 135]
TLS| writeHandshake (encrypted)
TLS| HS.next_fragment ID13?
HS | next_fragment
TLS| HS.next_fragment returned nothing
TLS| sendHandshake
TLS| read: WrittenHS, Open/Open, nothing
TLS| Read fragment at epoch index: 1 of length 130
TLS| StAE decrypt correct.
TLS| read Handshake fragment
HS | recv_fragment
HSL| parsed NewSessionTicket13
HSL| end of flight
HS | Received ticket: 98cb779e5dfe2cdd23b4ceac4abaeb3bb7d6a20202f389fb9f207d32883a749a389c6dd21ae678cc5d9b6742d63983ec80c7477bcaebbfaf5bb477193879f38e0fa4221ec4f81d4121760738
KS | ks_client_13_rms
KS | Recall RMS: ad5a30ad4ee2669b0721a5ffe9091648b0e32c018c3a4f21543f659ff5ea498f
AEP| LowProvider: COERCE(K=411f2022cbbcec52d55d97cb187b6e19e668c1cd15c43f252ac7879a4c9e81fa)

##### New session ticket received! #####
Host: localhost
Ticket:
98cb779e5dfe2cdd23b4ceac4abaeb3bb7d6a20202f389fb9f207d32883a749a
389c6dd21ae678cc5d9b6742d63983ec80c7477bcaebbfaf5bb477193879f38e
0fa4221ec4f81d4121760738
########################################
TLS| readOne ReadAgain
TLS| writeHandshake (encrypted)
TLS| HS.next_fragment ID13?
HS | next_fragment
TLS| HS.next_fragment returned nothing
TLS| sendHandshake
TLS| read: WrittenHS, Open/Open, nothing
REC| WouldBlock
TLS| readOne ReadWouldBlock
client returns clen=0 slen=135 status=would_block
Ok
make[1]: Leaving directory '/cygdrive/c/build/agent2/_work/6/s/mitls-fstar/apps/quicMinusNet'
make[1]: Entering directory '/cygdrive/c/build/agent2/_work/6/s/mitls-fstar/src/tls'
C:/build/agent2/_work/6/s/FStar/bin/fstar.exe --cache_dir cache/Model --cache_checked_modules --print_z3_statistics --use_hints --query_stats --cache_dir cache/Model --odir extract/Model --extract Nothing --dep full --include C:/build/agent2/_work/6/s/FStar/contrib/CoreCrypto/fst/ --include C:/build/agent2/_work/6/s/hacl-star/secure_api --include C:/build/agent2/_work/6/s/hacl-star/secure_api/utils --include C:/build/agent2/_work/6/s/hacl-star/secure_api/concrete_specializations --include C:/build/agent2/_work/6/s/hacl-star/secure_api/LowCProvider/fst --include C:/build/agent2/_work/6/s/hacl-star/code/curve25519/api --include C:/build/agent2/_work/6/s/hacl-star/code/lib --include C:/build/agent2/_work/6/s/kremlin/include --include C:/build/agent2/_work/6/s/kremlin/kremlib --include ../../libs/ffi --include ../../src/lowparse --include C:/build/agent2/_work/6/s/hacl-star/providers/evercrypt --include ../../src/tls/ideal-flags --include ../../src/tls/concrete-flags/generic --include ./concrete-flags/Debug QUIC.fst Test.Main.fst IV.fst HMAC.UFCMA.fst Token.UF1CMA.fst Pkg.Tree.fst AEAD.Pkg.fst > cache/Model/.depend
sed -i.opt -e "s/cmx/cmo/g" -e "s/source/old/g" cache/Model/.depend
make[1]: Leaving directory '/cygdrive/c/build/agent2/_work/6/s/mitls-fstar/src/tls'
make[1]: Entering directory '/cygdrive/c/build/agent2/_work/6/s/mitls-fstar/src/tls'
C:/build/agent2/_work/6/s/FStar/bin/fstar.exe --cache_dir cache/Kremlin --cache_checked_modules --print_z3_statistics --use_hints --query_stats --cache_dir cache/Kremlin --odir extract/Kremlin --extract '* -DHDB -LowCProvider -FFICallbacks -BufferBytes' --dep full --include C:/build/agent2/_work/6/s/FStar/contrib/CoreCrypto/fst/ --include C:/build/agent2/_work/6/s/hacl-star/secure_api --include C:/build/agent2/_work/6/s/hacl-star/secure_api/utils --include C:/build/agent2/_work/6/s/hacl-star/secure_api/concrete_specializations --include C:/build/agent2/_work/6/s/hacl-star/secure_api/LowCProvider/fst --include C:/build/agent2/_work/6/s/hacl-star/code/curve25519/api --include C:/build/agent2/_work/6/s/hacl-star/code/lib --include C:/build/agent2/_work/6/s/kremlin/include --include C:/build/agent2/_work/6/s/kremlin/kremlib --include ../../libs/ffi --include ../../src/lowparse --include C:/build/agent2/_work/6/s/hacl-star/providers/evercrypt --include ../../src/tls/concrete-flags --include ../../src/tls/concrete-flags/Kremlin --include ./concrete-flags/Debug QUIC.fst Test.Main.fst > cache/Kremlin/.depend
sed -i.opt -e "s/cmx/cmo/g" -e "s/source/old/g" cache/Kremlin/.depend
make[1]: Leaving directory '/cygdrive/c/build/agent2/_work/6/s/mitls-fstar/src/tls'
make[1]: Entering directory '/cygdrive/c/build/agent2/_work/6/s/mitls-fstar/src/tls'
echo No verification-specific tests as of yet.
No verification-specific tests as of yet.
make[1]: Leaving directory '/cygdrive/c/build/agent2/_work/6/s/mitls-fstar/src/tls'
make[1]: Entering directory '/cygdrive/c/build/agent2/_work/6/s/mitls-fstar/src/tls'
C:/build/agent2/_work/6/s/FStar/bin/fstar.exe --cache_dir cache/OCaml --cache_checked_modules --print_z3_statistics --use_hints --query_stats --cache_dir cache/OCaml --odir extract/OCaml --extract '* -Prims -FStar +FStar.Test +FStar.Kremlin.Endianness -CoreCrypto -CryptoTypes -EverCrypt.Bytes -EverCrypt -DHDB -LowCProvider -HaclProvider -FFICallbacks -Crypto.AEAD -Crypto.Symmetric -Crypto.Plain -Spec.Loops -Buffer.Utils -C +C.Loops -LowParse.SLow.Tac -BufferBytes' --dep full --include C:/build/agent2/_work/6/s/FStar/contrib/CoreCrypto/fst/ --include C:/build/agent2/_work/6/s/hacl-star/secure_api --include C:/build/agent2/_work/6/s/hacl-star/secure_api/utils --include C:/build/agent2/_work/6/s/hacl-star/secure_api/concrete_specializations --include C:/build/agent2/_work/6/s/hacl-star/secure_api/LowCProvider/fst --include C:/build/agent2/_work/6/s/hacl-star/code/curve25519/api --include C:/build/agent2/_work/6/s/hacl-star/code/lib --include C:/build/agent2/_work/6/s/kremlin/include --include C:/build/agent2/_work/6/s/kremlin/kremlib --include ../../libs/ffi --include ../../src/lowparse --include C:/build/agent2/_work/6/s/hacl-star/providers/evercrypt --include ../../src/tls/concrete-flags --include ../../src/tls/concrete-flags/OCaml --include ./concrete-flags/Debug QUIC.fst Test.Main.fst > cache/OCaml/.depend
sed -i.opt -e "s/cmx/cmo/g" -e "s/source/old/g" cache/OCaml/.depend
make[1]: Leaving directory '/cygdrive/c/build/agent2/_work/6/s/mitls-fstar/src/tls'
EVEREST_WINDOWS= make -C extract/Kremlin-Internal-Test test
EVEREST_WINDOWS= make -C extract/Kremlin-Library test
make[2]: Nothing to be done for 'test'.
make[2]: 'test' is up to date.
make[1]: Entering directory '/cygdrive/c/build/agent2/_work/6/s/mitls-fstar/src/tls'
OCAMLPATH="C:/build/agent2/_work/6/s/FStar/bin" ocamlfind opt -g -I C:/build/agent2/_work/6/s/FStar/ulib/ml -I extract/OCaml -I C:/build/agent2/_work/6/s/MLCrypto -I ../../libs/ffi -I C:/build/agent2/_work/6/s/hacl-star/secure_api/LowCProvider -I C:/build/agent2/_work/6/s/hacl-star/secure_api/out/runtime_switch/ -I C:/build/agent2/_work/6/s/kremlin/_build/kremlib -I test -I extract/mlstubs -I C:/build/agent2/_work/6/s/hacl-star/providers/evercrypt/ml -I . -package fstarlib,zarith,ctypes,ctypes.foreign -cclib -L../pki -cclib -lmipki \
-cclib -LC:/build/agent2/_work/6/s/hacl-star/providers/out -cclib -levercrypt -linkall \
-linkpkg -g extract/OCaml/BufferBytes.cmx extract/OCaml/Crypto_AEAD_Main.cmx C:/build/agent2/_work/6/s/kremlin/_build/kremlib/C.cmx C:/build/agent2/_work/6/s/MLCrypto/CoreCrypto.cmxa C:/build/agent2/_work/6/s/hacl-star/secure_api/out/runtime_switch/LowC.cmxa ../../libs/ffi/FFICallbacks.cmxa C:/build/agent2/_work/6/s/hacl-star/providers/out/evercrypt.cmxa extract/OCaml/Hashing_Spec.cmx extract/OCaml/Flags.cmx extract/OCaml/TLSError.cmx extract/OCaml/Mem.cmx extract/OCaml/Hashing_OpenSSL.cmx extract/OCaml/Hashing.cmx extract/OCaml/LowParse_Bytes32.cmx extract/OCaml/LowParse_Bytes.cmx extract/OCaml/LowParse_Spec_Base.cmx extract/OCaml/LowParse_Spec_Combinators.cmx extract/OCaml/LowParse_SLow_Base.cmx extract/OCaml/LowParse_SLow_Combinators.cmx extract/OCaml/LowParse_Spec_Enum.cmx extract/OCaml/LowParse_SLow_Enum.cmx extract/OCaml/LowParse_Spec_Sum.cmx extract/OCaml/LowParse_SLow_Sum.cmx extract/OCaml/LowParse_Math.cmx extract/OCaml/FStar_Kremlin_Endianness.cmx extract/OCaml/LowParse_BigEndian.cmx extract/OCaml/LowParse_BigEndianImpl_Base.cmx extract/OCaml/LowParse_BigEndianImpl_SLow.cmx extract/OCaml/LowParse_Spec_FLData.cmx extract/OCaml/LowParse_SLow_FLData.cmx extract/OCaml/LowParse_Spec_VLData.cmx extract/OCaml/LowParse_SLow_VLData.cmx extract/OCaml/LowParse_Spec_Bytes.cmx extract/OCaml/LowParse_SLow_Bytes.cmx extract/OCaml/LowParse_Spec_List.cmx extract/OCaml/LowParse_Spec_Array.cmx extract/OCaml/C_Loops.cmx extract/OCaml/LowParse_SLow_List.cmx extract/OCaml/LowParse_SLow_Array.cmx extract/OCaml/LowParse_Spec_Int_Aux.cmx extract/OCaml/LowParse_Spec_Int.cmx extract/OCaml/LowParse_Spec_Int_Unique.cmx extract/OCaml/LowParse_SLow_Int_Aux.cmx extract/OCaml/LowParse_SLow_Int.cmx extract/OCaml/LowParse_SLow.cmx extract/OCaml/Format_NamedGroup.cmx extract/OCaml/Format_Constants.cmx extract/OCaml/Format_UncompressedPointRepresentation.cmx extract/OCaml/Format_KeyShareEntry.cmx extract/OCaml/Format_ECCurveType.cmx extract/OCaml/TLS_Curve25519.cmx extract/OCaml/Parse.cmx extract/OCaml/ECGroup.cmx extract/OCaml/DHGroup.cmx extract/OCaml/DebugFlags.cmx extract/OCaml/Format_NamedGroupList.cmx extract/OCaml/CommonDH.cmx extract/OCaml/LowParseWrappers.cmx extract/OCaml/QD_TLS_protocolVersion.cmx extract/OCaml/TLSConstants.cmx extract/OCaml/PKI.cmx extract/OCaml/Nonce.cmx extract/OCaml/RSAKey.cmx extract/OCaml/PMS.cmx extract/OCaml/List_Helpers.cmx extract/OCaml/PSK.cmx extract/OCaml/Extensions.cmx extract/OCaml/Cert.cmx extract/OCaml/TLSInfoFlags.cmx extract/OCaml/TLSInfo.cmx extract/OCaml/Crypto_Indexing.cmx extract/OCaml/Flag.cmx extract/OCaml/Specializations_Providers_AEAD.cmx extract/OCaml/AEADOpenssl.cmx extract/OCaml/AEADProvider.cmx extract/OCaml/Range.cmx extract/OCaml/Hashing_CRF.cmx extract/OCaml/HandshakeMessages.cmx extract/OCaml/HandshakeLog.cmx extract/OCaml/HMAC.cmx extract/OCaml/Old_HMAC_UFCMA.cmx extract/OCaml/Test_BufferBytes.cmx extract/OCaml/TLSPRF.cmx extract/OCaml/DataStream.cmx extract/OCaml/Alert.cmx extract/OCaml/Content.cmx extract/OCaml/StreamPlain.cmx extract/OCaml/StreamAE.cmx extract/OCaml/StatefulPlain.cmx extract/OCaml/LHAEPlain.cmx extract/OCaml/AEAD_GCM.cmx extract/OCaml/StatefulLHAE.cmx extract/OCaml/StAE.cmx extract/OCaml/Ticket.cmx extract/OCaml/Old_HKDF.cmx extract/OCaml/Old_KeySchedule.cmx extract/OCaml/FStar_Test.cmx extract/OCaml/Test_CommonDH.cmx extract/OCaml/Negotiation.cmx extract/OCaml/Old_Epochs.cmx extract/OCaml/Old_Handshake.cmx extract/OCaml/Transport.cmx extract/OCaml/Record.cmx extract/OCaml/Connection.cmx extract/OCaml/StreamDeltas.cmx extract/OCaml/TLS.cmx extract/OCaml/FFI.cmx extract/OCaml/QUIC.cmx extract/OCaml/Test_StAE.cmx extract/OCaml/Test_TLSConstants.cmx extract/OCaml/Test_Handshake.cmx extract/OCaml/Test_AEAD.cmx extract/OCaml/Test_Main.cmx extract/OCaml/FFIRegister.cmx C:/build/agent2/_work/6/s/kremlin/kremlib/out/libkremlib.a -o mitls.exe -thread
make[1]: Leaving directory '/cygdrive/c/build/agent2/_work/6/s/mitls-fstar/src/tls'
make[1]: Entering directory '/cygdrive/c/build/agent2/_work/6/s/mitls-fstar/src/tls'
./mitls.exe
make[1]: Leaving directory '/cygdrive/c/build/agent2/_work/6/s/mitls-fstar/src/tls'
+ cd mitls-fstar/apps/cmitls
+ make test
./cmitls.exe google.com 443
cmitls.exe ===================
cmitls.exe calling FFI_mitls_init
cmitls.exe about to act as client or server
===============================================
Starting test client...
FFI| Setting up certificate callbacks.
FFI| Setting a new server negotiation callback.
TLS| writeHandshake (plaintext)
TLS| HS.next_fragment PlaintextID?
HS | next_fragment
HS | offering ClientHello 1.3
KS | ks_client_init 1.3
CDH| Keygen (initiator) on X255519
NGO| No PSK or 0-RTT disabled
NGO| offering client extensions [ supported_versions key_share server_name session_ticket extended_master_secret signature_algorithms ec_point_formats supported_groups psk_key_exchange_modes ]
NGO| offering cipher suites ; TLS_AES_128_GCM_SHA256; TLS_AES_256_GCM_SHA384; TLS_CHACHA20_POLY1305_SHA256; TLS_ECDHE_ECDSA_WITH_AES_128_GCM_SHA256; TLS_ECDHE_RSA_WITH_AES_128_GCM_SHA256; TLS_DHE_RSA_WITH_AES_128_GCM_SHA256; TLS_ECDHE_ECDSA_WITH_AES_256_GCM_SHA384; TLS_ECDHE_RSA_WITH_AES_256_GCM_SHA384; TLS_DHE_RSA_WITH_AES_256_GCM_SHA384; TLS_ECDHE_ECDSA_WITH_CHACHA20_POLY1305_SHA256; TLS_ECDHE_RSA_WITH_CHACHA20_POLY1305_SHA256; TLS_DHE_RSA_WITH_CHACHA20_POLY1305_SHA256
HSL| emit ClientHello
TLS| HS.next_fragment returned a fragment
TLS| sendHandshake
TLS| send Handshake fragment with index PlaintextID
TLS| Sending fragment of length 208
REC| record headers: 16030300d0
TLS| writeHandshake (plaintext)
TLS| HS.next_fragment PlaintextID?
HS | next_fragment
TLS| HS.next_fragment returned nothing
TLS| sendHandshake
TLS| read: WrittenHS, Ctrl/Ctrl, nothing
TLS| Read fragment at epoch index: -1 of length 58
TLS| read Handshake fragment
HS | recv_fragment
HSL| parsed ServerHello
HSL| end of flight
HS | client_ServerHello
NGO| processing server extensions [ extended_master_secret session_ticket ec_point_formats ]
NGO| negotiated 1.2 TLS_ECDHE_ECDSA_WITH_AES_128_GCM_SHA256
HS | Running classic TLS
HS | Offered SID= Server SID=
HS | recv_fragment
HSL| more bytes required
TLS| readOne ReadAgain
TLS| writeHandshake (plaintext)
TLS| HS.next_fragment PlaintextID?
HS | next_fragment
TLS| HS.next_fragment returned nothing
TLS| sendHandshake
TLS| read: WrittenHS, Ctrl/Ctrl, nothing
TLS| Read fragment at epoch index: -1 of length 3072
TLS| read Handshake fragment
HS | recv_fragment
HSL| parsed Certificate
HSL| more bytes required
TLS| readOne ReadAgain
TLS| writeHandshake (plaintext)
TLS| HS.next_fragment PlaintextID?
HS | next_fragment
TLS| HS.next_fragment returned nothing
TLS| sendHandshake
TLS| read: WrittenHS, Ctrl/Ctrl, nothing
TLS| Read fragment at epoch index: -1 of length 116
TLS| read Handshake fragment
HS | recv_fragment
HSL| parsed ServerKeyExchange
HSL| more bytes required
TLS| readOne ReadAgain
TLS| writeHandshake (plaintext)
TLS| HS.next_fragment PlaintextID?
HS | next_fragment
TLS| HS.next_fragment returned nothing
TLS| sendHandshake
TLS| read: WrittenHS, Ctrl/Ctrl, nothing
TLS| Read fragment at epoch index: -1 of length 4
TLS| read Handshake fragment
HS | recv_fragment
HSL| parsed ServerHelloDone
HSL| end of flight
HS | processing ...ServerHelloDone
NGO| ServerKeyExchange signature: Valid
CDH| Keygen (responder) on X255519
CDH| DH initiator on X255519
KS | Share: 3588200535f82a2fcf95f213b857940901ddd0b43629f4aa767714ee2673711b
KS | Share: 8d365c585d7a096c8aaab2fad6c9e7c99a335d034b49c2b6efe86a17b3468a17
KS | PMS: fbebced8e53cdda6396e293657188d2f338b4677239cbf27fe695d0279cfd20e
HSL| emit ClientKeyExchange and hash
KS | ks_client_12_set_session_hash hashed_log = 9b546f2c26756528760a0ec9815670cb91167902c30f12a1463cfc7fef18ddf1
KS | extended master secret:04ec4bb711bd463c70815f8811e2a2f3f3fe658c4cdeda60c484f05f862d09211fca0a52caf5db95b37104295936fe06
KS | ks_12_record_key
KS | keystring (CK, CIV, SK, SIV) = 5aac286d7677f8cf0e279ef53658666330f61fb1a91e5cb7430272ebc9bc04d6e93d8ff87cb1ebbb
AEP| LowProvider: COERCE(K=5aac286d7677f8cf0e279ef536586663)
AEP| LowProvider: COERCE(K=30f61fb1a91e5cb7430272ebc9bc04d6)
HS | digest is 9b546f2c26756528760a0ec9815670cb91167902c30f12a1463cfc7fef18ddf1
TLS| readOne ReadAgain
TLS| writeHandshake (plaintext)
TLS| HS.next_fragment PlaintextID?
HS | next_fragment
TLS| HS.next_fragment returned a fragment; CCS; next_keys (for handshake only
TLS| sendHandshake
TLS| send Handshake fragment with index PlaintextID
TLS| Sending fragment of length 37
REC| record headers: 1603030025
TLS| send CCS fragment with index PlaintextID
TLS| Sending fragment of length 1
REC| record headers: 1403030001
EPO| writer++ -1/0
TLS| writeHandshake (encrypted)
TLS| HS.next_fragment ID12?
HS | next_fragment
TLS| HS.next_fragment returned a fragment
TLS| sendHandshake
TLS| send Handshake fragment with index ID12
TLS| Sending fragment of length 40
REC| record headers: 1603030028
TLS| writeHandshake (encrypted)
TLS| HS.next_fragment ID12?
HS | next_fragment
TLS| HS.next_fragment returned nothing
TLS| sendHandshake
TLS| read: WrittenHS, Ctrl/Ctrl, new writer: handshake-only
TLS| ignore handshake-specifc key change; calling read again
TLS| writeHandshake (encrypted)
TLS| HS.next_fragment ID12?
HS | next_fragment
TLS| HS.next_fragment returned nothing
TLS| sendHandshake
TLS| read: WrittenHS, Ctrl/Ctrl, nothing
TLS| Read fragment at epoch index: -1 of length 228
TLS| read Handshake fragment
HS | recv_fragment
HSL| parsed NewSessionTicket
HSL| more bytes required
TLS| readOne ReadAgain
TLS| writeHandshake (encrypted)
TLS| HS.next_fragment ID12?
HS | next_fragment
TLS| HS.next_fragment returned nothing
TLS| sendHandshake
TLS| read: WrittenHS, Ctrl/Ctrl, nothing
TLS| Read fragment at epoch index: -1 of length 1
TLS| read CCS fragment
HS | recv_ccs
HS | Processing server CCS (full handshake). Ticket: 00ed68b0f2fb668fca42a23b5b2cf97c8f652bd88841ec2b4baa574606c9c54062276ff240d62d1123350e46f1d6dd31f9c4e49c0dda03edf8090ba73f6b94dd3d091f97cf95c1fb7762c96d2389adfe12e7e7aad3200908605bf0be6899c6f2c0ea496892c6b4b53489586c7516684ccbc53189e6912444fdea5c1ce62c73929d10ab431bc17acda54c72ea04f2ef88644bd330109b7b2317e2395f5a0a4b89e01601b74b590d258c7a9cc026b58705e16e69ee5a5cfc6617ac8cbccf7aa558361fb75e7f608b9c4c8cabf8adc2aba87c63348fe66287469cf9
EPO| reader++ 0/0
TLS| readOne ReadAgainFinishing
TLS| writeHandshake (encrypted)
TLS| HS.next_fragment ID12?
HS | next_fragment
TLS| HS.next_fragment returned nothing
TLS| sendHandshake
TLS| read: WrittenHS, Ctrl/Ctrl, nothing
TLS| Read fragment at epoch index: 0 of length 40
TLS| StAE decrypt correct.
TLS| read Handshake fragment
HS | recv_fragment
HSL| parsed Finished
HSL| end of flight
TLS| readOne Complete
FFI| Read returned Complete
Read OK, sending HTTP request...
TLS| writeHandshake (encrypted)
TLS| HS.next_fragment ID12?
HS | next_fragment
TLS| HS.next_fragment returned nothing
TLS| sendHandshake
TLS| send Data fragment with index ID12
TLS| Sending fragment of length 60
REC| record headers: 170303003c
TLS| writeHandshake (encrypted)
TLS| HS.next_fragment ID12?
HS | next_fragment
TLS| HS.next_fragment returned nothing
TLS| sendHandshake
TLS| read: WrittenHS, Open/Open, nothing
TLS| Read fragment at epoch index: 0 of length 620
TLS| StAE decrypt correct.
TLS| read Data fragment
TLS| readOne Read 596 bytes of data
Received 596 bytes of data:
Download speed: 1.#INF00kB/s
HTTP/1.1 301 Moved Permanently
Location: https://www.google.com/
Content-Type: text/html; charset=UTF-8
Date: Thu, 14 Jun 2018 21:55:18 GMT
Expires: Sat, 14 Jul 2018 21:55:18 GMT
Cache-Control: public, max-age=2592000
Server: gws
Content-Length: 220
X-XSS-Protection: 1; mode=block
X-Frame-Options: SAMEORIGIN
Alt-Svc: quic=":443"; ma=2592000; v="43,42,41,39,35"

<HTML><HEAD><meta http-equiv="content-type" content="text/html;charset=utf-8">
<TITLE>301 Moved</TITLE></HEAD><BODY>
<H1>301 Moved</H1>
The document has moved
<A HREF="https://www.google.com/">here</A>.
</BODY></HTML>

Closing connection, irrespective of the response
./cmitls.exe tls13.cloudflare.com 443
cmitls.exe ===================
cmitls.exe calling FFI_mitls_init
cmitls.exe about to act as client or server
===============================================
Starting test client...
FFI| Setting up certificate callbacks.
FFI| Setting a new server negotiation callback.
TLS| writeHandshake (plaintext)
TLS| HS.next_fragment PlaintextID?
HS | next_fragment
HS | offering ClientHello 1.3
KS | ks_client_init 1.3
CDH| Keygen (initiator) on X255519
NGO| No PSK or 0-RTT disabled
NGO| offering client extensions [ supported_versions key_share server_name session_ticket extended_master_secret signature_algorithms ec_point_formats supported_groups psk_key_exchange_modes ]
NGO| offering cipher suites ; TLS_AES_128_GCM_SHA256; TLS_AES_256_GCM_SHA384; TLS_CHACHA20_POLY1305_SHA256; TLS_ECDHE_ECDSA_WITH_AES_128_GCM_SHA256; TLS_ECDHE_RSA_WITH_AES_128_GCM_SHA256; TLS_DHE_RSA_WITH_AES_128_GCM_SHA256; TLS_ECDHE_ECDSA_WITH_AES_256_GCM_SHA384; TLS_ECDHE_RSA_WITH_AES_256_GCM_SHA384; TLS_DHE_RSA_WITH_AES_256_GCM_SHA384; TLS_ECDHE_ECDSA_WITH_CHACHA20_POLY1305_SHA256; TLS_ECDHE_RSA_WITH_CHACHA20_POLY1305_SHA256; TLS_DHE_RSA_WITH_CHACHA20_POLY1305_SHA256
HSL| emit ClientHello
TLS| HS.next_fragment returned a fragment
TLS| sendHandshake
TLS| send Handshake fragment with index PlaintextID
TLS| Sending fragment of length 218
REC| record headers: 16030300da
TLS| writeHandshake (plaintext)
TLS| HS.next_fragment PlaintextID?
HS | next_fragment
TLS| HS.next_fragment returned nothing
TLS| sendHandshake
TLS| read: WrittenHS, Ctrl/Ctrl, nothing
TLS| Read fragment at epoch index: -1 of length 90
TLS| read Handshake fragment
HS | recv_fragment
HSL| parsed ServerHello
HSL| end of flight
HS | client_ServerHello
NGO| processing server extensions [ key_share supported_versions ]
NGO| negotiated 1.3 TLS_AES_128_GCM_SHA256
HS | Running TLS 1.3
KS | ks_client_13_sh hashed_log = 167e5489854f72f7eb1da99e662995a0af0ac0e764f3a9dd09a4331c97ef1d8e
KS | no PSK negotiated. Early secret: 33ad0a1c607ec03b09e6cd9893680ce210adf300aa1f2660e1b22e10f170f92a
KS | handshake salt:                  6f2615a108c702c5678f54fc9dbab69716c076189c48250cebeac3576c3611ba
CDH| DH initiator on X255519
KS | DH shared secret: 4909f422bc77032c71f819b15db020affea334e882595c08213eed791186635d
KS | handshake secret:                d0f9acf5effd52bfc17653fc838645b7f2cae433cea29f7fe8728f3a1e514a4c
KS | handshake traffic secret[C]:     4b77318747df9edae75d0cba64fb5490baf5a069ee93420da96c29304c7376e6
KS | handshake traffic secret[S]:     1d3f0c804ec82f0a39eaf0865d470b1232e69e7b5145f220c6e4df9be771341e
KS | handshake key[C]:                3dc7aae86c0302283994f786f023f511, IV=ae9cae97142824fcbf94c9f0
KS | handshake key[S]:                09fe33b70e642992dcd62a00b2dcbfe8, IV=cb9bca53071584828f456046
KS | finished key[C]: f6e63c5f51a14c9120c9c2cfd650aa4245ac73f6dec86eed5927901ac4dd9e52
KS | finished key[S]: fb9fa7f7db6c1b494492faf966dac46cdb775e4150ab0ca13dc11cd275a49439
KS | application salt:                99f61d284d6c39c5be245ed0223a1e0c4ef37d1b08895851b6e9358ebc86868c
KS | application secret:              e91e2e875f8aa65407a67c5e7fa1c17ec9a36738bfde1fddb91b6c583e1c45e4
AEP| LowProvider: COERCE(K=3dc7aae86c0302283994f786f023f511)
AEP| LowProvider: COERCE(K=09fe33b70e642992dcd62a00b2dcbfe8)
EPO| reader++ 0/-1
TLS| readOne ReadAgain
TLS| writeHandshake (plaintext)
TLS| HS.next_fragment PlaintextID?
HS | next_fragment
TLS| HS.next_fragment returned nothing
TLS| sendHandshake
TLS| read: WrittenHS, Ctrl/Ctrl, nothing
TLS| Read fragment at epoch index: 0 of length 1
TLS| Ignoring a CCS
TLS| Read fragment at epoch index: 0 of length 3366
TLS| StAE decrypt correct.
TLS| read Handshake fragment
HS | recv_fragment
HSL| parsed EncryptedExtensions
HSL| parsed Certificate13
HSL| parsed CertificateVerify
HSL| parsed Finished
HSL| end of flight
NGO| Nego.clientComplete_13
NGO| EE: 
NGO| Negotiation callback to process application extensions.
@@@@ Nego callback for TLS 1.3 @@@@
Offered extensions:
0000
No application cookie (fist connection).
@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
NGO| Certificate & signature 1.3 callback result: valid
KS | ks_client_13_sf hashed_log = f25324497ad42a94fd5fdb251b17c005d2c8f0c1773c0e077e7f7dddb0d0a6b6
KS | application traffic secret[C]:   7e2dd3bcda2104327eca878c288c679ddb5dfc8d72ef003e7b9f8e9b75c1aed7
KS | application traffic secret[S]:   ab53055ffe6318bb715bc5585aa58b0fca1e7cb4ae42aaa4a3b4ddf135862a0d
KS | exporter master secret:          5165ccfe6332e0d4d7e5b894ef7f799f23bfd2d3b5dcaf1ea95f0a5ab04ae833
KS | application key[C]:              00676c68a8970737513237b678f3fd79, IV=3613e17dc13a37fd444a27b7
KS | application key[S]:              bcdd6d42425664277826fb78d5306ff8, IV=f308c26a9eacd54b21983b96
AEP| LowProvider: COERCE(K=00676c68a8970737513237b678f3fd79)
AEP| LowProvider: COERCE(K=bcdd6d42425664277826fb78d5306ff8)
HS | exporting a key
HS | Early data rejected
EPO| writer++ 0/0
+ cd mitls-fstar/apps/quicMinusNet
HSL| emit Finished and hash
KS | ks_client_13_cf hashed_log = e55997596eac02c3a94e5c90ffa984fc688f0c207153029113d8c027c1070548
+ make test
KS | resumption master secret:        d8badd62b943bc6ad56de13734ff174d8f3752ba00a8f4e023a451d28346bf35
EPO| reader++ 1/0
TLS| readOne ReadAgain
TLS| writeHandshake (encrypted)
TLS| HS.next_fragment ID13?
HS | next_fragment
TLS| HS.next_fragment returned a fragment; next_keys (for all data); complete
TLS| sendHandshake
TLS| send Handshake fragment with index ID13
TLS| Encrypting with key 637c777bf26b6fc53001672bfed7ab76
TLS| Sending fragment of length 53
REC| record headers: 1703030035
EPO| writer++ 1/1
TLS| read: WrittenHS, Open/Open, new writer: complete
FFI| Read returned Complete
Read OK, sending HTTP request...
TLS| writeHandshake (encrypted)
TLS| HS.next_fragment ID13?
HS | next_fragment
TLS| HS.next_fragment returned nothing
TLS| sendHandshake
TLS| send Data fragment with index ID13
TLS| Encrypting with key 637c777bf26b6fc53001672bfed7ab76
TLS| Sending fragment of length 63
REC| record headers: 170303003f
TLS| writeHandshake (encrypted)
TLS| HS.next_fragment ID13?
HS | next_fragment
TLS| HS.next_fragment returned nothing
TLS| sendHandshake
TLS| read: WrittenHS, Open/Open, nothing
TLS| Read fragment at epoch index: 1 of length 461
TLS| StAE decrypt correct.
TLS| read Handshake fragment
HS | recv_fragment
HSL| parsed NewSessionTicket13
HSL| end of flight (bytes waiting)
HS | Received ticket: 11bc531e97eb9ab18db15fc58a16fb32363046ff686106e1262f94ee5c41f92ec58af28c435aee797777a23117703decc8db9cc418884b73df55eada76b22d7edb6d8f64c29134716fffddc198149d5b45470edf2de2af9f4ff05c5bca999ef4cdc2d8bfa09b01bf7803226f971e719f24023ab73e478993034c4be72c01fb1613e11fd0f7d43dac6ba346478d66497bb7781470e2f86f25e67fe4fc68fb22187ec00f96de575cbef2658fe59946ac22f1018e224e65a5103e4e208a9a4fb449
KS | ks_client_13_rms
KS | Recall RMS: d8badd62b943bc6ad56de13734ff174d8f3752ba00a8f4e023a451d28346bf35
TLS| readOne ReadAgain
TLS| writeHandshake (encrypted)
TLS| HS.next_fragment ID13?
HS | next_fragment
TLS| HS.next_fragment returned nothing
TLS| sendHandshake
TLS| read: WrittenHS, Open/Open, nothing
TLS| Read fragment at epoch index: 1 of length 1386
TLS| StAE decrypt correct.
TLS| read Data fragment
TLS| readOne Read 1369 bytes of data
Received 1369 bytes of data:
Download speed: 1.#INF00kB/s
HTTP/1.1 521 Origin Down
Date: Thu, 14 Jun 2018 21:55:18 GMT
Content-Type: text/html; charset=UTF-8
Transfer-Encoding: chunked
Connection: keep-alive
Set-Cookie: __cfduid=d35e42038b0336c2df9ca802d2420389b1529013318; expires=Fri, 14-Jun-19 21:55:18 GMT; path=/; domain=.cloudflare.com; HttpOnly
Expires: Thu, 01 Jan 1970 00:00:01 GMT
Cache-Control: no-store, no-cache, must-revalidate, post-check=0, pre-check=0
Pragma: no-cache
X-Frame-Options: SAMEORIGIN
Set-Cookie: cf_use_ob=443; expires=Thu, 14-Jun-18 21:55:48 GMT; path=/
Set-Cookie: cf_ob_info=521:42b00a571b16bcaa:SEA; expires=Thu, 14-Jun-18 21:55:48 GMT; path=/
Strict-Transport-Security: max-age=15780000; includeSubDomains
Expect-CT: max-age=604800, report-uri="https://report-uri.cloudflare.com/cdn-cgi/beacon/expect-ct"
Server: cloudflare
CF-RAY: 42b00a571b16bcaa-SEA

11c8
<!DOCTYPE html>
<!--[if lt IE 7]> <html class="no-js ie6 oldie" lang="en-US"> <![endif]-->
<!--[if IE 7]>    <html class="no-js ie7 oldie" lang="en-US"> <![endif]-->
<!--[if IE 8]>    <html class="no-js ie8 oldie" lang="en-US"> <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en-US"> <!--<![endif]-->
<head>
<meta http-equiv="refresh" content="0">

<title>tls13.cloudflare.com | 521: Web server is down</title>
<meta charset="UTF-8" />
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8
Closing connection, irrespective of the response
./quic.exe
server create
FFI| offering custom extension 001a
FFI| extension contents: ffff00050a0b0c0d0e
FFI| setting early data limit to ffffffff
FFI| Setting a new ticket callback.
FFI| Setting a new server negotiation callback.
FFI| Setting up certificate callbacks.
client create
FFI| offering custom extension 001a
FFI| extension contents: ffff00050a0b0c0d0e
FFI| setting early data limit to ffffffff
FFI| Setting a new ticket callback.
FFI| Setting a new server negotiation callback.
FFI| Setting up certificate callbacks.
client call clen=8192 slen=   0
TLS| writeHandshake (plaintext)
TLS| HS.next_fragment PlaintextID?
HS | next_fragment
HS | offering ClientHello 1.3
KS | ks_client_init 1.3
CDH| Keygen (initiator) on X255519
NGO| No PSK or 0-RTT disabled
NGO| offering client extensions [ 001a supported_versions key_share server_name alpn extended_master_secret signature_algorithms supported_groups psk_key_exchange_modes ]
NGO| offering cipher suites ; TLS_CHACHA20_POLY1305_SHA256; TLS_AES_128_GCM_SHA256
HSL| emit ClientHello
TLS| HS.next_fragment returned a fragment
TLS| sendHandshake
TLS| send Handshake fragment with index PlaintextID
TLS| Sending fragment of length 170
REC| record headers: 16030300aa
TLS| writeHandshake (plaintext)
TLS| HS.next_fragment PlaintextID?
HS | next_fragment
TLS| HS.next_fragment returned nothing
TLS| sendHandshake
TLS| read: WrittenHS, Ctrl/Ctrl, nothing
REC| WouldBlock
TLS| readOne ReadWouldBlock
client done clen= 175 slen=   0 status=would_block
16030300aa010000a603035b22e4468a99981c4a2008b68b41e6aeef2bd4522c
e439f7314da276b765a0a40000041303130101000079001a0009ffff00050a0b
0c0d0e002b0003027f1c003300260024001d00207cc89fda58d47e1fde0c7463
60c800470da8706fb99e097249ec44aee9f63a630000000e000c0000096c6f63
616c686f73740010000800060568712d313000170000000d0006000408040403
000a00040002001d002d0003020001
server call clen= 175 slen=8192
TLS| writeHandshake (plaintext)
TLS| HS.next_fragment PlaintextID?
HS | next_fragment
TLS| HS.next_fragment returned nothing
TLS| sendHandshake
TLS| read: WrittenHS, Ctrl/Ctrl, nothing
TLS| Read fragment at epoch index: -1 of length 170
TLS| read Handshake fragment
HS | recv_fragment
HSL| parsed [ClientHello] -- end of flight 
HS | Processing ClientHello
NGO| offered client extensions [ 001a supported_versions key_share server_name alpn extended_master_secret signature_algorithms supported_groups psk_key_exchange_modes ]
NGO| offered cipher suites ; TLS_CHACHA20_POLY1305_SHA256; TLS_AES_128_GCM_SHA256
NGO| offered versions 1.3
NGO| Negotiated Pure EDH key exchange
NGO| Negotiated ECDSA_SECP256R1_SHA256
NGO| Negotiation callback to handle extra extensions and query for stateless retry.
NGO| Application data in cookie: none
@@@@ Nego callback for TLS 1.3 @@@@
Offered extensions:
003d001a0009ffff00050a0b0c0d0e0000000e000c0000096c6f63616c686f73
740010000800060568712d3130000d0006000408040403000a00040002001d
Transport parameters offered:
ffff00050a0b0c0d0e
No application cookie (fist connection).
Adding server transport parameters:
000102
@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
NGO| negotiated 1.3 TLS_CHACHA20_POLY1305_SHA256
KS | ks_server_init
KS | No PSK selected.
KS | Computed early secret:           33ad0a1c607ec03b09e6cd9893680ce210adf300aa1f2660e1b22e10f170f92a
KS | Handshake salt:                  6f2615a108c702c5678f54fc9dbab69716c076189c48250cebeac3576c3611ba
CDH| Keygen (responder) on X255519
CDH| DH initiator on X255519
KS | DH shared secret: db5d06d96ad9f45e8b15893530ddbc108de802a311ffd810345718cee58bc66d
KS | Handshake secret:                d692beba489871ce902e6a7bd24bd015c1e811fb20667dc31fd6b30e06370905
NGO| processing client extensions [ 001a supported_versions key_share server_name alpn extended_master_secret signature_algorithms supported_groups psk_key_exchange_modes ]
NGO| including server extensions (SH + EE) [ supported_versions key_share alpn supported_groups ]
NGO| extra extensions from application callback: 001a 
HSL| emit ServerHello and hash
HS | derive handshake keys
KS | ks_server_13_sh, hashed log = f6710e5694ca906f824e8adb90f0792e34e8d5d9a7753674ba84b3846c08aa01
KS | handshake traffic secret[C]:     02b179b925a744dae47f1071c7d85e7718bfb850b75e3aacd455de196d7b78da
KS | handshake traffic secret[S]:     1381452af3c33732358eb0faabfa8407f576911d47aad613727a706d69a6b592
KS | handshake key[C]:                7a1e5c920dff3bfee8ff3f192ba202b635bbb6289c4a794db584ba29de46ea6d, IV=8870b718587a5b9a306e82df
KS | handshake key[S]: c84dee6defb21ebe79a9efa2d55a956ec62fd3c5734e322b2dbf4789e88dd99d, IV=29c706165a045d28c045a70b
AEP| LowProvider: COERCE(K=c84dee6defb21ebe79a9efa2d55a956ec62fd3c5734e322b2dbf4789e88dd99d)
AEP| LowProvider: COERCE(K=7a1e5c920dff3bfee8ff3f192ba202b635bbb6289c4a794db584ba29de46ea6d)
KS | finished key[C]:                 a76928824750ca67bc604abf9b1135e67f941cecbfdb36c6afa7cd992d963ff7
KS | finished key[S]:                 7e53c682d24b2d9f0dff952526f8b2e3fc8277c863b3b3253eac15503404b34d
KS | Application salt:                e866e46058ab6f6cb8d55692712eb5817fe256709cf9e5cb108131234d420c03
KS | Application secret:              de83e914e9ae43ebdc1476a2bf226751d31c096b357a57c13d729a89120cd0d0
TLS| readOne ReadAgain
TLS| writeHandshake (plaintext)
TLS| HS.next_fragment PlaintextID?
HS | next_fragment
TLS| HS.next_fragment returned a fragment; next_keys (for handshake only
TLS| sendHandshake
TLS| send Handshake fragment with index PlaintextID
TLS| Sending fragment of length 90
REC| record headers: 160303005a
EPO| writer++ -1/0
TLS| writeHandshake (encrypted)
TLS| HS.next_fragment ID13?
HS | next_fragment
HS | prepare Server Finished
HSL| emit EncryptedExtensions
HSL| emit Certificate13 and hash
======== TO BE SIGNED <0403>: (130 octets) ========
2020202020202020202020202020202020202020202020202020202020202020
2020202020202020202020202020202020202020202020202020202020202020
544c5320312e332c207365727665722043657274696669636174655665726966
790095a8ba134f4b6f5643581260bd120f0ceb68ef76aa358961b1ae7878d823
3c8d
===================================================
HSL| emit CertificateVerify and hash
HSL| emit Finished and hash
KS | ks_server_13_sf hashed_log = 16bb69874514d92cd5e785d9dc7b49cf32f88b4a040914f8cba88b8f53b7f985
KS | application traffic secret[C]:   b9dc6d604ceb6a2beb95911916cfc6f3718bd607b62ab0f589c756f0fa5f0d81
KS | application traffic secret[S]:   7ba23c62cb5b190690258b11d6471e37c647e0ad34ad0172cfba324dbbe40fa0
KS | exporter master secret:          3f3eda2bd5faf774685c71edc2f6ba7bdb31f562803b6ed125f6430be5981a25
KS | application key[C]:              b30ccdaea426a6ca2705ee1e11698ca58d2700c0968412cea200ac4f4be142f6, IV=b77fbda647d5325d2d7484e1
KS | application key[S]:              f9965d015a8f47f643b23fbebdab27e29baf4081f99048e79c07c926f6ef804e, IV=948e571e8759f73d6f5c1e04
AEP| LowProvider: COERCE(K=f9965d015a8f47f643b23fbebdab27e29baf4081f99048e79c07c926f6ef804e)
AEP| LowProvider: COERCE(K=b30ccdaea426a6ca2705ee1e11698ca58d2700c0968412cea200ac4f4be142f6)
HS | exporting a key
EPO| reader++ 0/0
TLS| HS.next_fragment returned a fragment; next_keys (for all data)
TLS| sendHandshake
TLS| send Handshake fragment with index ID13
+ set +x
TLS| Encrypting with key c84dee6defb21ebe79a9efa2d55a956ec62fd3c5734e322b2dbf4789e88dd99d
TLS| Sending fragment of length 735
REC| record headers: 17030302df
EPO| writer++ 0/1
TLS| read: WrittenHS, Ctrl/Open, new writer: writable
sender done clen= 175 slen= 835 status=server_accept
160303005a0200005603035b22e4462a1014565e017a7a40cafa2b320a505193
6fc8e3568fc97a735adc6000130300002e002b00027f1c00330024001d00204d
91b804cabbb05c64628c0b7ef7f3a70f31a8173cdee072bb935644279bd33317
030302dfff1387c5ad141f190593d7e8f4ea271b649c43903df7e09008c0f217
ad3baa0810192aa922d7c4f5631db925c64f63609042400ec0e0f9f87a828b78
a44608a62f766ba0d887c458a453cf629928bdd6a636da6ffc6cb3b0d86ebe3c
364e15d56e71895b06673418117d057eb1ae83eb578f4734b291f76487880c5a
4016b271b3b41f43eafdba078a7c532a54f3c4d7067f724b92d86a73c81e7c5c
e7ac158114b0f8d0ca9c5d8a1729a93f86cae04b21e596f3bf1dd792925298da
1191a04b43425b13b89cddef3d853c3451ba1e4874da417c755d8412a6d7cbba
3db44883f2941a19deeebea8ca4f86a59f41001938eac04f3e78de8eacdb65a5
1031ebad5c1319d588b1e9d20cc05fdbd3ad24af5d1584dace74b5bb527ce4ef
0c2e04f7a6ce3371396447240c0fa2961608fd1a1c4852550a9610e459b8e8c2
18feeb3b159a911bcb674299f7cdf73943c4c5bffc2bdf1b32c0370fe1a50cb8
360ed6be5ba1a046ec4d7cb148484c7c895fc114624ae0b8798016644ce30e47
a1feecace4d9bf6ad2300c9b63c31b953ccd98017c93725eaacc42e97a7aba70
095b29f8914b33e88c561a81d0ae880c557d54e14e94b3e9923030f9741fdcd9
a28a8168d7e352d412cba97196a8eab02d97a455cee127e68ed6b1549e32316c
a7c5ab60e242d2a366859a7001d973af32822797b64f9d0a14b99c26e73b3cd8
c7d534c99c5037a6231164e0a0d0a58ce9e971ed8586a1a9370ae7aefe0a16cf
85e61c5fa89a168de9583df107f4a76d5df3924a1a600eabfcbded0a9cad30ea
6303ab07dab7c55ac07c5067933d98a74eb2c5f46ae521b5a336488dcbf6c0b1
783df30281efaba7206a8b5676f16b4bcfadae079a05cc9c4e40c707108153fd
6df7dd2d76d51644f7697c7216f964a23b6e84e39973de8c64ea8de825762093
030cce32172b961ef129503978eb7592f631d168abf8ba0e7f9da24349adb467
9889670d04c266cfe3be468c9074c03c23298cb7f654640886297840772f1a8c
d8c022
client call clen=8017 slen= 835
TLS| writeHandshake (plaintext)
TLS| HS.next_fragment PlaintextID?
HS | next_fragment
TLS| HS.next_fragment returned nothing
TLS| sendHandshake
TLS| read: WrittenHS, Ctrl/Ctrl, nothing
TLS| Read fragment at epoch index: -1 of length 90
TLS| read Handshake fragment
HS | recv_fragment
HSL| parsed ServerHello
HSL| end of flight
HS | client_ServerHello
NGO| processing server extensions [ supported_versions key_share ]
NGO| negotiated 1.3 TLS_CHACHA20_POLY1305_SHA256
HS | Running TLS 1.3
KS | ks_client_13_sh hashed_log = f6710e5694ca906f824e8adb90f0792e34e8d5d9a7753674ba84b3846c08aa01
KS | no PSK negotiated. Early secret: 33ad0a1c607ec03b09e6cd9893680ce210adf300aa1f2660e1b22e10f170f92a
KS | handshake salt:                  6f2615a108c702c5678f54fc9dbab69716c076189c48250cebeac3576c3611ba
CDH| DH initiator on X255519
KS | DH shared secret: db5d06d96ad9f45e8b15893530ddbc108de802a311ffd810345718cee58bc66d
KS | handshake secret:                d692beba489871ce902e6a7bd24bd015c1e811fb20667dc31fd6b30e06370905
KS | handshake traffic secret[C]:     02b179b925a744dae47f1071c7d85e7718bfb850b75e3aacd455de196d7b78da
KS | handshake traffic secret[S]:     1381452af3c33732358eb0faabfa8407f576911d47aad613727a706d69a6b592
KS | handshake key[C]:                7a1e5c920dff3bfee8ff3f192ba202b635bbb6289c4a794db584ba29de46ea6d, IV=8870b718587a5b9a306e82df
KS | handshake key[S]:                c84dee6defb21ebe79a9efa2d55a956ec62fd3c5734e322b2dbf4789e88dd99d, IV=29c706165a045d28c045a70b
KS | finished key[C]: a76928824750ca67bc604abf9b1135e67f941cecbfdb36c6afa7cd992d963ff7
KS | finished key[S]: 7e53c682d24b2d9f0dff952526f8b2e3fc8277c863b3b3253eac15503404b34d
KS | application salt:                e866e46058ab6f6cb8d55692712eb5817fe256709cf9e5cb108131234d420c03
KS | application secret:              de83e914e9ae43ebdc1476a2bf226751d31c096b357a57c13d729a89120cd0d0
AEP| LowProvider: COERCE(K=7a1e5c920dff3bfee8ff3f192ba202b635bbb6289c4a794db584ba29de46ea6d)
AEP| LowProvider: COERCE(K=c84dee6defb21ebe79a9efa2d55a956ec62fd3c5734e322b2dbf4789e88dd99d)
EPO| reader++ 0/-1
TLS| readOne ReadAgain
TLS| writeHandshake (plaintext)
TLS| HS.next_fragment PlaintextID?
HS | next_fragment
TLS| HS.next_fragment returned nothing
TLS| sendHandshake
TLS| read: WrittenHS, Ctrl/Ctrl, nothing
TLS| Read fragment at epoch index: 0 of length 735
TLS| StAE decrypt correct.
TLS| read Handshake fragment
HS | recv_fragment
HSL| parsed EncryptedExtensions
HSL| parsed Certificate13
HSL| parsed CertificateVerify
HSL| parsed Finished
HSL| end of flight
NGO| Nego.clientComplete_13
NGO| EE: alpn supported_groups 001a 
NGO| Negotiation callback to process application extensions.
@@@@ Nego callback for TLS 1.3 @@@@
Offered extensions:
001b0010000800060568712d3130000a00040002001d001a0003000102
Transport parameters offered:
000102
No application cookie (fist connection).
Adding server transport parameters:
000102
@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
WARNING: chain validation failed, ignoring.
NGO| Certificate & signature 1.3 callback result: valid
KS | ks_client_13_sf hashed_log = 16bb69874514d92cd5e785d9dc7b49cf32f88b4a040914f8cba88b8f53b7f985
KS | application traffic secret[C]:   b9dc6d604ceb6a2beb95911916cfc6f3718bd607b62ab0f589c756f0fa5f0d81
KS | application traffic secret[S]:   7ba23c62cb5b190690258b11d6471e37c647e0ad34ad0172cfba324dbbe40fa0
KS | exporter master secret:          3f3eda2bd5faf774685c71edc2f6ba7bdb31f562803b6ed125f6430be5981a25
KS | application key[C]:              b30ccdaea426a6ca2705ee1e11698ca58d2700c0968412cea200ac4f4be142f6, IV=b77fbda647d5325d2d7484e1
KS | application key[S]:              f9965d015a8f47f643b23fbebdab27e29baf4081f99048e79c07c926f6ef804e, IV=948e571e8759f73d6f5c1e04
AEP| LowProvider: COERCE(K=b30ccdaea426a6ca2705ee1e11698ca58d2700c0968412cea200ac4f4be142f6)
AEP| LowProvider: COERCE(K=f9965d015a8f47f643b23fbebdab27e29baf4081f99048e79c07c926f6ef804e)
HS | exporting a key
HS | Early data rejected
EPO| writer++ 0/0
HSL| emit Finished and hash
KS | ks_client_13_cf hashed_log = a1c3a67e3485219b44743fa3140e79c7cf7bf3f445597762ff67b7007940ad9a
KS | resumption master secret:        38db65ce9c738f505195a8d791ad7d9f8df63551bbc94bd67f0545043b8a85db
EPO| reader++ 1/0
TLS| readOne ReadAgain
TLS| writeHandshake (encrypted)
TLS| HS.next_fragment ID13?
HS | next_fragment
TLS| HS.next_fragment returned a fragment; next_keys (for all data); complete
TLS| sendHandshake
TLS| send Handshake fragment with index ID13
TLS| Encrypting with key 7a1e5c920dff3bfee8ff3f192ba202b635bbb6289c4a794db584ba29de46ea6d
TLS| Sending fragment of length 53
REC| record headers: 1703030035
EPO| writer++ 1/1
TLS| read: WrittenHS, Open/Open, new writer: complete
client done clen=  58 slen= 835 status=client_complete
170303003514c4d0b0c6d6f0b13a6b88d93882336d164c3521db29401c9774cc
bc19a082cc6fa895b72eebc312e4da2fd83adb63673f7c60364a
server call clen=  58 slen=7357
TLS| writeHandshake (encrypted)
TLS| HS.next_fragment ID13?
HS | next_fragment
TLS| HS.next_fragment returned nothing
TLS| sendHandshake
TLS| read: WrittenHS, Ctrl/Open, nothing
TLS| Read fragment at epoch index: 0 of length 53
TLS| StAE decrypt correct.
TLS| read Handshake fragment
HS | recv_fragment
HSL| parsed Finished
HSL| end of flight
HS | Process Client Finished
KS | ks_server_13_cf hashed_log = a1c3a67e3485219b44743fa3140e79c7cf7bf3f445597762ff67b7007940ad9a
KS | resumption master secret:        38db65ce9c738f505195a8d791ad7d9f8df63551bbc94bd67f0545043b8a85db
AEP| LowProvider: COERCE(K=4b8aad9c1586919b2ff7538aa49f98880f79d73487d81f73c0efc58f6111ee29)
HS | Sending ticket: 939589a97c2f91b0d9949ecbadca109f479454e2e5ecc59afc6463d926838eaac92a633373405d967005c37a9ab2fceb551667c8dc9897a34db0b3977051ab9a40c6cd3cb5cb08f7d822dc14
HSL| emit NewSessionTicket13
EPO| reader++ 1/1
TLS| readOne Complete
sender done clen=  58 slen=   0 status=server_complete
=== Exporter secret ===
3f3eda2bd5faf774685c71edc2f6ba7bdb31f562803b6ed125f6430be5981a25
=== QUIC 1-RTT secrets ===
C: 4a892481eb6aa6e9fec25b65e20f1adcb590f79fe0a037a36af29c6a714e098f
S: 0eb51c8dec8fb7855d86abee3dfcbb80ba769faac4c1263c5c55c27016ed4b40
=== AEAD client key test ===
120999cebeba6649dcbc20723fd0ee35628b8ca7ab67754264f7fe
=== Decrypt successful ===
Ok
./quic.exe 0rtt

INITIAL ECDHE HANDSHAKE (NO EARLY SECRET)

server create
FFI| offering custom extension 001a
FFI| extension contents: ffff00050a0b0c0d0e
FFI| setting early data limit to ffffffff
FFI| Setting a new ticket callback.
FFI| Setting a new server negotiation callback.
FFI| Setting up certificate callbacks.
client create
FFI| offering custom extension 001a
FFI| extension contents: ffff00050a0b0c0d0e
FFI| setting early data limit to ffffffff
FFI| Setting a new ticket callback.
FFI| Setting a new server negotiation callback.
FFI| Setting up certificate callbacks.
TLS| writeHandshake (plaintext)
TLS| HS.next_fragment PlaintextID?
HS | next_fragment
HS | offering ClientHello 1.3
KS | ks_client_init 1.3
CDH| Keygen (initiator) on X255519
NGO| No PSK or 0-RTT disabled
NGO| offering client extensions [ 001a supported_versions key_share server_name alpn extended_master_secret signature_algorithms supported_groups psk_key_exchange_modes ]
NGO| offering cipher suites ; TLS_CHACHA20_POLY1305_SHA256; TLS_AES_128_GCM_SHA256
HSL| emit ClientHello
TLS| HS.next_fragment returned a fragment
TLS| sendHandshake
TLS| send Handshake fragment with index PlaintextID
TLS| Sending fragment of length 170
REC| record headers: 16030300aa
TLS| writeHandshake (plaintext)
TLS| HS.next_fragment PlaintextID?
HS | next_fragment
TLS| HS.next_fragment returned nothing
TLS| sendHandshake
TLS| read: WrittenHS, Ctrl/Ctrl, nothing
REC| WouldBlock
TLS| readOne ReadWouldBlock
client returns would_block clen=175 slen=0
ClientHello[ 175] ---->

TLS| writeHandshake (plaintext)
TLS| HS.next_fragment PlaintextID?
HS | next_fragment
TLS| HS.next_fragment returned nothing
TLS| sendHandshake
TLS| read: WrittenHS, Ctrl/Ctrl, nothing
TLS| Read fragment at epoch index: -1 of length 170
TLS| read Handshake fragment
HS | recv_fragment
HSL| parsed [ClientHello] -- end of flight 
HS | Processing ClientHello
NGO| offered client extensions [ 001a supported_versions key_share server_name alpn extended_master_secret signature_algorithms supported_groups psk_key_exchange_modes ]
NGO| offered cipher suites ; TLS_CHACHA20_POLY1305_SHA256; TLS_AES_128_GCM_SHA256
NGO| offered versions 1.3
NGO| Negotiated Pure EDH key exchange
NGO| Negotiated ECDSA_SECP256R1_SHA256
NGO| Negotiation callback to handle extra extensions and query for stateless retry.
NGO| Application data in cookie: none
@@@@ Nego callback for TLS 1.3 @@@@
Offered extensions:
003d001a0009ffff00050a0b0c0d0e0000000e000c0000096c6f63616c686f73
740010000800060568712d3130000d0006000408040403000a00040002001d
Transport parameters offered:
ffff00050a0b0c0d0e
No application cookie (fist connection).
Adding server transport parameters:
000102
@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
NGO| negotiated 1.3 TLS_CHACHA20_POLY1305_SHA256
KS | ks_server_init
KS | No PSK selected.
KS | Computed early secret:           33ad0a1c607ec03b09e6cd9893680ce210adf300aa1f2660e1b22e10f170f92a
KS | Handshake salt:                  6f2615a108c702c5678f54fc9dbab69716c076189c48250cebeac3576c3611ba
CDH| Keygen (responder) on X255519
CDH| DH initiator on X255519
KS | DH shared secret: b7b9b6ea9cfbe7a9a600fcc02b4fffda66c108871b13097e8cf1ba930258ef3c
KS | Handshake secret:                05dae4b156463998a11330b42ba1c0f14d6e099445e59cf806c63e6798162c92
NGO| processing client extensions [ 001a supported_versions key_share server_name alpn extended_master_secret signature_algorithms supported_groups psk_key_exchange_modes ]
NGO| including server extensions (SH + EE) [ supported_versions key_share alpn supported_groups ]
NGO| extra extensions from application callback: 001a 
HSL| emit ServerHello and hash
HS | derive handshake keys
KS | ks_server_13_sh, hashed log = 7ef73d5f3c143620b6f452cf858520b64bc65b238636bce3bf011a9a9f7198b7
KS | handshake traffic secret[C]:     4e3907b45b0b5e3cdb396c519bd91d5d227fcdd18fddb0f684b655ae93fb3c01
KS | handshake traffic secret[S]:     73ab38e2bad9185719fcfbf368b51f39b85efdb6089545d1f4ba6ba866646ec4
KS | handshake key[C]:                6766599419ce37c7004082763e4997a2fd8c8895dda3ef02f2af51f86263e031, IV=9528b2726673cfe7322b55a2
KS | handshake key[S]: 6676fb0bedce40ba28fc32f149513b121b0bf270a787ae69373cd6594b744a86, IV=66fb824ba15d643cb79b45e3
AEP| LowProvider: COERCE(K=6676fb0bedce40ba28fc32f149513b121b0bf270a787ae69373cd6594b744a86)
AEP| LowProvider: COERCE(K=6766599419ce37c7004082763e4997a2fd8c8895dda3ef02f2af51f86263e031)
KS | finished key[C]:                 f30eb37693da6ab7c933c0684f06a0b9279fab068ddd4ba325f7007c84f91a20
KS | finished key[S]:                 985700b75cd6305421b16a31168ebc6222766ca859377f43674f5a1cf9459e28
KS | Application salt:                987a1ff5a2b4c8adf0c809aae0c07eb8268c14e979f2d49b4f0d0492c217043e
KS | Application secret:              6b32157282a319410415d0403f8c4329448b30593952fac784361032acc681f5
TLS| readOne ReadAgain
TLS| writeHandshake (plaintext)
TLS| HS.next_fragment PlaintextID?
HS | next_fragment
TLS| HS.next_fragment returned a fragment; next_keys (for handshake only
TLS| sendHandshake
TLS| send Handshake fragment with index PlaintextID
TLS| Sending fragment of length 90
REC| record headers: 160303005a
EPO| writer++ -1/0
TLS| writeHandshake (encrypted)
TLS| HS.next_fragment ID13?
HS | next_fragment
HS | prepare Server Finished
HSL| emit EncryptedExtensions
HSL| emit Certificate13 and hash
======== TO BE SIGNED <0403>: (130 octets) ========
2020202020202020202020202020202020202020202020202020202020202020
2020202020202020202020202020202020202020202020202020202020202020
544c5320312e332c207365727665722043657274696669636174655665726966
790088375de2166d8dd57262a92ab8803466e67b188814169931cdb8e63c55ab
c59d
===================================================
HSL| emit CertificateVerify and hash
HSL| emit Finished and hash
KS | ks_server_13_sf hashed_log = 1001b951a6f61e4949cac23e9a99b3fcd21fc26f9158c108e4d8ba3a5ceeb884
KS | application traffic secret[C]:   c8d2b7f7e6dbdf4438e879b789868659e88703e6402729b63b2edd4658f7e94e
KS | application traffic secret[S]:   97e713009cb47bec339d0cc81152a01b6bdbce90bf1c7592f3bc761e489c179a
KS | exporter master secret:          43bde9f4dab10ecb4c66d213bce2c390e788ed0f86dd3966daf90b3f96283753
KS | application key[C]:              c37e8a54584320869b4e1f26f48e2790f0d1aea40a140f30b0860cc28f2a6a21, IV=87da453a1a826e6f838ea1c4
KS | application key[S]:              98a406bdb187a3186cea15929d7a61209e6f3058834affcc7b5a2610eda4b570, IV=e8af119842c901b9de1ede5f
AEP| LowProvider: COERCE(K=98a406bdb187a3186cea15929d7a61209e6f3058834affcc7b5a2610eda4b570)
AEP| LowProvider: COERCE(K=c37e8a54584320869b4e1f26f48e2790f0d1aea40a140f30b0860cc28f2a6a21)
HS | exporting a key
EPO| reader++ 0/0
TLS| HS.next_fragment returned a fragment; next_keys (for all data)
TLS| sendHandshake
TLS| send Handshake fragment with index ID13
TLS| Encrypting with key 6676fb0bedce40ba28fc32f149513b121b0bf270a787ae69373cd6594b744a86
TLS| Sending fragment of length 733
REC| record headers: 17030302dd
EPO| writer++ 0/1
TLS| read: WrittenHS, Ctrl/Open, new writer: writable
server returns server_accept clen=175 slen=833
secret=43bde9f4dab10ecb4c66d213bce2c390e788ed0f86dd3966daf90b3f96283753
<---- ServerHello;(EncryptedExtensions; Certificate; CertVerify; Finished)[ 833]

TLS| writeHandshake (plaintext)
TLS| HS.next_fragment PlaintextID?
HS | next_fragment
TLS| HS.next_fragment returned nothing
TLS| sendHandshake
TLS| read: WrittenHS, Ctrl/Ctrl, nothing
TLS| Read fragment at epoch index: -1 of length 90
TLS| read Handshake fragment
HS | recv_fragment
HSL| parsed ServerHello
HSL| end of flight
HS | client_ServerHello
NGO| processing server extensions [ supported_versions key_share ]
NGO| negotiated 1.3 TLS_CHACHA20_POLY1305_SHA256
HS | Running TLS 1.3
KS | ks_client_13_sh hashed_log = 7ef73d5f3c143620b6f452cf858520b64bc65b238636bce3bf011a9a9f7198b7
KS | no PSK negotiated. Early secret: 33ad0a1c607ec03b09e6cd9893680ce210adf300aa1f2660e1b22e10f170f92a
KS | handshake salt:                  6f2615a108c702c5678f54fc9dbab69716c076189c48250cebeac3576c3611ba
CDH| DH initiator on X255519
KS | DH shared secret: b7b9b6ea9cfbe7a9a600fcc02b4fffda66c108871b13097e8cf1ba930258ef3c
KS | handshake secret:                05dae4b156463998a11330b42ba1c0f14d6e099445e59cf806c63e6798162c92
KS | handshake traffic secret[C]:     4e3907b45b0b5e3cdb396c519bd91d5d227fcdd18fddb0f684b655ae93fb3c01
KS | handshake traffic secret[S]:     73ab38e2bad9185719fcfbf368b51f39b85efdb6089545d1f4ba6ba866646ec4
KS | handshake key[C]:                6766599419ce37c7004082763e4997a2fd8c8895dda3ef02f2af51f86263e031, IV=9528b2726673cfe7322b55a2
KS | handshake key[S]:                6676fb0bedce40ba28fc32f149513b121b0bf270a787ae69373cd6594b744a86, IV=66fb824ba15d643cb79b45e3
KS | finished key[C]: f30eb37693da6ab7c933c0684f06a0b9279fab068ddd4ba325f7007c84f91a20
KS | finished key[S]: 985700b75cd6305421b16a31168ebc6222766ca859377f43674f5a1cf9459e28
KS | application salt:                987a1ff5a2b4c8adf0c809aae0c07eb8268c14e979f2d49b4f0d0492c217043e
KS | application secret:              6b32157282a319410415d0403f8c4329448b30593952fac784361032acc681f5
AEP| LowProvider: COERCE(K=6766599419ce37c7004082763e4997a2fd8c8895dda3ef02f2af51f86263e031)
AEP| LowProvider: COERCE(K=6676fb0bedce40ba28fc32f149513b121b0bf270a787ae69373cd6594b744a86)
EPO| reader++ 0/-1
TLS| readOne ReadAgain
TLS| writeHandshake (plaintext)
TLS| HS.next_fragment PlaintextID?
HS | next_fragment
TLS| HS.next_fragment returned nothing
TLS| sendHandshake
TLS| read: WrittenHS, Ctrl/Ctrl, nothing
TLS| Read fragment at epoch index: 0 of length 733
TLS| StAE decrypt correct.
TLS| read Handshake fragment
HS | recv_fragment
HSL| parsed EncryptedExtensions
HSL| parsed Certificate13
HSL| parsed CertificateVerify
HSL| parsed Finished
HSL| end of flight
NGO| Nego.clientComplete_13
NGO| EE: alpn supported_groups 001a 
NGO| Negotiation callback to process application extensions.
@@@@ Nego callback for TLS 1.3 @@@@
Offered extensions:
001b0010000800060568712d3130000a00040002001d001a0003000102
Transport parameters offered:
000102
No application cookie (fist connection).
Adding server transport parameters:
000102
@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
WARNING: chain validation failed, ignoring.
NGO| Certificate & signature 1.3 callback result: valid
KS | ks_client_13_sf hashed_log = 1001b951a6f61e4949cac23e9a99b3fcd21fc26f9158c108e4d8ba3a5ceeb884
KS | application traffic secret[C]:   c8d2b7f7e6dbdf4438e879b789868659e88703e6402729b63b2edd4658f7e94e
KS | application traffic secret[S]:   97e713009cb47bec339d0cc81152a01b6bdbce90bf1c7592f3bc761e489c179a
KS | exporter master secret:          43bde9f4dab10ecb4c66d213bce2c390e788ed0f86dd3966daf90b3f96283753
KS | application key[C]:              c37e8a54584320869b4e1f26f48e2790f0d1aea40a140f30b0860cc28f2a6a21, IV=87da453a1a826e6f838ea1c4
KS | application key[S]:              98a406bdb187a3186cea15929d7a61209e6f3058834affcc7b5a2610eda4b570, IV=e8af119842c901b9de1ede5f
AEP| LowProvider: COERCE(K=c37e8a54584320869b4e1f26f48e2790f0d1aea40a140f30b0860cc28f2a6a21)
AEP| LowProvider: COERCE(K=98a406bdb187a3186cea15929d7a61209e6f3058834affcc7b5a2610eda4b570)
HS | exporting a key
HS | Early data rejected
EPO| writer++ 0/0
HSL| emit Finished and hash
KS | ks_client_13_cf hashed_log = 8eb3bf4e19dcb9f89f7de59493a6b4b214ee5294f45b0b897ffa86633cd7aec4
KS | resumption master secret:        c7c02a0d379a3c3a2644e19c0596b8e1de603b248484400fd557edd5fd0bc536
EPO| reader++ 1/0
TLS| readOne ReadAgain
TLS| writeHandshake (encrypted)
TLS| HS.next_fragment ID13?
HS | next_fragment
TLS| HS.next_fragment returned a fragment; next_keys (for all data); complete
TLS| sendHandshake
TLS| send Handshake fragment with index ID13
TLS| Encrypting with key 6766599419ce37c7004082763e4997a2fd8c8895dda3ef02f2af51f86263e031
TLS| Sending fragment of length 53
REC| record headers: 1703030035
EPO| writer++ 1/1
TLS| read: WrittenHS, Open/Open, new writer: complete
client returns client_complete clen=58 slen=833
secret=43bde9f4dab10ecb4c66d213bce2c390e788ed0f86dd3966daf90b3f96283753
(Finished) [  58] ---->

TLS| writeHandshake (encrypted)
TLS| HS.next_fragment ID13?
HS | next_fragment
TLS| HS.next_fragment returned nothing
TLS| sendHandshake
TLS| read: WrittenHS, Ctrl/Open, nothing
TLS| Read fragment at epoch index: 0 of length 53
TLS| StAE decrypt correct.
TLS| read Handshake fragment
HS | recv_fragment
HSL| parsed Finished
HSL| end of flight
HS | Process Client Finished
KS | ks_server_13_cf hashed_log = 8eb3bf4e19dcb9f89f7de59493a6b4b214ee5294f45b0b897ffa86633cd7aec4
KS | resumption master secret:        c7c02a0d379a3c3a2644e19c0596b8e1de603b248484400fd557edd5fd0bc536
AEP| LowProvider: COERCE(K=4647e9f912a7611b0376cd47944e859e31c535ceeb6bd908e5e544d72bd8b15c)
HS | Sending ticket: ceb01416e810a644728903933b59e80a6f3af162a04a5511b00dd4860a22043c8ead0318391751be76b773ef67ff8cd9f3575539165f09168be478e8d70ea8e7f2feabb29a84116ddd3eb57a
HSL| emit NewSessionTicket13
EPO| reader++ 1/1
TLS| readOne Complete
server returns server_complete clen=58 slen=0
TLS| writeHandshake (encrypted)
TLS| HS.next_fragment ID13?
HS | next_fragment
TLS| HS.next_fragment returned a fragment
TLS| sendHandshake
TLS| send Handshake fragment with index ID13
TLS| Encrypting with key 98a406bdb187a3186cea15929d7a61209e6f3058834affcc7b5a2610eda4b570
TLS| Sending fragment of length 130
REC| record headers: 1703030082
TLS| writeHandshake (encrypted)
TLS| HS.next_fragment ID13?
HS | next_fragment
TLS| HS.next_fragment returned nothing
TLS| sendHandshake
TLS| read: WrittenHS, Open/Open, nothing
REC| WouldBlock
TLS| readOne ReadWouldBlock
server returns would_block clen=0 slen=135
<---- {Ticket}[ 135]
TLS| writeHandshake (encrypted)
TLS| HS.next_fragment ID13?
HS | next_fragment
TLS| HS.next_fragment returned nothing
TLS| sendHandshake
TLS| read: WrittenHS, Open/Open, nothing
TLS| Read fragment at epoch index: 1 of length 130
TLS| StAE decrypt correct.
TLS| read Handshake fragment
HS | recv_fragment
HSL| parsed NewSessionTicket13
HSL| end of flight
HS | Received ticket: ceb01416e810a644728903933b59e80a6f3af162a04a5511b00dd4860a22043c8ead0318391751be76b773ef67ff8cd9f3575539165f09168be478e8d70ea8e7f2feabb29a84116ddd3eb57a
KS | ks_client_13_rms
KS | Recall RMS: c7c02a0d379a3c3a2644e19c0596b8e1de603b248484400fd557edd5fd0bc536
AEP| LowProvider: COERCE(K=70da2bfcdaddb2adcfb6e7a11d72e80e45bba1282ff4f1a95d45ed030a398332)

##### New session ticket received! #####
Host: localhost
Ticket:
ceb01416e810a644728903933b59e80a6f3af162a04a5511b00dd4860a22043c
8ead0318391751be76b773ef67ff8cd9f3575539165f09168be478e8d70ea8e7
f2feabb29a84116ddd3eb57a
########################################
TLS| readOne ReadAgain
TLS| writeHandshake (encrypted)
TLS| HS.next_fragment ID13?
HS | next_fragment
TLS| HS.next_fragment returned nothing
TLS| sendHandshake
TLS| read: WrittenHS, Open/Open, nothing
REC| WouldBlock
TLS| readOne ReadWouldBlock
client returns clen=0 slen=135 status=would_block

TICKET-BASED RESUMPTION

server create
FFI| offering custom extension 001a
FFI| extension contents: ffff00050a0b0c0d0e
FFI| setting early data limit to ffffffff
FFI| Setting a new ticket callback.
FFI| Setting a new server negotiation callback.
FFI| Setting up certificate callbacks.
client create
FFI| offering custom extension 001a
FFI| extension contents: ffff00050a0b0c0d0e
FFI| setting early data limit to ffffffff
FFI| Setting a new ticket callback.
FFI| Setting a new server negotiation callback.
FFI| Setting up certificate callbacks.
TCK| Decrypting ticket ea5bab3ff3e703a296251ce7fecd93152ce94f0855b0ff7a8f466421bd7d1ecca3680bde290ee1a6b4006f77fab4b41f403520d6af0f85bf1d7ca0fefc67c1cab45cafadcbebaa40cddf87a6
TCK| Parsing ticket 030413035b22e446f3572c8600000020fc1a126764a364dddf13537767427d955438517fa07a387320e6de9997127dad
TLS| writeHandshake (plaintext)
TLS| HS.next_fragment PlaintextID?
HS | next_fragment
HS | offering ClientHello 1.3
KS | ks_client_init 1.3
CDH| Keygen (initiator) on X255519
NGO| Offering a PSK compatible with 0-RTT
NGO| offering client extensions [ 001a supported_versions key_share server_name alpn extended_master_secret signature_algorithms supported_groups psk_key_exchange_modes early_data pre_shared_key ]
NGO| offering cipher suites ; TLS_CHACHA20_POLY1305_SHA256; TLS_AES_128_GCM_SHA256
HSL| emit ClientHello
KS | Loaded pre-shared key ceb01416e810a644728903933b59e80a6f3af162a04a5511b00dd4860a22043c8ead0318391751be76b773ef67ff8cd9f3575539165f09168be478e8d70ea8e7f2feabb29a84116ddd3eb57a: fc1a126764a364dddf13537767427d955438517fa07a387320e6de9997127dad
KS | Early secret: a5f45cb924a1c49e2d13b69afb1204ad28e404aa1020a320a898f164a46767b2
KS | Binder key[res binder]: a4f23e9e4800d8efbd6716236316d343a2f28c5d55b9aa982515e46dc2142153
KS | Binder Finished key: 3b44b040c3ddc5f0d0502383b16581c114d55180d714f234f058c27056cfb96b
HSL| emit Binders
HS | setting up 0RTT
KS | ks_client_13_ch log=f169b9d499e7a5b66b54baf5d1516cc5aabcbf889c80ce349ee4660ff48f1a10
KS | Client early traffic secret:     88b31b46b15648432ba0e7ab7ab8a293354e44a885bd3f8f702a03f0763c892a
KS | Early exporter master secret:    df4015a5686f2ad4c9193987de046918842aed591c8917f903721f394ebd1b81
KS | Client 0-RTT key:                ddeb162c8fd52b4a163cd919c563d551884f9d6c748fbe731341262d3f47cab6, IV=5569773100ad3ed8b0605a0f
AEP| LowProvider: COERCE(K=ddeb162c8fd52b4a163cd919c563d551884f9d6c748fbe731341262d3f47cab6)
HS | exporting a key
TLS| HS.next_fragment returned a fragment; next_keys (for all data)
TLS| sendHandshake
TLS| send Handshake fragment with index PlaintextID
TLS| Sending fragment of length 297
REC| record headers: 1603030129
EPO| writer++ -1/0
TLS| read: WrittenHS, Ctrl/Open, new writer: writable
client returns client_early_data clen=302 slen=0
early secret=df4015a5686f2ad4c9193987de046918842aed591c8917f903721f394ebd1b81
ClientHello[ 302] ---->

TLS| writeHandshake (plaintext)
TLS| HS.next_fragment PlaintextID?
HS | next_fragment
TLS| HS.next_fragment returned nothing
TLS| sendHandshake
TLS| read: WrittenHS, Ctrl/Ctrl, nothing
TLS| Read fragment at epoch index: -1 of length 297
TLS| read Handshake fragment
HS | recv_fragment
HSL| parsed [ClientHello; Binders] -- end of flight 
HS | Processing ClientHello with 1 binder(s)
NGO| offered client extensions [ 001a supported_versions key_share server_name alpn extended_master_secret signature_algorithms supported_groups psk_key_exchange_modes early_data pre_shared_key ]
NGO| offered cipher suites ; TLS_CHACHA20_POLY1305_SHA256; TLS_AES_128_GCM_SHA256
NGO| offered versions 1.3
TCK| Decrypting ticket ceb01416e810a644728903933b59e80a6f3af162a04a5511b00dd4860a22043c8ead0318391751be76b773ef67ff8cd9f3575539165f09168be478e8d70ea8e7f2feabb29a84116ddd3eb57a
TCK| Parsing ticket 030413035b22e446f3572c8600000020c7c02a0d379a3c3a2644e19c0596b8e1de603b248484400fd557edd5fd0bc536
NGO| Negotiated PSK_EDH key exchange
NGO| Negotiation callback to handle extra extensions and query for stateless retry.
NGO| Application data in cookie: none
@@@@ Nego callback for TLS 1.3 @@@@
Offered extensions:
003d001a0009ffff00050a0b0c0d0e0000000e000c0000096c6f63616c686f73
740010000800060568712d3130000d0006000408040403000a00040002001d
Transport parameters offered:
ffff00050a0b0c0d0e
No application cookie (fist connection).
Adding server transport parameters:
000102
@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
NGO| negotiated 1.3 TLS_CHACHA20_POLY1305_SHA256
HS | accepted TLS 1.3 psk #0
KS | ks_server_init
KS | Using negotiated PSK identity: ceb01416e810a644728903933b59e80a6f3af162a04a5511b00dd4860a22043c8ead0318391751be76b773ef67ff8cd9f3575539165f09168be478e8d70ea8e7f2feabb29a84116ddd3eb57a
TCK| Decrypting ticket ceb01416e810a644728903933b59e80a6f3af162a04a5511b00dd4860a22043c8ead0318391751be76b773ef67ff8cd9f3575539165f09168be478e8d70ea8e7f2feabb29a84116ddd3eb57a
TCK| Parsing ticket 030413035b22e446f3572c8600000020c7c02a0d379a3c3a2644e19c0596b8e1de603b248484400fd557edd5fd0bc536
KS | Ticket RMS: c7c02a0d379a3c3a2644e19c0596b8e1de603b248484400fd557edd5fd0bc536
KS | Pre-shared key: fc1a126764a364dddf13537767427d955438517fa07a387320e6de9997127dad
KS | binder key:                      a4f23e9e4800d8efbd6716236316d343a2f28c5d55b9aa982515e46dc2142153
KS | binder Finished key:             3b44b040c3ddc5f0d0502383b16581c114d55180d714f234f058c27056cfb96b
KS | Computed early secret:           a5f45cb924a1c49e2d13b69afb1204ad28e404aa1020a320a898f164a46767b2
KS | Handshake salt:                  89191c40b635ca0fbd15a5c80d0cce338ac78db25af9966ec30b9d88253615d4
CDH| Keygen (responder) on X255519
CDH| DH initiator on X255519
KS | DH shared secret: 6c1e4781a694f238557c0c2a1836aced4dba9b36d6a41762ad954eae8c8dd546
KS | Handshake secret:                ac1c6b6db9532aae8ce748da24165bf98c953247f393c9da8689432114340679
NGO| processing client extensions [ 001a supported_versions key_share server_name alpn extended_master_secret signature_algorithms supported_groups psk_key_exchange_modes early_data pre_shared_key ]
NGO| including server extensions (SH + EE) [ supported_versions key_share alpn supported_groups early_data pre_shared_key ]
NGO| extra extensions from application callback: 001a 
HSL| emit ServerHello and hash
KS | ks_server_13_0rtt_key
KS | Client early traffic secret:     88b31b46b15648432ba0e7ab7ab8a293354e44a885bd3f8f702a03f0763c892a
KS | Early exporter master secret:    df4015a5686f2ad4c9193987de046918842aed591c8917f903721f394ebd1b81
KS | Client 0-RTT key:                ddeb162c8fd52b4a163cd919c563d551884f9d6c748fbe731341262d3f47cab6, IV=5569773100ad3ed8b0605a0f
AEP| LowProvider: COERCE(K=ddeb162c8fd52b4a163cd919c563d551884f9d6c748fbe731341262d3f47cab6)
HS | exporting a key
HS | derive handshake keys
KS | ks_server_13_sh, hashed log = 17875bccf46c1420e41bdc916248bc0d9daaaa1760d9463c0fa12796c7d5ee08
KS | handshake traffic secret[C]:     6a1fccd3353ca8df91af04d09ffb3459f29ef01f2a422adeda92e17f13856f8a
KS | handshake traffic secret[S]:     bd19bfcf0577e91096da35c3ea42bc66b1b4b833d46f3f5a477bf271e5878e10
KS | handshake key[C]:                d5da3383091a5810be9eb0305252d8d4dee50972241f2a3c8fc2b548201a4c13, IV=8ebb011e060b98d53881b104
KS | handshake key[S]: 06bbcb60d59ef1ebc5af983210796eb98829dc0c1f8d503c626234feeb0207b9, IV=cc3ddb4b8c090a244d96fb4d
AEP| LowProvider: COERCE(K=06bbcb60d59ef1ebc5af983210796eb98829dc0c1f8d503c626234feeb0207b9)
AEP| LowProvider: COERCE(K=d5da3383091a5810be9eb0305252d8d4dee50972241f2a3c8fc2b548201a4c13)
KS | finished key[C]:                 5356dd1545f7765f4b36e1005568c8fa136022683d88e68da0f7fc7beab5679a
KS | finished key[S]:                 0fd8f62dfe35a369e3eb743860ec329b8b97e9eb6f9cf25d4fc832ad6a4b0fd2
KS | Application salt:                5f841f7c1dee43938ffb9125f95e5ebc7d6d04ea99a38b117fa264426551d2bf
KS | Application secret:              3e9f7257e4c4689200cdde4059de373f7e2d817f61939d9ae19ebbef1cb84328
TLS| readOne ReadAgain
TLS| writeHandshake (plaintext)
TLS| HS.next_fragment PlaintextID?
HS | next_fragment
TLS| HS.next_fragment returned a fragment; next_keys (for handshake only skipping 0RTT
TLS| sendHandshake
TLS| send Handshake fragment with index PlaintextID
TLS| Sending fragment of length 96
REC| record headers: 1603030060
EPO| writer++ -1/0
EPO| writer++ -1/1
TLS| writeHandshake (encrypted)
TLS| HS.next_fragment ID13?
HS | next_fragment
HS | prepare Server Finished
HSL| emit EncryptedExtensions and hash
HSL| emit Finished and hash
KS | ks_server_13_sf hashed_log = a4262eb02824b9cbff87a4a773c0cbabf4d3f25318c4d33b21aac5b0fc53b7e8
KS | application traffic secret[C]:   7d27c6ebb457bd3d9ac614b00221ed52e9dd5f2fa802271ea5a5e46044f0d43f
KS | application traffic secret[S]:   b75270644329e8efa70889782686d1bf8f7a52fe23d3dc842d13b462a78e10ee
KS | exporter master secret:          fb6cee5415010198c6715c83153f2e53afcda9db2c1e610b30d724fef58451e3
KS | application key[C]:              48de053e0c2ba351d460eaff9ca35f6395d0207ba7a5a61bba6e7e1796eaed65, IV=b1490bf420e331523a2bc384
KS | application key[S]:              f9c86433d255c0d59ae4ae0cbcb8d4f3624ac4970f414f6ea020ff4bcc01ac13, IV=a616254434af5d9b90cd76c3
AEP| LowProvider: COERCE(K=f9c86433d255c0d59ae4ae0cbcb8d4f3624ac4970f414f6ea020ff4bcc01ac13)
AEP| LowProvider: COERCE(K=48de053e0c2ba351d460eaff9ca35f6395d0207ba7a5a61bba6e7e1796eaed65)
HS | exporting a key
EPO| reader++ 0/1
TLS| HS.next_fragment returned a fragment; next_keys (for all data)
TLS| sendHandshake
TLS| send Handshake fragment with index ID13
TLS| Encrypting with key 06bbcb60d59ef1ebc5af983210796eb98829dc0c1f8d503c626234feeb0207b9
TLS| Sending fragment of length 90
REC| record headers: 170303005a
EPO| writer++ 0/2
TLS| read: WrittenHS, Ctrl/Open, new writer: writable
server returns server_accept_early_data clen=302 slen=196
early secret=df4015a5686f2ad4c9193987de046918842aed591c8917f903721f394ebd1b81
secret=fb6cee5415010198c6715c83153f2e53afcda9db2c1e610b30d724fef58451e3
<---- ServerHello;(EncryptedExtensions; Certificate; CertVerify; Finished)[ 196]

TLS| writeHandshake (encrypted)
TLS| HS.next_fragment ID13?
HS | next_fragment
TLS| HS.next_fragment returned nothing
TLS| sendHandshake
TLS| read: WrittenHS, Ctrl/Open, nothing
TLS| Read fragment at epoch index: -1 of length 96
TLS| read Handshake fragment
HS | recv_fragment
HSL| parsed ServerHello
HSL| end of flight
HS | client_ServerHello
NGO| processing server extensions [ supported_versions key_share pre_shared_key ]
NGO| negotiated 1.3 TLS_CHACHA20_POLY1305_SHA256
HS | Running TLS 1.3
KS | ks_client_13_sh hashed_log = 17875bccf46c1420e41bdc916248bc0d9daaaa1760d9463c0fa12796c7d5ee08
KS | recallPSK early secret:          a5f45cb924a1c49e2d13b69afb1204ad28e404aa1020a320a898f164a46767b2
KS | handshake salt:                  89191c40b635ca0fbd15a5c80d0cce338ac78db25af9966ec30b9d88253615d4
CDH| DH initiator on X255519
KS | DH shared secret: 6c1e4781a694f238557c0c2a1836aced4dba9b36d6a41762ad954eae8c8dd546
KS | handshake secret:                ac1c6b6db9532aae8ce748da24165bf98c953247f393c9da8689432114340679
KS | handshake traffic secret[C]:     6a1fccd3353ca8df91af04d09ffb3459f29ef01f2a422adeda92e17f13856f8a
KS | handshake traffic secret[S]:     bd19bfcf0577e91096da35c3ea42bc66b1b4b833d46f3f5a477bf271e5878e10
KS | handshake key[C]:                d5da3383091a5810be9eb0305252d8d4dee50972241f2a3c8fc2b548201a4c13, IV=8ebb011e060b98d53881b104
KS | handshake key[S]:                06bbcb60d59ef1ebc5af983210796eb98829dc0c1f8d503c626234feeb0207b9, IV=cc3ddb4b8c090a244d96fb4d
KS | finished key[C]: 5356dd1545f7765f4b36e1005568c8fa136022683d88e68da0f7fc7beab5679a
KS | finished key[S]: 0fd8f62dfe35a369e3eb743860ec329b8b97e9eb6f9cf25d4fc832ad6a4b0fd2
KS | application salt:                5f841f7c1dee43938ffb9125f95e5ebc7d6d04ea99a38b117fa264426551d2bf
KS | application secret:              3e9f7257e4c4689200cdde4059de373f7e2d817f61939d9ae19ebbef1cb84328
AEP| LowProvider: COERCE(K=d5da3383091a5810be9eb0305252d8d4dee50972241f2a3c8fc2b548201a4c13)
AEP| LowProvider: COERCE(K=06bbcb60d59ef1ebc5af983210796eb98829dc0c1f8d503c626234feeb0207b9)
HS | 0RTT potentially accepted (wait for EE to confirm)
EPO| reader++ 0/0
EPO| reader++ 1/0
TLS| readOne ReadAgain
TLS| writeHandshake (encrypted)
TLS| HS.next_fragment ID13?
HS | next_fragment
TLS| HS.next_fragment returned nothing
TLS| sendHandshake
TLS| read: WrittenHS, Ctrl/Open, nothing
TLS| Read fragment at epoch index: 1 of length 90
TLS| StAE decrypt correct.
TLS| read Handshake fragment
HS | recv_fragment
HSL| parsed EncryptedExtensions
HSL| parsed Finished
HSL| end of flight
NGO| Nego.clientComplete_13
NGO| EE: alpn supported_groups early_data 001a 
NGO| Negotiation callback to process application extensions.
@@@@ Nego callback for TLS 1.3 @@@@
Offered extensions:
001b0010000800060568712d3130000a00040002001d001a0003000102
Transport parameters offered:
000102
No application cookie (fist connection).
Adding server transport parameters:
000102
@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
NGO| Certificate & signature 1.3 callback result: valid
KS | ks_client_13_sf hashed_log = a4262eb02824b9cbff87a4a773c0cbabf4d3f25318c4d33b21aac5b0fc53b7e8
KS | application traffic secret[C]:   7d27c6ebb457bd3d9ac614b00221ed52e9dd5f2fa802271ea5a5e46044f0d43f
KS | application traffic secret[S]:   b75270644329e8efa70889782686d1bf8f7a52fe23d3dc842d13b462a78e10ee
KS | exporter master secret:          fb6cee5415010198c6715c83153f2e53afcda9db2c1e610b30d724fef58451e3
KS | application key[C]:              48de053e0c2ba351d460eaff9ca35f6395d0207ba7a5a61bba6e7e1796eaed65, IV=b1490bf420e331523a2bc384
KS | application key[S]:              f9c86433d255c0d59ae4ae0cbcb8d4f3624ac4970f414f6ea020ff4bcc01ac13, IV=a616254434af5d9b90cd76c3
AEP| LowProvider: COERCE(K=48de053e0c2ba351d460eaff9ca35f6395d0207ba7a5a61bba6e7e1796eaed65)
AEP| LowProvider: COERCE(K=f9c86433d255c0d59ae4ae0cbcb8d4f3624ac4970f414f6ea020ff4bcc01ac13)
HS | exporting a key
HS | Early data accepted; emitting EOED.
HSL| emit EndOfEarlyData and hash
TLS| readOne ReadAgain
TLS| writeHandshake (encrypted)
TLS| HS.next_fragment ID13?
HS | next_fragment
TLS| HS.next_fragment returned a fragment; next_keys (for handshake only
TLS| sendHandshake
TLS| send Handshake fragment with index ID13
TLS| Encrypting with key ddeb162c8fd52b4a163cd919c563d551884f9d6c748fbe731341262d3f47cab6
TLS| Sending fragment of length 21
REC| record headers: 1703030015
EPO| writer++ 1/1
TLS| writeHandshake (encrypted)
TLS| HS.next_fragment ID13?
HS | next_fragment
HSL| emit Finished and hash
KS | ks_client_13_cf hashed_log = f3e267332a2f24f8120f516d5e47bc8641afe04c9e10c0721d8d6a9a5ce06eb9
KS | resumption master secret:        7a1e44866405b9bd2ef0c8903aa782b0866aba380c36035f319b83dcbffde24c
EPO| reader++ 2/1
TLS| HS.next_fragment returned a fragment; next_keys (for all data); complete
TLS| sendHandshake
TLS| send Handshake fragment with index ID13
TLS| Encrypting with key d5da3383091a5810be9eb0305252d8d4dee50972241f2a3c8fc2b548201a4c13
TLS| Sending fragment of length 53
REC| record headers: 1703030035
EPO| writer++ 2/2
TLS| read: WrittenHS, Open/Open, new writer: complete
client returns client_complete_early_data clen=84 slen=196
secret=fb6cee5415010198c6715c83153f2e53afcda9db2c1e610b30d724fef58451e3
(Finished) [  84] ---->

TLS| writeHandshake (encrypted)
TLS| HS.next_fragment ID13?
HS | next_fragment
TLS| HS.next_fragment returned nothing
TLS| sendHandshake
TLS| read: WrittenHS, Ctrl/Open, nothing
TLS| Read fragment at epoch index: 0 of length 21
TLS| StAE decrypt correct.
TLS| read Handshake fragment
HS | recv_fragment
HSL| parsed EndOfEarlyData
HSL| end of flight
HS | Process EOED (increment reader to HS key)
EPO| reader++ 1/2
TLS| readOne ReadAgain
TLS| writeHandshake (encrypted)
TLS| HS.next_fragment ID13?
HS | next_fragment
TLS| HS.next_fragment returned nothing
TLS| sendHandshake
TLS| read: WrittenHS, Ctrl/Open, nothing
TLS| Read fragment at epoch index: 1 of length 53
TLS| StAE decrypt correct.
TLS| read Handshake fragment
HS | recv_fragment
HSL| parsed Finished
HSL| end of flight
HS | Process Client Finished
KS | ks_server_13_cf hashed_log = f3e267332a2f24f8120f516d5e47bc8641afe04c9e10c0721d8d6a9a5ce06eb9
KS | resumption master secret:        7a1e44866405b9bd2ef0c8903aa782b0866aba380c36035f319b83dcbffde24c
HS | Sending ticket: 78b7ee66795d7d7ac8fdff80bac93008290755d236f5444ebe53d7087a6548e747a472e9a7139b643ca7d4b0590503471b423422a7e9b89fe227599a2cccecb65904a668bb6f0f71fe090c44
HSL| emit NewSessionTicket13
EPO| reader++ 2/2
TLS| readOne Complete
server returns clen=84 slen=0 status=server_complete
TLS| writeHandshake (encrypted)
TLS| HS.next_fragment ID13?
HS | next_fragment
TLS| HS.next_fragment returned a fragment
TLS| sendHandshake
TLS| send Handshake fragment with index ID13
TLS| Encrypting with key f9c86433d255c0d59ae4ae0cbcb8d4f3624ac4970f414f6ea020ff4bcc01ac13
TLS| Sending fragment of length 130
REC| record headers: 1703030082
TLS| writeHandshake (encrypted)
TLS| HS.next_fragment ID13?
HS | next_fragment
TLS| HS.next_fragment returned nothing
TLS| sendHandshake
TLS| read: WrittenHS, Open/Open, nothing
REC| WouldBlock
TLS| readOne ReadWouldBlock
server returns would_block clen=0 slen=135
<---- {Ticket}[ 135]
TLS| writeHandshake (encrypted)
TLS| HS.next_fragment ID13?
HS | next_fragment
TLS| HS.next_fragment returned nothing
TLS| sendHandshake
TLS| read: WrittenHS, Open/Open, nothing
TLS| Read fragment at epoch index: 2 of length 130
TLS| StAE decrypt correct.
TLS| read Handshake fragment
HS | recv_fragment
HSL| parsed NewSessionTicket13
HSL| end of flight
HS | Received ticket: 78b7ee66795d7d7ac8fdff80bac93008290755d236f5444ebe53d7087a6548e747a472e9a7139b643ca7d4b0590503471b423422a7e9b89fe227599a2cccecb65904a668bb6f0f71fe090c44
KS | ks_client_13_rms
KS | Recall RMS: 7a1e44866405b9bd2ef0c8903aa782b0866aba380c36035f319b83dcbffde24c

##### New session ticket received! #####
Host: localhost
Ticket:
78b7ee66795d7d7ac8fdff80bac93008290755d236f5444ebe53d7087a6548e7
47a472e9a7139b643ca7d4b0590503471b423422a7e9b89fe227599a2cccecb6
5904a668bb6f0f71fe090c44
########################################
TLS| readOne ReadAgain
TLS| writeHandshake (encrypted)
TLS| HS.next_fragment ID13?
HS | next_fragment
TLS| HS.next_fragment returned nothing
TLS| sendHandshake
TLS| read: WrittenHS, Open/Open, nothing
REC| WouldBlock
TLS| readOne ReadWouldBlock
client returns clen=0 slen=135 status=would_block
Ok
./quic.exe hrr

STATELESS RETRY TEST

server create
FFI| offering custom extension 001a
FFI| extension contents: ffff00050a0b0c0d0e
FFI| setting early data limit to ffffffff
FFI| Setting a new ticket callback.
FFI| Setting a new server negotiation callback.
FFI| Setting up certificate callbacks.
client create
FFI| offering custom extension 001a
FFI| extension contents: ffff00050a0b0c0d0e
FFI| setting early data limit to ffffffff
FFI| Setting a new ticket callback.
FFI| Setting a new server negotiation callback.
FFI| Setting up certificate callbacks.
TLS| writeHandshake (plaintext)
TLS| HS.next_fragment PlaintextID?
HS | next_fragment
HS | offering ClientHello 1.3
KS | ks_client_init 1.3
CDH| Keygen (initiator) on X255519
NGO| No PSK or 0-RTT disabled
NGO| offering client extensions [ 001a supported_versions key_share server_name alpn extended_master_secret signature_algorithms supported_groups psk_key_exchange_modes ]
NGO| offering cipher suites ; TLS_CHACHA20_POLY1305_SHA256; TLS_AES_128_GCM_SHA256
HSL| emit ClientHello
TLS| HS.next_fragment returned a fragment
TLS| sendHandshake
TLS| send Handshake fragment with index PlaintextID
TLS| Sending fragment of length 170
REC| record headers: 16030300aa
TLS| writeHandshake (plaintext)
TLS| HS.next_fragment PlaintextID?
HS | next_fragment
TLS| HS.next_fragment returned nothing
TLS| sendHandshake
TLS| read: WrittenHS, Ctrl/Ctrl, nothing
REC| WouldBlock
TLS| readOne ReadWouldBlock
client returns would_block clen=175 slen=0
ClientHello[ 175] ---->

~~~~~~~~~ Client Hello Summary ~~~~~~~~~~~
~ SNI = localhost
~ ALPN = 00060568712d3130
~ Cookie = NULL
~ Extensions = 0079001a0009ffff00050a0b0c0d0e002b0003027f1c003300260024001d0020
db42a0bc233d99ab588e0872077f389a7cc11e030d7efad5fbb06a16986c9f65
0000000e000c0000096c6f63616c686f73740010000800060568712d31300017
0000000d0006000408040403000a00040002001d002d0003020001
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
TLS| writeHandshake (plaintext)
TLS| HS.next_fragment PlaintextID?
HS | next_fragment
TLS| HS.next_fragment returned nothing
TLS| sendHandshake
TLS| read: WrittenHS, Ctrl/Ctrl, nothing
TLS| Read fragment at epoch index: -1 of length 170
TLS| read Handshake fragment
HS | recv_fragment
HSL| parsed [ClientHello] -- end of flight 
HS | Processing ClientHello
NGO| offered client extensions [ 001a supported_versions key_share server_name alpn extended_master_secret signature_algorithms supported_groups psk_key_exchange_modes ]
NGO| offered cipher suites ; TLS_CHACHA20_POLY1305_SHA256; TLS_AES_128_GCM_SHA256
NGO| offered versions 1.3
NGO| Negotiated Pure EDH key exchange
NGO| Negotiated ECDSA_SECP256R1_SHA256
NGO| Negotiation callback to handle extra extensions and query for stateless retry.
NGO| Application data in cookie: none
@@@@ Nego callback for TLS 1.3 @@@@
Offered extensions:
003d001a0009ffff00050a0b0c0d0e0000000e000c0000096c6f63616c686f73
740010000800060568712d3130000d0006000408040403000a00040002001d
Transport parameters offered:
ffff00050a0b0c0d0e
No application cookie (fist connection).
Adding server transport parameters:
000102
@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
AEP| LowProvider: COERCE(K=a2e2a3c831847799eba4b67af02fd54961265d0134b8e0ad250860a1d8b8672f)
TCK| Encrypting cookie: 0000320200002e0303cf21ad74e59a6111be1d8c021e65b891c2a211167abb8c5e079e09e2c8a8339c001303000006002b00027f1c207207c134344e2c40f429e1e38be6be8380949d8f6d6357f4c71da21327709ad0000b48656c6c6f20576f726c64
TCK| Encrypted cookie:  f3228dae65637082341d97a7a8ed7fead1fc9be1d910e4a26b03f73cc91163dafaaa86cb21053e7dd94ae530743212bc2044921fe7e545a54dc48fc1366b4c1693a8f611d79c430baad623a49f15202680169db836d23836ce30b8a774e24d8a78f049273945d97bc8a9e0b4a680100a50d9051808e2cfdd94b73ed5f7db8f
HSL| emit HelloRetryRequest
TLS| readOne ReadAgain
TLS| writeHandshake (plaintext)
TLS| HS.next_fragment PlaintextID?
HS | next_fragment
TLS| HS.next_fragment returned a fragment
TLS| sendHandshake
TLS| send Handshake fragment with index PlaintextID
TLS| Sending fragment of length 183
REC| record headers: 16030300b7
TLS| writeHandshake (plaintext)
TLS| HS.next_fragment PlaintextID?
HS | next_fragment
TLS| HS.next_fragment returned nothing
TLS| sendHandshake
TLS| read: WrittenHS, Ctrl/Ctrl, nothing
REC| WouldBlock
TLS| readOne ReadWouldBlock
server returns server_stateless_retry clen=175 slen=188
<---- HRR[ 188]

server re-create
FFI| offering custom extension 001a
FFI| extension contents: ffff00050a0b0c0d0e
FFI| setting early data limit to ffffffff
FFI| Setting a new ticket callback.
FFI| Setting a new server negotiation callback.
FFI| Setting up certificate callbacks.
TLS| writeHandshake (plaintext)
TLS| HS.next_fragment PlaintextID?
HS | next_fragment
TLS| HS.next_fragment returned nothing
TLS| sendHandshake
TLS| read: WrittenHS, Ctrl/Ctrl, nothing
TLS| Read fragment at epoch index: -1 of length 183
TLS| read Handshake fragment
HS | recv_fragment
HSL| parsed HelloRetryRequest
HSL| end of flight
HSL| Replacing CH1 in transcript with fe0000207207c134344e2c40f429e1e38be6be8380949d8f6d6357f4c71da21327709ad0
HSL| HRR bytes: 020000b30303cf21ad74e59a6111be1d8c021e65b891c2a211167abb8c5e079e09e2c8a8339c00130300008b002c0081007ff3228dae65637082341d97a7a8ed7fead1fc9be1d910e4a26b03f73cc91163dafaaa86cb21053e7dd94ae530743212bc2044921fe7e545a54dc48fc1366b4c1693a8f611d79c430baad623a49f15202680169db836d23836ce30b8a774e24d8a78f049273945d97bc8a9e0b4a680100a50d9051808e2cfdd94b73ed5f7db8f002b00027f1c
HS | client_HelloRetryRequest
HS | Server did not specify a group in HRR, re-using the previous choice
NGO| Got HRR, extensions: [cookie supported_versions ]
HSL| emit ClientHello
TLS| readOne ReadAgain
TLS| writeHandshake (plaintext)
TLS| HS.next_fragment PlaintextID?
HS | next_fragment
TLS| HS.next_fragment returned a fragment
TLS| sendHandshake
TLS| send Handshake fragment with index PlaintextID
TLS| Sending fragment of length 303
REC| record headers: 160303012f
TLS| writeHandshake (plaintext)
TLS| HS.next_fragment PlaintextID?
HS | next_fragment
TLS| HS.next_fragment returned nothing
TLS| sendHandshake
TLS| read: WrittenHS, Ctrl/Ctrl, nothing
REC| WouldBlock
TLS| readOne ReadWouldBlock
client returns would_block clen=308 slen=188
ClientHello2[ 308] ---->

TCK| Decrypting cookie f3228dae65637082341d97a7a8ed7fead1fc9be1d910e4a26b03f73cc91163dafaaa86cb21053e7dd94ae530743212bc2044921fe7e545a54dc48fc1366b4c1693a8f611d79c430baad623a49f15202680169db836d23836ce30b8a774e24d8a78f049273945d97bc8a9e0b4a680100a50d9051808e2cfdd94b73ed5f7db8f
TCK| Plain cookie: 0000320200002e0303cf21ad74e59a6111be1d8c021e65b891c2a211167abb8c5e079e09e2c8a8339c001303000006002b00027f1c207207c134344e2c40f429e1e38be6be8380949d8f6d6357f4c71da21327709ad0000b48656c6c6f20576f726c64
~~~~~~~~~ Client Hello Summary ~~~~~~~~~~~
~ SNI = localhost
~ ALPN = 00060568712d3130
~ Cookie = 48656c6c6f20576f726c64
~ Extensions = 00fe002c0081007ff3228dae65637082341d97a7a8ed7fead1fc9be1d910e4a2
6b03f73cc91163dafaaa86cb21053e7dd94ae530743212bc2044921fe7e545a5
4dc48fc1366b4c1693a8f611d79c430baad623a49f15202680169db836d23836
ce30b8a774e24d8a78f049273945d97bc8a9e0b4a680100a50d9051808e2cfdd
94b73ed5f7db8f001a0009ffff00050a0b0c0d0e002b0003027f1c0033002600
24001d0020db42a0bc233d99ab588e0872077f389a7cc11e030d7efad5fbb06a
16986c9f650000000e000c0000096c6f63616c686f7374001000080006056871
2d313000170000000d0006000408040403000a00040002001d002d0003020001
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
TLS| writeHandshake (plaintext)
TLS| HS.next_fragment PlaintextID?
HS | next_fragment
TLS| HS.next_fragment returned nothing
TLS| sendHandshake
TLS| read: WrittenHS, Ctrl/Ctrl, nothing
TLS| Read fragment at epoch index: -1 of length 303
TLS| read Handshake fragment
HS | recv_fragment
HSL| parsed [ClientHello] -- end of flight 
HS | Processing ClientHello
NGO| offered client extensions [ cookie 001a supported_versions key_share server_name alpn extended_master_secret signature_algorithms supported_groups psk_key_exchange_modes ]
NGO| offered cipher suites ; TLS_CHACHA20_POLY1305_SHA256; TLS_AES_128_GCM_SHA256
NGO| offered versions 1.3
NGO| Negotiated Pure EDH key exchange
NGO| Negotiated ECDSA_SECP256R1_SHA256
TCK| Decrypting cookie f3228dae65637082341d97a7a8ed7fead1fc9be1d910e4a26b03f73cc91163dafaaa86cb21053e7dd94ae530743212bc2044921fe7e545a54dc48fc1366b4c1693a8f611d79c430baad623a49f15202680169db836d23836ce30b8a774e24d8a78f049273945d97bc8a9e0b4a680100a50d9051808e2cfdd94b73ed5f7db8f
TCK| Plain cookie: 0000320200002e0303cf21ad74e59a6111be1d8c021e65b891c2a211167abb8c5e079e09e2c8a8339c001303000006002b00027f1c207207c134344e2c40f429e1e38be6be8380949d8f6d6357f4c71da21327709ad0000b48656c6c6f20576f726c64
NGO| Loaded stateless retry cookie f3228dae65637082341d97a7a8ed7fead1fc9be1d910e4a26b03f73cc91163dafaaa86cb21053e7dd94ae530743212bc2044921fe7e545a54dc48fc1366b4c1693a8f611d79c430baad623a49f15202680169db836d23836ce30b8a774e24d8a78f049273945d97bc8a9e0b4a680100a50d9051808e2cfdd94b73ed5f7db8f
NGO| Overwriting the transcript digest with CH1 hash 7207c134344e2c40f429e1e38be6be8380949d8f6d6357f4c71da21327709ad0
HSL| Installing prefix to transcript: fe0000207207c134344e2c40f429e1e38be6be8380949d8f6d6357f4c71da21327709ad0
HSL| HRR bytes: 020000b30303cf21ad74e59a6111be1d8c021e65b891c2a211167abb8c5e079e09e2c8a8339c00130300008b002c0081007ff3228dae65637082341d97a7a8ed7fead1fc9be1d910e4a26b03f73cc91163dafaaa86cb21053e7dd94ae530743212bc2044921fe7e545a54dc48fc1366b4c1693a8f611d79c430baad623a49f15202680169db836d23836ce30b8a774e24d8a78f049273945d97bc8a9e0b4a680100a50d9051808e2cfdd94b73ed5f7db8f002b00027f1c
NGO| Negotiation callback to handle extra extensions and query for stateless retry.
NGO| Application data in cookie: 48656c6c6f20576f726c64
@@@@ Nego callback for TLS 1.3 @@@@
Offered extensions:
003d001a0009ffff00050a0b0c0d0e0000000e000c0000096c6f63616c686f73
740010000800060568712d3130000d0006000408040403000a00040002001d
Transport parameters offered:
ffff00050a0b0c0d0e
Stateless cookie found, application contents:
48656c6c6f20576f726c64
Adding server transport parameters:
000102
@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
NGO| negotiated 1.3 TLS_CHACHA20_POLY1305_SHA256
KS | ks_server_init
KS | No PSK selected.
KS | Computed early secret:           33ad0a1c607ec03b09e6cd9893680ce210adf300aa1f2660e1b22e10f170f92a
KS | Handshake salt:                  6f2615a108c702c5678f54fc9dbab69716c076189c48250cebeac3576c3611ba
CDH| Keygen (responder) on X255519
CDH| DH initiator on X255519
KS | DH shared secret: aae14c06e865cf57769dc14ea47d0bd7e07b788d8bdd407583297a54c80d2d23
KS | Handshake secret:                078bdfa52fa87c98f2c9c3399a411f57d8c56cd58a4054a356e038f6f235c7a3
NGO| processing client extensions [ cookie 001a supported_versions key_share server_name alpn extended_master_secret signature_algorithms supported_groups psk_key_exchange_modes ]
NGO| including server extensions (SH + EE) [ supported_versions key_share alpn supported_groups ]
NGO| extra extensions from application callback: 001a 
HSL| emit ServerHello and hash
HS | derive handshake keys
KS | ks_server_13_sh, hashed log = 1d11b9224fd82f27996322e51092813ffb1ca36f34d34720a4f88102a88d7bc4
KS | handshake traffic secret[C]:     6e92991e77b64d07eb07c483da551b2d4bbd0fa5605d277e41521827f5b85555
KS | handshake traffic secret[S]:     dd34b1cdcc58c96922dc1364c0426efe9d6220d7ab9e668e2fea2c495d028444
KS | handshake key[C]:                e5f22c4758d9d3224b614486073df7b23ad5174266f0e7828b7b1d0444bdad56, IV=25ac5ffa62c2a82d7eeeddf8
KS | handshake key[S]: 98f13b4bf0d1b6568a6c9fe266bb905b43e5a44aa69c3035a634bc764a2ece09, IV=2714b8a688f0a5e134ee480c
AEP| LowProvider: COERCE(K=98f13b4bf0d1b6568a6c9fe266bb905b43e5a44aa69c3035a634bc764a2ece09)
AEP| LowProvider: COERCE(K=e5f22c4758d9d3224b614486073df7b23ad5174266f0e7828b7b1d0444bdad56)
KS | finished key[C]:                 b2f9e2420b880c61ffde854888093530d03740d631070912ed33221617bf410b
KS | finished key[S]:                 0b48dea895b3a1894d6ef0d6d311bef4844c5a8e86cf66746d956a46515dab65
KS | Application salt:                4cdf2b3e37a9c45f46f44a048c7bed15bbc7bc61b2a11c07dafd082c089d0ec4
KS | Application secret:              5502ea8cdd1eb00ca893f87dc2480b82b119d5ce52050cd80249c758b13b2f12
TLS| readOne ReadAgain
TLS| writeHandshake (plaintext)
TLS| HS.next_fragment PlaintextID?
HS | next_fragment
TLS| HS.next_fragment returned a fragment; next_keys (for handshake only
TLS| sendHandshake
TLS| send Handshake fragment with index PlaintextID
TLS| Sending fragment of length 90
REC| record headers: 160303005a
EPO| writer++ -1/0
TLS| writeHandshake (encrypted)
TLS| HS.next_fragment ID13?
HS | next_fragment
HS | prepare Server Finished
HSL| emit EncryptedExtensions
HSL| emit Certificate13 and hash
======== TO BE SIGNED <0403>: (130 octets) ========
2020202020202020202020202020202020202020202020202020202020202020
2020202020202020202020202020202020202020202020202020202020202020
544c5320312e332c207365727665722043657274696669636174655665726966
79002f8d6689336c45c2cb8edfe57bc9319d9ccbede041c187f4b6242ccab232
31ca
===================================================
HSL| emit CertificateVerify and hash
HSL| emit Finished and hash
KS | ks_server_13_sf hashed_log = 6d2f49a0529010d4c8c8721e2516c912c55db1656b25e9b6ec353b14f04db682
KS | application traffic secret[C]:   1ce5e64ee667b85d2a3fdb51e5e97aeeac8952bb09a7ac60301ee93c38266cd4
KS | application traffic secret[S]:   43b7d1d465d42712bdca7cb8bfb4a9cd1b06fbbfb56cc0fac077c44cb31e234c
KS | exporter master secret:          1d5f171e122c645afb1ab8622211dd64dae5c0128f457514872384ff74611dab
KS | application key[C]:              930b657b39c6df934df3109030deb181652630429c0e186c3a025880fbbe1434, IV=ca271bd52c760d9a71e63a13
KS | application key[S]:              aeeff33e5d71c2a6befe6818e0339426d31edc2e103329121f213d56a92f6ad0, IV=61dacbbb0cd66b84f96d8ade
AEP| LowProvider: COERCE(K=aeeff33e5d71c2a6befe6818e0339426d31edc2e103329121f213d56a92f6ad0)
AEP| LowProvider: COERCE(K=930b657b39c6df934df3109030deb181652630429c0e186c3a025880fbbe1434)
HS | exporting a key
EPO| reader++ 0/0
TLS| HS.next_fragment returned a fragment; next_keys (for all data)
TLS| sendHandshake
TLS| send Handshake fragment with index ID13
TLS| Encrypting with key 98f13b4bf0d1b6568a6c9fe266bb905b43e5a44aa69c3035a634bc764a2ece09
TLS| Sending fragment of length 735
REC| record headers: 17030302df
EPO| writer++ 0/1
TLS| read: WrittenHS, Ctrl/Open, new writer: writable
server returns server_accept clen=308 slen=835
secret=1d5f171e122c645afb1ab8622211dd64dae5c0128f457514872384ff74611dab
<---- ServerHello;(EncryptedExtensions; Certificate; CertVerify; Finished)[ 835]

TLS| writeHandshake (plaintext)
TLS| HS.next_fragment PlaintextID?
HS | next_fragment
TLS| HS.next_fragment returned nothing
TLS| sendHandshake
TLS| read: WrittenHS, Ctrl/Ctrl, nothing
TLS| Read fragment at epoch index: -1 of length 90
TLS| read Handshake fragment
HS | recv_fragment
HSL| parsed ServerHello
HSL| end of flight
HS | client_ServerHello
NGO| processing server extensions [ supported_versions key_share ]
NGO| negotiated 1.3 TLS_CHACHA20_POLY1305_SHA256
HS | Running TLS 1.3
KS | ks_client_13_sh hashed_log = 1d11b9224fd82f27996322e51092813ffb1ca36f34d34720a4f88102a88d7bc4
KS | no PSK negotiated. Early secret: 33ad0a1c607ec03b09e6cd9893680ce210adf300aa1f2660e1b22e10f170f92a
KS | handshake salt:                  6f2615a108c702c5678f54fc9dbab69716c076189c48250cebeac3576c3611ba
CDH| DH initiator on X255519
KS | DH shared secret: aae14c06e865cf57769dc14ea47d0bd7e07b788d8bdd407583297a54c80d2d23
KS | handshake secret:                078bdfa52fa87c98f2c9c3399a411f57d8c56cd58a4054a356e038f6f235c7a3
KS | handshake traffic secret[C]:     6e92991e77b64d07eb07c483da551b2d4bbd0fa5605d277e41521827f5b85555
KS | handshake traffic secret[S]:     dd34b1cdcc58c96922dc1364c0426efe9d6220d7ab9e668e2fea2c495d028444
KS | handshake key[C]:                e5f22c4758d9d3224b614486073df7b23ad5174266f0e7828b7b1d0444bdad56, IV=25ac5ffa62c2a82d7eeeddf8
KS | handshake key[S]:                98f13b4bf0d1b6568a6c9fe266bb905b43e5a44aa69c3035a634bc764a2ece09, IV=2714b8a688f0a5e134ee480c
KS | finished key[C]: b2f9e2420b880c61ffde854888093530d03740d631070912ed33221617bf410b
KS | finished key[S]: 0b48dea895b3a1894d6ef0d6d311bef4844c5a8e86cf66746d956a46515dab65
KS | application salt:                4cdf2b3e37a9c45f46f44a048c7bed15bbc7bc61b2a11c07dafd082c089d0ec4
KS | application secret:              5502ea8cdd1eb00ca893f87dc2480b82b119d5ce52050cd80249c758b13b2f12
AEP| LowProvider: COERCE(K=e5f22c4758d9d3224b614486073df7b23ad5174266f0e7828b7b1d0444bdad56)
AEP| LowProvider: COERCE(K=98f13b4bf0d1b6568a6c9fe266bb905b43e5a44aa69c3035a634bc764a2ece09)
EPO| reader++ 0/-1
TLS| readOne ReadAgain
TLS| writeHandshake (plaintext)
TLS| HS.next_fragment PlaintextID?
HS | next_fragment
TLS| HS.next_fragment returned nothing
TLS| sendHandshake
TLS| read: WrittenHS, Ctrl/Ctrl, nothing
TLS| Read fragment at epoch index: 0 of length 735
TLS| StAE decrypt correct.
TLS| read Handshake fragment
HS | recv_fragment
HSL| parsed EncryptedExtensions
HSL| parsed Certificate13
HSL| parsed CertificateVerify
HSL| parsed Finished
HSL| end of flight
NGO| Nego.clientComplete_13
NGO| EE: alpn supported_groups 001a 
NGO| Negotiation callback to process application extensions.
@@@@ Nego callback for TLS 1.3 @@@@
Offered extensions:
001b0010000800060568712d3130000a00040002001d001a0003000102
Transport parameters offered:
000102
No application cookie (fist connection).
Adding server transport parameters:
000102
@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
WARNING: chain validation failed, ignoring.
NGO| Certificate & signature 1.3 callback result: valid
KS | ks_client_13_sf hashed_log = 6d2f49a0529010d4c8c8721e2516c912c55db1656b25e9b6ec353b14f04db682
KS | application traffic secret[C]:   1ce5e64ee667b85d2a3fdb51e5e97aeeac8952bb09a7ac60301ee93c38266cd4
KS | application traffic secret[S]:   43b7d1d465d42712bdca7cb8bfb4a9cd1b06fbbfb56cc0fac077c44cb31e234c
KS | exporter master secret:          1d5f171e122c645afb1ab8622211dd64dae5c0128f457514872384ff74611dab
KS | application key[C]:              930b657b39c6df934df3109030deb181652630429c0e186c3a025880fbbe1434, IV=ca271bd52c760d9a71e63a13
KS | application key[S]:              aeeff33e5d71c2a6befe6818e0339426d31edc2e103329121f213d56a92f6ad0, IV=61dacbbb0cd66b84f96d8ade
AEP| LowProvider: COERCE(K=930b657b39c6df934df3109030deb181652630429c0e186c3a025880fbbe1434)
AEP| LowProvider: COERCE(K=aeeff33e5d71c2a6befe6818e0339426d31edc2e103329121f213d56a92f6ad0)
HS | exporting a key
HS | Early data rejected
EPO| writer++ 0/0
HSL| emit Finished and hash
KS | ks_client_13_cf hashed_log = ef7ac987aad3c3df0c726e404deaf88fd9a5a7e0f5d2b9aa2c9514fc5c52dc3a
KS | resumption master secret:        e51e6f3155ec2c0a1c6b4998dfbdb1e22c1dab26d76f13431665b9d22bfb97ef
EPO| reader++ 1/0
TLS| readOne ReadAgain
TLS| writeHandshake (encrypted)
TLS| HS.next_fragment ID13?
HS | next_fragment
TLS| HS.next_fragment returned a fragment; next_keys (for all data); complete
TLS| sendHandshake
TLS| send Handshake fragment with index ID13
TLS| Encrypting with key e5f22c4758d9d3224b614486073df7b23ad5174266f0e7828b7b1d0444bdad56
TLS| Sending fragment of length 53
REC| record headers: 1703030035
EPO| writer++ 1/1
TLS| read: WrittenHS, Open/Open, new writer: complete
client returns client_complete clen=58 slen=835
secret=1d5f171e122c645afb1ab8622211dd64dae5c0128f457514872384ff74611dab
(Finished) [  58] ---->

TLS| writeHandshake (encrypted)
TLS| HS.next_fragment ID13?
HS | next_fragment
TLS| HS.next_fragment returned nothing
TLS| sendHandshake
TLS| read: WrittenHS, Ctrl/Open, nothing
TLS| Read fragment at epoch index: 0 of length 53
TLS| StAE decrypt correct.
TLS| read Handshake fragment
HS | recv_fragment
HSL| parsed Finished
HSL| end of flight
HS | Process Client Finished
KS | ks_server_13_cf hashed_log = ef7ac987aad3c3df0c726e404deaf88fd9a5a7e0f5d2b9aa2c9514fc5c52dc3a
KS | resumption master secret:        e51e6f3155ec2c0a1c6b4998dfbdb1e22c1dab26d76f13431665b9d22bfb97ef
HS | Sending ticket: 482a0428dc04b79bf768fcc7ae2a4cdef3276a9a9e9e3186bee5830a7d0fa35f0108b00207865c6c9edf44c4466acdaea98c94c3a0f1004b49f9d8f0e9e29a2f3fac156c26d1f4094fdf20d0
HSL| emit NewSessionTicket13
EPO| reader++ 1/1
TLS| readOne Complete
server returns server_complete clen=58 slen=0
TLS| writeHandshake (encrypted)
TLS| HS.next_fragment ID13?
HS | next_fragment
TLS| HS.next_fragment returned a fragment
TLS| sendHandshake
TLS| send Handshake fragment with index ID13
TLS| Encrypting with key aeeff33e5d71c2a6befe6818e0339426d31edc2e103329121f213d56a92f6ad0
TLS| Sending fragment of length 130
REC| record headers: 1703030082
TLS| writeHandshake (encrypted)
TLS| HS.next_fragment ID13?
HS | next_fragment
TLS| HS.next_fragment returned nothing
TLS| sendHandshake
TLS| read: WrittenHS, Open/Open, nothing
REC| WouldBlock
TLS| readOne ReadWouldBlock
server returns would_block clen=0 slen=135
<---- {Ticket}[ 135]
TLS| writeHandshake (encrypted)
TLS| HS.next_fragment ID13?
HS | next_fragment
TLS| HS.next_fragment returned nothing
TLS| sendHandshake
TLS| read: WrittenHS, Open/Open, nothing
TLS| Read fragment at epoch index: 1 of length 130
TLS| StAE decrypt correct.
TLS| read Handshake fragment
HS | recv_fragment
HSL| parsed NewSessionTicket13
HSL| end of flight
HS | Received ticket: 482a0428dc04b79bf768fcc7ae2a4cdef3276a9a9e9e3186bee5830a7d0fa35f0108b00207865c6c9edf44c4466acdaea98c94c3a0f1004b49f9d8f0e9e29a2f3fac156c26d1f4094fdf20d0
KS | ks_client_13_rms
KS | Recall RMS: e51e6f3155ec2c0a1c6b4998dfbdb1e22c1dab26d76f13431665b9d22bfb97ef
AEP| LowProvider: COERCE(K=e8ea3e9b7110a0aaf5fd0857dd7dd1854d05166e93f7afb1b9e1e4841c9ef243)

##### New session ticket received! #####
Host: localhost
Ticket:
482a0428dc04b79bf768fcc7ae2a4cdef3276a9a9e9e3186bee5830a7d0fa35f
0108b00207865c6c9edf44c4466acdaea98c94c3a0f1004b49f9d8f0e9e29a2f
3fac156c26d1f4094fdf20d0
########################################
TLS| readOne ReadAgain
TLS| writeHandshake (encrypted)
TLS| HS.next_fragment ID13?
HS | next_fragment
TLS| HS.next_fragment returned nothing
TLS| sendHandshake
TLS| read: WrittenHS, Open/Open, nothing
REC| WouldBlock
TLS| readOne ReadWouldBlock
client returns clen=0 slen=135 status=would_block
Ok
================================================================================
