This is /home/everbld/everest-ci/ci
Working directory: /cygdrive/c/build/agent1/_work/6/s
About to run: ./everest --yes -j 16 test
BUILD_SOURCEBRANCHNAME: quic2c
BUILD_DEFINITIONNAME: Everest-CI-Windows
BUILD_BUILDID: 20300
DEFINITIONNAME:
Z3 is /home/everbld/everest/z3-4.5.1.1f29cebd4df6-x64-win/bin/z3
# Switching to the everest directory ... now in /cygdrive/c/build/agent1/_work/6/s

exported FSTAR_HOME=C:/build/agent1/_work/6/s/FStar
exported OPENSSL_HOME=C:/build/agent1/_work/6/s/MLCrypto/openssl
exported KREMLIN_HOME=C:/build/agent1/_work/6/s/kremlin
exported VALE_HOME=C:/build/agent1/_work/6/s/vale
exported HACL_HOME=C:/build/agent1/_work/6/s/hacl-star
exported MLCRYPTO_HOME=C:/build/agent1/_work/6/s/MLCrypto
exported PATH=/cygdrive/c/build/agent1/_work/6/s/MLCrypto/openssl:/cygdrive/c/build/agent1/_work/6/s/FStar/bin:/cygdrive/c/build/agent1/_work/6/s/kremlin:/home/everbld/.opam/4.05.0+mingw64c/bin:/cygdrive/c/Windows/Microsoft.NET/Framework64/v4.0.30319/:/home/everbld/everest/nuget/bin:/home/everbld/everest/z3-4.5.1.1f29cebd4df6-x64-win/bin:/cygdrive/c/PROGRA~2/MICROS~1.0/VC/bin/amd64:/cygdrive/c/PROGRA~2/MICROS~1.0/VC/bin:/cygdrive/c/PROGRA~2/MICROS~4/F#/4.0/FRAMEW~1/v4.0/:/usr/x86_64-w64-mingw32/sys-root/mingw/bin:/usr/local/bin:/usr/bin:/cygdrive/c/build/agent1/externals/git/cmd:/cygdrive/c/Python36/Scripts:/cygdrive/c/Python36:/cygdrive/c/Docker/Resources/bin:/cygdrive/c/windows/system32:/cygdrive/c/windows:/cygdrive/c/windows/System32/Wbem:/cygdrive/c/windows/System32/WindowsPowerShell/v1.0:/cygdrive/c/Users/everbld/AppData/Local/Microsoft/WindowsApps:/cygdrive/c/Program Files/Docker/Docker/resources/bin:%USERPROFILE%/.dnx/bin:/cygdrive/c/Program Files/Microsoft DNX/Dnvm:/cygdrive/c/Program Files/Microsoft SQL Server/120/Tools/Binn:/cygdrive/c/Program Files/Microsoft SQL Server/130/Tools/Binn:/cygdrive/c/Program Files/dotnet:/cygdrive/c/Program Files/nodejs:/usr/bin:/cygdrive/c/Program Files/Git/mingw64/bin:/cygdrive/c/Users/everbld/AppData/Roaming/npm:/cygdrive/c/build/agent1/bin:/cygdrive/c/build/agent1/bin
+ hacl-star/secure_api/out/vale_aes_concrete_id/krml-test.exe
================================================================================
Running tests (commands shown below)
test()
[test] expected output cipher is d31a8d34648e60db7b86afbc53ef7ec2a4aded51296e08fea9e2b5a736ee62d63dbea45e8ca9671282fafb69da92728b1a71de0a9e060b2905d6a5b67ecd3b3692ddbd7f2d778b8c9803aee328091b58fab324e4fad675945585808b4831d7bc3ff4def08e4b7a9de576d26586cec64b61161ae10b594f09e26a7e902ecbd0600691
+ hacl-star/secure_api/out/hacl_aes_concrete_id/krml-test.exe
[test] computed output cipher is d31a8d34648e60db7b86afbc53ef7ec2a4aded51296e08fea9e2b5a736ee62d63dbea45e8ca9671282fafb69da92728b1a71de0a9e060b2905d6a5b67ecd3b3692ddbd7f2d778b8c9803aee328091b58fab324e4fad675945585808b4831d7bc3ff4def08e4b7a9de576d26586cec64b61161ae10b594f09e26a7e902ecbd0600691
[test] cipher is a success
[test] expected output decryption is 4c616469657320616e642047656e746c656d656e206f662074686520636c617373206f66202739393a204966204920636f756c64206f6666657220796f75206f6e6c79206f6e652074697020666f7220746865206675747572652c2073756e73637265656e20776f756c642062652069742e
[test] computed output decryption is 4c616469657320616e642047656e746c656d656e206f662074686520636c617373206f66202739393a204966204920636f756c64206f6666657220796f75206f6e6c79206f6e652074697020666f7220746865206675747572652c2073756e73637265656e20776f756c642062652069742e
[test] decryption is a success
test_aes_gcm_0()
[test] expected output cipher is 58e2fccefa7e3061367f1d57a4e7455a
[test] computed output cipher is 58e2fccefa7e3061367f1d57a4e7455a
[test] cipher is a success
[test] expected output decryption is 
[test] computed output decryption is 
[test] decryption is a success
+ make -C hacl-star/secure_api -f Makefile.extract test
test_aes_gcm_1()
[test] expected output cipher is 530f8afbc74536b9a963b4f1c4cb738b
[test] computed output cipher is 530f8afbc74536b9a963b4f1c4cb738b
[test] cipher is a success
[test] expected output decryption is 
[test] computed output decryption is 
[test] decryption is a success
test_aes_gcm_2()
[test] expected output cipher is cea7403d4d606b6e074ec5d3baf39d18d0d1c8a799996bf0265b98b5d48ab919
[test] computed output cipher is cea7403d4d606b6e074ec5d3baf39d18d0d1c8a799996bf0265b98b5d48ab919
[test] cipher is a success
[test] expected output decryption is 00000000000000000000000000000000
[test] computed output decryption is 00000000000000000000000000000000
[test] decryption is a success
test_aes_gcm_3()
[test] expected output cipher is 522dc1f099567d07f47f37a32a84427d643a8cdcbfe5c0c97598a2bd2555d1aa8cb08e48590dbb3da7b08b1056828838c5f61e6393ba7a0abcc9f662898015adb094dac5d93471bdec1a502270e3cc6c
[test] computed output cipher is 522dc1f099567d07f47f37a32a84427d643a8cdcbfe5c0c97598a2bd2555d1aa8cb08e48590dbb3da7b08b1056828838c5f61e6393ba7a0abcc9f662898015adb094dac5d93471bdec1a502270e3cc6c
[test] cipher is a success
[test] expected output decryption is d9313225f88406e5a55909c5aff5269a86a7a9531534f7da2e4c303d8a318a721c3c0c95956809532fcf0e2449a6b525b16aedf5aa0de657ba637b391aafd255
[test] computed output decryption is d9313225f88406e5a55909c5aff5269a86a7a9531534f7da2e4c303d8a318a721c3c0c95956809532fcf0e2449a6b525b16aedf5aa0de657ba637b391aafd255
[test] decryption is a success
test_aes_gcm_4()
[test] expected output cipher is 522dc1f099567d07f47f37a32a84427d643a8cdcbfe5c0c97598a2bd2555d1aa8cb08e48590dbb3da7b08b1056828838c5f61e6393ba7a0abcc9f66276fc6ece0f4e1768cddf8853bb2d551b
[test] computed output cipher is 522dc1f099567d07f47f37a32a84427d643a8cdcbfe5c0c97598a2bd2555d1aa8cb08e48590dbb3da7b08b1056828838c5f61e6393ba7a0abcc9f66276fc6ece0f4e1768cddf8853bb2d551b
[test] cipher is a success
[test] expected output decryption is d9313225f88406e5a55909c5aff5269a86a7a9531534f7da2e4c303d8a318a721c3c0c95956809532fcf0e2449a6b525b16aedf5aa0de657ba637b39
[test] computed output decryption is d9313225f88406e5a55909c5aff5269a86a7a9531534f7da2e4c303d8a318a721c3c0c95956809532fcf0e2449a6b525b16aedf5aa0de657ba637b39
[test] decryption is a success
test()
[test] expected output cipher is d31a8d34648e60db7b86afbc53ef7ec2a4aded51296e08fea9e2b5a736ee62d63dbea45e8ca9671282fafb69da92728b1a71de0a9e060b2905d6a5b67ecd3b3692ddbd7f2d778b8c9803aee328091b58fab324e4fad675945585808b4831d7bc3ff4def08e4b7a9de576d26586cec64b61161ae10b594f09e26a7e902ecbd0600691
[test] computed output cipher is d31a8d34648e60db7b86afbc53ef7ec2a4aded51296e08fea9e2b5a736ee62d63dbea45e8ca9671282fafb69da92728b1a71de0a9e060b2905d6a5b67ecd3b3692ddbd7f2d778b8c9803aee328091b58fab324e4fad675945585808b4831d7bc3ff4def08e4b7a9de576d26586cec64b61161ae10b594f09e26a7e902ecbd0600691
[test] cipher is a success
[test] expected output decryption is 4c616469657320616e642047656e746c656d656e206f662074686520636c617373206f66202739393a204966204920636f756c64206f6666657220796f75206f6e6c79206f6e652074697020666f7220746865206675747572652c2073756e73637265656e20776f756c642062652069742e
[test] computed output decryption is 4c616469657320616e642047656e746c656d656e206f662074686520636c617373206f66202739393a204966204920636f756c64206f6666657220796f75206f6e6c79206f6e652074697020666f7220746865206675747572652c2073756e73637265656e20776f756c642062652069742e
[test] decryption is a success
test_aes_gcm_0()
[test] expected output cipher is 58e2fccefa7e3061367f1d57a4e7455a
[test] computed output cipher is 58e2fccefa7e3061367f1d57a4e7455a
[test] cipher is a success
[test] expected output decryption is 
[test] computed output decryption is 
[test] decryption is a success
test_aes_gcm_1()
[test] expected output cipher is 530f8afbc74536b9a963b4f1c4cb738b
[test] computed output cipher is 530f8afbc74536b9a963b4f1c4cb738b
[test] cipher is a success
[test] expected output decryption is 
[test] computed output decryption is 
[test] decryption is a success
test_aes_gcm_2()
[test] expected output cipher is cea7403d4d606b6e074ec5d3baf39d18d0d1c8a799996bf0265b98b5d48ab919
[test] computed output cipher is cea7403d4d606b6e074ec5d3baf39d18d0d1c8a799996bf0265b98b5d48ab919
[test] cipher is a success
[test] expected output decryption is 00000000000000000000000000000000
[test] computed output decryption is 00000000000000000000000000000000
[test] decryption is a success
test_aes_gcm_3()
[test] expected output cipher is 522dc1f099567d07f47f37a32a84427d643a8cdcbfe5c0c97598a2bd2555d1aa8cb08e48590dbb3da7b08b1056828838c5f61e6393ba7a0abcc9f662898015adb094dac5d93471bdec1a502270e3cc6c
[test] computed output cipher is 522dc1f099567d07f47f37a32a84427d643a8cdcbfe5c0c97598a2bd2555d1aa8cb08e48590dbb3da7b08b1056828838c5f61e6393ba7a0abcc9f662898015adb094dac5d93471bdec1a502270e3cc6c
[test] cipher is a success
[test] expected output decryption is d9313225f88406e5a55909c5aff5269a86a7a9531534f7da2e4c303d8a318a721c3c0c95956809532fcf0e2449a6b525b16aedf5aa0de657ba637b391aafd255
[test] computed output decryption is d9313225f88406e5a55909c5aff5269a86a7a9531534f7da2e4c303d8a318a721c3c0c95956809532fcf0e2449a6b525b16aedf5aa0de657ba637b391aafd255
[test] decryption is a success
test_aes_gcm_4()
[test] expected output cipher is 522dc1f099567d07f47f37a32a84427d643a8cdcbfe5c0c97598a2bd2555d1aa8cb08e48590dbb3da7b08b1056828838c5f61e6393ba7a0abcc9f66276fc6ece0f4e1768cddf8853bb2d551b
[test] computed output cipher is 522dc1f099567d07f47f37a32a84427d643a8cdcbfe5c0c97598a2bd2555d1aa8cb08e48590dbb3da7b08b1056828838c5f61e6393ba7a0abcc9f66276fc6ece0f4e1768cddf8853bb2d551b
[test] cipher is a success
[test] expected output decryption is d9313225f88406e5a55909c5aff5269a86a7a9531534f7da2e4c303d8a318a721c3c0c95956809532fcf0e2449a6b525b16aedf5aa0de657ba637b39
[test] computed output decryption is d9313225f88406e5a55909c5aff5269a86a7a9531534f7da2e4c303d8a318a721c3c0c95956809532fcf0e2449a6b525b16aedf5aa0de657ba637b39
[test] decryption is a success
make: Entering directory '/cygdrive/c/build/agent1/_work/6/s/hacl-star/secure_api'
./../secure_api/out/runtime_switch/krml-test.exe
test()
[test] expected output cipher is d31a8d34648e60db7b86afbc53ef7ec2a4aded51296e08fea9e2b5a736ee62d63dbea45e8ca9671282fafb69da92728b1a71de0a9e060b2905d6a5b67ecd3b3692ddbd7f2d778b8c9803aee328091b58fab324e4fad675945585808b4831d7bc3ff4def08e4b7a9de576d26586cec64b61161ae10b594f09e26a7e902ecbd0600691
[test] computed output cipher is d31a8d34648e60db7b86afbc53ef7ec2a4aded51296e08fea9e2b5a736ee62d63dbea45e8ca9671282fafb69da92728b1a71de0a9e060b2905d6a5b67ecd3b3692ddbd7f2d778b8c9803aee328091b58fab324e4fad675945585808b4831d7bc3ff4def08e4b7a9de576d26586cec64b61161ae10b594f09e26a7e902ecbd0600691
[test] cipher is a success
[test] expected output decryption is 4c616469657320616e642047656e746c656d656e206f662074686520636c617373206f66202739393a204966204920636f756c64206f6666657220796f75206f6e6c79206f6e652074697020666f7220746865206675747572652c2073756e73637265656e20776f756c642062652069742e
[test] computed output decryption is 4c616469657320616e642047656e746c656d656e206f662074686520636c617373206f66202739393a204966204920636f756c64206f6666657220796f75206f6e6c79206f6e652074697020666f7220746865206675747572652c2073756e73637265656e20776f756c642062652069742e
[test] decryption is a success
test_aes_gcm_0()
[test] expected output cipher is 58e2fccefa7e3061367f1d57a4e7455a
[test] computed output cipher is 58e2fccefa7e3061367f1d57a4e7455a
[test] cipher is a success
[test] expected output decryption is 
[test] computed output decryption is 
[test] decryption is a success
test_aes_gcm_1()
[test] expected output cipher is 530f8afbc74536b9a963b4f1c4cb738b
[test] computed output cipher is 530f8afbc74536b9a963b4f1c4cb738b
[test] cipher is a success
[test] expected output decryption is 
[test] computed output decryption is 
[test] decryption is a success
test_aes_gcm_2()
[test] expected output cipher is cea7403d4d606b6e074ec5d3baf39d18d0d1c8a799996bf0265b98b5d48ab919
[test] computed output cipher is cea7403d4d606b6e074ec5d3baf39d18d0d1c8a799996bf0265b98b5d48ab919
[test] cipher is a success
[test] expected output decryption is 00000000000000000000000000000000
[test] computed output decryption is 00000000000000000000000000000000
[test] decryption is a success
test_aes_gcm_3()
[test] expected output cipher is 522dc1f099567d07f47f37a32a84427d643a8cdcbfe5c0c97598a2bd2555d1aa8cb08e48590dbb3da7b08b1056828838c5f61e6393ba7a0abcc9f662898015adb094dac5d93471bdec1a502270e3cc6c
[test] computed output cipher is 522dc1f099567d07f47f37a32a84427d643a8cdcbfe5c0c97598a2bd2555d1aa8cb08e48590dbb3da7b08b1056828838c5f61e6393ba7a0abcc9f662898015adb094dac5d93471bdec1a502270e3cc6c
[test] cipher is a success
[test] expected output decryption is d9313225f88406e5a55909c5aff5269a86a7a9531534f7da2e4c303d8a318a721c3c0c95956809532fcf0e2449a6b525b16aedf5aa0de657ba637b391aafd255
[test] computed output decryption is d9313225f88406e5a55909c5aff5269a86a7a9531534f7da2e4c303d8a318a721c3c0c95956809532fcf0e2449a6b525b16aedf5aa0de657ba637b391aafd255
[test] decryption is a success
test_aes_gcm_4()
[test] expected output cipher is 522dc1f099567d07f47f37a32a84427d643a8cdcbfe5c0c97598a2bd2555d1aa8cb08e48590dbb3da7b08b1056828838c5f61e6393ba7a0abcc9f66276fc6ece0f4e1768cddf8853bb2d551b
[test] computed output cipher is 522dc1f099567d07f47f37a32a84427d643a8cdcbfe5c0c97598a2bd2555d1aa8cb08e48590dbb3da7b08b1056828838c5f61e6393ba7a0abcc9f66276fc6ece0f4e1768cddf8853bb2d551b
[test] cipher is a success
[test] expected output decryption is d9313225f88406e5a55909c5aff5269a86a7a9531534f7da2e4c303d8a318a721c3c0c95956809532fcf0e2449a6b525b16aedf5aa0de657ba637b39
[test] computed output decryption is d9313225f88406e5a55909c5aff5269a86a7a9531534f7da2e4c303d8a318a721c3c0c95956809532fcf0e2449a6b525b16aedf5aa0de657ba637b39
[test] decryption is a success
make -C C:/build/agent1/_work/6/s/MLCrypto
make[1]: Entering directory '/cygdrive/c/build/agent1/_work/6/s/MLCrypto'
make[1]: Nothing to be done for 'all'.
make[1]: Leaving directory '/cygdrive/c/build/agent1/_work/6/s/MLCrypto'
OCAMLPATH="C:/build/agent1/_work/6/s/FStar/bin" ocamlfind opt -package fstarlib,zarith -g -I C:/build/agent1/_work/6/s/FStar/ulib/ml -c LowCProvider/LowCProvider.ml -I LowCProvider -I ../secure_api/out/runtime_switch -I ../secure_api/out/runtime_switch/extracted -I C:/build/agent1/_work/6/s/MLCrypto -o LowCProvider/LowCProvider.cmx
OCAMLPATH="C:/build/agent1/_work/6/s/FStar/bin" ocamlfind mklib -g -I C:/build/agent1/_work/6/s/FStar/ulib/ml -I ../secure_api/out/runtime_switch/extracted ../secure_api/out/runtime_switch/uint128/uint128_wrapper.o LowCProvider/LowCProvider.cmx LowCProvider/HaclProvider.cmx LowCProvider/lowc_stub.o ../secure_api/out/runtime_switch/crypto/Crypto_AEAD_Main_Crypto_Indexing.o ../secure_api/out/runtime_switch/crypto/Crypto_HKDF_Crypto_HMAC.o ../secure_api/out/runtime_switch/crypto/Crypto_Symmetric_Bytes.o ../code/curve25519/x25519-c/Curve25519.o ../code/curve25519/x25519-c/FStar.o vale/asm/sha256_main_i.o vale/asm/sha256-x86_64.o vale/asm/Vale_Hash_SHA2_256.o vale/asm/vale_aes_glue.o vale/asm/aes-x86_64.o -o ../secure_api/out/runtime_switch/LowC
OCAMLPATH="C:/build/agent1/_work/6/s/FStar/bin" ocamlfind opt -package fstarlib,zarith -g -I C:/build/agent1/_work/6/s/FStar/ulib/ml -c LowCProvider/Tests.ml -I LowCProvider -I ../secure_api/out/runtime_switch -I ../secure_api/out/runtime_switch/extracted -I C:/build/agent1/_work/6/s/MLCrypto -o LowCProvider/Tests.cmx
OCAMLPATH="C:/build/agent1/_work/6/s/FStar/bin" ocamlfind opt -package fstarlib,zarith -g -I C:/build/agent1/_work/6/s/FStar/ulib/ml -I ../secure_api/out/runtime_switch/extracted -I LowCProvider \
-ccopt -L../secure_api/out/runtime_switch -linkpkg ../secure_api/out/runtime_switch/copied/kremstr.o C:/build/agent1/_work/6/s/MLCrypto/CryptoTypes.cmx ../secure_api/out/runtime_switch/LowC.cmxa LowCProvider/Tests.cmx -o ../secure_api/out/runtime_switch/LowCTests.exe
./../secure_api/out/runtime_switch/LowCTests.exe
Tests started
Test 1 OK

Test 2 OK

Test 3 OK

Test 4 OK

Test 5 OK

Test 6 OK

Output cipher:	ed3dc05f9d4877f5db78c69c3a8a3d8e8602646a0b2febe4fca07a426a9ace4163cb26eddbb5b0d5f56d7038512ac73d667397d129c3044e0eb8052e
Output tag:	e6f0c7f7b8920ba02a3942df2b8b2a04
cipher:		AES-128-GCM
key:		"feffe9928665731c6d6a8f9467308308"
iv:		"cafebabefacedbad"
aad:		"feedfacedeadbeeffeedfacedeadbeefabaddad2"
tag:		"3612d2e79e3b0785561be14aaca2fccb"
+ cd mitls-fstar/src/tls
plaintext:	"d9313225f88406e5a55909c5aff5269a86a7a9531534f7da2e4c303d8a318a721c3c0c95956809532fcf0e2449a6b525b16aedf5aa0de657ba637b39"
+ make -j 16 test
ciphertext:	"61353b4c2806934a777ff51fa22a4755699b2a714fcdc6f83766e5f97b6c742373806900e49f24b22b097544d4896b424989b5e1ebac0f07c23f4598"

Test 7 failed, but this is expected because |IV| <> 12 bytes and we don't do IV expansion.
Please disregard.

Output cipher:	8076eba01a51d7702d398c6dc3adaaadfe061c23a7ffc3c4623ea2be7a08d982b8f331d21ac6b8db541df43510561a3fff90b942215b7fb6fbcea43d
Output tag:	1606863da7ad74443b3a89fd2489363d
cipher:		AES-128-GCM
key:		"feffe9928665731c6d6a8f9467308308"
iv:		"9313225df88406e555909c5aff5269aa6a7a9538534f7da1e4c303d2a318a728c3c0c95156809539fcf0e2429a6b525416aedbf5a0de6a57a637b39b"
aad:		"feedfacedeadbeeffeedfacedeadbeefabaddad2"
tag:		"619cc5aefffe0bfa462af43c1699d050"
plaintext:	"d9313225f88406e5a55909c5aff5269a86a7a9531534f7da2e4c303d8a318a721c3c0c95956809532fcf0e2449a6b525b16aedf5aa0de657ba637b39"
ciphertext:	"8ce24998625615b603a033aca13fb894be9112a5c3a211a8ba262a3cca7e2ca701e4a9a4fba43c90ccdcb281d48c7c6fd62875d2aca417034c34aee5"

Test 8 failed, but this is expected because |IV| <> 12 bytes and we don't do IV expansion.
Please disregard.

Test 9 OK

Test 10 OK

Test 11 OK

Test 12 OK

Output cipher:	677a374b4dd797f8ea0252a721fa83784f68c4877cf4e60f8c1f56972e9c20f789efb32096dd6336c6e5ef833b041251fdf04ce41fbcf2fea0d1e83c
Output tag:	91b8ee617f7c50dab5bc75abff3bc1c3
cipher:		AES-256-GCM
key:		"feffe9928665731c6d6a8f9467308308feffe9928665731c6d6a8f9467308308"
iv:		"cafebabefacedbad"
aad:		"feedfacedeadbeeffeedfacedeadbeefabaddad2"
tag:		"3a337dbf46a792c45e454913fe2ea8f2"
plaintext:	"d9313225f88406e5a55909c5aff5269a86a7a9531534f7da2e4c303d8a318a721c3c0c95956809532fcf0e2449a6b525b16aedf5aa0de657ba637b39"
ciphertext:	"c3762df1ca787d32ae47c13bf19844cbaf1ae14d0b976afac52ff7d79bba9de0feb582d33934a4f0954cc2363bc73f7862ac430e64abe499f47c9b1f"

Test 13 failed, but this is expected because |IV| <> 12 bytes and we don't do IV expansion.
Please disregard.

Output cipher:	cf3b9ab7a70a2ac55a7bcf74cda369c5b32e7870a937cb4d7679ef877de6403b7126c8ca2d6c620755e8ff330af0e7fa003585282b2d7a3d8f785bcc
Output tag:	881390e147e8fc6b2923305b6413a594
cipher:		AES-256-GCM
key:		"feffe9928665731c6d6a8f9467308308feffe9928665731c6d6a8f9467308308"
iv:		"9313225df88406e555909c5aff5269aa6a7a9538534f7da1e4c303d2a318a728c3c0c95156809539fcf0e2429a6b525416aedbf5a0de6a57a637b39b"
aad:		"feedfacedeadbeeffeedfacedeadbeefabaddad2"
tag:		"a44a8266ee1c8eb0c8b5d4cf5ae9f19a"
plaintext:	"d9313225f88406e5a55909c5aff5269a86a7a9531534f7da2e4c303d8a318a721c3c0c95956809532fcf0e2449a6b525b16aedf5aa0de657ba637b39"
ciphertext:	"5a8def2f0c9e53f1f75d7853659e2a20eeb2b22aafde6419a058ab4f6f746bf40fc0c3b780f244452da3ebf1c5d82cdea2418997200ef82e44ae7e3f"

Test 14 failed, but this is expected because |IV| <> 12 bytes and we don't do IV expansion.
Please disregard.

Test 15 OK

Test 16 OK

Test 17 OK

Test 18 OK

Output cipher:	eff01b40f151144abb70955cedcbe564afd7d338ce2c3eb2ac13b1228ef785edc5bf4b7501cdc522a855c4e5843a3a0af67e4c8285f641951d9dcb727fb5d53bffe8165999884aa1626b20328a233f189b48820f19d2cf1551f21d0ae749227f1d47344d687533456994f11584dfd15d4791ceedf45f3774821bcd340d4b18ec8ed70e7ce40859ec159363caab3eaa87261cbda3733c01bbd39f03f21d3c4f1b3af2cadd75c67fbe96929c20a13077991908a0d23adbcecd49ed2ed71dd8f659
Output tag:	1f200ef9ef5218a0a69331c8304f873d
cipher:		AES-128-GCM
key:		"00000000000000000000000000000000"
iv:		"ffffffff000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000"
aad:		""
tag:		"566f8ef683078bfdeeffa869d751a017"
plaintext:	"000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000"
ciphertext:	"56b3373ca9ef6e4a2b64fe1e9a17b61425f10d47a75a5fce13efc6bc784af24f4141bdd48cf7c770887afd573cca5418a9aeffcd7c5ceddfc6a78397b9a85b499da558257267caab2ad0b23ca476a53cb17fb41c4b8b475cb4f3f7165094c229c9e8c4dc0a2a5ff1903e501511221376a1cdb8364c5061a20cae74bc4acd76ceb0abc9fd3217ef9f8c90be402ddf6d8697f4f880dff15bfb7a6b28241ec8fe183c2d59e3f9dfff653c7126f0acb9e64211f42bae12af462b1070bef1ab5e3606"

Test 19 failed, but this is expected because |IV| <> 12 bytes and we don't do IV expansion.
Please disregard.

Output cipher:	eff01b40f151144abb70955cedcbe564afd7d338ce2c3eb2ac13b1228ef785edc5bf4b7501cdc522a855c4e5843a3a0af67e4c8285f641951d9dcb727fb5d53bffe8165999884aa1626b20328a233f189b48820f19d2cf1551f21d0ae749227f1d47344d687533456994f11584dfd15d4791ceedf45f3774821bcd340d4b18ec8ed70e7ce40859ec159363caab3eaa87261cbda3733c01bbd39f03f21d3c4f1b3af2cadd75c67fbe96929c20a13077991908a0d23adbcecd49ed2ed71dd8f65954f4ff316fe216dd9e29b1ea55824efb884af85d0e6743d586acfc3088f200284dcb744dcf6fe40745827d98067e32af9b279d8f8354d7e47b8bb6736de3b66479f0d1ee5cb7796d966955cc6dea4ae5e4205b07040a0d9ec6594c2c6d2350a4
Output tag:	99b156f6881899ee456476976e9f5414
cipher:		AES-128-GCM
key:		"00000000000000000000000000000000"
iv:		"ffffffff000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000"
aad:		""
tag:		"8b307f6b33286d0ab026a9ed3fe1e85f"
plaintext:	"000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000"
ciphertext:	"56b3373ca9ef6e4a2b64fe1e9a17b61425f10d47a75a5fce13efc6bc784af24f4141bdd48cf7c770887afd573cca5418a9aeffcd7c5ceddfc6a78397b9a85b499da558257267caab2ad0b23ca476a53cb17fb41c4b8b475cb4f3f7165094c229c9e8c4dc0a2a5ff1903e501511221376a1cdb8364c5061a20cae74bc4acd76ceb0abc9fd3217ef9f8c90be402ddf6d8697f4f880dff15bfb7a6b28241ec8fe183c2d59e3f9dfff653c7126f0acb9e64211f42bae12af462b1070bef1ab5e3606872ca10dee15b3249b1a1b958f23134c4bccb7d03200bce420a2f8eb66dcf3644d1423c1b5699003c13ecef4bf38a3b60eedc34033bac1902783dc6d89e2e774188a439c7ebcc0672dbda4ddcfb2794613b0be41315ef778708a70ee7d75165c"

Test 20 failed, but this is expected because |IV| <> 12 bytes and we don't do IV expansion.
Please disregard.

Test 21 OK

AEAD: 21/21 tests passed
./../secure_api/out/runtime_switch/quicprovider-test.exe
==== coverage ====
SHA256('') =
e3b0c44298fc1c149afbf4c8996fb92427ae41e4649b934ca495991b7852b855

SHA384('') = 
38b060a751ac96384cd9327eb1b1e36a21fdb71114be07434c0cc7bf63f6e1da
274edebfe76f65fbd51ad2f14898b95b

SHA512('') = 
cf83e1357eefb8bdf1542850d66d8007d620e4050b5715dc83f4a921d36ce9ce
47d0d13c5d85f2b0ff8318d2877eec2f63b931bd47417a81a538327af927da3e

HMAC-SHA256('Jefe', 'what do ya want for nothing?') = 
5bdcc146bf60754e6a042426089575c75a003f089d2739839dec58b964ec3843

HMAC-SHA384('Jefe', 'what do ya want for nothing?') = 
af45d2e376484031617f78d2b58a6b1b9c7ef464f5a01b47e42ec3736322445e
8e2240ca5e69e2c78b3239ecfab21649

HMAC-SHA512('Jefe', 'what do ya want for nothing?') = 
164b7a7bfcf819e2e395fbe73b56e0a387bd64222e831fd610270cd7ea250554
9758bf75c05a994a6d034f65f8f0e6fdcaeab1a34d4a6b4b636e070a38bce737

prk = HKDF-EXTRACT-SHA256('0x000102030405060708090a0b0c', '0x0b0b0b0b0b0b0b0b0b0b0b0b0b0b0b0b0b0b0b0b0b0b')
077709362c2e32df0ddc3f0dc47bba6390b6c73bb50f9c3122ec844ad7c2b3e5
077709362c2e32df0ddc3f0dc47bba6390b6c73bb50f9c3122ec844ad7c2b3e5

okm = HKDF-EXPAND-SHA256(prk, '0xf0f1f2f3f4f5f6f7f8f9', 42)
3cb25f25faacd57a90434f64d0362f2a2d2d0a90cf1a5a4c5db02d56ecc4c5bf
34007208d5b887185865

AES-128-GCM encrypt test:
5936f46d6c7eb7008dbbfb0d40b491fce5328aedcbc0c5272457d347363fd36d
f238bd17971e982f4449350d
DECRYPT SUCCES: 
7768617420646f2079612077616e7420666f72206e6f7468696e673f

CHACHA20-POLY1305 encrypt test:
a62fe99f3d6001a4f4214a986f04b1f42ea1e5dcea3236ecf35adb5d8cc57db2
df5e18b278c8c904fcddf440
DECRYPT SUCCES: 
7768617420646f2079612077616e7420666f72206e6f7468696e673f
==== PASS:  coverage ====


==== test_crypto(TLS_hash_SHA256,TLS_aead_AES_128_GCM) ====
PASS
==== test_crypto(TLS_hash_SHA384,TLS_aead_AES_128_GCM) ====
PASS
==== test_crypto(TLS_hash_SHA512,TLS_aead_AES_128_GCM) ====
PASS
==== test_crypto(TLS_hash_SHA256,TLS_aead_AES_256_GCM) ====
PASS
==== test_crypto(TLS_hash_SHA384,TLS_aead_AES_256_GCM) ====
PASS
==== test_crypto(TLS_hash_SHA512,TLS_aead_AES_256_GCM) ====
PASS
==== test_crypto(TLS_hash_SHA256,TLS_aead_CHACHA20_POLY1305) ====
PASS
==== test_crypto(TLS_hash_SHA384,TLS_aead_CHACHA20_POLY1305) ====
PASS
==== test_crypto(TLS_hash_SHA512,TLS_aead_CHACHA20_POLY1305) ====
PASS
==== test_handshake_secrets() ====
==== PASS: test_handshake_secrets ==== 
==== ALL TESTS PASS ====
make: Leaving directory '/cygdrive/c/build/agent1/_work/6/s/hacl-star/secure_api'
rm -f cache/OCaml/.depend cache/Kremlin/.depend cache/Model/.depend
make -f Makefile.Kremlin test
make -f Makefile.OCaml test
make -C ../../apps/quicMinusNet test -k
make[1]: Entering directory '/cygdrive/c/build/agent1/_work/6/s/mitls-fstar/apps/quicMinusNet'
./quic.exe
server create
client create
client call clen=8192 slen=   0
client done clen= 175 slen=   0 status=would_block
16030300aa010000a603035aecc685e741f334a971e9420380aac2d54fa6f46f
0ae2df9045e02f7aad6fe50000041303130101000079001a0009ffff00050a0b
0c0d0e002b0003027f1c003300260024001d002070b9f57c6ddc3c7ed9216328
f6e6e20d0999f33f0f40ff1d66078e25e94467290000000e000c0000096c6f63
616c686f73740010000800060568712d303800170000000d0006000408040403
000a00040002001d002d0003020001
server call clen= 175 slen=8192
@@@@ Nego callback for TLS 1.3 @@@@
Offered extensions:
003d001a0009ffff00050a0b0c0d0e0000000e000c0000096c6f63616c686f73
740010000800060568712d3038000d0006000408040403000a00040002001d
Transport parameters offered:
ffff00050a0b0c0d0e
No application cookie (fist connection).
Adding server transport parameters:
000102
@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
======== TO BE SIGNED <0403>: (130 octets) ========
2020202020202020202020202020202020202020202020202020202020202020
2020202020202020202020202020202020202020202020202020202020202020
544c5320312e332c207365727665722043657274696669636174655665726966
7900bdd48d690549c1f6e55c7df8a5acc3d814cc2eebfbee1cc63083d693befc
d4e3
===================================================
sender done clen= 175 slen= 834 status=server_accept
160303005a0200005603035aecc685f111be127d02efdac47bb2623599773ed6
700101d90bde043a90d70c00130300002e002b00027f1c00330024001d0020b7
25f95d0a7429f92b8115cea26130b31d4685918b68261fd9b693d40d57125417
030302de476234e54d07cd550c772d504a242b375681a15b223b51b95f92c40d
a85f79743f35f9a05c09d55708b6d62f602e608a4eae66a3b06aadc842485b73
311e84ecdb8df51c1c857c2eb3e70859e30996a4da87926c046fe02345728673
ccb799e0dd339a851d429c4b22c80f0f8c9b8cf667fe61a2b16cbb8585d752b9
d57c6e42d105e4707b37be9ef74ef9daacd94bc2ea2614469bb021e528eec179
ddb95d38e83f435c97d045fa5864a40ea9360d1f0ef99d37c3f38d5706df62a2
3fc497cb84bf458dcc1e97c0cbdcc06cfb5bce1258e391936faa98bc2f9604dd
0bd9b5fde92048101ed713d839f3a2323d0f3eb6b85a9cd53a922d0c008326b7
52d8056a6a0dfb646015be57f5fc1ad82448df4242f8c8de345b512fdfadf31f
4fd61e2a2fbc001d54f430ade77711905e7a3cc911af8d407beecb4af2b63e6d
02377bc3349ccf118a570ab148e2720664252e7ecb3ad6b234869ed4f537b580
0e1aba5cac7a3053afd5baf9788936d9703916785939f45e11efba66a4dcd82a
bb4374356bd379cb71c62d581fcdeb1f7642e2bdc873deb9f919d770972743a5
0183f629cda1ae7edd94aeb6a764ebdbc6944ec2a2df004569d3a5dc8e361880
7aa4c31253ff4546bc65f0903e30ed20e526efadf0a1feb2407d406d7b081583
69f2f0676a5f08e3f0a54747f8b8ff65bee913b3973ff6737ae999a4946142e1
4a20f87cc3c87f0c8e2b66a099c46ce2451fb52e2487bb16a2a633fbd38ae552
85183e92c0755fb5f2f84d6a6c4a0fe5062f360ea147000e3290c3a944f3549c
b2d0866fe6546a29c0cdfd4af3338d03f7834a2025aff21ddad9f8f4000bb40f
d8cc903634c9cda51ecb4b87cd3231503c67cc6fec96768fd695c2c490b2773c
db5181c89d8901a1dde295958681a4ac7a333dfcab900ec59ec5c9917d1ef6b4
f99c0de5d32c4ed1c8ac46ac67d828898b6cf0d715c6926e47ca9ecd18c8f992
6a453189c45cb9b35f3fe643d0f320e7dec217a75d3e5608a5b693126401774d
7cc9
client call clen=8017 slen= 834
@@@@ Nego callback for TLS 1.3 @@@@
Offered extensions:
001b0010000800060568712d3038000a00040002001d001a0003000102
Transport parameters offered:
000102
No application cookie (fist connection).
Adding server transport parameters:
000102
@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
WARNING: chain validation failed, ignoring.
client done clen=  58 slen= 834 status=client_complete
1703030035cd163327a17bf5399e63df7f2b394d77d7109877d6dba634123c54
e1e0c4b525f79d62cad088127de0c82bfc2e7d3153765a5054e2
server call clen=  58 slen=7358
sender done clen=  58 slen=   0 status=server_complete
=== Exporter secret ===
de94ef53edbfe8cbcff68e146dbd9d286940f745c1c7a13fffd0138a952e1915
=== QUIC 1-RTT secrets ===
C: e375be1bc85ab031de1e5a65cebdd46d16eb26a503d871fbc746280c9ef6d9c5
S: 6b2a8286335b659365d4641855a408a3c5dbe964a3220e1d2cbd56f813f138f2
=== AEAD client key test ===
8938c28b0949feb706dd4903ec9c097a3552770b43a06a01fd7428
=== Decrypt successful ===
Ok
./quic.exe 0rtt

INITIAL ECDHE HANDSHAKE (NO EARLY SECRET)

server create
client create
client returns would_block clen=175 slen=0
ClientHello[ 175] ---->

@@@@ Nego callback for TLS 1.3 @@@@
Offered extensions:
003d001a0009ffff00050a0b0c0d0e0000000e000c0000096c6f63616c686f73
740010000800060568712d3038000d0006000408040403000a00040002001d
Transport parameters offered:
ffff00050a0b0c0d0e
No application cookie (fist connection).
Adding server transport parameters:
000102
@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
======== TO BE SIGNED <0403>: (130 octets) ========
2020202020202020202020202020202020202020202020202020202020202020
2020202020202020202020202020202020202020202020202020202020202020
544c5320312e332c207365727665722043657274696669636174655665726966
7900daed3d3c2572de1ba0bbf4a577235dcc82ebd88e0f8d530b86e9d54026e1
dd67
===================================================
server returns server_accept clen=175 slen=834
secret=3c356a9c496bad032ff7353974d345d675fcef1e50446028f82756df793921e3
<---- ServerHello;(EncryptedExtensions; Certificate; CertVerify; Finished)[ 834]

@@@@ Nego callback for TLS 1.3 @@@@
Offered extensions:
001b0010000800060568712d3038000a00040002001d001a0003000102
Transport parameters offered:
000102
No application cookie (fist connection).
Adding server transport parameters:
000102
@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
WARNING: chain validation failed, ignoring.
client returns client_complete clen=58 slen=834
secret=3c356a9c496bad032ff7353974d345d675fcef1e50446028f82756df793921e3
(Finished) [  58] ---->

server returns server_complete clen=58 slen=0
server returns would_block clen=0 slen=135
<---- {Ticket}[ 135]

##### New session ticket received! #####
Host: localhost
Ticket:
b0712c3108ac390f035d584bd07b23813ca97b0597fdb4cb1be3c5f009d99b50
fe21eecf81b3390a0db44f36f0d7b419c2145a23b622391e382231dba18c1cd0
a636312fbaa16222a0868a3e
########################################
client returns clen=0 slen=135 status=would_block

TICKET-BASED RESUMPTION

server create
client create
client returns client_early_data clen=302 slen=0
early secret=01d816fa4f7e98d3f39f340bc54442d89c4496eb3a778750f4b072514a5a9852
ClientHello[ 302] ---->

@@@@ Nego callback for TLS 1.3 @@@@
Offered extensions:
003d001a0009ffff00050a0b0c0d0e0000000e000c0000096c6f63616c686f73
740010000800060568712d3038000d0006000408040403000a00040002001d
Transport parameters offered:
ffff00050a0b0c0d0e
No application cookie (fist connection).
Adding server transport parameters:
000102
@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
server returns server_accept_early_data clen=302 slen=196
early secret=01d816fa4f7e98d3f39f340bc54442d89c4496eb3a778750f4b072514a5a9852
secret=aef6dd9d67dc679582ad7f7db556c9bfb9c632057a8935a45bf3d7d6f061d3c0
<---- ServerHello;(EncryptedExtensions; Certificate; CertVerify; Finished)[ 196]

@@@@ Nego callback for TLS 1.3 @@@@
Offered extensions:
001b0010000800060568712d3038000a00040002001d001a0003000102
Transport parameters offered:
000102
No application cookie (fist connection).
Adding server transport parameters:
000102
@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
client returns client_complete_early_data clen=84 slen=196
secret=aef6dd9d67dc679582ad7f7db556c9bfb9c632057a8935a45bf3d7d6f061d3c0
(Finished) [  84] ---->

server returns clen=84 slen=0 status=server_complete
server returns would_block clen=0 slen=135
<---- {Ticket}[ 135]

##### New session ticket received! #####
Host: localhost
Ticket:
30653a62e5ccd3ab11d1aeac477f9ee8b821146c4e3e560bb002edb45897ed9f
975a825177b7896bd917c89f1d808a6c8908de9963d0ad3361a063dfc770c1eb
f30c1ec58ad29eecc1ca501e
########################################
client returns clen=0 slen=135 status=would_block
Ok
./quic.exe hrr

STATELESS RETRY TEST

server create
client create
client returns would_block clen=175 slen=0
ClientHello[ 175] ---->

~~~~~~~~~ Client Hello Summary ~~~~~~~~~~~
~ SNI = localhost
~ ALPN = 00060568712d3038
~ Cookie = NULL
~ Extensions = 0079001a0009ffff00050a0b0c0d0e002b0003027f1c003300260024001d0020
a0c10e003867c3c0c5e094b2afeb5d3c5b856d47d2243804ed3165ff4d45b60d
0000000e000c0000096c6f63616c686f73740010000800060568712d30380017
0000000d0006000408040403000a00040002001d002d0003020001
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
@@@@ Nego callback for TLS 1.3 @@@@
Offered extensions:
003d001a0009ffff00050a0b0c0d0e0000000e000c0000096c6f63616c686f73
740010000800060568712d3038000d0006000408040403000a00040002001d
Transport parameters offered:
ffff00050a0b0c0d0e
No application cookie (fist connection).
Adding server transport parameters:
000102
@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
server returns server_stateless_retry clen=175 slen=188
<---- HRR[ 188]

server re-create
client returns would_block clen=308 slen=188
ClientHello2[ 308] ---->

~~~~~~~~~ Client Hello Summary ~~~~~~~~~~~
~ SNI = localhost
~ ALPN = 00060568712d3038
~ Cookie = 48656c6c6f20576f726c64
~ Extensions = 00fe002c0081007f591c03c9eaa4c1c6c588b28c78fde53cd0bdb8e574b73534
9965365318879ca773b43f05ee1ed7320b4cdeef718b35947163b4d60c3dfa8e
8f48bab81d7e58b7ab45180b029dd02a62a975573fbedf910ec9dd865b63048a
31645c771089833bf6bd66aadd76d9e993de8de86c28f180b42788ec8402349b
a4c084e1dcfe2f001a0009ffff00050a0b0c0d0e002b0003027f1c0033002600
24001d0020a0c10e003867c3c0c5e094b2afeb5d3c5b856d47d2243804ed3165
ff4d45b60d0000000e000c0000096c6f63616c686f7374001000080006056871
2d303800170000000d0006000408040403000a00040002001d002d0003020001
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
@@@@ Nego callback for TLS 1.3 @@@@
Offered extensions:
003d001a0009ffff00050a0b0c0d0e0000000e000c0000096c6f63616c686f73
740010000800060568712d3038000d0006000408040403000a00040002001d
Transport parameters offered:
ffff00050a0b0c0d0e
Stateless cookie found, application contents:
48656c6c6f20576f726c64
Adding server transport parameters:
000102
@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
======== TO BE SIGNED <0403>: (130 octets) ========
2020202020202020202020202020202020202020202020202020202020202020
2020202020202020202020202020202020202020202020202020202020202020
544c5320312e332c207365727665722043657274696669636174655665726966
79002bbe13c662e334fb996f62b8be05d6e1c20ceedbed710699b1eb93989241
5a1b
===================================================
server returns server_accept clen=308 slen=835
secret=673673e48b744819f96ab4ce2310d54ed14ec45ac4da6318d85a28e6b579bc7f
<---- ServerHello;(EncryptedExtensions; Certificate; CertVerify; Finished)[ 835]

@@@@ Nego callback for TLS 1.3 @@@@
Offered extensions:
001b0010000800060568712d3038000a00040002001d001a0003000102
Transport parameters offered:
000102
No application cookie (fist connection).
Adding server transport parameters:
000102
@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
WARNING: chain validation failed, ignoring.
client returns client_complete clen=58 slen=835
secret=673673e48b744819f96ab4ce2310d54ed14ec45ac4da6318d85a28e6b579bc7f
(Finished) [  58] ---->

server returns server_complete clen=58 slen=0
server returns would_block clen=0 slen=135
<---- {Ticket}[ 135]

##### New session ticket received! #####
Host: localhost
Ticket:
2bbfc476415590f9fc5b6c46a10cdfc0348e5d9cf20d155c79bf2398c65fe838
f4f202ffe4ad5e6e191a3be591db1d075a3482829439a4e0d09e670c9362d23f
5642eb3fae480c22d3b97f22
########################################
client returns clen=0 slen=135 status=would_block
Ok
make[1]: Leaving directory '/cygdrive/c/build/agent1/_work/6/s/mitls-fstar/apps/quicMinusNet'
make[1]: Entering directory '/cygdrive/c/build/agent1/_work/6/s/mitls-fstar/src/tls'
C:/build/agent1/_work/6/s/FStar/bin/fstar.exe --cache_dir cache/Kremlin --cache_checked_modules --print_z3_statistics --use_hints --query_stats --cache_dir cache/Kremlin --odir extract/Kremlin --extract '* -DHDB -LowCProvider -FFICallbacks -BufferBytes' --dep full --include C:/build/agent1/_work/6/s/FStar/contrib/CoreCrypto/fst/ --include C:/build/agent1/_work/6/s/hacl-star/secure_api --include C:/build/agent1/_work/6/s/hacl-star/secure_api/utils --include C:/build/agent1/_work/6/s/hacl-star/secure_api/concrete_specializations --include C:/build/agent1/_work/6/s/hacl-star/secure_api/LowCProvider/fst --include C:/build/agent1/_work/6/s/hacl-star/code/curve25519/api --include C:/build/agent1/_work/6/s/hacl-star/code/lib --include C:/build/agent1/_work/6/s/kremlin/kremlib --include ../../libs/ffi --include ../../src/tls/concrete-flags --include ../../src/tls/concrete-flags/Kremlin --include ./concrete-flags/Debug QUIC.fst Test.Main.fst  > cache/Kremlin/.depend
make[1]: Leaving directory '/cygdrive/c/build/agent1/_work/6/s/mitls-fstar/src/tls'
make[1]: Entering directory '/cygdrive/c/build/agent1/_work/6/s/mitls-fstar/src/tls'
C:/build/agent1/_work/6/s/FStar/bin/fstar.exe --cache_dir cache/OCaml --cache_checked_modules --print_z3_statistics --use_hints --query_stats --cache_dir cache/OCaml --odir extract/OCaml --extract '* -Prims -FStar +FStar.Test +FStar.Kremlin.Endianness -CoreCrypto -CryptoTypes -DHDB -LowCProvider -HaclProvider -FFICallbacks -Crypto.AEAD -Crypto.Symmetric -Crypto.Plain -Spec.Loops -Buffer.Utils -C +C.Loops -LowParse.SLow.Tac -BufferBytes' --dep full --include C:/build/agent1/_work/6/s/FStar/contrib/CoreCrypto/fst/ --include C:/build/agent1/_work/6/s/hacl-star/secure_api --include C:/build/agent1/_work/6/s/hacl-star/secure_api/utils --include C:/build/agent1/_work/6/s/hacl-star/secure_api/concrete_specializations --include C:/build/agent1/_work/6/s/hacl-star/secure_api/LowCProvider/fst --include C:/build/agent1/_work/6/s/hacl-star/code/curve25519/api --include C:/build/agent1/_work/6/s/hacl-star/code/lib --include C:/build/agent1/_work/6/s/kremlin/kremlib --include ../../libs/ffi --include ../../src/tls/concrete-flags --include ../../src/tls/concrete-flags/OCaml --include ./concrete-flags/Debug QUIC.fst Test.Main.fst  > cache/OCaml/.depend
make[1]: Leaving directory '/cygdrive/c/build/agent1/_work/6/s/mitls-fstar/src/tls'
make -C extract/Kremlin-Internal-Test test
make[2]: Entering directory '/cygdrive/c/build/agent1/_work/6/s/mitls-fstar/src/tls/extract/Kremlin-Internal-Test'
cp ../../../../data/CAFile.pem .
make[2]: Leaving directory '/cygdrive/c/build/agent1/_work/6/s/mitls-fstar/src/tls/extract/Kremlin-Internal-Test'
make[2]: Entering directory '/cygdrive/c/build/agent1/_work/6/s/mitls-fstar/src/tls/extract/Kremlin-Internal-Test'
cp ../../../../data/server-ecdsa.crt .
make[2]: Leaving directory '/cygdrive/c/build/agent1/_work/6/s/mitls-fstar/src/tls/extract/Kremlin-Internal-Test'
make[2]: Entering directory '/cygdrive/c/build/agent1/_work/6/s/mitls-fstar/src/tls/extract/Kremlin-Internal-Test'
cp ../../../../data/server-ecdsa.key .
make[2]: Leaving directory '/cygdrive/c/build/agent1/_work/6/s/mitls-fstar/src/tls/extract/Kremlin-Internal-Test'
make[1]: Entering directory '/cygdrive/c/build/agent1/_work/6/s/mitls-fstar/src/tls'
cp ../../data/CAFile.pem .
make[1]: Leaving directory '/cygdrive/c/build/agent1/_work/6/s/mitls-fstar/src/tls'
make[1]: Entering directory '/cygdrive/c/build/agent1/_work/6/s/mitls-fstar/src/tls'
cp ../../data/server-ecdsa.crt .
make[1]: Leaving directory '/cygdrive/c/build/agent1/_work/6/s/mitls-fstar/src/tls'
make[1]: Entering directory '/cygdrive/c/build/agent1/_work/6/s/mitls-fstar/src/tls'
cp ../../data/server-ecdsa.key .
make[1]: Leaving directory '/cygdrive/c/build/agent1/_work/6/s/mitls-fstar/src/tls'
make[2]: Entering directory '/cygdrive/c/build/agent1/_work/6/s/mitls-fstar/src/tls/extract/Kremlin-Internal-Test'
./test.exe
✔ RNG initialization
b1 = 1234567890abcdef1234567890abcdef
b2 = cafedecafbabedeadbeeffeec0ffee33
b12= 1234567890abcdef1234567890abcdefcafedecafbabedeadbeeffeec0ffee33
b3 = 1234567890abcdef1234567890abcdefcafedecafbabedeadbeeffeec0ffee33
✔ BufferBytes
✔ TLSConstants
✔ AEAD
AEP| LowProvider: COERCE(K=feffe9928665731c6d6a8f9467308308feffe9928665731c6d6a8f9467308308)
Test.StAE: c0 size=33 data=000000000000000017b5db7a6412522a62d32d2b5a94a9348c80cbc7b20bdcfa5c.
Test.StAE: c1 size=28 data=0000000000000001a93cd0e67431db38a93a169cd79b29c82f69d7e4.
Test.StAE: start.
Test.StAE: decryption fails on wrong cipher.
Test.StAE: decryption fails on wrong sequence number.
Test.StAE: decryption fails on wrong CT.
Test.StAE: first decryption succeeds.
Test.StAE: second decryption succeeds.
AEP| LowProvider: COERCE(K=feffe9928665731c6d6a8f9467308308feffe9928665731c6d6a8f9467308308)
Test.StAE: c0 size=26 data=d12a84f232589f6bc797322d5f5d3f43e95bc07640538c50dded.
Test.StAE: c1 size=21 data=2adba81a76d2814ee2aba4406c861ecbc19825461a.
Test.StAE: start.
Test.StAE: decryption fails on wrong cipher.
Test.StAE: decryption fails on wrong sequence number.
Test.StAE: TLS 1.3 does not intend to provide outer CT authentication.
Test.StAE: first decryption succeeds.
Test.StAE: second decryption succeeds.
✔ StAE
Test.CommonDH: Testing FFDHE2048.
CDH| Keygen on FFDHE2048
CDH| DH responder on FFDHE2048
CDH| Keygen on FFDHE2048
CDH| DH initiator on FFDHE2048
CDH| DH initiator on FFDHE2048
Test.CommonDH: Testing FFDHE3072.
CDH| Keygen on FFDHE3072
CDH| DH responder on FFDHE3072
CDH| Keygen on FFDHE3072
CDH| DH initiator on FFDHE3072
CDH| DH initiator on FFDHE3072
Test.CommonDH: Testing FFDHE4096.
CDH| Keygen on FFDHE4096
CDH| DH responder on FFDHE4096
CDH| Keygen on FFDHE4096
CDH| DH initiator on FFDHE4096
CDH| DH initiator on FFDHE4096
Test.CommonDH: Testing FFDHE6144.
CDH| Keygen on FFDHE6144
CDH| DH responder on FFDHE6144
CDH| Keygen on FFDHE6144
CDH| DH initiator on FFDHE6144
CDH| DH initiator on FFDHE6144
Test.CommonDH: Testing FFDHE8192.
CDH| Keygen on FFDHE8192
CDH| DH responder on FFDHE8192
CDH| Keygen on FFDHE8192
CDH| DH initiator on FFDHE8192
CDH| DH initiator on FFDHE8192
Test.CommonDH: Testing P256.
CDH| Keygen on P256
CDH| DH responder on P256
CDH| Keygen on P256
CDH| DH initiator on P256
CDH| DH initiator on P256
Test.CommonDH: Testing P384.
CDH| Keygen on P384
CDH| DH responder on P384
CDH| Keygen on P384
CDH| DH initiator on P384
CDH| DH initiator on P384
Test.CommonDH: Testing P521.
CDH| Keygen on P521
CDH| DH responder on P521
CDH| Keygen on P521
CDH| DH initiator on P521
CDH| DH initiator on P521
Test.CommonDH: Testing X255519.
CDH| Keygen on X255519
CDH| DH responder on X255519
CDH| Keygen on X255519
CDH| DH initiator on X255519
CDH| DH initiator on X255519
✔ CommonDH
HS | next_fragment
HS | offering ClientHello 1.3
KS | ks_client_init 1.3
CDH| Keygen on X255519
NGO| No PSK or 0-RTT disabled
NGO| offering client extensions [ supported_versions key_share extended_master_secret signature_algorithms ec_point_formats supported_groups psk_key_exchange_modes ]
NGO| offering cipher suites ; TLS_AES_128_GCM_SHA256; TLS_AES_256_GCM_SHA384; TLS_CHACHA20_POLY1305_SHA256; TLS_ECDHE_ECDSA_WITH_AES_128_GCM_SHA256; TLS_ECDHE_RSA_WITH_AES_128_GCM_SHA256; TLS_DHE_RSA_WITH_AES_128_GCM_SHA256; TLS_ECDHE_ECDSA_WITH_AES_256_GCM_SHA384; TLS_ECDHE_RSA_WITH_AES_256_GCM_SHA384; TLS_DHE_RSA_WITH_AES_256_GCM_SHA384; TLS_ECDHE_ECDSA_WITH_CHACHA20_POLY1305_SHA256; TLS_ECDHE_RSA_WITH_CHACHA20_POLY1305_SHA256; TLS_DHE_RSA_WITH_CHACHA20_POLY1305_SHA256
HSL| emit ClientHello
Test.Handshake: ----client-hello---> 010000b303035aecc688...010100002d0003020001 (183 bytes).
HS | recv_fragment
HSL| parsed [ClientHello] -- end of flight 
HS | Processing ClientHello
NGO| offered client extensions [ supported_versions key_share extended_master_secret signature_algorithms ec_point_formats supported_groups psk_key_exchange_modes ]
NGO| offered cipher suites ; TLS_AES_128_GCM_SHA256; TLS_AES_256_GCM_SHA384; TLS_CHACHA20_POLY1305_SHA256; TLS_ECDHE_ECDSA_WITH_AES_128_GCM_SHA256; TLS_ECDHE_RSA_WITH_AES_128_GCM_SHA256; TLS_DHE_RSA_WITH_AES_128_GCM_SHA256; TLS_ECDHE_ECDSA_WITH_AES_256_GCM_SHA384; TLS_ECDHE_RSA_WITH_AES_256_GCM_SHA384; TLS_DHE_RSA_WITH_AES_256_GCM_SHA384; TLS_ECDHE_ECDSA_WITH_CHACHA20_POLY1305_SHA256; TLS_ECDHE_RSA_WITH_CHACHA20_POLY1305_SHA256; TLS_DHE_RSA_WITH_CHACHA20_POLY1305_SHA256
NGO| offered versions 1.3
NGO| Negotiated Pure EDH key exchange
NGO| Negotiated ECDSA_SHA1
NGO| Negotiation callback to handle extra extensions and query for stateless retry.
NGO| Application data in cookie: none
NGO| negotiated 1.3 TLS_AES_128_GCM_SHA256
KS | ks_server_init
KS | No PSK selected.
KS | Computed early secret:           33ad0a1c607ec03b09e6cd9893680ce210adf300aa1f2660e1b22e10f170f92a
KS | Handshake salt:                  6f2615a108c702c5678f54fc9dbab69716c076189c48250cebeac3576c3611ba
CDH| DH responder on X255519
CDH| Keygen on X255519
CDH| DH initiator on X255519
KS | DH shared secret: 293d5fd75c799ff6f642e1ceebe809eeb0539733eb87f84261682304aff6be3a
KS | Handshake secret:                579df3866e9b419100ff3d653860d442b573a4b4d843dc4e6331052bc5a88584
NGO| processing client extensions [ supported_versions key_share extended_master_secret signature_algorithms ec_point_formats supported_groups psk_key_exchange_modes ]
NGO| including server extensions (SH + EE) [ supported_versions key_share supported_groups ]
NGO| extra extensions from application callback: 
HSL| emit ServerHello and hash
HS | derive handshake keys
KS | ks_server_13_sh, hashed log = d4cc484a3085e9bb7c8c570a57aff1a96defc07a01116aa4e45b25ffe58a8e98
KS | handshake traffic secret[C]:     381be21a40949d3693cf586434626297dd80e35558b3d658ccd47a347f92c22a
KS | handshake traffic secret[S]:     76b7e6916b98335f80e55248bede96a10a8c25926289ed498e9bf035e17f4320
KS | handshake key[C]:                aca5d0cadd2ed337ff8ec89e7935998f, IV=70c03bf5166adb461a07b7c1
KS | handshake key[S]: cb86872da20baa929ae75211608c9c55, IV=860fe6788f8e0634062543e7
AEP| LowProvider: COERCE(K=cb86872da20baa929ae75211608c9c55)
AEP| LowProvider: COERCE(K=aca5d0cadd2ed337ff8ec89e7935998f)
KS | finished key[C]:                 9f496d3d7b421fc06026608d2c0767f7fa894f91c39d1679ab6f1d1c2a49960f
KS | finished key[S]:                 ea98d59a7259cc847ecdbc80c2e9cb6b2fbe2b04457a75c081fbf8eb45bd2753
KS | Application salt:                a33351968b36228cd7f45b3c0530884be688b1f2293537d6899d4d7afbedab3e
KS | Application secret:              6f2e38e5d1186e4a4ee42b14602ff34a83a1f6a1bec8e2d3da387a91de1e23d6
HS | next_fragment
Test.Handshake: <---server-hello---- 0200005603035aecc688...1eae13053cb5480ba02e (90 bytes).
HS | recv_fragment
HSL| parsed ServerHello
HSL| end of flight
HS | client_ServerHello
NGO| processing server extensions [ supported_versions key_share ]
NGO| negotiated 1.3 TLS_AES_128_GCM_SHA256
HS | Running TLS 1.3
KS | ks_client_13_sh hashed_log = d4cc484a3085e9bb7c8c570a57aff1a96defc07a01116aa4e45b25ffe58a8e98
KS | no PSK negotiated. Early secret: 33ad0a1c607ec03b09e6cd9893680ce210adf300aa1f2660e1b22e10f170f92a
KS | handshake salt:                  6f2615a108c702c5678f54fc9dbab69716c076189c48250cebeac3576c3611ba
CDH| DH initiator on X255519
KS | DH shared secret: 293d5fd75c799ff6f642e1ceebe809eeb0539733eb87f84261682304aff6be3a
KS | handshake secret:                579df3866e9b419100ff3d653860d442b573a4b4d843dc4e6331052bc5a88584
KS | handshake traffic secret[C]:     381be21a40949d3693cf586434626297dd80e35558b3d658ccd47a347f92c22a
KS | handshake traffic secret[S]:     76b7e6916b98335f80e55248bede96a10a8c25926289ed498e9bf035e17f4320
KS | handshake key[C]:                aca5d0cadd2ed337ff8ec89e7935998f, IV=70c03bf5166adb461a07b7c1
KS | handshake key[S]:                cb86872da20baa929ae75211608c9c55, IV=860fe6788f8e0634062543e7
KS | finished key[C]: 9f496d3d7b421fc06026608d2c0767f7fa894f91c39d1679ab6f1d1c2a49960f
KS | finished key[S]: ea98d59a7259cc847ecdbc80c2e9cb6b2fbe2b04457a75c081fbf8eb45bd2753
KS | application salt:                a33351968b36228cd7f45b3c0530884be688b1f2293537d6899d4d7afbedab3e
KS | application secret:              6f2e38e5d1186e4a4ee42b14602ff34a83a1f6a1bec8e2d3da387a91de1e23d6
AEP| LowProvider: COERCE(K=aca5d0cadd2ed337ff8ec89e7935998f)
AEP| LowProvider: COERCE(K=cb86872da20baa929ae75211608c9c55)
EPO| reader++ 0/-1
HS | next_fragment
HS | prepare Server Finished
HSL| emit EncryptedExtensions
HSL| emit Certificate13 and hash
HSL| emit CertificateVerify and hash
HSL| emit Finished and hash
KS | ks_server_13_sf hashed_log = 9c0ad3061f478bf0db47a891e476aabf98755b5e6b0c56b097e45a3ec0d6f447
KS | application traffic secret[C]:   c279ee373f4a3ae7ea8aaf263de3f019f787b8bde32cbec8c304df7a359fbf57
KS | application traffic secret[S]:   18dad81a0be6bd06b62b35b38e468fdf6914a24943a34d057d9f6839e7e14db0
KS | exporter master secret:          a9cca5d18be78a73551c889f4734204e1674335110205b1ad5576bfe4ee4727e
KS | application key[C]:              98cfe2f8d595b8eb2994cc4961f8b3bd, IV=bc3be605f1fba5f94b992516
KS | application key[S]:              015f8301d9c5222dc5f755f3bea34fd0, IV=7d7a5dfbaf7471237af01e78
AEP| LowProvider: COERCE(K=015f8301d9c5222dc5f755f3bea34fd0)
AEP| LowProvider: COERCE(K=98cfe2f8d595b8eb2994cc4961f8b3bd)
HS | exporting a key
EPO| reader++ 0/-1
Test.Handshake: <--server-finished-- 080000160014000a0010...5f94f9fbdad3a659f98c (709 bytes).
HS | recv_fragment
HSL| parsed EncryptedExtensions
HSL| parsed Certificate13
HSL| parsed CertificateVerify
HSL| parsed Finished
HSL| end of flight
NGO| Nego.clientComplete_13
NGO| EE: supported_groups 
NGO| Negotiation callback to process application extensions.
NGO| Certificate & signature 1.3 callback result: valid
KS | ks_client_13_sf hashed_log = 9c0ad3061f478bf0db47a891e476aabf98755b5e6b0c56b097e45a3ec0d6f447
KS | application traffic secret[C]:   c279ee373f4a3ae7ea8aaf263de3f019f787b8bde32cbec8c304df7a359fbf57
KS | application traffic secret[S]:   18dad81a0be6bd06b62b35b38e468fdf6914a24943a34d057d9f6839e7e14db0
KS | exporter master secret:          a9cca5d18be78a73551c889f4734204e1674335110205b1ad5576bfe4ee4727e
KS | application key[C]:              98cfe2f8d595b8eb2994cc4961f8b3bd, IV=bc3be605f1fba5f94b992516
KS | application key[S]:              015f8301d9c5222dc5f755f3bea34fd0, IV=7d7a5dfbaf7471237af01e78
AEP| LowProvider: COERCE(K=98cfe2f8d595b8eb2994cc4961f8b3bd)
AEP| LowProvider: COERCE(K=015f8301d9c5222dc5f755f3bea34fd0)
HS | exporting a key
HS | Early data rejected
EPO| writer++ 0/0
HSL| emit Finished and hash
KS | ks_client_13_cf hashed_log = 0bc2d544c835403c70bc1ec607eaf6c0e5cd3317e7c92516505d80f15f6ca141
KS | resumption master secret:        9a361573a24d26e0108b1bf24f1c3be7ad22242c5dfb6316813efa8bc99fc45a
EPO| reader++ 1/0
HS | next_fragment
Test.Handshake: --client-finished---> 1400002003f145a6e523...9b353c6b60fc450922bd (36 bytes).
HS | recv_fragment
HSL| parsed Finished
HSL| end of flight
HS | Process Client Finished
KS | ks_server_13_cf hashed_log = 0bc2d544c835403c70bc1ec607eaf6c0e5cd3317e7c92516505d80f15f6ca141
KS | resumption master secret:        9a361573a24d26e0108b1bf24f1c3be7ad22242c5dfb6316813efa8bc99fc45a
AEP| LowProvider: COERCE(K=a7ee8c956dcdd3423e1fa060f8c0db980cb474b31ecb0ffc57ac4721983bfceb)
HS | Sending ticket: 7d38242fa5efaafd002d29c430f185f0353caf9d3a63a30cc1ee7c1ce8f794d55e4974513f0d821397f175422abd7fe08f49f6e17a1848a5914dbe5d2234a5111986a6768d22f9ae5b6eb655
HSL| emit NewSessionTicket13
EPO| reader++ 1/-1
HS | next_fragment
Test.Handshake: <--session-ticket-- 0400006500000e108e58...8d22f9ae5b6eb6550000 (105 bytes).
HS | recv_fragment
HSL| parsed NewSessionTicket13
HSL| end of flight
HS | Received ticket: 7d38242fa5efaafd002d29c430f185f0353caf9d3a63a30cc1ee7c1ce8f794d55e4974513f0d821397f175422abd7fe08f49f6e17a1848a5914dbe5d2234a5111986a6768d22f9ae5b6eb655
KS | ks_client_13_rms
KS | Recall RMS: 9a361573a24d26e0108b1bf24f1c3be7ad22242c5dfb6316813efa8bc99fc45a
Test.Handshake: Done.
✔ Handshake
make[2]: Leaving directory '/cygdrive/c/build/agent1/_work/6/s/mitls-fstar/src/tls/extract/Kremlin-Internal-Test'
make[1]: Entering directory '/cygdrive/c/build/agent1/_work/6/s/mitls-fstar/src/tls'
OCAMLPATH="C:/build/agent1/_work/6/s/FStar/bin" ocamlfind opt -g -I C:/build/agent1/_work/6/s/FStar/ulib/ml -I extract/OCaml -I C:/build/agent1/_work/6/s/MLCrypto -I ../../libs/ffi -I C:/build/agent1/_work/6/s/hacl-star/secure_api/LowCProvider -I C:/build/agent1/_work/6/s/hacl-star/secure_api/out/runtime_switch/ -I C:/build/agent1/_work/6/s/kremlin/_build/kremlib -I test -I extract/mlstubs -I . -package fstarlib,zarith,ctypes,ctypes.foreign -cclib -L../pki -cclib -lmipki -linkall -linkpkg -g extract/OCaml/BufferBytes.cmx extract/OCaml/Crypto_AEAD_Main.cmx C:/build/agent1/_work/6/s/kremlin/_build/kremlib/C.cmx C:/build/agent1/_work/6/s/MLCrypto/CoreCrypto.cmxa C:/build/agent1/_work/6/s/hacl-star/secure_api/out/runtime_switch/LowC.cmxa ../../libs/ffi/FFICallbacks.cmxa extract/OCaml/Hashing_Spec.cmx extract/OCaml/Hashing_OpenSSL.cmx extract/OCaml/Hashing.cmx extract/OCaml/Flags.cmx extract/OCaml/TLSError.cmx extract/OCaml/Parse.cmx extract/OCaml/TLSConstants.cmx extract/OCaml/PKI.cmx extract/OCaml/Nonce.cmx extract/OCaml/TLS_Curve25519.cmx extract/OCaml/ECGroup.cmx extract/OCaml/DHGroup.cmx extract/OCaml/DebugFlags.cmx extract/OCaml/CommonDH.cmx extract/OCaml/Hashing_Flags.cmx extract/OCaml/Hashing_CRF.cmx extract/OCaml/PSK.cmx extract/OCaml/Extensions.cmx extract/OCaml/Cert.cmx extract/OCaml/RSAKey.cmx extract/OCaml/PMS.cmx extract/OCaml/TLSInfoFlags.cmx extract/OCaml/TLSInfo.cmx extract/OCaml/Crypto_Indexing.cmx extract/OCaml/Flag.cmx extract/OCaml/Specializations_Providers_AEAD.cmx extract/OCaml/C_Loops.cmx extract/OCaml/AEADOpenssl.cmx extract/OCaml/AEADProvider.cmx extract/OCaml/Range.cmx extract/OCaml/HandshakeMessages.cmx extract/OCaml/HandshakeLog.cmx extract/OCaml/FStar_Kremlin_Endianness.cmx extract/OCaml/Test_BufferBytes.cmx extract/OCaml/Ticket.cmx extract/OCaml/HMAC.cmx extract/OCaml/TLSPRF.cmx extract/OCaml/HMAC_UFCMA.cmx extract/OCaml/DataStream.cmx extract/OCaml/Alert.cmx extract/OCaml/Content.cmx extract/OCaml/StreamPlain.cmx extract/OCaml/StreamAE.cmx extract/OCaml/StatefulPlain.cmx extract/OCaml/LHAEPlain.cmx extract/OCaml/AEAD_GCM.cmx extract/OCaml/StatefulLHAE.cmx extract/OCaml/StAE.cmx extract/OCaml/HKDF.cmx extract/OCaml/KeySchedule.cmx extract/OCaml/Negotiation.cmx extract/OCaml/Epochs.cmx extract/OCaml/Handshake.cmx extract/OCaml/FStar_Test.cmx extract/OCaml/Test_CommonDH.cmx extract/OCaml/Transport.cmx extract/OCaml/Record.cmx extract/OCaml/Connection.cmx extract/OCaml/StreamDeltas.cmx extract/OCaml/TLS.cmx extract/OCaml/FFI.cmx extract/OCaml/QUIC.cmx extract/OCaml/Test_StAE.cmx extract/OCaml/Test_TLSConstants.cmx extract/OCaml/Test_Handshake.cmx extract/OCaml/Test_AEAD.cmx extract/OCaml/Test_Main.cmx extract/OCaml/FFIRegister.cmx extract/copied/kremstr.o test/mitls.cmx -o mitls.exe -thread
make[1]: Leaving directory '/cygdrive/c/build/agent1/_work/6/s/mitls-fstar/src/tls'
make[1]: Entering directory '/cygdrive/c/build/agent1/_work/6/s/mitls-fstar/src/tls'
./mitls.exe
✔ RNG initialization
b1 = 1234567890abcdef1234567890abcdef
b2 = cafedecafbabedeadbeeffeec0ffee33
b12= 1234567890abcdef1234567890abcdefcafedecafbabedeadbeeffeec0ffee33
+ cd mitls-fstar/apps/cmitls
b3 = 1234567890abcdef1234567890abcdefcafedecafbabedeadbeeffeec0ffee33
+ make test
✔ BufferBytes
✔ TLSConstants
✔ AEAD
AEP| LowCProvider: COERCE(K=feffe9928665731c6d6a8f9467308308feffe9928665731c6d6a8f9467308308)
Test.StAE: c0 size=33 data=000000000000000017b5db7a6412522a62d32d2b5a94a9348c80cbc7b20bdcfa5c.
Test.StAE: c1 size=28 data=0000000000000001a93cd0e67431db38a93a169cd79b29c82f69d7e4.
Test.StAE: start.
Test.StAE: decryption fails on wrong cipher.
Test.StAE: decryption fails on wrong sequence number.
Test.StAE: decryption fails on wrong CT.
Test.StAE: first decryption succeeds.
Test.StAE: second decryption succeeds.
AEP| LowCProvider: COERCE(K=feffe9928665731c6d6a8f9467308308feffe9928665731c6d6a8f9467308308)
Test.StAE: c0 size=26 data=d12a84f232589f6bc797322d5f5d3f43e95bc07640538c50dded.
Test.StAE: c1 size=21 data=2adba81a76d2814ee2aba4406c861ecbc19825461a.
Test.StAE: start.
Test.StAE: decryption fails on wrong cipher.
Test.StAE: decryption fails on wrong sequence number.
Test.StAE: TLS 1.3 does not intend to provide outer CT authentication.
Test.StAE: first decryption succeeds.
Test.StAE: second decryption succeeds.
✔ StAE
Test.CommonDH: Testing FFDHE2048.
CDH| Keygen on FFDHE2048
CDH| DH responder on FFDHE2048
CDH| Keygen on FFDHE2048
CDH| DH initiator on FFDHE2048
CDH| DH initiator on FFDHE2048
Test.CommonDH: Testing FFDHE3072.
CDH| Keygen on FFDHE3072
CDH| DH responder on FFDHE3072
CDH| Keygen on FFDHE3072
CDH| DH initiator on FFDHE3072
CDH| DH initiator on FFDHE3072
Test.CommonDH: Testing FFDHE4096.
CDH| Keygen on FFDHE4096
CDH| DH responder on FFDHE4096
CDH| Keygen on FFDHE4096
CDH| DH initiator on FFDHE4096
CDH| DH initiator on FFDHE4096
Test.CommonDH: Testing FFDHE6144.
CDH| Keygen on FFDHE6144
CDH| DH responder on FFDHE6144
CDH| Keygen on FFDHE6144
CDH| DH initiator on FFDHE6144
CDH| DH initiator on FFDHE6144
Test.CommonDH: Testing FFDHE8192.
CDH| Keygen on FFDHE8192
CDH| DH responder on FFDHE8192
CDH| Keygen on FFDHE8192
CDH| DH initiator on FFDHE8192
CDH| DH initiator on FFDHE8192
Test.CommonDH: Testing P256.
CDH| Keygen on P256
CDH| DH responder on P256
CDH| Keygen on P256
CDH| DH initiator on P256
CDH| DH initiator on P256
Test.CommonDH: Testing P384.
CDH| Keygen on P384
CDH| DH responder on P384
CDH| Keygen on P384
CDH| DH initiator on P384
CDH| DH initiator on P384
Test.CommonDH: Testing P521.
CDH| Keygen on P521
CDH| DH responder on P521
CDH| Keygen on P521
CDH| DH initiator on P521
CDH| DH initiator on P521
Test.CommonDH: Testing X255519.
CDH| Keygen on X255519
CDH| DH responder on X255519
CDH| Keygen on X255519
CDH| DH initiator on X255519
CDH| DH initiator on X255519
✔ CommonDH
HS | next_fragment
HS | offering ClientHello 1.3
KS | ks_client_init 1.3
CDH| Keygen on X255519
NGO| No PSK or 0-RTT disabled
NGO| offering client extensions [ supported_versions key_share extended_master_secret signature_algorithms ec_point_formats supported_groups psk_key_exchange_modes ]
NGO| offering cipher suites ; TLS_AES_128_GCM_SHA256; TLS_AES_256_GCM_SHA384; TLS_CHACHA20_POLY1305_SHA256; TLS_ECDHE_ECDSA_WITH_AES_128_GCM_SHA256; TLS_ECDHE_RSA_WITH_AES_128_GCM_SHA256; TLS_DHE_RSA_WITH_AES_128_GCM_SHA256; TLS_ECDHE_ECDSA_WITH_AES_256_GCM_SHA384; TLS_ECDHE_RSA_WITH_AES_256_GCM_SHA384; TLS_DHE_RSA_WITH_AES_256_GCM_SHA384; TLS_ECDHE_ECDSA_WITH_CHACHA20_POLY1305_SHA256; TLS_ECDHE_RSA_WITH_CHACHA20_POLY1305_SHA256; TLS_DHE_RSA_WITH_CHACHA20_POLY1305_SHA256
HSL| emit ClientHello
Test.Handshake: ----client-hello---> 010000b303035aecc68c...010100002d0003020001 (183 bytes).
HS | recv_fragment
HSL| parsed [ClientHello] -- end of flight 
HS | Processing ClientHello
NGO| offered client extensions [ supported_versions key_share extended_master_secret signature_algorithms ec_point_formats supported_groups psk_key_exchange_modes ]
NGO| offered cipher suites ; TLS_AES_128_GCM_SHA256; TLS_AES_256_GCM_SHA384; TLS_CHACHA20_POLY1305_SHA256; TLS_ECDHE_ECDSA_WITH_AES_128_GCM_SHA256; TLS_ECDHE_RSA_WITH_AES_128_GCM_SHA256; TLS_DHE_RSA_WITH_AES_128_GCM_SHA256; TLS_ECDHE_ECDSA_WITH_AES_256_GCM_SHA384; TLS_ECDHE_RSA_WITH_AES_256_GCM_SHA384; TLS_DHE_RSA_WITH_AES_256_GCM_SHA384; TLS_ECDHE_ECDSA_WITH_CHACHA20_POLY1305_SHA256; TLS_ECDHE_RSA_WITH_CHACHA20_POLY1305_SHA256; TLS_DHE_RSA_WITH_CHACHA20_POLY1305_SHA256
NGO| offered versions 1.3
NGO| Negotiated Pure EDH key exchange
NGO| Negotiated ECDSA_SHA1
NGO| Negotiation callback to handle extra extensions and query for stateless retry.
NGO| Application data in cookie: none
NGO| negotiated 1.3 TLS_AES_128_GCM_SHA256
KS | ks_server_init
KS | No PSK selected.
KS | Computed early secret:           33AD0A1C607EC03B09E6CD9893680CE210ADF300AA1F2660E1B22E10F170F92A
KS | Handshake salt:                  6F2615A108C702C5678F54FC9DBAB69716C076189C48250CEBEAC3576C3611BA
CDH| DH responder on X255519
CDH| Keygen on X255519
CDH| DH initiator on X255519
KS | DH shared secret: 364F470AD3E5C596ED20ED0EEC953F63ADA6E2FD09B41B358F360390D711A721
KS | Handshake secret:                3705A4CD0C17488AF0AC95656A892CEF38CAC2CDCCDA85AE8CE57669D1648535
NGO| processing client extensions [ supported_versions key_share extended_master_secret signature_algorithms ec_point_formats supported_groups psk_key_exchange_modes ]
NGO| including server extensions (SH + EE) [ supported_versions key_share supported_groups ]
NGO| extra extensions from application callback: 
HSL| emit ServerHello and hash
HS | derive handshake keys
KS | ks_server_13_sh, hashed log = 9DB052117F9A18EAB7B4683323DAAFFAB5C026135AAF54C0EB50131F2243C7C2
KS | handshake traffic secret[C]:     3F19B79208D5CF971CCB28E05FEF5C405258470053A07A4D1FD87B5BB5D27E03
KS | handshake traffic secret[S]:     0E8047667638304B9A119CD0BEE1F1296B4EB1EA548ABEA56A935909B74594C6
KS | handshake key[C]:                2E1326E515288D3DD5E461050D750F98, IV=46487D426ABC4455FB603489
KS | handshake key[S]: 8664ED415D7A0B48285CD979E47ABD82, IV=7D456FAF10343697AEEE138B
AEP| LowCProvider: COERCE(K=8664ed415d7a0b48285cd979e47abd82)
AEP| LowCProvider: COERCE(K=2e1326e515288d3dd5e461050d750f98)
KS | finished key[C]:                 119C50012FF965557720BB53707D42C654083711FCF37C34CCD9B909B8743A99
KS | finished key[S]:                 1B243148B36CF74729CF6D4E9C114A0A260E29CACAFF06AD8C88D099CBE0B5DD
KS | Application salt:                03CD053C782189128D18BCEC19AD25737B41B8DA243781928BBA88AF853C95BB
KS | Application secret:              E62911F027CCB94A636945E9A986FEE98A58F366901F11602EB973A8CE913C63
HS | next_fragment
Test.Handshake: <---server-hello---- 0200005603035aecc68c...8de085195c17cd8b3307 (90 bytes).
HS | recv_fragment
HSL| parsed ServerHello
HSL| end of flight
HS | client_ServerHello
NGO| processing server extensions [ supported_versions key_share ]
NGO| negotiated 1.3 TLS_AES_128_GCM_SHA256
HS | Running TLS 1.3
KS | ks_client_13_sh hashed_log = 9DB052117F9A18EAB7B4683323DAAFFAB5C026135AAF54C0EB50131F2243C7C2
KS | no PSK negotiated. Early secret: 33AD0A1C607EC03B09E6CD9893680CE210ADF300AA1F2660E1B22E10F170F92A
KS | handshake salt:                  6F2615A108C702C5678F54FC9DBAB69716C076189C48250CEBEAC3576C3611BA
CDH| DH initiator on X255519
KS | DH shared secret: 364F470AD3E5C596ED20ED0EEC953F63ADA6E2FD09B41B358F360390D711A721
KS | handshake secret:                3705A4CD0C17488AF0AC95656A892CEF38CAC2CDCCDA85AE8CE57669D1648535
KS | handshake traffic secret[C]:     3F19B79208D5CF971CCB28E05FEF5C405258470053A07A4D1FD87B5BB5D27E03
KS | handshake traffic secret[S]:     0E8047667638304B9A119CD0BEE1F1296B4EB1EA548ABEA56A935909B74594C6
KS | handshake key[C]:                2E1326E515288D3DD5E461050D750F98, IV=46487D426ABC4455FB603489
KS | handshake key[S]:                8664ED415D7A0B48285CD979E47ABD82, IV=7D456FAF10343697AEEE138B
KS | finished key[C]: 119C50012FF965557720BB53707D42C654083711FCF37C34CCD9B909B8743A99
KS | finished key[S]: 1B243148B36CF74729CF6D4E9C114A0A260E29CACAFF06AD8C88D099CBE0B5DD
KS | application salt:                03CD053C782189128D18BCEC19AD25737B41B8DA243781928BBA88AF853C95BB
KS | application secret:              E62911F027CCB94A636945E9A986FEE98A58F366901F11602EB973A8CE913C63
AEP| LowCProvider: COERCE(K=2e1326e515288d3dd5e461050d750f98)
AEP| LowCProvider: COERCE(K=8664ed415d7a0b48285cd979e47abd82)
EPO| reader++ 0/-1
HS | next_fragment
HS | prepare Server Finished
HSL| emit EncryptedExtensions
HSL| emit Certificate13 and hash
HSL| emit CertificateVerify and hash
HSL| emit Finished and hash
KS | ks_server_13_sf hashed_log = 30C3D4EA7F391C37798892F9C36A793A5E1A1A87D5C4620DB8BD34711A7E1A86
KS | application traffic secret[C]:   B32A8CEAA56A713F26990CFC48D453D8EB8636F5143F04F500A71A334A22D772
KS | application traffic secret[S]:   5FDAE79828D7BC9C42A20BC209F51FA3BD045EDC5A6285CDF4A5359A9182F662
KS | exporter master secret:          CC9CDAC6A23F6C59C8A7048BF20B11DBCAA63991901EB04DF8EB285DFD5A49C2
KS | application key[C]:              A328C41863863858CD5B0120A47E72A5, IV=A2B2450400F91956F84C0397
KS | application key[S]:              4922BC4E875C1AB914C436777F34EB69, IV=3543B537BFE93FA79DEF44B9
AEP| LowCProvider: COERCE(K=4922bc4e875c1ab914c436777f34eb69)
AEP| LowCProvider: COERCE(K=a328c41863863858cd5b0120a47e72a5)
HS | exporting a key
EPO| reader++ 0/-1
Test.Handshake: <--server-finished-- 080000160014000a0010...a2821247c1ca8cfa81de (709 bytes).
HS | recv_fragment
HSL| parsed EncryptedExtensions
HSL| parsed Certificate13
HSL| parsed CertificateVerify
HSL| parsed Finished
HSL| end of flight
NGO| Nego.clientComplete_13
NGO| EE: supported_groups 
NGO| Negotiation callback to process application extensions.
NGO| Certificate & signature 1.3 callback result: valid
KS | ks_client_13_sf hashed_log = 30C3D4EA7F391C37798892F9C36A793A5E1A1A87D5C4620DB8BD34711A7E1A86
KS | application traffic secret[C]:   B32A8CEAA56A713F26990CFC48D453D8EB8636F5143F04F500A71A334A22D772
KS | application traffic secret[S]:   5FDAE79828D7BC9C42A20BC209F51FA3BD045EDC5A6285CDF4A5359A9182F662
KS | exporter master secret:          CC9CDAC6A23F6C59C8A7048BF20B11DBCAA63991901EB04DF8EB285DFD5A49C2
KS | application key[C]:              A328C41863863858CD5B0120A47E72A5, IV=A2B2450400F91956F84C0397
KS | application key[S]:              4922BC4E875C1AB914C436777F34EB69, IV=3543B537BFE93FA79DEF44B9
AEP| LowCProvider: COERCE(K=a328c41863863858cd5b0120a47e72a5)
AEP| LowCProvider: COERCE(K=4922bc4e875c1ab914c436777f34eb69)
HS | exporting a key
HS | Early data rejected
EPO| writer++ 0/0
HSL| emit Finished and hash
KS | ks_client_13_cf hashed_log = 1411F3B34887533F93A8E91DCC1175AEFA59EEEB1C1E6BC78CEB533725C25BDC
KS | resumption master secret:        206B99130FC3AF559EAFD1D508FE18CB690C868D878C094D6403FEA2EE839067
EPO| reader++ 1/0
HS | next_fragment
Test.Handshake: --client-finished---> 140000204d3c6517d229...380d46e7df91ffbacbed (36 bytes).
HS | recv_fragment
HSL| parsed Finished
HSL| end of flight
HS | Process Client Finished
KS | ks_server_13_cf hashed_log = 1411F3B34887533F93A8E91DCC1175AEFA59EEEB1C1E6BC78CEB533725C25BDC
KS | resumption master secret:        206B99130FC3AF559EAFD1D508FE18CB690C868D878C094D6403FEA2EE839067
AEP| LowCProvider: COERCE(K=1ff979b4da34a5635e22f1fe1e927fec4e45238ba9ff5f7dc51fada154e2e8bc)
HS | Sending ticket: C2E0BCBBEBC27E461B4FADDD505F424849A1E7835CBEDABF6FB309F298A270C75DB4F332C7ABABB28AD6763D11693B23667FD2EEB04779D196BDDC8266B2EF33C6269BFF8129D1848916AF11
HSL| emit NewSessionTicket13
EPO| reader++ 1/-1
HS | next_fragment
Test.Handshake: <--session-ticket-- 0400006500000e100c0b...8129d1848916af110000 (105 bytes).
HS | recv_fragment
HSL| parsed NewSessionTicket13
HSL| end of flight
HS | Received ticket: c2e0bcbbebc27e461b4faddd505f424849a1e7835cbedabf6fb309f298a270c75db4f332c7ababb28ad6763d11693b23667fd2eeb04779d196bddc8266b2ef33c6269bff8129d1848916af11
KS | ks_client_13_rms
KS | Recall RMS: 206b99130fc3af559eafd1d508fe18cb690c868d878c094d6403fea2ee839067
Test.Handshake: Done.
✔ Handshake
make[1]: Leaving directory '/cygdrive/c/build/agent1/_work/6/s/mitls-fstar/src/tls'
./cmitls.exe google.com 443
cmitls.exe ===================
cmitls.exe calling FFI_mitls_init
cmitls.exe about to act as client or server
===============================================
Starting test client...
Read OK, sending HTTP request...
Received 693 bytes of data:
Download speed: 1.#INF00kB/s
HTTP/1.1 301 Moved Permanently
Location: https://www.google.com/
Content-Type: text/html; charset=UTF-8
Date: Fri, 04 May 2018 20:46:04 GMT
Expires: Sun, 03 Jun 2018 20:46:04 GMT
Cache-Control: public, max-age=2592000
Server: gws
Content-Length: 220
X-XSS-Protection: 1; mode=block
X-Frame-Options: SAMEORIGIN
Alt-Svc: hq=":443"; ma=2592000; quic=51303433; quic=51303432; quic=51303431; quic=51303339; quic=51303335,quic=":443"; ma=2592000; v="43,42,41,39,35"

<HTML><HEAD><meta http-equiv="content-type" content="text/html;charset=utf-8">
<TITLE>301 Moved</TITLE></HEAD><BODY>
<H1>301 Moved</H1>
The document has moved
<A HREF="https://www.google.com/">here</A>.
</BODY></HTML>

Closing connection, irrespective of the response
./cmitls.exe tls13.cloudflare.com 443
cmitls.exe ===================
cmitls.exe calling FFI_mitls_init
cmitls.exe about to act as client or server
===============================================
Starting test client...
Read OK, sending HTTP request...
Received 1369 bytes of data:
Download speed: 1.336914kB/s
+ cd mitls-fstar/apps/quicMinusNet
HTTP/1.1 521 Origin Down
Date: Fri, 04 May 2018 20:46:05 GMT
Content-Type: text/html; charset=UTF-8
+ make test
Transfer-Encoding: chunked
Connection: keep-alive
Set-Cookie: __cfduid=d3a4a992826ab467aed3707404aee1fc61525466764; expires=Sat, 04-May-19 20:46:04 GMT; path=/; domain=.cloudflare.com; HttpOnly
Expires: Thu, 01 Jan 1970 00:00:01 GMT
Cache-Control: no-store, no-cache, must-revalidate, post-check=0, pre-check=0
Pragma: no-cache
X-Frame-Options: SAMEORIGIN
Set-Cookie: cf_use_ob=443; expires=Fri, 04-May-18 20:46:35 GMT; path=/
Set-Cookie: cf_ob_info=521:415dd090ea2279a3:SEA; expires=Fri, 04-May-18 20:46:35 GMT; path=/
Strict-Transport-Security: max-age=15780000; includeSubDomains
Expect-CT: max-age=604800, report-uri="https://report-uri.cloudflare.com/cdn-cgi/beacon/expect-ct"
Server: cloudflare
CF-RAY: 415dd090ea2279a3-SEA

11c8
<!DOCTYPE html>
<!--[if lt IE 7]> <html class="no-js ie6 oldie" lang="en-US"> <![endif]-->
<!--[if IE 7]>    <html class="no-js ie7 oldie" lang="en-US"> <![endif]-->
<!--[if IE 8]>    <html class="no-js ie8 oldie" lang="en-US"> <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en-US"> <!--<![endif]-->
<head>
<meta http-equiv="refresh" content="0">

<title>tls13.cloudflare.com | 521: Web server is down</title>
<meta charset="UTF-8" />
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8
Closing connection, irrespective of the response
./quic.exe
server create
client create
client call clen=8192 slen=   0
client done clen= 175 slen=   0 status=would_block
16030300aa010000a603035aecc68d1d5678e886b8bd1dde9ecfc24721e543a9
072087335066f473d9302a0000041303130101000079001a0009ffff00050a0b
0c0d0e002b0003027f1c003300260024001d0020bf4d934205305ed2edbd5a22
92b21f60e741c26aa4b10f893cd7298fd53b01440000000e000c0000096c6f63
616c686f73740010000800060568712d303800170000000d0006000408040403
000a00040002001d002d0003020001
server call clen= 175 slen=8192
@@@@ Nego callback for TLS 1.3 @@@@
Offered extensions:
003d001a0009ffff00050a0b0c0d0e0000000e000c0000096c6f63616c686f73
740010000800060568712d3038000d0006000408040403000a00040002001d
Transport parameters offered:
ffff00050a0b0c0d0e
No application cookie (fist connection).
Adding server transport parameters:
000102
@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
======== TO BE SIGNED <0403>: (130 octets) ========
2020202020202020202020202020202020202020202020202020202020202020
2020202020202020202020202020202020202020202020202020202020202020
544c5320312e332c207365727665722043657274696669636174655665726966
79008762e3a52e4e927ba288d9b29a2b266af16693f834da86b1f5540438c098
2b7f
===================================================
sender done clen= 175 slen= 834 status=server_accept
160303005a0200005603035aecc68d411cfbcfef79bd69eb42e0b83cd873928a
c495f12271fd3bd2b87c3d00130300002e002b00027f1c00330024001d0020f6
ddca6abfc1047ef5b1b176ef4f0f36fbf0e2f79933234e51f18e7b81a7524417
030302debac22d63795ff3311816cd26ac278fb613977cccaeff75d8be3c911f
a8ceb8569d4776a9527940d276dbd1efa15863db766c4f9781bab0201a342d82
df23f8402b9dbe83a648ddaa05f539ec123342fabc4ef20d60228b4541a4a0a2
12a3b4d15802507b32b666989708aa2ac05b064523b389b622ff13649ad38ce9
c95250465177510cf288b4b58fcea8a67112882a05158d52d07aaf1393f80576
61d87432933ae26cbbce4282b5cd1eafb35cfceae2c035318adb732100f7fd78
e828d9e219afd8395fc3b08e66a40ace0ce3e334ea19ef637c0ae95e66678e96
72752b2e690c835fe3d35a38405f247ce68c019be6c421006d40e9d24d679d55
c9f7f4538695a80661ffbb9f749ee5c064c32130d88784b5aea1025fa3210576
09b91276db4228a74d62591edbdb1fb31b85452e48a04893c8985d8d2df2d743
516fc14c5c9d393a03ce9b820b3ae418fd511be22a8a3dcb3d906a4cce7b2621
d3fb1625db4e6f88950f0e4d08db254646d0486319a2edf66a4389b7e627ca0a
b9b6e3e8a90200af1bcaad1e21f058274e777b95a717faea741763fd83c28623
1afe06d0352ccec10a5a2f1bd6a81a5ba6ec855a1d19685f32fbc2f52aa1ae79
a4b9dfbfd2ee9424f2a2a696c1b956eca7acccdbf008855f1a51d65793fc7a5c
b2eb51982908af0578155c8eb1ce35011eada14d84d2ffbea92f2e8eb8d8d96d
50e2ebdb0cb6cdc8e3a54d08f5c4cc9e59ae4f5f6cc26a40cfee02b0c741cba0
4edadc84928758b30178e80e0f3776b580ee2fcf72a207d1a27ec7a50145ddae
fa4f206e01f1a0ad82d99d744c5514b21a9b697022dacac3586a1d81bd00b282
78c94a53beae46ee8fd8728122ea7309aeab995293791ebb68a36786ded46eaa
4a976888ec14f6d57db78d065b951119576a5cb0a1220f236db0442b5da878ce
925d524a9852ec246bc41c7c6f55120d5c9307a4f4aefe3cf91cb2c8aac07cde
b37cf298d5a70241353f813eab88048ccad26dead3a7e6dc3e285fe7d7d332a5
9295
client call clen=8017 slen= 834
@@@@ Nego callback for TLS 1.3 @@@@
Offered extensions:
001b0010000800060568712d3038000a00040002001d001a0003000102
+ set +x
Transport parameters offered:
000102
No application cookie (fist connection).
Adding server transport parameters:
000102
@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
WARNING: chain validation failed, ignoring.
client done clen=  58 slen= 834 status=client_complete
17030300358e2c80bc9c46cc1d1c2a234217f9c8444a93891e60c0d0e53de2b9
e66784ad78e2b5b439ec4767a76c33a579ee3b91e25db09f391d
server call clen=  58 slen=7358
sender done clen=  58 slen=   0 status=server_complete
=== Exporter secret ===
4974b48e2c923d5a986bf63b2497fee60bb4df9eb2a6cf41ca52e3243cedb9db
=== QUIC 1-RTT secrets ===
C: 6a91325e352c413c1d7402b3c58cb7401f6031fa78ce7512eb227b4cd47f5d96
S: 152a4b1d690e48f4323e8c606bf66f0cf90176eabce353c77aa91689acd3f931
=== AEAD client key test ===
1e74c4176771fe798d7027b4aad234b18440cfcdc783bff25297ff
=== Decrypt successful ===
Ok
./quic.exe 0rtt

INITIAL ECDHE HANDSHAKE (NO EARLY SECRET)

server create
client create
client returns would_block clen=175 slen=0
ClientHello[ 175] ---->

@@@@ Nego callback for TLS 1.3 @@@@
Offered extensions:
003d001a0009ffff00050a0b0c0d0e0000000e000c0000096c6f63616c686f73
740010000800060568712d3038000d0006000408040403000a00040002001d
Transport parameters offered:
ffff00050a0b0c0d0e
No application cookie (fist connection).
Adding server transport parameters:
000102
@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
======== TO BE SIGNED <0403>: (130 octets) ========
2020202020202020202020202020202020202020202020202020202020202020
2020202020202020202020202020202020202020202020202020202020202020
544c5320312e332c207365727665722043657274696669636174655665726966
7900d67ac69fa0abd854dd33efca29a8d7228a19ac4d17115d6dc88d52585aec
2921
===================================================
server returns server_accept clen=175 slen=835
secret=4405b23cbf1f8f71d61274c90e21d5c83a05907487dd06e550bdad089f9c76f1
<---- ServerHello;(EncryptedExtensions; Certificate; CertVerify; Finished)[ 835]

@@@@ Nego callback for TLS 1.3 @@@@
Offered extensions:
001b0010000800060568712d3038000a00040002001d001a0003000102
Transport parameters offered:
000102
No application cookie (fist connection).
Adding server transport parameters:
000102
@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
WARNING: chain validation failed, ignoring.
client returns client_complete clen=58 slen=835
secret=4405b23cbf1f8f71d61274c90e21d5c83a05907487dd06e550bdad089f9c76f1
(Finished) [  58] ---->

server returns server_complete clen=58 slen=0
server returns would_block clen=0 slen=135
<---- {Ticket}[ 135]

##### New session ticket received! #####
Host: localhost
Ticket:
80827f1061475c6f1aeea1828fc96710271aaa9a11066f349eb4aba977c05620
641577c08110193e4d993dacdcfa1b45d493f40fa53d2c5d87841c3584fad9e1
76ac204601853817ccd14c8a
########################################
client returns clen=0 slen=135 status=would_block

TICKET-BASED RESUMPTION

server create
client create
client returns client_early_data clen=302 slen=0
early secret=ec21eade16eae5a3d339b513eb504451fa16d8bf0d5794c40d32d63cf4725ede
ClientHello[ 302] ---->

@@@@ Nego callback for TLS 1.3 @@@@
Offered extensions:
003d001a0009ffff00050a0b0c0d0e0000000e000c0000096c6f63616c686f73
740010000800060568712d3038000d0006000408040403000a00040002001d
Transport parameters offered:
ffff00050a0b0c0d0e
No application cookie (fist connection).
Adding server transport parameters:
000102
@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
server returns server_accept_early_data clen=302 slen=196
early secret=ec21eade16eae5a3d339b513eb504451fa16d8bf0d5794c40d32d63cf4725ede
secret=7a2d6543a8312474259ff5a4a58d123ad783fcd32c7e15927de506f9cd9d53c8
<---- ServerHello;(EncryptedExtensions; Certificate; CertVerify; Finished)[ 196]

@@@@ Nego callback for TLS 1.3 @@@@
Offered extensions:
001b0010000800060568712d3038000a00040002001d001a0003000102
Transport parameters offered:
000102
No application cookie (fist connection).
Adding server transport parameters:
000102
@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
client returns client_complete_early_data clen=84 slen=196
secret=7a2d6543a8312474259ff5a4a58d123ad783fcd32c7e15927de506f9cd9d53c8
(Finished) [  84] ---->

server returns clen=84 slen=0 status=server_complete
server returns would_block clen=0 slen=135
<---- {Ticket}[ 135]

##### New session ticket received! #####
Host: localhost
Ticket:
52ab405b400262c9cdb04d81c193e8122c57ee4179b711d3ed46139a56d7f4e1
598421f8e980d9f89b60003640286d5497889fb3c2d1ff98997c0e8e023fef21
06bac3331a8e996a41005417
########################################
client returns clen=0 slen=135 status=would_block
Ok
./quic.exe hrr

STATELESS RETRY TEST

server create
client create
client returns would_block clen=175 slen=0
ClientHello[ 175] ---->

~~~~~~~~~ Client Hello Summary ~~~~~~~~~~~
~ SNI = localhost
~ ALPN = 00060568712d3038
~ Cookie = NULL
~ Extensions = 0079001a0009ffff00050a0b0c0d0e002b0003027f1c003300260024001d0020
67c7382f3e16f3b560902ada95f2e5195520a06a6d31e644a4703a1792a80865
0000000e000c0000096c6f63616c686f73740010000800060568712d30380017
0000000d0006000408040403000a00040002001d002d0003020001
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
@@@@ Nego callback for TLS 1.3 @@@@
Offered extensions:
003d001a0009ffff00050a0b0c0d0e0000000e000c0000096c6f63616c686f73
740010000800060568712d3038000d0006000408040403000a00040002001d
Transport parameters offered:
ffff00050a0b0c0d0e
No application cookie (fist connection).
Adding server transport parameters:
000102
@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
server returns server_stateless_retry clen=175 slen=188
<---- HRR[ 188]

server re-create
client returns would_block clen=308 slen=188
ClientHello2[ 308] ---->

~~~~~~~~~ Client Hello Summary ~~~~~~~~~~~
~ SNI = localhost
~ ALPN = 00060568712d3038
~ Cookie = 48656c6c6f20576f726c64
~ Extensions = 00fe002c0081007f4aba98a72a4d60aba325730d831916c5584193319775e639
902ceec4f05d2fbaeb3aad70c042ffb3a913d28d0f76ca591fde958333c3a924
d9582c519fd90af267518fe9139ed3882733df09d582e499154591d72eb8424d
8aedba18bde4b83bf74cf37a48918f189673fd037603b9606fc95c5195fe8a7e
5543ceee8626b7001a0009ffff00050a0b0c0d0e002b0003027f1c0033002600
24001d002067c7382f3e16f3b560902ada95f2e5195520a06a6d31e644a4703a
1792a808650000000e000c0000096c6f63616c686f7374001000080006056871
2d303800170000000d0006000408040403000a00040002001d002d0003020001
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
@@@@ Nego callback for TLS 1.3 @@@@
Offered extensions:
003d001a0009ffff00050a0b0c0d0e0000000e000c0000096c6f63616c686f73
740010000800060568712d3038000d0006000408040403000a00040002001d
Transport parameters offered:
ffff00050a0b0c0d0e
Stateless cookie found, application contents:
48656c6c6f20576f726c64
Adding server transport parameters:
000102
@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
======== TO BE SIGNED <0403>: (130 octets) ========
2020202020202020202020202020202020202020202020202020202020202020
2020202020202020202020202020202020202020202020202020202020202020
544c5320312e332c207365727665722043657274696669636174655665726966
7900b95622d0b5b04c7da00e84f756e29ce1f80484cfa4c0d9b09462e60819c5
a16e
===================================================
server returns server_accept clen=308 slen=834
secret=11beda1471a545b40244063b20f713c224906812edc9d1ff9ae103e9ba7c1735
<---- ServerHello;(EncryptedExtensions; Certificate; CertVerify; Finished)[ 834]

@@@@ Nego callback for TLS 1.3 @@@@
Offered extensions:
001b0010000800060568712d3038000a00040002001d001a0003000102
Transport parameters offered:
000102
No application cookie (fist connection).
Adding server transport parameters:
000102
@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
WARNING: chain validation failed, ignoring.
client returns client_complete clen=58 slen=834
secret=11beda1471a545b40244063b20f713c224906812edc9d1ff9ae103e9ba7c1735
(Finished) [  58] ---->

server returns server_complete clen=58 slen=0
server returns would_block clen=0 slen=135
<---- {Ticket}[ 135]

##### New session ticket received! #####
Host: localhost
Ticket:
7a1faf747c0c36dff329e4d0ce368180419b6afc465e6ab5f0633bde2fe0b447
9c68d3e3fda6ee01344b64780e2b3b02c10de6f7fa2343e7e3a867bb83deeffb
81c0e1184a4057797582ec4d
########################################
client returns clen=0 slen=135 status=would_block
Ok
================================================================================
