This is /home/everbld/everest-ci/ci
Working directory: /cygdrive/c/build/agent1/_work/13/s
About to run: ./everest --yes -windows -j 16 test
BUILD_SOURCEBRANCHNAME: protz_uint128
BUILD_DEFINITIONNAME: Everest-CI-Windows-fnouint128
BUILD_BUILDID: 21677
DEFINITIONNAME:
Z3 is /home/everbld/everest/z3-4.5.1.1f29cebd4df6-x64-win/bin/z3
# Switching to the everest directory ... now in /cygdrive/c/build/agent1/_work/13/s

exported FSTAR_HOME=C:/build/agent1/_work/13/s/FStar
exported OPENSSL_HOME=C:/build/agent1/_work/13/s/MLCrypto/openssl
exported KREMLIN_HOME=C:/build/agent1/_work/13/s/kremlin
exported VALE_HOME=C:/build/agent1/_work/13/s/vale
exported HACL_HOME=C:/build/agent1/_work/13/s/hacl-star
exported MLCRYPTO_HOME=C:/build/agent1/_work/13/s/MLCrypto
+ hacl-star/secure_api/out/vale_aes_concrete_id/krml-test.exe
exported PATH=/cygdrive/c/build/agent1/_work/13/s/MLCrypto/openssl:/cygdrive/c/build/agent1/_work/13/s/FStar/bin:/cygdrive/c/build/agent1/_work/13/s/kremlin:/home/everbld/.opam/4.05.0+mingw64c/bin:/cygdrive/c/Windows/Microsoft.NET/Framework64/v4.0.30319/:/home/everbld/everest/nuget/bin:/home/everbld/everest/z3-4.5.1.1f29cebd4df6-x64-win/bin:/cygdrive/c/PROGRA~2/MICROS~1.0/VC/bin/amd64:/cygdrive/c/PROGRA~2/MICROS~1.0/VC/bin:/cygdrive/c/PROGRA~2/MICROS~4/F#/4.0/FRAMEW~1/v4.0/:/usr/x86_64-w64-mingw32/sys-root/mingw/bin:/home/everbld/.opam/4.05.0+mingw64c/bin:/cygdrive/c/Windows/Microsoft.NET/Framework64/v4.0.30319/:/home/everbld/everest/nuget/bin:/home/everbld/everest/z3-4.5.1.1f29cebd4df6-x64-win/bin:/cygdrive/c/PROGRA~2/MICROS~1.0/VC/bin/amd64:/cygdrive/c/PROGRA~2/MICROS~1.0/VC/bin:/cygdrive/c/PROGRA~2/MICROS~4/F#/4.0/FRAMEW~1/v4.0/:/usr/x86_64-w64-mingw32/sys-root/mingw/bin:/usr/local/bin:/usr/bin:/cygdrive/c/build/agent1/externals/git/cmd:/cygdrive/c/Python36/Scripts:/cygdrive/c/Python36:/cygdrive/c/Docker/Resources/bin:/cygdrive/c/windows/system32:/cygdrive/c/windows:/cygdrive/c/windows/System32/Wbem:/cygdrive/c/windows/System32/WindowsPowerShell/v1.0:/cygdrive/c/Users/everbld/AppData/Local/Microsoft/WindowsApps:/cygdrive/c/Program Files/Docker/Docker/resources/bin:%USERPROFILE%/.dnx/bin:/cygdrive/c/Program Files/Microsoft DNX/Dnvm:/cygdrive/c/Program Files/Microsoft SQL Server/120/Tools/Binn:/cygdrive/c/Program Files/Microsoft SQL Server/130/Tools/Binn:/cygdrive/c/Program Files/dotnet:/cygdrive/c/Program Files/nodejs:/usr/bin:/cygdrive/c/Program Files/Git/mingw64/bin:/cygdrive/c/Users/everbld/AppData/Roaming/npm:/cygdrive/c/build/agent1/bin:/cygdrive/c/build/agent1/bin
================================================================================
Running tests (commands shown below)
test()
[test] expected output cipher is d31a8d34648e60db7b86afbc53ef7ec2a4aded51296e08fea9e2b5a736ee62d63dbea45e8ca9671282fafb69da92728b1a71de0a9e060b2905d6a5b67ecd3b3692ddbd7f2d778b8c9803aee328091b58fab324e4fad675945585808b4831d7bc3ff4def08e4b7a9de576d26586cec64b61161ae10b594f09e26a7e902ecbd0600691
+ hacl-star/secure_api/out/hacl_aes_concrete_id/krml-test.exe
[test] computed output cipher is d31a8d34648e60db7b86afbc53ef7ec2a4aded51296e08fea9e2b5a736ee62d63dbea45e8ca9671282fafb69da92728b1a71de0a9e060b2905d6a5b67ecd3b3692ddbd7f2d778b8c9803aee328091b58fab324e4fad675945585808b4831d7bc3ff4def08e4b7a9de576d26586cec64b61161ae10b594f09e26a7e902ecbd0600691
[test] cipher is a success
[test] expected output decryption is 4c616469657320616e642047656e746c656d656e206f662074686520636c617373206f66202739393a204966204920636f756c64206f6666657220796f75206f6e6c79206f6e652074697020666f7220746865206675747572652c2073756e73637265656e20776f756c642062652069742e
[test] computed output decryption is 4c616469657320616e642047656e746c656d656e206f662074686520636c617373206f66202739393a204966204920636f756c64206f6666657220796f75206f6e6c79206f6e652074697020666f7220746865206675747572652c2073756e73637265656e20776f756c642062652069742e
[test] decryption is a success
test_aes_gcm_0()
[test] expected output cipher is 58e2fccefa7e3061367f1d57a4e7455a
[test] computed output cipher is 58e2fccefa7e3061367f1d57a4e7455a
[test] cipher is a success
[test] expected output decryption is 
[test] computed output decryption is 
[test] decryption is a success
+ make -C hacl-star/secure_api -f Makefile.extract test
test_aes_gcm_1()
[test] expected output cipher is 530f8afbc74536b9a963b4f1c4cb738b
[test] computed output cipher is 530f8afbc74536b9a963b4f1c4cb738b
[test] cipher is a success
[test] expected output decryption is 
[test] computed output decryption is 
[test] decryption is a success
test_aes_gcm_2()
[test] expected output cipher is cea7403d4d606b6e074ec5d3baf39d18d0d1c8a799996bf0265b98b5d48ab919
[test] computed output cipher is cea7403d4d606b6e074ec5d3baf39d18d0d1c8a799996bf0265b98b5d48ab919
[test] cipher is a success
[test] expected output decryption is 00000000000000000000000000000000
[test] computed output decryption is 00000000000000000000000000000000
[test] decryption is a success
test_aes_gcm_3()
[test] expected output cipher is 522dc1f099567d07f47f37a32a84427d643a8cdcbfe5c0c97598a2bd2555d1aa8cb08e48590dbb3da7b08b1056828838c5f61e6393ba7a0abcc9f662898015adb094dac5d93471bdec1a502270e3cc6c
[test] computed output cipher is 522dc1f099567d07f47f37a32a84427d643a8cdcbfe5c0c97598a2bd2555d1aa8cb08e48590dbb3da7b08b1056828838c5f61e6393ba7a0abcc9f662898015adb094dac5d93471bdec1a502270e3cc6c
[test] cipher is a success
[test] expected output decryption is d9313225f88406e5a55909c5aff5269a86a7a9531534f7da2e4c303d8a318a721c3c0c95956809532fcf0e2449a6b525b16aedf5aa0de657ba637b391aafd255
[test] computed output decryption is d9313225f88406e5a55909c5aff5269a86a7a9531534f7da2e4c303d8a318a721c3c0c95956809532fcf0e2449a6b525b16aedf5aa0de657ba637b391aafd255
[test] decryption is a success
test_aes_gcm_4()
[test] expected output cipher is 522dc1f099567d07f47f37a32a84427d643a8cdcbfe5c0c97598a2bd2555d1aa8cb08e48590dbb3da7b08b1056828838c5f61e6393ba7a0abcc9f66276fc6ece0f4e1768cddf8853bb2d551b
[test] computed output cipher is 522dc1f099567d07f47f37a32a84427d643a8cdcbfe5c0c97598a2bd2555d1aa8cb08e48590dbb3da7b08b1056828838c5f61e6393ba7a0abcc9f66276fc6ece0f4e1768cddf8853bb2d551b
[test] cipher is a success
[test] expected output decryption is d9313225f88406e5a55909c5aff5269a86a7a9531534f7da2e4c303d8a318a721c3c0c95956809532fcf0e2449a6b525b16aedf5aa0de657ba637b39
[test] computed output decryption is d9313225f88406e5a55909c5aff5269a86a7a9531534f7da2e4c303d8a318a721c3c0c95956809532fcf0e2449a6b525b16aedf5aa0de657ba637b39
[test] decryption is a success
test()
[test] expected output cipher is d31a8d34648e60db7b86afbc53ef7ec2a4aded51296e08fea9e2b5a736ee62d63dbea45e8ca9671282fafb69da92728b1a71de0a9e060b2905d6a5b67ecd3b3692ddbd7f2d778b8c9803aee328091b58fab324e4fad675945585808b4831d7bc3ff4def08e4b7a9de576d26586cec64b61161ae10b594f09e26a7e902ecbd0600691
[test] computed output cipher is d31a8d34648e60db7b86afbc53ef7ec2a4aded51296e08fea9e2b5a736ee62d63dbea45e8ca9671282fafb69da92728b1a71de0a9e060b2905d6a5b67ecd3b3692ddbd7f2d778b8c9803aee328091b58fab324e4fad675945585808b4831d7bc3ff4def08e4b7a9de576d26586cec64b61161ae10b594f09e26a7e902ecbd0600691
[test] cipher is a success
[test] expected output decryption is 4c616469657320616e642047656e746c656d656e206f662074686520636c617373206f66202739393a204966204920636f756c64206f6666657220796f75206f6e6c79206f6e652074697020666f7220746865206675747572652c2073756e73637265656e20776f756c642062652069742e
[test] computed output decryption is 4c616469657320616e642047656e746c656d656e206f662074686520636c617373206f66202739393a204966204920636f756c64206f6666657220796f75206f6e6c79206f6e652074697020666f7220746865206675747572652c2073756e73637265656e20776f756c642062652069742e
[test] decryption is a success
test_aes_gcm_0()
[test] expected output cipher is 58e2fccefa7e3061367f1d57a4e7455a
[test] computed output cipher is 58e2fccefa7e3061367f1d57a4e7455a
[test] cipher is a success
[test] expected output decryption is 
[test] computed output decryption is 
[test] decryption is a success
test_aes_gcm_1()
[test] expected output cipher is 530f8afbc74536b9a963b4f1c4cb738b
[test] computed output cipher is 530f8afbc74536b9a963b4f1c4cb738b
[test] cipher is a success
[test] expected output decryption is 
[test] computed output decryption is 
[test] decryption is a success
test_aes_gcm_2()
[test] expected output cipher is cea7403d4d606b6e074ec5d3baf39d18d0d1c8a799996bf0265b98b5d48ab919
[test] computed output cipher is cea7403d4d606b6e074ec5d3baf39d18d0d1c8a799996bf0265b98b5d48ab919
[test] cipher is a success
[test] expected output decryption is 00000000000000000000000000000000
[test] computed output decryption is 00000000000000000000000000000000
[test] decryption is a success
test_aes_gcm_3()
[test] expected output cipher is 522dc1f099567d07f47f37a32a84427d643a8cdcbfe5c0c97598a2bd2555d1aa8cb08e48590dbb3da7b08b1056828838c5f61e6393ba7a0abcc9f662898015adb094dac5d93471bdec1a502270e3cc6c
[test] computed output cipher is 522dc1f099567d07f47f37a32a84427d643a8cdcbfe5c0c97598a2bd2555d1aa8cb08e48590dbb3da7b08b1056828838c5f61e6393ba7a0abcc9f662898015adb094dac5d93471bdec1a502270e3cc6c
[test] cipher is a success
[test] expected output decryption is d9313225f88406e5a55909c5aff5269a86a7a9531534f7da2e4c303d8a318a721c3c0c95956809532fcf0e2449a6b525b16aedf5aa0de657ba637b391aafd255
[test] computed output decryption is d9313225f88406e5a55909c5aff5269a86a7a9531534f7da2e4c303d8a318a721c3c0c95956809532fcf0e2449a6b525b16aedf5aa0de657ba637b391aafd255
[test] decryption is a success
test_aes_gcm_4()
[test] expected output cipher is 522dc1f099567d07f47f37a32a84427d643a8cdcbfe5c0c97598a2bd2555d1aa8cb08e48590dbb3da7b08b1056828838c5f61e6393ba7a0abcc9f66276fc6ece0f4e1768cddf8853bb2d551b
[test] computed output cipher is 522dc1f099567d07f47f37a32a84427d643a8cdcbfe5c0c97598a2bd2555d1aa8cb08e48590dbb3da7b08b1056828838c5f61e6393ba7a0abcc9f66276fc6ece0f4e1768cddf8853bb2d551b
[test] cipher is a success
[test] expected output decryption is d9313225f88406e5a55909c5aff5269a86a7a9531534f7da2e4c303d8a318a721c3c0c95956809532fcf0e2449a6b525b16aedf5aa0de657ba637b39
[test] computed output decryption is d9313225f88406e5a55909c5aff5269a86a7a9531534f7da2e4c303d8a318a721c3c0c95956809532fcf0e2449a6b525b16aedf5aa0de657ba637b39
[test] decryption is a success
make: Entering directory '/cygdrive/c/build/agent1/_work/13/s/hacl-star/secure_api'
C:/build/agent1/_work/13/s/FStar/bin/fstar.exe --print_z3_statistics --use_hints --query_stats --cache_dir ../secure_api/out/runtime_switch/cache --cache_checked_modules --include ../specs --include ../code/bignum --include ../code/experimental/aesgcm --include ../code/lib/kremlin --include ../code/poly1305 --include ../code/hash --include ../code/salsa-family --include C:/build/agent1/_work/13/s/kremlin/kremlib --include ../secure_api --include ../secure_api/aead --include ../secure_api/prf --include ../secure_api/hkdf --include ../secure_api/vale --include ../secure_api/uf1cma --include ../secure_api/utils --include ../secure_api/LowCProvider/fst --include C:/build/agent1/_work/13/s/FStar/contrib/CoreCrypto/fst --include ../secure_api/concrete_specializations --include ../secure_api/concrete_specializations/runtime_switch --include ../secure_api/test --odir ../secure_api/out/runtime_switch/extracted --use_hints --lax \
prims.fst \
--codegen Kremlin \
--extract_module prims
All verification conditions discharged successfully
TOTAL TIME 38 ms: C:\build\agent1\_work\13\s\FStar\bin\fstar.exe --print_z3_statistics --use_hints --query_stats --cache_dir ../secure_api/out/runtime_switch/cache --cache_checked_modules --include ../specs --include ../code/bignum --include ../code/experimental/aesgcm --include ../code/lib/kremlin --include ../code/poly1305 --include ../code/hash --include ../code/salsa-family --include C:/build/agent1/_work/13/s/kremlin/kremlib --include ../secure_api --include ../secure_api/aead --include ../secure_api/prf --include ../secure_api/hkdf --include ../secure_api/vale --include ../secure_api/uf1cma --include ../secure_api/utils --include ../secure_api/LowCProvider/fst --include C:/build/agent1/_work/13/s/FStar/contrib/CoreCrypto/fst --include ../secure_api/concrete_specializations --include ../secure_api/concrete_specializations/runtime_switch --include ../secure_api/test --odir ../secure_api/out/runtime_switch/extracted --use_hints --lax prims.fst --codegen Kremlin --extract_module prims
C:/build/agent1/_work/13/s/kremlin/krml -falloca -ftail-calls -no-prefix KrmlTest -bundle \
Hacl.Impl.Poly1305_64+Hacl.Impl.Chacha20=Hacl.*,Spec,Spec.* -bundle \
Crypto.AEAD.Main=Crypto.* -tmpdir ../secure_api/out/runtime_switch/extracted \
-add-include '"kremlin/internal/compat.h"' \
../secure_api/out/runtime_switch/extracted/prims.krml ../secure_api/out/runtime_switch/extracted/FStar_Pervasives_Native.krml ../secure_api/out/runtime_switch/extracted/FStar_Pervasives.krml ../secure_api/out/runtime_switch/extracted/FStar_Mul.krml ../secure_api/out/runtime_switch/extracted/FStar_Math_Lib.krml ../secure_api/out/runtime_switch/extracted/FStar_Math_Lemmas.krml ../secure_api/out/runtime_switch/extracted/FStar_Squash.krml ../secure_api/out/runtime_switch/extracted/FStar_StrongExcludedMiddle.krml ../secure_api/out/runtime_switch/extracted/FStar_Classical.krml ../secure_api/out/runtime_switch/extracted/FStar_List_Tot_Base.krml ../secure_api/out/runtime_switch/extracted/FStar_List_Tot_Properties.krml ../secure_api/out/runtime_switch/extracted/FStar_List_Tot.krml ../secure_api/out/runtime_switch/extracted/FStar_Seq_Base.krml ../secure_api/out/runtime_switch/extracted/FStar_Seq_Properties.krml ../secure_api/out/runtime_switch/extracted/FStar_Seq.krml ../secure_api/out/runtime_switch/extracted/FStar_BitVector.krml ../secure_api/out/runtime_switch/extracted/FStar_UInt.krml ../secure_api/out/runtime_switch/extracted/FStar_UInt32.krml ../secure_api/out/runtime_switch/extracted/FStar_Int.krml ../secure_api/out/runtime_switch/extracted/FStar_Int64.krml ../secure_api/out/runtime_switch/extracted/FStar_Int63.krml ../secure_api/out/runtime_switch/extracted/FStar_Int32.krml ../secure_api/out/runtime_switch/extracted/FStar_Int16.krml ../secure_api/out/runtime_switch/extracted/FStar_Int8.krml ../secure_api/out/runtime_switch/extracted/FStar_UInt64.krml ../secure_api/out/runtime_switch/extracted/FStar_UInt63.krml ../secure_api/out/runtime_switch/extracted/FStar_UInt16.krml ../secure_api/out/runtime_switch/extracted/FStar_UInt8.krml ../secure_api/out/runtime_switch/extracted/FStar_Int_Cast.krml ../secure_api/out/runtime_switch/extracted/FStar_UInt128.krml ../secure_api/out/runtime_switch/extracted/Hacl_UInt64.krml ../secure_api/out/runtime_switch/extracted/FStar_Preorder.krml ../secure_api/out/runtime_switch/extracted/FStar_Ghost.krml ../secure_api/out/runtime_switch/extracted/FStar_ErasedLogic.krml ../secure_api/out/runtime_switch/extracted/FStar_FunctionalExtensionality.krml ../secure_api/out/runtime_switch/extracted/FStar_Set.krml ../secure_api/out/runtime_switch/extracted/FStar_PropositionalExtensionality.krml ../secure_api/out/runtime_switch/extracted/FStar_PredicateExtensionality.krml ../secure_api/out/runtime_switch/extracted/FStar_TSet.krml ../secure_api/out/runtime_switch/extracted/FStar_Monotonic_Heap.krml ../secure_api/out/runtime_switch/extracted/FStar_Heap.krml ../secure_api/out/runtime_switch/extracted/FStar_Map.krml ../secure_api/out/runtime_switch/extracted/FStar_Monotonic_HyperHeap.krml ../secure_api/out/runtime_switch/extracted/FStar_Monotonic_HyperStack.krml ../secure_api/out/runtime_switch/extracted/FStar_HyperStack.krml ../secure_api/out/runtime_switch/extracted/FStar_Monotonic_Witnessed.krml ../secure_api/out/runtime_switch/extracted/FStar_HyperStack_ST.krml ../secure_api/out/runtime_switch/extracted/FStar_HyperStack_All.krml ../secure_api/out/runtime_switch/extracted/Hacl_UInt128.krml ../secure_api/out/runtime_switch/extracted/Hacl_UInt8.krml ../secure_api/out/runtime_switch/extracted/Hacl_Bignum_Constants.krml ../secure_api/out/runtime_switch/extracted/Hacl_UInt32.krml ../secure_api/out/runtime_switch/extracted/FStar_Int_Cast_Full.krml ../secure_api/out/runtime_switch/extracted/Hacl_Cast.krml ../secure_api/out/runtime_switch/extracted/FStar_Buffer.krml ../secure_api/out/runtime_switch/extracted/Hacl_Bignum_Parameters.krml ../secure_api/out/runtime_switch/extracted/Hacl_Bignum_Wide.krml ../secure_api/out/runtime_switch/extracted/Spec_Loops.krml ../secure_api/out/runtime_switch/extracted/Hacl_Bignum_Limb.krml ../secure_api/out/runtime_switch/extracted/Hacl_Spec_Bignum_Field.krml ../secure_api/out/runtime_switch/extracted/Hacl_Spec_Bignum_Bigint.krml ../secure_api/out/runtime_switch/extracted/Hacl_Spec_Bignum_Modulo.krml ../secure_api/out/runtime_switch/extracted/Hacl_Spec_Bignum_Fproduct.krml ../secure_api/out/runtime_switch/extracted/Hacl_Spec_Bignum_Fmul.krml ../secure_api/out/runtime_switch/extracted/FStar_Endianness.krml ../secure_api/out/runtime_switch/extracted/Spec_Poly1305_Lemmas.krml ../secure_api/out/runtime_switch/extracted/FStar_Kremlin_Endianness.krml ../secure_api/out/runtime_switch/extracted/C_Endianness.krml ../secure_api/out/runtime_switch/extracted/C.krml ../secure_api/out/runtime_switch/extracted/Hacl_UInt16.krml ../secure_api/out/runtime_switch/extracted/Hacl_Spec_Endianness.krml ../secure_api/out/runtime_switch/extracted/Hacl_Endianness.krml ../secure_api/out/runtime_switch/extracted/Spec_Lib.krml ../secure_api/out/runtime_switch/extracted/Seq_Create.krml ../secure_api/out/runtime_switch/extracted/Spec_SHA2_256.krml ../secure_api/out/runtime_switch/extracted/C_Loops.krml ../secure_api/out/runtime_switch/extracted/Hacl_Hash_Lib_LoadStore.krml ../secure_api/out/runtime_switch/extracted/Hacl_Hash_Lib_Create.krml ../secure_api/out/runtime_switch/extracted/Hacl_Impl_SHA2_256_Lemmas.krml ../secure_api/out/runtime_switch/extracted/Hacl_Impl_SHA2_256.krml ../secure_api/out/runtime_switch/extracted/Hacl_Spec_Bignum_Fsum.krml ../secure_api/out/runtime_switch/extracted/Hacl_Bignum_Fsum.krml ../secure_api/out/runtime_switch/extracted/Crypto_AEAD_BufferUtils.krml ../secure_api/out/runtime_switch/extracted/Vale_AES.krml ../secure_api/out/runtime_switch/extracted/Hacl_Impl_Xor_Lemmas.krml ../secure_api/out/runtime_switch/extracted/Spec_CTR_Lemmas.krml ../secure_api/out/runtime_switch/extracted/Spec_CTR.krml ../secure_api/out/runtime_switch/extracted/Hacl_Lib_LoadStore32.krml ../secure_api/out/runtime_switch/extracted/Spec_Chacha20_Lemmas.krml ../secure_api/out/runtime_switch/extracted/Spec_Chacha20.krml ../secure_api/out/runtime_switch/extracted/Hacl_Impl_Chacha20.krml ../secure_api/out/runtime_switch/extracted/Hacl_SecureAPI_Chacha20.krml ../secure_api/out/runtime_switch/extracted/Crypto_Indexing.krml ../secure_api/out/runtime_switch/extracted/Flag.krml ../secure_api/out/runtime_switch/extracted/Crypto_Symmetric_AES.krml ../secure_api/out/runtime_switch/extracted/Crypto_Symmetric_AES128.krml ../secure_api/out/runtime_switch/extracted/FStar_Float.krml ../secure_api/out/runtime_switch/extracted/FStar_Exn.krml ../secure_api/out/runtime_switch/extracted/FStar_ST.krml ../secure_api/out/runtime_switch/extracted/FStar_All.krml ../secure_api/out/runtime_switch/extracted/FStar_IO.krml ../secure_api/out/runtime_switch/extracted/Buffer_Utils.krml ../secure_api/out/runtime_switch/extracted/Crypto_Symmetric_Bytes.krml ../secure_api/out/runtime_switch/extracted/Crypto_Symmetric_Cipher.krml ../secure_api/out/runtime_switch/extracted/C_Nullity.krml ../secure_api/out/runtime_switch/extracted/Hacl_Spec_Bignum_AddAndMultiply.krml ../secure_api/out/runtime_switch/extracted/Spec_Poly1305.krml ../secure_api/out/runtime_switch/extracted/Hacl_Bignum_Modulo.krml ../secure_api/out/runtime_switch/extracted/Hacl_Bignum_Fproduct.krml ../secure_api/out/runtime_switch/extracted/Hacl_Spec_Poly1305_64_State.krml ../secure_api/out/runtime_switch/extracted/Hacl_Spec_Poly1305_64.krml ../secure_api/out/runtime_switch/extracted/Hacl_Impl_Poly1305_64_State.krml ../secure_api/out/runtime_switch/extracted/Hacl_Bignum_Fmul.krml ../secure_api/out/runtime_switch/extracted/Hacl_Bignum_AddAndMultiply.krml ../secure_api/out/runtime_switch/extracted/Hacl_Spe_Poly1305_64.krml ../secure_api/out/runtime_switch/extracted/Hacl_Impl_Poly1305_64.krml ../secure_api/out/runtime_switch/extracted/Spec_GaloisField.krml ../secure_api/out/runtime_switch/extracted/Spec_GF128.krml ../secure_api/out/runtime_switch/extracted/Crypto_Symmetric_GF128.krml ../secure_api/out/runtime_switch/extracted/Crypto_Symmetric_MAC.krml ../secure_api/out/runtime_switch/extracted/Crypto_Symmetric_UF1CMA.krml ../secure_api/out/runtime_switch/extracted/Crypto_Plain.krml ../secure_api/out/runtime_switch/extracted/Crypto_Symmetric_PRF.krml ../secure_api/out/runtime_switch/extracted/Crypto_AEAD_Encoding.krml ../secure_api/out/runtime_switch/extracted/Crypto_AEAD_Invariant.krml ../secure_api/out/runtime_switch/extracted/Crypto_AEAD_Encrypt_Invariant.krml ../secure_api/out/runtime_switch/extracted/Crypto_AEAD_Wrappers_PRF.krml ../secure_api/out/runtime_switch/extracted/Crypto_AEAD_Wrappers_Encoding.krml ../secure_api/out/runtime_switch/extracted/Crypto_AEAD_Wrappers_CMA.krml ../secure_api/out/runtime_switch/extracted/Crypto_AEAD_EnxorDexor.krml ../secure_api/out/runtime_switch/extracted/Crypto_AEAD_Decrypt.krml ../secure_api/out/runtime_switch/extracted/Spec_HMAC_SHA2_256.krml ../secure_api/out/runtime_switch/extracted/Spec_SHA2_512.krml ../secure_api/out/runtime_switch/extracted/Hacl_Impl_SHA2_512_Lemmas.krml ../secure_api/out/runtime_switch/extracted/Hacl_Impl_SHA2_512.krml ../secure_api/out/runtime_switch/extracted/Spec_SHA2_384.krml ../secure_api/out/runtime_switch/extracted/Hacl_Impl_SHA2_384_Lemmas.krml ../secure_api/out/runtime_switch/extracted/Hacl_Impl_SHA2_384.krml ../secure_api/out/runtime_switch/extracted/Crypto_HMAC.krml ../secure_api/out/runtime_switch/extracted/Crypto_AEAD_Encrypt_Ideal_Invariant.krml ../secure_api/out/runtime_switch/extracted/Crypto_AEAD_MAC_Wrapper_Invariant.krml ../secure_api/out/runtime_switch/extracted/Crypto_AEAD_Enxor_Invariant.krml ../secure_api/out/runtime_switch/extracted/Crypto_AEAD_Encrypt.krml ../secure_api/out/runtime_switch/extracted/Crypto_AEAD.krml ../secure_api/out/runtime_switch/extracted/FStar_List.krml ../secure_api/out/runtime_switch/extracted/FStar_Char.krml ../secure_api/out/runtime_switch/extracted/FStar_String.krml ../secure_api/out/runtime_switch/extracted/C_String.krml ../secure_api/out/runtime_switch/extracted/TestLib.krml ../secure_api/out/runtime_switch/extracted/FStar_Bytes.krml ../secure_api/out/runtime_switch/extracted/Crypto_AEAD_Main.krml ../secure_api/out/runtime_switch/extracted/CryptoTypes.krml ../secure_api/out/runtime_switch/extracted/Crypto_HKDF.krml ../secure_api/out/runtime_switch/extracted/HaclProvider.krml ../secure_api/out/runtime_switch/extracted/KrmlTest.krml ../secure_api/out/runtime_switch/extracted/LowCProvider.krml vale/asm/sha256_main_i.o vale/asm/sha256-x86_64.o vale/asm/Vale_Hash_SHA2_256.o vale/asm/vale_aes_glue.o vale/asm/aes-x86_64.o -o ../secure_api/out/runtime_switch/krml-test.exe \
-drop HaclProvider,LowCProvider,CryptoTypes
Warning 10: : -drop is deprecated
use a combination of -bundle and -d reachability to make sure the functions are eliminated as you wish
Warning 6: in top-level declaration Crypto.Plain.create, in file Crypto_AEAD_Main: stack newbuf @1 @0 is a non-constant size, stack-allocated array; this is not supported by CompCert and requires the use of alloca(3) for MSVC
Warning 6: in the definition of keyBuffer, after the definition of h0, in the last element of the sequence, after the definition of macId, in top-level declaration Crypto.Symmetric.PRF.prf_mac, in file Crypto_AEAD_Main: stack newbuf 0uint8 Crypto.Symmetric.UF1CMA.keylen @5 is a non-constant size, stack-allocated array; this is not supported by CompCert and requires the use of alloca(3) for MSVC
Warning 6: in the definition of cipher1, after the definition of cipherlen, in the last element of the sequence, in top-level declaration KrmlTest.test, in file KrmlTest: stack newbuf 0uint8 @0 is a non-constant size, stack-allocated array; this is not supported by CompCert and requires the use of alloca(3) for MSVC
Warning 6: in the definition of cipher1, after the definition of cipherlen, in the last element of the sequence, in top-level declaration KrmlTest.test_aes_gcm, in file KrmlTest: stack newbuf 2uint8 @0 is a non-constant size, stack-allocated array; this is not supported by CompCert and requires the use of alloca(3) for MSVC
Warning 6: in the definition of plain, after the definition of plainlen, in top-level declaration KrmlTest.test_aes_gcm_0, in file KrmlTest: stack newbuf 0uint8 @0 is a non-constant size, stack-allocated array; this is not supported by CompCert and requires the use of alloca(3) for MSVC
Warning 6: in the definition of aad, after the definition of aadlen, in top-level declaration KrmlTest.test_aes_gcm_0, in file KrmlTest: stack newbuf 0uint8 @0 is a non-constant size, stack-allocated array; this is not supported by CompCert and requires the use of alloca(3) for MSVC
Warning 6: in the definition of plain, after the definition of plainlen, in top-level declaration KrmlTest.test_aes_gcm_1, in file KrmlTest: stack newbuf 0uint8 @0 is a non-constant size, stack-allocated array; this is not supported by CompCert and requires the use of alloca(3) for MSVC
Warning 6: in the definition of aad, after the definition of aadlen, in top-level declaration KrmlTest.test_aes_gcm_1, in file KrmlTest: stack newbuf 0uint8 @0 is a non-constant size, stack-allocated array; this is not supported by CompCert and requires the use of alloca(3) for MSVC
Warning 6: in the definition of plain, after the definition of plainlen, in top-level declaration KrmlTest.test_aes_gcm_2, in file KrmlTest: stack newbuf 0uint8 @0 is a non-constant size, stack-allocated array; this is not supported by CompCert and requires the use of alloca(3) for MSVC
Warning 6: in the definition of aad, after the definition of aadlen, in top-level declaration KrmlTest.test_aes_gcm_2, in file KrmlTest: stack newbuf 0uint8 @0 is a non-constant size, stack-allocated array; this is not supported by CompCert and requires the use of alloca(3) for MSVC
Warning 6: in the definition of aad, after the definition of aadlen, in top-level declaration KrmlTest.test_aes_gcm_3, in file KrmlTest: stack newbuf 0uint8 @0 is a non-constant size, stack-allocated array; this is not supported by CompCert and requires the use of alloca(3) for MSVC
[38;5;119m✔[0m [Monomorphization] ⏱️ 78ms
[38;5;119m✔[0m [Inlining] ⏱️ 63ms
[38;5;119m✔[0m [Pattern matches compilation] ⏱️ 63ms
[38;5;119m✔[0m [Simplify 2] ⏱️ 297ms
Warning 14: : FStar.List.Tot.Base.append__uint8_t is recursive but cannot be optimized to a tail-call
Warning 14: : FStar.Seq.Base.create__uint8_t is recursive but cannot be optimized to a tail-call
Warning 14: : Crypto.Symmetric.Bytes.load_bytes is recursive but cannot be optimized to a tail-call
Warning 14: : Crypto.Symmetric.Bytes.load_uint128 is recursive but cannot be optimized to a tail-call
Warning 14: : Crypto.Symmetric.Bytes.store_uint32 is recursive but cannot be optimized to a tail-call
Warning 14: : Crypto.Symmetric.Bytes.store_big32 is recursive but cannot be optimized to a tail-call
Warning 14: : Crypto.Symmetric.Bytes.store_uint128 is recursive but cannot be optimized to a tail-call
Warning 7: : After inlining, Hacl.Bignum.Fproduct.copy_from_wide_ (going into Hacl_Impl_Poly1305_64_Hacl_Impl_Chacha20) calls FStar.UInt128.uint128_to_uint64 (going into FStar) -- removing the static qualifier from FStar.UInt128.uint128_to_uint64
Warning 7: : After inlining, Hacl.Bignum.Fproduct.sum_scalar_multiplication_ (going into Hacl_Impl_Poly1305_64_Hacl_Impl_Chacha20) calls FStar.UInt128.add_mod (going into FStar) -- removing the static qualifier from FStar.UInt128.add_mod
Warning 7: : After inlining, Hacl.Bignum.Fproduct.sum_scalar_multiplication_ (going into Hacl_Impl_Poly1305_64_Hacl_Impl_Chacha20) calls FStar.UInt128.mul_wide (going into FStar) -- removing the static qualifier from FStar.UInt128.mul_wide
Warning 7: : After inlining, Hacl.Bignum.Fproduct.carry_wide_ (going into Hacl_Impl_Poly1305_64_Hacl_Impl_Chacha20) calls FStar.UInt128.shift_right (going into FStar) -- removing the static qualifier from FStar.UInt128.shift_right
[38;5;119m✔[0m [Structs + Simplify 2] ⏱️ 313ms
Warning 7: : After inlining, Hacl.Bignum.Fproduct.carry_wide_ (going into Hacl_Impl_Poly1305_64_Hacl_Impl_Chacha20) calls FStar.UInt128.uint64_to_uint128 (going into FStar) -- removing the static qualifier from FStar.UInt128.uint64_to_uint128
Warning 7: : After inlining, Hacl.Bignum.Fproduct.carry_wide_ (going into Hacl_Impl_Poly1305_64_Hacl_Impl_Chacha20) calls FStar.UInt128.add (going into FStar) -- removing the static qualifier from FStar.UInt128.add
Warning 7: : After inlining, Hacl.Bignum.Modulo.carry_top_wide (going into Hacl_Impl_Poly1305_64_Hacl_Impl_Chacha20) calls FStar.UInt128.logand (going into FStar) -- removing the static qualifier from FStar.UInt128.logand
[38;5;119m✔[0m [Drop] ⏱️ 16ms
Warning 7: : After inlining, Hacl.Impl.Poly1305_64.poly1305_encode_r (going into Hacl_Impl_Poly1305_64_Hacl_Impl_Chacha20) calls FStar.UInt128.shift_left (going into FStar) -- removing the static qualifier from FStar.UInt128.shift_left
[38;5;119m✔[0m [AstToCStar] ⏱️ <1ms
[38;5;119m✔[0m [CStarToC] ⏱️ 16ms
Warning 7: : After inlining, Hacl.Impl.Poly1305_64.poly1305_encode_r (going into Hacl_Impl_Poly1305_64_Hacl_Impl_Chacha20) calls FStar.UInt128.logor (going into FStar) -- removing the static qualifier from FStar.UInt128.logor
Warning 7: : After inlining, Hacl.Impl.Poly1305_64.poly1305_last_pass_ (going into Hacl_Impl_Poly1305_64_Hacl_Impl_Chacha20) calls FStar.UInt64.gte_mask (going into FStar) -- removing the static qualifier from FStar.UInt64.gte_mask
Warning 7: : After inlining, Hacl.Impl.Poly1305_64.poly1305_last_pass_ (going into Hacl_Impl_Poly1305_64_Hacl_Impl_Chacha20) calls FStar.UInt64.eq_mask (going into FStar) -- removing the static qualifier from FStar.UInt64.eq_mask
Warning 7: : After inlining, Crypto.Symmetric.Bytes.uint128_to_uint8 (going into Crypto_AEAD_Main) calls FStar.Int.Cast.Full.uint128_to_uint64 (going into FStar) -- removing the static qualifier from FStar.Int.Cast.Full.uint128_to_uint64
Warning 7: : After inlining, FStar.Seq.Base.createEmpty__uint8_t (going into Crypto_AEAD_Main) calls FStar.Seq.Base.seq__uint8_t (going into Hacl_Impl_Poly1305_64_Hacl_Impl_Chacha20) -- removing the static qualifier from FStar.Seq.Base.seq__uint8_t
Warning 7: : After inlining, FStar.Seq.Base.createEmpty__uint8_t (going into Crypto_AEAD_Main) calls Prims.list__uint8_t (going into Hacl_Impl_Poly1305_64_Hacl_Impl_Chacha20) -- removing the static qualifier from Prims.list__uint8_t
Warning 7: : After inlining, FStar.Seq.Base.createEmpty__uint8_t (going into Crypto_AEAD_Main) calls Prims.list__uint8_t (going into Hacl_Impl_Poly1305_64_Hacl_Impl_Chacha20) -- removing the static qualifier from Prims.list__uint8_t
Warning 7: : After inlining, FStar.Seq.Base.createEmpty__uint8_t (going into Crypto_AEAD_Main) calls Prims.list__uint8_t_tags (going into Hacl_Impl_Poly1305_64_Hacl_Impl_Chacha20) -- removing the static qualifier from Prims.list__uint8_t_tags
Warning 7: : After inlining, FStar.Seq.Base.create__uint8_t (going into Crypto_AEAD_Main) calls Prims.op_Subtraction (going into Prims) -- removing the static qualifier from Prims.op_Subtraction
Warning 7: : After inlining, Crypto.Symmetric.GF128.gf128_add (going into Crypto_AEAD_Main) calls FStar.UInt128.logxor (going into FStar) -- removing the static qualifier from FStar.UInt128.logxor
Warning 7: : After inlining, Crypto.Symmetric.GF128.gf128_shift_reduce (going into Crypto_AEAD_Main) calls FStar.UInt128.eq_mask (going into FStar) -- removing the static qualifier from FStar.UInt128.eq_mask
Warning 7: : After inlining, Crypto.Symmetric.MAC.update (going into Crypto_AEAD_Main) calls Hacl.Impl.Poly1305_64.State.poly1305_state (going into Hacl_Impl_Poly1305_64_Hacl_Impl_Chacha20) -- removing the static qualifier from Hacl.Impl.Poly1305_64.State.poly1305_state
Warning 8: : After inlining, Crypto.Symmetric.MAC.update (going into Crypto_AEAD_Main) calls Hacl.Impl.Poly1305_64.poly1305_update (going into Hacl_Impl_Poly1305_64_Hacl_Impl_Chacha20). This is a call across translation units but Hacl.Impl.Poly1305_64.poly1305_update has a C "inline" qualifier. The C standard allows removing Hacl.Impl.Poly1305_64.poly1305_update from its translation unit (see C11 6.7.3 §5), and CompCert will do it. 
Warning 8: : After inlining, Crypto.Symmetric.MAC.finish (going into Crypto_AEAD_Main) calls Hacl.Impl.Poly1305_64.poly1305_process_last_block (going into Hacl_Impl_Poly1305_64_Hacl_Impl_Chacha20). This is a call across translation units but Hacl.Impl.Poly1305_64.poly1305_process_last_block has a C "inline" qualifier. The C standard allows removing Hacl.Impl.Poly1305_64.poly1305_process_last_block from its translation unit (see C11 6.7.3 §5), and CompCert will do it. 
Warning 8: : After inlining, Crypto.Symmetric.Cipher.compute (going into Crypto_AEAD_Main) calls Hacl.Impl.Chacha20.setup (going into Hacl_Impl_Poly1305_64_Hacl_Impl_Chacha20). This is a call across translation units but Hacl.Impl.Chacha20.setup has a C "inline" qualifier. The C standard allows removing Hacl.Impl.Chacha20.setup from its translation unit (see C11 6.7.3 §5), and CompCert will do it. 
Warning 8: : After inlining, Crypto.Symmetric.Cipher.compute (going into Crypto_AEAD_Main) calls Hacl.Impl.Chacha20.copy_state (going into Hacl_Impl_Poly1305_64_Hacl_Impl_Chacha20). This is a call across translation units but Hacl.Impl.Chacha20.copy_state has a C "inline" qualifier. The C standard allows removing Hacl.Impl.Chacha20.copy_state from its translation unit (see C11 6.7.3 §5), and CompCert will do it. 
Warning 8: : After inlining, Crypto.Symmetric.Cipher.compute (going into Crypto_AEAD_Main) calls Hacl.Impl.Chacha20.rounds (going into Hacl_Impl_Poly1305_64_Hacl_Impl_Chacha20). This is a call across translation units but Hacl.Impl.Chacha20.rounds has a C "inline" qualifier. The C standard allows removing Hacl.Impl.Chacha20.rounds from its translation unit (see C11 6.7.3 §5), and CompCert will do it. 
Warning 8: : After inlining, Crypto.Symmetric.Cipher.compute (going into Crypto_AEAD_Main) calls Hacl.Impl.Chacha20.sum_states (going into Hacl_Impl_Poly1305_64_Hacl_Impl_Chacha20). This is a call across translation units but Hacl.Impl.Chacha20.sum_states has a C "inline" qualifier. The C standard allows removing Hacl.Impl.Chacha20.sum_states from its translation unit (see C11 6.7.3 §5), and CompCert will do it. 
Warning 7: : After inlining, Crypto.Symmetric.Cipher.compute (going into Crypto_AEAD_Main) calls Hacl.Lib.LoadStore32.uint32s_to_le_bytes (going into Hacl_Impl_Poly1305_64_Hacl_Impl_Chacha20) -- removing the static qualifier from Hacl.Lib.LoadStore32.uint32s_to_le_bytes
Warning 7: : After inlining, Crypto.Symmetric.PRF.gen (going into Crypto_AEAD_Main) calls FStar.UInt32.v (going into FStar) -- removing the static qualifier from FStar.UInt32.v
Warning 7: : After inlining, Crypto.AEAD.Invariant.maxplain (going into Crypto_AEAD_Main) calls Prims.pow2 (going into Prims) -- removing the static qualifier from Prims.pow2
Warning 7: : After inlining, Crypto.AEAD.Invariant.safelen (going into Crypto_AEAD_Main) calls Prims.op_Multiply (going into Prims) -- removing the static qualifier from Prims.op_Multiply
Warning 7: : After inlining, Crypto.AEAD.Invariant.safelen (going into Crypto_AEAD_Main) calls Prims.op_LessThanOrEqual (going into Prims) -- removing the static qualifier from Prims.op_LessThanOrEqual
Warning 7: : After inlining, Crypto.AEAD.Invariant.safelen (going into Crypto_AEAD_Main) calls Prims.op_Addition (going into Prims) -- removing the static qualifier from Prims.op_Addition
Warning 7: : After inlining, KrmlTest.test (going into KrmlTest) calls Crypto.Indexing.id (going into Crypto_AEAD_Main) -- removing the static qualifier from Crypto.Indexing.id
Warning 7: : After inlining, KrmlTest.test (going into KrmlTest) calls Crypto.Indexing.aeadAlg (going into Crypto_AEAD_Main) -- removing the static qualifier from Crypto.Indexing.aeadAlg
Warning 7: : After inlining, KrmlTest.test (going into KrmlTest) calls Crypto.Indexing.testId (going into Crypto_AEAD_Main) -- removing the static qualifier from Crypto.Indexing.testId
Warning 7: : After inlining, KrmlTest.test (going into KrmlTest) calls Crypto.Plain.unsafe_hide_buffer (going into Crypto_AEAD_Main) -- removing the static qualifier from Crypto.Plain.unsafe_hide_buffer
Warning 7: : After inlining, KrmlTest.test (going into KrmlTest) calls Crypto.Symmetric.Bytes.load_bytes (going into Crypto_AEAD_Main) -- removing the static qualifier from Crypto.Symmetric.Bytes.load_bytes
Warning 7: : After inlining, KrmlTest.test (going into KrmlTest) calls Crypto.Symmetric.Bytes.load_uint128 (going into Crypto_AEAD_Main) -- removing the static qualifier from Crypto.Symmetric.Bytes.load_uint128
Warning 7: : After inlining, KrmlTest.test (going into KrmlTest) calls Crypto.AEAD.Invariant.aead_state (going into Crypto_AEAD_Main) -- removing the static qualifier from Crypto.AEAD.Invariant.aead_state
Warning 7: : After inlining, KrmlTest.test (going into KrmlTest) calls Crypto.Plain.bufferRepr (going into Crypto_AEAD_Main) -- removing the static qualifier from Crypto.Plain.bufferRepr
Warning 7: : After inlining, KrmlTest.main (going into KrmlTest) calls C.exit_code (going into C) -- removing the static qualifier from C.exit_code
Warning 7: : After inlining, Flag.cipher_prf (going into Flag) calls Crypto.Indexing.cipherAlg (going into Crypto_AEAD_Main) -- removing the static qualifier from Crypto.Indexing.cipherAlg
Warning 7: : After inlining, Flag.mac_int1cma (going into Flag) calls Crypto.Indexing.macAlg (going into Crypto_AEAD_Main) -- removing the static qualifier from Crypto.Indexing.macAlg
[38;5;81m⚙ KreMLin auto-detecting tools.[0m Here's what we found:
[4mreadlink is:[0m readlink
[4mKreMLin called via:[0m C:\build\agent1\_work\13\s\kremlin\_build\src\Kremlin.native
[4mthe Kremlin executable is:[0m C:\build\agent1\_work\13\s\kremlin\_build\src\Kremlin.native
[4mKreMLin home is:[0m C:/build/agent1/_work/13/s/kremlin
[38;5;81m⚙ KreMLin will drive F*.[0m Here's what we found:
read FSTAR_HOME via the environment
[4mfstar converted to windows path:[0m C:/build/agent1/_work/13/s/FStar/bin/fstar.exe
[4mfstar home converted to windows path:[0m C:/build/agent1/_work/13/s/FStar
[4mfstar lib converted to windows path:[0m C:/build/agent1/_work/13/s/FStar/ulib
fstar is on [38;5;202mbranch protz_uint128[0m
[4mfstar is:[0m C:/build/agent1/_work/13/s/FStar/bin/fstar.exe C:/build/agent1/_work/13/s/kremlin/runtime/WasmSupport.fst C:/build/agent1/_work/13/s/FStar/ulib/FStar.UInt128.fst --trace_error --cache_checked_modules --expose_interfaces --include C:/build/agent1/_work/13/s/kremlin/include --include C:/build/agent1/_work/13/s/kremlin/kremlib
[38;5;119m✔[0m [PrettyPrinting] ⏱️ 16ms
KreMLin: wrote out .c files for C_String, TestLib, C_Loops_Spec_Loops, Prims, FStar, Buffer_Utils, C_Endianness, C_Nullity, Vale_AES, Seq_Create, C, Hacl_Impl_Poly1305_64_Hacl_Impl_Chacha20, Crypto_AEAD_Main, KrmlTest, Flag, LowStar
KreMLin: wrote out .h files for C_String, TestLib, C_Loops_Spec_Loops, Prims, FStar, Buffer_Utils, C_Endianness, C_Nullity, Vale_AES, Seq_Create, C, Hacl_Impl_Poly1305_64_Hacl_Impl_Chacha20, Crypto_AEAD_Main, KrmlTest, Flag, LowStar
[38;5;81m⚙ KreMLin will drive the C compiler.[0m Here's what we found:
[4mgcc is:[0m x86_64-w64-mingw32-gcc
[4mx86_64-w64-mingw32-gcc options are:[0m -I C:/build/agent1/_work/13/s/kremlin/include -I C:/build/agent1/_work/13/s/kremlin/kremlib -I ../secure_api/out/runtime_switch/extracted -Wall -Werror -Wno-unused-variable -Wno-unknown-warning-option -Wno-unused-but-set-variable -g -fwrapv -fstack-check -D_BSD_SOURCE -D_DEFAULT_SOURCE -D__USE_MINGW_ANSI_STDIO -Wno-parentheses -std=c11
[38;5;81m⚡ Generating object files[0m
[38;5;119m✔[0m [CC,../secure_api/out/runtime_switch/extracted/C_String.c] (use -verbose to see the output)
[38;5;119m✔[0m [CC,../secure_api/out/runtime_switch/extracted/TestLib.c] (use -verbose to see the output)
[38;5;119m✔[0m [CC,../secure_api/out/runtime_switch/extracted/C_Loops_Spec_Loops.c] (use -verbose to see the output)
[38;5;119m✔[0m [CC,../secure_api/out/runtime_switch/extracted/Prims.c] (use -verbose to see the output)
[38;5;119m✔[0m [CC,../secure_api/out/runtime_switch/extracted/FStar.c] (use -verbose to see the output)
[38;5;119m✔[0m [CC,../secure_api/out/runtime_switch/extracted/Buffer_Utils.c] (use -verbose to see the output)
[38;5;119m✔[0m [CC,../secure_api/out/runtime_switch/extracted/C_Endianness.c] (use -verbose to see the output)
[38;5;119m✔[0m [CC,../secure_api/out/runtime_switch/extracted/C_Nullity.c] (use -verbose to see the output)
[38;5;119m✔[0m [CC,../secure_api/out/runtime_switch/extracted/Vale_AES.c] (use -verbose to see the output)
[38;5;119m✔[0m [CC,../secure_api/out/runtime_switch/extracted/Seq_Create.c] (use -verbose to see the output)
[38;5;119m✔[0m [CC,../secure_api/out/runtime_switch/extracted/C.c] (use -verbose to see the output)
[38;5;119m✔[0m [CC,../secure_api/out/runtime_switch/extracted/Hacl_Impl_Poly1305_64_Hacl_Impl_Chacha20.c] (use -verbose to see the output)
[38;5;119m✔[0m [CC,../secure_api/out/runtime_switch/extracted/Crypto_AEAD_Main.c] (use -verbose to see the output)
[38;5;119m✔[0m [CC,../secure_api/out/runtime_switch/extracted/KrmlTest.c] (use -verbose to see the output)
[38;5;119m✔[0m [CC,../secure_api/out/runtime_switch/extracted/Flag.c] (use -verbose to see the output)
[38;5;119m✔[0m [CC,../secure_api/out/runtime_switch/extracted/LowStar.c] (use -verbose to see the output)
[38;5;119m✔[0m [LD] (use -verbose to see the output)
[38;5;119mAll files linked successfully[0m 👍
./../secure_api/out/runtime_switch/krml-test.exe
test()
[test] expected output cipher is d31a8d34648e60db7b86afbc53ef7ec2a4aded51296e08fea9e2b5a736ee62d63dbea45e8ca9671282fafb69da92728b1a71de0a9e060b2905d6a5b67ecd3b3692ddbd7f2d778b8c9803aee328091b58fab324e4fad675945585808b4831d7bc3ff4def08e4b7a9de576d26586cec64b61161ae10b594f09e26a7e902ecbd0600691
[test] computed output cipher is d31a8d34648e60db7b86afbc53ef7ec2a4aded51296e08fea9e2b5a736ee62d63dbea45e8ca9671282fafb69da92728b1a71de0a9e060b2905d6a5b67ecd3b3692ddbd7f2d778b8c9803aee328091b58fab324e4fad675945585808b4831d7bc3ff4def08e4b7a9de576d26586cec64b61161ae10b594f09e26a7e902ecbd0600691
[test] cipher is a success
[test] expected output decryption is 4c616469657320616e642047656e746c656d656e206f662074686520636c617373206f66202739393a204966204920636f756c64206f6666657220796f75206f6e6c79206f6e652074697020666f7220746865206675747572652c2073756e73637265656e20776f756c642062652069742e
[test] computed output decryption is 4c616469657320616e642047656e746c656d656e206f662074686520636c617373206f66202739393a204966204920636f756c64206f6666657220796f75206f6e6c79206f6e652074697020666f7220746865206675747572652c2073756e73637265656e20776f756c642062652069742e
[test] decryption is a success
test_aes_gcm_0()
[test] expected output cipher is 58e2fccefa7e3061367f1d57a4e7455a
[test] computed output cipher is 58e2fccefa7e3061367f1d57a4e7455a
[test] cipher is a success
[test] expected output decryption is 
[test] computed output decryption is 
[test] decryption is a success
test_aes_gcm_1()
[test] expected output cipher is 530f8afbc74536b9a963b4f1c4cb738b
[test] computed output cipher is 530f8afbc74536b9a963b4f1c4cb738b
[test] cipher is a success
[test] expected output decryption is 
[test] computed output decryption is 
[test] decryption is a success
test_aes_gcm_2()
[test] expected output cipher is cea7403d4d606b6e074ec5d3baf39d18d0d1c8a799996bf0265b98b5d48ab919
[test] computed output cipher is cea7403d4d606b6e074ec5d3baf39d18d0d1c8a799996bf0265b98b5d48ab919
[test] cipher is a success
[test] expected output decryption is 00000000000000000000000000000000
[test] computed output decryption is 00000000000000000000000000000000
[test] decryption is a success
test_aes_gcm_3()
[test] expected output cipher is 522dc1f099567d07f47f37a32a84427d643a8cdcbfe5c0c97598a2bd2555d1aa8cb08e48590dbb3da7b08b1056828838c5f61e6393ba7a0abcc9f662898015adb094dac5d93471bdec1a502270e3cc6c
[test] computed output cipher is 522dc1f099567d07f47f37a32a84427d643a8cdcbfe5c0c97598a2bd2555d1aa8cb08e48590dbb3da7b08b1056828838c5f61e6393ba7a0abcc9f662898015adb094dac5d93471bdec1a502270e3cc6c
[test] cipher is a success
[test] expected output decryption is d9313225f88406e5a55909c5aff5269a86a7a9531534f7da2e4c303d8a318a721c3c0c95956809532fcf0e2449a6b525b16aedf5aa0de657ba637b391aafd255
[test] computed output decryption is d9313225f88406e5a55909c5aff5269a86a7a9531534f7da2e4c303d8a318a721c3c0c95956809532fcf0e2449a6b525b16aedf5aa0de657ba637b391aafd255
[test] decryption is a success
test_aes_gcm_4()
[test] expected output cipher is 522dc1f099567d07f47f37a32a84427d643a8cdcbfe5c0c97598a2bd2555d1aa8cb08e48590dbb3da7b08b1056828838c5f61e6393ba7a0abcc9f66276fc6ece0f4e1768cddf8853bb2d551b
[test] computed output cipher is 522dc1f099567d07f47f37a32a84427d643a8cdcbfe5c0c97598a2bd2555d1aa8cb08e48590dbb3da7b08b1056828838c5f61e6393ba7a0abcc9f66276fc6ece0f4e1768cddf8853bb2d551b
[test] cipher is a success
[test] expected output decryption is d9313225f88406e5a55909c5aff5269a86a7a9531534f7da2e4c303d8a318a721c3c0c95956809532fcf0e2449a6b525b16aedf5aa0de657ba637b39
[test] computed output decryption is d9313225f88406e5a55909c5aff5269a86a7a9531534f7da2e4c303d8a318a721c3c0c95956809532fcf0e2449a6b525b16aedf5aa0de657ba637b39
[test] decryption is a success
make -C C:/build/agent1/_work/13/s/MLCrypto
make[1]: Entering directory '/cygdrive/c/build/agent1/_work/13/s/MLCrypto'
make[1]: Nothing to be done for 'all'.
make[1]: Leaving directory '/cygdrive/c/build/agent1/_work/13/s/MLCrypto'
OCAMLPATH="C:/build/agent1/_work/13/s/FStar/bin" ocamlfind opt -package fstarlib,zarith -g -I C:/build/agent1/_work/13/s/FStar/ulib/ml -c LowCProvider/LowCProvider.ml -I LowCProvider -I ../secure_api/out/runtime_switch -I ../secure_api/out/runtime_switch/extracted -I C:/build/agent1/_work/13/s/MLCrypto -o LowCProvider/LowCProvider.cmx
C:/build/agent1/_work/13/s/kremlin/krml -falloca -ftail-calls -bundle 'Crypto_Symmetric_Bytes=*' -minimal -skip-compilation \
-tmpdir ../secure_api/out/runtime_switch/crypto ../secure_api/out/runtime_switch/extracted/prims.krml ../secure_api/out/runtime_switch/extracted/FStar_Pervasives_Native.krml ../secure_api/out/runtime_switch/extracted/FStar_Pervasives.krml ../secure_api/out/runtime_switch/extracted/FStar_Mul.krml ../secure_api/out/runtime_switch/extracted/FStar_Math_Lib.krml ../secure_api/out/runtime_switch/extracted/FStar_Math_Lemmas.krml ../secure_api/out/runtime_switch/extracted/FStar_Squash.krml ../secure_api/out/runtime_switch/extracted/FStar_StrongExcludedMiddle.krml ../secure_api/out/runtime_switch/extracted/FStar_Classical.krml ../secure_api/out/runtime_switch/extracted/FStar_List_Tot_Base.krml ../secure_api/out/runtime_switch/extracted/FStar_List_Tot_Properties.krml ../secure_api/out/runtime_switch/extracted/FStar_List_Tot.krml ../secure_api/out/runtime_switch/extracted/FStar_Seq_Base.krml ../secure_api/out/runtime_switch/extracted/FStar_Seq_Properties.krml ../secure_api/out/runtime_switch/extracted/FStar_Seq.krml ../secure_api/out/runtime_switch/extracted/FStar_BitVector.krml ../secure_api/out/runtime_switch/extracted/FStar_UInt.krml ../secure_api/out/runtime_switch/extracted/FStar_UInt32.krml ../secure_api/out/runtime_switch/extracted/FStar_Int.krml ../secure_api/out/runtime_switch/extracted/FStar_Int64.krml ../secure_api/out/runtime_switch/extracted/FStar_Int63.krml ../secure_api/out/runtime_switch/extracted/FStar_Int32.krml ../secure_api/out/runtime_switch/extracted/FStar_Int16.krml ../secure_api/out/runtime_switch/extracted/FStar_Int8.krml ../secure_api/out/runtime_switch/extracted/FStar_UInt64.krml ../secure_api/out/runtime_switch/extracted/FStar_UInt63.krml ../secure_api/out/runtime_switch/extracted/FStar_UInt16.krml ../secure_api/out/runtime_switch/extracted/FStar_UInt8.krml ../secure_api/out/runtime_switch/extracted/FStar_Int_Cast.krml ../secure_api/out/runtime_switch/extracted/FStar_UInt128.krml ../secure_api/out/runtime_switch/extracted/Hacl_UInt64.krml ../secure_api/out/runtime_switch/extracted/FStar_Preorder.krml ../secure_api/out/runtime_switch/extracted/FStar_Ghost.krml ../secure_api/out/runtime_switch/extracted/FStar_ErasedLogic.krml ../secure_api/out/runtime_switch/extracted/FStar_FunctionalExtensionality.krml ../secure_api/out/runtime_switch/extracted/FStar_Set.krml ../secure_api/out/runtime_switch/extracted/FStar_PropositionalExtensionality.krml ../secure_api/out/runtime_switch/extracted/FStar_PredicateExtensionality.krml ../secure_api/out/runtime_switch/extracted/FStar_TSet.krml ../secure_api/out/runtime_switch/extracted/FStar_Monotonic_Heap.krml ../secure_api/out/runtime_switch/extracted/FStar_Heap.krml ../secure_api/out/runtime_switch/extracted/FStar_Map.krml ../secure_api/out/runtime_switch/extracted/FStar_Monotonic_HyperHeap.krml ../secure_api/out/runtime_switch/extracted/FStar_Monotonic_HyperStack.krml ../secure_api/out/runtime_switch/extracted/FStar_HyperStack.krml ../secure_api/out/runtime_switch/extracted/FStar_Monotonic_Witnessed.krml ../secure_api/out/runtime_switch/extracted/FStar_HyperStack_ST.krml ../secure_api/out/runtime_switch/extracted/FStar_HyperStack_All.krml ../secure_api/out/runtime_switch/extracted/Hacl_UInt128.krml ../secure_api/out/runtime_switch/extracted/Hacl_UInt8.krml ../secure_api/out/runtime_switch/extracted/Hacl_Bignum_Constants.krml ../secure_api/out/runtime_switch/extracted/Hacl_UInt32.krml ../secure_api/out/runtime_switch/extracted/FStar_Int_Cast_Full.krml ../secure_api/out/runtime_switch/extracted/Hacl_Cast.krml ../secure_api/out/runtime_switch/extracted/FStar_Buffer.krml ../secure_api/out/runtime_switch/extracted/Hacl_Bignum_Parameters.krml ../secure_api/out/runtime_switch/extracted/Hacl_Bignum_Wide.krml ../secure_api/out/runtime_switch/extracted/Spec_Loops.krml ../secure_api/out/runtime_switch/extracted/Hacl_Bignum_Limb.krml ../secure_api/out/runtime_switch/extracted/Hacl_Spec_Bignum_Field.krml ../secure_api/out/runtime_switch/extracted/Hacl_Spec_Bignum_Bigint.krml ../secure_api/out/runtime_switch/extracted/Hacl_Spec_Bignum_Modulo.krml ../secure_api/out/runtime_switch/extracted/Hacl_Spec_Bignum_Fproduct.krml ../secure_api/out/runtime_switch/extracted/Hacl_Spec_Bignum_Fmul.krml ../secure_api/out/runtime_switch/extracted/FStar_Endianness.krml ../secure_api/out/runtime_switch/extracted/Spec_Poly1305_Lemmas.krml ../secure_api/out/runtime_switch/extracted/FStar_Kremlin_Endianness.krml ../secure_api/out/runtime_switch/extracted/C_Endianness.krml ../secure_api/out/runtime_switch/extracted/C.krml ../secure_api/out/runtime_switch/extracted/Hacl_UInt16.krml ../secure_api/out/runtime_switch/extracted/Hacl_Spec_Endianness.krml ../secure_api/out/runtime_switch/extracted/Hacl_Endianness.krml ../secure_api/out/runtime_switch/extracted/Spec_Lib.krml ../secure_api/out/runtime_switch/extracted/Seq_Create.krml ../secure_api/out/runtime_switch/extracted/Spec_SHA2_256.krml ../secure_api/out/runtime_switch/extracted/C_Loops.krml ../secure_api/out/runtime_switch/extracted/Hacl_Hash_Lib_LoadStore.krml ../secure_api/out/runtime_switch/extracted/Hacl_Hash_Lib_Create.krml ../secure_api/out/runtime_switch/extracted/Hacl_Impl_SHA2_256_Lemmas.krml ../secure_api/out/runtime_switch/extracted/Hacl_Impl_SHA2_256.krml ../secure_api/out/runtime_switch/extracted/Hacl_Spec_Bignum_Fsum.krml ../secure_api/out/runtime_switch/extracted/Hacl_Bignum_Fsum.krml ../secure_api/out/runtime_switch/extracted/Crypto_AEAD_BufferUtils.krml ../secure_api/out/runtime_switch/extracted/Vale_AES.krml ../secure_api/out/runtime_switch/extracted/Hacl_Impl_Xor_Lemmas.krml ../secure_api/out/runtime_switch/extracted/Spec_CTR_Lemmas.krml ../secure_api/out/runtime_switch/extracted/Spec_CTR.krml ../secure_api/out/runtime_switch/extracted/Hacl_Lib_LoadStore32.krml ../secure_api/out/runtime_switch/extracted/Spec_Chacha20_Lemmas.krml ../secure_api/out/runtime_switch/extracted/Spec_Chacha20.krml ../secure_api/out/runtime_switch/extracted/Hacl_Impl_Chacha20.krml ../secure_api/out/runtime_switch/extracted/Hacl_SecureAPI_Chacha20.krml ../secure_api/out/runtime_switch/extracted/Crypto_Indexing.krml ../secure_api/out/runtime_switch/extracted/Flag.krml ../secure_api/out/runtime_switch/extracted/Crypto_Symmetric_AES.krml ../secure_api/out/runtime_switch/extracted/Crypto_Symmetric_AES128.krml ../secure_api/out/runtime_switch/extracted/FStar_Float.krml ../secure_api/out/runtime_switch/extracted/FStar_Exn.krml ../secure_api/out/runtime_switch/extracted/FStar_ST.krml ../secure_api/out/runtime_switch/extracted/FStar_All.krml ../secure_api/out/runtime_switch/extracted/FStar_IO.krml ../secure_api/out/runtime_switch/extracted/Buffer_Utils.krml ../secure_api/out/runtime_switch/extracted/Crypto_Symmetric_Bytes.krml ../secure_api/out/runtime_switch/extracted/Crypto_Symmetric_Cipher.krml ../secure_api/out/runtime_switch/extracted/C_Nullity.krml ../secure_api/out/runtime_switch/extracted/Hacl_Spec_Bignum_AddAndMultiply.krml ../secure_api/out/runtime_switch/extracted/Spec_Poly1305.krml ../secure_api/out/runtime_switch/extracted/Hacl_Bignum_Modulo.krml ../secure_api/out/runtime_switch/extracted/Hacl_Bignum_Fproduct.krml ../secure_api/out/runtime_switch/extracted/Hacl_Spec_Poly1305_64_State.krml ../secure_api/out/runtime_switch/extracted/Hacl_Spec_Poly1305_64.krml ../secure_api/out/runtime_switch/extracted/Hacl_Impl_Poly1305_64_State.krml ../secure_api/out/runtime_switch/extracted/Hacl_Bignum_Fmul.krml ../secure_api/out/runtime_switch/extracted/Hacl_Bignum_AddAndMultiply.krml ../secure_api/out/runtime_switch/extracted/Hacl_Spe_Poly1305_64.krml ../secure_api/out/runtime_switch/extracted/Hacl_Impl_Poly1305_64.krml ../secure_api/out/runtime_switch/extracted/Spec_GaloisField.krml ../secure_api/out/runtime_switch/extracted/Spec_GF128.krml ../secure_api/out/runtime_switch/extracted/Crypto_Symmetric_GF128.krml ../secure_api/out/runtime_switch/extracted/Crypto_Symmetric_MAC.krml ../secure_api/out/runtime_switch/extracted/Crypto_Symmetric_UF1CMA.krml ../secure_api/out/runtime_switch/extracted/Crypto_Plain.krml ../secure_api/out/runtime_switch/extracted/Crypto_Symmetric_PRF.krml ../secure_api/out/runtime_switch/extracted/Crypto_AEAD_Encoding.krml ../secure_api/out/runtime_switch/extracted/Crypto_AEAD_Invariant.krml ../secure_api/out/runtime_switch/extracted/Crypto_AEAD_Encrypt_Invariant.krml ../secure_api/out/runtime_switch/extracted/Crypto_AEAD_Wrappers_PRF.krml ../secure_api/out/runtime_switch/extracted/Crypto_AEAD_Wrappers_Encoding.krml ../secure_api/out/runtime_switch/extracted/Crypto_AEAD_Wrappers_CMA.krml ../secure_api/out/runtime_switch/extracted/Crypto_AEAD_EnxorDexor.krml ../secure_api/out/runtime_switch/extracted/Crypto_AEAD_Decrypt.krml ../secure_api/out/runtime_switch/extracted/Spec_HMAC_SHA2_256.krml ../secure_api/out/runtime_switch/extracted/Spec_SHA2_512.krml ../secure_api/out/runtime_switch/extracted/Hacl_Impl_SHA2_512_Lemmas.krml ../secure_api/out/runtime_switch/extracted/Hacl_Impl_SHA2_512.krml ../secure_api/out/runtime_switch/extracted/Spec_SHA2_384.krml ../secure_api/out/runtime_switch/extracted/Hacl_Impl_SHA2_384_Lemmas.krml ../secure_api/out/runtime_switch/extracted/Hacl_Impl_SHA2_384.krml ../secure_api/out/runtime_switch/extracted/Crypto_HMAC.krml ../secure_api/out/runtime_switch/extracted/Crypto_AEAD_Encrypt_Ideal_Invariant.krml ../secure_api/out/runtime_switch/extracted/Crypto_AEAD_MAC_Wrapper_Invariant.krml ../secure_api/out/runtime_switch/extracted/Crypto_AEAD_Enxor_Invariant.krml ../secure_api/out/runtime_switch/extracted/Crypto_AEAD_Encrypt.krml ../secure_api/out/runtime_switch/extracted/Crypto_AEAD.krml ../secure_api/out/runtime_switch/extracted/FStar_List.krml ../secure_api/out/runtime_switch/extracted/FStar_Char.krml ../secure_api/out/runtime_switch/extracted/FStar_String.krml ../secure_api/out/runtime_switch/extracted/C_String.krml ../secure_api/out/runtime_switch/extracted/TestLib.krml ../secure_api/out/runtime_switch/extracted/FStar_Bytes.krml ../secure_api/out/runtime_switch/extracted/Crypto_AEAD_Main.krml ../secure_api/out/runtime_switch/extracted/CryptoTypes.krml ../secure_api/out/runtime_switch/extracted/Crypto_HKDF.krml ../secure_api/out/runtime_switch/extracted/HaclProvider.krml ../secure_api/out/runtime_switch/extracted/KrmlTest.krml ../secure_api/out/runtime_switch/extracted/LowCProvider.krml -add-include '"kremlib.h"' -add-include '"kremlin/internal/compat.h"' \

Warning 6: in the definition of buf, after the definition of m0, in the last element of the sequence, in top-level declaration Crypto.Symmetric.Bytes.random_bytes, in file Crypto_Symmetric_Bytes: stack newbuf 0uint8 @1 is a non-constant size, stack-allocated array; this is not supported by CompCert and requires the use of alloca(3) for MSVC
[38;5;119m✔[0m [Monomorphization] ⏱️ 63ms
[38;5;119m✔[0m [Inlining] ⏱️ <1ms
[38;5;119m✔[0m [Pattern matches compilation] ⏱️ 16ms
[38;5;119m✔[0m [Simplify 2] ⏱️ <1ms
Warning 14: : FStar.List.Tot.Base.length__uint8_t is recursive but cannot be optimized to a tail-call
Warning 14: : FStar.Seq.Base.slice__uint8_t is recursive but cannot be optimized to a tail-call
Warning 14: : FStar.Endianness.little_endian is recursive but cannot be optimized to a tail-call
[38;5;119m✔[0m [Structs + Simplify 2] ⏱️ 16ms
Warning 14: : FStar.Endianness.big_endian is recursive but cannot be optimized to a tail-call
[38;5;119m✔[0m [Drop] ⏱️ <1ms
Warning 14: : FStar.List.Tot.Base.append__uint8_t is recursive but cannot be optimized to a tail-call
[38;5;119m✔[0m [AstToCStar] ⏱️ <1ms
[38;5;119m✔[0m [CStarToC] ⏱️ <1ms
Warning 14: : FStar.Seq.Base.create__uint8_t is recursive but cannot be optimized to a tail-call
Warning 14: : FStar.Endianness.little_bytes is recursive but cannot be optimized to a tail-call
Warning 14: : Crypto.Symmetric.Bytes.load_bytes is recursive but cannot be optimized to a tail-call
Warning 14: : Crypto.Symmetric.Bytes.load_uint32 is recursive but cannot be optimized to a tail-call
Warning 14: : Crypto.Symmetric.Bytes.load_big32 is recursive but cannot be optimized to a tail-call
Warning 14: : Crypto.Symmetric.Bytes.load_big64 is recursive but cannot be optimized to a tail-call
Warning 14: : Crypto.Symmetric.Bytes.load_uint128 is recursive but cannot be optimized to a tail-call
Warning 14: : Crypto.Symmetric.Bytes.load_big128 is recursive but cannot be optimized to a tail-call
Warning 14: : Crypto.Symmetric.Bytes.store_uint32 is recursive but cannot be optimized to a tail-call
Warning 14: : Crypto.Symmetric.Bytes.store_big32 is recursive but cannot be optimized to a tail-call
Warning 14: : Crypto.Symmetric.Bytes.big_bytes is recursive but cannot be optimized to a tail-call
Warning 14: : Crypto.Symmetric.Bytes.store_uint128 is recursive but cannot be optimized to a tail-call
Warning 14: : Crypto.Symmetric.Bytes.store_big128 is recursive but cannot be optimized to a tail-call
[38;5;81m⚙ KreMLin auto-detecting tools.[0m Here's what we found:
[4mreadlink is:[0m readlink
[4mKreMLin called via:[0m C:\build\agent1\_work\13\s\kremlin\_build\src\Kremlin.native
[4mthe Kremlin executable is:[0m C:\build\agent1\_work\13\s\kremlin\_build\src\Kremlin.native
[4mKreMLin home is:[0m C:/build/agent1/_work/13/s/kremlin
[38;5;81m⚙ KreMLin will drive F*.[0m Here's what we found:
read FSTAR_HOME via the environment
[4mfstar converted to windows path:[0m C:/build/agent1/_work/13/s/FStar/bin/fstar.exe
[4mfstar home converted to windows path:[0m C:/build/agent1/_work/13/s/FStar
[4mfstar lib converted to windows path:[0m C:/build/agent1/_work/13/s/FStar/ulib
fstar is on [38;5;202mbranch protz_uint128[0m
[4mfstar is:[0m C:/build/agent1/_work/13/s/FStar/bin/fstar.exe C:/build/agent1/_work/13/s/kremlin/runtime/WasmSupport.fst C:/build/agent1/_work/13/s/FStar/ulib/FStar.UInt128.fst --trace_error --cache_checked_modules --expose_interfaces --include C:/build/agent1/_work/13/s/kremlin/include --include C:/build/agent1/_work/13/s/kremlin/kremlib
[38;5;119m✔[0m [PrettyPrinting] ⏱️ <1ms
KreMLin: wrote out .c files for Crypto_Symmetric_Bytes
KreMLin: wrote out .h files for Crypto_Symmetric_Bytes
C:/build/agent1/_work/13/s/kremlin/krml -falloca -ftail-calls -bundle 'Crypto_AEAD_Main+Crypto_Indexing=*' -minimal -skip-compilation \
-tmpdir ../secure_api/out/runtime_switch/crypto ../secure_api/out/runtime_switch/extracted/prims.krml ../secure_api/out/runtime_switch/extracted/FStar_Pervasives_Native.krml ../secure_api/out/runtime_switch/extracted/FStar_Pervasives.krml ../secure_api/out/runtime_switch/extracted/FStar_Mul.krml ../secure_api/out/runtime_switch/extracted/FStar_Math_Lib.krml ../secure_api/out/runtime_switch/extracted/FStar_Math_Lemmas.krml ../secure_api/out/runtime_switch/extracted/FStar_Squash.krml ../secure_api/out/runtime_switch/extracted/FStar_StrongExcludedMiddle.krml ../secure_api/out/runtime_switch/extracted/FStar_Classical.krml ../secure_api/out/runtime_switch/extracted/FStar_List_Tot_Base.krml ../secure_api/out/runtime_switch/extracted/FStar_List_Tot_Properties.krml ../secure_api/out/runtime_switch/extracted/FStar_List_Tot.krml ../secure_api/out/runtime_switch/extracted/FStar_Seq_Base.krml ../secure_api/out/runtime_switch/extracted/FStar_Seq_Properties.krml ../secure_api/out/runtime_switch/extracted/FStar_Seq.krml ../secure_api/out/runtime_switch/extracted/FStar_BitVector.krml ../secure_api/out/runtime_switch/extracted/FStar_UInt.krml ../secure_api/out/runtime_switch/extracted/FStar_UInt32.krml ../secure_api/out/runtime_switch/extracted/FStar_Int.krml ../secure_api/out/runtime_switch/extracted/FStar_Int64.krml ../secure_api/out/runtime_switch/extracted/FStar_Int63.krml ../secure_api/out/runtime_switch/extracted/FStar_Int32.krml ../secure_api/out/runtime_switch/extracted/FStar_Int16.krml ../secure_api/out/runtime_switch/extracted/FStar_Int8.krml ../secure_api/out/runtime_switch/extracted/FStar_UInt64.krml ../secure_api/out/runtime_switch/extracted/FStar_UInt63.krml ../secure_api/out/runtime_switch/extracted/FStar_UInt16.krml ../secure_api/out/runtime_switch/extracted/FStar_UInt8.krml ../secure_api/out/runtime_switch/extracted/FStar_Int_Cast.krml ../secure_api/out/runtime_switch/extracted/FStar_UInt128.krml ../secure_api/out/runtime_switch/extracted/Hacl_UInt64.krml ../secure_api/out/runtime_switch/extracted/FStar_Preorder.krml ../secure_api/out/runtime_switch/extracted/FStar_Ghost.krml ../secure_api/out/runtime_switch/extracted/FStar_ErasedLogic.krml ../secure_api/out/runtime_switch/extracted/FStar_FunctionalExtensionality.krml ../secure_api/out/runtime_switch/extracted/FStar_Set.krml ../secure_api/out/runtime_switch/extracted/FStar_PropositionalExtensionality.krml ../secure_api/out/runtime_switch/extracted/FStar_PredicateExtensionality.krml ../secure_api/out/runtime_switch/extracted/FStar_TSet.krml ../secure_api/out/runtime_switch/extracted/FStar_Monotonic_Heap.krml ../secure_api/out/runtime_switch/extracted/FStar_Heap.krml ../secure_api/out/runtime_switch/extracted/FStar_Map.krml ../secure_api/out/runtime_switch/extracted/FStar_Monotonic_HyperHeap.krml ../secure_api/out/runtime_switch/extracted/FStar_Monotonic_HyperStack.krml ../secure_api/out/runtime_switch/extracted/FStar_HyperStack.krml ../secure_api/out/runtime_switch/extracted/FStar_Monotonic_Witnessed.krml ../secure_api/out/runtime_switch/extracted/FStar_HyperStack_ST.krml ../secure_api/out/runtime_switch/extracted/FStar_HyperStack_All.krml ../secure_api/out/runtime_switch/extracted/Hacl_UInt128.krml ../secure_api/out/runtime_switch/extracted/Hacl_UInt8.krml ../secure_api/out/runtime_switch/extracted/Hacl_Bignum_Constants.krml ../secure_api/out/runtime_switch/extracted/Hacl_UInt32.krml ../secure_api/out/runtime_switch/extracted/FStar_Int_Cast_Full.krml ../secure_api/out/runtime_switch/extracted/Hacl_Cast.krml ../secure_api/out/runtime_switch/extracted/FStar_Buffer.krml ../secure_api/out/runtime_switch/extracted/Hacl_Bignum_Parameters.krml ../secure_api/out/runtime_switch/extracted/Hacl_Bignum_Wide.krml ../secure_api/out/runtime_switch/extracted/Spec_Loops.krml ../secure_api/out/runtime_switch/extracted/Hacl_Bignum_Limb.krml ../secure_api/out/runtime_switch/extracted/Hacl_Spec_Bignum_Field.krml ../secure_api/out/runtime_switch/extracted/Hacl_Spec_Bignum_Bigint.krml ../secure_api/out/runtime_switch/extracted/Hacl_Spec_Bignum_Modulo.krml ../secure_api/out/runtime_switch/extracted/Hacl_Spec_Bignum_Fproduct.krml ../secure_api/out/runtime_switch/extracted/Hacl_Spec_Bignum_Fmul.krml ../secure_api/out/runtime_switch/extracted/FStar_Endianness.krml ../secure_api/out/runtime_switch/extracted/Spec_Poly1305_Lemmas.krml ../secure_api/out/runtime_switch/extracted/FStar_Kremlin_Endianness.krml ../secure_api/out/runtime_switch/extracted/C_Endianness.krml ../secure_api/out/runtime_switch/extracted/C.krml ../secure_api/out/runtime_switch/extracted/Hacl_UInt16.krml ../secure_api/out/runtime_switch/extracted/Hacl_Spec_Endianness.krml ../secure_api/out/runtime_switch/extracted/Hacl_Endianness.krml ../secure_api/out/runtime_switch/extracted/Spec_Lib.krml ../secure_api/out/runtime_switch/extracted/Seq_Create.krml ../secure_api/out/runtime_switch/extracted/Spec_SHA2_256.krml ../secure_api/out/runtime_switch/extracted/C_Loops.krml ../secure_api/out/runtime_switch/extracted/Hacl_Hash_Lib_LoadStore.krml ../secure_api/out/runtime_switch/extracted/Hacl_Hash_Lib_Create.krml ../secure_api/out/runtime_switch/extracted/Hacl_Impl_SHA2_256_Lemmas.krml ../secure_api/out/runtime_switch/extracted/Hacl_Impl_SHA2_256.krml ../secure_api/out/runtime_switch/extracted/Hacl_Spec_Bignum_Fsum.krml ../secure_api/out/runtime_switch/extracted/Hacl_Bignum_Fsum.krml ../secure_api/out/runtime_switch/extracted/Crypto_AEAD_BufferUtils.krml ../secure_api/out/runtime_switch/extracted/Vale_AES.krml ../secure_api/out/runtime_switch/extracted/Hacl_Impl_Xor_Lemmas.krml ../secure_api/out/runtime_switch/extracted/Spec_CTR_Lemmas.krml ../secure_api/out/runtime_switch/extracted/Spec_CTR.krml ../secure_api/out/runtime_switch/extracted/Hacl_Lib_LoadStore32.krml ../secure_api/out/runtime_switch/extracted/Spec_Chacha20_Lemmas.krml ../secure_api/out/runtime_switch/extracted/Spec_Chacha20.krml ../secure_api/out/runtime_switch/extracted/Hacl_Impl_Chacha20.krml ../secure_api/out/runtime_switch/extracted/Hacl_SecureAPI_Chacha20.krml ../secure_api/out/runtime_switch/extracted/Crypto_Indexing.krml ../secure_api/out/runtime_switch/extracted/Flag.krml ../secure_api/out/runtime_switch/extracted/Crypto_Symmetric_AES.krml ../secure_api/out/runtime_switch/extracted/Crypto_Symmetric_AES128.krml ../secure_api/out/runtime_switch/extracted/FStar_Float.krml ../secure_api/out/runtime_switch/extracted/FStar_Exn.krml ../secure_api/out/runtime_switch/extracted/FStar_ST.krml ../secure_api/out/runtime_switch/extracted/FStar_All.krml ../secure_api/out/runtime_switch/extracted/FStar_IO.krml ../secure_api/out/runtime_switch/extracted/Buffer_Utils.krml ../secure_api/out/runtime_switch/extracted/Crypto_Symmetric_Bytes.krml ../secure_api/out/runtime_switch/extracted/Crypto_Symmetric_Cipher.krml ../secure_api/out/runtime_switch/extracted/C_Nullity.krml ../secure_api/out/runtime_switch/extracted/Hacl_Spec_Bignum_AddAndMultiply.krml ../secure_api/out/runtime_switch/extracted/Spec_Poly1305.krml ../secure_api/out/runtime_switch/extracted/Hacl_Bignum_Modulo.krml ../secure_api/out/runtime_switch/extracted/Hacl_Bignum_Fproduct.krml ../secure_api/out/runtime_switch/extracted/Hacl_Spec_Poly1305_64_State.krml ../secure_api/out/runtime_switch/extracted/Hacl_Spec_Poly1305_64.krml ../secure_api/out/runtime_switch/extracted/Hacl_Impl_Poly1305_64_State.krml ../secure_api/out/runtime_switch/extracted/Hacl_Bignum_Fmul.krml ../secure_api/out/runtime_switch/extracted/Hacl_Bignum_AddAndMultiply.krml ../secure_api/out/runtime_switch/extracted/Hacl_Spe_Poly1305_64.krml ../secure_api/out/runtime_switch/extracted/Hacl_Impl_Poly1305_64.krml ../secure_api/out/runtime_switch/extracted/Spec_GaloisField.krml ../secure_api/out/runtime_switch/extracted/Spec_GF128.krml ../secure_api/out/runtime_switch/extracted/Crypto_Symmetric_GF128.krml ../secure_api/out/runtime_switch/extracted/Crypto_Symmetric_MAC.krml ../secure_api/out/runtime_switch/extracted/Crypto_Symmetric_UF1CMA.krml ../secure_api/out/runtime_switch/extracted/Crypto_Plain.krml ../secure_api/out/runtime_switch/extracted/Crypto_Symmetric_PRF.krml ../secure_api/out/runtime_switch/extracted/Crypto_AEAD_Encoding.krml ../secure_api/out/runtime_switch/extracted/Crypto_AEAD_Invariant.krml ../secure_api/out/runtime_switch/extracted/Crypto_AEAD_Encrypt_Invariant.krml ../secure_api/out/runtime_switch/extracted/Crypto_AEAD_Wrappers_PRF.krml ../secure_api/out/runtime_switch/extracted/Crypto_AEAD_Wrappers_Encoding.krml ../secure_api/out/runtime_switch/extracted/Crypto_AEAD_Wrappers_CMA.krml ../secure_api/out/runtime_switch/extracted/Crypto_AEAD_EnxorDexor.krml ../secure_api/out/runtime_switch/extracted/Crypto_AEAD_Decrypt.krml ../secure_api/out/runtime_switch/extracted/Spec_HMAC_SHA2_256.krml ../secure_api/out/runtime_switch/extracted/Spec_SHA2_512.krml ../secure_api/out/runtime_switch/extracted/Hacl_Impl_SHA2_512_Lemmas.krml ../secure_api/out/runtime_switch/extracted/Hacl_Impl_SHA2_512.krml ../secure_api/out/runtime_switch/extracted/Spec_SHA2_384.krml ../secure_api/out/runtime_switch/extracted/Hacl_Impl_SHA2_384_Lemmas.krml ../secure_api/out/runtime_switch/extracted/Hacl_Impl_SHA2_384.krml ../secure_api/out/runtime_switch/extracted/Crypto_HMAC.krml ../secure_api/out/runtime_switch/extracted/Crypto_AEAD_Encrypt_Ideal_Invariant.krml ../secure_api/out/runtime_switch/extracted/Crypto_AEAD_MAC_Wrapper_Invariant.krml ../secure_api/out/runtime_switch/extracted/Crypto_AEAD_Enxor_Invariant.krml ../secure_api/out/runtime_switch/extracted/Crypto_AEAD_Encrypt.krml ../secure_api/out/runtime_switch/extracted/Crypto_AEAD.krml ../secure_api/out/runtime_switch/extracted/FStar_List.krml ../secure_api/out/runtime_switch/extracted/FStar_Char.krml ../secure_api/out/runtime_switch/extracted/FStar_String.krml ../secure_api/out/runtime_switch/extracted/C_String.krml ../secure_api/out/runtime_switch/extracted/TestLib.krml ../secure_api/out/runtime_switch/extracted/FStar_Bytes.krml ../secure_api/out/runtime_switch/extracted/Crypto_AEAD_Main.krml ../secure_api/out/runtime_switch/extracted/CryptoTypes.krml ../secure_api/out/runtime_switch/extracted/Crypto_HKDF.krml ../secure_api/out/runtime_switch/extracted/HaclProvider.krml ../secure_api/out/runtime_switch/extracted/KrmlTest.krml ../secure_api/out/runtime_switch/extracted/LowCProvider.krml -add-include '"kremlib.h"' -add-include '"kremlin/internal/compat.h"' \

Warning 6: in the definition of keyBuffer, after the definition of h0, in the last element of the sequence, after the definition of macId, in top-level declaration Crypto.Symmetric.PRF.prf_mac, in file Crypto_AEAD_Main_Crypto_Indexing: stack newbuf 0uint8 Crypto.Symmetric.UF1CMA.keylen @5 is a non-constant size, stack-allocated array; this is not supported by CompCert and requires the use of alloca(3) for MSVC
[38;5;119m✔[0m [Monomorphization] ⏱️ 63ms
[38;5;119m✔[0m [Inlining] ⏱️ 63ms
[38;5;119m✔[0m [Pattern matches compilation] ⏱️ 47ms
[38;5;119m✔[0m [Simplify 2] ⏱️ 250ms
Warning 14: : Crypto.Symmetric.Bytes.store_uint32 is recursive but cannot be optimized to a tail-call
Warning 14: : Crypto.Symmetric.Bytes.store_big32 is recursive but cannot be optimized to a tail-call
Warning 14: : Crypto.Symmetric.Bytes.store_uint128 is recursive but cannot be optimized to a tail-call
[38;5;119m✔[0m [Structs + Simplify 2] ⏱️ 297ms
[38;5;119m✔[0m [Drop] ⏱️ <1ms
[38;5;119m✔[0m [AstToCStar] ⏱️ 16ms
[38;5;119m✔[0m [CStarToC] ⏱️ <1ms
[38;5;81m⚙ KreMLin auto-detecting tools.[0m Here's what we found:
[4mreadlink is:[0m readlink
[4mKreMLin called via:[0m C:\build\agent1\_work\13\s\kremlin\_build\src\Kremlin.native
[4mthe Kremlin executable is:[0m C:\build\agent1\_work\13\s\kremlin\_build\src\Kremlin.native
[4mKreMLin home is:[0m C:/build/agent1/_work/13/s/kremlin
[38;5;81m⚙ KreMLin will drive F*.[0m Here's what we found:
read FSTAR_HOME via the environment
[4mfstar converted to windows path:[0m C:/build/agent1/_work/13/s/FStar/bin/fstar.exe
[4mfstar home converted to windows path:[0m C:/build/agent1/_work/13/s/FStar
[4mfstar lib converted to windows path:[0m C:/build/agent1/_work/13/s/FStar/ulib
fstar is on [38;5;202mbranch protz_uint128[0m
[4mfstar is:[0m C:/build/agent1/_work/13/s/FStar/bin/fstar.exe C:/build/agent1/_work/13/s/kremlin/runtime/WasmSupport.fst C:/build/agent1/_work/13/s/FStar/ulib/FStar.UInt128.fst --trace_error --cache_checked_modules --expose_interfaces --include C:/build/agent1/_work/13/s/kremlin/include --include C:/build/agent1/_work/13/s/kremlin/kremlib
[38;5;119m✔[0m [PrettyPrinting] ⏱️ 16ms
KreMLin: wrote out .c files for Crypto_AEAD_Main_Crypto_Indexing
KreMLin: wrote out .h files for Crypto_AEAD_Main_Crypto_Indexing
C:/build/agent1/_work/13/s/kremlin/krml -falloca -ftail-calls -bundle 'Crypto_HKDF+Crypto_HMAC=*' -minimal -skip-compilation \
-tmpdir ../secure_api/out/runtime_switch/crypto ../secure_api/out/runtime_switch/extracted/prims.krml ../secure_api/out/runtime_switch/extracted/FStar_Pervasives_Native.krml ../secure_api/out/runtime_switch/extracted/FStar_Pervasives.krml ../secure_api/out/runtime_switch/extracted/FStar_Mul.krml ../secure_api/out/runtime_switch/extracted/FStar_Math_Lib.krml ../secure_api/out/runtime_switch/extracted/FStar_Math_Lemmas.krml ../secure_api/out/runtime_switch/extracted/FStar_Squash.krml ../secure_api/out/runtime_switch/extracted/FStar_StrongExcludedMiddle.krml ../secure_api/out/runtime_switch/extracted/FStar_Classical.krml ../secure_api/out/runtime_switch/extracted/FStar_List_Tot_Base.krml ../secure_api/out/runtime_switch/extracted/FStar_List_Tot_Properties.krml ../secure_api/out/runtime_switch/extracted/FStar_List_Tot.krml ../secure_api/out/runtime_switch/extracted/FStar_Seq_Base.krml ../secure_api/out/runtime_switch/extracted/FStar_Seq_Properties.krml ../secure_api/out/runtime_switch/extracted/FStar_Seq.krml ../secure_api/out/runtime_switch/extracted/FStar_BitVector.krml ../secure_api/out/runtime_switch/extracted/FStar_UInt.krml ../secure_api/out/runtime_switch/extracted/FStar_UInt32.krml ../secure_api/out/runtime_switch/extracted/FStar_Int.krml ../secure_api/out/runtime_switch/extracted/FStar_Int64.krml ../secure_api/out/runtime_switch/extracted/FStar_Int63.krml ../secure_api/out/runtime_switch/extracted/FStar_Int32.krml ../secure_api/out/runtime_switch/extracted/FStar_Int16.krml ../secure_api/out/runtime_switch/extracted/FStar_Int8.krml ../secure_api/out/runtime_switch/extracted/FStar_UInt64.krml ../secure_api/out/runtime_switch/extracted/FStar_UInt63.krml ../secure_api/out/runtime_switch/extracted/FStar_UInt16.krml ../secure_api/out/runtime_switch/extracted/FStar_UInt8.krml ../secure_api/out/runtime_switch/extracted/FStar_Int_Cast.krml ../secure_api/out/runtime_switch/extracted/FStar_UInt128.krml ../secure_api/out/runtime_switch/extracted/Hacl_UInt64.krml ../secure_api/out/runtime_switch/extracted/FStar_Preorder.krml ../secure_api/out/runtime_switch/extracted/FStar_Ghost.krml ../secure_api/out/runtime_switch/extracted/FStar_ErasedLogic.krml ../secure_api/out/runtime_switch/extracted/FStar_FunctionalExtensionality.krml ../secure_api/out/runtime_switch/extracted/FStar_Set.krml ../secure_api/out/runtime_switch/extracted/FStar_PropositionalExtensionality.krml ../secure_api/out/runtime_switch/extracted/FStar_PredicateExtensionality.krml ../secure_api/out/runtime_switch/extracted/FStar_TSet.krml ../secure_api/out/runtime_switch/extracted/FStar_Monotonic_Heap.krml ../secure_api/out/runtime_switch/extracted/FStar_Heap.krml ../secure_api/out/runtime_switch/extracted/FStar_Map.krml ../secure_api/out/runtime_switch/extracted/FStar_Monotonic_HyperHeap.krml ../secure_api/out/runtime_switch/extracted/FStar_Monotonic_HyperStack.krml ../secure_api/out/runtime_switch/extracted/FStar_HyperStack.krml ../secure_api/out/runtime_switch/extracted/FStar_Monotonic_Witnessed.krml ../secure_api/out/runtime_switch/extracted/FStar_HyperStack_ST.krml ../secure_api/out/runtime_switch/extracted/FStar_HyperStack_All.krml ../secure_api/out/runtime_switch/extracted/Hacl_UInt128.krml ../secure_api/out/runtime_switch/extracted/Hacl_UInt8.krml ../secure_api/out/runtime_switch/extracted/Hacl_Bignum_Constants.krml ../secure_api/out/runtime_switch/extracted/Hacl_UInt32.krml ../secure_api/out/runtime_switch/extracted/FStar_Int_Cast_Full.krml ../secure_api/out/runtime_switch/extracted/Hacl_Cast.krml ../secure_api/out/runtime_switch/extracted/FStar_Buffer.krml ../secure_api/out/runtime_switch/extracted/Hacl_Bignum_Parameters.krml ../secure_api/out/runtime_switch/extracted/Hacl_Bignum_Wide.krml ../secure_api/out/runtime_switch/extracted/Spec_Loops.krml ../secure_api/out/runtime_switch/extracted/Hacl_Bignum_Limb.krml ../secure_api/out/runtime_switch/extracted/Hacl_Spec_Bignum_Field.krml ../secure_api/out/runtime_switch/extracted/Hacl_Spec_Bignum_Bigint.krml ../secure_api/out/runtime_switch/extracted/Hacl_Spec_Bignum_Modulo.krml ../secure_api/out/runtime_switch/extracted/Hacl_Spec_Bignum_Fproduct.krml ../secure_api/out/runtime_switch/extracted/Hacl_Spec_Bignum_Fmul.krml ../secure_api/out/runtime_switch/extracted/FStar_Endianness.krml ../secure_api/out/runtime_switch/extracted/Spec_Poly1305_Lemmas.krml ../secure_api/out/runtime_switch/extracted/FStar_Kremlin_Endianness.krml ../secure_api/out/runtime_switch/extracted/C_Endianness.krml ../secure_api/out/runtime_switch/extracted/C.krml ../secure_api/out/runtime_switch/extracted/Hacl_UInt16.krml ../secure_api/out/runtime_switch/extracted/Hacl_Spec_Endianness.krml ../secure_api/out/runtime_switch/extracted/Hacl_Endianness.krml ../secure_api/out/runtime_switch/extracted/Spec_Lib.krml ../secure_api/out/runtime_switch/extracted/Seq_Create.krml ../secure_api/out/runtime_switch/extracted/Spec_SHA2_256.krml ../secure_api/out/runtime_switch/extracted/C_Loops.krml ../secure_api/out/runtime_switch/extracted/Hacl_Hash_Lib_LoadStore.krml ../secure_api/out/runtime_switch/extracted/Hacl_Hash_Lib_Create.krml ../secure_api/out/runtime_switch/extracted/Hacl_Impl_SHA2_256_Lemmas.krml ../secure_api/out/runtime_switch/extracted/Hacl_Impl_SHA2_256.krml ../secure_api/out/runtime_switch/extracted/Hacl_Spec_Bignum_Fsum.krml ../secure_api/out/runtime_switch/extracted/Hacl_Bignum_Fsum.krml ../secure_api/out/runtime_switch/extracted/Crypto_AEAD_BufferUtils.krml ../secure_api/out/runtime_switch/extracted/Vale_AES.krml ../secure_api/out/runtime_switch/extracted/Hacl_Impl_Xor_Lemmas.krml ../secure_api/out/runtime_switch/extracted/Spec_CTR_Lemmas.krml ../secure_api/out/runtime_switch/extracted/Spec_CTR.krml ../secure_api/out/runtime_switch/extracted/Hacl_Lib_LoadStore32.krml ../secure_api/out/runtime_switch/extracted/Spec_Chacha20_Lemmas.krml ../secure_api/out/runtime_switch/extracted/Spec_Chacha20.krml ../secure_api/out/runtime_switch/extracted/Hacl_Impl_Chacha20.krml ../secure_api/out/runtime_switch/extracted/Hacl_SecureAPI_Chacha20.krml ../secure_api/out/runtime_switch/extracted/Crypto_Indexing.krml ../secure_api/out/runtime_switch/extracted/Flag.krml ../secure_api/out/runtime_switch/extracted/Crypto_Symmetric_AES.krml ../secure_api/out/runtime_switch/extracted/Crypto_Symmetric_AES128.krml ../secure_api/out/runtime_switch/extracted/FStar_Float.krml ../secure_api/out/runtime_switch/extracted/FStar_Exn.krml ../secure_api/out/runtime_switch/extracted/FStar_ST.krml ../secure_api/out/runtime_switch/extracted/FStar_All.krml ../secure_api/out/runtime_switch/extracted/FStar_IO.krml ../secure_api/out/runtime_switch/extracted/Buffer_Utils.krml ../secure_api/out/runtime_switch/extracted/Crypto_Symmetric_Bytes.krml ../secure_api/out/runtime_switch/extracted/Crypto_Symmetric_Cipher.krml ../secure_api/out/runtime_switch/extracted/C_Nullity.krml ../secure_api/out/runtime_switch/extracted/Hacl_Spec_Bignum_AddAndMultiply.krml ../secure_api/out/runtime_switch/extracted/Spec_Poly1305.krml ../secure_api/out/runtime_switch/extracted/Hacl_Bignum_Modulo.krml ../secure_api/out/runtime_switch/extracted/Hacl_Bignum_Fproduct.krml ../secure_api/out/runtime_switch/extracted/Hacl_Spec_Poly1305_64_State.krml ../secure_api/out/runtime_switch/extracted/Hacl_Spec_Poly1305_64.krml ../secure_api/out/runtime_switch/extracted/Hacl_Impl_Poly1305_64_State.krml ../secure_api/out/runtime_switch/extracted/Hacl_Bignum_Fmul.krml ../secure_api/out/runtime_switch/extracted/Hacl_Bignum_AddAndMultiply.krml ../secure_api/out/runtime_switch/extracted/Hacl_Spe_Poly1305_64.krml ../secure_api/out/runtime_switch/extracted/Hacl_Impl_Poly1305_64.krml ../secure_api/out/runtime_switch/extracted/Spec_GaloisField.krml ../secure_api/out/runtime_switch/extracted/Spec_GF128.krml ../secure_api/out/runtime_switch/extracted/Crypto_Symmetric_GF128.krml ../secure_api/out/runtime_switch/extracted/Crypto_Symmetric_MAC.krml ../secure_api/out/runtime_switch/extracted/Crypto_Symmetric_UF1CMA.krml ../secure_api/out/runtime_switch/extracted/Crypto_Plain.krml ../secure_api/out/runtime_switch/extracted/Crypto_Symmetric_PRF.krml ../secure_api/out/runtime_switch/extracted/Crypto_AEAD_Encoding.krml ../secure_api/out/runtime_switch/extracted/Crypto_AEAD_Invariant.krml ../secure_api/out/runtime_switch/extracted/Crypto_AEAD_Encrypt_Invariant.krml ../secure_api/out/runtime_switch/extracted/Crypto_AEAD_Wrappers_PRF.krml ../secure_api/out/runtime_switch/extracted/Crypto_AEAD_Wrappers_Encoding.krml ../secure_api/out/runtime_switch/extracted/Crypto_AEAD_Wrappers_CMA.krml ../secure_api/out/runtime_switch/extracted/Crypto_AEAD_EnxorDexor.krml ../secure_api/out/runtime_switch/extracted/Crypto_AEAD_Decrypt.krml ../secure_api/out/runtime_switch/extracted/Spec_HMAC_SHA2_256.krml ../secure_api/out/runtime_switch/extracted/Spec_SHA2_512.krml ../secure_api/out/runtime_switch/extracted/Hacl_Impl_SHA2_512_Lemmas.krml ../secure_api/out/runtime_switch/extracted/Hacl_Impl_SHA2_512.krml ../secure_api/out/runtime_switch/extracted/Spec_SHA2_384.krml ../secure_api/out/runtime_switch/extracted/Hacl_Impl_SHA2_384_Lemmas.krml ../secure_api/out/runtime_switch/extracted/Hacl_Impl_SHA2_384.krml ../secure_api/out/runtime_switch/extracted/Crypto_HMAC.krml ../secure_api/out/runtime_switch/extracted/Crypto_AEAD_Encrypt_Ideal_Invariant.krml ../secure_api/out/runtime_switch/extracted/Crypto_AEAD_MAC_Wrapper_Invariant.krml ../secure_api/out/runtime_switch/extracted/Crypto_AEAD_Enxor_Invariant.krml ../secure_api/out/runtime_switch/extracted/Crypto_AEAD_Encrypt.krml ../secure_api/out/runtime_switch/extracted/Crypto_AEAD.krml ../secure_api/out/runtime_switch/extracted/FStar_List.krml ../secure_api/out/runtime_switch/extracted/FStar_Char.krml ../secure_api/out/runtime_switch/extracted/FStar_String.krml ../secure_api/out/runtime_switch/extracted/C_String.krml ../secure_api/out/runtime_switch/extracted/TestLib.krml ../secure_api/out/runtime_switch/extracted/FStar_Bytes.krml ../secure_api/out/runtime_switch/extracted/Crypto_AEAD_Main.krml ../secure_api/out/runtime_switch/extracted/CryptoTypes.krml ../secure_api/out/runtime_switch/extracted/Crypto_HKDF.krml ../secure_api/out/runtime_switch/extracted/HaclProvider.krml ../secure_api/out/runtime_switch/extracted/KrmlTest.krml ../secure_api/out/runtime_switch/extracted/LowCProvider.krml -add-include '"kremlib.h"' -add-include '"kremlin/internal/compat.h"' \

Warning 6: in the definition of state, after the definition of pos_T, in the last element of the sequence, in top-level declaration Crypto.HKDF.hkdf_expand, in file Crypto_HKDF_Crypto_HMAC: stack newbuf 0uint8 (+,uint32) (+,uint32) @7 @3 @4 is a non-constant size, stack-allocated array; this is not supported by CompCert and requires the use of alloca(3) for MSVC
Warning 6: in the definition of state0, after the definition of h0, in the last element of the sequence, in top-level declaration Crypto.HMAC.hmac_part1, in file Crypto_HKDF_Crypto_HMAC: stack newbuf 0uint32 match @4 with | λ .  SHA256 () ->  137uint32 | λ .  SHA384 () ->  338uint32 | λ .  SHA512 () ->  338uint32 is a non-constant size, stack-allocated array; this is not supported by CompCert and requires the use of alloca(3) for MSVC
Warning 6: in the definition of state1, after the definition of h0, in the last element of the sequence, after the definition of hinit, in top-level declaration Crypto.HMAC.hmac_part2, in file Crypto_HKDF_Crypto_HMAC: stack newbuf 0uint32 match @5 with | λ .  SHA256 () ->  137uint32 | λ .  SHA384 () ->  338uint32 | λ .  SHA512 () ->  338uint32 is a non-constant size, stack-allocated array; this is not supported by CompCert and requires the use of alloca(3) for MSVC
Warning 6: in the definition of ipad, after the definition of h0, in the last element of the sequence, after the definition of h00, in top-level declaration Crypto.HMAC.hmac_core, in file Crypto_HKDF_Crypto_HMAC: stack newbuf 0x36uint8 Crypto.HMAC.block_size @6 is a non-constant size, stack-allocated array; this is not supported by CompCert and requires the use of alloca(3) for MSVC
Warning 6: in the definition of opad, after the definition of ipad, in the last element of the sequence, after the definition of h00, in top-level declaration Crypto.HMAC.hmac_core, in file Crypto_HKDF_Crypto_HMAC: stack newbuf 0x5cuint8 Crypto.HMAC.block_size @7 is a non-constant size, stack-allocated array; this is not supported by CompCert and requires the use of alloca(3) for MSVC
Warning 6: in the definition of nkey, in the last element of the sequence, in top-level declaration Crypto.HMAC.hmac, in file Crypto_HKDF_Crypto_HMAC: stack newbuf 0x00uint8 Crypto.HMAC.block_size @5 is a non-constant size, stack-allocated array; this is not supported by CompCert and requires the use of alloca(3) for MSVC
[38;5;119m✔[0m [Monomorphization] ⏱️ 47ms
[38;5;119m✔[0m [Inlining] ⏱️ 47ms
[38;5;119m✔[0m [Pattern matches compilation] ⏱️ 16ms
[38;5;119m✔[0m [Simplify 2] ⏱️ 63ms
Warning 14: : Crypto.HKDF.hkdf_expand_inner is recursive but cannot be optimized to a tail-call
[38;5;119m✔[0m [Structs + Simplify 2] ⏱️ 94ms
[38;5;119m✔[0m [Drop] ⏱️ <1ms
[38;5;119m✔[0m [AstToCStar] ⏱️ <1ms
[38;5;119m✔[0m [CStarToC] ⏱️ <1ms
[38;5;81m⚙ KreMLin auto-detecting tools.[0m Here's what we found:
[4mreadlink is:[0m readlink
[4mKreMLin called via:[0m C:\build\agent1\_work\13\s\kremlin\_build\src\Kremlin.native
[4mthe Kremlin executable is:[0m C:\build\agent1\_work\13\s\kremlin\_build\src\Kremlin.native
[4mKreMLin home is:[0m C:/build/agent1/_work/13/s/kremlin
[38;5;81m⚙ KreMLin will drive F*.[0m Here's what we found:
read FSTAR_HOME via the environment
[4mfstar converted to windows path:[0m C:/build/agent1/_work/13/s/FStar/bin/fstar.exe
[4mfstar home converted to windows path:[0m C:/build/agent1/_work/13/s/FStar
[4mfstar lib converted to windows path:[0m C:/build/agent1/_work/13/s/FStar/ulib
fstar is on [38;5;202mbranch protz_uint128[0m
[4mfstar is:[0m C:/build/agent1/_work/13/s/FStar/bin/fstar.exe C:/build/agent1/_work/13/s/kremlin/runtime/WasmSupport.fst C:/build/agent1/_work/13/s/FStar/ulib/FStar.UInt128.fst --trace_error --cache_checked_modules --expose_interfaces --include C:/build/agent1/_work/13/s/kremlin/include --include C:/build/agent1/_work/13/s/kremlin/kremlib
[38;5;119m✔[0m [PrettyPrinting] ⏱️ <1ms
KreMLin: wrote out .c files for Crypto_HKDF_Crypto_HMAC
KreMLin: wrote out .h files for Crypto_HKDF_Crypto_HMAC
OCAMLPATH="C:/build/agent1/_work/13/s/FStar/bin" ocamlfind opt -package fstarlib,zarith -g -I C:/build/agent1/_work/13/s/FStar/ulib/ml -c LowCProvider/lowc_stub.c -I LowCProvider/ -I ../secure_api/out/runtime_switch -I C:/build/agent1/_work/13/s/kremlin/include -I C:/build/agent1/_work/13/s/MLCrypto \
-I ../../mitls-fstar/libs/ffi -ccopt "-o LowCProvider/lowc_stub.o" -I ../code/salsa-family/chacha-c -I ../code/poly1305/poly-c \
-I ../code/curve25519/x25519-c -I ../secure_api/out/runtime_switch/crypto -I ../code/api/aead-c \
-ccopt -Wall -ccopt -Wextra -ccopt -I -ccopt C:/build/agent1/_work/13/s/kremlin/include -ccopt -Wno-unused-variable -ccopt -Wno-unused-parameter -ccopt -Wno-unused-but-set-variable -ccopt -Wno-parentheses -ccopt -Werror -ccopt -Wno-unknown-warning-option
OCAMLPATH="C:/build/agent1/_work/13/s/FStar/bin" ocamlfind opt -package fstarlib,zarith -g -I C:/build/agent1/_work/13/s/FStar/ulib/ml -c ../secure_api/out/runtime_switch/crypto/Crypto_AEAD_Main_Crypto_Indexing.c -I ../secure_api/out/runtime_switch/crypto/ -I ../secure_api/out/runtime_switch -I C:/build/agent1/_work/13/s/kremlin/include -I C:/build/agent1/_work/13/s/MLCrypto \
-I ../../mitls-fstar/libs/ffi -ccopt "-o ../secure_api/out/runtime_switch/crypto/Crypto_AEAD_Main_Crypto_Indexing.o" -I ../code/salsa-family/chacha-c -I ../code/poly1305/poly-c \
-I ../code/curve25519/x25519-c -I ../secure_api/out/runtime_switch/crypto -I ../code/api/aead-c \
-ccopt -Wall -ccopt -Wextra -ccopt -I -ccopt C:/build/agent1/_work/13/s/kremlin/include -ccopt -Wno-unused-variable -ccopt -Wno-unused-parameter -ccopt -Wno-unused-but-set-variable -ccopt -Wno-parentheses -ccopt -Werror -ccopt -Wno-unknown-warning-option
OCAMLPATH="C:/build/agent1/_work/13/s/FStar/bin" ocamlfind opt -package fstarlib,zarith -g -I C:/build/agent1/_work/13/s/FStar/ulib/ml -c ../secure_api/out/runtime_switch/crypto/Crypto_HKDF_Crypto_HMAC.c -I ../secure_api/out/runtime_switch/crypto/ -I ../secure_api/out/runtime_switch -I C:/build/agent1/_work/13/s/kremlin/include -I C:/build/agent1/_work/13/s/MLCrypto \
-I ../../mitls-fstar/libs/ffi -ccopt "-o ../secure_api/out/runtime_switch/crypto/Crypto_HKDF_Crypto_HMAC.o" -I ../code/salsa-family/chacha-c -I ../code/poly1305/poly-c \
-I ../code/curve25519/x25519-c -I ../secure_api/out/runtime_switch/crypto -I ../code/api/aead-c \
-ccopt -Wall -ccopt -Wextra -ccopt -I -ccopt C:/build/agent1/_work/13/s/kremlin/include -ccopt -Wno-unused-variable -ccopt -Wno-unused-parameter -ccopt -Wno-unused-but-set-variable -ccopt -Wno-parentheses -ccopt -Werror -ccopt -Wno-unknown-warning-option
OCAMLPATH="C:/build/agent1/_work/13/s/FStar/bin" ocamlfind opt -package fstarlib,zarith -g -I C:/build/agent1/_work/13/s/FStar/ulib/ml -c ../secure_api/out/runtime_switch/crypto/Crypto_Symmetric_Bytes.c -I ../secure_api/out/runtime_switch/crypto/ -I ../secure_api/out/runtime_switch -I C:/build/agent1/_work/13/s/kremlin/include -I C:/build/agent1/_work/13/s/MLCrypto \
-I ../../mitls-fstar/libs/ffi -ccopt "-o ../secure_api/out/runtime_switch/crypto/Crypto_Symmetric_Bytes.o" -I ../code/salsa-family/chacha-c -I ../code/poly1305/poly-c \
-I ../code/curve25519/x25519-c -I ../secure_api/out/runtime_switch/crypto -I ../code/api/aead-c \
-ccopt -Wall -ccopt -Wextra -ccopt -I -ccopt C:/build/agent1/_work/13/s/kremlin/include -ccopt -Wno-unused-variable -ccopt -Wno-unused-parameter -ccopt -Wno-unused-but-set-variable -ccopt -Wno-parentheses -ccopt -Werror -ccopt -Wno-unknown-warning-option
OCAMLPATH="C:/build/agent1/_work/13/s/FStar/bin" ocamlfind mklib -g -I C:/build/agent1/_work/13/s/FStar/ulib/ml -I ../secure_api/out/runtime_switch/extracted vale/asm/sha256_main_i.o vale/asm/sha256-x86_64.o vale/asm/Vale_Hash_SHA2_256.o vale/asm/vale_aes_glue.o vale/asm/aes-x86_64.o LowCProvider/LowCProvider.cmx LowCProvider/HaclProvider.cmx LowCProvider/lowc_stub.o ../secure_api/out/runtime_switch/crypto/Crypto_AEAD_Main_Crypto_Indexing.o ../secure_api/out/runtime_switch/crypto/Crypto_HKDF_Crypto_HMAC.o ../code/salsa-family/chacha-c/Hacl_Chacha20.o ../code/poly1305/poly-c/AEAD_Poly1305_64.o ../code/api/policies-c/Hacl_Policies.o ../code/api/aead-c/Hacl_Chacha20Poly1305.o ../secure_api/out/runtime_switch/crypto/Crypto_Symmetric_Bytes.o ../code/curve25519/x25519-c/Hacl_Curve25519.o -o ../secure_api/out/runtime_switch/LowC
OCAMLPATH="C:/build/agent1/_work/13/s/FStar/bin" ocamlfind opt -package fstarlib,zarith -g -I C:/build/agent1/_work/13/s/FStar/ulib/ml -c LowCProvider/Tests.ml -I LowCProvider -I ../secure_api/out/runtime_switch -I ../secure_api/out/runtime_switch/extracted -I C:/build/agent1/_work/13/s/MLCrypto -o LowCProvider/Tests.cmx
OCAMLPATH="C:/build/agent1/_work/13/s/FStar/bin" ocamlfind opt -package fstarlib,zarith -g -I C:/build/agent1/_work/13/s/FStar/ulib/ml -I ../secure_api/out/runtime_switch/extracted -I LowCProvider \
-ccopt -L../secure_api/out/runtime_switch -cclib C:/build/agent1/_work/13/s/kremlin/kremlib/out/libkremlib.a -linkpkg C:/build/agent1/_work/13/s/MLCrypto/CryptoTypes.cmx ../secure_api/out/runtime_switch/LowC.cmxa LowCProvider/Tests.cmx -o ../secure_api/out/runtime_switch/LowCTests.exe
./../secure_api/out/runtime_switch/LowCTests.exe
Tests started
Test 1 OK

Test 2 OK

Test 3 OK

Test 4 OK

Test 5 OK

Test 6 OK

Output cipher:	ed3dc05f9d4877f5db78c69c3a8a3d8e8602646a0b2febe4fca07a426a9ace4163cb26eddbb5b0d5f56d7038512ac73d667397d129c3044e0eb8052e
Output tag:	e6f0c7f7b8920ba02a3942df2b8b2a04
cipher:		AES-128-GCM
key:		"feffe9928665731c6d6a8f9467308308"
iv:		"cafebabefacedbad"
aad:		"feedfacedeadbeeffeedfacedeadbeefabaddad2"
tag:		"3612d2e79e3b0785561be14aaca2fccb"
plaintext:	"d9313225f88406e5a55909c5aff5269a86a7a9531534f7da2e4c303d8a318a721c3c0c95956809532fcf0e2449a6b525b16aedf5aa0de657ba637b39"
ciphertext:	"61353b4c2806934a777ff51fa22a4755699b2a714fcdc6f83766e5f97b6c742373806900e49f24b22b097544d4896b424989b5e1ebac0f07c23f4598"

Test 7 failed, but this is expected because |IV| <> 12 bytes and we don't do IV expansion.
Please disregard.

Output cipher:	8076eba01a51d7702d398c6dc3adaaadfe061c23a7ffc3c4623ea2be7a08d982b8f331d21ac6b8db541df43510561a3fff90b942215b7fb6fbcea43d
Output tag:	1606863da7ad74443b3a89fd2489363d
cipher:		AES-128-GCM
key:		"feffe9928665731c6d6a8f9467308308"
iv:		"9313225df88406e555909c5aff5269aa6a7a9538534f7da1e4c303d2a318a728c3c0c95156809539fcf0e2429a6b525416aedbf5a0de6a57a637b39b"
aad:		"feedfacedeadbeeffeedfacedeadbeefabaddad2"
tag:		"619cc5aefffe0bfa462af43c1699d050"
plaintext:	"d9313225f88406e5a55909c5aff5269a86a7a9531534f7da2e4c303d8a318a721c3c0c95956809532fcf0e2449a6b525b16aedf5aa0de657ba637b39"
ciphertext:	"8ce24998625615b603a033aca13fb894be9112a5c3a211a8ba262a3cca7e2ca701e4a9a4fba43c90ccdcb281d48c7c6fd62875d2aca417034c34aee5"

Test 8 failed, but this is expected because |IV| <> 12 bytes and we don't do IV expansion.
Please disregard.

Test 9 OK

Test 10 OK

Test 11 OK

Test 12 OK

Output cipher:	677a374b4dd797f8ea0252a721fa83784f68c4877cf4e60f8c1f56972e9c20f789efb32096dd6336c6e5ef833b041251fdf04ce41fbcf2fea0d1e83c
Output tag:	91b8ee617f7c50dab5bc75abff3bc1c3
cipher:		AES-256-GCM
key:		"feffe9928665731c6d6a8f9467308308feffe9928665731c6d6a8f9467308308"
iv:		"cafebabefacedbad"
aad:		"feedfacedeadbeeffeedfacedeadbeefabaddad2"
tag:		"3a337dbf46a792c45e454913fe2ea8f2"
plaintext:	"d9313225f88406e5a55909c5aff5269a86a7a9531534f7da2e4c303d8a318a721c3c0c95956809532fcf0e2449a6b525b16aedf5aa0de657ba637b39"
ciphertext:	"c3762df1ca787d32ae47c13bf19844cbaf1ae14d0b976afac52ff7d79bba9de0feb582d33934a4f0954cc2363bc73f7862ac430e64abe499f47c9b1f"

Test 13 failed, but this is expected because |IV| <> 12 bytes and we don't do IV expansion.
Please disregard.

Output cipher:	cf3b9ab7a70a2ac55a7bcf74cda369c5b32e7870a937cb4d7679ef877de6403b7126c8ca2d6c620755e8ff330af0e7fa003585282b2d7a3d8f785bcc
Output tag:	881390e147e8fc6b2923305b6413a594
cipher:		AES-256-GCM
key:		"feffe9928665731c6d6a8f9467308308feffe9928665731c6d6a8f9467308308"
iv:		"9313225df88406e555909c5aff5269aa6a7a9538534f7da1e4c303d2a318a728c3c0c95156809539fcf0e2429a6b525416aedbf5a0de6a57a637b39b"
aad:		"feedfacedeadbeeffeedfacedeadbeefabaddad2"
tag:		"a44a8266ee1c8eb0c8b5d4cf5ae9f19a"
plaintext:	"d9313225f88406e5a55909c5aff5269a86a7a9531534f7da2e4c303d8a318a721c3c0c95956809532fcf0e2449a6b525b16aedf5aa0de657ba637b39"
ciphertext:	"5a8def2f0c9e53f1f75d7853659e2a20eeb2b22aafde6419a058ab4f6f746bf40fc0c3b780f244452da3ebf1c5d82cdea2418997200ef82e44ae7e3f"

Test 14 failed, but this is expected because |IV| <> 12 bytes and we don't do IV expansion.
Please disregard.

Test 15 OK

Test 16 OK

Test 17 OK

Test 18 OK

Output cipher:	eff01b40f151144abb70955cedcbe564afd7d338ce2c3eb2ac13b1228ef785edc5bf4b7501cdc522a855c4e5843a3a0af67e4c8285f641951d9dcb727fb5d53bffe8165999884aa1626b20328a233f189b48820f19d2cf1551f21d0ae749227f1d47344d687533456994f11584dfd15d4791ceedf45f3774821bcd340d4b18ec8ed70e7ce40859ec159363caab3eaa87261cbda3733c01bbd39f03f21d3c4f1b3af2cadd75c67fbe96929c20a13077991908a0d23adbcecd49ed2ed71dd8f659
Output tag:	1f200ef9ef5218a0a69331c8304f873d
cipher:		AES-128-GCM
key:		"00000000000000000000000000000000"
iv:		"ffffffff000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000"
aad:		""
tag:		"566f8ef683078bfdeeffa869d751a017"
plaintext:	"000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000"
ciphertext:	"56b3373ca9ef6e4a2b64fe1e9a17b61425f10d47a75a5fce13efc6bc784af24f4141bdd48cf7c770887afd573cca5418a9aeffcd7c5ceddfc6a78397b9a85b499da558257267caab2ad0b23ca476a53cb17fb41c4b8b475cb4f3f7165094c229c9e8c4dc0a2a5ff1903e501511221376a1cdb8364c5061a20cae74bc4acd76ceb0abc9fd3217ef9f8c90be402ddf6d8697f4f880dff15bfb7a6b28241ec8fe183c2d59e3f9dfff653c7126f0acb9e64211f42bae12af462b1070bef1ab5e3606"

Test 19 failed, but this is expected because |IV| <> 12 bytes and we don't do IV expansion.
Please disregard.

Output cipher:	eff01b40f151144abb70955cedcbe564afd7d338ce2c3eb2ac13b1228ef785edc5bf4b7501cdc522a855c4e5843a3a0af67e4c8285f641951d9dcb727fb5d53bffe8165999884aa1626b20328a233f189b48820f19d2cf1551f21d0ae749227f1d47344d687533456994f11584dfd15d4791ceedf45f3774821bcd340d4b18ec8ed70e7ce40859ec159363caab3eaa87261cbda3733c01bbd39f03f21d3c4f1b3af2cadd75c67fbe96929c20a13077991908a0d23adbcecd49ed2ed71dd8f65954f4ff316fe216dd9e29b1ea55824efb884af85d0e6743d586acfc3088f200284dcb744dcf6fe40745827d98067e32af9b279d8f8354d7e47b8bb6736de3b66479f0d1ee5cb7796d966955cc6dea4ae5e4205b07040a0d9ec6594c2c6d2350a4
Output tag:	99b156f6881899ee456476976e9f5414
cipher:		AES-128-GCM
key:		"00000000000000000000000000000000"
iv:		"ffffffff000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000"
aad:		""
tag:		"8b307f6b33286d0ab026a9ed3fe1e85f"
plaintext:	"000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000"
ciphertext:	"56b3373ca9ef6e4a2b64fe1e9a17b61425f10d47a75a5fce13efc6bc784af24f4141bdd48cf7c770887afd573cca5418a9aeffcd7c5ceddfc6a78397b9a85b499da558257267caab2ad0b23ca476a53cb17fb41c4b8b475cb4f3f7165094c229c9e8c4dc0a2a5ff1903e501511221376a1cdb8364c5061a20cae74bc4acd76ceb0abc9fd3217ef9f8c90be402ddf6d8697f4f880dff15bfb7a6b28241ec8fe183c2d59e3f9dfff653c7126f0acb9e64211f42bae12af462b1070bef1ab5e3606872ca10dee15b3249b1a1b958f23134c4bccb7d03200bce420a2f8eb66dcf3644d1423c1b5699003c13ecef4bf38a3b60eedc34033bac1902783dc6d89e2e774188a439c7ebcc0672dbda4ddcfb2794613b0be41315ef778708a70ee7d75165c"

Test 20 failed, but this is expected because |IV| <> 12 bytes and we don't do IV expansion.
Please disregard.

Test 21 OK

AEAD: 21/21 tests passed
OCAMLPATH="C:/build/agent1/_work/13/s/FStar/bin" ocamlfind opt -package fstarlib,zarith -g -I C:/build/agent1/_work/13/s/FStar/ulib/ml -c QuicProvider/test.c -I QuicProvider/ -I ../secure_api/out/runtime_switch -I C:/build/agent1/_work/13/s/kremlin/include -I C:/build/agent1/_work/13/s/MLCrypto \
-I ../../mitls-fstar/libs/ffi -ccopt "-o QuicProvider/test.o" -I ../code/salsa-family/chacha-c -I ../code/poly1305/poly-c \
-I ../code/curve25519/x25519-c -I ../secure_api/out/runtime_switch/crypto -I ../code/api/aead-c \
-ccopt -Wall -ccopt -Wextra -ccopt -I -ccopt C:/build/agent1/_work/13/s/kremlin/include -ccopt -Wno-unused-variable -ccopt -Wno-unused-parameter -ccopt -Wno-unused-but-set-variable -ccopt -Wno-parentheses -ccopt -Werror -ccopt -Wno-unknown-warning-option
OCAMLPATH="C:/build/agent1/_work/13/s/FStar/bin" ocamlfind opt -package fstarlib,zarith -g -I C:/build/agent1/_work/13/s/FStar/ulib/ml -c QuicProvider/quic_provider.c -I QuicProvider/ -I ../secure_api/out/runtime_switch -I C:/build/agent1/_work/13/s/kremlin/include -I C:/build/agent1/_work/13/s/MLCrypto \
-I ../../mitls-fstar/libs/ffi -ccopt "-o QuicProvider/quic_provider.o" -I ../code/salsa-family/chacha-c -I ../code/poly1305/poly-c \
-I ../code/curve25519/x25519-c -I ../secure_api/out/runtime_switch/crypto -I ../code/api/aead-c \
-ccopt -Wall -ccopt -Wextra -ccopt -I -ccopt C:/build/agent1/_work/13/s/kremlin/include -ccopt -Wno-unused-variable -ccopt -Wno-unused-parameter -ccopt -Wno-unused-but-set-variable -ccopt -Wno-parentheses -ccopt -Werror -ccopt -Wno-unknown-warning-option
x86_64-w64-mingw32-gcc vale/asm/sha256_main_i.o vale/asm/sha256-x86_64.o vale/asm/Vale_Hash_SHA2_256.o vale/asm/vale_aes_glue.o vale/asm/aes-x86_64.o QuicProvider/quic_provider.o ../secure_api/out/runtime_switch/crypto/Crypto_AEAD_Main_Crypto_Indexing.o ../secure_api/out/runtime_switch/crypto/Crypto_Symmetric_Bytes.o ../secure_api/out/runtime_switch/crypto/Crypto_HKDF_Crypto_HMAC.o ../code/salsa-family/chacha-c/Hacl_Chacha20.o ../code/poly1305/poly-c/AEAD_Poly1305_64.o ../code/api/policies-c/Hacl_Policies.o ../code/api/aead-c/Hacl_Chacha20Poly1305.o C:/build/agent1/_work/13/s/kremlin/kremlib/out/libkremlib.a -o ../secure_api/out/runtime_switch/libquicprovider.dll  -shared
x86_64-w64-mingw32-gcc QuicProvider/test.o -o ../secure_api/out/runtime_switch/quicprovider-test.exe -L../secure_api/out/runtime_switch -lquicprovider C:/build/agent1/_work/13/s/kremlin/kremlib/out/libkremlib.a
./../secure_api/out/runtime_switch/quicprovider-test.exe
==== coverage ====
SHA256('') =
e3b0c44298fc1c149afbf4c8996fb92427ae41e4649b934ca495991b7852b855

SHA384('') = 
38b060a751ac96384cd9327eb1b1e36a21fdb71114be07434c0cc7bf63f6e1da
274edebfe76f65fbd51ad2f14898b95b

+ cd mitls-fstar/src/tls
SHA512('') = 
cf83e1357eefb8bdf1542850d66d8007d620e4050b5715dc83f4a921d36ce9ce
+ make -j 16 test
47d0d13c5d85f2b0ff8318d2877eec2f63b931bd47417a81a538327af927da3e

HMAC-SHA256('Jefe', 'what do ya want for nothing?') = 
5bdcc146bf60754e6a042426089575c75a003f089d2739839dec58b964ec3843

HMAC-SHA384('Jefe', 'what do ya want for nothing?') = 
af45d2e376484031617f78d2b58a6b1b9c7ef464f5a01b47e42ec3736322445e
8e2240ca5e69e2c78b3239ecfab21649

HMAC-SHA512('Jefe', 'what do ya want for nothing?') = 
164b7a7bfcf819e2e395fbe73b56e0a387bd64222e831fd610270cd7ea250554
9758bf75c05a994a6d034f65f8f0e6fdcaeab1a34d4a6b4b636e070a38bce737

prk = HKDF-EXTRACT-SHA256('0x000102030405060708090a0b0c', '0x0b0b0b0b0b0b0b0b0b0b0b0b0b0b0b0b0b0b0b0b0b0b')
077709362c2e32df0ddc3f0dc47bba6390b6c73bb50f9c3122ec844ad7c2b3e5
077709362c2e32df0ddc3f0dc47bba6390b6c73bb50f9c3122ec844ad7c2b3e5

okm = HKDF-EXPAND-SHA256(prk, '0xf0f1f2f3f4f5f6f7f8f9', 42)
3cb25f25faacd57a90434f64d0362f2a2d2d0a90cf1a5a4c5db02d56ecc4c5bf
34007208d5b887185865

AES-128-GCM encrypt test:
5936f46d6c7eb7008dbbfb0d40b491fce5328aedcbc0c5272457d347363fd36d
f238bd17971e982f4449350d
DECRYPT SUCCES: 
7768617420646f2079612077616e7420666f72206e6f7468696e673f

CHACHA20-POLY1305 encrypt test:
a62fe99f3d6001a4f4214a986f04b1f42ea1e5dcea3236ecf35adb5d8cc57db2
df5e18b278c8c904fcddf440
DECRYPT SUCCES: 
7768617420646f2079612077616e7420666f72206e6f7468696e673f
==== PASS:  coverage ====


==== test_crypto(TLS_hash_SHA256,TLS_aead_AES_128_GCM) ====
PASS
==== test_crypto(TLS_hash_SHA384,TLS_aead_AES_128_GCM) ====
PASS
==== test_crypto(TLS_hash_SHA512,TLS_aead_AES_128_GCM) ====
PASS
==== test_crypto(TLS_hash_SHA256,TLS_aead_AES_256_GCM) ====
PASS
==== test_crypto(TLS_hash_SHA384,TLS_aead_AES_256_GCM) ====
PASS
==== test_crypto(TLS_hash_SHA512,TLS_aead_AES_256_GCM) ====
PASS
==== test_crypto(TLS_hash_SHA256,TLS_aead_CHACHA20_POLY1305) ====
PASS
==== test_crypto(TLS_hash_SHA384,TLS_aead_CHACHA20_POLY1305) ====
PASS
==== test_crypto(TLS_hash_SHA512,TLS_aead_CHACHA20_POLY1305) ====
PASS
==== test_handshake_secrets() ====
==== PASS: test_handshake_secrets ==== 
==== ALL TESTS PASS ====
make: Leaving directory '/cygdrive/c/build/agent1/_work/13/s/hacl-star/secure_api'
rm -f cache/OCaml/.depend cache/Kremlin/.depend cache/Model/.depend
make -f Makefile.Model test
make -f Makefile.Kremlin test
make -f Makefile.OCaml test
make -C ../../apps/quicMinusNet test -k
make[1]: Entering directory '/cygdrive/c/build/agent1/_work/13/s/mitls-fstar/apps/quicMinusNet'
x86_64-w64-mingw32-gcc.exe -fPIC -I../../src/tls/extract/Kremlin-Library/include \
quic.c:1:0: warning: -fPIC ignored for target (all code is position independent)
-I../../src/tls/extract/Kremlin-Library/stub -I../../src/pki \
-I../../libs/ffi -I/cygdrive/c/build/agent1/_work/13/s/hacl-star/secure_api/QuicProvider \
#define __USE_MINGW_ANSI_STDIO 1
quic.c \
^
-L/cygdrive/c/build/agent1/_work/13/s/hacl-star/providers/out -L../../src/pki -L../../src/tls/extract/Kremlin-Library -L/cygdrive/c/build/agent1/_work/13/s/hacl-star/secure_api/out/runtime_switch -L/cygdrive/c/build/agent1/_work/13/s/MLCrypto/openssl \
-lmitls -lquicprovider -lmipki  -o quic.exe
make[1]: Leaving directory '/cygdrive/c/build/agent1/_work/13/s/mitls-fstar/apps/quicMinusNet'
make[1]: Entering directory '/cygdrive/c/build/agent1/_work/13/s/mitls-fstar/apps/quicMinusNet'
./quic.exe
server create
FFI| offering custom extension 001a
FFI| extension contents: ffff00050a0b0c0d0e
FFI| setting early data limit to ffffffff
FFI| Setting a new ticket callback.
FFI| Setting a new server negotiation callback.
FFI| Setting up certificate callbacks.
client create
FFI| offering custom extension 001a
FFI| extension contents: ffff00050a0b0c0d0e
FFI| setting early data limit to ffffffff
FFI| Setting a new ticket callback.
FFI| Setting a new server negotiation callback.
FFI| Setting up certificate callbacks.
client call clen=8192 slen=   0
TLS| writeHandshake (plaintext)
TLS| HS.next_fragment PlaintextID?
HS | next_fragment
HS | offering ClientHello 1.3
KS | ks_client_init 1.3
CDH| Keygen (initiator) on X255519
NGO| No PSK or 0-RTT disabled
NGO| offering client extensions [ 001a supported_versions key_share server_name alpn extended_master_secret signature_algorithms supported_groups psk_key_exchange_modes ]
NGO| offering cipher suites ; TLS_CHACHA20_POLY1305_SHA256; TLS_AES_128_GCM_SHA256
HSL| emit ClientHello
TLS| HS.next_fragment returned a fragment
TLS| sendHandshake
TLS| send Handshake fragment with index PlaintextID
TLS| Sending fragment of length 170
REC| record headers: 16030300aa
TLS| writeHandshake (plaintext)
TLS| HS.next_fragment PlaintextID?
HS | next_fragment
TLS| HS.next_fragment returned nothing
TLS| sendHandshake
TLS| read: WrittenHS, Ctrl/Ctrl, nothing
REC| WouldBlock
TLS| readOne ReadWouldBlock
client done clen= 175 slen=   0 status=would_block
16030300aa010000a603035b170bac6e0f2acba7de6c3185fcdab4c1ca568dea
2f67ad3188d1612e8dec460000041303130101000079001a0009ffff00050a0b
0c0d0e002b0003027f1c003300260024001d00200be9adb1618c214965151ae7
87dc082b7b1f75873379599299328edc8d1d70240000000e000c0000096c6f63
616c686f73740010000800060568712d313000170000000d0006000408040403
000a00040002001d002d0003020001
server call clen= 175 slen=8192
TLS| writeHandshake (plaintext)
TLS| HS.next_fragment PlaintextID?
HS | next_fragment
TLS| HS.next_fragment returned nothing
TLS| sendHandshake
TLS| read: WrittenHS, Ctrl/Ctrl, nothing
TLS| Read fragment at epoch index: -1 of length 170
TLS| read Handshake fragment
HS | recv_fragment
HSL| parsed [ClientHello] -- end of flight 
HS | Processing ClientHello
NGO| offered client extensions [ 001a supported_versions key_share server_name alpn extended_master_secret signature_algorithms supported_groups psk_key_exchange_modes ]
NGO| offered cipher suites ; TLS_CHACHA20_POLY1305_SHA256; TLS_AES_128_GCM_SHA256
NGO| offered versions 1.3
NGO| Negotiated Pure EDH key exchange
NGO| Negotiated ECDSA_SECP256R1_SHA256
NGO| Negotiation callback to handle extra extensions and query for stateless retry.
NGO| Application data in cookie: none
@@@@ Nego callback for TLS 1.3 @@@@
Offered extensions:
003d001a0009ffff00050a0b0c0d0e0000000e000c0000096c6f63616c686f73
740010000800060568712d3130000d0006000408040403000a00040002001d
Transport parameters offered:
ffff00050a0b0c0d0e
No application cookie (fist connection).
Adding server transport parameters:
000102
@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
NGO| negotiated 1.3 TLS_CHACHA20_POLY1305_SHA256
KS | ks_server_init
KS | No PSK selected.
KS | Computed early secret:           33ad0a1c607ec03b09e6cd9893680ce210adf300aa1f2660e1b22e10f170f92a
KS | Handshake salt:                  6f2615a108c702c5678f54fc9dbab69716c076189c48250cebeac3576c3611ba
CDH| Keygen (responder) on X255519
CDH| DH initiator on X255519
KS | DH shared secret: 1e1bad0f77b68471c4cbf426014c5191cd4327acca1bde02f6a62735629db33f
KS | Handshake secret:                a20e55b81bccd5af6ed056910e702090fe71b0b8e5fe8626117ed424acaab0f4
NGO| processing client extensions [ 001a supported_versions key_share server_name alpn extended_master_secret signature_algorithms supported_groups psk_key_exchange_modes ]
NGO| including server extensions (SH + EE) [ supported_versions key_share alpn supported_groups ]
NGO| extra extensions from application callback: 001a 
HSL| emit ServerHello and hash
HS | derive handshake keys
KS | ks_server_13_sh, hashed log = 0f84c6bec9c0b6dbbc5fa762484fe99e88b2281ec03fd6f8eb7e984b4601896b
KS | handshake traffic secret[C]:     b48ccd04c179cbadc513a27b0a0cf35378857d08f14ad63c462425be2f1c8001
KS | handshake traffic secret[S]:     b95ebe60a8a56ea2985f3a4346331ebb3a3263c5a4f320e910c7ad4c4cf61ad7
KS | handshake key[C]:                57813ab599c2a73f2d4146dc5f860a726fd90c6012a950ed702f441595eb63c0, IV=1ff39af65bc003383ee551d7
KS | handshake key[S]: f342b386aabd9bf1acfe4fa1f4d111f278751e34ac92841ab4cc99b794050ef1, IV=6dd5c09309361235bf8c97ec
AEP| LowProvider: COERCE(K=f342b386aabd9bf1acfe4fa1f4d111f278751e34ac92841ab4cc99b794050ef1)
AEP| LowProvider: COERCE(K=57813ab599c2a73f2d4146dc5f860a726fd90c6012a950ed702f441595eb63c0)
KS | finished key[C]:                 f19180a876291cd2ae8262dc4db19d7eb031422c4c8ad939902ea66c159ce667
KS | finished key[S]:                 eade931fd41dad8f68ddbe65db5ee92035a3fef0157e91c62a75972c5043abec
KS | Application salt:                a111b8b7f21a466f9b39f081f2848ad8a6537ae418b9229e183becbbe23ca26f
KS | Application secret:              1c7eea654ccd2e5610e8f6f9ceac61d403ab47c9036666ee0c0227bfbca1bffb
TLS| readOne ReadAgain
TLS| writeHandshake (plaintext)
TLS| HS.next_fragment PlaintextID?
HS | next_fragment
TLS| HS.next_fragment returned a fragment; next_keys (for handshake only
TLS| sendHandshake
TLS| send Handshake fragment with index PlaintextID
TLS| Sending fragment of length 90
REC| record headers: 160303005a
EPO| writer++ -1/0
TLS| writeHandshake (encrypted)
TLS| HS.next_fragment ID13?
HS | next_fragment
HS | prepare Server Finished
HSL| emit EncryptedExtensions
HSL| emit Certificate13 and hash
======== TO BE SIGNED <0403>: (130 octets) ========
2020202020202020202020202020202020202020202020202020202020202020
2020202020202020202020202020202020202020202020202020202020202020
544c5320312e332c207365727665722043657274696669636174655665726966
79001c4e6e977bbd0f4d45f2366675434a8d6ea430a8a25c466f02d946e9219f
55e3
===================================================
HSL| emit CertificateVerify and hash
HSL| emit Finished and hash
KS | ks_server_13_sf hashed_log = 290adbeb7726faf7c02b3af9c9b4ddfd5ebb1d8cd15e39e5198b6f34ac73387b
KS | application traffic secret[C]:   73f8431448603526f856490a7c2c8ba8ca1f1bcb40c6d56cfef7bad9fd80fc38
KS | application traffic secret[S]:   e8a66c402f418e6005d65e7d6d323ab52e9c26730f67d9c36f322101a7a2ee12
KS | exporter master secret:          138be6a3628fc16caab9211058fd59165d5daeef1c4320d9b3acb446c32ad513
KS | application key[C]:              2dea5f9b95fd8389309e54ccdc6f0f79ba513aef97de07c8483b871b79e2770e, IV=ede46dff0121efe76004c4e4
KS | application key[S]:              fed10a7f797b5e86dd2221e5dd520cabcb9b5705db4e53046c4269665c2fc4e2, IV=27e8970b08a0b587eddebd4f
AEP| LowProvider: COERCE(K=fed10a7f797b5e86dd2221e5dd520cabcb9b5705db4e53046c4269665c2fc4e2)
AEP| LowProvider: COERCE(K=2dea5f9b95fd8389309e54ccdc6f0f79ba513aef97de07c8483b871b79e2770e)
HS | exporting a key
EPO| reader++ 0/0
TLS| HS.next_fragment returned a fragment; next_keys (for all data)
TLS| sendHandshake
TLS| send Handshake fragment with index ID13
TLS| Encrypting with key f342b386aabd9bf1acfe4fa1f4d111f278751e34ac92841ab4cc99b794050ef1
TLS| Sending fragment of length 734
REC| record headers: 17030302de
EPO| writer++ 0/1
TLS| read: WrittenHS, Ctrl/Open, new writer: writable
sender done clen= 175 slen= 834 status=server_accept
160303005a0200005603035b170bac369e66e64e52e34be555675ea59a8c6abe
e9b6536695808947cda94200130300002e002b00027f1c00330024001d00207f
68017fac04972900b3645075c8b2761ea3965f1867a1f9832667f4a843684a17
030302de78e68e8bd85bf662e8d1204b417c850429627ac9737eb966305c9a60
c356fe8b9449d86cad4a9e51623ee2f95b7200aff577f4e69a39871b18738f43
dedf4ec2b4ec9eb3483788b568bbeff2a569c786cd68821fac821b8754bfdd3c
aea3d344dc66aedd76e89787932285bec22ed63bd0361e14a2cabfdca05f9c5d
605c0fb8c4e90723cb41911145ae3e6b8c3f85b93e968edb935a0774f36d12f1
61b974e227a6f976de6e8b7dd8274fa0574a5b5ca5ddf33763fefb8647bddc49
7d86928f1295cf82900ce08db43616cedae0a6258f8f9677d39c64edbad375a6
86423db83bde612b144f1912e693244e58068b230777c06f52102f491704b6b8
60aa9f736856b58500aedf9334477c86a87fa3c844f9d41a1daecf8881a31882
8b4b6c46535a654ec5fcf224642e989c898016782bf93dfafaf590b12933e85f
0eb59f3e6187c96b68332f4205ac36689d640df18db18dcce9630b33bc90c186
e477e369eb5292d5b4d6e4421c4970d3078d23a0bc473f9ea1260d21895bbcf7
055b6daa278a9780fde0f8c24a3763e2618d393c4fd8bbb75074cb8f9a48ba95
b86ef967efc427a52ca9879f9c11d0297aa5d8361fe712f535cf02fcfc17d412
b5957e6e2785741b018372af55fb45381cfdef81ffbc5988732740964fdabd32
4dff35dff8e5f25caa540b6b8201fcf788e2183d5f928ac7a10f834a1a4c4cbc
1be88bea7b10ec654bb8e6241ec718fa1eb271c365df3d2dbfdbed022767b9d8
9fad5e88da5bc65b46794b2dbf648c7ca0e7806d40fed22081a2a1d34d342d13
3e039e602591ac59bc9d69af8e3773bbdad2a7b4a8da73da5e730f606587910d
4635c68ee7072d2039b10ff115b6d6d3ffd6120f3363d4c51c72fe1dfb960284
0bd028b4071d17fb6eeef14adb935535319a0944e3201323c58bceaa510928be
f36c792d96478e20acd5f7e49fe84129ed5b4bf0b2e5ce14c016b580b2ce26ec
4fd93d339bd201ba83fe30c22be5f117e77194686c9fa7cbbf861d377a2f5635
533d
client call clen=8017 slen= 834
TLS| writeHandshake (plaintext)
TLS| HS.next_fragment PlaintextID?
HS | next_fragment
TLS| HS.next_fragment returned nothing
TLS| sendHandshake
TLS| read: WrittenHS, Ctrl/Ctrl, nothing
TLS| Read fragment at epoch index: -1 of length 90
TLS| read Handshake fragment
HS | recv_fragment
HSL| parsed ServerHello
HSL| end of flight
HS | client_ServerHello
NGO| processing server extensions [ supported_versions key_share ]
NGO| negotiated 1.3 TLS_CHACHA20_POLY1305_SHA256
HS | Running TLS 1.3
KS | ks_client_13_sh hashed_log = 0f84c6bec9c0b6dbbc5fa762484fe99e88b2281ec03fd6f8eb7e984b4601896b
KS | no PSK negotiated. Early secret: 33ad0a1c607ec03b09e6cd9893680ce210adf300aa1f2660e1b22e10f170f92a
KS | handshake salt:                  6f2615a108c702c5678f54fc9dbab69716c076189c48250cebeac3576c3611ba
CDH| DH initiator on X255519
KS | DH shared secret: 1e1bad0f77b68471c4cbf426014c5191cd4327acca1bde02f6a62735629db33f
KS | handshake secret:                a20e55b81bccd5af6ed056910e702090fe71b0b8e5fe8626117ed424acaab0f4
KS | handshake traffic secret[C]:     b48ccd04c179cbadc513a27b0a0cf35378857d08f14ad63c462425be2f1c8001
KS | handshake traffic secret[S]:     b95ebe60a8a56ea2985f3a4346331ebb3a3263c5a4f320e910c7ad4c4cf61ad7
KS | handshake key[C]:                57813ab599c2a73f2d4146dc5f860a726fd90c6012a950ed702f441595eb63c0, IV=1ff39af65bc003383ee551d7
KS | handshake key[S]:                f342b386aabd9bf1acfe4fa1f4d111f278751e34ac92841ab4cc99b794050ef1, IV=6dd5c09309361235bf8c97ec
KS | finished key[C]: f19180a876291cd2ae8262dc4db19d7eb031422c4c8ad939902ea66c159ce667
KS | finished key[S]: eade931fd41dad8f68ddbe65db5ee92035a3fef0157e91c62a75972c5043abec
KS | application salt:                a111b8b7f21a466f9b39f081f2848ad8a6537ae418b9229e183becbbe23ca26f
KS | application secret:              1c7eea654ccd2e5610e8f6f9ceac61d403ab47c9036666ee0c0227bfbca1bffb
AEP| LowProvider: COERCE(K=57813ab599c2a73f2d4146dc5f860a726fd90c6012a950ed702f441595eb63c0)
AEP| LowProvider: COERCE(K=f342b386aabd9bf1acfe4fa1f4d111f278751e34ac92841ab4cc99b794050ef1)
EPO| reader++ 0/-1
TLS| readOne ReadAgain
TLS| writeHandshake (plaintext)
TLS| HS.next_fragment PlaintextID?
HS | next_fragment
TLS| HS.next_fragment returned nothing
TLS| sendHandshake
TLS| read: WrittenHS, Ctrl/Ctrl, nothing
TLS| Read fragment at epoch index: 0 of length 734
TLS| StAE decrypt correct.
TLS| read Handshake fragment
HS | recv_fragment
HSL| parsed EncryptedExtensions
HSL| parsed Certificate13
HSL| parsed CertificateVerify
HSL| parsed Finished
HSL| end of flight
NGO| Nego.clientComplete_13
NGO| EE: alpn supported_groups 001a 
NGO| Negotiation callback to process application extensions.
@@@@ Nego callback for TLS 1.3 @@@@
Offered extensions:
001b0010000800060568712d3130000a00040002001d001a0003000102
Transport parameters offered:
000102
No application cookie (fist connection).
Adding server transport parameters:
000102
@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
WARNING: chain validation failed, ignoring.
NGO| Certificate & signature 1.3 callback result: valid
KS | ks_client_13_sf hashed_log = 290adbeb7726faf7c02b3af9c9b4ddfd5ebb1d8cd15e39e5198b6f34ac73387b
KS | application traffic secret[C]:   73f8431448603526f856490a7c2c8ba8ca1f1bcb40c6d56cfef7bad9fd80fc38
KS | application traffic secret[S]:   e8a66c402f418e6005d65e7d6d323ab52e9c26730f67d9c36f322101a7a2ee12
KS | exporter master secret:          138be6a3628fc16caab9211058fd59165d5daeef1c4320d9b3acb446c32ad513
KS | application key[C]:              2dea5f9b95fd8389309e54ccdc6f0f79ba513aef97de07c8483b871b79e2770e, IV=ede46dff0121efe76004c4e4
KS | application key[S]:              fed10a7f797b5e86dd2221e5dd520cabcb9b5705db4e53046c4269665c2fc4e2, IV=27e8970b08a0b587eddebd4f
AEP| LowProvider: COERCE(K=2dea5f9b95fd8389309e54ccdc6f0f79ba513aef97de07c8483b871b79e2770e)
AEP| LowProvider: COERCE(K=fed10a7f797b5e86dd2221e5dd520cabcb9b5705db4e53046c4269665c2fc4e2)
HS | exporting a key
HS | Early data rejected
EPO| writer++ 0/0
HSL| emit Finished and hash
KS | ks_client_13_cf hashed_log = 74f60cae87a2e71692f278de666ceb6fde470ee19b14d4008ea9e8ccec598b3c
KS | resumption master secret:        d86abeeab475aede1a658a00af85e88b998baca3a01b59407e9300fd569673c8
EPO| reader++ 1/0
TLS| readOne ReadAgain
TLS| writeHandshake (encrypted)
TLS| HS.next_fragment ID13?
HS | next_fragment
TLS| HS.next_fragment returned a fragment; next_keys (for all data); complete
TLS| sendHandshake
TLS| send Handshake fragment with index ID13
TLS| Encrypting with key 57813ab599c2a73f2d4146dc5f860a726fd90c6012a950ed702f441595eb63c0
TLS| Sending fragment of length 53
REC| record headers: 1703030035
EPO| writer++ 1/1
TLS| read: WrittenHS, Open/Open, new writer: complete
client done clen=  58 slen= 834 status=client_complete
1703030035262a7538419084233dbfbeb285711dca77c26126e38304fd5db728
8c75c53f10612db5651d9e7e14d701f7f4b31f449c61973ebef6
server call clen=  58 slen=7358
TLS| writeHandshake (encrypted)
TLS| HS.next_fragment ID13?
HS | next_fragment
TLS| HS.next_fragment returned nothing
TLS| sendHandshake
TLS| read: WrittenHS, Ctrl/Open, nothing
TLS| Read fragment at epoch index: 0 of length 53
TLS| StAE decrypt correct.
TLS| read Handshake fragment
HS | recv_fragment
HSL| parsed Finished
HSL| end of flight
HS | Process Client Finished
KS | ks_server_13_cf hashed_log = 74f60cae87a2e71692f278de666ceb6fde470ee19b14d4008ea9e8ccec598b3c
KS | resumption master secret:        d86abeeab475aede1a658a00af85e88b998baca3a01b59407e9300fd569673c8
AEP| LowProvider: COERCE(K=7177ba9b949b965595b08f0f5067600669f35d8323213d859652500124bce4ed)
HS | Sending ticket: 91a9bb204e60a414aae404e0956812325deed1215ce7b09ae82d0c9aa6487a39cc2e6e1372bad6046132a76c97c1f0fe12da3e22fb449f1bd590be8e1e0cd351bb5f00ed58f7eeb78c29623d
HSL| emit NewSessionTicket13
EPO| reader++ 1/1
TLS| readOne Complete
sender done clen=  58 slen=   0 status=server_complete
=== Exporter secret ===
138be6a3628fc16caab9211058fd59165d5daeef1c4320d9b3acb446c32ad513
=== QUIC 1-RTT secrets ===
C: a477c1a41f4a4cdc073202d450d63101a96e79b91d5adb94cddabba52673b409
S: 85d423bfadc2bde2baad6ad0d849119f63a8a17fd6033f7723d2497b13ecf7db
=== AEAD client key test ===
82697a44015d8baa44e97957ea5e43ed17809c93a7550c036c4f17
=== Decrypt successful ===
Ok
./quic.exe 0rtt

INITIAL ECDHE HANDSHAKE (NO EARLY SECRET)

server create
FFI| offering custom extension 001a
FFI| extension contents: ffff00050a0b0c0d0e
FFI| setting early data limit to ffffffff
FFI| Setting a new ticket callback.
FFI| Setting a new server negotiation callback.
FFI| Setting up certificate callbacks.
client create
FFI| offering custom extension 001a
FFI| extension contents: ffff00050a0b0c0d0e
FFI| setting early data limit to ffffffff
FFI| Setting a new ticket callback.
FFI| Setting a new server negotiation callback.
FFI| Setting up certificate callbacks.
TLS| writeHandshake (plaintext)
TLS| HS.next_fragment PlaintextID?
HS | next_fragment
HS | offering ClientHello 1.3
KS | ks_client_init 1.3
CDH| Keygen (initiator) on X255519
NGO| No PSK or 0-RTT disabled
NGO| offering client extensions [ 001a supported_versions key_share server_name alpn extended_master_secret signature_algorithms supported_groups psk_key_exchange_modes ]
NGO| offering cipher suites ; TLS_CHACHA20_POLY1305_SHA256; TLS_AES_128_GCM_SHA256
HSL| emit ClientHello
TLS| HS.next_fragment returned a fragment
TLS| sendHandshake
TLS| send Handshake fragment with index PlaintextID
TLS| Sending fragment of length 170
REC| record headers: 16030300aa
TLS| writeHandshake (plaintext)
TLS| HS.next_fragment PlaintextID?
HS | next_fragment
TLS| HS.next_fragment returned nothing
TLS| sendHandshake
TLS| read: WrittenHS, Ctrl/Ctrl, nothing
REC| WouldBlock
TLS| readOne ReadWouldBlock
client returns would_block clen=175 slen=0
ClientHello[ 175] ---->

TLS| writeHandshake (plaintext)
TLS| HS.next_fragment PlaintextID?
HS | next_fragment
TLS| HS.next_fragment returned nothing
TLS| sendHandshake
TLS| read: WrittenHS, Ctrl/Ctrl, nothing
TLS| Read fragment at epoch index: -1 of length 170
TLS| read Handshake fragment
HS | recv_fragment
HSL| parsed [ClientHello] -- end of flight 
HS | Processing ClientHello
NGO| offered client extensions [ 001a supported_versions key_share server_name alpn extended_master_secret signature_algorithms supported_groups psk_key_exchange_modes ]
NGO| offered cipher suites ; TLS_CHACHA20_POLY1305_SHA256; TLS_AES_128_GCM_SHA256
NGO| offered versions 1.3
NGO| Negotiated Pure EDH key exchange
NGO| Negotiated ECDSA_SECP256R1_SHA256
NGO| Negotiation callback to handle extra extensions and query for stateless retry.
NGO| Application data in cookie: none
@@@@ Nego callback for TLS 1.3 @@@@
Offered extensions:
003d001a0009ffff00050a0b0c0d0e0000000e000c0000096c6f63616c686f73
740010000800060568712d3130000d0006000408040403000a00040002001d
Transport parameters offered:
ffff00050a0b0c0d0e
No application cookie (fist connection).
Adding server transport parameters:
000102
@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
NGO| negotiated 1.3 TLS_CHACHA20_POLY1305_SHA256
KS | ks_server_init
KS | No PSK selected.
KS | Computed early secret:           33ad0a1c607ec03b09e6cd9893680ce210adf300aa1f2660e1b22e10f170f92a
KS | Handshake salt:                  6f2615a108c702c5678f54fc9dbab69716c076189c48250cebeac3576c3611ba
CDH| Keygen (responder) on X255519
CDH| DH initiator on X255519
KS | DH shared secret: 623f92c6110229a9c6972f552e842f80cfa4189d27bd5d453de604477d52b027
KS | Handshake secret:                e38776db5695e866340a3af4b537e7732ff62c95690c2dcafe9c7c679f07209a
NGO| processing client extensions [ 001a supported_versions key_share server_name alpn extended_master_secret signature_algorithms supported_groups psk_key_exchange_modes ]
NGO| including server extensions (SH + EE) [ supported_versions key_share alpn supported_groups ]
NGO| extra extensions from application callback: 001a 
HSL| emit ServerHello and hash
HS | derive handshake keys
KS | ks_server_13_sh, hashed log = 5948b817139118b1f43c040fa8854aec6fd6a666f18ebc1b8ef4cea184f77c85
KS | handshake traffic secret[C]:     1fcdf0cd44fec5a7dbd3e5e74523f48cce7dd38d1a5e4d84fc2ac1a8c6d04631
KS | handshake traffic secret[S]:     1e9acab025f8f5b3106f5b284bc1576441e8ae0d65f98e46d8d1e59704984815
KS | handshake key[C]:                1d6511c372d029bf2c3c7b1b643c25cdc0613fe3624f0c4f90eaa2e96ca99916, IV=a7b51d3935be836984fb42c9
KS | handshake key[S]: 36fa5a09f111a99fe21bfa8ff5ab3d0eae758368c573911d55c476e89c9b5d4f, IV=64c93ce6557832cb10faea76
AEP| LowProvider: COERCE(K=36fa5a09f111a99fe21bfa8ff5ab3d0eae758368c573911d55c476e89c9b5d4f)
AEP| LowProvider: COERCE(K=1d6511c372d029bf2c3c7b1b643c25cdc0613fe3624f0c4f90eaa2e96ca99916)
KS | finished key[C]:                 3abfe8f0ce2896c9c19c968c1206ded335e1d0df49a49ebbb6bf712997fb5252
KS | finished key[S]:                 183f568f3b314a81c0684a89d697f136b743a4d37eb6278c09a60cc5f6bf0ef4
KS | Application salt:                53573f2d0d38b4384452c5c158334a5a9f998d7fdc187feb746c30794f2b8a4e
KS | Application secret:              35f7850d785fcd9df21d4e4c79e577d403f242557e38284f4239a370ae8c248f
TLS| readOne ReadAgain
TLS| writeHandshake (plaintext)
TLS| HS.next_fragment PlaintextID?
HS | next_fragment
TLS| HS.next_fragment returned a fragment; next_keys (for handshake only
TLS| sendHandshake
TLS| send Handshake fragment with index PlaintextID
TLS| Sending fragment of length 90
REC| record headers: 160303005a
EPO| writer++ -1/0
TLS| writeHandshake (encrypted)
TLS| HS.next_fragment ID13?
HS | next_fragment
HS | prepare Server Finished
HSL| emit EncryptedExtensions
HSL| emit Certificate13 and hash
======== TO BE SIGNED <0403>: (130 octets) ========
2020202020202020202020202020202020202020202020202020202020202020
2020202020202020202020202020202020202020202020202020202020202020
544c5320312e332c207365727665722043657274696669636174655665726966
790087d821dfe4ac4ba733f0c730e54c0db0847ca6868b0611cf12af81a0b77f
5161
===================================================
HSL| emit CertificateVerify and hash
HSL| emit Finished and hash
KS | ks_server_13_sf hashed_log = 10a455d23b6b1baf2728738ee5914eaf0a208eedd151073f6bea8035ffb3a53f
KS | application traffic secret[C]:   03182975b8a0595ea8e67ff626747c16ec7ab898fce64764db6df1599c740104
KS | application traffic secret[S]:   30ee637cfa9d43206052f07402ba2c120e6190a0f0378c9606ef9f3de93cbac8
KS | exporter master secret:          658b4fbe54b705d35179aea96926785ce10799b6a821ae6ac3b40bbf394fb7ef
KS | application key[C]:              69afe3095558ba091321a4a21954fc2fbf8dd71aafef83a8d5bbe7eee676d296, IV=77581278a55bc7be0ba086da
KS | application key[S]:              8a362535e4d336d336dc529a8e2653abc10734115812396d6edff562e3db90b1, IV=eadfe5f8e13949da11918d6e
AEP| LowProvider: COERCE(K=8a362535e4d336d336dc529a8e2653abc10734115812396d6edff562e3db90b1)
AEP| LowProvider: COERCE(K=69afe3095558ba091321a4a21954fc2fbf8dd71aafef83a8d5bbe7eee676d296)
HS | exporting a key
EPO| reader++ 0/0
TLS| HS.next_fragment returned a fragment; next_keys (for all data)
TLS| sendHandshake
TLS| send Handshake fragment with index ID13
TLS| Encrypting with key 36fa5a09f111a99fe21bfa8ff5ab3d0eae758368c573911d55c476e89c9b5d4f
TLS| Sending fragment of length 735
REC| record headers: 17030302df
EPO| writer++ 0/1
TLS| read: WrittenHS, Ctrl/Open, new writer: writable
server returns server_accept clen=175 slen=835
secret=658b4fbe54b705d35179aea96926785ce10799b6a821ae6ac3b40bbf394fb7ef
<---- ServerHello;(EncryptedExtensions; Certificate; CertVerify; Finished)[ 835]

TLS| writeHandshake (plaintext)
TLS| HS.next_fragment PlaintextID?
HS | next_fragment
TLS| HS.next_fragment returned nothing
TLS| sendHandshake
TLS| read: WrittenHS, Ctrl/Ctrl, nothing
TLS| Read fragment at epoch index: -1 of length 90
TLS| read Handshake fragment
HS | recv_fragment
HSL| parsed ServerHello
HSL| end of flight
HS | client_ServerHello
NGO| processing server extensions [ supported_versions key_share ]
NGO| negotiated 1.3 TLS_CHACHA20_POLY1305_SHA256
HS | Running TLS 1.3
KS | ks_client_13_sh hashed_log = 5948b817139118b1f43c040fa8854aec6fd6a666f18ebc1b8ef4cea184f77c85
KS | no PSK negotiated. Early secret: 33ad0a1c607ec03b09e6cd9893680ce210adf300aa1f2660e1b22e10f170f92a
KS | handshake salt:                  6f2615a108c702c5678f54fc9dbab69716c076189c48250cebeac3576c3611ba
CDH| DH initiator on X255519
KS | DH shared secret: 623f92c6110229a9c6972f552e842f80cfa4189d27bd5d453de604477d52b027
KS | handshake secret:                e38776db5695e866340a3af4b537e7732ff62c95690c2dcafe9c7c679f07209a
KS | handshake traffic secret[C]:     1fcdf0cd44fec5a7dbd3e5e74523f48cce7dd38d1a5e4d84fc2ac1a8c6d04631
KS | handshake traffic secret[S]:     1e9acab025f8f5b3106f5b284bc1576441e8ae0d65f98e46d8d1e59704984815
KS | handshake key[C]:                1d6511c372d029bf2c3c7b1b643c25cdc0613fe3624f0c4f90eaa2e96ca99916, IV=a7b51d3935be836984fb42c9
KS | handshake key[S]:                36fa5a09f111a99fe21bfa8ff5ab3d0eae758368c573911d55c476e89c9b5d4f, IV=64c93ce6557832cb10faea76
KS | finished key[C]: 3abfe8f0ce2896c9c19c968c1206ded335e1d0df49a49ebbb6bf712997fb5252
KS | finished key[S]: 183f568f3b314a81c0684a89d697f136b743a4d37eb6278c09a60cc5f6bf0ef4
KS | application salt:                53573f2d0d38b4384452c5c158334a5a9f998d7fdc187feb746c30794f2b8a4e
KS | application secret:              35f7850d785fcd9df21d4e4c79e577d403f242557e38284f4239a370ae8c248f
AEP| LowProvider: COERCE(K=1d6511c372d029bf2c3c7b1b643c25cdc0613fe3624f0c4f90eaa2e96ca99916)
AEP| LowProvider: COERCE(K=36fa5a09f111a99fe21bfa8ff5ab3d0eae758368c573911d55c476e89c9b5d4f)
EPO| reader++ 0/-1
TLS| readOne ReadAgain
TLS| writeHandshake (plaintext)
TLS| HS.next_fragment PlaintextID?
HS | next_fragment
TLS| HS.next_fragment returned nothing
TLS| sendHandshake
TLS| read: WrittenHS, Ctrl/Ctrl, nothing
TLS| Read fragment at epoch index: 0 of length 735
TLS| StAE decrypt correct.
TLS| read Handshake fragment
HS | recv_fragment
HSL| parsed EncryptedExtensions
HSL| parsed Certificate13
HSL| parsed CertificateVerify
HSL| parsed Finished
HSL| end of flight
NGO| Nego.clientComplete_13
NGO| EE: alpn supported_groups 001a 
NGO| Negotiation callback to process application extensions.
@@@@ Nego callback for TLS 1.3 @@@@
Offered extensions:
001b0010000800060568712d3130000a00040002001d001a0003000102
Transport parameters offered:
000102
No application cookie (fist connection).
Adding server transport parameters:
000102
@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
WARNING: chain validation failed, ignoring.
NGO| Certificate & signature 1.3 callback result: valid
KS | ks_client_13_sf hashed_log = 10a455d23b6b1baf2728738ee5914eaf0a208eedd151073f6bea8035ffb3a53f
KS | application traffic secret[C]:   03182975b8a0595ea8e67ff626747c16ec7ab898fce64764db6df1599c740104
KS | application traffic secret[S]:   30ee637cfa9d43206052f07402ba2c120e6190a0f0378c9606ef9f3de93cbac8
KS | exporter master secret:          658b4fbe54b705d35179aea96926785ce10799b6a821ae6ac3b40bbf394fb7ef
KS | application key[C]:              69afe3095558ba091321a4a21954fc2fbf8dd71aafef83a8d5bbe7eee676d296, IV=77581278a55bc7be0ba086da
KS | application key[S]:              8a362535e4d336d336dc529a8e2653abc10734115812396d6edff562e3db90b1, IV=eadfe5f8e13949da11918d6e
AEP| LowProvider: COERCE(K=69afe3095558ba091321a4a21954fc2fbf8dd71aafef83a8d5bbe7eee676d296)
AEP| LowProvider: COERCE(K=8a362535e4d336d336dc529a8e2653abc10734115812396d6edff562e3db90b1)
HS | exporting a key
HS | Early data rejected
EPO| writer++ 0/0
HSL| emit Finished and hash
KS | ks_client_13_cf hashed_log = 5bc9b510f99d50fbcb28f8becf48cd1165657b9908f75d0ed4805da9e4a032e7
KS | resumption master secret:        68f09b089442afa2e522d28e3ed460a740899ab299b7ac75e472d1aef13b44b5
EPO| reader++ 1/0
TLS| readOne ReadAgain
TLS| writeHandshake (encrypted)
TLS| HS.next_fragment ID13?
HS | next_fragment
TLS| HS.next_fragment returned a fragment; next_keys (for all data); complete
TLS| sendHandshake
TLS| send Handshake fragment with index ID13
TLS| Encrypting with key 1d6511c372d029bf2c3c7b1b643c25cdc0613fe3624f0c4f90eaa2e96ca99916
TLS| Sending fragment of length 53
REC| record headers: 1703030035
EPO| writer++ 1/1
TLS| read: WrittenHS, Open/Open, new writer: complete
client returns client_complete clen=58 slen=835
secret=658b4fbe54b705d35179aea96926785ce10799b6a821ae6ac3b40bbf394fb7ef
(Finished) [  58] ---->

TLS| writeHandshake (encrypted)
TLS| HS.next_fragment ID13?
HS | next_fragment
TLS| HS.next_fragment returned nothing
TLS| sendHandshake
TLS| read: WrittenHS, Ctrl/Open, nothing
TLS| Read fragment at epoch index: 0 of length 53
TLS| StAE decrypt correct.
TLS| read Handshake fragment
HS | recv_fragment
HSL| parsed Finished
HSL| end of flight
HS | Process Client Finished
KS | ks_server_13_cf hashed_log = 5bc9b510f99d50fbcb28f8becf48cd1165657b9908f75d0ed4805da9e4a032e7
KS | resumption master secret:        68f09b089442afa2e522d28e3ed460a740899ab299b7ac75e472d1aef13b44b5
AEP| LowProvider: COERCE(K=98b8b7cfc131d55cfee8ee5780b860be99975029fe7ab0b7987e50648cb960e8)
HS | Sending ticket: 475920fb0adc032a6a94a4369ab390e25e37a7c4d336f2c57b3b9fe2590c5ac447e09d5ceff9351ee667b3a1039434ab566c6f24df450f9661d7f4df1837ba60e232f839e8e5bcfd3eb4981a
HSL| emit NewSessionTicket13
EPO| reader++ 1/1
TLS| readOne Complete
server returns server_complete clen=58 slen=0
TLS| writeHandshake (encrypted)
TLS| HS.next_fragment ID13?
HS | next_fragment
TLS| HS.next_fragment returned a fragment
TLS| sendHandshake
TLS| send Handshake fragment with index ID13
TLS| Encrypting with key 8a362535e4d336d336dc529a8e2653abc10734115812396d6edff562e3db90b1
TLS| Sending fragment of length 130
REC| record headers: 1703030082
TLS| writeHandshake (encrypted)
TLS| HS.next_fragment ID13?
HS | next_fragment
TLS| HS.next_fragment returned nothing
TLS| sendHandshake
TLS| read: WrittenHS, Open/Open, nothing
REC| WouldBlock
TLS| readOne ReadWouldBlock
server returns would_block clen=0 slen=135
<---- {Ticket}[ 135]
TLS| writeHandshake (encrypted)
TLS| HS.next_fragment ID13?
HS | next_fragment
TLS| HS.next_fragment returned nothing
TLS| sendHandshake
TLS| read: WrittenHS, Open/Open, nothing
TLS| Read fragment at epoch index: 1 of length 130
TLS| StAE decrypt correct.
TLS| read Handshake fragment
HS | recv_fragment
HSL| parsed NewSessionTicket13
HSL| end of flight
HS | Received ticket: 475920fb0adc032a6a94a4369ab390e25e37a7c4d336f2c57b3b9fe2590c5ac447e09d5ceff9351ee667b3a1039434ab566c6f24df450f9661d7f4df1837ba60e232f839e8e5bcfd3eb4981a
KS | ks_client_13_rms
KS | Recall RMS: 68f09b089442afa2e522d28e3ed460a740899ab299b7ac75e472d1aef13b44b5
AEP| LowProvider: COERCE(K=700ebb6e5ba40b30f560ab97a907f7aa192f4226a5a6030ef522e6b666f8c75c)

##### New session ticket received! #####
Host: localhost
Ticket:
475920fb0adc032a6a94a4369ab390e25e37a7c4d336f2c57b3b9fe2590c5ac4
47e09d5ceff9351ee667b3a1039434ab566c6f24df450f9661d7f4df1837ba60
e232f839e8e5bcfd3eb4981a
########################################
TLS| readOne ReadAgain
TLS| writeHandshake (encrypted)
TLS| HS.next_fragment ID13?
HS | next_fragment
TLS| HS.next_fragment returned nothing
TLS| sendHandshake
TLS| read: WrittenHS, Open/Open, nothing
REC| WouldBlock
TLS| readOne ReadWouldBlock
client returns clen=0 slen=135 status=would_block

TICKET-BASED RESUMPTION

server create
FFI| offering custom extension 001a
FFI| extension contents: ffff00050a0b0c0d0e
FFI| setting early data limit to ffffffff
FFI| Setting a new ticket callback.
FFI| Setting a new server negotiation callback.
FFI| Setting up certificate callbacks.
client create
FFI| offering custom extension 001a
FFI| extension contents: ffff00050a0b0c0d0e
FFI| setting early data limit to ffffffff
FFI| Setting a new ticket callback.
FFI| Setting a new server negotiation callback.
FFI| Setting up certificate callbacks.
TCK| Decrypting ticket cbec7f0e99005b00864d2434703c190354b4b8d5cc6843a42d9d33255d430a32de6631f90de9ce81c144c19dac7e1d3459bfd33647cee10603b46259cdbf5ee40fe9d774d3de67e6a48f56c9
TCK| Parsing ticket 030413035b170bace9e51aa5000000208c5435a1dc29c5607ec94d1431a780e29aa7080a927fd6803995cce22a95ce6e
TLS| writeHandshake (plaintext)
TLS| HS.next_fragment PlaintextID?
HS | next_fragment
HS | offering ClientHello 1.3
KS | ks_client_init 1.3
CDH| Keygen (initiator) on X255519
NGO| Offering a PSK compatible with 0-RTT
NGO| offering client extensions [ 001a supported_versions key_share server_name alpn extended_master_secret signature_algorithms supported_groups psk_key_exchange_modes early_data pre_shared_key ]
NGO| offering cipher suites ; TLS_CHACHA20_POLY1305_SHA256; TLS_AES_128_GCM_SHA256
HSL| emit ClientHello
KS | Loaded pre-shared key 475920fb0adc032a6a94a4369ab390e25e37a7c4d336f2c57b3b9fe2590c5ac447e09d5ceff9351ee667b3a1039434ab566c6f24df450f9661d7f4df1837ba60e232f839e8e5bcfd3eb4981a: 8c5435a1dc29c5607ec94d1431a780e29aa7080a927fd6803995cce22a95ce6e
KS | Early secret: 3bb4f232b1b50f639bcb5ce189d62fa126c157f3b716a58bf85c3b5eead5c0e8
KS | Binder key[res binder]: 2843721b308480839a759c9493730f536c2b161718767db486e6aebc379d699c
KS | Binder Finished key: 12d79c6b8f103b5daf5caef942cd08737117883b4b77cc6fb8cdd3f68c257e9f
HSL| emit Binders
HS | setting up 0RTT
KS | ks_client_13_ch log=5e88c0e0e9c5aed9b3345b7969cf153cccaed7d1e191fb860fda7e50bbc34eca
KS | Client early traffic secret:     38b055a11436098648b9c6cfac4ca730f0bc4fb97b743815b996a6ac118a0bc8
KS | Early exporter master secret:    81f36e5963b0add7beb5b6adc91459ea6690264f3d59fd985a2491db3f986e9f
KS | Client 0-RTT key:                ce85da356036c9c6e61068ce1aa9195501968e8d039d418b1151955ebe53d933, IV=1ac92b155cf06f3b690302b8
AEP| LowProvider: COERCE(K=ce85da356036c9c6e61068ce1aa9195501968e8d039d418b1151955ebe53d933)
HS | exporting a key
TLS| HS.next_fragment returned a fragment; next_keys (for all data)
TLS| sendHandshake
TLS| send Handshake fragment with index PlaintextID
TLS| Sending fragment of length 297
REC| record headers: 1603030129
EPO| writer++ -1/0
TLS| read: WrittenHS, Ctrl/Open, new writer: writable
client returns client_early_data clen=302 slen=0
early secret=81f36e5963b0add7beb5b6adc91459ea6690264f3d59fd985a2491db3f986e9f
ClientHello[ 302] ---->

TLS| writeHandshake (plaintext)
TLS| HS.next_fragment PlaintextID?
HS | next_fragment
TLS| HS.next_fragment returned nothing
TLS| sendHandshake
TLS| read: WrittenHS, Ctrl/Ctrl, nothing
TLS| Read fragment at epoch index: -1 of length 297
TLS| read Handshake fragment
HS | recv_fragment
HSL| parsed [ClientHello; Binders] -- end of flight 
HS | Processing ClientHello with 1 binder(s)
NGO| offered client extensions [ 001a supported_versions key_share server_name alpn extended_master_secret signature_algorithms supported_groups psk_key_exchange_modes early_data pre_shared_key ]
NGO| offered cipher suites ; TLS_CHACHA20_POLY1305_SHA256; TLS_AES_128_GCM_SHA256
NGO| offered versions 1.3
TCK| Decrypting ticket 475920fb0adc032a6a94a4369ab390e25e37a7c4d336f2c57b3b9fe2590c5ac447e09d5ceff9351ee667b3a1039434ab566c6f24df450f9661d7f4df1837ba60e232f839e8e5bcfd3eb4981a
TCK| Parsing ticket 030413035b170bace9e51aa50000002068f09b089442afa2e522d28e3ed460a740899ab299b7ac75e472d1aef13b44b5
NGO| Negotiated PSK_EDH key exchange
NGO| Negotiation callback to handle extra extensions and query for stateless retry.
NGO| Application data in cookie: none
@@@@ Nego callback for TLS 1.3 @@@@
Offered extensions:
003d001a0009ffff00050a0b0c0d0e0000000e000c0000096c6f63616c686f73
740010000800060568712d3130000d0006000408040403000a00040002001d
Transport parameters offered:
ffff00050a0b0c0d0e
No application cookie (fist connection).
Adding server transport parameters:
000102
@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
NGO| negotiated 1.3 TLS_CHACHA20_POLY1305_SHA256
HS | accepted TLS 1.3 psk #0
KS | ks_server_init
KS | Using negotiated PSK identity: 475920fb0adc032a6a94a4369ab390e25e37a7c4d336f2c57b3b9fe2590c5ac447e09d5ceff9351ee667b3a1039434ab566c6f24df450f9661d7f4df1837ba60e232f839e8e5bcfd3eb4981a
TCK| Decrypting ticket 475920fb0adc032a6a94a4369ab390e25e37a7c4d336f2c57b3b9fe2590c5ac447e09d5ceff9351ee667b3a1039434ab566c6f24df450f9661d7f4df1837ba60e232f839e8e5bcfd3eb4981a
TCK| Parsing ticket 030413035b170bace9e51aa50000002068f09b089442afa2e522d28e3ed460a740899ab299b7ac75e472d1aef13b44b5
KS | Ticket RMS: 68f09b089442afa2e522d28e3ed460a740899ab299b7ac75e472d1aef13b44b5
KS | Pre-shared key: 8c5435a1dc29c5607ec94d1431a780e29aa7080a927fd6803995cce22a95ce6e
KS | binder key:                      2843721b308480839a759c9493730f536c2b161718767db486e6aebc379d699c
KS | binder Finished key:             12d79c6b8f103b5daf5caef942cd08737117883b4b77cc6fb8cdd3f68c257e9f
KS | Computed early secret:           3bb4f232b1b50f639bcb5ce189d62fa126c157f3b716a58bf85c3b5eead5c0e8
KS | Handshake salt:                  a644d630c95893205e5e25512b1001914d81fcd618976c8a7d9c102146593960
CDH| Keygen (responder) on X255519
CDH| DH initiator on X255519
KS | DH shared secret: e1d60e02f04b21710b3146458b55a754ba4cfe5713b0d263490490b789f0d46f
KS | Handshake secret:                8d922ef9a1c035b5bf7443bca4dfdf5745bd38f5027111afe19584623d9befb9
NGO| processing client extensions [ 001a supported_versions key_share server_name alpn extended_master_secret signature_algorithms supported_groups psk_key_exchange_modes early_data pre_shared_key ]
NGO| including server extensions (SH + EE) [ supported_versions key_share alpn supported_groups early_data pre_shared_key ]
NGO| extra extensions from application callback: 001a 
HSL| emit ServerHello and hash
KS | ks_server_13_0rtt_key
KS | Client early traffic secret:     38b055a11436098648b9c6cfac4ca730f0bc4fb97b743815b996a6ac118a0bc8
KS | Early exporter master secret:    81f36e5963b0add7beb5b6adc91459ea6690264f3d59fd985a2491db3f986e9f
KS | Client 0-RTT key:                ce85da356036c9c6e61068ce1aa9195501968e8d039d418b1151955ebe53d933, IV=1ac92b155cf06f3b690302b8
AEP| LowProvider: COERCE(K=ce85da356036c9c6e61068ce1aa9195501968e8d039d418b1151955ebe53d933)
HS | exporting a key
HS | derive handshake keys
KS | ks_server_13_sh, hashed log = 926cfc48eb385aad725d8764ab06eb061504dc1c409a62de5e41799a0aa90db7
KS | handshake traffic secret[C]:     719b8e4636ba067e3db9e7577b6ac0f763415fa5c12cf4eb3a5c99285e1ae393
KS | handshake traffic secret[S]:     9247b027f4d97ef6181f0b139827f4501df4a7dcccc763002e1d625d3346be3c
KS | handshake key[C]:                b6210d2c67fc1642ea5c15b5cd4e4fca554b0227cdf729edc4a05a6ffacde803, IV=d7e937fadb00151e2759eff4
KS | handshake key[S]: 77a4186cc18699f097c44f39ba93da35d42768c79c81f033c5c5ec5ebb915bee, IV=eae630c797aebd9c916e0fbb
AEP| LowProvider: COERCE(K=77a4186cc18699f097c44f39ba93da35d42768c79c81f033c5c5ec5ebb915bee)
AEP| LowProvider: COERCE(K=b6210d2c67fc1642ea5c15b5cd4e4fca554b0227cdf729edc4a05a6ffacde803)
KS | finished key[C]:                 1cb5f4fc194717ad455f9d39a37b4861f9a0368001598bde766298d1c5e9b6b5
KS | finished key[S]:                 8d41c57e10ec833a0114f4b08871207ab1cf330b85f0b6ebb9bf924a85f2c542
KS | Application salt:                8845c63d16f1603c62e3e50a747725cbc7bd3ab9504d17d9f2662599ba6a681d
KS | Application secret:              c59aaec906015e4e53f603b693ad08060517b01306e58ec2668e167624df5d26
TLS| readOne ReadAgain
TLS| writeHandshake (plaintext)
TLS| HS.next_fragment PlaintextID?
HS | next_fragment
TLS| HS.next_fragment returned a fragment; next_keys (for handshake only skipping 0RTT
TLS| sendHandshake
TLS| send Handshake fragment with index PlaintextID
TLS| Sending fragment of length 96
REC| record headers: 1603030060
EPO| writer++ -1/0
EPO| writer++ -1/1
TLS| writeHandshake (encrypted)
TLS| HS.next_fragment ID13?
HS | next_fragment
HS | prepare Server Finished
HSL| emit EncryptedExtensions and hash
HSL| emit Finished and hash
KS | ks_server_13_sf hashed_log = b9cd2719655f7d1339cd4e8f25b20b729bea961ccda6175a7d4e7bc4d5a36cb4
KS | application traffic secret[C]:   5be4fffd699c86abff1f00d1d118cd5fb81fe85960bef6234c34bf0ac5d8bf01
KS | application traffic secret[S]:   4c753bc3ec49dd746b2bd75e0b8a9e11810cffe6e7e311b035c6b4ca7a5a5edb
KS | exporter master secret:          6d3bfb121b364e59e2a1dfe50594c06333023afe0872160e098e08e16b58c5df
KS | application key[C]:              c29fa7deea9737528963bfed7c8679e4e061c479fe1856ecffbade5131bb368b, IV=b078cbaf0b47d0fdd31018e2
KS | application key[S]:              57f927986fc4315023546c2d8ba4c7ab1c578db08074f45d6f65ee9216288cd6, IV=8e0d805ca3d7f415fbde9441
AEP| LowProvider: COERCE(K=57f927986fc4315023546c2d8ba4c7ab1c578db08074f45d6f65ee9216288cd6)
AEP| LowProvider: COERCE(K=c29fa7deea9737528963bfed7c8679e4e061c479fe1856ecffbade5131bb368b)
HS | exporting a key
EPO| reader++ 0/1
TLS| HS.next_fragment returned a fragment; next_keys (for all data)
TLS| sendHandshake
TLS| send Handshake fragment with index ID13
TLS| Encrypting with key 77a4186cc18699f097c44f39ba93da35d42768c79c81f033c5c5ec5ebb915bee
TLS| Sending fragment of length 90
REC| record headers: 170303005a
EPO| writer++ 0/2
TLS| read: WrittenHS, Ctrl/Open, new writer: writable
server returns server_accept_early_data clen=302 slen=196
early secret=81f36e5963b0add7beb5b6adc91459ea6690264f3d59fd985a2491db3f986e9f
secret=6d3bfb121b364e59e2a1dfe50594c06333023afe0872160e098e08e16b58c5df
<---- ServerHello;(EncryptedExtensions; Certificate; CertVerify; Finished)[ 196]

TLS| writeHandshake (encrypted)
TLS| HS.next_fragment ID13?
HS | next_fragment
TLS| HS.next_fragment returned nothing
TLS| sendHandshake
TLS| read: WrittenHS, Ctrl/Open, nothing
TLS| Read fragment at epoch index: -1 of length 96
TLS| read Handshake fragment
HS | recv_fragment
HSL| parsed ServerHello
HSL| end of flight
HS | client_ServerHello
NGO| processing server extensions [ supported_versions key_share pre_shared_key ]
NGO| negotiated 1.3 TLS_CHACHA20_POLY1305_SHA256
HS | Running TLS 1.3
KS | ks_client_13_sh hashed_log = 926cfc48eb385aad725d8764ab06eb061504dc1c409a62de5e41799a0aa90db7
KS | recallPSK early secret:          3bb4f232b1b50f639bcb5ce189d62fa126c157f3b716a58bf85c3b5eead5c0e8
KS | handshake salt:                  a644d630c95893205e5e25512b1001914d81fcd618976c8a7d9c102146593960
CDH| DH initiator on X255519
KS | DH shared secret: e1d60e02f04b21710b3146458b55a754ba4cfe5713b0d263490490b789f0d46f
KS | handshake secret:                8d922ef9a1c035b5bf7443bca4dfdf5745bd38f5027111afe19584623d9befb9
KS | handshake traffic secret[C]:     719b8e4636ba067e3db9e7577b6ac0f763415fa5c12cf4eb3a5c99285e1ae393
KS | handshake traffic secret[S]:     9247b027f4d97ef6181f0b139827f4501df4a7dcccc763002e1d625d3346be3c
KS | handshake key[C]:                b6210d2c67fc1642ea5c15b5cd4e4fca554b0227cdf729edc4a05a6ffacde803, IV=d7e937fadb00151e2759eff4
KS | handshake key[S]:                77a4186cc18699f097c44f39ba93da35d42768c79c81f033c5c5ec5ebb915bee, IV=eae630c797aebd9c916e0fbb
KS | finished key[C]: 1cb5f4fc194717ad455f9d39a37b4861f9a0368001598bde766298d1c5e9b6b5
KS | finished key[S]: 8d41c57e10ec833a0114f4b08871207ab1cf330b85f0b6ebb9bf924a85f2c542
KS | application salt:                8845c63d16f1603c62e3e50a747725cbc7bd3ab9504d17d9f2662599ba6a681d
KS | application secret:              c59aaec906015e4e53f603b693ad08060517b01306e58ec2668e167624df5d26
AEP| LowProvider: COERCE(K=b6210d2c67fc1642ea5c15b5cd4e4fca554b0227cdf729edc4a05a6ffacde803)
AEP| LowProvider: COERCE(K=77a4186cc18699f097c44f39ba93da35d42768c79c81f033c5c5ec5ebb915bee)
HS | 0RTT potentially accepted (wait for EE to confirm)
EPO| reader++ 0/0
EPO| reader++ 1/0
TLS| readOne ReadAgain
TLS| writeHandshake (encrypted)
TLS| HS.next_fragment ID13?
HS | next_fragment
TLS| HS.next_fragment returned nothing
TLS| sendHandshake
TLS| read: WrittenHS, Ctrl/Open, nothing
TLS| Read fragment at epoch index: 1 of length 90
TLS| StAE decrypt correct.
TLS| read Handshake fragment
HS | recv_fragment
HSL| parsed EncryptedExtensions
HSL| parsed Finished
HSL| end of flight
NGO| Nego.clientComplete_13
NGO| EE: alpn supported_groups early_data 001a 
NGO| Negotiation callback to process application extensions.
@@@@ Nego callback for TLS 1.3 @@@@
Offered extensions:
001b0010000800060568712d3130000a00040002001d001a0003000102
Transport parameters offered:
000102
No application cookie (fist connection).
Adding server transport parameters:
000102
@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
NGO| Certificate & signature 1.3 callback result: valid
KS | ks_client_13_sf hashed_log = b9cd2719655f7d1339cd4e8f25b20b729bea961ccda6175a7d4e7bc4d5a36cb4
KS | application traffic secret[C]:   5be4fffd699c86abff1f00d1d118cd5fb81fe85960bef6234c34bf0ac5d8bf01
KS | application traffic secret[S]:   4c753bc3ec49dd746b2bd75e0b8a9e11810cffe6e7e311b035c6b4ca7a5a5edb
KS | exporter master secret:          6d3bfb121b364e59e2a1dfe50594c06333023afe0872160e098e08e16b58c5df
KS | application key[C]:              c29fa7deea9737528963bfed7c8679e4e061c479fe1856ecffbade5131bb368b, IV=b078cbaf0b47d0fdd31018e2
KS | application key[S]:              57f927986fc4315023546c2d8ba4c7ab1c578db08074f45d6f65ee9216288cd6, IV=8e0d805ca3d7f415fbde9441
AEP| LowProvider: COERCE(K=c29fa7deea9737528963bfed7c8679e4e061c479fe1856ecffbade5131bb368b)
AEP| LowProvider: COERCE(K=57f927986fc4315023546c2d8ba4c7ab1c578db08074f45d6f65ee9216288cd6)
HS | exporting a key
HS | Early data accepted; emitting EOED.
HSL| emit EndOfEarlyData and hash
TLS| readOne ReadAgain
TLS| writeHandshake (encrypted)
TLS| HS.next_fragment ID13?
HS | next_fragment
TLS| HS.next_fragment returned a fragment; next_keys (for handshake only
TLS| sendHandshake
TLS| send Handshake fragment with index ID13
TLS| Encrypting with key ce85da356036c9c6e61068ce1aa9195501968e8d039d418b1151955ebe53d933
TLS| Sending fragment of length 21
REC| record headers: 1703030015
EPO| writer++ 1/1
TLS| writeHandshake (encrypted)
TLS| HS.next_fragment ID13?
HS | next_fragment
HSL| emit Finished and hash
KS | ks_client_13_cf hashed_log = 99f6994c099772fceee24caccc8195633b613ae7c6f34edfe4cef2fff4343957
KS | resumption master secret:        1cab802fd8a6ec0b00ff66ef9abdf09645d05aa6360f9d66b9dd38268ba6e501
EPO| reader++ 2/1
TLS| HS.next_fragment returned a fragment; next_keys (for all data); complete
TLS| sendHandshake
TLS| send Handshake fragment with index ID13
TLS| Encrypting with key b6210d2c67fc1642ea5c15b5cd4e4fca554b0227cdf729edc4a05a6ffacde803
TLS| Sending fragment of length 53
REC| record headers: 1703030035
EPO| writer++ 2/2
TLS| read: WrittenHS, Open/Open, new writer: complete
client returns client_complete_early_data clen=84 slen=196
secret=6d3bfb121b364e59e2a1dfe50594c06333023afe0872160e098e08e16b58c5df
(Finished) [  84] ---->

TLS| writeHandshake (encrypted)
TLS| HS.next_fragment ID13?
HS | next_fragment
TLS| HS.next_fragment returned nothing
TLS| sendHandshake
TLS| read: WrittenHS, Ctrl/Open, nothing
TLS| Read fragment at epoch index: 0 of length 21
TLS| StAE decrypt correct.
TLS| read Handshake fragment
HS | recv_fragment
HSL| parsed EndOfEarlyData
HSL| end of flight
HS | Process EOED (increment reader to HS key)
EPO| reader++ 1/2
TLS| readOne ReadAgain
TLS| writeHandshake (encrypted)
TLS| HS.next_fragment ID13?
HS | next_fragment
TLS| HS.next_fragment returned nothing
TLS| sendHandshake
TLS| read: WrittenHS, Ctrl/Open, nothing
TLS| Read fragment at epoch index: 1 of length 53
TLS| StAE decrypt correct.
TLS| read Handshake fragment
HS | recv_fragment
HSL| parsed Finished
HSL| end of flight
HS | Process Client Finished
KS | ks_server_13_cf hashed_log = 99f6994c099772fceee24caccc8195633b613ae7c6f34edfe4cef2fff4343957
KS | resumption master secret:        1cab802fd8a6ec0b00ff66ef9abdf09645d05aa6360f9d66b9dd38268ba6e501
HS | Sending ticket: e450e0ea3f91942956504eeedd4b23f7fcd5984669cc708ddada5e7d4ef46a844e6a3056e8828d9f7da220deda1a0463994ff789fe96ef3490e92e928acde10b9ed4b197e1c4e8a20402ac04
HSL| emit NewSessionTicket13
EPO| reader++ 2/2
TLS| readOne Complete
server returns clen=84 slen=0 status=server_complete
TLS| writeHandshake (encrypted)
TLS| HS.next_fragment ID13?
HS | next_fragment
TLS| HS.next_fragment returned a fragment
TLS| sendHandshake
TLS| send Handshake fragment with index ID13
TLS| Encrypting with key 57f927986fc4315023546c2d8ba4c7ab1c578db08074f45d6f65ee9216288cd6
TLS| Sending fragment of length 130
REC| record headers: 1703030082
TLS| writeHandshake (encrypted)
TLS| HS.next_fragment ID13?
HS | next_fragment
TLS| HS.next_fragment returned nothing
TLS| sendHandshake
TLS| read: WrittenHS, Open/Open, nothing
REC| WouldBlock
TLS| readOne ReadWouldBlock
server returns would_block clen=0 slen=135
<---- {Ticket}[ 135]
TLS| writeHandshake (encrypted)
TLS| HS.next_fragment ID13?
HS | next_fragment
TLS| HS.next_fragment returned nothing
TLS| sendHandshake
TLS| read: WrittenHS, Open/Open, nothing
TLS| Read fragment at epoch index: 2 of length 130
TLS| StAE decrypt correct.
TLS| read Handshake fragment
HS | recv_fragment
HSL| parsed NewSessionTicket13
HSL| end of flight
HS | Received ticket: e450e0ea3f91942956504eeedd4b23f7fcd5984669cc708ddada5e7d4ef46a844e6a3056e8828d9f7da220deda1a0463994ff789fe96ef3490e92e928acde10b9ed4b197e1c4e8a20402ac04
KS | ks_client_13_rms
KS | Recall RMS: 1cab802fd8a6ec0b00ff66ef9abdf09645d05aa6360f9d66b9dd38268ba6e501

##### New session ticket received! #####
Host: localhost
Ticket:
e450e0ea3f91942956504eeedd4b23f7fcd5984669cc708ddada5e7d4ef46a84
4e6a3056e8828d9f7da220deda1a0463994ff789fe96ef3490e92e928acde10b
9ed4b197e1c4e8a20402ac04
########################################
TLS| readOne ReadAgain
TLS| writeHandshake (encrypted)
TLS| HS.next_fragment ID13?
HS | next_fragment
TLS| HS.next_fragment returned nothing
TLS| sendHandshake
TLS| read: WrittenHS, Open/Open, nothing
REC| WouldBlock
TLS| readOne ReadWouldBlock
client returns clen=0 slen=135 status=would_block
Ok
./quic.exe hrr

STATELESS RETRY TEST

server create
FFI| offering custom extension 001a
FFI| extension contents: ffff00050a0b0c0d0e
FFI| setting early data limit to ffffffff
FFI| Setting a new ticket callback.
FFI| Setting a new server negotiation callback.
FFI| Setting up certificate callbacks.
client create
FFI| offering custom extension 001a
FFI| extension contents: ffff00050a0b0c0d0e
FFI| setting early data limit to ffffffff
FFI| Setting a new ticket callback.
FFI| Setting a new server negotiation callback.
FFI| Setting up certificate callbacks.
TLS| writeHandshake (plaintext)
TLS| HS.next_fragment PlaintextID?
HS | next_fragment
HS | offering ClientHello 1.3
KS | ks_client_init 1.3
CDH| Keygen (initiator) on X255519
NGO| No PSK or 0-RTT disabled
NGO| offering client extensions [ 001a supported_versions key_share server_name alpn extended_master_secret signature_algorithms supported_groups psk_key_exchange_modes ]
NGO| offering cipher suites ; TLS_CHACHA20_POLY1305_SHA256; TLS_AES_128_GCM_SHA256
HSL| emit ClientHello
TLS| HS.next_fragment returned a fragment
TLS| sendHandshake
TLS| send Handshake fragment with index PlaintextID
TLS| Sending fragment of length 170
REC| record headers: 16030300aa
TLS| writeHandshake (plaintext)
TLS| HS.next_fragment PlaintextID?
HS | next_fragment
TLS| HS.next_fragment returned nothing
TLS| sendHandshake
TLS| read: WrittenHS, Ctrl/Ctrl, nothing
REC| WouldBlock
TLS| readOne ReadWouldBlock
client returns would_block clen=175 slen=0
ClientHello[ 175] ---->

~~~~~~~~~ Client Hello Summary ~~~~~~~~~~~
~ SNI = localhost
~ ALPN = 00060568712d3130
~ Cookie = NULL
~ Extensions = 0079001a0009ffff00050a0b0c0d0e002b0003027f1c003300260024001d0020
8aa4f99e81332b17854f8caea8456c73412a396d1e018ce1a3ccbab349081f12
0000000e000c0000096c6f63616c686f73740010000800060568712d31300017
0000000d0006000408040403000a00040002001d002d0003020001
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
TLS| writeHandshake (plaintext)
TLS| HS.next_fragment PlaintextID?
HS | next_fragment
TLS| HS.next_fragment returned nothing
TLS| sendHandshake
TLS| read: WrittenHS, Ctrl/Ctrl, nothing
TLS| Read fragment at epoch index: -1 of length 170
TLS| read Handshake fragment
HS | recv_fragment
HSL| parsed [ClientHello] -- end of flight 
HS | Processing ClientHello
NGO| offered client extensions [ 001a supported_versions key_share server_name alpn extended_master_secret signature_algorithms supported_groups psk_key_exchange_modes ]
NGO| offered cipher suites ; TLS_CHACHA20_POLY1305_SHA256; TLS_AES_128_GCM_SHA256
NGO| offered versions 1.3
NGO| Negotiated Pure EDH key exchange
NGO| Negotiated ECDSA_SECP256R1_SHA256
NGO| Negotiation callback to handle extra extensions and query for stateless retry.
NGO| Application data in cookie: none
@@@@ Nego callback for TLS 1.3 @@@@
Offered extensions:
003d001a0009ffff00050a0b0c0d0e0000000e000c0000096c6f63616c686f73
740010000800060568712d3130000d0006000408040403000a00040002001d
Transport parameters offered:
ffff00050a0b0c0d0e
No application cookie (fist connection).
Adding server transport parameters:
000102
@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
AEP| LowProvider: COERCE(K=58ee9fe448434b7b324b092f2337f105a797e013707ad88402cdf1a9b69eb21d)
TCK| Encrypting cookie: 0000320200002e0303cf21ad74e59a6111be1d8c021e65b891c2a211167abb8c5e079e09e2c8a8339c001303000006002b00027f1c203e6099eba5fe00c27f999e7ee25b2b989b33ba67a8df054b9ca4f9e7d1d54452000b48656c6c6f20576f726c64
TCK| Encrypted cookie:  bc298456b01758f46769e4429047fd19a0dca454168531dc767dcc78fa652a1d60645fa583de85de0433a312e30f4fdfee73e012a951bc7dceb099fae89fd60a4f3470409a321041ca27ee967b5fd40935b0264f3f29026b8585582da1e3a9499884ebc65baddad574edad5d0ecfb202b98c2f2df9819c2bc33e79c41a33d1
HSL| emit HelloRetryRequest
TLS| readOne ReadAgain
TLS| writeHandshake (plaintext)
TLS| HS.next_fragment PlaintextID?
HS | next_fragment
TLS| HS.next_fragment returned a fragment
TLS| sendHandshake
TLS| send Handshake fragment with index PlaintextID
TLS| Sending fragment of length 183
REC| record headers: 16030300b7
TLS| writeHandshake (plaintext)
TLS| HS.next_fragment PlaintextID?
HS | next_fragment
TLS| HS.next_fragment returned nothing
TLS| sendHandshake
TLS| read: WrittenHS, Ctrl/Ctrl, nothing
REC| WouldBlock
TLS| readOne ReadWouldBlock
server returns server_stateless_retry clen=175 slen=188
<---- HRR[ 188]

server re-create
FFI| offering custom extension 001a
FFI| extension contents: ffff00050a0b0c0d0e
FFI| setting early data limit to ffffffff
FFI| Setting a new ticket callback.
FFI| Setting a new server negotiation callback.
FFI| Setting up certificate callbacks.
TLS| writeHandshake (plaintext)
TLS| HS.next_fragment PlaintextID?
HS | next_fragment
TLS| HS.next_fragment returned nothing
TLS| sendHandshake
TLS| read: WrittenHS, Ctrl/Ctrl, nothing
TLS| Read fragment at epoch index: -1 of length 183
TLS| read Handshake fragment
HS | recv_fragment
HSL| parsed HelloRetryRequest
HSL| end of flight
HSL| Replacing CH1 in transcript with fe0000203e6099eba5fe00c27f999e7ee25b2b989b33ba67a8df054b9ca4f9e7d1d54452
HSL| HRR bytes: 020000b30303cf21ad74e59a6111be1d8c021e65b891c2a211167abb8c5e079e09e2c8a8339c00130300008b002c0081007fbc298456b01758f46769e4429047fd19a0dca454168531dc767dcc78fa652a1d60645fa583de85de0433a312e30f4fdfee73e012a951bc7dceb099fae89fd60a4f3470409a321041ca27ee967b5fd40935b0264f3f29026b8585582da1e3a9499884ebc65baddad574edad5d0ecfb202b98c2f2df9819c2bc33e79c41a33d1002b00027f1c
HS | client_HelloRetryRequest
HS | Server did not specify a group in HRR, re-using the previous choice
NGO| Got HRR, extensions: [cookie supported_versions ]
HSL| emit ClientHello
TLS| readOne ReadAgain
TLS| writeHandshake (plaintext)
TLS| HS.next_fragment PlaintextID?
HS | next_fragment
TLS| HS.next_fragment returned a fragment
TLS| sendHandshake
TLS| send Handshake fragment with index PlaintextID
TLS| Sending fragment of length 303
REC| record headers: 160303012f
TLS| writeHandshake (plaintext)
TLS| HS.next_fragment PlaintextID?
HS | next_fragment
TLS| HS.next_fragment returned nothing
TLS| sendHandshake
TLS| read: WrittenHS, Ctrl/Ctrl, nothing
REC| WouldBlock
TLS| readOne ReadWouldBlock
client returns would_block clen=308 slen=188
ClientHello2[ 308] ---->

TCK| Decrypting cookie bc298456b01758f46769e4429047fd19a0dca454168531dc767dcc78fa652a1d60645fa583de85de0433a312e30f4fdfee73e012a951bc7dceb099fae89fd60a4f3470409a321041ca27ee967b5fd40935b0264f3f29026b8585582da1e3a9499884ebc65baddad574edad5d0ecfb202b98c2f2df9819c2bc33e79c41a33d1
TCK| Plain cookie: 0000320200002e0303cf21ad74e59a6111be1d8c021e65b891c2a211167abb8c5e079e09e2c8a8339c001303000006002b00027f1c203e6099eba5fe00c27f999e7ee25b2b989b33ba67a8df054b9ca4f9e7d1d54452000b48656c6c6f20576f726c64
~~~~~~~~~ Client Hello Summary ~~~~~~~~~~~
~ SNI = localhost
~ ALPN = 00060568712d3130
~ Cookie = 48656c6c6f20576f726c64
~ Extensions = 00fe002c0081007fbc298456b01758f46769e4429047fd19a0dca454168531dc
767dcc78fa652a1d60645fa583de85de0433a312e30f4fdfee73e012a951bc7d
ceb099fae89fd60a4f3470409a321041ca27ee967b5fd40935b0264f3f29026b
8585582da1e3a9499884ebc65baddad574edad5d0ecfb202b98c2f2df9819c2b
c33e79c41a33d1001a0009ffff00050a0b0c0d0e002b0003027f1c0033002600
24001d00208aa4f99e81332b17854f8caea8456c73412a396d1e018ce1a3ccba
b349081f120000000e000c0000096c6f63616c686f7374001000080006056871
2d313000170000000d0006000408040403000a00040002001d002d0003020001
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
TLS| writeHandshake (plaintext)
TLS| HS.next_fragment PlaintextID?
HS | next_fragment
TLS| HS.next_fragment returned nothing
TLS| sendHandshake
TLS| read: WrittenHS, Ctrl/Ctrl, nothing
TLS| Read fragment at epoch index: -1 of length 303
TLS| read Handshake fragment
HS | recv_fragment
HSL| parsed [ClientHello] -- end of flight 
HS | Processing ClientHello
NGO| offered client extensions [ cookie 001a supported_versions key_share server_name alpn extended_master_secret signature_algorithms supported_groups psk_key_exchange_modes ]
NGO| offered cipher suites ; TLS_CHACHA20_POLY1305_SHA256; TLS_AES_128_GCM_SHA256
NGO| offered versions 1.3
NGO| Negotiated Pure EDH key exchange
NGO| Negotiated ECDSA_SECP256R1_SHA256
TCK| Decrypting cookie bc298456b01758f46769e4429047fd19a0dca454168531dc767dcc78fa652a1d60645fa583de85de0433a312e30f4fdfee73e012a951bc7dceb099fae89fd60a4f3470409a321041ca27ee967b5fd40935b0264f3f29026b8585582da1e3a9499884ebc65baddad574edad5d0ecfb202b98c2f2df9819c2bc33e79c41a33d1
TCK| Plain cookie: 0000320200002e0303cf21ad74e59a6111be1d8c021e65b891c2a211167abb8c5e079e09e2c8a8339c001303000006002b00027f1c203e6099eba5fe00c27f999e7ee25b2b989b33ba67a8df054b9ca4f9e7d1d54452000b48656c6c6f20576f726c64
NGO| Loaded stateless retry cookie bc298456b01758f46769e4429047fd19a0dca454168531dc767dcc78fa652a1d60645fa583de85de0433a312e30f4fdfee73e012a951bc7dceb099fae89fd60a4f3470409a321041ca27ee967b5fd40935b0264f3f29026b8585582da1e3a9499884ebc65baddad574edad5d0ecfb202b98c2f2df9819c2bc33e79c41a33d1
NGO| Overwriting the transcript digest with CH1 hash 3e6099eba5fe00c27f999e7ee25b2b989b33ba67a8df054b9ca4f9e7d1d54452
HSL| Installing prefix to transcript: fe0000203e6099eba5fe00c27f999e7ee25b2b989b33ba67a8df054b9ca4f9e7d1d54452
HSL| HRR bytes: 020000b30303cf21ad74e59a6111be1d8c021e65b891c2a211167abb8c5e079e09e2c8a8339c00130300008b002c0081007fbc298456b01758f46769e4429047fd19a0dca454168531dc767dcc78fa652a1d60645fa583de85de0433a312e30f4fdfee73e012a951bc7dceb099fae89fd60a4f3470409a321041ca27ee967b5fd40935b0264f3f29026b8585582da1e3a9499884ebc65baddad574edad5d0ecfb202b98c2f2df9819c2bc33e79c41a33d1002b00027f1c
NGO| Negotiation callback to handle extra extensions and query for stateless retry.
NGO| Application data in cookie: 48656c6c6f20576f726c64
@@@@ Nego callback for TLS 1.3 @@@@
Offered extensions:
003d001a0009ffff00050a0b0c0d0e0000000e000c0000096c6f63616c686f73
740010000800060568712d3130000d0006000408040403000a00040002001d
Transport parameters offered:
ffff00050a0b0c0d0e
Stateless cookie found, application contents:
48656c6c6f20576f726c64
Adding server transport parameters:
000102
@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
NGO| negotiated 1.3 TLS_CHACHA20_POLY1305_SHA256
KS | ks_server_init
KS | No PSK selected.
KS | Computed early secret:           33ad0a1c607ec03b09e6cd9893680ce210adf300aa1f2660e1b22e10f170f92a
KS | Handshake salt:                  6f2615a108c702c5678f54fc9dbab69716c076189c48250cebeac3576c3611ba
CDH| Keygen (responder) on X255519
CDH| DH initiator on X255519
KS | DH shared secret: a7861ba4ef2ea064a54eda06722abb67a005e70d9e09ebac05122c303843bd00
KS | Handshake secret:                dfc527c00ee51f6ebe1413ba19ab695360a18863ded6a90a3bfefca9693269a8
NGO| processing client extensions [ cookie 001a supported_versions key_share server_name alpn extended_master_secret signature_algorithms supported_groups psk_key_exchange_modes ]
NGO| including server extensions (SH + EE) [ supported_versions key_share alpn supported_groups ]
NGO| extra extensions from application callback: 001a 
HSL| emit ServerHello and hash
HS | derive handshake keys
KS | ks_server_13_sh, hashed log = 0249acdc5ef1e4e0ac3eef0afd687cd66cb2fc469f6c141cd213838df88be2bf
KS | handshake traffic secret[C]:     d33310935a3e602bc423520f8f5fab353ba9a8894c87871fc3e43a83863777e2
KS | handshake traffic secret[S]:     4688d22bdf8652a868648000a8a2b12ccb1692bbcc2857b036a9c8fcff84db4f
KS | handshake key[C]:                17cac29bd743965bbbf5b528ef1d98d3873c0a711be87e36092fe5a906d091b3, IV=9abdcb717025884139996735
KS | handshake key[S]: bb52271f487a9254ab1cffe972ad2b310f5ee6c7be3c460f05781b29fb8f2060, IV=39be07318857913a0bcf5eb2
AEP| LowProvider: COERCE(K=bb52271f487a9254ab1cffe972ad2b310f5ee6c7be3c460f05781b29fb8f2060)
AEP| LowProvider: COERCE(K=17cac29bd743965bbbf5b528ef1d98d3873c0a711be87e36092fe5a906d091b3)
KS | finished key[C]:                 c6f05bccde23e15a82f3e7e0436be674af1eccfd94be43bf3e8a9af112bc1cc3
KS | finished key[S]:                 a822943b9abe0101de0669b5256ecaa49b79f8c59fa70ffa6a46588d0f20f7ab
KS | Application salt:                f7b32f6ac92dcfc6d842405fba38fd51efe905a5065bbb44d9def21299983358
KS | Application secret:              0a5aea86dd1b45175224f0a55b313314fd3b3d0118b496b02e62aa579bf6806d
TLS| readOne ReadAgain
TLS| writeHandshake (plaintext)
TLS| HS.next_fragment PlaintextID?
HS | next_fragment
TLS| HS.next_fragment returned a fragment; next_keys (for handshake only
TLS| sendHandshake
TLS| send Handshake fragment with index PlaintextID
TLS| Sending fragment of length 90
REC| record headers: 160303005a
EPO| writer++ -1/0
TLS| writeHandshake (encrypted)
TLS| HS.next_fragment ID13?
HS | next_fragment
HS | prepare Server Finished
HSL| emit EncryptedExtensions
HSL| emit Certificate13 and hash
======== TO BE SIGNED <0403>: (130 octets) ========
2020202020202020202020202020202020202020202020202020202020202020
2020202020202020202020202020202020202020202020202020202020202020
544c5320312e332c207365727665722043657274696669636174655665726966
7900f361555684cc67adf2b9b98d731cc3af0a878250b4339fb48d2f9031153c
83a0
===================================================
HSL| emit CertificateVerify and hash
HSL| emit Finished and hash
KS | ks_server_13_sf hashed_log = f166b8d58143fb0b81a64affdfe0e3c16cd9b185189f17626735749b8fabdcef
KS | application traffic secret[C]:   c6937bbdf77251e7b4feed5586777ceed75217ac100112fa082e5141cfe6a279
KS | application traffic secret[S]:   0733c41f40b611104224434c4d586e7f534e872ec33e69816be8044c4c61e2f6
KS | exporter master secret:          d4f461bf901332f43bff712808c6112e8baea06153f55c9a554499c3927aa2af
KS | application key[C]:              c5cdc4d530d8351d9fef32debde4db980fa2fa2e45d589e7d088e37b255aff99, IV=e89660b2298aad38ba538798
KS | application key[S]:              c8f482a9b4b16cb4fbe94b30368b1081d57336d6b04d39d2e7b42e56e46626f5, IV=3185c7c18155dd1f53a890ce
AEP| LowProvider: COERCE(K=c8f482a9b4b16cb4fbe94b30368b1081d57336d6b04d39d2e7b42e56e46626f5)
AEP| LowProvider: COERCE(K=c5cdc4d530d8351d9fef32debde4db980fa2fa2e45d589e7d088e37b255aff99)
HS | exporting a key
EPO| reader++ 0/0
TLS| HS.next_fragment returned a fragment; next_keys (for all data)
TLS| sendHandshake
TLS| send Handshake fragment with index ID13
TLS| Encrypting with key bb52271f487a9254ab1cffe972ad2b310f5ee6c7be3c460f05781b29fb8f2060
TLS| Sending fragment of length 735
REC| record headers: 17030302df
EPO| writer++ 0/1
TLS| read: WrittenHS, Ctrl/Open, new writer: writable
server returns server_accept clen=308 slen=835
secret=d4f461bf901332f43bff712808c6112e8baea06153f55c9a554499c3927aa2af
<---- ServerHello;(EncryptedExtensions; Certificate; CertVerify; Finished)[ 835]

TLS| writeHandshake (plaintext)
TLS| HS.next_fragment PlaintextID?
HS | next_fragment
TLS| HS.next_fragment returned nothing
TLS| sendHandshake
TLS| read: WrittenHS, Ctrl/Ctrl, nothing
TLS| Read fragment at epoch index: -1 of length 90
TLS| read Handshake fragment
HS | recv_fragment
HSL| parsed ServerHello
HSL| end of flight
HS | client_ServerHello
NGO| processing server extensions [ supported_versions key_share ]
NGO| negotiated 1.3 TLS_CHACHA20_POLY1305_SHA256
HS | Running TLS 1.3
KS | ks_client_13_sh hashed_log = 0249acdc5ef1e4e0ac3eef0afd687cd66cb2fc469f6c141cd213838df88be2bf
KS | no PSK negotiated. Early secret: 33ad0a1c607ec03b09e6cd9893680ce210adf300aa1f2660e1b22e10f170f92a
KS | handshake salt:                  6f2615a108c702c5678f54fc9dbab69716c076189c48250cebeac3576c3611ba
CDH| DH initiator on X255519
KS | DH shared secret: a7861ba4ef2ea064a54eda06722abb67a005e70d9e09ebac05122c303843bd00
KS | handshake secret:                dfc527c00ee51f6ebe1413ba19ab695360a18863ded6a90a3bfefca9693269a8
KS | handshake traffic secret[C]:     d33310935a3e602bc423520f8f5fab353ba9a8894c87871fc3e43a83863777e2
KS | handshake traffic secret[S]:     4688d22bdf8652a868648000a8a2b12ccb1692bbcc2857b036a9c8fcff84db4f
KS | handshake key[C]:                17cac29bd743965bbbf5b528ef1d98d3873c0a711be87e36092fe5a906d091b3, IV=9abdcb717025884139996735
KS | handshake key[S]:                bb52271f487a9254ab1cffe972ad2b310f5ee6c7be3c460f05781b29fb8f2060, IV=39be07318857913a0bcf5eb2
KS | finished key[C]: c6f05bccde23e15a82f3e7e0436be674af1eccfd94be43bf3e8a9af112bc1cc3
KS | finished key[S]: a822943b9abe0101de0669b5256ecaa49b79f8c59fa70ffa6a46588d0f20f7ab
KS | application salt:                f7b32f6ac92dcfc6d842405fba38fd51efe905a5065bbb44d9def21299983358
KS | application secret:              0a5aea86dd1b45175224f0a55b313314fd3b3d0118b496b02e62aa579bf6806d
AEP| LowProvider: COERCE(K=17cac29bd743965bbbf5b528ef1d98d3873c0a711be87e36092fe5a906d091b3)
AEP| LowProvider: COERCE(K=bb52271f487a9254ab1cffe972ad2b310f5ee6c7be3c460f05781b29fb8f2060)
EPO| reader++ 0/-1
TLS| readOne ReadAgain
TLS| writeHandshake (plaintext)
TLS| HS.next_fragment PlaintextID?
HS | next_fragment
TLS| HS.next_fragment returned nothing
TLS| sendHandshake
TLS| read: WrittenHS, Ctrl/Ctrl, nothing
TLS| Read fragment at epoch index: 0 of length 735
TLS| StAE decrypt correct.
TLS| read Handshake fragment
HS | recv_fragment
HSL| parsed EncryptedExtensions
HSL| parsed Certificate13
HSL| parsed CertificateVerify
HSL| parsed Finished
HSL| end of flight
NGO| Nego.clientComplete_13
NGO| EE: alpn supported_groups 001a 
NGO| Negotiation callback to process application extensions.
@@@@ Nego callback for TLS 1.3 @@@@
Offered extensions:
001b0010000800060568712d3130000a00040002001d001a0003000102
Transport parameters offered:
000102
No application cookie (fist connection).
Adding server transport parameters:
000102
@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
WARNING: chain validation failed, ignoring.
NGO| Certificate & signature 1.3 callback result: valid
KS | ks_client_13_sf hashed_log = f166b8d58143fb0b81a64affdfe0e3c16cd9b185189f17626735749b8fabdcef
KS | application traffic secret[C]:   c6937bbdf77251e7b4feed5586777ceed75217ac100112fa082e5141cfe6a279
KS | application traffic secret[S]:   0733c41f40b611104224434c4d586e7f534e872ec33e69816be8044c4c61e2f6
KS | exporter master secret:          d4f461bf901332f43bff712808c6112e8baea06153f55c9a554499c3927aa2af
KS | application key[C]:              c5cdc4d530d8351d9fef32debde4db980fa2fa2e45d589e7d088e37b255aff99, IV=e89660b2298aad38ba538798
KS | application key[S]:              c8f482a9b4b16cb4fbe94b30368b1081d57336d6b04d39d2e7b42e56e46626f5, IV=3185c7c18155dd1f53a890ce
AEP| LowProvider: COERCE(K=c5cdc4d530d8351d9fef32debde4db980fa2fa2e45d589e7d088e37b255aff99)
AEP| LowProvider: COERCE(K=c8f482a9b4b16cb4fbe94b30368b1081d57336d6b04d39d2e7b42e56e46626f5)
HS | exporting a key
HS | Early data rejected
EPO| writer++ 0/0
HSL| emit Finished and hash
KS | ks_client_13_cf hashed_log = 91f72a4e3250302348d4096c68b842060b3de3fc49e05c552029e443f2e2212d
KS | resumption master secret:        4971a696417ad56ae78d9803dbe207b373c332acdf4234c1849e708de3796298
EPO| reader++ 1/0
TLS| readOne ReadAgain
TLS| writeHandshake (encrypted)
TLS| HS.next_fragment ID13?
HS | next_fragment
TLS| HS.next_fragment returned a fragment; next_keys (for all data); complete
TLS| sendHandshake
TLS| send Handshake fragment with index ID13
TLS| Encrypting with key 17cac29bd743965bbbf5b528ef1d98d3873c0a711be87e36092fe5a906d091b3
TLS| Sending fragment of length 53
REC| record headers: 1703030035
EPO| writer++ 1/1
TLS| read: WrittenHS, Open/Open, new writer: complete
client returns client_complete clen=58 slen=835
secret=d4f461bf901332f43bff712808c6112e8baea06153f55c9a554499c3927aa2af
(Finished) [  58] ---->

TLS| writeHandshake (encrypted)
TLS| HS.next_fragment ID13?
HS | next_fragment
TLS| HS.next_fragment returned nothing
TLS| sendHandshake
TLS| read: WrittenHS, Ctrl/Open, nothing
TLS| Read fragment at epoch index: 0 of length 53
TLS| StAE decrypt correct.
TLS| read Handshake fragment
HS | recv_fragment
HSL| parsed Finished
HSL| end of flight
HS | Process Client Finished
KS | ks_server_13_cf hashed_log = 91f72a4e3250302348d4096c68b842060b3de3fc49e05c552029e443f2e2212d
KS | resumption master secret:        4971a696417ad56ae78d9803dbe207b373c332acdf4234c1849e708de3796298
HS | Sending ticket: 4678fff9b4b6582d364a53c2c82a1dc5e191f6af1e8db85e938458a499fa06753298ec293e24d6aa29e18c0c45e8b9a046364a031a918b563353262f9a94d9cddfad44d23cbd1719a2dd4775
HSL| emit NewSessionTicket13
EPO| reader++ 1/1
TLS| readOne Complete
server returns server_complete clen=58 slen=0
TLS| writeHandshake (encrypted)
TLS| HS.next_fragment ID13?
HS | next_fragment
TLS| HS.next_fragment returned a fragment
TLS| sendHandshake
TLS| send Handshake fragment with index ID13
TLS| Encrypting with key c8f482a9b4b16cb4fbe94b30368b1081d57336d6b04d39d2e7b42e56e46626f5
TLS| Sending fragment of length 130
REC| record headers: 1703030082
TLS| writeHandshake (encrypted)
TLS| HS.next_fragment ID13?
HS | next_fragment
TLS| HS.next_fragment returned nothing
TLS| sendHandshake
TLS| read: WrittenHS, Open/Open, nothing
REC| WouldBlock
TLS| readOne ReadWouldBlock
server returns would_block clen=0 slen=135
<---- {Ticket}[ 135]
TLS| writeHandshake (encrypted)
TLS| HS.next_fragment ID13?
HS | next_fragment
TLS| HS.next_fragment returned nothing
TLS| sendHandshake
TLS| read: WrittenHS, Open/Open, nothing
TLS| Read fragment at epoch index: 1 of length 130
TLS| StAE decrypt correct.
TLS| read Handshake fragment
HS | recv_fragment
HSL| parsed NewSessionTicket13
HSL| end of flight
HS | Received ticket: 4678fff9b4b6582d364a53c2c82a1dc5e191f6af1e8db85e938458a499fa06753298ec293e24d6aa29e18c0c45e8b9a046364a031a918b563353262f9a94d9cddfad44d23cbd1719a2dd4775
KS | ks_client_13_rms
KS | Recall RMS: 4971a696417ad56ae78d9803dbe207b373c332acdf4234c1849e708de3796298
AEP| LowProvider: COERCE(K=9daf86c2868eb12b88d974cc3e5b8cf53470d6e91406f243833d044925bd8a26)

##### New session ticket received! #####
Host: localhost
Ticket:
4678fff9b4b6582d364a53c2c82a1dc5e191f6af1e8db85e938458a499fa0675
3298ec293e24d6aa29e18c0c45e8b9a046364a031a918b563353262f9a94d9cd
dfad44d23cbd1719a2dd4775
########################################
TLS| readOne ReadAgain
TLS| writeHandshake (encrypted)
TLS| HS.next_fragment ID13?
HS | next_fragment
TLS| HS.next_fragment returned nothing
TLS| sendHandshake
TLS| read: WrittenHS, Open/Open, nothing
REC| WouldBlock
TLS| readOne ReadWouldBlock
client returns clen=0 slen=135 status=would_block
Ok
make[1]: Leaving directory '/cygdrive/c/build/agent1/_work/13/s/mitls-fstar/apps/quicMinusNet'
make[1]: Entering directory '/cygdrive/c/build/agent1/_work/13/s/mitls-fstar/src/tls'
C:/build/agent1/_work/13/s/FStar/bin/fstar.exe --cache_dir cache/Kremlin --cache_checked_modules --print_z3_statistics --use_hints --query_stats --cache_dir cache/Kremlin --odir extract/Kremlin --extract '* -DHDB -LowCProvider -FFICallbacks -BufferBytes' --dep full --include C:/build/agent1/_work/13/s/FStar/contrib/CoreCrypto/fst/ --include C:/build/agent1/_work/13/s/hacl-star/secure_api --include C:/build/agent1/_work/13/s/hacl-star/secure_api/utils --include C:/build/agent1/_work/13/s/hacl-star/secure_api/concrete_specializations --include C:/build/agent1/_work/13/s/hacl-star/secure_api/LowCProvider/fst --include C:/build/agent1/_work/13/s/hacl-star/code/curve25519/api --include C:/build/agent1/_work/13/s/hacl-star/code/lib --include C:/build/agent1/_work/13/s/kremlin/include --include C:/build/agent1/_work/13/s/kremlin/kremlib --include ../../libs/ffi --include ../../src/lowparse --include C:/build/agent1/_work/13/s/hacl-star/providers/multiplexer --include ../../src/tls/concrete-flags --include ../../src/tls/concrete-flags/Kremlin --include ./concrete-flags/Debug QUIC.fst Test.Main.fst > cache/Kremlin/.depend
sed -i.opt -e "s/cmx/cmo/g" -e "s/source/old/g" cache/Kremlin/.depend
make[1]: Leaving directory '/cygdrive/c/build/agent1/_work/13/s/mitls-fstar/src/tls'
make[1]: Entering directory '/cygdrive/c/build/agent1/_work/13/s/mitls-fstar/src/tls'
C:/build/agent1/_work/13/s/FStar/bin/fstar.exe --cache_dir cache/Model --cache_checked_modules --print_z3_statistics --use_hints --query_stats --cache_dir cache/Model --odir extract/Model --extract Nothing --dep full --include C:/build/agent1/_work/13/s/FStar/contrib/CoreCrypto/fst/ --include C:/build/agent1/_work/13/s/hacl-star/secure_api --include C:/build/agent1/_work/13/s/hacl-star/secure_api/utils --include C:/build/agent1/_work/13/s/hacl-star/secure_api/concrete_specializations --include C:/build/agent1/_work/13/s/hacl-star/secure_api/LowCProvider/fst --include C:/build/agent1/_work/13/s/hacl-star/code/curve25519/api --include C:/build/agent1/_work/13/s/hacl-star/code/lib --include C:/build/agent1/_work/13/s/kremlin/include --include C:/build/agent1/_work/13/s/kremlin/kremlib --include ../../libs/ffi --include ../../src/lowparse --include C:/build/agent1/_work/13/s/hacl-star/providers/multiplexer --include ../../src/tls/ideal-flags --include ../../src/tls/concrete-flags/generic --include ./concrete-flags/Debug QUIC.fst Test.Main.fst IV.fst HMAC.UFCMA.fst Token.UF1CMA.fst Pkg.Tree.fst > cache/Model/.depend
sed -i.opt -e "s/cmx/cmo/g" -e "s/source/old/g" cache/Model/.depend
make[1]: Leaving directory '/cygdrive/c/build/agent1/_work/13/s/mitls-fstar/src/tls'
make[1]: Entering directory '/cygdrive/c/build/agent1/_work/13/s/mitls-fstar/src/tls'
echo No verification-specific tests as of yet.
No verification-specific tests as of yet.
make[1]: Leaving directory '/cygdrive/c/build/agent1/_work/13/s/mitls-fstar/src/tls'
make[1]: Entering directory '/cygdrive/c/build/agent1/_work/13/s/mitls-fstar/src/tls'
C:/build/agent1/_work/13/s/FStar/bin/fstar.exe --cache_dir cache/OCaml --cache_checked_modules --print_z3_statistics --use_hints --query_stats --cache_dir cache/OCaml --odir extract/OCaml --extract '* -Prims -FStar +FStar.Test +FStar.Kremlin.Endianness -CoreCrypto -CryptoTypes -EverCrypt.Bytes -EverCrypt -DHDB -LowCProvider -HaclProvider -FFICallbacks -Crypto.AEAD -Crypto.Symmetric -Crypto.Plain -Spec.Loops -Buffer.Utils -C +C.Loops -LowParse.SLow.Tac -BufferBytes' --dep full --include C:/build/agent1/_work/13/s/FStar/contrib/CoreCrypto/fst/ --include C:/build/agent1/_work/13/s/hacl-star/secure_api --include C:/build/agent1/_work/13/s/hacl-star/secure_api/utils --include C:/build/agent1/_work/13/s/hacl-star/secure_api/concrete_specializations --include C:/build/agent1/_work/13/s/hacl-star/secure_api/LowCProvider/fst --include C:/build/agent1/_work/13/s/hacl-star/code/curve25519/api --include C:/build/agent1/_work/13/s/hacl-star/code/lib --include C:/build/agent1/_work/13/s/kremlin/include --include C:/build/agent1/_work/13/s/kremlin/kremlib --include ../../libs/ffi --include ../../src/lowparse --include C:/build/agent1/_work/13/s/hacl-star/providers/multiplexer --include ../../src/tls/concrete-flags --include ../../src/tls/concrete-flags/OCaml --include ./concrete-flags/Debug QUIC.fst Test.Main.fst > cache/OCaml/.depend
sed -i.opt -e "s/cmx/cmo/g" -e "s/source/old/g" cache/OCaml/.depend
make[1]: Leaving directory '/cygdrive/c/build/agent1/_work/13/s/mitls-fstar/src/tls'
EVEREST_WINDOWS=1 make -C extract/Kremlin-Internal-Test test
EVEREST_WINDOWS=1 make -C extract/Kremlin-Library test
make[2]: Nothing to be done for 'test'.
make[2]: 'test' is up to date.
make[1]: Entering directory '/cygdrive/c/build/agent1/_work/13/s/mitls-fstar/src/tls'
OCAMLPATH="C:/build/agent1/_work/13/s/FStar/bin" ocamlfind opt -g -I C:/build/agent1/_work/13/s/FStar/ulib/ml -I extract/OCaml -I C:/build/agent1/_work/13/s/MLCrypto -I ../../libs/ffi -I C:/build/agent1/_work/13/s/hacl-star/secure_api/LowCProvider -I C:/build/agent1/_work/13/s/hacl-star/secure_api/out/runtime_switch/ -I C:/build/agent1/_work/13/s/kremlin/_build/kremlib -I test -I extract/mlstubs -I C:/build/agent1/_work/13/s/hacl-star/providers/multiplexer/ml -I . -package fstarlib,zarith,ctypes,ctypes.foreign -cclib -L../pki -cclib -lmipki \
-cclib -LC:/build/agent1/_work/13/s/hacl-star/providers/out -cclib -levercrypt -linkall \
-linkpkg -g extract/OCaml/BufferBytes.cmx extract/OCaml/Crypto_AEAD_Main.cmx C:/build/agent1/_work/13/s/kremlin/_build/kremlib/C.cmx C:/build/agent1/_work/13/s/MLCrypto/CoreCrypto.cmxa C:/build/agent1/_work/13/s/hacl-star/secure_api/out/runtime_switch/LowC.cmxa ../../libs/ffi/FFICallbacks.cmxa C:/build/agent1/_work/13/s/hacl-star/providers/out/evercrypt.cmxa extract/OCaml/Hashing_Spec.cmx extract/OCaml/Flags.cmx extract/OCaml/TLSError.cmx extract/OCaml/Mem.cmx extract/OCaml/Hashing_OpenSSL.cmx extract/OCaml/Hashing.cmx extract/OCaml/LowParse_Bytes32.cmx extract/OCaml/LowParse_Bytes.cmx extract/OCaml/LowParse_Spec_Base.cmx extract/OCaml/LowParse_Spec_Combinators.cmx extract/OCaml/LowParse_SLow_Base.cmx extract/OCaml/LowParse_SLow_Combinators.cmx extract/OCaml/LowParse_Spec_Enum.cmx extract/OCaml/LowParse_SLow_Enum.cmx extract/OCaml/LowParse_Spec_Sum.cmx extract/OCaml/LowParse_SLow_Sum.cmx extract/OCaml/LowParse_Math.cmx extract/OCaml/FStar_Kremlin_Endianness.cmx extract/OCaml/LowParse_BigEndian.cmx extract/OCaml/LowParse_BigEndianImpl.cmx extract/OCaml/LowParse_Spec_FLData.cmx extract/OCaml/LowParse_SLow_FLData.cmx extract/OCaml/LowParse_Spec_VLData.cmx extract/OCaml/LowParse_SLow_VLData.cmx extract/OCaml/LowParse_Spec_Bytes.cmx extract/OCaml/LowParse_SLow_Bytes.cmx extract/OCaml/LowParse_Spec_List.cmx extract/OCaml/LowParse_Spec_Array.cmx extract/OCaml/C_Loops.cmx extract/OCaml/LowParse_SLow_List.cmx extract/OCaml/LowParse_SLow_Array.cmx extract/OCaml/LowParse_Spec_Int_Aux.cmx extract/OCaml/LowParse_Spec_Int.cmx extract/OCaml/LowParse_Spec_Int_Unique.cmx extract/OCaml/LowParse_SLow_Int_Aux.cmx extract/OCaml/LowParse_SLow_Int.cmx extract/OCaml/LowParse_SLow.cmx extract/OCaml/Format_NamedGroup.cmx extract/OCaml/Format_Constants.cmx extract/OCaml/Format_UncompressedPointRepresentation.cmx extract/OCaml/Format_KeyShareEntry.cmx extract/OCaml/Format_ECCurveType.cmx extract/OCaml/TLS_Curve25519.cmx extract/OCaml/Parse.cmx extract/OCaml/ECGroup.cmx extract/OCaml/DHGroup.cmx extract/OCaml/DebugFlags.cmx extract/OCaml/Format_NamedGroupList.cmx extract/OCaml/CommonDH.cmx extract/OCaml/LowParseWrappers.cmx extract/OCaml/QD_TLS_protocolVersion.cmx extract/OCaml/TLSConstants.cmx extract/OCaml/PKI.cmx extract/OCaml/Nonce.cmx extract/OCaml/RSAKey.cmx extract/OCaml/PMS.cmx extract/OCaml/List_Helpers.cmx extract/OCaml/PSK.cmx extract/OCaml/Extensions.cmx extract/OCaml/Cert.cmx extract/OCaml/TLSInfoFlags.cmx extract/OCaml/TLSInfo.cmx extract/OCaml/Crypto_Indexing.cmx extract/OCaml/Flag.cmx extract/OCaml/Specializations_Providers_AEAD.cmx extract/OCaml/AEADOpenssl.cmx extract/OCaml/AEADProvider.cmx extract/OCaml/Range.cmx extract/OCaml/Hashing_CRF.cmx extract/OCaml/HandshakeMessages.cmx extract/OCaml/HandshakeLog.cmx extract/OCaml/HMAC.cmx extract/OCaml/Old_HMAC_UFCMA.cmx extract/OCaml/Test_BufferBytes.cmx extract/OCaml/TLSPRF.cmx extract/OCaml/DataStream.cmx extract/OCaml/Alert.cmx extract/OCaml/Content.cmx extract/OCaml/StreamPlain.cmx extract/OCaml/StreamAE.cmx extract/OCaml/StatefulPlain.cmx extract/OCaml/LHAEPlain.cmx extract/OCaml/AEAD_GCM.cmx extract/OCaml/StatefulLHAE.cmx extract/OCaml/StAE.cmx extract/OCaml/Ticket.cmx extract/OCaml/Old_HKDF.cmx extract/OCaml/Old_KeySchedule.cmx extract/OCaml/FStar_Test.cmx extract/OCaml/Test_CommonDH.cmx extract/OCaml/Negotiation.cmx extract/OCaml/Old_Epochs.cmx extract/OCaml/Old_Handshake.cmx extract/OCaml/Transport.cmx extract/OCaml/Record.cmx extract/OCaml/Connection.cmx extract/OCaml/StreamDeltas.cmx extract/OCaml/TLS.cmx extract/OCaml/FFI.cmx extract/OCaml/QUIC.cmx extract/OCaml/Test_StAE.cmx extract/OCaml/Test_TLSConstants.cmx extract/OCaml/Test_Handshake.cmx extract/OCaml/Test_AEAD.cmx extract/OCaml/Test_Main.cmx extract/OCaml/FFIRegister.cmx C:/build/agent1/_work/13/s/kremlin/kremlib/out/libkremlib.a -o mitls.exe -thread
make[1]: Leaving directory '/cygdrive/c/build/agent1/_work/13/s/mitls-fstar/src/tls'
make[1]: Entering directory '/cygdrive/c/build/agent1/_work/13/s/mitls-fstar/src/tls'
./mitls.exe
make[1]: Leaving directory '/cygdrive/c/build/agent1/_work/13/s/mitls-fstar/src/tls'
+ cd mitls-fstar/apps/cmitls
+ make test
./cmitls.exe google.com 443
cmitls.exe ===================
cmitls.exe calling FFI_mitls_init
cmitls.exe about to act as client or server
===============================================
Starting test client...
FFI| Setting up certificate callbacks.
FFI| Setting a new server negotiation callback.
TLS| writeHandshake (plaintext)
TLS| HS.next_fragment PlaintextID?
HS | next_fragment
HS | offering ClientHello 1.3
KS | ks_client_init 1.3
CDH| Keygen (initiator) on X255519
NGO| No PSK or 0-RTT disabled
NGO| offering client extensions [ supported_versions key_share server_name session_ticket extended_master_secret signature_algorithms ec_point_formats supported_groups psk_key_exchange_modes ]
NGO| offering cipher suites ; TLS_AES_128_GCM_SHA256; TLS_AES_256_GCM_SHA384; TLS_CHACHA20_POLY1305_SHA256; TLS_ECDHE_ECDSA_WITH_AES_128_GCM_SHA256; TLS_ECDHE_RSA_WITH_AES_128_GCM_SHA256; TLS_DHE_RSA_WITH_AES_128_GCM_SHA256; TLS_ECDHE_ECDSA_WITH_AES_256_GCM_SHA384; TLS_ECDHE_RSA_WITH_AES_256_GCM_SHA384; TLS_DHE_RSA_WITH_AES_256_GCM_SHA384; TLS_ECDHE_ECDSA_WITH_CHACHA20_POLY1305_SHA256; TLS_ECDHE_RSA_WITH_CHACHA20_POLY1305_SHA256; TLS_DHE_RSA_WITH_CHACHA20_POLY1305_SHA256
HSL| emit ClientHello
TLS| HS.next_fragment returned a fragment
TLS| sendHandshake
TLS| send Handshake fragment with index PlaintextID
TLS| Sending fragment of length 208
REC| record headers: 16030300d0
TLS| writeHandshake (plaintext)
TLS| HS.next_fragment PlaintextID?
HS | next_fragment
TLS| HS.next_fragment returned nothing
TLS| sendHandshake
TLS| read: WrittenHS, Ctrl/Ctrl, nothing
TLS| Read fragment at epoch index: -1 of length 58
TLS| read Handshake fragment
HS | recv_fragment
HSL| parsed ServerHello
HSL| end of flight
HS | client_ServerHello
NGO| processing server extensions [ extended_master_secret session_ticket ec_point_formats ]
NGO| negotiated 1.2 TLS_ECDHE_ECDSA_WITH_AES_128_GCM_SHA256
HS | Running classic TLS
HS | Offered SID= Server SID=
HS | recv_fragment
HSL| more bytes required
TLS| readOne ReadAgain
TLS| writeHandshake (plaintext)
TLS| HS.next_fragment PlaintextID?
HS | next_fragment
TLS| HS.next_fragment returned nothing
TLS| sendHandshake
TLS| read: WrittenHS, Ctrl/Ctrl, nothing
TLS| Read fragment at epoch index: -1 of length 3072
TLS| read Handshake fragment
HS | recv_fragment
HSL| parsed Certificate
HSL| more bytes required
TLS| readOne ReadAgain
TLS| writeHandshake (plaintext)
TLS| HS.next_fragment PlaintextID?
HS | next_fragment
TLS| HS.next_fragment returned nothing
TLS| sendHandshake
TLS| read: WrittenHS, Ctrl/Ctrl, nothing
TLS| Read fragment at epoch index: -1 of length 115
TLS| read Handshake fragment
HS | recv_fragment
HSL| parsed ServerKeyExchange
HSL| more bytes required
TLS| readOne ReadAgain
TLS| writeHandshake (plaintext)
TLS| HS.next_fragment PlaintextID?
HS | next_fragment
TLS| HS.next_fragment returned nothing
TLS| sendHandshake
TLS| read: WrittenHS, Ctrl/Ctrl, nothing
TLS| Read fragment at epoch index: -1 of length 4
TLS| read Handshake fragment
HS | recv_fragment
HSL| parsed ServerHelloDone
HSL| end of flight
HS | processing ...ServerHelloDone
NGO| ServerKeyExchange signature: Valid
CDH| Keygen (responder) on X255519
CDH| DH initiator on X255519
KS | Share: c76a5abbb3c7066c30d7e05d75c6c11c8ce2b399b975b67fbc98a26035c9d44e
KS | Share: 2cbb5deedf70830b57a1aef7db7635f544c333660bad7d414deadb57ffb5900b
KS | PMS: 6c36647d251e452677ed33cec6739e503473725400100b8b5968f923ba62986e
HSL| emit ClientKeyExchange and hash
KS | ks_client_12_set_session_hash hashed_log = 26a472b8f9f4f06f39d09565c89debea5b56dfc5cc2b4a822a656fcf4f08678a
KS | extended master secret:936696ed6d0a5a1b5987ec9baa37f7f759e6a7cfd6670c10cdc562e3694c30d5e29f30c56c86e0b28a2694d87362663c
KS | ks_12_record_key
KS | keystring (CK, CIV, SK, SIV) = f512efc37a820b804b038ae709d8682abbebd9409d8c4aa38f8be8096bb1d23f277affab4fd06c2e
AEP| LowProvider: COERCE(K=f512efc37a820b804b038ae709d8682a)
AEP| LowProvider: COERCE(K=bbebd9409d8c4aa38f8be8096bb1d23f)
HS | digest is 26a472b8f9f4f06f39d09565c89debea5b56dfc5cc2b4a822a656fcf4f08678a
TLS| readOne ReadAgain
TLS| writeHandshake (plaintext)
TLS| HS.next_fragment PlaintextID?
HS | next_fragment
TLS| HS.next_fragment returned a fragment; CCS; next_keys (for handshake only
TLS| sendHandshake
TLS| send Handshake fragment with index PlaintextID
TLS| Sending fragment of length 37
REC| record headers: 1603030025
TLS| send CCS fragment with index PlaintextID
TLS| Sending fragment of length 1
REC| record headers: 1403030001
EPO| writer++ -1/0
TLS| writeHandshake (encrypted)
TLS| HS.next_fragment ID12?
HS | next_fragment
TLS| HS.next_fragment returned a fragment
TLS| sendHandshake
TLS| send Handshake fragment with index ID12
TLS| Sending fragment of length 40
REC| record headers: 1603030028
TLS| writeHandshake (encrypted)
TLS| HS.next_fragment ID12?
HS | next_fragment
TLS| HS.next_fragment returned nothing
TLS| sendHandshake
TLS| read: WrittenHS, Ctrl/Ctrl, new writer: handshake-only
TLS| ignore handshake-specifc key change; calling read again
TLS| writeHandshake (encrypted)
TLS| HS.next_fragment ID12?
HS | next_fragment
TLS| HS.next_fragment returned nothing
TLS| sendHandshake
TLS| read: WrittenHS, Ctrl/Ctrl, nothing
TLS| Read fragment at epoch index: -1 of length 228
TLS| read Handshake fragment
HS | recv_fragment
HSL| parsed NewSessionTicket
HSL| more bytes required
TLS| readOne ReadAgain
TLS| writeHandshake (encrypted)
TLS| HS.next_fragment ID12?
HS | next_fragment
TLS| HS.next_fragment returned nothing
TLS| sendHandshake
TLS| read: WrittenHS, Ctrl/Ctrl, nothing
TLS| Read fragment at epoch index: -1 of length 1
TLS| read CCS fragment
HS | recv_ccs
HS | Processing server CCS (full handshake). Ticket: 009c63c8430e3505522f0e93cb360d72251d77666da34c4a5e6c7eeea76cb3cf22d957d16e1649ddaa95d191d36ad411b1f52ff683938d640cb1ae0692947fe3e8e28effffc3e07885f24346d36755ff09c36382bc49a41888da4c8de13123a1b4383ad9f12546da8ab1414025cc8241214e5efc0c2b35c2a4e3aa72eda89e6aaf3fa025c7b8d29c985a7373fb6017cf236a732f68ed35ca56714baaef8a19801731b818187c21f7c7f586bda908d14b98bdee1a69026effb3df5090e1b3858b849f6a8fac4a5563ba9ac345492037f3850ea73a097191355ba5
EPO| reader++ 0/0
TLS| readOne ReadAgainFinishing
TLS| writeHandshake (encrypted)
TLS| HS.next_fragment ID12?
HS | next_fragment
TLS| HS.next_fragment returned nothing
TLS| sendHandshake
TLS| read: WrittenHS, Ctrl/Ctrl, nothing
TLS| Read fragment at epoch index: 0 of length 40
TLS| StAE decrypt correct.
TLS| read Handshake fragment
HS | recv_fragment
HSL| parsed Finished
HSL| end of flight
TLS| readOne Complete
FFI| Read returned Complete
Read OK, sending HTTP request...
TLS| writeHandshake (encrypted)
TLS| HS.next_fragment ID12?
HS | next_fragment
TLS| HS.next_fragment returned nothing
TLS| sendHandshake
TLS| send Data fragment with index ID12
TLS| Sending fragment of length 60
REC| record headers: 170303003c
TLS| writeHandshake (encrypted)
TLS| HS.next_fragment ID12?
HS | next_fragment
TLS| HS.next_fragment returned nothing
TLS| sendHandshake
TLS| read: WrittenHS, Open/Open, nothing
TLS| Read fragment at epoch index: 0 of length 620
TLS| StAE decrypt correct.
TLS| read Data fragment
TLS| readOne Read 596 bytes of data
Received 596 bytes of data:
Download speed: 1.#INF00kB/s
HTTP/1.1 301 Moved Permanently
Location: https://www.google.com/
Content-Type: text/html; charset=UTF-8
Date: Tue, 05 Jun 2018 22:16:19 GMT
Expires: Thu, 05 Jul 2018 22:16:19 GMT
Cache-Control: public, max-age=2592000
Server: gws
Content-Length: 220
X-XSS-Protection: 1; mode=block
X-Frame-Options: SAMEORIGIN
Alt-Svc: quic=":443"; ma=2592000; v="43,42,41,39,35"

<HTML><HEAD><meta http-equiv="content-type" content="text/html;charset=utf-8">
<TITLE>301 Moved</TITLE></HEAD><BODY>
<H1>301 Moved</H1>
The document has moved
<A HREF="https://www.google.com/">here</A>.
</BODY></HTML>

Closing connection, irrespective of the response
./cmitls.exe tls13.cloudflare.com 443
cmitls.exe ===================
cmitls.exe calling FFI_mitls_init
cmitls.exe about to act as client or server
===============================================
Starting test client...
FFI| Setting up certificate callbacks.
FFI| Setting a new server negotiation callback.
TLS| writeHandshake (plaintext)
TLS| HS.next_fragment PlaintextID?
HS | next_fragment
HS | offering ClientHello 1.3
KS | ks_client_init 1.3
CDH| Keygen (initiator) on X255519
NGO| No PSK or 0-RTT disabled
NGO| offering client extensions [ supported_versions key_share server_name session_ticket extended_master_secret signature_algorithms ec_point_formats supported_groups psk_key_exchange_modes ]
+ cd mitls-fstar/apps/quicMinusNet
NGO| offering cipher suites ; TLS_AES_128_GCM_SHA256; TLS_AES_256_GCM_SHA384; TLS_CHACHA20_POLY1305_SHA256; TLS_ECDHE_ECDSA_WITH_AES_128_GCM_SHA256; TLS_ECDHE_RSA_WITH_AES_128_GCM_SHA256; TLS_DHE_RSA_WITH_AES_128_GCM_SHA256; TLS_ECDHE_ECDSA_WITH_AES_256_GCM_SHA384; TLS_ECDHE_RSA_WITH_AES_256_GCM_SHA384; TLS_DHE_RSA_WITH_AES_256_GCM_SHA384; TLS_ECDHE_ECDSA_WITH_CHACHA20_POLY1305_SHA256; TLS_ECDHE_RSA_WITH_CHACHA20_POLY1305_SHA256; TLS_DHE_RSA_WITH_CHACHA20_POLY1305_SHA256
HSL| emit ClientHello
+ make test
TLS| HS.next_fragment returned a fragment
TLS| sendHandshake
TLS| send Handshake fragment with index PlaintextID
TLS| Sending fragment of length 218
REC| record headers: 16030300da
TLS| writeHandshake (plaintext)
TLS| HS.next_fragment PlaintextID?
HS | next_fragment
TLS| HS.next_fragment returned nothing
TLS| sendHandshake
TLS| read: WrittenHS, Ctrl/Ctrl, nothing
TLS| Read fragment at epoch index: -1 of length 90
TLS| read Handshake fragment
HS | recv_fragment
HSL| parsed ServerHello
HSL| end of flight
HS | client_ServerHello
NGO| processing server extensions [ key_share supported_versions ]
NGO| negotiated 1.3 TLS_AES_128_GCM_SHA256
HS | Running TLS 1.3
KS | ks_client_13_sh hashed_log = a83db269eab6c829b9f2733bfdae021d8e47951c6a689ed35c2afc2bca7c9959
KS | no PSK negotiated. Early secret: 33ad0a1c607ec03b09e6cd9893680ce210adf300aa1f2660e1b22e10f170f92a
KS | handshake salt:                  6f2615a108c702c5678f54fc9dbab69716c076189c48250cebeac3576c3611ba
CDH| DH initiator on X255519
KS | DH shared secret: cde4e7645f62478913ca33182aa3550d391bb3ebd3ab6b69c7e0f7a9e5b4d069
KS | handshake secret:                19acc61463ac92538119e7956c3e4b7ae4d43dcbbc886c2928bfc3d63ef93584
KS | handshake traffic secret[C]:     c558625dd05661439d5664f29805ac3bd79fa468b9539d369304e045cd5d6539
KS | handshake traffic secret[S]:     4dca68148dd6888a2bb2a9bd930979b003453e78f0a8c842bce92273641ac85f
KS | handshake key[C]:                7d83b8b9a3de4a2f7e4db5d0ebe320da, IV=6eee64dba07438c10e1739a9
KS | handshake key[S]:                01917351388a047c13fe5d88a731f1fb, IV=fd98f983e472f16d9172a521
KS | finished key[C]: 5da7120476e2ab17a9b3ddfa45be157ab976df27ff77e955aded801af65c6571
KS | finished key[S]: f388f78a42df4337c8e74cc77841fc3426e463b82dbc95d9015d5e54e9c15595
KS | application salt:                810616d9f4d81d9d9774e482e8aca5d71a5fc5df033b74bc44621748b98e65e2
KS | application secret:              7e8ea56f591d8f3a90029301a0be4f8623d449cb13713ae34b82a009acbf609a
AEP| LowProvider: COERCE(K=7d83b8b9a3de4a2f7e4db5d0ebe320da)
AEP| LowProvider: COERCE(K=01917351388a047c13fe5d88a731f1fb)
EPO| reader++ 0/-1
TLS| readOne ReadAgain
TLS| writeHandshake (plaintext)
TLS| HS.next_fragment PlaintextID?
HS | next_fragment
TLS| HS.next_fragment returned nothing
TLS| sendHandshake
TLS| read: WrittenHS, Ctrl/Ctrl, nothing
TLS| Read fragment at epoch index: 0 of length 1
TLS| Ignoring a CCS
TLS| Read fragment at epoch index: 0 of length 23
TLS| StAE decrypt correct.
TLS| read Handshake fragment
HS | recv_fragment
HSL| parsed EncryptedExtensions
HSL| more bytes required
TLS| readOne ReadAgain
TLS| writeHandshake (plaintext)
TLS| HS.next_fragment PlaintextID?
HS | next_fragment
TLS| HS.next_fragment returned nothing
TLS| sendHandshake
TLS| read: WrittenHS, Ctrl/Ctrl, nothing
TLS| Read fragment at epoch index: 0 of length 3244
TLS| StAE decrypt correct.
TLS| read Handshake fragment
HS | recv_fragment
HSL| parsed Certificate13
HSL| more bytes required
TLS| readOne ReadAgain
TLS| writeHandshake (plaintext)
TLS| HS.next_fragment PlaintextID?
HS | next_fragment
TLS| HS.next_fragment returned nothing
TLS| sendHandshake
TLS| read: WrittenHS, Ctrl/Ctrl, nothing
TLS| Read fragment at epoch index: 0 of length 96
TLS| StAE decrypt correct.
TLS| read Handshake fragment
HS | recv_fragment
HSL| parsed CertificateVerify
HSL| more bytes required
TLS| readOne ReadAgain
TLS| writeHandshake (plaintext)
TLS| HS.next_fragment PlaintextID?
HS | next_fragment
TLS| HS.next_fragment returned nothing
TLS| sendHandshake
TLS| read: WrittenHS, Ctrl/Ctrl, nothing
TLS| Read fragment at epoch index: 0 of length 53
TLS| StAE decrypt correct.
TLS| read Handshake fragment
HS | recv_fragment
HSL| parsed Finished
HSL| end of flight
NGO| Nego.clientComplete_13
NGO| EE: 
NGO| Negotiation callback to process application extensions.
@@@@ Nego callback for TLS 1.3 @@@@
Offered extensions:
0000
No application cookie (fist connection).
@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
NGO| Certificate & signature 1.3 callback result: valid
KS | ks_client_13_sf hashed_log = 2deb0be1d1f6b4438fd31280e89c84872a182b81f43880107b2f16d6b248df50
KS | application traffic secret[C]:   d83fe51dc3b91ad0411cc7e93c4cf3fff98c064c8c96c7160210abd39f1a25c2
KS | application traffic secret[S]:   3465e92e080fe9871e61ec56124ad1c5d79085c10176ac127f153b6744f031a4
KS | exporter master secret:          74887718fd3c05e500872009b69f4c1087d9919ef930d35fbcb43a93acf32760
KS | application key[C]:              3385601d042838207b44aa6b6686e86a, IV=0745e4fe2c8e3b500b73a219
KS | application key[S]:              70277892fc09ed2cd7ebbe912d16143d, IV=61eaeb2ed01cbbad0a8f3b3c
AEP| LowProvider: COERCE(K=3385601d042838207b44aa6b6686e86a)
AEP| LowProvider: COERCE(K=70277892fc09ed2cd7ebbe912d16143d)
HS | exporting a key
HS | Early data rejected
EPO| writer++ 0/0
HSL| emit Finished and hash
KS | ks_client_13_cf hashed_log = c7c9846057fab2719815645cab40462f4f2ceb31e47a64163db104d72915d13f
KS | resumption master secret:        283fcde4088b1aa5f15e159f93e6f193d10413aebc61163397aa037fb2747135
EPO| reader++ 1/0
TLS| readOne ReadAgain
TLS| writeHandshake (encrypted)
TLS| HS.next_fragment ID13?
HS | next_fragment
TLS| HS.next_fragment returned a fragment; next_keys (for all data); complete
TLS| sendHandshake
TLS| send Handshake fragment with index ID13
TLS| Encrypting with key 637c777bf26b6fc53001672bfed7ab76
TLS| Sending fragment of length 53
REC| record headers: 1703030035
EPO| writer++ 1/1
TLS| read: WrittenHS, Open/Open, new writer: complete
FFI| Read returned Complete
Read OK, sending HTTP request...
TLS| writeHandshake (encrypted)
TLS| HS.next_fragment ID13?
HS | next_fragment
TLS| HS.next_fragment returned nothing
TLS| sendHandshake
TLS| send Data fragment with index ID13
TLS| Encrypting with key 637c777bf26b6fc53001672bfed7ab76
TLS| Sending fragment of length 63
REC| record headers: 170303003f
TLS| writeHandshake (encrypted)
TLS| HS.next_fragment ID13?
HS | next_fragment
TLS| HS.next_fragment returned nothing
TLS| sendHandshake
TLS| read: WrittenHS, Open/Open, nothing
TLS| Read fragment at epoch index: 1 of length 239
TLS| StAE decrypt correct.
TLS| read Handshake fragment
HS | recv_fragment
HSL| parsed NewSessionTicket13
HSL| end of flight
HS | Received ticket: b2a43ec3ee926b1245efdf0ee7b106800d010c297d9679054cb20a20edc2db6c1f4090838e1e227e603f1d12092c1636b1cd6d8fbb0428ba2d8edde396379f68e6dc5a96c96a758bafdac64effd85a6ee98bd721df954d5509bf49269e62e8e4d5cce6a94d4ff346256868281ac3bdbd72a68b73b87d1128b51a5a649cbb83e3aad0d421883365d13313380960340539f19523c19b137e8b5c2506ea4168683d14d359431acf2a1c84234015f1db75448b1b8c349819e3e80312d6cb356ec380
KS | ks_client_13_rms
KS | Recall RMS: 283fcde4088b1aa5f15e159f93e6f193d10413aebc61163397aa037fb2747135
TLS| readOne ReadAgain
TLS| writeHandshake (encrypted)
TLS| HS.next_fragment ID13?
HS | next_fragment
TLS| HS.next_fragment returned nothing
TLS| sendHandshake
TLS| read: WrittenHS, Open/Open, nothing
TLS| Read fragment at epoch index: 1 of length 239
TLS| StAE decrypt correct.
TLS| read Handshake fragment
HS | recv_fragment
HSL| parsed NewSessionTicket13
HSL| end of flight
HS | Received ticket: b2a43ec3ee926b1245efdf0ee7b1068021d2c59b1f215e05fdd655fa61229496fff2a1fc6f18c3b2e097488e2679bbf037a02a6e46ad6ba28d323409bb39a7e5a7217516e9a8013a9e5730367e4c6146019170e8fc3d961220665a3d81b44868647298f0434f7878e27e5649da6fa6560e43c2aea9e218130bf0826a718383b8f24c8b84d38794234c6298aeddff4f307c7b97e28d72f854fa15e609632555ace77edff669af7d686b0b7704ba8bf570d96000c7d99f5a6b3840bd9f5e9e08c1
KS | ks_client_13_rms
KS | Recall RMS: 283fcde4088b1aa5f15e159f93e6f193d10413aebc61163397aa037fb2747135
TLS| readOne ReadAgain
TLS| writeHandshake (encrypted)
TLS| HS.next_fragment ID13?
HS | next_fragment
TLS| HS.next_fragment returned nothing
TLS| sendHandshake
TLS| read: WrittenHS, Open/Open, nothing
TLS| Read fragment at epoch index: 1 of length 1386
TLS| StAE decrypt correct.
TLS| read Data fragment
TLS| readOne Read 1369 bytes of data
Received 1369 bytes of data:
Download speed: 1.#INF00kB/s
HTTP/1.1 521 Origin Down
Date: Tue, 05 Jun 2018 22:16:19 GMT
Content-Type: text/html; charset=UTF-8
Transfer-Encoding: chunked
Connection: keep-alive
Set-Cookie: __cfduid=dd8abcb80d3859d934e3a5e7a951ecce01528236979; expires=Wed, 05-Jun-19 22:16:19 GMT; path=/; domain=.cloudflare.com; HttpOnly
Expires: Thu, 01 Jan 1970 00:00:01 GMT
Cache-Control: no-store, no-cache, must-revalidate, post-check=0, pre-check=0
Pragma: no-cache
X-Frame-Options: SAMEORIGIN
Set-Cookie: cf_use_ob=443; expires=Tue, 05-Jun-18 22:16:49 GMT; path=/
Set-Cookie: cf_ob_info=521:426600c2587e7a17:SEA; expires=Tue, 05-Jun-18 22:16:49 GMT; path=/
Strict-Transport-Security: max-age=15780000; includeSubDomains
Expect-CT: max-age=604800, report-uri="https://report-uri.cloudflare.com/cdn-cgi/beacon/expect-ct"
Server: cloudflare
CF-RAY: 426600c2587e7a17-SEA

11c8
<!DOCTYPE html>
<!--[if lt IE 7]> <html class="no-js ie6 oldie" lang="en-US"> <![endif]-->
<!--[if IE 7]>    <html class="no-js ie7 oldie" lang="en-US"> <![endif]-->
<!--[if IE 8]>    <html class="no-js ie8 oldie" lang="en-US"> <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en-US"> <!--<![endif]-->
<head>
<meta http-equiv="refresh" content="0">

<title>tls13.cloudflare.com | 521: Web server is down</title>
<meta charset="UTF-8" />
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8
Closing connection, irrespective of the response
./quic.exe
server create
FFI| offering custom extension 001a
FFI| extension contents: ffff00050a0b0c0d0e
FFI| setting early data limit to ffffffff
FFI| Setting a new ticket callback.
FFI| Setting a new server negotiation callback.
FFI| Setting up certificate callbacks.
client create
FFI| offering custom extension 001a
FFI| extension contents: ffff00050a0b0c0d0e
FFI| setting early data limit to ffffffff
FFI| Setting a new ticket callback.
FFI| Setting a new server negotiation callback.
FFI| Setting up certificate callbacks.
client call clen=8192 slen=   0
TLS| writeHandshake (plaintext)
TLS| HS.next_fragment PlaintextID?
HS | next_fragment
HS | offering ClientHello 1.3
KS | ks_client_init 1.3
CDH| Keygen (initiator) on X255519
NGO| No PSK or 0-RTT disabled
NGO| offering client extensions [ 001a supported_versions key_share server_name alpn extended_master_secret signature_algorithms supported_groups psk_key_exchange_modes ]
NGO| offering cipher suites ; TLS_CHACHA20_POLY1305_SHA256; TLS_AES_128_GCM_SHA256
HSL| emit ClientHello
TLS| HS.next_fragment returned a fragment
TLS| sendHandshake
TLS| send Handshake fragment with index PlaintextID
TLS| Sending fragment of length 170
REC| record headers: 16030300aa
TLS| writeHandshake (plaintext)
TLS| HS.next_fragment PlaintextID?
HS | next_fragment
TLS| HS.next_fragment returned nothing
TLS| sendHandshake
TLS| read: WrittenHS, Ctrl/Ctrl, nothing
REC| WouldBlock
TLS| readOne ReadWouldBlock
client done clen= 175 slen=   0 status=would_block
16030300aa010000a603035b170bb334abf38f4617ff830695ca3f43d474c229
f8cef94947780b3d3a0d980000041303130101000079001a0009ffff00050a0b
0c0d0e002b0003027f1c003300260024001d0020a65a22564917bbd7dd607834
b1b3ccc2507c5cad3a214a25f6d2d69afd8d86070000000e000c0000096c6f63
616c686f73740010000800060568712d313000170000000d0006000408040403
000a00040002001d002d0003020001
server call clen= 175 slen=8192
TLS| writeHandshake (plaintext)
TLS| HS.next_fragment PlaintextID?
HS | next_fragment
TLS| HS.next_fragment returned nothing
TLS| sendHandshake
TLS| read: WrittenHS, Ctrl/Ctrl, nothing
TLS| Read fragment at epoch index: -1 of length 170
TLS| read Handshake fragment
HS | recv_fragment
HSL| parsed [ClientHello] -- end of flight 
HS | Processing ClientHello
NGO| offered client extensions [ 001a supported_versions key_share server_name alpn extended_master_secret signature_algorithms supported_groups psk_key_exchange_modes ]
NGO| offered cipher suites ; TLS_CHACHA20_POLY1305_SHA256; TLS_AES_128_GCM_SHA256
NGO| offered versions 1.3
NGO| Negotiated Pure EDH key exchange
NGO| Negotiated ECDSA_SECP256R1_SHA256
NGO| Negotiation callback to handle extra extensions and query for stateless retry.
NGO| Application data in cookie: none
@@@@ Nego callback for TLS 1.3 @@@@
Offered extensions:
003d001a0009ffff00050a0b0c0d0e0000000e000c0000096c6f63616c686f73
740010000800060568712d3130000d0006000408040403000a00040002001d
Transport parameters offered:
ffff00050a0b0c0d0e
No application cookie (fist connection).
Adding server transport parameters:
000102
@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
NGO| negotiated 1.3 TLS_CHACHA20_POLY1305_SHA256
KS | ks_server_init
KS | No PSK selected.
KS | Computed early secret:           33ad0a1c607ec03b09e6cd9893680ce210adf300aa1f2660e1b22e10f170f92a
KS | Handshake salt:                  6f2615a108c702c5678f54fc9dbab69716c076189c48250cebeac3576c3611ba
CDH| Keygen (responder) on X255519
CDH| DH initiator on X255519
KS | DH shared secret: 409e21bc9267d2fb57f627c785434eb9fc20b0cbd0dd4c48e503fa3051a1cc19
KS | Handshake secret:                33747eb649cd5a157da48614406dc7dde201ba569ac63d132e75b5ca5f64b564
NGO| processing client extensions [ 001a supported_versions key_share server_name alpn extended_master_secret signature_algorithms supported_groups psk_key_exchange_modes ]
NGO| including server extensions (SH + EE) [ supported_versions key_share alpn supported_groups ]
NGO| extra extensions from application callback: 001a 
HSL| emit ServerHello and hash
HS | derive handshake keys
KS | ks_server_13_sh, hashed log = 18584843cae321c809be2f6643fef0ab1bfb2d73694b5f359d0d488fc4648f85
KS | handshake traffic secret[C]:     f7f9d2984884f0063018b17cdde2313a28fecee6331525cd90b6f7452ee5852f
KS | handshake traffic secret[S]:     9628830b2ddbb596d9c1ffac52c3087ba859454d8ef01435673667a04b5b7246
KS | handshake key[C]:                9f35e4655bb8544ea937eb7709c779451c5507554f1c56b16271accc27f15d16, IV=eb2016af7fb011712899232e
KS | handshake key[S]: c2755a3aae1a7897b1176dbb644bd04286edd125336166231977c0382c668c2a, IV=4e6f320c79fcf9b1409f1395
AEP| LowProvider: COERCE(K=c2755a3aae1a7897b1176dbb644bd04286edd125336166231977c0382c668c2a)
AEP| LowProvider: COERCE(K=9f35e4655bb8544ea937eb7709c779451c5507554f1c56b16271accc27f15d16)
KS | finished key[C]:                 fa65a4c68b6175d1bc2e114cef38bb2ef85697be6a407e867d83bc8c3dad1da4
KS | finished key[S]:                 90c71cd0e0bebd6f7fba56b662a5c861f8c6c4d8bf3d830b8ac7acccb147b154
KS | Application salt:                4d7802c917fc3dd25705d8ad7f3d0d04d0f07dd253eb9f2898e5427b62b4a397
KS | Application secret:              019996861b69e257f401ea1e5d78d02cb86d5563fe52c3faf9f64696109b9f70
TLS| readOne ReadAgain
TLS| writeHandshake (plaintext)
TLS| HS.next_fragment PlaintextID?
HS | next_fragment
TLS| HS.next_fragment returned a fragment; next_keys (for handshake only
TLS| sendHandshake
TLS| send Handshake fragment with index PlaintextID
TLS| Sending fragment of length 90
REC| record headers: 160303005a
EPO| writer++ -1/0
TLS| writeHandshake (encrypted)
TLS| HS.next_fragment ID13?
HS | next_fragment
HS | prepare Server Finished
HSL| emit EncryptedExtensions
HSL| emit Certificate13 and hash
======== TO BE SIGNED <0403>: (130 octets) ========
2020202020202020202020202020202020202020202020202020202020202020
2020202020202020202020202020202020202020202020202020202020202020
544c5320312e332c207365727665722043657274696669636174655665726966
7900f4cf4cc0cce41a620aeae3b212bcc06617ef3fe36bdba147381664190116
2685
===================================================
HSL| emit CertificateVerify and hash
HSL| emit Finished and hash
KS | ks_server_13_sf hashed_log = 4f053a5dc397c7b2c735e35c6f76e62065a6b0361c997cbc854af1ba90a9bf5c
KS | application traffic secret[C]:   17c5ad00a13de755a3e759d5e453ffba4f10edf51fa71d523e51d03f56206b68
KS | application traffic secret[S]:   291a976514ffa26d5093f1053eff47bf00bbf36aa610321696e928f780866ad1
KS | exporter master secret:          2a2342c1c9f9ffb3ee1cacea6bb2069fba2d121dca6a8de0250faf8288273328
KS | application key[C]:              7327e634b587717ba42ce6251638416c1dad7b8b17e6ff7451fb17f810dc8f03, IV=7dbce0142d51d49b2b106548
KS | application key[S]:              34c7ba09fa3da1a5c1fcf8d7b717bf79cb06e1857fdb9dc296a070e31f22d849, IV=0d83b012c6e70b0e6af2b9a8
AEP| LowProvider: COERCE(K=34c7ba09fa3da1a5c1fcf8d7b717bf79cb06e1857fdb9dc296a070e31f22d849)
AEP| LowProvider: COERCE(K=7327e634b587717ba42ce6251638416c1dad7b8b17e6ff7451fb17f810dc8f03)
HS | exporting a key
EPO| reader++ 0/0
TLS| HS.next_fragment returned a fragment; next_keys (for all data)
+ set +x
TLS| sendHandshake
TLS| send Handshake fragment with index ID13
TLS| Encrypting with key c2755a3aae1a7897b1176dbb644bd04286edd125336166231977c0382c668c2a
TLS| Sending fragment of length 734
REC| record headers: 17030302de
EPO| writer++ 0/1
TLS| read: WrittenHS, Ctrl/Open, new writer: writable
sender done clen= 175 slen= 834 status=server_accept
160303005a0200005603035b170bb386552483bbc12905edeb245e1cf6d60348
a019dfa2efde6fa274dd5700130300002e002b00027f1c00330024001d0020bc
0df014aa6443150bec3e43895382ca9134b34514ee8abda35da393190a971017
030302de774ef34f6739b099b2b88ecfd58fa869cb72f782b9c9602323ee99d7
32f4d57a884209ef401ca5dee57c7825ab031b2494547160b3888e1be06489fc
db4ce57a2c112394532aea70d81503989a4358239ab9501a62cf17216a8caba8
120fd3cc867c071050db52dbd001c0fcbfa9bd17c813cf9d75e1c0eef927641b
efd05e08b34eb7833084ec40b30c7ec45fa5efa18e79e4b87d4a62ffcd9e486d
b97373b5d0d5a23d636f8661da9d5e9a25426d69dc62cc3cc920622f710e16cf
f7462da4556e4e329bf507f11dc3a5a1d4b5029c323c741a0eb842b817813681
2bb5f6b8b225bbf03ac491598e1e9d79c11358f5c7fcc38d43b3d1356068ff9e
6645f6a5b8932294696c013e626266fdc613fd77f3c1bda5a885c46a3409ea97
4710881777657e16d8921af22ccdbd3f2b005260356cfd645deffbec867af9b1
3c7fc0eb7abd8286b9dd348cea38d5b8d6ee102f5e8839aebb1058fc0445528e
17d70d76e8d3dbbc0cc6b2bca9a22ae706fbdbade1181a725c94379dc81c50fa
d40ab24cbdf594769452422fa78c284773aecb2a0c7c2ac676871382e613d2c7
ef14a63a553fe45032e995e465a1ed34dd5d6d3ce0e45792c9820af7823fb65f
4163893389bd3d0a32761f50c435212bbba541eb157db6bd8830eea2d7d4e34a
dfcf2e41486e32277445db25ce1cb5205b247fe4ddc3ba549f871b755729b768
05c3c7bb498f2db647d7f2a440accb1af5fc67199f83b73a93c0eee70c6cde04
374d52cdfcdab1fb3a0ef46c873f021364e511eb17f2694738bae0966f9bcd43
f9e3b300117353a4fcbd214f9ac200dbdafd72f63324c80e8648ebddb919214b
54cd98d15e2ca426c120a30feac192e5d34b0cd5dc2b37d413695b0826f5bea9
924e25f9510e694dbde97cf3914f9c5d632a9dddf11cbf3594f4131d3f479238
d2647b85504845428a4c2e0d9959d537090f75a916a4247df8f3324bdbf4815b
512d1798a5b8053fe95e9d06895c44372d0b55800583ac00fceb3c9da2f8ef53
ab39
client call clen=8017 slen= 834
TLS| writeHandshake (plaintext)
TLS| HS.next_fragment PlaintextID?
HS | next_fragment
TLS| HS.next_fragment returned nothing
TLS| sendHandshake
TLS| read: WrittenHS, Ctrl/Ctrl, nothing
TLS| Read fragment at epoch index: -1 of length 90
TLS| read Handshake fragment
HS | recv_fragment
HSL| parsed ServerHello
HSL| end of flight
HS | client_ServerHello
NGO| processing server extensions [ supported_versions key_share ]
NGO| negotiated 1.3 TLS_CHACHA20_POLY1305_SHA256
HS | Running TLS 1.3
KS | ks_client_13_sh hashed_log = 18584843cae321c809be2f6643fef0ab1bfb2d73694b5f359d0d488fc4648f85
KS | no PSK negotiated. Early secret: 33ad0a1c607ec03b09e6cd9893680ce210adf300aa1f2660e1b22e10f170f92a
KS | handshake salt:                  6f2615a108c702c5678f54fc9dbab69716c076189c48250cebeac3576c3611ba
CDH| DH initiator on X255519
KS | DH shared secret: 409e21bc9267d2fb57f627c785434eb9fc20b0cbd0dd4c48e503fa3051a1cc19
KS | handshake secret:                33747eb649cd5a157da48614406dc7dde201ba569ac63d132e75b5ca5f64b564
KS | handshake traffic secret[C]:     f7f9d2984884f0063018b17cdde2313a28fecee6331525cd90b6f7452ee5852f
KS | handshake traffic secret[S]:     9628830b2ddbb596d9c1ffac52c3087ba859454d8ef01435673667a04b5b7246
KS | handshake key[C]:                9f35e4655bb8544ea937eb7709c779451c5507554f1c56b16271accc27f15d16, IV=eb2016af7fb011712899232e
KS | handshake key[S]:                c2755a3aae1a7897b1176dbb644bd04286edd125336166231977c0382c668c2a, IV=4e6f320c79fcf9b1409f1395
KS | finished key[C]: fa65a4c68b6175d1bc2e114cef38bb2ef85697be6a407e867d83bc8c3dad1da4
KS | finished key[S]: 90c71cd0e0bebd6f7fba56b662a5c861f8c6c4d8bf3d830b8ac7acccb147b154
KS | application salt:                4d7802c917fc3dd25705d8ad7f3d0d04d0f07dd253eb9f2898e5427b62b4a397
KS | application secret:              019996861b69e257f401ea1e5d78d02cb86d5563fe52c3faf9f64696109b9f70
AEP| LowProvider: COERCE(K=9f35e4655bb8544ea937eb7709c779451c5507554f1c56b16271accc27f15d16)
AEP| LowProvider: COERCE(K=c2755a3aae1a7897b1176dbb644bd04286edd125336166231977c0382c668c2a)
EPO| reader++ 0/-1
TLS| readOne ReadAgain
TLS| writeHandshake (plaintext)
TLS| HS.next_fragment PlaintextID?
HS | next_fragment
TLS| HS.next_fragment returned nothing
TLS| sendHandshake
TLS| read: WrittenHS, Ctrl/Ctrl, nothing
TLS| Read fragment at epoch index: 0 of length 734
TLS| StAE decrypt correct.
TLS| read Handshake fragment
HS | recv_fragment
HSL| parsed EncryptedExtensions
HSL| parsed Certificate13
HSL| parsed CertificateVerify
HSL| parsed Finished
HSL| end of flight
NGO| Nego.clientComplete_13
NGO| EE: alpn supported_groups 001a 
NGO| Negotiation callback to process application extensions.
@@@@ Nego callback for TLS 1.3 @@@@
Offered extensions:
001b0010000800060568712d3130000a00040002001d001a0003000102
Transport parameters offered:
000102
No application cookie (fist connection).
Adding server transport parameters:
000102
@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
WARNING: chain validation failed, ignoring.
NGO| Certificate & signature 1.3 callback result: valid
KS | ks_client_13_sf hashed_log = 4f053a5dc397c7b2c735e35c6f76e62065a6b0361c997cbc854af1ba90a9bf5c
KS | application traffic secret[C]:   17c5ad00a13de755a3e759d5e453ffba4f10edf51fa71d523e51d03f56206b68
KS | application traffic secret[S]:   291a976514ffa26d5093f1053eff47bf00bbf36aa610321696e928f780866ad1
KS | exporter master secret:          2a2342c1c9f9ffb3ee1cacea6bb2069fba2d121dca6a8de0250faf8288273328
KS | application key[C]:              7327e634b587717ba42ce6251638416c1dad7b8b17e6ff7451fb17f810dc8f03, IV=7dbce0142d51d49b2b106548
KS | application key[S]:              34c7ba09fa3da1a5c1fcf8d7b717bf79cb06e1857fdb9dc296a070e31f22d849, IV=0d83b012c6e70b0e6af2b9a8
AEP| LowProvider: COERCE(K=7327e634b587717ba42ce6251638416c1dad7b8b17e6ff7451fb17f810dc8f03)
AEP| LowProvider: COERCE(K=34c7ba09fa3da1a5c1fcf8d7b717bf79cb06e1857fdb9dc296a070e31f22d849)
HS | exporting a key
HS | Early data rejected
EPO| writer++ 0/0
HSL| emit Finished and hash
KS | ks_client_13_cf hashed_log = 1feca377bd282f89554de1e50bbafe0b5f572651648a3f09038209ea9eba92d2
KS | resumption master secret:        7543209ef148692e75c005d81fdc26c4bebad9a62021b5a8337e1abaa62406ff
EPO| reader++ 1/0
TLS| readOne ReadAgain
TLS| writeHandshake (encrypted)
TLS| HS.next_fragment ID13?
HS | next_fragment
TLS| HS.next_fragment returned a fragment; next_keys (for all data); complete
TLS| sendHandshake
TLS| send Handshake fragment with index ID13
TLS| Encrypting with key 9f35e4655bb8544ea937eb7709c779451c5507554f1c56b16271accc27f15d16
TLS| Sending fragment of length 53
REC| record headers: 1703030035
EPO| writer++ 1/1
TLS| read: WrittenHS, Open/Open, new writer: complete
client done clen=  58 slen= 834 status=client_complete
17030300351b32063df4ef230a60cae7215718df463c7a4bc6d0c0216cf2e84a
192c9b7a5446713324416f3c0befbebf2a7ab4c6ea2076f809bb
server call clen=  58 slen=7358
TLS| writeHandshake (encrypted)
TLS| HS.next_fragment ID13?
HS | next_fragment
TLS| HS.next_fragment returned nothing
TLS| sendHandshake
TLS| read: WrittenHS, Ctrl/Open, nothing
TLS| Read fragment at epoch index: 0 of length 53
TLS| StAE decrypt correct.
TLS| read Handshake fragment
HS | recv_fragment
HSL| parsed Finished
HSL| end of flight
HS | Process Client Finished
KS | ks_server_13_cf hashed_log = 1feca377bd282f89554de1e50bbafe0b5f572651648a3f09038209ea9eba92d2
KS | resumption master secret:        7543209ef148692e75c005d81fdc26c4bebad9a62021b5a8337e1abaa62406ff
AEP| LowProvider: COERCE(K=91f4e49558247ea083d23c92861dce15c28d780199eb5f2c75bdbc2643dd9f8f)
HS | Sending ticket: fc4d510b82cd2173b3c2d8e8e736ff6fcddd1ed01f589d198cd013d2af98f4dfe92fc40f39f44e2d8987ad5a786f958dcbe78fbd9c9f1c64c0757ce272aa7d831ae5971d91bebddf8651a439
HSL| emit NewSessionTicket13
EPO| reader++ 1/1
TLS| readOne Complete
sender done clen=  58 slen=   0 status=server_complete
=== Exporter secret ===
2a2342c1c9f9ffb3ee1cacea6bb2069fba2d121dca6a8de0250faf8288273328
=== QUIC 1-RTT secrets ===
C: 92a94491acdec07b7a4aeb20a7a5493da8b2d4ea5277f4616328d7d70ce777a8
S: 276508b2052d3a6df06f19a1dc47c1c70aeb1790af34037d54aeb25cdb7c456f
=== AEAD client key test ===
a59f0878e9b33ef72c83911ad91b3ee80809a9bf091d0b5bbf3e40
=== Decrypt successful ===
Ok
./quic.exe 0rtt

INITIAL ECDHE HANDSHAKE (NO EARLY SECRET)

server create
FFI| offering custom extension 001a
FFI| extension contents: ffff00050a0b0c0d0e
FFI| setting early data limit to ffffffff
FFI| Setting a new ticket callback.
FFI| Setting a new server negotiation callback.
FFI| Setting up certificate callbacks.
client create
FFI| offering custom extension 001a
FFI| extension contents: ffff00050a0b0c0d0e
FFI| setting early data limit to ffffffff
FFI| Setting a new ticket callback.
FFI| Setting a new server negotiation callback.
FFI| Setting up certificate callbacks.
TLS| writeHandshake (plaintext)
TLS| HS.next_fragment PlaintextID?
HS | next_fragment
HS | offering ClientHello 1.3
KS | ks_client_init 1.3
CDH| Keygen (initiator) on X255519
NGO| No PSK or 0-RTT disabled
NGO| offering client extensions [ 001a supported_versions key_share server_name alpn extended_master_secret signature_algorithms supported_groups psk_key_exchange_modes ]
NGO| offering cipher suites ; TLS_CHACHA20_POLY1305_SHA256; TLS_AES_128_GCM_SHA256
HSL| emit ClientHello
TLS| HS.next_fragment returned a fragment
TLS| sendHandshake
TLS| send Handshake fragment with index PlaintextID
TLS| Sending fragment of length 170
REC| record headers: 16030300aa
TLS| writeHandshake (plaintext)
TLS| HS.next_fragment PlaintextID?
HS | next_fragment
TLS| HS.next_fragment returned nothing
TLS| sendHandshake
TLS| read: WrittenHS, Ctrl/Ctrl, nothing
REC| WouldBlock
TLS| readOne ReadWouldBlock
client returns would_block clen=175 slen=0
ClientHello[ 175] ---->

TLS| writeHandshake (plaintext)
TLS| HS.next_fragment PlaintextID?
HS | next_fragment
TLS| HS.next_fragment returned nothing
TLS| sendHandshake
TLS| read: WrittenHS, Ctrl/Ctrl, nothing
TLS| Read fragment at epoch index: -1 of length 170
TLS| read Handshake fragment
HS | recv_fragment
HSL| parsed [ClientHello] -- end of flight 
HS | Processing ClientHello
NGO| offered client extensions [ 001a supported_versions key_share server_name alpn extended_master_secret signature_algorithms supported_groups psk_key_exchange_modes ]
NGO| offered cipher suites ; TLS_CHACHA20_POLY1305_SHA256; TLS_AES_128_GCM_SHA256
NGO| offered versions 1.3
NGO| Negotiated Pure EDH key exchange
NGO| Negotiated ECDSA_SECP256R1_SHA256
NGO| Negotiation callback to handle extra extensions and query for stateless retry.
NGO| Application data in cookie: none
@@@@ Nego callback for TLS 1.3 @@@@
Offered extensions:
003d001a0009ffff00050a0b0c0d0e0000000e000c0000096c6f63616c686f73
740010000800060568712d3130000d0006000408040403000a00040002001d
Transport parameters offered:
ffff00050a0b0c0d0e
No application cookie (fist connection).
Adding server transport parameters:
000102
@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
NGO| negotiated 1.3 TLS_CHACHA20_POLY1305_SHA256
KS | ks_server_init
KS | No PSK selected.
KS | Computed early secret:           33ad0a1c607ec03b09e6cd9893680ce210adf300aa1f2660e1b22e10f170f92a
KS | Handshake salt:                  6f2615a108c702c5678f54fc9dbab69716c076189c48250cebeac3576c3611ba
CDH| Keygen (responder) on X255519
CDH| DH initiator on X255519
KS | DH shared secret: b7a52fc07d15ff882058be6a6cc02dcd97ec6f68c986033ca04c240e86bf3b75
KS | Handshake secret:                5de15415ef01320efb82ed94b03e123cfb340a1c7faa81c084b6deb61b8ae956
NGO| processing client extensions [ 001a supported_versions key_share server_name alpn extended_master_secret signature_algorithms supported_groups psk_key_exchange_modes ]
NGO| including server extensions (SH + EE) [ supported_versions key_share alpn supported_groups ]
NGO| extra extensions from application callback: 001a 
HSL| emit ServerHello and hash
HS | derive handshake keys
KS | ks_server_13_sh, hashed log = 8cb0726da7cce50d594a7ef3e5a54d7de24892fa36eef1ab83c0dfbb6c553bf3
KS | handshake traffic secret[C]:     597922ac761e51a4262aa8e68b9a0b7b90f3bb2e40646c48374c172b9434932b
KS | handshake traffic secret[S]:     f2adba11e0e54ec8611380f8aa18cb8b6222959686f9d5ee1e5cd09cb1edcb75
KS | handshake key[C]:                23a3e1d73f522aa3be87791751da4513a81f49099c23f89db0e7856b256c21b7, IV=49aed6f6754fdc566d9f483b
KS | handshake key[S]: 020d66f07cc92b97aafc5abf99dd9cb76560a93576916bb76854fffc55190102, IV=71b52a563eb2b914217111b2
AEP| LowProvider: COERCE(K=020d66f07cc92b97aafc5abf99dd9cb76560a93576916bb76854fffc55190102)
AEP| LowProvider: COERCE(K=23a3e1d73f522aa3be87791751da4513a81f49099c23f89db0e7856b256c21b7)
KS | finished key[C]:                 19363a1594ea9463ae8c939182074e3cd3eb5ed870c9580eee8cf55673acaa17
KS | finished key[S]:                 f923a4bf1e6ace4dc6b4a8107ad1de05e5256e8f044d5451549e30a44ed8e1ef
KS | Application salt:                6649641f4789b8c39ffc0cf72feb39288df70ac67de0725c26c79b09781d2e04
KS | Application secret:              aff4b8ffeab899d2a42a4fe1e73291ba7c32460a17f59f3c37c447d01915b111
TLS| readOne ReadAgain
TLS| writeHandshake (plaintext)
TLS| HS.next_fragment PlaintextID?
HS | next_fragment
TLS| HS.next_fragment returned a fragment; next_keys (for handshake only
TLS| sendHandshake
TLS| send Handshake fragment with index PlaintextID
TLS| Sending fragment of length 90
REC| record headers: 160303005a
EPO| writer++ -1/0
TLS| writeHandshake (encrypted)
TLS| HS.next_fragment ID13?
HS | next_fragment
HS | prepare Server Finished
HSL| emit EncryptedExtensions
HSL| emit Certificate13 and hash
======== TO BE SIGNED <0403>: (130 octets) ========
2020202020202020202020202020202020202020202020202020202020202020
2020202020202020202020202020202020202020202020202020202020202020
544c5320312e332c207365727665722043657274696669636174655665726966
7900bbb0ad9caf5cc9553329694137c2ee305c75059bc7ae3b5d125a010c82b0
bfed
===================================================
HSL| emit CertificateVerify and hash
HSL| emit Finished and hash
KS | ks_server_13_sf hashed_log = 460b9b482f855a697d0dee6de4c16408990bd861883c0c220b87988dc2c7a341
KS | application traffic secret[C]:   13874d1a03512f3a39b728abfa769612cdbb5b33ce77fe206e3316cb1f47ee4d
KS | application traffic secret[S]:   b06dd8a6aa736511ce21000bb93c71a36cac62e7305c69c1291f157a936aeb00
KS | exporter master secret:          e03eeee02211d530cef65cde33dc27e95ee6c9ea366ecdfb26c442bd12317792
KS | application key[C]:              16de62c4d0bfd36ffccc6811d810b84475f6a216a6ea5f0ebd74be2135e2307a, IV=11b7df4c7eadd8949062fe5b
KS | application key[S]:              ab7cee7979886b1e2e46c0b5177d818f0a8037d58eb90164eb5af77bbe1203aa, IV=61164f87eea95eceb067cc5a
AEP| LowProvider: COERCE(K=ab7cee7979886b1e2e46c0b5177d818f0a8037d58eb90164eb5af77bbe1203aa)
AEP| LowProvider: COERCE(K=16de62c4d0bfd36ffccc6811d810b84475f6a216a6ea5f0ebd74be2135e2307a)
HS | exporting a key
EPO| reader++ 0/0
TLS| HS.next_fragment returned a fragment; next_keys (for all data)
TLS| sendHandshake
TLS| send Handshake fragment with index ID13
TLS| Encrypting with key 020d66f07cc92b97aafc5abf99dd9cb76560a93576916bb76854fffc55190102
TLS| Sending fragment of length 734
REC| record headers: 17030302de
EPO| writer++ 0/1
TLS| read: WrittenHS, Ctrl/Open, new writer: writable
server returns server_accept clen=175 slen=834
secret=e03eeee02211d530cef65cde33dc27e95ee6c9ea366ecdfb26c442bd12317792
<---- ServerHello;(EncryptedExtensions; Certificate; CertVerify; Finished)[ 834]

TLS| writeHandshake (plaintext)
TLS| HS.next_fragment PlaintextID?
HS | next_fragment
TLS| HS.next_fragment returned nothing
TLS| sendHandshake
TLS| read: WrittenHS, Ctrl/Ctrl, nothing
TLS| Read fragment at epoch index: -1 of length 90
TLS| read Handshake fragment
HS | recv_fragment
HSL| parsed ServerHello
HSL| end of flight
HS | client_ServerHello
NGO| processing server extensions [ supported_versions key_share ]
NGO| negotiated 1.3 TLS_CHACHA20_POLY1305_SHA256
HS | Running TLS 1.3
KS | ks_client_13_sh hashed_log = 8cb0726da7cce50d594a7ef3e5a54d7de24892fa36eef1ab83c0dfbb6c553bf3
KS | no PSK negotiated. Early secret: 33ad0a1c607ec03b09e6cd9893680ce210adf300aa1f2660e1b22e10f170f92a
KS | handshake salt:                  6f2615a108c702c5678f54fc9dbab69716c076189c48250cebeac3576c3611ba
CDH| DH initiator on X255519
KS | DH shared secret: b7a52fc07d15ff882058be6a6cc02dcd97ec6f68c986033ca04c240e86bf3b75
KS | handshake secret:                5de15415ef01320efb82ed94b03e123cfb340a1c7faa81c084b6deb61b8ae956
KS | handshake traffic secret[C]:     597922ac761e51a4262aa8e68b9a0b7b90f3bb2e40646c48374c172b9434932b
KS | handshake traffic secret[S]:     f2adba11e0e54ec8611380f8aa18cb8b6222959686f9d5ee1e5cd09cb1edcb75
KS | handshake key[C]:                23a3e1d73f522aa3be87791751da4513a81f49099c23f89db0e7856b256c21b7, IV=49aed6f6754fdc566d9f483b
KS | handshake key[S]:                020d66f07cc92b97aafc5abf99dd9cb76560a93576916bb76854fffc55190102, IV=71b52a563eb2b914217111b2
KS | finished key[C]: 19363a1594ea9463ae8c939182074e3cd3eb5ed870c9580eee8cf55673acaa17
KS | finished key[S]: f923a4bf1e6ace4dc6b4a8107ad1de05e5256e8f044d5451549e30a44ed8e1ef
KS | application salt:                6649641f4789b8c39ffc0cf72feb39288df70ac67de0725c26c79b09781d2e04
KS | application secret:              aff4b8ffeab899d2a42a4fe1e73291ba7c32460a17f59f3c37c447d01915b111
AEP| LowProvider: COERCE(K=23a3e1d73f522aa3be87791751da4513a81f49099c23f89db0e7856b256c21b7)
AEP| LowProvider: COERCE(K=020d66f07cc92b97aafc5abf99dd9cb76560a93576916bb76854fffc55190102)
EPO| reader++ 0/-1
TLS| readOne ReadAgain
TLS| writeHandshake (plaintext)
TLS| HS.next_fragment PlaintextID?
HS | next_fragment
TLS| HS.next_fragment returned nothing
TLS| sendHandshake
TLS| read: WrittenHS, Ctrl/Ctrl, nothing
TLS| Read fragment at epoch index: 0 of length 734
TLS| StAE decrypt correct.
TLS| read Handshake fragment
HS | recv_fragment
HSL| parsed EncryptedExtensions
HSL| parsed Certificate13
HSL| parsed CertificateVerify
HSL| parsed Finished
HSL| end of flight
NGO| Nego.clientComplete_13
NGO| EE: alpn supported_groups 001a 
NGO| Negotiation callback to process application extensions.
@@@@ Nego callback for TLS 1.3 @@@@
Offered extensions:
001b0010000800060568712d3130000a00040002001d001a0003000102
Transport parameters offered:
000102
No application cookie (fist connection).
Adding server transport parameters:
000102
@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
WARNING: chain validation failed, ignoring.
NGO| Certificate & signature 1.3 callback result: valid
KS | ks_client_13_sf hashed_log = 460b9b482f855a697d0dee6de4c16408990bd861883c0c220b87988dc2c7a341
KS | application traffic secret[C]:   13874d1a03512f3a39b728abfa769612cdbb5b33ce77fe206e3316cb1f47ee4d
KS | application traffic secret[S]:   b06dd8a6aa736511ce21000bb93c71a36cac62e7305c69c1291f157a936aeb00
KS | exporter master secret:          e03eeee02211d530cef65cde33dc27e95ee6c9ea366ecdfb26c442bd12317792
KS | application key[C]:              16de62c4d0bfd36ffccc6811d810b84475f6a216a6ea5f0ebd74be2135e2307a, IV=11b7df4c7eadd8949062fe5b
KS | application key[S]:              ab7cee7979886b1e2e46c0b5177d818f0a8037d58eb90164eb5af77bbe1203aa, IV=61164f87eea95eceb067cc5a
AEP| LowProvider: COERCE(K=16de62c4d0bfd36ffccc6811d810b84475f6a216a6ea5f0ebd74be2135e2307a)
AEP| LowProvider: COERCE(K=ab7cee7979886b1e2e46c0b5177d818f0a8037d58eb90164eb5af77bbe1203aa)
HS | exporting a key
HS | Early data rejected
EPO| writer++ 0/0
HSL| emit Finished and hash
KS | ks_client_13_cf hashed_log = c8328ddba63554af65b88063245d213cb9608837e42f7aa351a5a3ec7e20d33f
KS | resumption master secret:        47f0bbb0422c4377da783c64d2944f91e29da2960814775362cd62cdb24fdaaf
EPO| reader++ 1/0
TLS| readOne ReadAgain
TLS| writeHandshake (encrypted)
TLS| HS.next_fragment ID13?
HS | next_fragment
TLS| HS.next_fragment returned a fragment; next_keys (for all data); complete
TLS| sendHandshake
TLS| send Handshake fragment with index ID13
TLS| Encrypting with key 23a3e1d73f522aa3be87791751da4513a81f49099c23f89db0e7856b256c21b7
TLS| Sending fragment of length 53
REC| record headers: 1703030035
EPO| writer++ 1/1
TLS| read: WrittenHS, Open/Open, new writer: complete
client returns client_complete clen=58 slen=834
secret=e03eeee02211d530cef65cde33dc27e95ee6c9ea366ecdfb26c442bd12317792
(Finished) [  58] ---->

TLS| writeHandshake (encrypted)
TLS| HS.next_fragment ID13?
HS | next_fragment
TLS| HS.next_fragment returned nothing
TLS| sendHandshake
TLS| read: WrittenHS, Ctrl/Open, nothing
TLS| Read fragment at epoch index: 0 of length 53
TLS| StAE decrypt correct.
TLS| read Handshake fragment
HS | recv_fragment
HSL| parsed Finished
HSL| end of flight
HS | Process Client Finished
KS | ks_server_13_cf hashed_log = c8328ddba63554af65b88063245d213cb9608837e42f7aa351a5a3ec7e20d33f
KS | resumption master secret:        47f0bbb0422c4377da783c64d2944f91e29da2960814775362cd62cdb24fdaaf
AEP| LowProvider: COERCE(K=e9202436766437d464ce031043db2947e02fd639758226ea6ee2685ff17b544f)
HS | Sending ticket: 89b858d6c8b6d8647aa57ba2ab31bf0cbd32f000c13b6a9e1c5321dab1478226559d3d0f7dc175bf65644961bae0904d754916bdad122e3aeed7b2e72763fcce1faa2ce0aada7c6a94f6e207
HSL| emit NewSessionTicket13
EPO| reader++ 1/1
TLS| readOne Complete
server returns server_complete clen=58 slen=0
TLS| writeHandshake (encrypted)
TLS| HS.next_fragment ID13?
HS | next_fragment
TLS| HS.next_fragment returned a fragment
TLS| sendHandshake
TLS| send Handshake fragment with index ID13
TLS| Encrypting with key ab7cee7979886b1e2e46c0b5177d818f0a8037d58eb90164eb5af77bbe1203aa
TLS| Sending fragment of length 130
REC| record headers: 1703030082
TLS| writeHandshake (encrypted)
TLS| HS.next_fragment ID13?
HS | next_fragment
TLS| HS.next_fragment returned nothing
TLS| sendHandshake
TLS| read: WrittenHS, Open/Open, nothing
REC| WouldBlock
TLS| readOne ReadWouldBlock
server returns would_block clen=0 slen=135
<---- {Ticket}[ 135]
TLS| writeHandshake (encrypted)
TLS| HS.next_fragment ID13?
HS | next_fragment
TLS| HS.next_fragment returned nothing
TLS| sendHandshake
TLS| read: WrittenHS, Open/Open, nothing
TLS| Read fragment at epoch index: 1 of length 130
TLS| StAE decrypt correct.
TLS| read Handshake fragment
HS | recv_fragment
HSL| parsed NewSessionTicket13
HSL| end of flight
HS | Received ticket: 89b858d6c8b6d8647aa57ba2ab31bf0cbd32f000c13b6a9e1c5321dab1478226559d3d0f7dc175bf65644961bae0904d754916bdad122e3aeed7b2e72763fcce1faa2ce0aada7c6a94f6e207
KS | ks_client_13_rms
KS | Recall RMS: 47f0bbb0422c4377da783c64d2944f91e29da2960814775362cd62cdb24fdaaf
AEP| LowProvider: COERCE(K=07cd75e2eed926599e8da9972b486e0e10f3b89f4f6a2ce02f785934c5f6dcce)

##### New session ticket received! #####
Host: localhost
Ticket:
89b858d6c8b6d8647aa57ba2ab31bf0cbd32f000c13b6a9e1c5321dab1478226
559d3d0f7dc175bf65644961bae0904d754916bdad122e3aeed7b2e72763fcce
1faa2ce0aada7c6a94f6e207
########################################
TLS| readOne ReadAgain
TLS| writeHandshake (encrypted)
TLS| HS.next_fragment ID13?
HS | next_fragment
TLS| HS.next_fragment returned nothing
TLS| sendHandshake
TLS| read: WrittenHS, Open/Open, nothing
REC| WouldBlock
TLS| readOne ReadWouldBlock
client returns clen=0 slen=135 status=would_block

TICKET-BASED RESUMPTION

server create
FFI| offering custom extension 001a
FFI| extension contents: ffff00050a0b0c0d0e
FFI| setting early data limit to ffffffff
FFI| Setting a new ticket callback.
FFI| Setting a new server negotiation callback.
FFI| Setting up certificate callbacks.
client create
FFI| offering custom extension 001a
FFI| extension contents: ffff00050a0b0c0d0e
FFI| setting early data limit to ffffffff
FFI| Setting a new ticket callback.
FFI| Setting a new server negotiation callback.
FFI| Setting up certificate callbacks.
TCK| Decrypting ticket 290ae6e5aec82f047fe2bb2ed21f1f67ad9be099e43f4a74f17d88a67ee53af814524ed09fe54e818dfb722776edd8fa16a6f0e957a72297a19f3ea5c68539c6a191cfdddcb710a34aa593a0
TCK| Parsing ticket 030413035b170bb3ed7a31b70000002064d7a68be45aa0c1f1c68898ded21f1e7ae7e6b15f497a75bd9a04ce700824ea
TLS| writeHandshake (plaintext)
TLS| HS.next_fragment PlaintextID?
HS | next_fragment
HS | offering ClientHello 1.3
KS | ks_client_init 1.3
CDH| Keygen (initiator) on X255519
NGO| Offering a PSK compatible with 0-RTT
NGO| offering client extensions [ 001a supported_versions key_share server_name alpn extended_master_secret signature_algorithms supported_groups psk_key_exchange_modes early_data pre_shared_key ]
NGO| offering cipher suites ; TLS_CHACHA20_POLY1305_SHA256; TLS_AES_128_GCM_SHA256
HSL| emit ClientHello
KS | Loaded pre-shared key 89b858d6c8b6d8647aa57ba2ab31bf0cbd32f000c13b6a9e1c5321dab1478226559d3d0f7dc175bf65644961bae0904d754916bdad122e3aeed7b2e72763fcce1faa2ce0aada7c6a94f6e207: 64d7a68be45aa0c1f1c68898ded21f1e7ae7e6b15f497a75bd9a04ce700824ea
KS | Early secret: dea9b99080d8915ba68060a7eea01fc1ed7e4772a7ae20ffb5bc1c1e7ea9594b
KS | Binder key[res binder]: 1c33d603612827b100193c79b477be584e07d5936bf90b850e35f1147eab0e0b
KS | Binder Finished key: 73e7c909644604f392b01764cad86810fee6ea10880fa57739eedbe7f79b9ea5
HSL| emit Binders
HS | setting up 0RTT
KS | ks_client_13_ch log=7c65564ca9b53d6c09fdd869d7af48380eeee4c0c0747b44dcf5e7c9f3666642
KS | Client early traffic secret:     9af1fbacb36967bb8f2c141b50f16a8a468c2f0e204e80f2b486536b113f3eb3
KS | Early exporter master secret:    ba458d59b71852acfd1368fa9760c0e575ec5ff8fcbf98e62cdba1c060dadd82
KS | Client 0-RTT key:                7f9e8e5157600922b8e6c508dfa582069c82f5ccfd40c365cb6ec532fa548578, IV=eedf13144562eef79dfa746c
AEP| LowProvider: COERCE(K=7f9e8e5157600922b8e6c508dfa582069c82f5ccfd40c365cb6ec532fa548578)
HS | exporting a key
TLS| HS.next_fragment returned a fragment; next_keys (for all data)
TLS| sendHandshake
TLS| send Handshake fragment with index PlaintextID
TLS| Sending fragment of length 297
REC| record headers: 1603030129
EPO| writer++ -1/0
TLS| read: WrittenHS, Ctrl/Open, new writer: writable
client returns client_early_data clen=302 slen=0
early secret=ba458d59b71852acfd1368fa9760c0e575ec5ff8fcbf98e62cdba1c060dadd82
ClientHello[ 302] ---->

TLS| writeHandshake (plaintext)
TLS| HS.next_fragment PlaintextID?
HS | next_fragment
TLS| HS.next_fragment returned nothing
TLS| sendHandshake
TLS| read: WrittenHS, Ctrl/Ctrl, nothing
TLS| Read fragment at epoch index: -1 of length 297
TLS| read Handshake fragment
HS | recv_fragment
HSL| parsed [ClientHello; Binders] -- end of flight 
HS | Processing ClientHello with 1 binder(s)
NGO| offered client extensions [ 001a supported_versions key_share server_name alpn extended_master_secret signature_algorithms supported_groups psk_key_exchange_modes early_data pre_shared_key ]
NGO| offered cipher suites ; TLS_CHACHA20_POLY1305_SHA256; TLS_AES_128_GCM_SHA256
NGO| offered versions 1.3
TCK| Decrypting ticket 89b858d6c8b6d8647aa57ba2ab31bf0cbd32f000c13b6a9e1c5321dab1478226559d3d0f7dc175bf65644961bae0904d754916bdad122e3aeed7b2e72763fcce1faa2ce0aada7c6a94f6e207
TCK| Parsing ticket 030413035b170bb3ed7a31b70000002047f0bbb0422c4377da783c64d2944f91e29da2960814775362cd62cdb24fdaaf
NGO| Negotiated PSK_EDH key exchange
NGO| Negotiation callback to handle extra extensions and query for stateless retry.
NGO| Application data in cookie: none
@@@@ Nego callback for TLS 1.3 @@@@
Offered extensions:
003d001a0009ffff00050a0b0c0d0e0000000e000c0000096c6f63616c686f73
740010000800060568712d3130000d0006000408040403000a00040002001d
Transport parameters offered:
ffff00050a0b0c0d0e
No application cookie (fist connection).
Adding server transport parameters:
000102
@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
NGO| negotiated 1.3 TLS_CHACHA20_POLY1305_SHA256
HS | accepted TLS 1.3 psk #0
KS | ks_server_init
KS | Using negotiated PSK identity: 89b858d6c8b6d8647aa57ba2ab31bf0cbd32f000c13b6a9e1c5321dab1478226559d3d0f7dc175bf65644961bae0904d754916bdad122e3aeed7b2e72763fcce1faa2ce0aada7c6a94f6e207
TCK| Decrypting ticket 89b858d6c8b6d8647aa57ba2ab31bf0cbd32f000c13b6a9e1c5321dab1478226559d3d0f7dc175bf65644961bae0904d754916bdad122e3aeed7b2e72763fcce1faa2ce0aada7c6a94f6e207
TCK| Parsing ticket 030413035b170bb3ed7a31b70000002047f0bbb0422c4377da783c64d2944f91e29da2960814775362cd62cdb24fdaaf
KS | Ticket RMS: 47f0bbb0422c4377da783c64d2944f91e29da2960814775362cd62cdb24fdaaf
KS | Pre-shared key: 64d7a68be45aa0c1f1c68898ded21f1e7ae7e6b15f497a75bd9a04ce700824ea
KS | binder key:                      1c33d603612827b100193c79b477be584e07d5936bf90b850e35f1147eab0e0b
KS | binder Finished key:             73e7c909644604f392b01764cad86810fee6ea10880fa57739eedbe7f79b9ea5
KS | Computed early secret:           dea9b99080d8915ba68060a7eea01fc1ed7e4772a7ae20ffb5bc1c1e7ea9594b
KS | Handshake salt:                  4a509502c096081266e75c9244c7b1bce31d0d4001482ea281026b68e542307a
CDH| Keygen (responder) on X255519
CDH| DH initiator on X255519
KS | DH shared secret: 9e6c81497d41c01026d844cb6fab624bd439b3f68bb35148b109438b2bafbd5b
KS | Handshake secret:                65979a9a5811913e0deec3a99d3b42162fac54e3305fce3099ac96e494ceac22
NGO| processing client extensions [ 001a supported_versions key_share server_name alpn extended_master_secret signature_algorithms supported_groups psk_key_exchange_modes early_data pre_shared_key ]
NGO| including server extensions (SH + EE) [ supported_versions key_share alpn supported_groups early_data pre_shared_key ]
NGO| extra extensions from application callback: 001a 
HSL| emit ServerHello and hash
KS | ks_server_13_0rtt_key
KS | Client early traffic secret:     9af1fbacb36967bb8f2c141b50f16a8a468c2f0e204e80f2b486536b113f3eb3
KS | Early exporter master secret:    ba458d59b71852acfd1368fa9760c0e575ec5ff8fcbf98e62cdba1c060dadd82
KS | Client 0-RTT key:                7f9e8e5157600922b8e6c508dfa582069c82f5ccfd40c365cb6ec532fa548578, IV=eedf13144562eef79dfa746c
AEP| LowProvider: COERCE(K=7f9e8e5157600922b8e6c508dfa582069c82f5ccfd40c365cb6ec532fa548578)
HS | exporting a key
HS | derive handshake keys
KS | ks_server_13_sh, hashed log = fb20f551c9b7f4e5264a973225f83e5cf548f482074338a271e1b63c490fb9d0
KS | handshake traffic secret[C]:     62c2f395020b74c0c661cb5f7617be65898c17e8615a3def5012bfbf328a9f5b
KS | handshake traffic secret[S]:     8d6da9dd5beea596336dded2853e3581930d636e03bef1bebd7538ce7754f08e
KS | handshake key[C]:                69f6af0139546ea0b89bdc1c8b3d0f591793eb7615d2a8e7c94fb892c505ea45, IV=abb3a536c2a48ee263a25de5
KS | handshake key[S]: bf8441d26c2f573f0bff5dd52adacbd5f3d4315ca7c167e0a6752e97716e7a2b, IV=20864431b192abeabc7ce260
AEP| LowProvider: COERCE(K=bf8441d26c2f573f0bff5dd52adacbd5f3d4315ca7c167e0a6752e97716e7a2b)
AEP| LowProvider: COERCE(K=69f6af0139546ea0b89bdc1c8b3d0f591793eb7615d2a8e7c94fb892c505ea45)
KS | finished key[C]:                 910dcbc6e30414d7d7b710a34c11c1744f3ff9bd51936eb847e57cb3876a71c7
KS | finished key[S]:                 5f7ac110ee72be76b1d4402462320c1572ba6a1164994970752c705fb3916e41
KS | Application salt:                3624f9406765c25643980e29285ff85d2fba98872ea175ab93dd995b2f14c950
KS | Application secret:              c30426e480c6bfd11e0f0e0845e6debb170d411bab72112756c6b5020dbbf4a3
TLS| readOne ReadAgain
TLS| writeHandshake (plaintext)
TLS| HS.next_fragment PlaintextID?
HS | next_fragment
TLS| HS.next_fragment returned a fragment; next_keys (for handshake only skipping 0RTT
TLS| sendHandshake
TLS| send Handshake fragment with index PlaintextID
TLS| Sending fragment of length 96
REC| record headers: 1603030060
EPO| writer++ -1/0
EPO| writer++ -1/1
TLS| writeHandshake (encrypted)
TLS| HS.next_fragment ID13?
HS | next_fragment
HS | prepare Server Finished
HSL| emit EncryptedExtensions and hash
HSL| emit Finished and hash
KS | ks_server_13_sf hashed_log = 6b93a08cc0d9ecaac5aa4a17bbf0b346c7b62a518a7a78263cbaf4ae918f63e3
KS | application traffic secret[C]:   1a1f7ffabbc353705abb3561838edf1fa767c828e01ad33def5b1451e9c3b368
KS | application traffic secret[S]:   19eda8573dd5559fe3bfc5d2e6f22ef2f5faeda612d0265abb0126c55a7f7526
KS | exporter master secret:          0f926cf5fe522bd1b7ce068d76a1f63fb31d05175ff2da18703eecb160e07b0f
KS | application key[C]:              c5ae6bf483a09f07de28f75fcc68835cf8aa481741df709917cb4657a476e45a, IV=2ccec14410622f820175b3fc
KS | application key[S]:              7672fd810e7fe133d3654783107743e73ff2a114e4b8684f15d7313fdc0d18e3, IV=fbb7bf4507df62195681a0c6
AEP| LowProvider: COERCE(K=7672fd810e7fe133d3654783107743e73ff2a114e4b8684f15d7313fdc0d18e3)
AEP| LowProvider: COERCE(K=c5ae6bf483a09f07de28f75fcc68835cf8aa481741df709917cb4657a476e45a)
HS | exporting a key
EPO| reader++ 0/1
TLS| HS.next_fragment returned a fragment; next_keys (for all data)
TLS| sendHandshake
TLS| send Handshake fragment with index ID13
TLS| Encrypting with key bf8441d26c2f573f0bff5dd52adacbd5f3d4315ca7c167e0a6752e97716e7a2b
TLS| Sending fragment of length 90
REC| record headers: 170303005a
EPO| writer++ 0/2
TLS| read: WrittenHS, Ctrl/Open, new writer: writable
server returns server_accept_early_data clen=302 slen=196
early secret=ba458d59b71852acfd1368fa9760c0e575ec5ff8fcbf98e62cdba1c060dadd82
secret=0f926cf5fe522bd1b7ce068d76a1f63fb31d05175ff2da18703eecb160e07b0f
<---- ServerHello;(EncryptedExtensions; Certificate; CertVerify; Finished)[ 196]

TLS| writeHandshake (encrypted)
TLS| HS.next_fragment ID13?
HS | next_fragment
TLS| HS.next_fragment returned nothing
TLS| sendHandshake
TLS| read: WrittenHS, Ctrl/Open, nothing
TLS| Read fragment at epoch index: -1 of length 96
TLS| read Handshake fragment
HS | recv_fragment
HSL| parsed ServerHello
HSL| end of flight
HS | client_ServerHello
NGO| processing server extensions [ supported_versions key_share pre_shared_key ]
NGO| negotiated 1.3 TLS_CHACHA20_POLY1305_SHA256
HS | Running TLS 1.3
KS | ks_client_13_sh hashed_log = fb20f551c9b7f4e5264a973225f83e5cf548f482074338a271e1b63c490fb9d0
KS | recallPSK early secret:          dea9b99080d8915ba68060a7eea01fc1ed7e4772a7ae20ffb5bc1c1e7ea9594b
KS | handshake salt:                  4a509502c096081266e75c9244c7b1bce31d0d4001482ea281026b68e542307a
CDH| DH initiator on X255519
KS | DH shared secret: 9e6c81497d41c01026d844cb6fab624bd439b3f68bb35148b109438b2bafbd5b
KS | handshake secret:                65979a9a5811913e0deec3a99d3b42162fac54e3305fce3099ac96e494ceac22
KS | handshake traffic secret[C]:     62c2f395020b74c0c661cb5f7617be65898c17e8615a3def5012bfbf328a9f5b
KS | handshake traffic secret[S]:     8d6da9dd5beea596336dded2853e3581930d636e03bef1bebd7538ce7754f08e
KS | handshake key[C]:                69f6af0139546ea0b89bdc1c8b3d0f591793eb7615d2a8e7c94fb892c505ea45, IV=abb3a536c2a48ee263a25de5
KS | handshake key[S]:                bf8441d26c2f573f0bff5dd52adacbd5f3d4315ca7c167e0a6752e97716e7a2b, IV=20864431b192abeabc7ce260
KS | finished key[C]: 910dcbc6e30414d7d7b710a34c11c1744f3ff9bd51936eb847e57cb3876a71c7
KS | finished key[S]: 5f7ac110ee72be76b1d4402462320c1572ba6a1164994970752c705fb3916e41
KS | application salt:                3624f9406765c25643980e29285ff85d2fba98872ea175ab93dd995b2f14c950
KS | application secret:              c30426e480c6bfd11e0f0e0845e6debb170d411bab72112756c6b5020dbbf4a3
AEP| LowProvider: COERCE(K=69f6af0139546ea0b89bdc1c8b3d0f591793eb7615d2a8e7c94fb892c505ea45)
AEP| LowProvider: COERCE(K=bf8441d26c2f573f0bff5dd52adacbd5f3d4315ca7c167e0a6752e97716e7a2b)
HS | 0RTT potentially accepted (wait for EE to confirm)
EPO| reader++ 0/0
EPO| reader++ 1/0
TLS| readOne ReadAgain
TLS| writeHandshake (encrypted)
TLS| HS.next_fragment ID13?
HS | next_fragment
TLS| HS.next_fragment returned nothing
TLS| sendHandshake
TLS| read: WrittenHS, Ctrl/Open, nothing
TLS| Read fragment at epoch index: 1 of length 90
TLS| StAE decrypt correct.
TLS| read Handshake fragment
HS | recv_fragment
HSL| parsed EncryptedExtensions
HSL| parsed Finished
HSL| end of flight
NGO| Nego.clientComplete_13
NGO| EE: alpn supported_groups early_data 001a 
NGO| Negotiation callback to process application extensions.
@@@@ Nego callback for TLS 1.3 @@@@
Offered extensions:
001b0010000800060568712d3130000a00040002001d001a0003000102
Transport parameters offered:
000102
No application cookie (fist connection).
Adding server transport parameters:
000102
@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
NGO| Certificate & signature 1.3 callback result: valid
KS | ks_client_13_sf hashed_log = 6b93a08cc0d9ecaac5aa4a17bbf0b346c7b62a518a7a78263cbaf4ae918f63e3
KS | application traffic secret[C]:   1a1f7ffabbc353705abb3561838edf1fa767c828e01ad33def5b1451e9c3b368
KS | application traffic secret[S]:   19eda8573dd5559fe3bfc5d2e6f22ef2f5faeda612d0265abb0126c55a7f7526
KS | exporter master secret:          0f926cf5fe522bd1b7ce068d76a1f63fb31d05175ff2da18703eecb160e07b0f
KS | application key[C]:              c5ae6bf483a09f07de28f75fcc68835cf8aa481741df709917cb4657a476e45a, IV=2ccec14410622f820175b3fc
KS | application key[S]:              7672fd810e7fe133d3654783107743e73ff2a114e4b8684f15d7313fdc0d18e3, IV=fbb7bf4507df62195681a0c6
AEP| LowProvider: COERCE(K=c5ae6bf483a09f07de28f75fcc68835cf8aa481741df709917cb4657a476e45a)
AEP| LowProvider: COERCE(K=7672fd810e7fe133d3654783107743e73ff2a114e4b8684f15d7313fdc0d18e3)
HS | exporting a key
HS | Early data accepted; emitting EOED.
HSL| emit EndOfEarlyData and hash
TLS| readOne ReadAgain
TLS| writeHandshake (encrypted)
TLS| HS.next_fragment ID13?
HS | next_fragment
TLS| HS.next_fragment returned a fragment; next_keys (for handshake only
TLS| sendHandshake
TLS| send Handshake fragment with index ID13
TLS| Encrypting with key 7f9e8e5157600922b8e6c508dfa582069c82f5ccfd40c365cb6ec532fa548578
TLS| Sending fragment of length 21
REC| record headers: 1703030015
EPO| writer++ 1/1
TLS| writeHandshake (encrypted)
TLS| HS.next_fragment ID13?
HS | next_fragment
HSL| emit Finished and hash
KS | ks_client_13_cf hashed_log = bd3d03cfbf41daa39e7327b50dd6a673bec5b5d8005b3a25c356a59ed12f6235
KS | resumption master secret:        ea6d5ea56fd0de10894f907a255a144fd3f7b0fe26f729aa690cca71abf75aa2
EPO| reader++ 2/1
TLS| HS.next_fragment returned a fragment; next_keys (for all data); complete
TLS| sendHandshake
TLS| send Handshake fragment with index ID13
TLS| Encrypting with key 69f6af0139546ea0b89bdc1c8b3d0f591793eb7615d2a8e7c94fb892c505ea45
TLS| Sending fragment of length 53
REC| record headers: 1703030035
EPO| writer++ 2/2
TLS| read: WrittenHS, Open/Open, new writer: complete
client returns client_complete_early_data clen=84 slen=196
secret=0f926cf5fe522bd1b7ce068d76a1f63fb31d05175ff2da18703eecb160e07b0f
(Finished) [  84] ---->

TLS| writeHandshake (encrypted)
TLS| HS.next_fragment ID13?
HS | next_fragment
TLS| HS.next_fragment returned nothing
TLS| sendHandshake
TLS| read: WrittenHS, Ctrl/Open, nothing
TLS| Read fragment at epoch index: 0 of length 21
TLS| StAE decrypt correct.
TLS| read Handshake fragment
HS | recv_fragment
HSL| parsed EndOfEarlyData
HSL| end of flight
HS | Process EOED (increment reader to HS key)
EPO| reader++ 1/2
TLS| readOne ReadAgain
TLS| writeHandshake (encrypted)
TLS| HS.next_fragment ID13?
HS | next_fragment
TLS| HS.next_fragment returned nothing
TLS| sendHandshake
TLS| read: WrittenHS, Ctrl/Open, nothing
TLS| Read fragment at epoch index: 1 of length 53
TLS| StAE decrypt correct.
TLS| read Handshake fragment
HS | recv_fragment
HSL| parsed Finished
HSL| end of flight
HS | Process Client Finished
KS | ks_server_13_cf hashed_log = bd3d03cfbf41daa39e7327b50dd6a673bec5b5d8005b3a25c356a59ed12f6235
KS | resumption master secret:        ea6d5ea56fd0de10894f907a255a144fd3f7b0fe26f729aa690cca71abf75aa2
HS | Sending ticket: 40bd6c94d3fe70855b436caf842b43d9343dfc1fcdcc101134d7446730d9178e868491817488ceea688b34ef7d04e85b5de43ce3f996985b27facedbc739cc8602d9259dded0939dc6b71ace
HSL| emit NewSessionTicket13
EPO| reader++ 2/2
TLS| readOne Complete
server returns clen=84 slen=0 status=server_complete
TLS| writeHandshake (encrypted)
TLS| HS.next_fragment ID13?
HS | next_fragment
TLS| HS.next_fragment returned a fragment
TLS| sendHandshake
TLS| send Handshake fragment with index ID13
TLS| Encrypting with key 7672fd810e7fe133d3654783107743e73ff2a114e4b8684f15d7313fdc0d18e3
TLS| Sending fragment of length 130
REC| record headers: 1703030082
TLS| writeHandshake (encrypted)
TLS| HS.next_fragment ID13?
HS | next_fragment
TLS| HS.next_fragment returned nothing
TLS| sendHandshake
TLS| read: WrittenHS, Open/Open, nothing
REC| WouldBlock
TLS| readOne ReadWouldBlock
server returns would_block clen=0 slen=135
<---- {Ticket}[ 135]
TLS| writeHandshake (encrypted)
TLS| HS.next_fragment ID13?
HS | next_fragment
TLS| HS.next_fragment returned nothing
TLS| sendHandshake
TLS| read: WrittenHS, Open/Open, nothing
TLS| Read fragment at epoch index: 2 of length 130
TLS| StAE decrypt correct.
TLS| read Handshake fragment
HS | recv_fragment
HSL| parsed NewSessionTicket13
HSL| end of flight
HS | Received ticket: 40bd6c94d3fe70855b436caf842b43d9343dfc1fcdcc101134d7446730d9178e868491817488ceea688b34ef7d04e85b5de43ce3f996985b27facedbc739cc8602d9259dded0939dc6b71ace
KS | ks_client_13_rms
KS | Recall RMS: ea6d5ea56fd0de10894f907a255a144fd3f7b0fe26f729aa690cca71abf75aa2

##### New session ticket received! #####
Host: localhost
Ticket:
40bd6c94d3fe70855b436caf842b43d9343dfc1fcdcc101134d7446730d9178e
868491817488ceea688b34ef7d04e85b5de43ce3f996985b27facedbc739cc86
02d9259dded0939dc6b71ace
########################################
TLS| readOne ReadAgain
TLS| writeHandshake (encrypted)
TLS| HS.next_fragment ID13?
HS | next_fragment
TLS| HS.next_fragment returned nothing
TLS| sendHandshake
TLS| read: WrittenHS, Open/Open, nothing
REC| WouldBlock
TLS| readOne ReadWouldBlock
client returns clen=0 slen=135 status=would_block
Ok
./quic.exe hrr

STATELESS RETRY TEST

server create
FFI| offering custom extension 001a
FFI| extension contents: ffff00050a0b0c0d0e
FFI| setting early data limit to ffffffff
FFI| Setting a new ticket callback.
FFI| Setting a new server negotiation callback.
FFI| Setting up certificate callbacks.
client create
FFI| offering custom extension 001a
FFI| extension contents: ffff00050a0b0c0d0e
FFI| setting early data limit to ffffffff
FFI| Setting a new ticket callback.
FFI| Setting a new server negotiation callback.
FFI| Setting up certificate callbacks.
TLS| writeHandshake (plaintext)
TLS| HS.next_fragment PlaintextID?
HS | next_fragment
HS | offering ClientHello 1.3
KS | ks_client_init 1.3
CDH| Keygen (initiator) on X255519
NGO| No PSK or 0-RTT disabled
NGO| offering client extensions [ 001a supported_versions key_share server_name alpn extended_master_secret signature_algorithms supported_groups psk_key_exchange_modes ]
NGO| offering cipher suites ; TLS_CHACHA20_POLY1305_SHA256; TLS_AES_128_GCM_SHA256
HSL| emit ClientHello
TLS| HS.next_fragment returned a fragment
TLS| sendHandshake
TLS| send Handshake fragment with index PlaintextID
TLS| Sending fragment of length 170
REC| record headers: 16030300aa
TLS| writeHandshake (plaintext)
TLS| HS.next_fragment PlaintextID?
HS | next_fragment
TLS| HS.next_fragment returned nothing
TLS| sendHandshake
TLS| read: WrittenHS, Ctrl/Ctrl, nothing
REC| WouldBlock
TLS| readOne ReadWouldBlock
client returns would_block clen=175 slen=0
ClientHello[ 175] ---->

~~~~~~~~~ Client Hello Summary ~~~~~~~~~~~
~ SNI = localhost
~ ALPN = 00060568712d3130
~ Cookie = NULL
~ Extensions = 0079001a0009ffff00050a0b0c0d0e002b0003027f1c003300260024001d0020
55852ee73acf9b1c634f8c6e4e68c4fd639689b779c977afe67e53b6a6ad0836
0000000e000c0000096c6f63616c686f73740010000800060568712d31300017
0000000d0006000408040403000a00040002001d002d0003020001
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
TLS| writeHandshake (plaintext)
TLS| HS.next_fragment PlaintextID?
HS | next_fragment
TLS| HS.next_fragment returned nothing
TLS| sendHandshake
TLS| read: WrittenHS, Ctrl/Ctrl, nothing
TLS| Read fragment at epoch index: -1 of length 170
TLS| read Handshake fragment
HS | recv_fragment
HSL| parsed [ClientHello] -- end of flight 
HS | Processing ClientHello
NGO| offered client extensions [ 001a supported_versions key_share server_name alpn extended_master_secret signature_algorithms supported_groups psk_key_exchange_modes ]
NGO| offered cipher suites ; TLS_CHACHA20_POLY1305_SHA256; TLS_AES_128_GCM_SHA256
NGO| offered versions 1.3
NGO| Negotiated Pure EDH key exchange
NGO| Negotiated ECDSA_SECP256R1_SHA256
NGO| Negotiation callback to handle extra extensions and query for stateless retry.
NGO| Application data in cookie: none
@@@@ Nego callback for TLS 1.3 @@@@
Offered extensions:
003d001a0009ffff00050a0b0c0d0e0000000e000c0000096c6f63616c686f73
740010000800060568712d3130000d0006000408040403000a00040002001d
Transport parameters offered:
ffff00050a0b0c0d0e
No application cookie (fist connection).
Adding server transport parameters:
000102
@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
AEP| LowProvider: COERCE(K=d1914808a55bf8e240620d1e7053df83e842a69c8b6aad43a59addc68a40816b)
TCK| Encrypting cookie: 0000320200002e0303cf21ad74e59a6111be1d8c021e65b891c2a211167abb8c5e079e09e2c8a8339c001303000006002b00027f1c207c2c370bc1cae59db231a9146840170d548e425d111574eef1523cbeb851418f000b48656c6c6f20576f726c64
TCK| Encrypted cookie:  4e4820c56c952069e8c8ba435fadc414cea30e5f93de0443c4585eb90f57ac689750a417db1b2939a5bef347d8f0e91eae750d262ca3522af128cc5670b3ffca5722009c759930a0ebf65bec2f52708a8b608a382588a00ea734c2b0a9ef5522f5f10c5791893fbf88b7657f30ea5810043dead80fbd79f13ed2d9e3b5fa97
HSL| emit HelloRetryRequest
TLS| readOne ReadAgain
TLS| writeHandshake (plaintext)
TLS| HS.next_fragment PlaintextID?
HS | next_fragment
TLS| HS.next_fragment returned a fragment
TLS| sendHandshake
TLS| send Handshake fragment with index PlaintextID
TLS| Sending fragment of length 183
REC| record headers: 16030300b7
TLS| writeHandshake (plaintext)
TLS| HS.next_fragment PlaintextID?
HS | next_fragment
TLS| HS.next_fragment returned nothing
TLS| sendHandshake
TLS| read: WrittenHS, Ctrl/Ctrl, nothing
REC| WouldBlock
TLS| readOne ReadWouldBlock
server returns server_stateless_retry clen=175 slen=188
<---- HRR[ 188]

server re-create
FFI| offering custom extension 001a
FFI| extension contents: ffff00050a0b0c0d0e
FFI| setting early data limit to ffffffff
FFI| Setting a new ticket callback.
FFI| Setting a new server negotiation callback.
FFI| Setting up certificate callbacks.
TLS| writeHandshake (plaintext)
TLS| HS.next_fragment PlaintextID?
HS | next_fragment
TLS| HS.next_fragment returned nothing
TLS| sendHandshake
TLS| read: WrittenHS, Ctrl/Ctrl, nothing
TLS| Read fragment at epoch index: -1 of length 183
TLS| read Handshake fragment
HS | recv_fragment
HSL| parsed HelloRetryRequest
