This is /home/everbld/everest-ci/ci
Working directory: /cygdrive/c/build/agent2/_work/6/s
About to run: ./everest --yes -j 16 test
BUILD_SOURCEBRANCHNAME: quic2c
BUILD_DEFINITIONNAME: Everest-CI-Windows
BUILD_BUILDID: 20013
DEFINITIONNAME:
Z3 is /home/everbld/everest/z3-4.5.1.1f29cebd4df6-x64-win/bin/z3
# Switching to the everest directory ... now in /cygdrive/c/build/agent2/_work/6/s

exported FSTAR_HOME=C:/build/agent2/_work/6/s/FStar
exported OPENSSL_HOME=C:/build/agent2/_work/6/s/MLCrypto/openssl
exported KREMLIN_HOME=C:/build/agent2/_work/6/s/kremlin
exported VALE_HOME=C:/build/agent2/_work/6/s/vale
exported HACL_HOME=C:/build/agent2/_work/6/s/hacl-star
exported MLCRYPTO_HOME=C:/build/agent2/_work/6/s/MLCrypto
exported PATH=/cygdrive/c/build/agent2/_work/6/s/MLCrypto/openssl:/cygdrive/c/build/agent2/_work/6/s/FStar/bin:/cygdrive/c/build/agent2/_work/6/s/kremlin:/home/everbld/.opam/4.05.0+mingw64c/bin:/cygdrive/c/Windows/Microsoft.NET/Framework64/v4.0.30319/:/home/everbld/everest/nuget/bin:/home/everbld/everest/z3-4.5.1.1f29cebd4df6-x64-win/bin:/cygdrive/c/PROGRA~2/MICROS~1.0/VC/bin/amd64:/cygdrive/c/PROGRA~2/MICROS~1.0/VC/bin:/cygdrive/c/PROGRA~2/MICROS~4/F#/4.0/FRAMEW~1/v4.0/:/usr/x86_64-w64-mingw32/sys-root/mingw/bin:/usr/local/bin:/usr/bin:/cygdrive/c/build/agent2/externals/git/cmd:/cygdrive/c/Python36/Scripts:/cygdrive/c/Python36:/cygdrive/c/Docker/Resources/bin:/cygdrive/c/windows/system32:/cygdrive/c/windows:/cygdrive/c/windows/System32/Wbem:/cygdrive/c/windows/System32/WindowsPowerShell/v1.0:/cygdrive/c/Users/everbld/AppData/Local/Microsoft/WindowsApps:/cygdrive/c/Program Files/Docker/Docker/resources/bin:%USERPROFILE%/.dnx/bin:/cygdrive/c/Program Files/Microsoft DNX/Dnvm:/cygdrive/c/Program Files/Microsoft SQL Server/120/Tools/Binn:/cygdrive/c/Program Files/Microsoft SQL Server/130/Tools/Binn:/cygdrive/c/Program Files/dotnet:/cygdrive/c/Program Files/nodejs:/usr/bin:/cygdrive/c/Program Files/Git/mingw64/bin:/cygdrive/c/Users/everbld/AppData/Roaming/npm:/cygdrive/c/build/agent2/bin:/cygdrive/c/build/agent2/bin
+ hacl-star/secure_api/out/vale_aes_concrete_id/krml-test.exe
================================================================================
Running tests (commands shown below)
test()
[test] expected output cipher is d31a8d34648e60db7b86afbc53ef7ec2a4aded51296e08fea9e2b5a736ee62d63dbea45e8ca9671282fafb69da92728b1a71de0a9e060b2905d6a5b67ecd3b3692ddbd7f2d778b8c9803aee328091b58fab324e4fad675945585808b4831d7bc3ff4def08e4b7a9de576d26586cec64b61161ae10b594f09e26a7e902ecbd0600691
+ hacl-star/secure_api/out/hacl_aes_concrete_id/krml-test.exe
[test] computed output cipher is d31a8d34648e60db7b86afbc53ef7ec2a4aded51296e08fea9e2b5a736ee62d63dbea45e8ca9671282fafb69da92728b1a71de0a9e060b2905d6a5b67ecd3b3692ddbd7f2d778b8c9803aee328091b58fab324e4fad675945585808b4831d7bc3ff4def08e4b7a9de576d26586cec64b61161ae10b594f09e26a7e902ecbd0600691
[test] cipher is a success
[test] expected output decryption is 4c616469657320616e642047656e746c656d656e206f662074686520636c617373206f66202739393a204966204920636f756c64206f6666657220796f75206f6e6c79206f6e652074697020666f7220746865206675747572652c2073756e73637265656e20776f756c642062652069742e
[test] computed output decryption is 4c616469657320616e642047656e746c656d656e206f662074686520636c617373206f66202739393a204966204920636f756c64206f6666657220796f75206f6e6c79206f6e652074697020666f7220746865206675747572652c2073756e73637265656e20776f756c642062652069742e
[test] decryption is a success
test_aes_gcm_0()
[test] expected output cipher is 58e2fccefa7e3061367f1d57a4e7455a
[test] computed output cipher is 58e2fccefa7e3061367f1d57a4e7455a
[test] cipher is a success
[test] expected output decryption is 
[test] computed output decryption is 
+ make -C hacl-star/secure_api -f Makefile.extract test
[test] decryption is a success
test_aes_gcm_1()
[test] expected output cipher is 530f8afbc74536b9a963b4f1c4cb738b
[test] computed output cipher is 530f8afbc74536b9a963b4f1c4cb738b
[test] cipher is a success
[test] expected output decryption is 
[test] computed output decryption is 
[test] decryption is a success
test_aes_gcm_2()
[test] expected output cipher is cea7403d4d606b6e074ec5d3baf39d18d0d1c8a799996bf0265b98b5d48ab919
[test] computed output cipher is cea7403d4d606b6e074ec5d3baf39d18d0d1c8a799996bf0265b98b5d48ab919
[test] cipher is a success
[test] expected output decryption is 00000000000000000000000000000000
[test] computed output decryption is 00000000000000000000000000000000
[test] decryption is a success
test_aes_gcm_3()
[test] expected output cipher is 522dc1f099567d07f47f37a32a84427d643a8cdcbfe5c0c97598a2bd2555d1aa8cb08e48590dbb3da7b08b1056828838c5f61e6393ba7a0abcc9f662898015adb094dac5d93471bdec1a502270e3cc6c
[test] computed output cipher is 522dc1f099567d07f47f37a32a84427d643a8cdcbfe5c0c97598a2bd2555d1aa8cb08e48590dbb3da7b08b1056828838c5f61e6393ba7a0abcc9f662898015adb094dac5d93471bdec1a502270e3cc6c
[test] cipher is a success
[test] expected output decryption is d9313225f88406e5a55909c5aff5269a86a7a9531534f7da2e4c303d8a318a721c3c0c95956809532fcf0e2449a6b525b16aedf5aa0de657ba637b391aafd255
[test] computed output decryption is d9313225f88406e5a55909c5aff5269a86a7a9531534f7da2e4c303d8a318a721c3c0c95956809532fcf0e2449a6b525b16aedf5aa0de657ba637b391aafd255
[test] decryption is a success
test_aes_gcm_4()
[test] expected output cipher is 522dc1f099567d07f47f37a32a84427d643a8cdcbfe5c0c97598a2bd2555d1aa8cb08e48590dbb3da7b08b1056828838c5f61e6393ba7a0abcc9f66276fc6ece0f4e1768cddf8853bb2d551b
[test] computed output cipher is 522dc1f099567d07f47f37a32a84427d643a8cdcbfe5c0c97598a2bd2555d1aa8cb08e48590dbb3da7b08b1056828838c5f61e6393ba7a0abcc9f66276fc6ece0f4e1768cddf8853bb2d551b
[test] cipher is a success
[test] expected output decryption is d9313225f88406e5a55909c5aff5269a86a7a9531534f7da2e4c303d8a318a721c3c0c95956809532fcf0e2449a6b525b16aedf5aa0de657ba637b39
[test] computed output decryption is d9313225f88406e5a55909c5aff5269a86a7a9531534f7da2e4c303d8a318a721c3c0c95956809532fcf0e2449a6b525b16aedf5aa0de657ba637b39
[test] decryption is a success
test()
[test] expected output cipher is d31a8d34648e60db7b86afbc53ef7ec2a4aded51296e08fea9e2b5a736ee62d63dbea45e8ca9671282fafb69da92728b1a71de0a9e060b2905d6a5b67ecd3b3692ddbd7f2d778b8c9803aee328091b58fab324e4fad675945585808b4831d7bc3ff4def08e4b7a9de576d26586cec64b61161ae10b594f09e26a7e902ecbd0600691
[test] computed output cipher is d31a8d34648e60db7b86afbc53ef7ec2a4aded51296e08fea9e2b5a736ee62d63dbea45e8ca9671282fafb69da92728b1a71de0a9e060b2905d6a5b67ecd3b3692ddbd7f2d778b8c9803aee328091b58fab324e4fad675945585808b4831d7bc3ff4def08e4b7a9de576d26586cec64b61161ae10b594f09e26a7e902ecbd0600691
[test] cipher is a success
[test] expected output decryption is 4c616469657320616e642047656e746c656d656e206f662074686520636c617373206f66202739393a204966204920636f756c64206f6666657220796f75206f6e6c79206f6e652074697020666f7220746865206675747572652c2073756e73637265656e20776f756c642062652069742e
[test] computed output decryption is 4c616469657320616e642047656e746c656d656e206f662074686520636c617373206f66202739393a204966204920636f756c64206f6666657220796f75206f6e6c79206f6e652074697020666f7220746865206675747572652c2073756e73637265656e20776f756c642062652069742e
[test] decryption is a success
test_aes_gcm_0()
[test] expected output cipher is 58e2fccefa7e3061367f1d57a4e7455a
[test] computed output cipher is 58e2fccefa7e3061367f1d57a4e7455a
[test] cipher is a success
[test] expected output decryption is 
[test] computed output decryption is 
[test] decryption is a success
test_aes_gcm_1()
[test] expected output cipher is 530f8afbc74536b9a963b4f1c4cb738b
[test] computed output cipher is 530f8afbc74536b9a963b4f1c4cb738b
[test] cipher is a success
[test] expected output decryption is 
[test] computed output decryption is 
[test] decryption is a success
test_aes_gcm_2()
[test] expected output cipher is cea7403d4d606b6e074ec5d3baf39d18d0d1c8a799996bf0265b98b5d48ab919
[test] computed output cipher is cea7403d4d606b6e074ec5d3baf39d18d0d1c8a799996bf0265b98b5d48ab919
[test] cipher is a success
[test] expected output decryption is 00000000000000000000000000000000
[test] computed output decryption is 00000000000000000000000000000000
[test] decryption is a success
test_aes_gcm_3()
[test] expected output cipher is 522dc1f099567d07f47f37a32a84427d643a8cdcbfe5c0c97598a2bd2555d1aa8cb08e48590dbb3da7b08b1056828838c5f61e6393ba7a0abcc9f662898015adb094dac5d93471bdec1a502270e3cc6c
[test] computed output cipher is 522dc1f099567d07f47f37a32a84427d643a8cdcbfe5c0c97598a2bd2555d1aa8cb08e48590dbb3da7b08b1056828838c5f61e6393ba7a0abcc9f662898015adb094dac5d93471bdec1a502270e3cc6c
[test] cipher is a success
[test] expected output decryption is d9313225f88406e5a55909c5aff5269a86a7a9531534f7da2e4c303d8a318a721c3c0c95956809532fcf0e2449a6b525b16aedf5aa0de657ba637b391aafd255
[test] computed output decryption is d9313225f88406e5a55909c5aff5269a86a7a9531534f7da2e4c303d8a318a721c3c0c95956809532fcf0e2449a6b525b16aedf5aa0de657ba637b391aafd255
[test] decryption is a success
test_aes_gcm_4()
[test] expected output cipher is 522dc1f099567d07f47f37a32a84427d643a8cdcbfe5c0c97598a2bd2555d1aa8cb08e48590dbb3da7b08b1056828838c5f61e6393ba7a0abcc9f66276fc6ece0f4e1768cddf8853bb2d551b
[test] computed output cipher is 522dc1f099567d07f47f37a32a84427d643a8cdcbfe5c0c97598a2bd2555d1aa8cb08e48590dbb3da7b08b1056828838c5f61e6393ba7a0abcc9f66276fc6ece0f4e1768cddf8853bb2d551b
[test] cipher is a success
[test] expected output decryption is d9313225f88406e5a55909c5aff5269a86a7a9531534f7da2e4c303d8a318a721c3c0c95956809532fcf0e2449a6b525b16aedf5aa0de657ba637b39
[test] computed output decryption is d9313225f88406e5a55909c5aff5269a86a7a9531534f7da2e4c303d8a318a721c3c0c95956809532fcf0e2449a6b525b16aedf5aa0de657ba637b39
[test] decryption is a success
make: Entering directory '/cygdrive/c/build/agent2/_work/6/s/hacl-star/secure_api'
./../secure_api/out/runtime_switch/krml-test.exe
test()
[test] expected output cipher is d31a8d34648e60db7b86afbc53ef7ec2a4aded51296e08fea9e2b5a736ee62d63dbea45e8ca9671282fafb69da92728b1a71de0a9e060b2905d6a5b67ecd3b3692ddbd7f2d778b8c9803aee328091b58fab324e4fad675945585808b4831d7bc3ff4def08e4b7a9de576d26586cec64b61161ae10b594f09e26a7e902ecbd0600691
[test] computed output cipher is d31a8d34648e60db7b86afbc53ef7ec2a4aded51296e08fea9e2b5a736ee62d63dbea45e8ca9671282fafb69da92728b1a71de0a9e060b2905d6a5b67ecd3b3692ddbd7f2d778b8c9803aee328091b58fab324e4fad675945585808b4831d7bc3ff4def08e4b7a9de576d26586cec64b61161ae10b594f09e26a7e902ecbd0600691
[test] cipher is a success
[test] expected output decryption is 4c616469657320616e642047656e746c656d656e206f662074686520636c617373206f66202739393a204966204920636f756c64206f6666657220796f75206f6e6c79206f6e652074697020666f7220746865206675747572652c2073756e73637265656e20776f756c642062652069742e
[test] computed output decryption is 4c616469657320616e642047656e746c656d656e206f662074686520636c617373206f66202739393a204966204920636f756c64206f6666657220796f75206f6e6c79206f6e652074697020666f7220746865206675747572652c2073756e73637265656e20776f756c642062652069742e
[test] decryption is a success
test_aes_gcm_0()
[test] expected output cipher is 58e2fccefa7e3061367f1d57a4e7455a
[test] computed output cipher is 58e2fccefa7e3061367f1d57a4e7455a
[test] cipher is a success
[test] expected output decryption is 
[test] computed output decryption is 
[test] decryption is a success
test_aes_gcm_1()
[test] expected output cipher is 530f8afbc74536b9a963b4f1c4cb738b
[test] computed output cipher is 530f8afbc74536b9a963b4f1c4cb738b
[test] cipher is a success
[test] expected output decryption is 
[test] computed output decryption is 
[test] decryption is a success
test_aes_gcm_2()
[test] expected output cipher is cea7403d4d606b6e074ec5d3baf39d18d0d1c8a799996bf0265b98b5d48ab919
[test] computed output cipher is cea7403d4d606b6e074ec5d3baf39d18d0d1c8a799996bf0265b98b5d48ab919
[test] cipher is a success
[test] expected output decryption is 00000000000000000000000000000000
[test] computed output decryption is 00000000000000000000000000000000
[test] decryption is a success
test_aes_gcm_3()
[test] expected output cipher is 522dc1f099567d07f47f37a32a84427d643a8cdcbfe5c0c97598a2bd2555d1aa8cb08e48590dbb3da7b08b1056828838c5f61e6393ba7a0abcc9f662898015adb094dac5d93471bdec1a502270e3cc6c
[test] computed output cipher is 522dc1f099567d07f47f37a32a84427d643a8cdcbfe5c0c97598a2bd2555d1aa8cb08e48590dbb3da7b08b1056828838c5f61e6393ba7a0abcc9f662898015adb094dac5d93471bdec1a502270e3cc6c
[test] cipher is a success
[test] expected output decryption is d9313225f88406e5a55909c5aff5269a86a7a9531534f7da2e4c303d8a318a721c3c0c95956809532fcf0e2449a6b525b16aedf5aa0de657ba637b391aafd255
[test] computed output decryption is d9313225f88406e5a55909c5aff5269a86a7a9531534f7da2e4c303d8a318a721c3c0c95956809532fcf0e2449a6b525b16aedf5aa0de657ba637b391aafd255
[test] decryption is a success
test_aes_gcm_4()
[test] expected output cipher is 522dc1f099567d07f47f37a32a84427d643a8cdcbfe5c0c97598a2bd2555d1aa8cb08e48590dbb3da7b08b1056828838c5f61e6393ba7a0abcc9f66276fc6ece0f4e1768cddf8853bb2d551b
[test] computed output cipher is 522dc1f099567d07f47f37a32a84427d643a8cdcbfe5c0c97598a2bd2555d1aa8cb08e48590dbb3da7b08b1056828838c5f61e6393ba7a0abcc9f66276fc6ece0f4e1768cddf8853bb2d551b
[test] cipher is a success
[test] expected output decryption is d9313225f88406e5a55909c5aff5269a86a7a9531534f7da2e4c303d8a318a721c3c0c95956809532fcf0e2449a6b525b16aedf5aa0de657ba637b39
[test] computed output decryption is d9313225f88406e5a55909c5aff5269a86a7a9531534f7da2e4c303d8a318a721c3c0c95956809532fcf0e2449a6b525b16aedf5aa0de657ba637b39
[test] decryption is a success
make -C C:/build/agent2/_work/6/s/MLCrypto
make[1]: Entering directory '/cygdrive/c/build/agent2/_work/6/s/MLCrypto'
make[1]: Nothing to be done for 'all'.
make[1]: Leaving directory '/cygdrive/c/build/agent2/_work/6/s/MLCrypto'
OCAMLPATH="C:/build/agent2/_work/6/s/FStar/bin" ocamlfind opt -package fstarlib,zarith -g -I C:/build/agent2/_work/6/s/FStar/ulib/ml -c LowCProvider/LowCProvider.ml -I LowCProvider -I ../secure_api/out/runtime_switch -I ../secure_api/out/runtime_switch/extracted -I C:/build/agent2/_work/6/s/MLCrypto -o LowCProvider/LowCProvider.cmx
OCAMLPATH="C:/build/agent2/_work/6/s/FStar/bin" ocamlfind mklib -package fstarlib,zarith -g -I C:/build/agent2/_work/6/s/FStar/ulib/ml -I ../secure_api/out/runtime_switch/extracted ../secure_api/out/runtime_switch/uint128/uint128_wrapper.o LowCProvider/LowCProvider.cmx LowCProvider/HaclProvider.cmx LowCProvider/lowc_stub.o ../secure_api/out/runtime_switch/crypto/Crypto_AEAD_Main_Crypto_Indexing.o ../secure_api/out/runtime_switch/crypto/Crypto_HKDF_Crypto_HMAC.o ../secure_api/out/runtime_switch/crypto/Crypto_Symmetric_Bytes.o ../code/curve25519/x25519-c/Curve25519.o ../code/curve25519/x25519-c/FStar.o vale/asm/sha256_main_i.o vale/asm/sha256-x86_64.o vale/asm/Vale_Hash_SHA2_256.o vale/asm/vale_aes_glue.o vale/asm/aes-x86_64.o -o ../secure_api/out/runtime_switch/LowC
OCAMLPATH="C:/build/agent2/_work/6/s/FStar/bin" ocamlfind opt -package fstarlib,zarith -g -I C:/build/agent2/_work/6/s/FStar/ulib/ml -c LowCProvider/Tests.ml -I LowCProvider -I ../secure_api/out/runtime_switch -I ../secure_api/out/runtime_switch/extracted -I C:/build/agent2/_work/6/s/MLCrypto -o LowCProvider/Tests.cmx
OCAMLPATH="C:/build/agent2/_work/6/s/FStar/bin" ocamlfind opt -package fstarlib,zarith -g -I C:/build/agent2/_work/6/s/FStar/ulib/ml -I ../secure_api/out/runtime_switch/extracted -I LowCProvider \
-ccopt -L../secure_api/out/runtime_switch -linkpkg ../secure_api/out/runtime_switch/copied/kremstr.o C:/build/agent2/_work/6/s/MLCrypto/CryptoTypes.cmx ../secure_api/out/runtime_switch/LowC.cmxa LowCProvider/Tests.cmx -o ../secure_api/out/runtime_switch/LowCTests.exe
./../secure_api/out/runtime_switch/LowCTests.exe
Tests started
Test 1 OK

Test 2 OK

Test 3 OK

Test 4 OK

Test 5 OK

Test 6 OK

Output cipher:	ed3dc05f9d4877f5db78c69c3a8a3d8e8602646a0b2febe4fca07a426a9ace4163cb26eddbb5b0d5f56d7038512ac73d667397d129c3044e0eb8052e
Output tag:	e6f0c7f7b8920ba02a3942df2b8b2a04
cipher:		AES-128-GCM
key:		"feffe9928665731c6d6a8f9467308308"
iv:		"cafebabefacedbad"
aad:		"feedfacedeadbeeffeedfacedeadbeefabaddad2"
tag:		"3612d2e79e3b0785561be14aaca2fccb"
plaintext:	"d9313225f88406e5a55909c5aff5269a86a7a9531534f7da2e4c303d8a318a721c3c0c95956809532fcf0e2449a6b525b16aedf5aa0de657ba637b39"
ciphertext:	"61353b4c2806934a777ff51fa22a4755699b2a714fcdc6f83766e5f97b6c742373806900e49f24b22b097544d4896b424989b5e1ebac0f07c23f4598"
+ cd mitls-fstar/src/tls

Test 7 failed, but this is expected because |IV| <> 12 bytes and we don't do IV expansion.
+ make -j 16 test
Please disregard.

Output cipher:	8076eba01a51d7702d398c6dc3adaaadfe061c23a7ffc3c4623ea2be7a08d982b8f331d21ac6b8db541df43510561a3fff90b942215b7fb6fbcea43d
Output tag:	1606863da7ad74443b3a89fd2489363d
cipher:		AES-128-GCM
key:		"feffe9928665731c6d6a8f9467308308"
iv:		"9313225df88406e555909c5aff5269aa6a7a9538534f7da1e4c303d2a318a728c3c0c95156809539fcf0e2429a6b525416aedbf5a0de6a57a637b39b"
aad:		"feedfacedeadbeeffeedfacedeadbeefabaddad2"
tag:		"619cc5aefffe0bfa462af43c1699d050"
plaintext:	"d9313225f88406e5a55909c5aff5269a86a7a9531534f7da2e4c303d8a318a721c3c0c95956809532fcf0e2449a6b525b16aedf5aa0de657ba637b39"
ciphertext:	"8ce24998625615b603a033aca13fb894be9112a5c3a211a8ba262a3cca7e2ca701e4a9a4fba43c90ccdcb281d48c7c6fd62875d2aca417034c34aee5"

Test 8 failed, but this is expected because |IV| <> 12 bytes and we don't do IV expansion.
Please disregard.

Test 9 OK

Test 10 OK

Test 11 OK

Test 12 OK

Output cipher:	677a374b4dd797f8ea0252a721fa83784f68c4877cf4e60f8c1f56972e9c20f789efb32096dd6336c6e5ef833b041251fdf04ce41fbcf2fea0d1e83c
Output tag:	91b8ee617f7c50dab5bc75abff3bc1c3
cipher:		AES-256-GCM
key:		"feffe9928665731c6d6a8f9467308308feffe9928665731c6d6a8f9467308308"
iv:		"cafebabefacedbad"
aad:		"feedfacedeadbeeffeedfacedeadbeefabaddad2"
tag:		"3a337dbf46a792c45e454913fe2ea8f2"
plaintext:	"d9313225f88406e5a55909c5aff5269a86a7a9531534f7da2e4c303d8a318a721c3c0c95956809532fcf0e2449a6b525b16aedf5aa0de657ba637b39"
ciphertext:	"c3762df1ca787d32ae47c13bf19844cbaf1ae14d0b976afac52ff7d79bba9de0feb582d33934a4f0954cc2363bc73f7862ac430e64abe499f47c9b1f"

Test 13 failed, but this is expected because |IV| <> 12 bytes and we don't do IV expansion.
Please disregard.

Output cipher:	cf3b9ab7a70a2ac55a7bcf74cda369c5b32e7870a937cb4d7679ef877de6403b7126c8ca2d6c620755e8ff330af0e7fa003585282b2d7a3d8f785bcc
Output tag:	881390e147e8fc6b2923305b6413a594
cipher:		AES-256-GCM
key:		"feffe9928665731c6d6a8f9467308308feffe9928665731c6d6a8f9467308308"
iv:		"9313225df88406e555909c5aff5269aa6a7a9538534f7da1e4c303d2a318a728c3c0c95156809539fcf0e2429a6b525416aedbf5a0de6a57a637b39b"
aad:		"feedfacedeadbeeffeedfacedeadbeefabaddad2"
tag:		"a44a8266ee1c8eb0c8b5d4cf5ae9f19a"
plaintext:	"d9313225f88406e5a55909c5aff5269a86a7a9531534f7da2e4c303d8a318a721c3c0c95956809532fcf0e2449a6b525b16aedf5aa0de657ba637b39"
ciphertext:	"5a8def2f0c9e53f1f75d7853659e2a20eeb2b22aafde6419a058ab4f6f746bf40fc0c3b780f244452da3ebf1c5d82cdea2418997200ef82e44ae7e3f"

Test 14 failed, but this is expected because |IV| <> 12 bytes and we don't do IV expansion.
Please disregard.

Test 15 OK

Test 16 OK

Test 17 OK

Test 18 OK

Output cipher:	eff01b40f151144abb70955cedcbe564afd7d338ce2c3eb2ac13b1228ef785edc5bf4b7501cdc522a855c4e5843a3a0af67e4c8285f641951d9dcb727fb5d53bffe8165999884aa1626b20328a233f189b48820f19d2cf1551f21d0ae749227f1d47344d687533456994f11584dfd15d4791ceedf45f3774821bcd340d4b18ec8ed70e7ce40859ec159363caab3eaa87261cbda3733c01bbd39f03f21d3c4f1b3af2cadd75c67fbe96929c20a13077991908a0d23adbcecd49ed2ed71dd8f659
Output tag:	1f200ef9ef5218a0a69331c8304f873d
cipher:		AES-128-GCM
key:		"00000000000000000000000000000000"
iv:		"ffffffff000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000"
aad:		""
tag:		"566f8ef683078bfdeeffa869d751a017"
plaintext:	"000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000"
ciphertext:	"56b3373ca9ef6e4a2b64fe1e9a17b61425f10d47a75a5fce13efc6bc784af24f4141bdd48cf7c770887afd573cca5418a9aeffcd7c5ceddfc6a78397b9a85b499da558257267caab2ad0b23ca476a53cb17fb41c4b8b475cb4f3f7165094c229c9e8c4dc0a2a5ff1903e501511221376a1cdb8364c5061a20cae74bc4acd76ceb0abc9fd3217ef9f8c90be402ddf6d8697f4f880dff15bfb7a6b28241ec8fe183c2d59e3f9dfff653c7126f0acb9e64211f42bae12af462b1070bef1ab5e3606"

Test 19 failed, but this is expected because |IV| <> 12 bytes and we don't do IV expansion.
Please disregard.

Output cipher:	eff01b40f151144abb70955cedcbe564afd7d338ce2c3eb2ac13b1228ef785edc5bf4b7501cdc522a855c4e5843a3a0af67e4c8285f641951d9dcb727fb5d53bffe8165999884aa1626b20328a233f189b48820f19d2cf1551f21d0ae749227f1d47344d687533456994f11584dfd15d4791ceedf45f3774821bcd340d4b18ec8ed70e7ce40859ec159363caab3eaa87261cbda3733c01bbd39f03f21d3c4f1b3af2cadd75c67fbe96929c20a13077991908a0d23adbcecd49ed2ed71dd8f65954f4ff316fe216dd9e29b1ea55824efb884af85d0e6743d586acfc3088f200284dcb744dcf6fe40745827d98067e32af9b279d8f8354d7e47b8bb6736de3b66479f0d1ee5cb7796d966955cc6dea4ae5e4205b07040a0d9ec6594c2c6d2350a4
Output tag:	99b156f6881899ee456476976e9f5414
cipher:		AES-128-GCM
key:		"00000000000000000000000000000000"
iv:		"ffffffff000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000"
aad:		""
tag:		"8b307f6b33286d0ab026a9ed3fe1e85f"
plaintext:	"000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000"
ciphertext:	"56b3373ca9ef6e4a2b64fe1e9a17b61425f10d47a75a5fce13efc6bc784af24f4141bdd48cf7c770887afd573cca5418a9aeffcd7c5ceddfc6a78397b9a85b499da558257267caab2ad0b23ca476a53cb17fb41c4b8b475cb4f3f7165094c229c9e8c4dc0a2a5ff1903e501511221376a1cdb8364c5061a20cae74bc4acd76ceb0abc9fd3217ef9f8c90be402ddf6d8697f4f880dff15bfb7a6b28241ec8fe183c2d59e3f9dfff653c7126f0acb9e64211f42bae12af462b1070bef1ab5e3606872ca10dee15b3249b1a1b958f23134c4bccb7d03200bce420a2f8eb66dcf3644d1423c1b5699003c13ecef4bf38a3b60eedc34033bac1902783dc6d89e2e774188a439c7ebcc0672dbda4ddcfb2794613b0be41315ef778708a70ee7d75165c"

Test 20 failed, but this is expected because |IV| <> 12 bytes and we don't do IV expansion.
Please disregard.

Test 21 OK

AEAD: 21/21 tests passed
./../secure_api/out/runtime_switch/quicprovider-test.exe
==== coverage ====
SHA256('') =
e3b0c44298fc1c149afbf4c8996fb92427ae41e4649b934ca495991b7852b855

SHA384('') = 
38b060a751ac96384cd9327eb1b1e36a21fdb71114be07434c0cc7bf63f6e1da
274edebfe76f65fbd51ad2f14898b95b

SHA512('') = 
cf83e1357eefb8bdf1542850d66d8007d620e4050b5715dc83f4a921d36ce9ce
47d0d13c5d85f2b0ff8318d2877eec2f63b931bd47417a81a538327af927da3e

HMAC-SHA256('Jefe', 'what do ya want for nothing?') = 
5bdcc146bf60754e6a042426089575c75a003f089d2739839dec58b964ec3843

HMAC-SHA384('Jefe', 'what do ya want for nothing?') = 
af45d2e376484031617f78d2b58a6b1b9c7ef464f5a01b47e42ec3736322445e
8e2240ca5e69e2c78b3239ecfab21649

HMAC-SHA512('Jefe', 'what do ya want for nothing?') = 
164b7a7bfcf819e2e395fbe73b56e0a387bd64222e831fd610270cd7ea250554
9758bf75c05a994a6d034f65f8f0e6fdcaeab1a34d4a6b4b636e070a38bce737

prk = HKDF-EXTRACT-SHA256('0x000102030405060708090a0b0c', '0x0b0b0b0b0b0b0b0b0b0b0b0b0b0b0b0b0b0b0b0b0b0b')
077709362c2e32df0ddc3f0dc47bba6390b6c73bb50f9c3122ec844ad7c2b3e5
077709362c2e32df0ddc3f0dc47bba6390b6c73bb50f9c3122ec844ad7c2b3e5

okm = HKDF-EXPAND-SHA256(prk, '0xf0f1f2f3f4f5f6f7f8f9', 42)
3cb25f25faacd57a90434f64d0362f2a2d2d0a90cf1a5a4c5db02d56ecc4c5bf
34007208d5b887185865

AES-128-GCM encrypt test:
5936f46d6c7eb7008dbbfb0d40b491fce5328aedcbc0c5272457d347363fd36d
f238bd17971e982f4449350d
DECRYPT SUCCES: 
7768617420646f2079612077616e7420666f72206e6f7468696e673f

CHACHA20-POLY1305 encrypt test:
a62fe99f3d6001a4f4214a986f04b1f42ea1e5dcea3236ecf35adb5d8cc57db2
df5e18b278c8c904fcddf440
DECRYPT SUCCES: 
7768617420646f2079612077616e7420666f72206e6f7468696e673f
==== PASS:  coverage ====


==== test_crypto(TLS_hash_SHA256,TLS_aead_AES_128_GCM) ====
PASS
==== test_crypto(TLS_hash_SHA384,TLS_aead_AES_128_GCM) ====
PASS
==== test_crypto(TLS_hash_SHA512,TLS_aead_AES_128_GCM) ====
PASS
==== test_crypto(TLS_hash_SHA256,TLS_aead_AES_256_GCM) ====
PASS
==== test_crypto(TLS_hash_SHA384,TLS_aead_AES_256_GCM) ====
PASS
==== test_crypto(TLS_hash_SHA512,TLS_aead_AES_256_GCM) ====
PASS
==== test_crypto(TLS_hash_SHA256,TLS_aead_CHACHA20_POLY1305) ====
PASS
==== test_crypto(TLS_hash_SHA384,TLS_aead_CHACHA20_POLY1305) ====
PASS
==== test_crypto(TLS_hash_SHA512,TLS_aead_CHACHA20_POLY1305) ====
PASS
==== test_handshake_secrets() ====
==== PASS: test_handshake_secrets ==== 
==== ALL TESTS PASS ====
make: Leaving directory '/cygdrive/c/build/agent2/_work/6/s/hacl-star/secure_api'
rm -f cache/OCaml/.depend cache/Kremlin/.depend cache/Model/.depend
make -f Makefile.Kremlin test
make -f Makefile.OCaml test
make -C ../../apps/quicMinusNet test -k
make[1]: Entering directory '/cygdrive/c/build/agent2/_work/6/s/mitls-fstar/apps/quicMinusNet'
./quic.exe
server create
client create
client call clen=8192 slen=   0
client done clen= 175 slen=   0 status=would_block
16030300aa010000a603035ae7818ed47121f3c5dc5ab46213d06e1ab6d6ce3c
92c0b3ef5f69b401ca1f210000041303130101000079001a0009ffff00050a0b
0c0d0e002b0003027f1c003300260024001d0020114569b7637978a541328870
fbdfc9a625cce18f19fadae13a810a7e4b36ad320000000e000c0000096c6f63
616c686f73740010000800060568712d303800170000000d0006000408040403
000a00040002001d002d0003020001
server call clen= 175 slen=8192
@@@@ Nego callback for TLS 1.3 @@@@
Offered extensions:
003d001a0009ffff00050a0b0c0d0e0000000e000c0000096c6f63616c686f73
740010000800060568712d3038000d0006000408040403000a00040002001d
Transport parameters offered:
ffff00050a0b0c0d0e
No application cookie (fist connection).
Adding server transport parameters:
000102
@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
======== TO BE SIGNED <0403>: (130 octets) ========
2020202020202020202020202020202020202020202020202020202020202020
2020202020202020202020202020202020202020202020202020202020202020
544c5320312e332c207365727665722043657274696669636174655665726966
790055d7aead94ebb1c8ea10c6fa8e198299cc73fc0204a6ba9e0aa92aad4bd7
f84b
===================================================
sender done clen= 175 slen= 834 status=server_accept
160303005a0200005603035ae7818e8dff5c74dca941aa45def4e9174889a51d
25017ccc8c8212dd7095f200130300002e002b00027f1c00330024001d0020f7
023f8d3d14e4a345cab974ca8d9262dca43046e913bc6c7018c0a2984f9b1117
030302dea77c0728d046796f468205911b17656a49ab9e201eed765455fb5fbf
184208d1a7eed2d8f71d96a23dbcf4f4fa25ffb560144b07256b5f6bb8461322
6039b4fb3d26616d406beb76f61fdfb360d40f6fc5d397510ceb682dd918d5d9
3ead4c8d5b2e5cfde39b2382759664dd7aedc12c5d1a3fd0f0dbc7d3d7922cd5
b30ea9a8b56265c9122e95829cba1a0dc7441364555973c759ccb341ee81e74d
2d2c2b6a3925fcc15db330ae1be93b10a2945dca07d70022ccdcdf16abd425a6
b4aab8450b87d903a482397c91a9c8346edb0ef9219c06d6413e859215fff85d
beda980863443fa0ecadb5bde65e630e2a576c3fb2b907382f665c4c23233c91
858b0492c3a263d35b44e7d006ab45d667b03ddf756213cae0bd54aeedb9f0f5
ac7a36707cfdf6f49c57dcf07bbebbe43f69c90cdd57f1a9a4a591d10034b76e
e44f7cae586f42acf7775a2e30520dec0e9e70a2d6092656ce1d5696ba1119a5
4567eef4a64ab716ff2c1a63395fe31e6d83af90fe6c256487dabb969b0f9de2
89e4b1028ada6610af1cc31adb3f4e9303cd6e041261c61342cadfde45ba0468
4ba57a78193626aeadfd55a9fe86370e93ed6032c714b1a4bffee391954ff4bd
9d321d51c6b073bf0e38b304c5d0842d0b3b68a505249ca4aa2e537341a0a4f5
139370451c67ba6b9bb1eb1e05cc75d7a8e89d7dc197004dd952a50c2d24dd63
0e843444bef2f9ecb3e58558253f348a5ad771886416650960fe68ff637ab78b
4f272e64c7d645147dcfbb79f6cba6ffb4e39b039bb63cbe57cf013f6143ea4c
121d3f664bc310304f937c7f18b415147beb5aba27ec4f44942b6f4957823418
6299aa3b6ba2f996e1333a2d680f419542133602a1dce66c2b7e853598d88120
f17cd4c10c2533353ec9d2154368d490669b26311aa3b16a22fee22b4c77d731
bb618ab060173592ddf57bb3d8908537fdd8f3161a7bf4f8b92883e33507d3e4
df6c6905f684e53baded44001d96785e50bd21d5c92591da5254d307bca1e50d
3639
client call clen=8017 slen= 834
@@@@ Nego callback for TLS 1.3 @@@@
Offered extensions:
001b0010000800060568712d3038000a00040002001d001a0003000102
Transport parameters offered:
000102
No application cookie (fist connection).
Adding server transport parameters:
000102
@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
WARNING: chain validation failed, ignoring.
client done clen=  58 slen= 834 status=client_complete
17030300352ac272661f644bde43f8b5a1386ef492a79ffe0df408eb838c55b8
ab4e329d491b36119bbf7e59126f2d1f0dd210c29de8d9a9e032
server call clen=  58 slen=7358
sender done clen=  58 slen=   0 status=server_complete
=== Exporter secret ===
5ed31ca79226325b1749636f92008d7252c81db2ce4c305bef29d3ce1626a17a
=== QUIC 1-RTT secrets ===
C: 0ca008363a161375e9e962dc66ded7c7518e54536d1a39e39ccdeb14bc85d35a
S: 572e6b16dee5f50e9b5d4b18e7695339ad33096d2770375facce48d999bce108
=== AEAD client key test ===
854fe39eea862ec24d6aec60da769f7a9d4d9ea2c4d09c188772f8
=== Decrypt successful ===
Ok
./quic.exe 0rtt

INITIAL ECDHE HANDSHAKE (NO EARLY SECRET)

server create
client create
client returns would_block clen=175 slen=0
ClientHello[ 175] ---->

@@@@ Nego callback for TLS 1.3 @@@@
Offered extensions:
003d001a0009ffff00050a0b0c0d0e0000000e000c0000096c6f63616c686f73
740010000800060568712d3038000d0006000408040403000a00040002001d
Transport parameters offered:
ffff00050a0b0c0d0e
No application cookie (fist connection).
Adding server transport parameters:
000102
@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
======== TO BE SIGNED <0403>: (130 octets) ========
2020202020202020202020202020202020202020202020202020202020202020
2020202020202020202020202020202020202020202020202020202020202020
544c5320312e332c207365727665722043657274696669636174655665726966
79002e8005ac76df805524e000a22ebace9340bc464d69b78eb653e27f711c73
4703
===================================================
server returns server_accept clen=175 slen=834
secret=da5467f3256902109550729604baf31a4419fe23d718a52362532c912961abef
<---- ServerHello;(EncryptedExtensions; Certificate; CertVerify; Finished)[ 834]

@@@@ Nego callback for TLS 1.3 @@@@
Offered extensions:
001b0010000800060568712d3038000a00040002001d001a0003000102
Transport parameters offered:
000102
No application cookie (fist connection).
Adding server transport parameters:
000102
@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
WARNING: chain validation failed, ignoring.
client returns client_complete clen=58 slen=834
secret=da5467f3256902109550729604baf31a4419fe23d718a52362532c912961abef
(Finished) [  58] ---->

server returns server_complete clen=58 slen=0
server returns would_block clen=0 slen=135
<---- {Ticket}[ 135]

##### New session ticket received! #####
Host: localhost
Ticket:
48c2fe5fe44a482cebbbb78b4569d07a70aabb6974c7d5541107d2d4277e920d
d4f07a9a990c3f42718e6a182e7923860b1c22024085423c63629554eda4730f
eb75ce0f1c39611746d0dda8
########################################
client returns clen=0 slen=135 status=would_block

TICKET-BASED RESUMPTION

server create
client create
client returns client_early_data clen=302 slen=0
early secret=95a50dc8b5aadb357ce4729831ba68d37a9e0191dca959d1abcd521969447d43
ClientHello[ 302] ---->

@@@@ Nego callback for TLS 1.3 @@@@
Offered extensions:
003d001a0009ffff00050a0b0c0d0e0000000e000c0000096c6f63616c686f73
740010000800060568712d3038000d0006000408040403000a00040002001d
Transport parameters offered:
ffff00050a0b0c0d0e
No application cookie (fist connection).
Adding server transport parameters:
000102
@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
server returns server_accept_early_data clen=302 slen=196
early secret=95a50dc8b5aadb357ce4729831ba68d37a9e0191dca959d1abcd521969447d43
secret=5c4fe272e34436445c43b26f6d048f99b20832475fc76e77d9aa2f667d710ec4
<---- ServerHello;(EncryptedExtensions; Certificate; CertVerify; Finished)[ 196]

@@@@ Nego callback for TLS 1.3 @@@@
Offered extensions:
001b0010000800060568712d3038000a00040002001d001a0003000102
Transport parameters offered:
000102
No application cookie (fist connection).
Adding server transport parameters:
000102
@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
client returns client_complete_early_data clen=84 slen=196
secret=5c4fe272e34436445c43b26f6d048f99b20832475fc76e77d9aa2f667d710ec4
(Finished) [  84] ---->

server returns clen=84 slen=0 status=server_complete
server returns would_block clen=0 slen=135
<---- {Ticket}[ 135]

##### New session ticket received! #####
Host: localhost
Ticket:
05ec4e051fc56327206afdb72dec9d90945f44b09a008d898bffc34df68f1da5
3e6a2495e9f2aa14cd623710faa8e66e0701dc847398bdad4932e76a815ba627
c32a7926924b1ddde245863c
########################################
client returns clen=0 slen=135 status=would_block
Ok
./quic.exe hrr

STATELESS RETRY TEST

server create
client create
client returns would_block clen=175 slen=0
ClientHello[ 175] ---->

~~~~~~~~~ Client Hello Summary ~~~~~~~~~~~
~ SNI = localhost
~ ALPN = 00060568712d3038
~ Cookie = NULL
~ Extensions = 0079001a0009ffff00050a0b0c0d0e002b0003027f1c003300260024001d0020
701ccffb1d722a2740f11d9c72f3b3f7ef2b37c904ccbac49e09214626557343
0000000e000c0000096c6f63616c686f73740010000800060568712d30380017
0000000d0006000408040403000a00040002001d002d0003020001
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
@@@@ Nego callback for TLS 1.3 @@@@
Offered extensions:
003d001a0009ffff00050a0b0c0d0e0000000e000c0000096c6f63616c686f73
740010000800060568712d3038000d0006000408040403000a00040002001d
Transport parameters offered:
ffff00050a0b0c0d0e
No application cookie (fist connection).
Adding server transport parameters:
000102
@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
server returns server_stateless_retry clen=175 slen=188
<---- HRR[ 188]

server re-create
client returns would_block clen=308 slen=188
ClientHello2[ 308] ---->

~~~~~~~~~ Client Hello Summary ~~~~~~~~~~~
~ SNI = localhost
~ ALPN = 00060568712d3038
~ Cookie = 48656c6c6f20576f726c64
~ Extensions = 00fe002c0081007f42138ac5743c519bf5b8848e4baf25471d3b5cc536b69d31
a0409c836981b12378063213aa96b84be0c648a7dc7ed03d82a66e8c0d3c2225
d56cf19613345d9ddf8afdde1f18ae317b6acf7a18ea5f7796095e90dcf98d48
aa46312eca87b4176b8a12b1754100cccd635c9d97b573387915dd9eb3669645
b82afd71dd5e1f001a0009ffff00050a0b0c0d0e002b0003027f1c0033002600
24001d0020701ccffb1d722a2740f11d9c72f3b3f7ef2b37c904ccbac49e0921
46265573430000000e000c0000096c6f63616c686f7374001000080006056871
2d303800170000000d0006000408040403000a00040002001d002d0003020001
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
@@@@ Nego callback for TLS 1.3 @@@@
Offered extensions:
003d001a0009ffff00050a0b0c0d0e0000000e000c0000096c6f63616c686f73
740010000800060568712d3038000d0006000408040403000a00040002001d
Transport parameters offered:
ffff00050a0b0c0d0e
Stateless cookie found, application contents:
48656c6c6f20576f726c64
Adding server transport parameters:
000102
@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
======== TO BE SIGNED <0403>: (130 octets) ========
2020202020202020202020202020202020202020202020202020202020202020
2020202020202020202020202020202020202020202020202020202020202020
544c5320312e332c207365727665722043657274696669636174655665726966
7900fb5c8004f64802e9e60cb8e894e1daac30c5f5bbc129d032a5f086aef386
78ed
===================================================
server returns server_accept clen=308 slen=835
secret=20e75bc0ab75b584b1b4ac70604348fe0811ae65c169f114eed67d3be72aa656
<---- ServerHello;(EncryptedExtensions; Certificate; CertVerify; Finished)[ 835]

@@@@ Nego callback for TLS 1.3 @@@@
Offered extensions:
001b0010000800060568712d3038000a00040002001d001a0003000102
Transport parameters offered:
000102
No application cookie (fist connection).
Adding server transport parameters:
000102
@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
WARNING: chain validation failed, ignoring.
client returns client_complete clen=58 slen=835
secret=20e75bc0ab75b584b1b4ac70604348fe0811ae65c169f114eed67d3be72aa656
(Finished) [  58] ---->

server returns server_complete clen=58 slen=0
server returns would_block clen=0 slen=135
<---- {Ticket}[ 135]

##### New session ticket received! #####
Host: localhost
Ticket:
218e86574d94f52ef49635b50fa2c8133d898ffb041dcade602b9ab15e8427a6
150c0ad01fa96419d0e4d9626b24e15df72550b2396e2e9617e569c8e1a62495
5402686cb4ede124de16b2b6
########################################
client returns clen=0 slen=135 status=would_block
Ok
make[1]: Leaving directory '/cygdrive/c/build/agent2/_work/6/s/mitls-fstar/apps/quicMinusNet'
make[1]: Entering directory '/cygdrive/c/build/agent2/_work/6/s/mitls-fstar/src/tls'
C:/build/agent2/_work/6/s/FStar/bin/fstar.exe --cache_dir cache/Kremlin --cache_checked_modules --print_z3_statistics --use_hints --query_stats --cache_dir cache/Kremlin --odir extract/Kremlin --extract '* -DHDB -LowCProvider -FFICallbacks -BufferBytes' --dep full --include C:/build/agent2/_work/6/s/FStar/contrib/CoreCrypto/fst/ --include C:/build/agent2/_work/6/s/hacl-star/secure_api --include C:/build/agent2/_work/6/s/hacl-star/secure_api/utils --include C:/build/agent2/_work/6/s/hacl-star/secure_api/concrete_specializations --include C:/build/agent2/_work/6/s/hacl-star/secure_api/LowCProvider/fst --include C:/build/agent2/_work/6/s/hacl-star/code/curve25519/api --include C:/build/agent2/_work/6/s/hacl-star/code/lib --include C:/build/agent2/_work/6/s/kremlin/kremlib --include ../../libs/ffi --include ../../src/tls/concrete-flags --include ../../src/tls/concrete-flags/Kremlin --include ./concrete-flags/Debug QUIC.fst Test.Main.fst  > cache/Kremlin/.depend
make[1]: Leaving directory '/cygdrive/c/build/agent2/_work/6/s/mitls-fstar/src/tls'
make[1]: Entering directory '/cygdrive/c/build/agent2/_work/6/s/mitls-fstar/src/tls'
C:/build/agent2/_work/6/s/FStar/bin/fstar.exe --cache_dir cache/OCaml --cache_checked_modules --print_z3_statistics --use_hints --query_stats --cache_dir cache/OCaml --odir extract/OCaml --extract '* -Prims -FStar +FStar.Test +FStar.Kremlin.Endianness -CoreCrypto -CryptoTypes -DHDB -LowCProvider -HaclProvider -FFICallbacks -Crypto.AEAD -Crypto.Symmetric -Crypto.Plain -Spec.Loops -Buffer.Utils -C +C.Loops -LowParse.SLow.Tac -BufferBytes' --dep full --include C:/build/agent2/_work/6/s/FStar/contrib/CoreCrypto/fst/ --include C:/build/agent2/_work/6/s/hacl-star/secure_api --include C:/build/agent2/_work/6/s/hacl-star/secure_api/utils --include C:/build/agent2/_work/6/s/hacl-star/secure_api/concrete_specializations --include C:/build/agent2/_work/6/s/hacl-star/secure_api/LowCProvider/fst --include C:/build/agent2/_work/6/s/hacl-star/code/curve25519/api --include C:/build/agent2/_work/6/s/hacl-star/code/lib --include C:/build/agent2/_work/6/s/kremlin/kremlib --include ../../libs/ffi --include ../../src/tls/concrete-flags --include ../../src/tls/concrete-flags/OCaml --include ./concrete-flags/Debug QUIC.fst Test.Main.fst  > cache/OCaml/.depend
make[1]: Leaving directory '/cygdrive/c/build/agent2/_work/6/s/mitls-fstar/src/tls'
make -C extract/Kremlin-Internal-Test test
make[2]: Entering directory '/cygdrive/c/build/agent2/_work/6/s/mitls-fstar/src/tls/extract/Kremlin-Internal-Test'
cp ../../../../data/CAFile.pem .
make[2]: Leaving directory '/cygdrive/c/build/agent2/_work/6/s/mitls-fstar/src/tls/extract/Kremlin-Internal-Test'
make[2]: Entering directory '/cygdrive/c/build/agent2/_work/6/s/mitls-fstar/src/tls/extract/Kremlin-Internal-Test'
cp ../../../../data/server-ecdsa.crt .
make[2]: Leaving directory '/cygdrive/c/build/agent2/_work/6/s/mitls-fstar/src/tls/extract/Kremlin-Internal-Test'
make[2]: Entering directory '/cygdrive/c/build/agent2/_work/6/s/mitls-fstar/src/tls/extract/Kremlin-Internal-Test'
cp ../../../../data/server-ecdsa.key .
make[2]: Leaving directory '/cygdrive/c/build/agent2/_work/6/s/mitls-fstar/src/tls/extract/Kremlin-Internal-Test'
make[1]: Entering directory '/cygdrive/c/build/agent2/_work/6/s/mitls-fstar/src/tls'
cp ../../data/CAFile.pem .
make[1]: Leaving directory '/cygdrive/c/build/agent2/_work/6/s/mitls-fstar/src/tls'
make[1]: Entering directory '/cygdrive/c/build/agent2/_work/6/s/mitls-fstar/src/tls'
cp ../../data/server-ecdsa.crt .
make[1]: Leaving directory '/cygdrive/c/build/agent2/_work/6/s/mitls-fstar/src/tls'
make[1]: Entering directory '/cygdrive/c/build/agent2/_work/6/s/mitls-fstar/src/tls'
cp ../../data/server-ecdsa.key .
make[1]: Leaving directory '/cygdrive/c/build/agent2/_work/6/s/mitls-fstar/src/tls'
make[2]: Entering directory '/cygdrive/c/build/agent2/_work/6/s/mitls-fstar/src/tls/extract/Kremlin-Internal-Test'
./test.exe
✔ RNG initialization
b1 = 1234567890abcdef1234567890abcdef
b2 = cafedecafbabedeadbeeffeec0ffee33
b12= 1234567890abcdef1234567890abcdefcafedecafbabedeadbeeffeec0ffee33
b3 = 1234567890abcdef1234567890abcdefcafedecafbabedeadbeeffeec0ffee33
✔ BufferBytes
✔ TLSConstants
✔ AEAD
AEP| LowProvider: COERCE(K=feffe9928665731c6d6a8f9467308308feffe9928665731c6d6a8f9467308308)
Test.StAE: c0 size=33 data=000000000000000017b5db7a6412522a62d32d2b5a94a9348c80cbc7b20bdcfa5c.
Test.StAE: c1 size=28 data=0000000000000001a93cd0e67431db38a93a169cd79b29c82f69d7e4.
Test.StAE: start.
Test.StAE: decryption fails on wrong cipher.
Test.StAE: decryption fails on wrong sequence number.
Test.StAE: decryption fails on wrong CT.
Test.StAE: first decryption succeeds.
Test.StAE: second decryption succeeds.
AEP| LowProvider: COERCE(K=feffe9928665731c6d6a8f9467308308feffe9928665731c6d6a8f9467308308)
Test.StAE: c0 size=26 data=d12a84f232589f6bc797322d5f5d3f43e95bc07640538c50dded.
Test.StAE: c1 size=21 data=2adba81a76d2814ee2aba4406c861ecbc19825461a.
Test.StAE: start.
Test.StAE: decryption fails on wrong cipher.
Test.StAE: decryption fails on wrong sequence number.
Test.StAE: TLS 1.3 does not intend to provide outer CT authentication.
Test.StAE: first decryption succeeds.
Test.StAE: second decryption succeeds.
✔ StAE
Test.CommonDH: Testing FFDHE2048.
CDH| Keygen on FFDHE2048
CDH| DH responder on FFDHE2048
CDH| Keygen on FFDHE2048
CDH| DH initiator on FFDHE2048
CDH| DH initiator on FFDHE2048
Test.CommonDH: Testing FFDHE3072.
CDH| Keygen on FFDHE3072
CDH| DH responder on FFDHE3072
CDH| Keygen on FFDHE3072
CDH| DH initiator on FFDHE3072
CDH| DH initiator on FFDHE3072
Test.CommonDH: Testing FFDHE4096.
CDH| Keygen on FFDHE4096
CDH| DH responder on FFDHE4096
CDH| Keygen on FFDHE4096
CDH| DH initiator on FFDHE4096
CDH| DH initiator on FFDHE4096
Test.CommonDH: Testing FFDHE6144.
CDH| Keygen on FFDHE6144
CDH| DH responder on FFDHE6144
CDH| Keygen on FFDHE6144
CDH| DH initiator on FFDHE6144
CDH| DH initiator on FFDHE6144
Test.CommonDH: Testing FFDHE8192.
CDH| Keygen on FFDHE8192
CDH| DH responder on FFDHE8192
CDH| Keygen on FFDHE8192
CDH| DH initiator on FFDHE8192
CDH| DH initiator on FFDHE8192
Test.CommonDH: Testing P256.
CDH| Keygen on P256
CDH| DH responder on P256
CDH| Keygen on P256
CDH| DH initiator on P256
CDH| DH initiator on P256
Test.CommonDH: Testing P384.
CDH| Keygen on P384
CDH| DH responder on P384
CDH| Keygen on P384
CDH| DH initiator on P384
CDH| DH initiator on P384
Test.CommonDH: Testing P521.
CDH| Keygen on P521
CDH| DH responder on P521
CDH| Keygen on P521
CDH| DH initiator on P521
CDH| DH initiator on P521
Test.CommonDH: Testing X255519.
CDH| Keygen on X255519
CDH| DH responder on X255519
CDH| Keygen on X255519
CDH| DH initiator on X255519
CDH| DH initiator on X255519
✔ CommonDH
HS | next_fragment
HS | offering ClientHello 1.3
KS | ks_client_init 1.3
CDH| Keygen on X255519
NGO| No PSK or 0-RTT disabled
NGO| offering client extensions [ supported_versions key_share extended_master_secret signature_algorithms ec_point_formats supported_groups psk_key_exchange_modes ]
NGO| offering cipher suites ; TLS_AES_128_GCM_SHA256; TLS_AES_256_GCM_SHA384; TLS_CHACHA20_POLY1305_SHA256; TLS_ECDHE_ECDSA_WITH_AES_128_GCM_SHA256; TLS_ECDHE_RSA_WITH_AES_128_GCM_SHA256; TLS_DHE_RSA_WITH_AES_128_GCM_SHA256; TLS_ECDHE_ECDSA_WITH_AES_256_GCM_SHA384; TLS_ECDHE_RSA_WITH_AES_256_GCM_SHA384; TLS_DHE_RSA_WITH_AES_256_GCM_SHA384; TLS_ECDHE_ECDSA_WITH_CHACHA20_POLY1305_SHA256; TLS_ECDHE_RSA_WITH_CHACHA20_POLY1305_SHA256; TLS_DHE_RSA_WITH_CHACHA20_POLY1305_SHA256
HSL| emit ClientHello
Test.Handshake: ----client-hello---> 010000b303035ae78191...010100002d0003020001 (183 bytes).
HS | recv_fragment
HSL| parsed [ClientHello] -- end of flight 
HS | Processing ClientHello
NGO| offered client extensions [ supported_versions key_share extended_master_secret signature_algorithms ec_point_formats supported_groups psk_key_exchange_modes ]
NGO| offered cipher suites ; TLS_AES_128_GCM_SHA256; TLS_AES_256_GCM_SHA384; TLS_CHACHA20_POLY1305_SHA256; TLS_ECDHE_ECDSA_WITH_AES_128_GCM_SHA256; TLS_ECDHE_RSA_WITH_AES_128_GCM_SHA256; TLS_DHE_RSA_WITH_AES_128_GCM_SHA256; TLS_ECDHE_ECDSA_WITH_AES_256_GCM_SHA384; TLS_ECDHE_RSA_WITH_AES_256_GCM_SHA384; TLS_DHE_RSA_WITH_AES_256_GCM_SHA384; TLS_ECDHE_ECDSA_WITH_CHACHA20_POLY1305_SHA256; TLS_ECDHE_RSA_WITH_CHACHA20_POLY1305_SHA256; TLS_DHE_RSA_WITH_CHACHA20_POLY1305_SHA256
NGO| offered versions 1.3
NGO| Negotiated Pure EDH key exchange
NGO| Negotiated ECDSA_SHA1
NGO| Negotiation callback to handle extra extensions and query for stateless retry.
NGO| Application data in cookie: none
NGO| negotiated 1.3 TLS_AES_128_GCM_SHA256
KS | ks_server_init
KS | No PSK selected.
KS | Computed early secret:           33ad0a1c607ec03b09e6cd9893680ce210adf300aa1f2660e1b22e10f170f92a
KS | Handshake salt:                  6f2615a108c702c5678f54fc9dbab69716c076189c48250cebeac3576c3611ba
CDH| DH responder on X255519
CDH| Keygen on X255519
CDH| DH initiator on X255519
KS | DH shared secret: 2c1a9079c38ca2db792d644cfbed50d7563ce114eb84643085e2ce1da3fe3f2a
KS | Handshake secret:                ecfd901e5413bc2c4d8135bc39dfeae6e1db21ab65ee1401f17be51d07ae4e22
NGO| processing client extensions [ supported_versions key_share extended_master_secret signature_algorithms ec_point_formats supported_groups psk_key_exchange_modes ]
NGO| including server extensions (SH + EE) [ supported_versions key_share supported_groups ]
NGO| extra extensions from application callback: 
HSL| emit ServerHello and hash
HS | derive handshake keys
KS | ks_server_13_sh, hashed log = ec1dc6c5d4180c269bc6ace04b4daec4c55802ce1ca6d58d53b57f6fe8f5917c
KS | handshake traffic secret[C]:     602b707dda7282b6a7c13c71d0dfe359815b9078dd834bddc92919d7753f847c
KS | handshake traffic secret[S]:     c4a01ef90c5f2e5ed5794b5f365c1e820eaa0e2672f951ad42eeebcb4d84fcaf
KS | handshake key[C]:                500a57e9796b363a77a825dd750e807d, IV=cf4288a3ba47e76ae684ee7d
KS | handshake key[S]: 851e1b2e7462f0a76ea6cfbec981dbce, IV=e37f7b02d693579512eea334
AEP| LowProvider: COERCE(K=851e1b2e7462f0a76ea6cfbec981dbce)
AEP| LowProvider: COERCE(K=500a57e9796b363a77a825dd750e807d)
KS | finished key[C]:                 3d136c0a70cd99b96c3c542fc0a13f7e8cf9f841f3ab387aba13c97f475c3697
KS | finished key[S]:                 130efa91b55e7129e4808fe849252ea02bf0083e5270481d16e4e5f9384a96b2
KS | Application salt:                b2de3d500cfff8888546be1345653d8cac67a095943d121a5d5da0a3784244ac
KS | Application secret:              dc5d957090603d2592ebbe28725309a334a480bcce46a204f6936a3091a8c805
HS | next_fragment
Test.Handshake: <---server-hello---- 0200005603035ae78191...60f7d05d6cc0bc094645 (90 bytes).
HS | recv_fragment
HSL| parsed ServerHello
HSL| end of flight
HS | client_ServerHello
NGO| processing server extensions [ supported_versions key_share ]
NGO| negotiated 1.3 TLS_AES_128_GCM_SHA256
HS | Running TLS 1.3
KS | ks_client_13_sh hashed_log = ec1dc6c5d4180c269bc6ace04b4daec4c55802ce1ca6d58d53b57f6fe8f5917c
KS | no PSK negotiated. Early secret: 33ad0a1c607ec03b09e6cd9893680ce210adf300aa1f2660e1b22e10f170f92a
KS | handshake salt:                  6f2615a108c702c5678f54fc9dbab69716c076189c48250cebeac3576c3611ba
CDH| DH initiator on X255519
KS | DH shared secret: 2c1a9079c38ca2db792d644cfbed50d7563ce114eb84643085e2ce1da3fe3f2a
KS | handshake secret:                ecfd901e5413bc2c4d8135bc39dfeae6e1db21ab65ee1401f17be51d07ae4e22
KS | handshake traffic secret[C]:     602b707dda7282b6a7c13c71d0dfe359815b9078dd834bddc92919d7753f847c
KS | handshake traffic secret[S]:     c4a01ef90c5f2e5ed5794b5f365c1e820eaa0e2672f951ad42eeebcb4d84fcaf
KS | handshake key[C]:                500a57e9796b363a77a825dd750e807d, IV=cf4288a3ba47e76ae684ee7d
KS | handshake key[S]:                851e1b2e7462f0a76ea6cfbec981dbce, IV=e37f7b02d693579512eea334
KS | finished key[C]: 3d136c0a70cd99b96c3c542fc0a13f7e8cf9f841f3ab387aba13c97f475c3697
KS | finished key[S]: 130efa91b55e7129e4808fe849252ea02bf0083e5270481d16e4e5f9384a96b2
KS | application salt:                b2de3d500cfff8888546be1345653d8cac67a095943d121a5d5da0a3784244ac
KS | application secret:              dc5d957090603d2592ebbe28725309a334a480bcce46a204f6936a3091a8c805
AEP| LowProvider: COERCE(K=500a57e9796b363a77a825dd750e807d)
AEP| LowProvider: COERCE(K=851e1b2e7462f0a76ea6cfbec981dbce)
EPO| reader++ 0/-1
HS | next_fragment
HS | prepare Server Finished
HSL| emit EncryptedExtensions
HSL| emit Certificate13 and hash
HSL| emit CertificateVerify and hash
HSL| emit Finished and hash
KS | ks_server_13_sf hashed_log = 9158df99a41782b751798ca4b84e301ec4d559734e999b81e7acd740cee14386
KS | application traffic secret[C]:   da3f57a3436df65efb89b7bdaab7dc51031550077442dd28ec616a20c9aa2b65
KS | application traffic secret[S]:   a6021e664ea1b826ad4e034a6215a54b737fb8ee821065cd19e7809958883fca
KS | exporter master secret:          693ff95ad1a6dc554cabdf32cca121636b7631535bb63c76bb222ed6f1e04d01
KS | application key[C]:              b9e6b6859fed9e06a2f18d131b5b7fe6, IV=260e0f33542510acb872748f
KS | application key[S]:              2e037b334867148b3fe603381cc4b114, IV=ba6c100d22fd9dd4dfea0ad0
AEP| LowProvider: COERCE(K=2e037b334867148b3fe603381cc4b114)
AEP| LowProvider: COERCE(K=b9e6b6859fed9e06a2f18d131b5b7fe6)
HS | exporting a key
EPO| reader++ 0/-1
Test.Handshake: <--server-finished-- 080000160014000a0010...b6262cd7f448359627f4 (710 bytes).
HS | recv_fragment
HSL| parsed EncryptedExtensions
HSL| parsed Certificate13
HSL| parsed CertificateVerify
HSL| parsed Finished
HSL| end of flight
NGO| Nego.clientComplete_13
NGO| EE: supported_groups 
NGO| Negotiation callback to process application extensions.
NGO| Certificate & signature 1.3 callback result: valid
KS | ks_client_13_sf hashed_log = 9158df99a41782b751798ca4b84e301ec4d559734e999b81e7acd740cee14386
KS | application traffic secret[C]:   da3f57a3436df65efb89b7bdaab7dc51031550077442dd28ec616a20c9aa2b65
KS | application traffic secret[S]:   a6021e664ea1b826ad4e034a6215a54b737fb8ee821065cd19e7809958883fca
KS | exporter master secret:          693ff95ad1a6dc554cabdf32cca121636b7631535bb63c76bb222ed6f1e04d01
KS | application key[C]:              b9e6b6859fed9e06a2f18d131b5b7fe6, IV=260e0f33542510acb872748f
KS | application key[S]:              2e037b334867148b3fe603381cc4b114, IV=ba6c100d22fd9dd4dfea0ad0
AEP| LowProvider: COERCE(K=b9e6b6859fed9e06a2f18d131b5b7fe6)
AEP| LowProvider: COERCE(K=2e037b334867148b3fe603381cc4b114)
HS | exporting a key
HS | Early data rejected
EPO| writer++ 0/0
HSL| emit Finished and hash
KS | ks_client_13_cf hashed_log = 0a16872dccb92b8f314dcd8f91c64b2f7de5241060f954318194f018ebe843a6
KS | resumption master secret:        df585822c024ad8b9db409735665aa920997f6d42366603ee412c406916d6adc
EPO| reader++ 1/0
HS | next_fragment
Test.Handshake: --client-finished---> 1400002000d64f64b6a0...751b8425d6348f90d74d (36 bytes).
HS | recv_fragment
HSL| parsed Finished
HSL| end of flight
HS | Process Client Finished
KS | ks_server_13_cf hashed_log = 0a16872dccb92b8f314dcd8f91c64b2f7de5241060f954318194f018ebe843a6
KS | resumption master secret:        df585822c024ad8b9db409735665aa920997f6d42366603ee412c406916d6adc
AEP| LowProvider: COERCE(K=3c5ac85265f3cc5a72726cb60201a81b49dbf61997c06fdf300a2b34c88f1da8)
HS | Sending ticket: c16d3185e53e77fe0ad7880c6531fc93435898ccab647832f70d204d4a527a9d71f4a7ab9ee794811f96c7c7fd72962d8e3772d6f792a5bf95506d488f454521cc3d85b37096684c1c8cc2f6
HSL| emit NewSessionTicket13
EPO| reader++ 1/-1
HS | next_fragment
Test.Handshake: <--session-ticket-- 0400006500000e1083dc...7096684c1c8cc2f60000 (105 bytes).
HS | recv_fragment
HSL| parsed NewSessionTicket13
HSL| end of flight
HS | Received ticket: c16d3185e53e77fe0ad7880c6531fc93435898ccab647832f70d204d4a527a9d71f4a7ab9ee794811f96c7c7fd72962d8e3772d6f792a5bf95506d488f454521cc3d85b37096684c1c8cc2f6
KS | ks_client_13_rms
KS | Recall RMS: df585822c024ad8b9db409735665aa920997f6d42366603ee412c406916d6adc
Test.Handshake: Done.
✔ Handshake
make[2]: Leaving directory '/cygdrive/c/build/agent2/_work/6/s/mitls-fstar/src/tls/extract/Kremlin-Internal-Test'
make[1]: Entering directory '/cygdrive/c/build/agent2/_work/6/s/mitls-fstar/src/tls'
OCAMLPATH="C:/build/agent2/_work/6/s/FStar/bin" ocamlfind opt -package fstarlib,zarith,ctypes,ctypes.foreign -g -I C:/build/agent2/_work/6/s/FStar/ulib/ml -I extract/OCaml -I C:/build/agent2/_work/6/s/MLCrypto -I ../../libs/ffi -I C:/build/agent2/_work/6/s/hacl-star/secure_api/LowCProvider -I C:/build/agent2/_work/6/s/hacl-star/secure_api/out/runtime_switch/ -I C:/build/agent2/_work/6/s/kremlin/_build/kremlib -I test -I extract/mlstubs -I . -cclib -L../pki -cclib -lmipki -linkall -linkpkg -g extract/OCaml/BufferBytes.cmx extract/OCaml/Crypto_AEAD_Main.cmx C:/build/agent2/_work/6/s/kremlin/_build/kremlib/C.cmx C:/build/agent2/_work/6/s/MLCrypto/CoreCrypto.cmxa C:/build/agent2/_work/6/s/hacl-star/secure_api/out/runtime_switch/LowC.cmxa ../../libs/ffi/FFICallbacks.cmxa extract/OCaml/Hashing_Spec.cmx extract/OCaml/Hashing_OpenSSL.cmx extract/OCaml/Hashing.cmx extract/OCaml/Flags.cmx extract/OCaml/TLSError.cmx extract/OCaml/Parse.cmx extract/OCaml/TLSConstants.cmx extract/OCaml/PKI.cmx extract/OCaml/Nonce.cmx extract/OCaml/TLS_Curve25519.cmx extract/OCaml/ECGroup.cmx extract/OCaml/DHGroup.cmx extract/OCaml/DebugFlags.cmx extract/OCaml/CommonDH.cmx extract/OCaml/Hashing_Flags.cmx extract/OCaml/Hashing_CRF.cmx extract/OCaml/PSK.cmx extract/OCaml/Extensions.cmx extract/OCaml/Cert.cmx extract/OCaml/RSAKey.cmx extract/OCaml/PMS.cmx extract/OCaml/TLSInfoFlags.cmx extract/OCaml/TLSInfo.cmx extract/OCaml/Crypto_Indexing.cmx extract/OCaml/Flag.cmx extract/OCaml/Specializations_Providers_AEAD.cmx extract/OCaml/C_Loops.cmx extract/OCaml/AEADOpenssl.cmx extract/OCaml/AEADProvider.cmx extract/OCaml/Range.cmx extract/OCaml/HandshakeMessages.cmx extract/OCaml/HandshakeLog.cmx extract/OCaml/FStar_Kremlin_Endianness.cmx extract/OCaml/Test_BufferBytes.cmx extract/OCaml/Ticket.cmx extract/OCaml/HMAC.cmx extract/OCaml/TLSPRF.cmx extract/OCaml/HMAC_UFCMA.cmx extract/OCaml/DataStream.cmx extract/OCaml/Alert.cmx extract/OCaml/Content.cmx extract/OCaml/StreamPlain.cmx extract/OCaml/StreamAE.cmx extract/OCaml/StatefulPlain.cmx extract/OCaml/LHAEPlain.cmx extract/OCaml/AEAD_GCM.cmx extract/OCaml/StatefulLHAE.cmx extract/OCaml/StAE.cmx extract/OCaml/HKDF.cmx extract/OCaml/KeySchedule.cmx extract/OCaml/Negotiation.cmx extract/OCaml/Epochs.cmx extract/OCaml/Handshake.cmx extract/OCaml/FStar_Test.cmx extract/OCaml/Test_CommonDH.cmx extract/OCaml/Transport.cmx extract/OCaml/Record.cmx extract/OCaml/Connection.cmx extract/OCaml/StreamDeltas.cmx extract/OCaml/TLS.cmx extract/OCaml/FFI.cmx extract/OCaml/QUIC.cmx extract/OCaml/Test_StAE.cmx extract/OCaml/Test_TLSConstants.cmx extract/OCaml/Test_Handshake.cmx extract/OCaml/Test_AEAD.cmx extract/OCaml/Test_Main.cmx extract/OCaml/FFIRegister.cmx extract/copied/kremstr.o test/mitls.cmx -o mitls.exe -thread
make[1]: Leaving directory '/cygdrive/c/build/agent2/_work/6/s/mitls-fstar/src/tls'
make[1]: Entering directory '/cygdrive/c/build/agent2/_work/6/s/mitls-fstar/src/tls'
./mitls.exe
✔ RNG initialization
b1 = 1234567890abcdef1234567890abcdef
b2 = cafedecafbabedeadbeeffeec0ffee33
b12= 1234567890abcdef1234567890abcdefcafedecafbabedeadbeeffeec0ffee33
b3 = 1234567890abcdef1234567890abcdefcafedecafbabedeadbeeffeec0ffee33
✔ BufferBytes
+ cd mitls-fstar/apps/cmitls
✔ TLSConstants
✔ AEAD
+ make test
AEP| LowCProvider: COERCE(K=feffe9928665731c6d6a8f9467308308feffe9928665731c6d6a8f9467308308)
Test.StAE: c0 size=33 data=000000000000000017b5db7a6412522a62d32d2b5a94a9348c80cbc7b20bdcfa5c.
Test.StAE: c1 size=28 data=0000000000000001a93cd0e67431db38a93a169cd79b29c82f69d7e4.
Test.StAE: start.
Test.StAE: decryption fails on wrong cipher.
Test.StAE: decryption fails on wrong sequence number.
Test.StAE: decryption fails on wrong CT.
Test.StAE: first decryption succeeds.
Test.StAE: second decryption succeeds.
AEP| LowCProvider: COERCE(K=feffe9928665731c6d6a8f9467308308feffe9928665731c6d6a8f9467308308)
Test.StAE: c0 size=26 data=d12a84f232589f6bc797322d5f5d3f43e95bc07640538c50dded.
Test.StAE: c1 size=21 data=2adba81a76d2814ee2aba4406c861ecbc19825461a.
Test.StAE: start.
Test.StAE: decryption fails on wrong cipher.
Test.StAE: decryption fails on wrong sequence number.
Test.StAE: TLS 1.3 does not intend to provide outer CT authentication.
Test.StAE: first decryption succeeds.
Test.StAE: second decryption succeeds.
✔ StAE
Test.CommonDH: Testing FFDHE2048.
CDH| Keygen on FFDHE2048
CDH| DH responder on FFDHE2048
CDH| Keygen on FFDHE2048
CDH| DH initiator on FFDHE2048
CDH| DH initiator on FFDHE2048
Test.CommonDH: Testing FFDHE3072.
CDH| Keygen on FFDHE3072
CDH| DH responder on FFDHE3072
CDH| Keygen on FFDHE3072
CDH| DH initiator on FFDHE3072
CDH| DH initiator on FFDHE3072
Test.CommonDH: Testing FFDHE4096.
CDH| Keygen on FFDHE4096
CDH| DH responder on FFDHE4096
CDH| Keygen on FFDHE4096
CDH| DH initiator on FFDHE4096
CDH| DH initiator on FFDHE4096
Test.CommonDH: Testing FFDHE6144.
CDH| Keygen on FFDHE6144
CDH| DH responder on FFDHE6144
CDH| Keygen on FFDHE6144
CDH| DH initiator on FFDHE6144
CDH| DH initiator on FFDHE6144
Test.CommonDH: Testing FFDHE8192.
CDH| Keygen on FFDHE8192
CDH| DH responder on FFDHE8192
CDH| Keygen on FFDHE8192
CDH| DH initiator on FFDHE8192
CDH| DH initiator on FFDHE8192
Test.CommonDH: Testing P256.
CDH| Keygen on P256
CDH| DH responder on P256
CDH| Keygen on P256
CDH| DH initiator on P256
CDH| DH initiator on P256
Test.CommonDH: Testing P384.
CDH| Keygen on P384
CDH| DH responder on P384
CDH| Keygen on P384
CDH| DH initiator on P384
CDH| DH initiator on P384
Test.CommonDH: Testing P521.
CDH| Keygen on P521
CDH| DH responder on P521
CDH| Keygen on P521
CDH| DH initiator on P521
CDH| DH initiator on P521
Test.CommonDH: Testing X255519.
CDH| Keygen on X255519
CDH| DH responder on X255519
CDH| Keygen on X255519
CDH| DH initiator on X255519
CDH| DH initiator on X255519
✔ CommonDH
HS | next_fragment
HS | offering ClientHello 1.3
KS | ks_client_init 1.3
CDH| Keygen on X255519
NGO| No PSK or 0-RTT disabled
NGO| offering client extensions [ supported_versions key_share extended_master_secret signature_algorithms ec_point_formats supported_groups psk_key_exchange_modes ]
NGO| offering cipher suites ; TLS_AES_128_GCM_SHA256; TLS_AES_256_GCM_SHA384; TLS_CHACHA20_POLY1305_SHA256; TLS_ECDHE_ECDSA_WITH_AES_128_GCM_SHA256; TLS_ECDHE_RSA_WITH_AES_128_GCM_SHA256; TLS_DHE_RSA_WITH_AES_128_GCM_SHA256; TLS_ECDHE_ECDSA_WITH_AES_256_GCM_SHA384; TLS_ECDHE_RSA_WITH_AES_256_GCM_SHA384; TLS_DHE_RSA_WITH_AES_256_GCM_SHA384; TLS_ECDHE_ECDSA_WITH_CHACHA20_POLY1305_SHA256; TLS_ECDHE_RSA_WITH_CHACHA20_POLY1305_SHA256; TLS_DHE_RSA_WITH_CHACHA20_POLY1305_SHA256
HSL| emit ClientHello
Test.Handshake: ----client-hello---> 010000b303035ae78194...010100002d0003020001 (183 bytes).
HS | recv_fragment
HSL| parsed [ClientHello] -- end of flight 
HS | Processing ClientHello
NGO| offered client extensions [ supported_versions key_share extended_master_secret signature_algorithms ec_point_formats supported_groups psk_key_exchange_modes ]
NGO| offered cipher suites ; TLS_AES_128_GCM_SHA256; TLS_AES_256_GCM_SHA384; TLS_CHACHA20_POLY1305_SHA256; TLS_ECDHE_ECDSA_WITH_AES_128_GCM_SHA256; TLS_ECDHE_RSA_WITH_AES_128_GCM_SHA256; TLS_DHE_RSA_WITH_AES_128_GCM_SHA256; TLS_ECDHE_ECDSA_WITH_AES_256_GCM_SHA384; TLS_ECDHE_RSA_WITH_AES_256_GCM_SHA384; TLS_DHE_RSA_WITH_AES_256_GCM_SHA384; TLS_ECDHE_ECDSA_WITH_CHACHA20_POLY1305_SHA256; TLS_ECDHE_RSA_WITH_CHACHA20_POLY1305_SHA256; TLS_DHE_RSA_WITH_CHACHA20_POLY1305_SHA256
NGO| offered versions 1.3
NGO| Negotiated Pure EDH key exchange
NGO| Negotiated ECDSA_SHA1
NGO| Negotiation callback to handle extra extensions and query for stateless retry.
NGO| Application data in cookie: none
NGO| negotiated 1.3 TLS_AES_128_GCM_SHA256
KS | ks_server_init
KS | No PSK selected.
KS | Computed early secret:           33AD0A1C607EC03B09E6CD9893680CE210ADF300AA1F2660E1B22E10F170F92A
KS | Handshake salt:                  6F2615A108C702C5678F54FC9DBAB69716C076189C48250CEBEAC3576C3611BA
CDH| DH responder on X255519
CDH| Keygen on X255519
CDH| DH initiator on X255519
KS | DH shared secret: 332758458C37455A2C67A562C8F0E14B27F3FEE760A22AA6A17AED56F5B80E03
KS | Handshake secret:                712792DD7E27B46CAEA0E5273B5365DEBA878284DB65572A74F831FE15C061C4
NGO| processing client extensions [ supported_versions key_share extended_master_secret signature_algorithms ec_point_formats supported_groups psk_key_exchange_modes ]
NGO| including server extensions (SH + EE) [ supported_versions key_share supported_groups ]
NGO| extra extensions from application callback: 
HSL| emit ServerHello and hash
HS | derive handshake keys
KS | ks_server_13_sh, hashed log = A4C03CC12ECD748CE9F437BD130D8D97F9C8186B4683CEFE447554A0F67BD5B4
KS | handshake traffic secret[C]:     C4B90BB32FDC8EEDDF439F5128FD22E1D70089C4049767A298F39948CBA9C2FA
KS | handshake traffic secret[S]:     25CD15316AA0CCBF21F39DD652BA692E7011A2EF41801FDA6CF741141693A541
KS | handshake key[C]:                7EF6DC19AC72B3511B9386D6E537BE04, IV=E93ADC614D1DD00C1D95E606
KS | handshake key[S]: 63E119FEAC677816F19D000AE07F34C6, IV=D26FC00A82F724DBCDC5BCCD
AEP| LowCProvider: COERCE(K=63e119feac677816f19d000ae07f34c6)
AEP| LowCProvider: COERCE(K=7ef6dc19ac72b3511b9386d6e537be04)
KS | finished key[C]:                 A686C581D9BDE3B8F383BC2C33A3CC1820F86E8C6780C853B6FAB5F69F5EE802
KS | finished key[S]:                 E9F032475627E4DEEE6C7BC20ADBA83E13016F48F772DF11CAB7821228BEC597
KS | Application salt:                D94795D0E5CFF4A7A941B74EABFDF24E82F66E079D8E6357F2970F052B91C909
KS | Application secret:              E70319A949E5E03C87DD51853D880F44D494107CE2E9D24EDB8131DE2060715D
HS | next_fragment
Test.Handshake: <---server-hello---- 0200005603035ae78194...19e518c7de4f56bf8122 (90 bytes).
HS | recv_fragment
HSL| parsed ServerHello
HSL| end of flight
HS | client_ServerHello
NGO| processing server extensions [ supported_versions key_share ]
NGO| negotiated 1.3 TLS_AES_128_GCM_SHA256
HS | Running TLS 1.3
KS | ks_client_13_sh hashed_log = A4C03CC12ECD748CE9F437BD130D8D97F9C8186B4683CEFE447554A0F67BD5B4
KS | no PSK negotiated. Early secret: 33AD0A1C607EC03B09E6CD9893680CE210ADF300AA1F2660E1B22E10F170F92A
KS | handshake salt:                  6F2615A108C702C5678F54FC9DBAB69716C076189C48250CEBEAC3576C3611BA
CDH| DH initiator on X255519
KS | DH shared secret: 332758458C37455A2C67A562C8F0E14B27F3FEE760A22AA6A17AED56F5B80E03
KS | handshake secret:                712792DD7E27B46CAEA0E5273B5365DEBA878284DB65572A74F831FE15C061C4
KS | handshake traffic secret[C]:     C4B90BB32FDC8EEDDF439F5128FD22E1D70089C4049767A298F39948CBA9C2FA
KS | handshake traffic secret[S]:     25CD15316AA0CCBF21F39DD652BA692E7011A2EF41801FDA6CF741141693A541
KS | handshake key[C]:                7EF6DC19AC72B3511B9386D6E537BE04, IV=E93ADC614D1DD00C1D95E606
KS | handshake key[S]:                63E119FEAC677816F19D000AE07F34C6, IV=D26FC00A82F724DBCDC5BCCD
KS | finished key[C]: A686C581D9BDE3B8F383BC2C33A3CC1820F86E8C6780C853B6FAB5F69F5EE802
KS | finished key[S]: E9F032475627E4DEEE6C7BC20ADBA83E13016F48F772DF11CAB7821228BEC597
KS | application salt:                D94795D0E5CFF4A7A941B74EABFDF24E82F66E079D8E6357F2970F052B91C909
KS | application secret:              E70319A949E5E03C87DD51853D880F44D494107CE2E9D24EDB8131DE2060715D
AEP| LowCProvider: COERCE(K=7ef6dc19ac72b3511b9386d6e537be04)
AEP| LowCProvider: COERCE(K=63e119feac677816f19d000ae07f34c6)
EPO| reader++ 0/-1
HS | next_fragment
HS | prepare Server Finished
HSL| emit EncryptedExtensions
HSL| emit Certificate13 and hash
HSL| emit CertificateVerify and hash
HSL| emit Finished and hash
KS | ks_server_13_sf hashed_log = D47DF09C5E45695B12A06C4693D9DF3182641339390C3C614D53680E06CDC07C
KS | application traffic secret[C]:   B028D9A546AAF6DBF30E1FC1A8C9344855E24491C649E9978C2F51FCB0F9EA4F
KS | application traffic secret[S]:   4BCC42F4282BFBE0A218D255FAC9AF52B36E664FC27121C7C299B533C5B6F54D
KS | exporter master secret:          7A64A8181B43B9FEDA16A208889A7CCD46DFE0416EB444F684D6CDF175120BB2
KS | application key[C]:              A03822CE9B7E2AE6C9E308C7ECAF077C, IV=630799C3E75C81CDDA43D629
KS | application key[S]:              16CA4CD9DA363A2B1D640800CDA0EECB, IV=81B3222A0BCBE30F4FE6F224
AEP| LowCProvider: COERCE(K=16ca4cd9da363a2b1d640800cda0eecb)
AEP| LowCProvider: COERCE(K=a03822ce9b7e2ae6c9e308c7ecaf077c)
HS | exporting a key
EPO| reader++ 0/-1
Test.Handshake: <--server-finished-- 080000160014000a0010...3c436e1ea83c2b3bc4f2 (710 bytes).
HS | recv_fragment
HSL| parsed EncryptedExtensions
HSL| parsed Certificate13
HSL| parsed CertificateVerify
HSL| parsed Finished
HSL| end of flight
NGO| Nego.clientComplete_13
NGO| EE: supported_groups 
NGO| Negotiation callback to process application extensions.
NGO| Certificate & signature 1.3 callback result: valid
KS | ks_client_13_sf hashed_log = D47DF09C5E45695B12A06C4693D9DF3182641339390C3C614D53680E06CDC07C
KS | application traffic secret[C]:   B028D9A546AAF6DBF30E1FC1A8C9344855E24491C649E9978C2F51FCB0F9EA4F
KS | application traffic secret[S]:   4BCC42F4282BFBE0A218D255FAC9AF52B36E664FC27121C7C299B533C5B6F54D
KS | exporter master secret:          7A64A8181B43B9FEDA16A208889A7CCD46DFE0416EB444F684D6CDF175120BB2
KS | application key[C]:              A03822CE9B7E2AE6C9E308C7ECAF077C, IV=630799C3E75C81CDDA43D629
KS | application key[S]:              16CA4CD9DA363A2B1D640800CDA0EECB, IV=81B3222A0BCBE30F4FE6F224
AEP| LowCProvider: COERCE(K=a03822ce9b7e2ae6c9e308c7ecaf077c)
AEP| LowCProvider: COERCE(K=16ca4cd9da363a2b1d640800cda0eecb)
HS | exporting a key
HS | Early data rejected
EPO| writer++ 0/0
HSL| emit Finished and hash
KS | ks_client_13_cf hashed_log = B5BE7C36107FC2824A8652E933316D8EE14EB5998B2F8AFD2F5C64F1F4F177A7
KS | resumption master secret:        A091E0D57A5C3DA1C782E109ED7AEF6C1B384B3E280AB0B960E3B621DFBA6505
EPO| reader++ 1/0
HS | next_fragment
Test.Handshake: --client-finished---> 140000206c303740790b...90de9c30f2048b0ea3bb (36 bytes).
HS | recv_fragment
HSL| parsed Finished
HSL| end of flight
HS | Process Client Finished
KS | ks_server_13_cf hashed_log = B5BE7C36107FC2824A8652E933316D8EE14EB5998B2F8AFD2F5C64F1F4F177A7
KS | resumption master secret:        A091E0D57A5C3DA1C782E109ED7AEF6C1B384B3E280AB0B960E3B621DFBA6505
AEP| LowCProvider: COERCE(K=7abe72c97d3934a5e782bc869e77df50a7b26149b34bf86d8187e1263dd79669)
HS | Sending ticket: FEF2D9F83A7F7835FF6277CC24B416E1FE90520D5EC310F3CAE7629E0E845E8BE9829BADBB9B33E616A08B0604EE30409D75E78AA11D7CD9938D7FD8B529BCA1EECE5CCE3A79E3902C60E82C
HSL| emit NewSessionTicket13
EPO| reader++ 1/-1
HS | next_fragment
Test.Handshake: <--session-ticket-- 0400006500000e101f11...3a79e3902c60e82c0000 (105 bytes).
HS | recv_fragment
HSL| parsed NewSessionTicket13
HSL| end of flight
HS | Received ticket: fef2d9f83a7f7835ff6277cc24b416e1fe90520d5ec310f3cae7629e0e845e8be9829badbb9b33e616a08b0604ee30409d75e78aa11d7cd9938d7fd8b529bca1eece5cce3a79e3902c60e82c
KS | ks_client_13_rms
KS | Recall RMS: a091e0d57a5c3da1c782e109ed7aef6c1b384b3e280ab0b960e3b621dfba6505
Test.Handshake: Done.
✔ Handshake
make[1]: Leaving directory '/cygdrive/c/build/agent2/_work/6/s/mitls-fstar/src/tls'
./cmitls.exe google.com 443
cmitls.exe ===================
cmitls.exe calling FFI_mitls_init
cmitls.exe about to act as client or server
===============================================
Starting test client...
Read OK, sending HTTP request...
Received 693 bytes of data:
Download speed: 1.#INF00kB/s
HTTP/1.1 301 Moved Permanently
Location: https://www.google.com/
Content-Type: text/html; charset=UTF-8
Date: Mon, 30 Apr 2018 20:50:28 GMT
Expires: Wed, 30 May 2018 20:50:28 GMT
Cache-Control: public, max-age=2592000
Server: gws
Content-Length: 220
X-XSS-Protection: 1; mode=block
X-Frame-Options: SAMEORIGIN
Alt-Svc: hq=":443"; ma=2592000; quic=51303433; quic=51303432; quic=51303431; quic=51303339; quic=51303335,quic=":443"; ma=2592000; v="43,42,41,39,35"

<HTML><HEAD><meta http-equiv="content-type" content="text/html;charset=utf-8">
<TITLE>301 Moved</TITLE></HEAD><BODY>
<H1>301 Moved</H1>
The document has moved
<A HREF="https://www.google.com/">here</A>.
</BODY></HTML>

Closing connection, irrespective of the response
./cmitls.exe tls13.cloudflare.com 443
cmitls.exe ===================
cmitls.exe calling FFI_mitls_init
cmitls.exe about to act as client or server
===============================================
Starting test client...
Read OK, sending HTTP request...
Received 1369 bytes of data:
Download speed: 1.336914kB/s
HTTP/1.1 521 Origin Down
+ cd mitls-fstar/apps/quicMinusNet
Date: Mon, 30 Apr 2018 20:50:29 GMT
Content-Type: text/html; charset=UTF-8
Transfer-Encoding: chunked
Connection: keep-alive
+ make test
Set-Cookie: __cfduid=d233c021a05b11c40a6a8fdea05ed42ea1525121428; expires=Tue, 30-Apr-19 20:50:28 GMT; path=/; domain=.cloudflare.com; HttpOnly
Expires: Thu, 01 Jan 1970 00:00:01 GMT
Cache-Control: no-store, no-cache, must-revalidate, post-check=0, pre-check=0
Pragma: no-cache
X-Frame-Options: SAMEORIGIN
Set-Cookie: cf_use_ob=443; expires=Mon, 30-Apr-18 20:50:59 GMT; path=/
Set-Cookie: cf_ob_info=521:413ce18338327a17:SEA; expires=Mon, 30-Apr-18 20:50:59 GMT; path=/
Strict-Transport-Security: max-age=15780000; includeSubDomains
Expect-CT: max-age=604800, report-uri="https://report-uri.cloudflare.com/cdn-cgi/beacon/expect-ct"
Server: cloudflare
CF-RAY: 413ce18338327a17-SEA

11c7
<!DOCTYPE html>
<!--[if lt IE 7]> <html class="no-js ie6 oldie" lang="en-US"> <![endif]-->
<!--[if IE 7]>    <html class="no-js ie7 oldie" lang="en-US"> <![endif]-->
<!--[if IE 8]>    <html class="no-js ie8 oldie" lang="en-US"> <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en-US"> <!--<![endif]-->
<head>
<meta http-equiv="refresh" content="0">

<title>tls13.cloudflare.com | 521: Web server is down</title>
<meta charset="UTF-8" />
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8
Closing connection, irrespective of the response
./quic.exe
server create
client create
client call clen=8192 slen=   0
client done clen= 175 slen=   0 status=would_block
16030300aa010000a603035ae78195209df64dbea55e72ca7bc1a1cffa04c088
689585b691fc2407f689c50000041303130101000079001a0009ffff00050a0b
0c0d0e002b0003027f1c003300260024001d0020b0f6d3cfc84cad665f11d1f6
e38bc54895c48d994e746ab0021c7632e8fd9b2f0000000e000c0000096c6f63
616c686f73740010000800060568712d303800170000000d0006000408040403
000a00040002001d002d0003020001
server call clen= 175 slen=8192
@@@@ Nego callback for TLS 1.3 @@@@
Offered extensions:
003d001a0009ffff00050a0b0c0d0e0000000e000c0000096c6f63616c686f73
740010000800060568712d3038000d0006000408040403000a00040002001d
Transport parameters offered:
ffff00050a0b0c0d0e
No application cookie (fist connection).
Adding server transport parameters:
000102
@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
======== TO BE SIGNED <0403>: (130 octets) ========
2020202020202020202020202020202020202020202020202020202020202020
2020202020202020202020202020202020202020202020202020202020202020
544c5320312e332c207365727665722043657274696669636174655665726966
790099d3631c23db113b2738f46da236529f31aa51e42aecaaa2edc826b4cb04
c2ea
===================================================
sender done clen= 175 slen= 833 status=server_accept
160303005a0200005603035ae78195882ab0f5ae9b94c99c8a223f4ef1eae6b5
d6bd9e33f0eea02040604900130300002e002b00027f1c00330024001d002065
86b5d6e1893be7b44d96305a8affb7a8f83e6e5dc516015b32fac07626920217
030302dd317a149d7df25ede86c255f990cb0e5b8542a726685f1c3a86174ae0
144dbb0db73c440ee5f1106af4e332e8c4faa62de9544bab06e9f496f36f3cc1
6c53dbac7c184850889600fe711ddc48e4610c0bb1b582b360a0850b6e7ae7ee
62ef6ebc425cfbfa6f333940e7a7c2c0d88fc5f5e810abea20e3a3a4bba250dd
8b290983b184c34670543cf85443a74c4eada12324558818c7049f985d26be62
22cfb3bdb982fc6ba3bd90cae65089b018327cbd93cd212059d46fb38c983059
9be4350e35a82368efc62b7ebe515ba740347e4fb67cc980e597dc8519da49a4
5b51fac4c9020135a9a0f9f5033ccc1814b228f41defa0f85a8a0cd52732f708
f9ff8ca24f1c40d885904e03405bd86a4c7d0c1cdf3d3d1f4e7946d831d644ff
78a8f189e9e6ddd5a5f1fd1de5ecfe92c5d6200707397c85f4dd8153b4be296d
159ed79c1e3ed62e6fd90be288c21f52580fa63b0d264d1ad7931e240817183c
c903518a3fa00c1f98daf50d20866739cd1c145c216b37f2363f9d5cf695aa9a
323d084042ba0639e81fbf4d7c19de123a928c230ca3e3ad827a9da846f98db0
0991d7dea3c3c0795c01f9ade322cc1b9d428a1eda04cf558683f81d8a1686b7
343439700a03c3dada6bd347eb4c42b4ec9500cec73f12bbcb3e7d634d99fdd7
7e6b1aa27d8e551411d818495200f433e94f19c47e88954a4d4bb8e56e022482
927924ebbd20989210ce0ddb89773f78d7cb04c25fe18a8bbcb7a9dba1655b79
6579b33c7635dabcb4e2743e011ff4f7f26f284c1bd07c308c1284ed851f2722
f9e419de2d1040fadda3baa6db66ab4230254dcd026ab9105f98f0ac2340b7df
d60b1af25d2f4030f5462b752cc57004a2cfea27ff7b86f8735d83a87e69b4d8
5962e5a7d9120ec78b6cc108ab590f72f171b717dd4232a49a9d53fd7947e710
225c1c552777881eab3b74522e580c8bd52bf27fbacc7ccff231d4b51086671f
aabe6649bcf945eb5f7ac1e77662b44e91cc46add2ac773870f1ac33d4a8665b
dc
client call clen=8017 slen= 833
@@@@ Nego callback for TLS 1.3 @@@@
Offered extensions:
001b0010000800060568712d3038000a00040002001d001a0003000102
Transport parameters offered:
000102
No application cookie (fist connection).
+ set +x
Adding server transport parameters:
000102
@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
WARNING: chain validation failed, ignoring.
client done clen=  58 slen= 833 status=client_complete
1703030035daa5c5703803c948f662e06c32561a03e2a362fba3e2b67dd27c84
1696ee6c75893b6cfdfbe04d4d9df04cc5eaf8227d56880f88dc
server call clen=  58 slen=7359
sender done clen=  58 slen=   0 status=server_complete
=== Exporter secret ===
820e96aadf458f546538c5dc5fe60b9b21b26d6a5cb9ec72b46370854132d009
=== QUIC 1-RTT secrets ===
C: 524b33aa5b124c0c3e201bc4273f1d9d1cbae3d9e3041fe22e7c588a0012d19e
S: 8b08b03e6ec5eb6100c0fc81c18e8f6ab2f1cda12a859c00632550afbd47e99b
=== AEAD client key test ===
3722d6b8945d9097ecf081ab2157e8341bfb1bfa0f9b68bfccd420
=== Decrypt successful ===
Ok
./quic.exe 0rtt

INITIAL ECDHE HANDSHAKE (NO EARLY SECRET)

server create
client create
client returns would_block clen=175 slen=0
ClientHello[ 175] ---->

@@@@ Nego callback for TLS 1.3 @@@@
Offered extensions:
003d001a0009ffff00050a0b0c0d0e0000000e000c0000096c6f63616c686f73
740010000800060568712d3038000d0006000408040403000a00040002001d
Transport parameters offered:
ffff00050a0b0c0d0e
No application cookie (fist connection).
Adding server transport parameters:
000102
@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
======== TO BE SIGNED <0403>: (130 octets) ========
2020202020202020202020202020202020202020202020202020202020202020
2020202020202020202020202020202020202020202020202020202020202020
544c5320312e332c207365727665722043657274696669636174655665726966
7900a68135c9da8f4a79ab63bb5747484b322e0d499d9a14e52862db36564494
6744
===================================================
server returns server_accept clen=175 slen=834
secret=a80f55efbda5c48caf1d6ae3f02ee5e11c2123eeb322ec1003613a46c80478c6
<---- ServerHello;(EncryptedExtensions; Certificate; CertVerify; Finished)[ 834]

@@@@ Nego callback for TLS 1.3 @@@@
Offered extensions:
001b0010000800060568712d3038000a00040002001d001a0003000102
Transport parameters offered:
000102
No application cookie (fist connection).
Adding server transport parameters:
000102
@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
WARNING: chain validation failed, ignoring.
client returns client_complete clen=58 slen=834
secret=a80f55efbda5c48caf1d6ae3f02ee5e11c2123eeb322ec1003613a46c80478c6
(Finished) [  58] ---->

server returns server_complete clen=58 slen=0
server returns would_block clen=0 slen=135
<---- {Ticket}[ 135]

##### New session ticket received! #####
Host: localhost
Ticket:
006a2a28067e336b9b69f8c15f7b594f43355968b8065deb6da960101f89fcf4
0f52d325d6bd695a44ee35e6453b1215e8e09dabf83f0927727cdf0935ae097b
354ac9300747277157343c4e
########################################
client returns clen=0 slen=135 status=would_block

TICKET-BASED RESUMPTION

server create
client create
client returns client_early_data clen=302 slen=0
early secret=73f457bfdc86694601aa1aa8d29c435af0e955608f1ecac732e80521bbcd8246
ClientHello[ 302] ---->

@@@@ Nego callback for TLS 1.3 @@@@
Offered extensions:
003d001a0009ffff00050a0b0c0d0e0000000e000c0000096c6f63616c686f73
740010000800060568712d3038000d0006000408040403000a00040002001d
Transport parameters offered:
ffff00050a0b0c0d0e
No application cookie (fist connection).
Adding server transport parameters:
000102
@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
server returns server_accept_early_data clen=302 slen=196
early secret=73f457bfdc86694601aa1aa8d29c435af0e955608f1ecac732e80521bbcd8246
secret=113cec35a98381b723625900a49411182659672b403b9659738a8fd619b6fa20
<---- ServerHello;(EncryptedExtensions; Certificate; CertVerify; Finished)[ 196]

@@@@ Nego callback for TLS 1.3 @@@@
Offered extensions:
001b0010000800060568712d3038000a00040002001d001a0003000102
Transport parameters offered:
000102
No application cookie (fist connection).
Adding server transport parameters:
000102
@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
client returns client_complete_early_data clen=84 slen=196
secret=113cec35a98381b723625900a49411182659672b403b9659738a8fd619b6fa20
(Finished) [  84] ---->

server returns clen=84 slen=0 status=server_complete
server returns would_block clen=0 slen=135
<---- {Ticket}[ 135]

##### New session ticket received! #####
Host: localhost
Ticket:
b7708fb82d463d4aff2ed2bbefbf146fe2dbfac638352f02d3eead2a62db9828
f96f19d3a6828796e07a01908d80f6bc1998a941cf3d36d525700b035f486b03
9210c7862575f7afbd6e05c3
########################################
client returns clen=0 slen=135 status=would_block
Ok
./quic.exe hrr

STATELESS RETRY TEST

server create
client create
client returns would_block clen=175 slen=0
ClientHello[ 175] ---->

~~~~~~~~~ Client Hello Summary ~~~~~~~~~~~
~ SNI = localhost
~ ALPN = 00060568712d3038
~ Cookie = NULL
~ Extensions = 0079001a0009ffff00050a0b0c0d0e002b0003027f1c003300260024001d0020
dedff9f4aca95f464a1871d91d08ce4377d450763a0dd1eacfd6503cff9fe741
0000000e000c0000096c6f63616c686f73740010000800060568712d30380017
0000000d0006000408040403000a00040002001d002d0003020001
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
@@@@ Nego callback for TLS 1.3 @@@@
Offered extensions:
003d001a0009ffff00050a0b0c0d0e0000000e000c0000096c6f63616c686f73
740010000800060568712d3038000d0006000408040403000a00040002001d
Transport parameters offered:
ffff00050a0b0c0d0e
No application cookie (fist connection).
Adding server transport parameters:
000102
@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
server returns server_stateless_retry clen=175 slen=188
<---- HRR[ 188]

server re-create
client returns would_block clen=308 slen=188
ClientHello2[ 308] ---->

~~~~~~~~~ Client Hello Summary ~~~~~~~~~~~
~ SNI = localhost
~ ALPN = 00060568712d3038
~ Cookie = 48656c6c6f20576f726c64
~ Extensions = 00fe002c0081007f1e3ef8c4e2d701addb8219d4e727ce0dd5826c653e3aa5cd
3ce0d4e7b4df70b828a7c6452cdb7c32e9b2adc5a1c87c4638b3f1038ee54a80
59cf4eac0bb3c9d36c52f9f35a4bf177059585b36bc88f4cd10bb29e65e3ac43
5d75f28ff7bfc26842aaad382fb3ca878f89755a6f11f027d1a7330880d9f0b0
79e5fed76a973d001a0009ffff00050a0b0c0d0e002b0003027f1c0033002600
24001d0020dedff9f4aca95f464a1871d91d08ce4377d450763a0dd1eacfd650
3cff9fe7410000000e000c0000096c6f63616c686f7374001000080006056871
2d303800170000000d0006000408040403000a00040002001d002d0003020001
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
@@@@ Nego callback for TLS 1.3 @@@@
Offered extensions:
003d001a0009ffff00050a0b0c0d0e0000000e000c0000096c6f63616c686f73
740010000800060568712d3038000d0006000408040403000a00040002001d
Transport parameters offered:
ffff00050a0b0c0d0e
Stateless cookie found, application contents:
48656c6c6f20576f726c64
Adding server transport parameters:
000102
@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
======== TO BE SIGNED <0403>: (130 octets) ========
2020202020202020202020202020202020202020202020202020202020202020
2020202020202020202020202020202020202020202020202020202020202020
544c5320312e332c207365727665722043657274696669636174655665726966
790089697046b18cee49b178309823ed410a1649516f800ba7a7a9fa6db83ae2
88ce
===================================================
server returns server_accept clen=308 slen=834
secret=262c4660b0577ff6743a44e14bf35d69ed775ded711f12f0f5c701efbcffe985
<---- ServerHello;(EncryptedExtensions; Certificate; CertVerify; Finished)[ 834]

@@@@ Nego callback for TLS 1.3 @@@@
Offered extensions:
001b0010000800060568712d3038000a00040002001d001a0003000102
Transport parameters offered:
000102
No application cookie (fist connection).
Adding server transport parameters:
000102
@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
WARNING: chain validation failed, ignoring.
client returns client_complete clen=58 slen=834
secret=262c4660b0577ff6743a44e14bf35d69ed775ded711f12f0f5c701efbcffe985
(Finished) [  58] ---->

server returns server_complete clen=58 slen=0
server returns would_block clen=0 slen=135
<---- {Ticket}[ 135]

##### New session ticket received! #####
Host: localhost
Ticket:
9a9197f32d25ebeb1b2702d157ffebc4334c7583c49d9dd0e32262994fb44dc4
6fa64d41729d325b7065b48d427f19dd72300278a181c109e9f13d830ace4049
ead2774649138d2fbf56f992
########################################
client returns clen=0 slen=135 status=would_block
Ok
================================================================================
